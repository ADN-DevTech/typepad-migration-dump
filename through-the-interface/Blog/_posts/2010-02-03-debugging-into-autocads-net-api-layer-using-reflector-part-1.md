---
layout: "post"
title: "Debugging into AutoCAD&rsquo;s .NET API layer using Reflector &ndash; Part 1"
date: "2010-02-03 11:24:03"
author: "Kean Walmsley"
categories:
  - "AutoCAD"
  - "AutoCAD .NET"
  - "Debugging"
  - "Visual Studio"
original_url: "https://www.keanw.com/2010/02/debugging-into-autocads-net-api-layer-using-reflector-part-1.html "
typepad_basename: "debugging-into-autocads-net-api-layer-using-reflector-part-1"
typepad_status: "Publish"
---

<p>As many of you will know, by now, I’m <a href="http://through-the-interface.typepad.com/through_the_interface/2007/01/more_on_ip_prot.html">a</a> <a href="http://through-the-interface.typepad.com/through_the_interface/2007/01/reflecting_on_a.html">big</a> <a href="http://through-the-interface.typepad.com/through_the_interface/2007/01/one_for_the_bit.html">fan</a> <a href="http://through-the-interface.typepad.com/through_the_interface/2008/02/using-reflector.html">of</a> <a href="http://through-the-interface.typepad.com/through_the_interface/2009/07/converting-between-c-and-vbnet.html">Reflector</a>. I’ve used it for quite some time, since its early days as a piece of freeware developed by <a href="http://www.lutzroeder.com">Lutz Roeder</a>, and overall it’s proven to be an extremely valuable tool. When a UK-based company, <a href="http://www.red-gate.com">Red Gate Software</a>, <a href="http://blog.lutzroeder.com/2008/08/future-of-net-reflector.html">acquired the Reflector technology back in 2008</a>, I was curious as to their strategy for monetizing it (and it seems I wasn’t alone in speculating on <a href="http://www.simple-talk.com/opinion/opinion-pieces/the-future-of-reflector-/">the direction the tool would take as a commercial offering</a>). Well, that’s now starting <a href="http://www.simple-talk.com/community/blogs/laila/archive/2010/01/28/88748.aspx">to become clear</a> with <a href="http://www.red-gate.com/products/reflector/downloadbeta.htm">the Beta release of .NET Reflector Pro</a>.</p>  <p>Here’s the tag-line on Red Gate’s website for this new version:</p>  <blockquote>   <p><em><strong>.NET Reflector Pro integrates .NET Reflector into Visual Studio to allow you to seamlessly debug into third-party code and assemblies, even if you don't have the source code for them.</strong> You can now treat decompiled assemblies much like your own code: you can step through the assemblies and use all the debugging techniques that you would use on your own code.</em></p> </blockquote>  <p><a href="http://www.simple-talk.com/community/blogs/alex/archive/2010/01/20/87639.aspx">This blog article</a> on Red Gate’s Simple-Talk site contains some more interesting details on this version’s capabilities. Here are the two main features:</p>  <ul>   <ul>     <li><em>Letting you jump to Reflector from your code (this is free!)</em> </li>      <li><em>Debugging decompiled code using the visual studio debugger (this is Reflector Pro - so will cost money)</em> </li>   </ul> </ul>  <p>Both of these items look pretty interesting, and – knowing that the .NET API for AutoCAD is un<a href="http://through-the-interface.typepad.com/through_the_interface/2007/01/protecting_inte.html">obfuscated</a>, as it’s mostly a fairly thin layer on top of ObjectARX – the second (paid) feature has the potential to be of great interest to AutoCAD .NET developers.</p>  <p>So I decided to put the tool through its paces. After downloading the most recent external Beta (build 892), and extracting it to my hard-drive, I launched Reflector.</p>  <p>On the Tools menu, we see the Integration Options menu item:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e20120a8567f09970b-pi"><img style="border-right-width: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto" title="Reflector 6&#39;s integration options menu item" border="0" alt="Reflector 6&#39;s integration options menu item" src="/assets/image_730046.jpg" width="298" height="372" /></a> </p>  <p>In the options, themselves, we can see that the tool has detected the installed versions of Visual Studio on my system and has integrated itself appropriately with them:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201287758c6be970c-pi"><img style="border-right-width: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto" title="The integration options" border="0" alt="The integration options" src="/assets/image_370389.jpg" width="327" height="376" /></a> </p>  <p>Now, as long as we’ve previously loaded AutoCAD’s managed assemblies inside Reflector (File –&gt; Open, and select “acmgd.dll” and “acdbmgd.dll” from our AutoCAD installation folder), we should now be able to jump directly to the implementation of a particular method from the Visual Studio window. Let’s take the example of the method looked used in the last post, the Extend method we called on a Line:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201287758c6d7970c-pi"><img style="border-right-width: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto" title="Launching Reflector directly from Visual Studio" border="0" alt="Launching Reflector directly from Visual Studio" src="/assets/image_696654.jpg" width="384" height="368" /></a> </p>  <p>And when we select it, the integration takes us to the Curve class in Reflector:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201287758c6ea970c-pi"><img style="border-right-width: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto" title="Jumped to the Curve class, where Extend is implemented" border="0" alt="Jumped to the Curve class, where Extend is implemented" src="/assets/image_878921.jpg" width="298" height="372" /></a> </p>  <p>From here it’s a manual operation to expand the class and select “Extend(Boolean, Point3d) : Void” from the list of methods (although I’m curious why it didn’t manage to get there itself – perhaps a minor Beta quirk).</p>  <p>And then we can, of course, use the standard Reflector capabilities to look into the code:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e20120a8567fa7970b-pi"><img style="border-right-width: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto" title="Disassembling the Curve&#39;s Extend function" border="0" alt="Disassembling the Curve&#39;s Extend function" src="/assets/image_254167.jpg" width="298" height="372" /></a> </p>  <p>Which admittedly only shows us (in this case, at least) an obscure piece of code which is actually calling through to the underlying, unmanaged, ObjectARX API:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201287758c754970c-pi"><img style="border-right-width: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto" title="Our disassembled method" border="0" alt="Our disassembled method" src="/assets/image_375390.jpg" width="474" height="262" /></a> </p>  <p>In the second part of this two-part series, we’ll take a look at the “Pro” features of this new .NET Reflector version: the actual debugging integration.</p>
