---
layout: "post"
title: "JavaScript in AutoCAD: Viewing 3D solids using Three.js"
date: "2014-05-26 18:54:57"
author: "Kean Walmsley"
categories:
  - "AutoCAD"
  - "AutoCAD .NET"
  - "HTML"
  - "JavaScript"
  - "Solid modeling"
  - "User interface"
  - "Web/Tech"
original_url: "https://www.keanw.com/2014/05/javascript-in-autocad-viewing-3d-solids-using-threejs.html "
typepad_basename: "javascript-in-autocad-viewing-3d-solids-using-threejs"
typepad_status: "Publish"
---

<p>After <a href="http://through-the-interface.typepad.com/through_the_interface/2014/05/javascript-in-autocad-introducing-the-series.html" target="_blank">introducing the series</a> and looking at sample applications for <a href="http://through-the-interface.typepad.com/through_the_interface/2014/05/javascript-in-autocad-revision-clouds-using-paperjs.html" target="_blank">2D graphics using Paper.js</a> and <a href="http://through-the-interface.typepad.com/through_the_interface/2014/05/javascript-in-autocad-isometric-views-of-3d-solids.html" target="_blank">2.5D graphics using Isomer</a>, it’s now really time to go 3D.</p>  <p>We’re going to use much of the same code we saw in the last post – with some simplification as we no longer need to sort the solids by distance – but this time we’re going to feed data into an HTML client app that’s fundamentally similar in nature to the one seen in <a href="http://through-the-interface.typepad.com/through_the_interface/2012/05/creating-a-3d-viewer-for-our-apollonian-service-using-html5.html" target="_blank">this</a> <a href="http://through-the-interface.typepad.com/through_the_interface/2012/05/creating-a-3d-viewer-for-our-apollonian-service-using-html5-part-2.html" target="_blank">series</a> of <a href="http://through-the-interface.typepad.com/through_the_interface/2012/05/creating-a-3d-viewer-for-our-apollonian-service-using-html5-part-3.html" target="_blank">posts</a> using <a href="http://threejs.org" target="_blank">Three.js</a>. I’m happy to have some experience using Three.js, because it happens to be a technology that’s at the core of something exciting our Cloud Platforms team is building. More on that later (please scroll to the bottom of this post for more information on that).</p>  <p>It’s worth saying a few words about Three.js. It’s basically a topological layer on top of <a href="http://en.wikipedia.org/wiki/WebGL" target="_blank">WebGL</a> that allows you to build a scene based on objects, rather than having to deal with low-level graphics API calls. As such it’s supported in <a href="http://en.wikipedia.org/wiki/WebGL#Desktop_browsers" target="_blank">most modern browsers</a>, the main outlier being Internet Explorer (which has partial WebGL support with IE11, apparently). But as AutoCAD’s browser control – used for both HTML palettes and documents – is based on the <a href="http://en.wikipedia.org/wiki/Chromium_Embedded_Framework" target="_blank">Chromium Embedded Framework</a>, at least for AutoCAD-resident use (such as we’ll see today) we’re just fine.</p>  <p>As before, let’s start by looking at the C# code that gets called from JavaScript to retrieve the bounding box information about our 3D solids, as well as the commands to launch our HTML UI.</p>  <div style="font-size: 8pt; font-family: courier new; background: white; color: black; line-height: 140%">   <p style="margin: 0px"><span style="color: blue">using</span> Autodesk.AutoCAD.ApplicationServices;</p>    <p style="margin: 0px"><span style="color: blue">using</span> Autodesk.AutoCAD.DatabaseServices;</p>    <p style="margin: 0px"><span style="color: blue">using</span> Autodesk.AutoCAD.Runtime;</p>    <p style="margin: 0px"><span style="color: blue">using</span> Autodesk.AutoCAD.Windows;</p>    <p style="margin: 0px"><span style="color: blue">using</span> Newtonsoft.Json;</p>    <p style="margin: 0px"><span style="color: blue">using</span> System;</p>    <p style="margin: 0px"><span style="color: blue">using</span> System.Collections.Generic;</p>    <p style="margin: 0px"><span style="color: blue">using</span> System.IO;</p>    <p style="margin: 0px"><span style="color: blue">using</span> System.Reflection;</p>    <p style="margin: 0px"><span style="color: blue">using</span> System.Text;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">namespace</span> JavaScriptExtender</p>    <p style="margin: 0px">{</p>    <p style="margin: 0px">&#160; <span style="color: blue">public</span> <span style="color: blue">class</span> <span style="color: #2b91af">Commands</span></p>    <p style="margin: 0px">&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">private</span> <span style="color: #2b91af">PaletteSet</span> _3ps = <span style="color: blue">null</span>;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">private</span> <span style="color: blue">static</span> <span style="color: #2b91af">Document</span> _launchDoc = <span style="color: blue">null</span>;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; [<span style="color: #2b91af">JavaScriptCallback</span>(<span style="color: #a31515">&quot;GetSolids&quot;</span>)]</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">public</span> <span style="color: blue">string</span> GetSolids(<span style="color: blue">string</span> jsonArgs)</p>    <p style="margin: 0px">&#160;&#160;&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">var</span> doc = GetActiveDocument(<span style="color: #2b91af">Application</span>.DocumentManager);</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">// If we didn't find a document, return</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> (doc == <span style="color: blue">null</span>)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">return</span> <span style="color: #a31515">&quot;&quot;</span>;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">// We could probably get away without locking the document</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">// - as we only need to read - but it's good practice to</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">// do it anyway</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">using</span> (<span style="color: blue">var</span> dl = doc.LockDocument())</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">var</span> db = doc.Database;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">var</span> ed = doc.Editor;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// Capture our Extents3d objects in a list</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">var</span> sols = <span style="color: blue">new</span> <span style="color: #2b91af">List</span>&lt;<span style="color: #2b91af">Extents3d</span>&gt;();</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">using</span> (<span style="color: blue">var</span> tr = doc.TransactionManager.StartTransaction())</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// Start by getting the modelspace</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">var</span> ms =</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (<span style="color: #2b91af">BlockTableRecord</span>)tr.GetObject(</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">SymbolUtilityServices</span>.GetBlockModelSpaceId(db),</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">OpenMode</span>.ForRead</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; );</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// Get each Solid3d in modelspace and add its extents</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// to the list</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">foreach</span> (<span style="color: blue">var</span> id <span style="color: blue">in</span> ms)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">var</span> obj = tr.GetObject(id, <span style="color: #2b91af">OpenMode</span>.ForRead);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">var</span> sol = obj <span style="color: blue">as</span> <span style="color: #2b91af">Solid3d</span>;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> (sol != <span style="color: blue">null</span>)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; sols.Add(sol.GeometricExtents);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; tr.Commit();</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">return</span> GetSolidsString(sols);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; }</p>    <p style="margin: 0px">&#160;&#160;&#160; }</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">private</span> <span style="color: #2b91af">Document</span> GetActiveDocument(<span style="color: #2b91af">DocumentCollection</span> dm)</p>    <p style="margin: 0px">&#160;&#160;&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">// If we're called from an HTML document, the active</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">// document may be null</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">var</span> doc = dm.MdiActiveDocument;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> (doc == <span style="color: blue">null</span>)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; doc = _launchDoc;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; }</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">return</span> doc;</p>    <p style="margin: 0px">&#160;&#160;&#160; }</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">// Helper function to build a JSON string containing our</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">// sorted extents list</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">private</span> <span style="color: blue">string</span> GetSolidsString(<span style="color: #2b91af">List</span>&lt;<span style="color: #2b91af">Extents3d</span>&gt; lst)</p>    <p style="margin: 0px">&#160;&#160;&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">var</span> sb = <span style="color: blue">new</span> <span style="color: #2b91af">StringBuilder</span>(<span style="color: #a31515">&quot;{\&quot;retCode\&quot;:0, \&quot;result\&quot;:[&quot;</span>);</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">bool</span> first = <span style="color: blue">true</span>;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">foreach</span> (<span style="color: blue">var</span> ext <span style="color: blue">in</span> lst)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> (first)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; first = <span style="color: blue">false</span>;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">else</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; sb.Append(<span style="color: #a31515">&quot;,&quot;</span>);</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; sb.Append(</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">string</span>.Format(</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #a31515">&quot;{{\&quot;min\&quot;:{0},\&quot;max\&quot;:{1}}}&quot;</span>,</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">JsonConvert</span>.SerializeObject(ext.MinPoint),</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">JsonConvert</span>.SerializeObject(ext.MaxPoint)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; )</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; );</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; }</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; sb.Append(<span style="color: #a31515">&quot;]}&quot;</span>);</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">return</span> sb.ToString();</p>    <p style="margin: 0px">&#160;&#160;&#160; }</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; [<span style="color: #2b91af">CommandMethod</span>(<span style="color: #a31515">&quot;THREEDOC&quot;</span>)]</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">public</span> <span style="color: blue">static</span> <span style="color: blue">void</span> ThreeDocument()</p>    <p style="margin: 0px">&#160;&#160;&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; _launchDoc = <span style="color: #2b91af">Application</span>.DocumentManager.MdiActiveDocument;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; _launchDoc.BeginDocumentClose +=</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (s, e) =&gt; { _launchDoc = <span style="color: blue">null</span>; };</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">Application</span>.DocumentWindowCollection.AddDocumentWindow(</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #a31515">&quot;Three.js Document&quot;</span>, GetHtmlPathThree()</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; );</p>    <p style="margin: 0px">&#160;&#160;&#160; }</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; [<span style="color: #2b91af">CommandMethod</span>(<span style="color: #a31515">&quot;THREE&quot;</span>)]</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">public</span> <span style="color: blue">void</span> ThreePalette()</p>    <p style="margin: 0px">&#160;&#160;&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; _launchDoc = <span style="color: blue">null</span>;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; _3ps =</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; ShowPalette(</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; _3ps,</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">new</span> <span style="color: #2b91af">Guid</span>(<span style="color: #a31515">&quot;9CEE43FF-FDD7-406A-89B2-6A48D4169F71&quot;</span>),</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #a31515">&quot;THREE&quot;</span>,</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #a31515">&quot;Three.js Examples&quot;</span>,</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; GetHtmlPathThree()</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; );</p>    <p style="margin: 0px">&#160;&#160;&#160; }</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">// Helper function to show a palette</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">private</span> <span style="color: #2b91af">PaletteSet</span> ShowPalette(</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">PaletteSet</span> ps, <span style="color: #2b91af">Guid</span> guid, <span style="color: blue">string</span> cmd, <span style="color: blue">string</span> title, <span style="color: #2b91af">Uri</span> uri</p>    <p style="margin: 0px">&#160;&#160;&#160; )</p>    <p style="margin: 0px">&#160;&#160;&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> (ps == <span style="color: blue">null</span>)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; ps = <span style="color: blue">new</span> <span style="color: #2b91af">PaletteSet</span>(cmd, guid);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; }</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">else</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> (ps.Visible)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">return</span> ps;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; }</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> (ps.Count != 0)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; ps[0].PaletteSet.Remove(0);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; }</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; ps.Add(title, uri);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; ps.Visible = <span style="color: blue">true</span>;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">return</span> ps;</p>    <p style="margin: 0px">&#160;&#160;&#160; }</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">// Helper function to get the path to our HTML files</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">private</span> <span style="color: blue">static</span> <span style="color: blue">string</span> GetHtmlPath()</p>    <p style="margin: 0px">&#160;&#160;&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">// Use this approach if loading the HTML from the same</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">// location as your .NET module</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">//var asm = Assembly.GetExecutingAssembly();</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">//return Path.GetDirectoryName(asm.Location) + &quot;\\&quot;;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">return</span> <span style="color: #a31515">&quot;http://through-the-interface.typepad.com/files/&quot;</span>;</p>    <p style="margin: 0px">&#160;&#160;&#160; }</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">private</span> <span style="color: blue">static</span> <span style="color: #2b91af">Uri</span> GetHtmlPathThree()</p>    <p style="margin: 0px">&#160;&#160;&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">return</span> <span style="color: blue">new</span> <span style="color: #2b91af">Uri</span>(GetHtmlPath() + <span style="color: #a31515">&quot;threesolids.html&quot;</span>);</p>    <p style="margin: 0px">&#160;&#160;&#160; }</p>    <p style="margin: 0px">&#160; }</p>    <p style="margin: 0px">}</p> </div>  <p>Here’s the code in action:</p>  <br /><iframe height="264" src="//www.youtube.com/embed/J0CCF2j0crg?rel=0" frameborder="0" width="470" allowfullscreen="allowfullscreen"></iframe>  <br />  <br />  <p>Here’s <a href="http://through-the-interface.typepad.com/files/threesolids.html" target="_blank">the HTML page</a> from my blog:</p>  <div style="font-size: 8pt; font-family: courier new; background: white; color: black; line-height: 140%">   <p style="margin: 0px"><span style="color: blue">&lt;</span><span style="color: maroon">!doctype</span> <span style="color: red">html</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&lt;</span><span style="color: maroon">html</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px">&#160; <span style="color: blue">&lt;</span><span style="color: maroon">head</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">&lt;</span><span style="color: maroon">title</span><span style="color: blue">&gt;</span>Three.js Solids<span style="color: blue">&lt;/</span><span style="color: maroon">title</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">&lt;</span><span style="color: maroon">link</span> <span style="color: red">rel</span><span style="color: blue">=&quot;stylesheet&quot;</span> <span style="color: red">href</span><span style="color: blue">=&quot;style.css&quot;&gt;</span></p>    <p style="margin: 0px">&#160; <span style="color: blue">&lt;/</span><span style="color: maroon">head</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px">&#160; <span style="color: blue">&lt;</span><span style="color: maroon">body</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">&lt;</span><span style="color: maroon">script</span> <span style="color: red">src</span><span style="color: blue">=&quot;http://code.jquery.com/jquery-1.7.1.js&quot;&gt;&lt;/</span><span style="color: maroon">script</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">&lt;</span><span style="color: maroon">script</span> <span style="color: red">src</span><span style="color: blue">=&quot;js/three.min.js&quot;&gt;&lt;/</span><span style="color: maroon">script</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">&lt;</span><span style="color: maroon">script</span> <span style="color: red">src</span><span style="color: blue">=&quot;js/controls/TrackballControls.js&quot;&gt;&lt;/</span><span style="color: maroon">script</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">&lt;</span><span style="color: maroon">script</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: red">src</span><span style="color: blue">=&quot;http://app.autocad360.com/jsapi/v2/Autodesk.AutoCAD.js&quot;&gt;</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">&lt;/</span><span style="color: maroon">script</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">&lt;</span><span style="color: maroon">script</span> <span style="color: red">src</span><span style="color: blue">=&quot;js/acadext.js&quot;&gt;&lt;/</span><span style="color: maroon">script</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">&lt;</span><span style="color: maroon">script</span> <span style="color: red">src</span><span style="color: blue">=&quot;js/threesolids.js&quot;&gt;&lt;/</span><span style="color: maroon">script</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px">&#160; <span style="color: blue">&lt;/</span><span style="color: maroon">body</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&lt;/</span><span style="color: maroon">html</span><span style="color: blue">&gt;</span></p> </div>  <p>As before, it relies on <a href="http://through-the-interface.typepad.com/files/js/threesolids.js" target="_blank">an external JavaScript file</a>:</p>  <div style="font-size: 8pt; font-family: courier new; background: white; color: black; line-height: 140%">   <p style="margin: 0px"><span style="color: green">// Global variables</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">var</span> useWebGL;</p>    <p style="margin: 0px"><span style="color: blue">var</span> container, root = <span style="color: blue">null</span>;</p>    <p style="margin: 0px"><span style="color: blue">var</span> camera, scene, renderer, trackball;</p>    <p style="margin: 0px"><span style="color: blue">var</span> sols;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: green">// Some namespace shortcuts</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">var</span> Vector3 = THREE.Vector3;</p>    <p style="margin: 0px"><span style="color: blue">var</span> PointLight = THREE.PointLight;</p>    <p style="margin: 0px"><span style="color: blue">var</span> BoxGeometry = THREE.BoxGeometry;</p>    <p style="margin: 0px"><span style="color: blue">var</span> Mesh = THREE.Mesh;</p>    <p style="margin: 0px"><span style="color: blue">var</span> MeshLambertMaterial = THREE.MeshLambertMaterial;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">function</span> init() {</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: green">// Get our solids from AutoCAD</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; sols = getSolidsFromAutoCAD();</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: green">// Get the overall bounding box</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: blue">var</span> minX = Infinity,</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; minY = Infinity,</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; minZ = Infinity,</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; maxX = -Infinity,</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; maxY = -Infinity,</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; maxZ = -Infinity;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: blue">for</span> (<span style="color: blue">var</span> sol <span style="color: blue">in</span> sols) {</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">var</span> s = sols[sol];</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; minX = Math.min(minX, s.min.X, s.max.X);</p>    <p style="margin: 0px">&#160;&#160;&#160; minY = Math.min(minY, s.min.Y, s.max.Y);</p>    <p style="margin: 0px">&#160;&#160;&#160; minZ = Math.min(minZ, s.min.Z, s.max.Y);</p>    <p style="margin: 0px">&#160;&#160;&#160; maxX = Math.max(maxX, s.min.X, s.max.X);</p>    <p style="margin: 0px">&#160;&#160;&#160; maxY = Math.max(maxY, s.min.Y, s.max.Y);</p>    <p style="margin: 0px">&#160;&#160;&#160; maxZ = Math.max(maxZ, s.min.Z, s.max.X);</p>    <p style="margin: 0px">&#160; }</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: blue">var</span> delX = Math.abs(maxX - minX),</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; delY = Math.abs(maxY - minY),</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; delZ = Math.abs(maxZ - minZ);</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: green">// See whether we can use WebGL or not</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; useWebGL = hasWebGL();</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: green">// Build the canvas area and add a linebreak beneath it</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; container = document.createElement(<span style="color: #a31515">'div'</span>);</p>    <p style="margin: 0px">&#160; container.style.background = <span style="color: #a31515">'#FFFFFF'</span>;</p>    <p style="margin: 0px">&#160; document.body.appendChild(container);</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: blue">var</span> br = document.createElement(<span style="color: #a31515">'br'</span>);</p>    <p style="margin: 0px">&#160; document.body.appendChild(br);</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: green">// Build the area our button(s) will reside on the page</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: blue">var</span> controls = document.createElement(<span style="color: #a31515">'div'</span>);</p>    <p style="margin: 0px">&#160; controls.setAttribute(<span style="color: #a31515">'id'</span>, <span style="color: #a31515">'control'</span>);</p>    <p style="margin: 0px">&#160; document.body.appendChild(controls);</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: green">// Set the scene size (slightly smaller than the</span></p>    <p style="margin: 0px">&#160; <span style="color: green">// inner screen size, to avoid scrollbars)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: blue">var</span> width = window.innerWidth - 17,</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; height = window.innerHeight - 90;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: green">// Set some camera attributes</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: blue">var</span> viewAngle = 45,</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; aspect = width / height,</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; near = 0.1,</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; far = maxZ * 100;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: green">// Create the renderer, camera, scene and trackball</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; renderer =</p>    <p style="margin: 0px">&#160;&#160;&#160; useWebGL ?</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">new</span> THREE.WebGLRenderer() :</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">new</span> THREE.CanvasRenderer();</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; camera = <span style="color: blue">new</span> THREE.PerspectiveCamera(viewAngle, aspect, near, far);</p>    <p style="margin: 0px">&#160; camera.position.set(minX + delX / 2, minY + delY / 2, maxZ * 1.5);</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; scene = <span style="color: blue">new</span> THREE.Scene();</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: green">// Create some point lights and add them to the scene</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: blue">var</span> pointLight = <span style="color: blue">new</span> PointLight(0xFFEEFF);</p>    <p style="margin: 0px">&#160; pointLight.position.set(minX - delX, minY - delY, maxZ + delZ);</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: blue">var</span> pointLight2 = <span style="color: blue">new</span> PointLight(0xEEFFFF);</p>    <p style="margin: 0px">&#160; pointLight2.position.set(maxX + delX, maxY + delY, maxZ + delZ);</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; scene.add(pointLight);</p>    <p style="margin: 0px">&#160; scene.add(pointLight2);</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: green">// And the camera</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; scene.add(camera);</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: green">// Create our trackball controls</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; trackball = <span style="color: blue">new</span> THREE.TrackballControls(camera);</p>    <p style="margin: 0px">&#160; trackball.target.set(minX + delX / 2, minY + delY / 2, 0);</p>    <p style="margin: 0px">&#160; trackball.rotateSpeed = 1.4;</p>    <p style="margin: 0px">&#160; trackball.zoomSpeed = 2.0;</p>    <p style="margin: 0px">&#160; trackball.panSpeed = 0.5;</p>    <p style="margin: 0px">&#160; trackball.noZoom = <span style="color: blue">false</span>;</p>    <p style="margin: 0px">&#160; trackball.noPan = <span style="color: blue">false</span>;</p>    <p style="margin: 0px">&#160; trackball.staticMoving = <span style="color: blue">true</span>;</p>    <p style="margin: 0px">&#160; trackball.dynamicDampingFactor = 0.3;</p>    <p style="margin: 0px">&#160; trackball.keys = [65, 83, 68]; <span style="color: green">// [a:rotate, s:zoom, d:pan]</span></p>    <p style="margin: 0px">&#160; trackball.addEventListener(<span style="color: #a31515">'change'</span>, render);</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: green">// Look at the same position as the trackball using our camera</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; camera.lookAt(<span style="color: blue">new</span> Vector3(minX + delX / 2, minY + delY / 2, 0));</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: green">// Start the renderer</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; renderer.setSize(width, height);</p>    <p style="margin: 0px">&#160; renderer.setClearColor(0xCCCCCC, 1);</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: green">// Attach the renderer-supplied DOM element</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; container.appendChild(renderer.domElement);</p>    <p style="margin: 0px">}</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">function</span> animate() {</p>    <p style="margin: 0px">&#160; requestAnimationFrame(animate);</p>    <p style="margin: 0px">&#160; trackball.update(camera);</p>    <p style="margin: 0px">}</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">function</span> render() {</p>    <p style="margin: 0px">&#160; renderer.render(scene, camera);</p>    <p style="margin: 0px">}</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">function</span> Commands() { }</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">Commands.refresh = <span style="color: blue">function</span> () {</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: green">// Clear any previous geometry</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: blue">if</span> (root != <span style="color: blue">null</span>) {</p>    <p style="margin: 0px">&#160;&#160;&#160; scene.remove(root);</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">delete</span> root;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">// Get the geometry info from AutoCAD again</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; sols = getSolidsFromAutoCAD();</p>    <p style="margin: 0px">&#160; }</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: green">// Create the materials</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: blue">var</span> dark = <span style="color: blue">new</span> MeshLambertMaterial({ color: 0x000000 });</p>    <p style="margin: 0px">&#160; <span style="color: blue">var</span> light = <span style="color: blue">new</span> MeshLambertMaterial({ color: 0xFFFFFF });</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: green">// Set up the root vars</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: blue">var</span> rootDim = 0.01, segs = 9;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: green">// Create our root object</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: blue">var</span> boxGeom =</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">new</span> BoxGeometry(rootDim, rootDim, rootDim, segs, segs, segs);</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: green">// Create the mesh from the geometry</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; root = <span style="color: blue">new</span> Mesh(boxGeom, dark);</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; scene.add(root);</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: green">// Process each box, adding it to the scene</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: blue">for</span> (<span style="color: blue">var</span> sol <span style="color: blue">in</span> sols) {</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">var</span> s = sols[sol];</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">var</span> box = <span style="color: blue">new</span> Mesh(boxGeom, light);</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; box.position.x = s.min.X + (s.max.X - s.min.X) / 2;</p>    <p style="margin: 0px">&#160;&#160;&#160; box.position.y = s.min.Y + (s.max.Y - s.min.Y) / 2;</p>    <p style="margin: 0px">&#160;&#160;&#160; box.position.z = s.min.Z + (s.max.Z - s.min.Z) / 2;</p>    <p style="margin: 0px">&#160;&#160;&#160; box.scale.x = (s.max.X - s.min.X) / rootDim;</p>    <p style="margin: 0px">&#160;&#160;&#160; box.scale.y = (s.max.Y - s.min.Y) / rootDim;</p>    <p style="margin: 0px">&#160;&#160;&#160; box.scale.z = (s.max.Z - s.min.Z) / rootDim;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; root.add(box);</p>    <p style="margin: 0px">&#160; }</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: green">// Draw!</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; renderer.render(scene, camera);</p>    <p style="margin: 0px">};</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: green">// Feature test for WebGL</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">function</span> hasWebGL()</p>    <p style="margin: 0px">{</p>    <p style="margin: 0px">&#160; <span style="color: blue">try</span></p>    <p style="margin: 0px">&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">var</span> canvas = document.createElement(<span style="color: #a31515">'canvas'</span>);</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">var</span> ret =</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; !!(window.WebGLRenderingContext &amp;&amp;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (canvas.getContext(<span style="color: #a31515">'webgl'</span>) ||</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; canvas.getContext(<span style="color: #a31515">'experimental-webgl'</span>))</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; );</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">return</span> ret;</p>    <p style="margin: 0px">&#160; }</p>    <p style="margin: 0px">&#160; <span style="color: blue">catch</span>(e)</p>    <p style="margin: 0px">&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">return</span> <span style="color: blue">false</span>;</p>    <p style="margin: 0px">&#160; };</p>    <p style="margin: 0px">}</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">(<span style="color: blue">function</span> () {</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; init();</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: blue">var</span> panel = document.getElementById(<span style="color: #a31515">'control'</span>);</p>    <p style="margin: 0px">&#160; <span style="color: blue">for</span> (<span style="color: blue">var</span> fn <span style="color: blue">in</span> Commands) {</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">var</span> button = document.createElement(<span style="color: #a31515">'div'</span>);</p>    <p style="margin: 0px">&#160;&#160;&#160; button.classList.add(<span style="color: #a31515">'cmd-btn'</span>);</p>    <p style="margin: 0px">&#160;&#160;&#160; button.innerHTML = fn;</p>    <p style="margin: 0px">&#160;&#160;&#160; button.onclick = (<span style="color: blue">function</span> (fn) {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">return</span> <span style="color: blue">function</span> () { fn(); };</p>    <p style="margin: 0px">&#160;&#160;&#160; })(Commands[fn]);</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; panel.appendChild(button);</p>    <p style="margin: 0px">&#160;&#160;&#160; panel.appendChild(document.createTextNode(<span style="color: #a31515">'\u00a0'</span>));</p>    <p style="margin: 0px">&#160; }</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; Commands.refresh();</p>    <p style="margin: 0px">&#160; animate();</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">})();</p> </div>  <p><a href="http://through-the-interface.typepad.com/files/style.css" target="_blank">The stylesheet</a> and <a href="http://through-the-interface.typepad.com/files/js/acadext.js" target="_blank">the extension to AutoCAD’s Shaping Layer</a> are the same as last time (I’ve perhaps foolishly kept the same name for the function as in the previous post, even though it no longer does any location-based sorting of the solids’ bounding boxes).</p>  <p>Hopefully you can see the potential that WebGL and Three.js present for zero client 3D in HTML5 browsers. It’s this rich capability that our Cloud Platforms organization has harnessed for the new model viewer in <a href="http://360.autodesk.com" target="_blank">Autodesk 360</a>. If you haven’t already taken it for a spin, head on over and check out the new <a href="https://autodesk360.com" target="_blank">Autodesk 360 Tech Preview</a>. The new viewer is really impressive.</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201a3fd10ba64970b-pi" target="_blank"><img title="Screen Shot 2014-05-26 at 1.56.55 PM" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; float: none; padding-top: 0px; padding-left: 0px; margin: 20px auto; display: block; padding-right: 0px; border-top-width: 0px" border="0" alt="Screen Shot 2014-05-26 at 1.56.55 PM" src="/assets/image_822506.jpg" width="400" height="355" /></a></p>  <p>In tomorrow’s post we’ll take a sneak peek at the new Autodesk viewer embedded in a web page, just to give you a sense of what’s coming… some very cool stuff!</p>
