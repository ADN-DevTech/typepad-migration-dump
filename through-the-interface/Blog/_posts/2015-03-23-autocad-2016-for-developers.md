---
layout: "post"
title: "AutoCAD 2016 for developers"
date: "2015-03-23 12:20:44"
author: "Kean Walmsley"
categories:
  - "AutoCAD"
  - "AutoCAD .NET"
  - "Commands"
  - "ObjectARX"
  - "Point clouds"
  - "Reality capture"
  - "Runtime"
  - "Security"
original_url: "https://www.keanw.com/2015/03/autocad-2016-for-developers.html "
typepad_basename: "autocad-2016-for-developers"
typepad_status: "Publish"
---

<p>After <a href="http://through-the-interface.typepad.com/through_the_interface/2015/03/autocad-2016.html" target="_blank">our quick look at AutoCAD 2016 from a user perspective</a>, let’s now spend some time looking at the things important to developers in this latest release.</p>  <br />  <p><strong>Compatibility</strong></p>  <p>Off the bat it’s worth stating that AutoCAD 2016 is a <strong>DWG compatible</strong> release: it’s using the same file format as AutoCAD 2013, 2014 and 2015. It’s also a <strong>binary application compatible</strong> release: ObjectARX apps written for AutoCAD 2015 should work in 2016 and it’s likely that .NET apps built for AutoCAD 2014 will work, too. That said, some changes have been made to the security model for this release of AutoCAD, so you may want to make sure these changes haven’t impacted your application…</p>  <br />  <p><strong>Security</strong></p>  <p>You’ll see straight away when you try to load your application that there’s a bit more going on in the 2016 version of this dialog.</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201b8d0f2b2ea970c-pi" target="_blank"><img title="Security dialog in AutoCAD 2016" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; float: none; padding-top: 0px; padding-left: 0px; margin: 20px auto; display: block; padding-right: 0px; border-top-width: 0px" border="0" alt="Security dialog in AutoCAD 2016" src="/assets/image_785308.jpg" width="359" height="211" /></a></p>  <p>Firstly, the word “unsigned” indicates something very important: we’re encouraging developers to <strong>sign their executables</strong> – and even their LISP files – to improve security. An increasing number of AutoCAD customers – often the larger ones, as you might expect – are requiring application modules to be signed. This is certainly a topic that’s worth go into more deeply in a future post.</p>  <p>The other addition to the dialog is the “Always load this application” checkbox. This tells AutoCAD to continue loading this module from a non-trusted location, with the caveat that if the module changes the user will be prompted again.</p>  <p><a href="http://knowledge.autodesk.com/search?search=%22may%20be%20locked%20by%20a%20CAD%20administrator%22#?sort=score" target="_blank">A number of sysvars</a> related to AutoCAD’s security features can now be <strong>locked</strong> by CAD managers:</p>  <ul>   <li>SECURELOAD </li>    <li>TRUSTEDPATHS </li>    <li><strike>TRUSTEDDOMAINS</strike> (see <em>update</em> below)</li>    <li>LEGACYCODESEARCH </li>    <li><strike>ACADLSPASDOC</strike> (see <em>update</em> below)</li> </ul>  <p>LEGACYCODESEARCH is important to note: AutoCAD’s default “find file” behaviour has been changed neither to search the current working folder nor the folder of the active drawing. This will make it much harder for people to write viruses that travel around with AutoCAD drawings.</p>  <p>On the subject of sysvars, I do think the <strong>System Variable Monitor</strong> – which we mentioned last time – will be a useful diagnostic tool for developers. If you know you’re using sysvars in your code – such as CMDECHO, CMDDIA, FILEDIA, etc. – try adding them to the monitor and see whether you get any notifications about your commands not setting them back properly. If you get any you can bet your users will, too.</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201b8d0f2b2f3970c-pi" target="_blank"><img title="Sysvar monitor" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; float: none; padding-top: 0px; padding-left: 0px; margin: 20px auto; display: block; padding-right: 0px; border-top-width: 0px" border="0" alt="Sysvar monitor" src="/assets/image_709505.jpg" width="350" height="324" /></a></p>  <p>Now let’s take a look at the new .NET API features (equivalent – and in a few cases more – functionality is also available via ObjectARX).</p>  <br />  <p><strong>Reality computing</strong></p>  <p>A number of point cloud-related features have been added to the product and are also available via the API.</p>  <p>You can create point cloud extension definitions (PointCloudDefEx objects) by attaching .RCS/.RCP files. These are analogous to block definitions. You can also create point cloud extension entities (PointCloudEx objects) that “insert” these into the drawing. A whole slew of properties and methods are exposed from both these classes.</p>  <p>A number of capabilities have been added relating to extraction of features from point clouds. Firstly, the Section class now has a “slice” type, and can be used to slice through a point cloud. Correspondingly it’s possible to use a PointCloudCrop object to crop a point cloud relative to a plane.</p>  <br /><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201bb080d2161970d-pi"><img title="Even silly point clouds can be sectioned" style="display: inline" alt="Even silly point clouds can be sectioned" src="/assets/image_614467.jpg" width="470" height="359" /></a>   <br />  <p>The extraction itself can also be driven programmatically. I’ve put together a sample that performs an extraction and adds the extracted geometry to the drawing: we’ll take a look at that in an upcoming post.</p>  <br />  <p><strong>Rendering</strong></p>  <p>A number of capabilities related to the newly introduced RapidRT rendering system have been added to the API in this release. You can add and control image-based lighting, for instance, as well as managing the various settings related to RapidRT.</p>  <p>As this is a binary application compatible release, when we change an API significantly we make sure we do so via a new class until we can safely break API compatibility in a future release. So there’s a new Autodesk.AutoCAD.GraphicsSystem.Manager2 class which contains GetOffScreenDevice() and GetOffScreenView() methods making use of the RapidRT engine.</p>  <br />  <p><strong>Miscellaneous</strong></p>  <p>Here’s a quick round-up of some of the more interesting miscellaneous API enhancements in this release…</p>  <p>The Spline.ToPolyline() method has a couple of new Boolean parameters allowing you to specify that you wish to create arc segments as well as requesting the generation of lightweight polylines.</p>  <p>The Dimension.TextDefinedSize property allows you to control the width associated with long dimension text.</p>  <p>The MText class has a couple of new properties: ContentsRTF allows you to extract a version of the contents in <a href="http://en.wikipedia.org/wiki/Rich_Text_Format" target="_blank">Rich Text Format</a>, while ShowBorders allows you to query or control whether an MText object’s borders are visible.</p>  <p>We mentioned the ability for CAD managers to lock certain system variables. There’s a corresponding Variable.IsLocked property allowing you to test this programmatically.</p>  <p>And finally my personal favourite miscellaneous enhancement in this release… you can now request code to be executed within a command context from the application context using DocumentCollection.ExecuteInCommandContextAsync(). Now this may not sound like much, but this one method allows you to do some <em>really</em> interesting things, such as calling commands from AutoCAD event handlers or even OS-level events. This is definitely a method of which we’re going to make a great deal of use, both in a few near-term posts and in the longer term.</p>  <p><strong><em>Update:</em></strong></p>  <p>It turns out that while the documentation for ACADLSPASDOC and TRUSTEDDOMAINS state they “may be locked by CAD managers”, the CAD Manager Control Utility currently does not, in fact, allow you to lock these two sysvars. Thanks to Dieter and Karen for tracking this one down: we’ll make sure the docs get fixed during the next update.</p>
