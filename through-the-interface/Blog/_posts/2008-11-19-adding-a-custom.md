---
layout: "post"
title: "Adding a custom tab to AutoCAD's options dialog using .NET - Part 1"
date: "2008-11-19 10:07:25"
author: "Kean Walmsley"
categories:
  - "AutoCAD"
  - "AutoCAD .NET"
  - "Notification / Events"
  - "User interface"
original_url: "https://www.keanw.com/2008/11/adding-a-custom.html "
typepad_basename: "adding-a-custom"
typepad_status: "Publish"
---

<p><em>A big thanks to Viru Aithal, from our DevTech India team, for providing the code that inspired this post.</em></p>
<p><em><strong>Update:</strong> it turns out I didn&#39;t look deeply enough into the origins of the code behind this post. The code that inspired Viru&#39;s code that inspired mine came from our old friend Mike Tuersley, who&#39;s delivering </em><a href="http://au.autodesk.com/sessions/detail/3022/"><em>a class on customizing the Options dialog at this year&#39;s AU</em></a><em> (in just over a week). Thanks, Mike! :-)</em></p>
<p>One way that applications often want to integrate with AutoCAD is via the dialog displayed by the OPTIONS command. Luckily it&#39;s relatively easy to add your own custom tab to this dialog using .NET, allowing users to view and modify your application&#39;s settings. I&#39;m going to take a similar approach to this topic as I did with <a href="http://through-the-interface.typepad.com/through_the_interface/2008/11/implementing-ta.html">task</a> <a href="http://through-the-interface.typepad.com/through_the_interface/2008/11/implementing--1.html">dialogs</a>: part 1 (this post) focuses on a very simple implementation to show the basic capabilities of the mechanism, and part 2 will look at a more &quot;real world&quot; implementation that goes as far as providing access to and storing some actual (well, realistic, at least) application settings.</p>
<p>The first step when implementing your custom tab is to add a User Control to your project. As this activity goes beyond just copy &amp; pasting code, <a href="http://through-the-interface.typepad.com/through_the_interface/files/OptionsDlg.zip">here&#39;s a sample project</a> demonstrating the technique shown in this post.</p>
<p>Once you have a User Control in your project (ours has the default name <em>UserControl1</em>), you can design it to add in some custom controls - whether buttons, checkboxes, combos, or more complex controls such as a property grid (something I&#39;ll show in the next post). Here&#39;s the design I settled for, containing just a few, simple controls, each added with its default name:</p>
<p><a href="http://through-the-interface.typepad.com/through_the_interface/WindowsLiveWriter/User%20control%20layout%20for%20options%20tab.png"><img alt="User control layout for options tab" border="0" height="300" src="/assets/User%20control%20layout%20for%20options%20tab_thumb.png" style="BORDER-RIGHT-WIDTH: 0px; BORDER-TOP-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px" width="385" /></a> </p>
<p>You can clearly adjust the layout, as you wish, with anchor points, docking, etc. It&#39;s worth setting the &quot;modifier&quot; for each of the controls you&#39;ve added to public or internal, assuming you want to access their state directly from elsewhere in the project. The other way is to expose them via public properties, but that&#39;s really up to you.</p>
<p>Here&#39;s the code that goes behind this dialog, the important activity being to set the &quot;dirty&quot; flag for the control when a particular component control is selected:</p>
<div style="FONT-FAMILY: courier new; BACKGROUND: white; COLOR: black; FONT-SIZE: 8pt">
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%; COLOR: blue">using</span><span style="LINE-HEIGHT: 140%"> System;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%; COLOR: blue">using</span><span style="LINE-HEIGHT: 140%"> System.Windows.Forms;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%; COLOR: blue">using</span><span style="LINE-HEIGHT: 140%"> Autodesk.AutoCAD.ApplicationServices;</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%; COLOR: blue">namespace</span><span style="LINE-HEIGHT: 140%"> OptionsDlg</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">{</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">public</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">partial</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">class</span><span style="LINE-HEIGHT: 140%"> </span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">UserControl1</span></span><span style="LINE-HEIGHT: 140%"> : </span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">UserControl</span></span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">public</span><span style="LINE-HEIGHT: 140%"> UserControl1()</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;InitializeComponent();</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; }</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">private</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">void</span><span style="LINE-HEIGHT: 140%"> button1_Click(</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;</span><span style="LINE-HEIGHT: 140%; COLOR: blue">object</span><span style="LINE-HEIGHT: 140%"> sender,</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;</span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">EventArgs</span></span><span style="LINE-HEIGHT: 140%"> e</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; )</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;</span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">TabbedDialogExtension</span></span><span style="LINE-HEIGHT: 140%">.SetDirty(</span><span style="LINE-HEIGHT: 140%; COLOR: blue">this</span><span style="LINE-HEIGHT: 140%">, </span><span style="LINE-HEIGHT: 140%; COLOR: blue">true</span><span style="LINE-HEIGHT: 140%">);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; }</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">private</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">void</span><span style="LINE-HEIGHT: 140%"> checkBox1_CheckedChanged(</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;</span><span style="LINE-HEIGHT: 140%; COLOR: blue">object</span><span style="LINE-HEIGHT: 140%"> sender,</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;</span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">EventArgs</span></span><span style="LINE-HEIGHT: 140%"> e</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; )</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;</span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">TabbedDialogExtension</span></span><span style="LINE-HEIGHT: 140%">.SetDirty(</span><span style="LINE-HEIGHT: 140%; COLOR: blue">this</span><span style="LINE-HEIGHT: 140%">, </span><span style="LINE-HEIGHT: 140%; COLOR: blue">true</span><span style="LINE-HEIGHT: 140%">);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; }</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">private</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">void</span><span style="LINE-HEIGHT: 140%"> comboBox1_SelectedIndexChanged(</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;</span><span style="LINE-HEIGHT: 140%; COLOR: blue">object</span><span style="LINE-HEIGHT: 140%"> sender,</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;</span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">EventArgs</span></span><span style="LINE-HEIGHT: 140%"> e</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; )</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;</span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">TabbedDialogExtension</span></span><span style="LINE-HEIGHT: 140%">.SetDirty(</span><span style="LINE-HEIGHT: 140%; COLOR: blue">this</span><span style="LINE-HEIGHT: 140%">, </span><span style="LINE-HEIGHT: 140%; COLOR: blue">true</span><span style="LINE-HEIGHT: 140%">);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">}</span></p></div>
<p>Now for our rest of the implementation. We&#39;re going to add our custom tab on load of the application (see <a href="http://through-the-interface.typepad.com/through_the_interface/2006/09/initialization_.html">these two</a> <a href="http://through-the-interface.typepad.com/through_the_interface/2006/09/optimizing_the_.html">previous posts</a> for the approach for running code on application load), so there&#39;s no need to implement a command. Here&#39;s the C# code:</p>
<div style="FONT-FAMILY: courier new; BACKGROUND: white; COLOR: black; FONT-SIZE: 8pt">
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%; COLOR: blue">using</span><span style="LINE-HEIGHT: 140%"> Autodesk.AutoCAD.Runtime;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%; COLOR: blue">using</span><span style="LINE-HEIGHT: 140%"> Autodesk.AutoCAD.ApplicationServices;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%; COLOR: blue">using</span><span style="LINE-HEIGHT: 140%"> Autodesk.AutoCAD.EditorInput;</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">[assembly:</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; </span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">ExtensionApplication</span></span><span style="LINE-HEIGHT: 140%">(</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">typeof</span><span style="LINE-HEIGHT: 140%">(OneNeedsOptions.</span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">Initialization</span></span><span style="LINE-HEIGHT: 140%">)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; )</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">]</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%; COLOR: blue">namespace</span><span style="LINE-HEIGHT: 140%"> OneNeedsOptions</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">{</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">class</span><span style="LINE-HEIGHT: 140%"> </span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">Initialization</span></span><span style="LINE-HEIGHT: 140%"> : </span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">IExtensionApplication</span></span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">static</span><span style="LINE-HEIGHT: 140%"> OptionsDlg.</span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">UserControl1</span></span><span style="LINE-HEIGHT: 140%"> _uc;</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">public</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">void</span><span style="LINE-HEIGHT: 140%"> Initialize()</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;</span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">Application</span></span><span style="LINE-HEIGHT: 140%">.DisplayingOptionDialog +=</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">new</span><span style="LINE-HEIGHT: 140%"> </span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">TabbedDialogEventHandler</span></span><span style="LINE-HEIGHT: 140%">(</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; Application_DisplayingOptionDialog</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; );</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; }</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">public</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">void</span><span style="LINE-HEIGHT: 140%"> Terminate()</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;</span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">Application</span></span><span style="LINE-HEIGHT: 140%">.DisplayingOptionDialog -=</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">new</span><span style="LINE-HEIGHT: 140%"> </span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">TabbedDialogEventHandler</span></span><span style="LINE-HEIGHT: 140%">(</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; Application_DisplayingOptionDialog</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; );</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; }</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">private</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">static</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">void</span><span style="LINE-HEIGHT: 140%"> ButtonPressedMessage(</span><span style="LINE-HEIGHT: 140%; COLOR: blue">string</span><span style="LINE-HEIGHT: 140%"> name)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;</span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">Editor</span></span><span style="LINE-HEIGHT: 140%"> ed =</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">Application</span></span><span style="LINE-HEIGHT: 140%">.DocumentManager.MdiActiveDocument.Editor;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;ed.WriteMessage(name + </span><span style="COLOR: #a31515"><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot; button pressed.\n&quot;</span></span><span style="LINE-HEIGHT: 140%">);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; }</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">private</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">static</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">void</span><span style="LINE-HEIGHT: 140%"> ShowSettings()</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;</span><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> (_uc != </span><span style="LINE-HEIGHT: 140%; COLOR: blue">null</span><span style="LINE-HEIGHT: 140%">)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;{</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">Editor</span></span><span style="LINE-HEIGHT: 140%"> ed =</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">Application</span></span><span style="LINE-HEIGHT: 140%">.DocumentManager.MdiActiveDocument.Editor;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; ed.WriteMessage(</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="COLOR: #a31515"><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;Settings were: checkbox contains {0},&quot;</span></span><span style="LINE-HEIGHT: 140%"> +</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="COLOR: #a31515"><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot; combobox contains {1}\n&quot;</span></span><span style="LINE-HEIGHT: 140%">,</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; _uc.checkBox1.Checked,</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; _uc.comboBox1.Text</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; );</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;}</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; }</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">private</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">static</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">void</span><span style="LINE-HEIGHT: 140%"> OnOK()</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;ButtonPressedMessage(</span><span style="COLOR: #a31515"><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;OK&quot;</span></span><span style="LINE-HEIGHT: 140%">);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;ShowSettings();</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; }</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">private</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">static</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">void</span><span style="LINE-HEIGHT: 140%"> OnCancel()</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;ButtonPressedMessage(</span><span style="COLOR: #a31515"><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;Cancel&quot;</span></span><span style="LINE-HEIGHT: 140%">);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; }</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">private</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">static</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">void</span><span style="LINE-HEIGHT: 140%"> OnHelp()</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;ButtonPressedMessage(</span><span style="COLOR: #a31515"><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;Help&quot;</span></span><span style="LINE-HEIGHT: 140%">);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; }</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">private</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">static</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">void</span><span style="LINE-HEIGHT: 140%"> OnApply()</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;ButtonPressedMessage(</span><span style="COLOR: #a31515"><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;Apply&quot;</span></span><span style="LINE-HEIGHT: 140%">);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;ShowSettings();</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; }</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">private</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">static</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">void</span><span style="LINE-HEIGHT: 140%"> Application_DisplayingOptionDialog(</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;</span><span style="LINE-HEIGHT: 140%; COLOR: blue">object</span><span style="LINE-HEIGHT: 140%"> sender,</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;</span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">TabbedDialogEventArgs</span></span><span style="LINE-HEIGHT: 140%"> e</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; )</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;</span><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> (_uc == </span><span style="LINE-HEIGHT: 140%; COLOR: blue">null</span><span style="LINE-HEIGHT: 140%">)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; _uc = </span><span style="LINE-HEIGHT: 140%; COLOR: blue">new</span><span style="LINE-HEIGHT: 140%"> OptionsDlg.</span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">UserControl1</span></span><span style="LINE-HEIGHT: 140%">();</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;</span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">TabbedDialogExtension</span><span style="LINE-HEIGHT: 140%"> tde =</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160; &#0160;</span><span style="LINE-HEIGHT: 140%; COLOR: blue">new</span><span style="LINE-HEIGHT: 140%"> </span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">TabbedDialogExtension</span></span><span style="LINE-HEIGHT: 140%">(</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; _uc,</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">new</span><span style="LINE-HEIGHT: 140%"> </span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">TabbedDialogAction</span></span><span style="LINE-HEIGHT: 140%">(OnOK),</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">new</span><span style="LINE-HEIGHT: 140%"> </span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">TabbedDialogAction</span></span><span style="LINE-HEIGHT: 140%">(OnCancel),</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">new</span><span style="LINE-HEIGHT: 140%"> </span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">TabbedDialogAction</span></span><span style="LINE-HEIGHT: 140%">(OnHelp),</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">new</span><span style="LINE-HEIGHT: 140%"> </span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">TabbedDialogAction</span></span><span style="LINE-HEIGHT: 140%">(OnApply)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; );</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;e.AddTab(</span><span style="COLOR: #a31515"><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;My Custom Settings&quot;</span></span><span style="LINE-HEIGHT: 140%">, tde);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">}</span></p></div>
<p>When we build the application, load it into AutoCAD and run the OPTIONS command, we should see our custom settings appear in our new tab:</p>
<p><a href="http://through-the-interface.typepad.com/through_the_interface/WindowsLiveWriter/A%20custom%20tab%20in%20AutoCAD&#39;s%20options%20dialog.png"><img alt="A custom tab in AutoCAD&#39;s options dialog" border="0" height="389" src="/assets/image_177753.jpg" style="BORDER-RIGHT-WIDTH: 0px; BORDER-TOP-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px" width="469" /></a> </p>
<p>As the various settings in the dialog get modified (even the button being clicked), you&#39;ll see the &quot;Apply&quot; button get enabled - a direct result of the settings on the control being considered &quot;dirty&quot;. As you select the various buttons belonging to the dialog you should see messages on the command-line, as the respective events get fired.</p>
<p>In the next post we&#39;ll extend this example to provide access to persistent properties, as you would want to do from a real application.</p>
