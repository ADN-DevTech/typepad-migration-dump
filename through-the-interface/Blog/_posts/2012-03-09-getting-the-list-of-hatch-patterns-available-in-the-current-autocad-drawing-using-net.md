---
layout: "post"
title: "Getting the list of hatch patterns available in the current AutoCAD drawing using .NET"
date: "2012-03-09 19:31:42"
author: "Kean Walmsley"
categories:
  - "AutoCAD"
  - "AutoCAD .NET"
  - "Drawing structure"
  - "User interface"
original_url: "https://www.keanw.com/2012/03/getting-the-list-of-hatch-patterns-available-in-the-current-autocad-drawing-using-net.html "
typepad_basename: "getting-the-list-of-hatch-patterns-available-in-the-current-autocad-drawing-using-net"
typepad_status: "Publish"
---

<p>This post was inspired by an email I saw from Philippe Leefsma, from DevTech EMEA, which made use of the Autodesk.AutoCAD.Windows.Data namespace – something I didn’t even know existed.</p>  <p>The specific example Philippe showed was how to access the list of hatch patterns available in the current drawing without iterating through the relevant dictionary in the named objects dictionary.</p>  <p>Here’s Philippe’s C# code:</p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.ApplicationServices;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.EditorInput;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.Runtime;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.Windows.Data;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">class</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">DataStuff</span></p>    <p style="margin: 0px"><span style="line-height: 140%">{</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; [</span><span style="line-height: 140%; color: #2b91af">CommandMethod</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: #a31515">&quot;HPS&quot;</span><span style="line-height: 140%">)]</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">static</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> GetHatchPatterns()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Editor</span><span style="line-height: 140%"> ed =</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Application</span><span style="line-height: 140%">.DocumentManager.MdiActiveDocument.Editor;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">foreach</span><span style="line-height: 140%"> (</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%"> str </span><span style="line-height: 140%; color: blue">in</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">HatchPatterns</span><span style="line-height: 140%">.Instance.AllPatterns)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</span><span style="line-height: 140%; color: #a31515">&quot;\n&quot;</span><span style="line-height: 140%"> + str);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">}</span></p> </div>  <p>When we run it, we see the following output at the command-line:</p>    <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%">Command: <font color="#ff0000">HPS</font></span></p>    <p style="margin: 0px"><span style="line-height: 140%">SOLID</span></p>    <p style="margin: 0px"><span style="line-height: 140%">ANGLE</span></p>    <p style="margin: 0px"><span style="line-height: 140%">ANSI31</span></p>    <p style="margin: 0px"><span style="line-height: 140%">ANSI32</span></p>    <p style="margin: 0px"><span style="line-height: 140%">ANSI33</span></p>    <p style="margin: 0px"><span style="line-height: 140%">ANSI34</span></p>    <p style="margin: 0px"><span style="line-height: 140%">ANSI35</span></p>    <p style="margin: 0px"><span style="line-height: 140%">ANSI36</span></p>    <p style="margin: 0px"><span style="line-height: 140%">ANSI37</span></p>    <p style="margin: 0px"><span style="line-height: 140%">ANSI38</span></p>    <p style="margin: 0px"><span style="line-height: 140%">AR-B816</span></p>    <p style="margin: 0px"><span style="line-height: 140%">AR-B816C</span></p>    <p style="margin: 0px"><span style="line-height: 140%">AR-B88</span></p>    <p style="margin: 0px"><span style="line-height: 140%">AR-BRELM</span></p>    <p style="margin: 0px"><span style="line-height: 140%">AR-BRSTD</span></p>    <p style="margin: 0px"><span style="line-height: 140%">AR-CONC</span></p>    <p style="margin: 0px"><span style="line-height: 140%">AR-HBONE</span></p>    <p style="margin: 0px"><span style="line-height: 140%">AR-PARQ1</span></p>    <p style="margin: 0px"><span style="line-height: 140%">AR-RROOF</span></p>    <p style="margin: 0px"><span style="line-height: 140%">AR-RSHKE</span></p>    <p style="margin: 0px"><span style="line-height: 140%">AR-SAND</span></p>    <p style="margin: 0px"><span style="line-height: 140%">BOX</span></p>    <p style="margin: 0px"><span style="line-height: 140%">BRASS</span></p>    <p style="margin: 0px"><span style="line-height: 140%">BRICK</span></p>    <p style="margin: 0px"><span style="line-height: 140%">BRSTONE</span></p>    <p style="margin: 0px"><span style="line-height: 140%">CLAY</span></p>    <p style="margin: 0px"><span style="line-height: 140%">CORK</span></p>    <p style="margin: 0px"><span style="line-height: 140%">CROSS</span></p>    <p style="margin: 0px"><span style="line-height: 140%">DASH</span></p>    <p style="margin: 0px"><span style="line-height: 140%">DOLMIT</span></p>    <p style="margin: 0px"><span style="line-height: 140%">DOTS</span></p>    <p style="margin: 0px"><span style="line-height: 140%">EARTH</span></p>    <p style="margin: 0px"><span style="line-height: 140%">ESCHER</span></p>    <p style="margin: 0px"><span style="line-height: 140%">FLEX</span></p>    <p style="margin: 0px"><span style="line-height: 140%">GOST_GLASS</span></p>    <p style="margin: 0px"><span style="line-height: 140%">GOST_GROUND</span></p>    <p style="margin: 0px"><span style="line-height: 140%">GOST_WOOD</span></p>    <p style="margin: 0px"><span style="line-height: 140%">GR_LINEAR</span></p>    <p style="margin: 0px"><span style="line-height: 140%">GR_CYLIN</span></p>    <p style="margin: 0px"><span style="line-height: 140%">GR_INVCYL</span></p>    <p style="margin: 0px"><span style="line-height: 140%">GR_SPHER</span></p>    <p style="margin: 0px"><span style="line-height: 140%">GR_HEMISP</span></p>    <p style="margin: 0px"><span style="line-height: 140%">GR_CURVED</span></p>    <p style="margin: 0px"><span style="line-height: 140%">GR_INVSPH</span></p>    <p style="margin: 0px"><span style="line-height: 140%">GR_INVHEM</span></p>    <p style="margin: 0px"><span style="line-height: 140%">GR_INVCUR</span></p>    <p style="margin: 0px"><span style="line-height: 140%">GRASS</span></p>    <p style="margin: 0px"><span style="line-height: 140%">GRATE</span></p>    <p style="margin: 0px"><span style="line-height: 140%">GRAVEL</span></p>    <p style="margin: 0px"><span style="line-height: 140%">HEX</span></p>    <p style="margin: 0px"><span style="line-height: 140%">HONEY</span></p>    <p style="margin: 0px"><span style="line-height: 140%">HOUND</span></p>    <p style="margin: 0px"><span style="line-height: 140%">INSUL</span></p>    <p style="margin: 0px"><span style="line-height: 140%">ACAD_ISO02W100</span></p>    <p style="margin: 0px"><span style="line-height: 140%">ACAD_ISO03W100</span></p>    <p style="margin: 0px"><span style="line-height: 140%">ACAD_ISO04W100</span></p>    <p style="margin: 0px"><span style="line-height: 140%">ACAD_ISO05W100</span></p>    <p style="margin: 0px"><span style="line-height: 140%">ACAD_ISO06W100</span></p>    <p style="margin: 0px"><span style="line-height: 140%">ACAD_ISO07W100</span></p>    <p style="margin: 0px"><span style="line-height: 140%">ACAD_ISO08W100</span></p>    <p style="margin: 0px"><span style="line-height: 140%">ACAD_ISO09W100</span></p>    <p style="margin: 0px"><span style="line-height: 140%">ACAD_ISO10W100</span></p>    <p style="margin: 0px"><span style="line-height: 140%">ACAD_ISO11W100</span></p>    <p style="margin: 0px"><span style="line-height: 140%">ACAD_ISO12W100</span></p>    <p style="margin: 0px"><span style="line-height: 140%">ACAD_ISO13W100</span></p>    <p style="margin: 0px"><span style="line-height: 140%">ACAD_ISO14W100</span></p>    <p style="margin: 0px"><span style="line-height: 140%">ACAD_ISO15W100</span></p>    <p style="margin: 0px"><span style="line-height: 140%">LINE</span></p>    <p style="margin: 0px"><span style="line-height: 140%">MUDST</span></p>    <p style="margin: 0px"><span style="line-height: 140%">NET</span></p>    <p style="margin: 0px"><span style="line-height: 140%">NET3</span></p>    <p style="margin: 0px"><span style="line-height: 140%">PLAST</span></p>    <p style="margin: 0px"><span style="line-height: 140%">PLASTI</span></p>    <p style="margin: 0px"><span style="line-height: 140%">SACNCR</span></p>    <p style="margin: 0px"><span style="line-height: 140%">SQUARE</span></p>    <p style="margin: 0px"><span style="line-height: 140%">STARS</span></p>    <p style="margin: 0px"><span style="line-height: 140%">STEEL</span></p>    <p style="margin: 0px"><span style="line-height: 140%">SWAMP</span></p>    <p style="margin: 0px"><span style="line-height: 140%">TRANS</span></p>    <p style="margin: 0px"><span style="line-height: 140%">TRIANG</span></p>    <p style="margin: 0px"><span style="line-height: 140%">ZIGZAG</span></p>    <p style="margin: 0px"><span style="line-height: 140%">USER</span></p> </div>    <p>I was curious about this namespace and so asked around to find out more about its origins. Apparently it was introduced to provide simplified access to data that needs to be displayed in the AutoCAD user interface: we expose this data through Autodesk.AutoCAD.Windows.Data to make it simpler to implement the ribbon without having to iterate database objects there directly. What’s nice is the data changes when the connected database does: whether relevant items are added to, edited in or removed from the database, or the user changes the currently active drawing in the editor, the data made accessible is adjusted accordingly.</p>  <p>This capability is known internally as the BOL or Bindable Object Layer. Cool stuff.</p>  <p>At this stage, I didn’t find a way to access other data from this namespace: HatchPatterns is the only class with a static Instance property that provides access to it. There is a very interesting DataBindings class, that appears to provide access to the data in the rest of the namespace, but I so far have been unable to find a way to instantiate (or retrieve an existing instance of it).</p>
