---
layout: "post"
title: "A new project wizard for AutoCAD .NET development"
date: "2009-06-17 08:09:58"
author: "Kean Walmsley"
categories:
  - "AutoCAD"
  - "AutoCAD .NET"
  - "Commands"
  - "Runtime"
original_url: "https://www.keanw.com/2009/06/a-new-project-wizard-for-autocad-net-development.html "
typepad_basename: "a-new-project-wizard-for-autocad-net-development"
typepad_status: "Publish"
---

<p>Some of you may remember <a href="http://through-the-interface.typepad.com/through_the_interface/2009/02/wizards-vs-code-samples.html">a philosophical question I raised in a post some time ago</a>. The overall consensus of the feedback we received was to prioritise delivering code samples (given a choice between code samples and wizard-like code-generation tools). Which we are doing, both via the ADN site and our developer blogs… but that doesn’t mean some investment in code-generation tools isn’t also appropriate, from time-to-time. :-)</p>  <p>Cyrille Fauvel, who manages the Media &amp; Entertainment arm of DevTech but also occasionally works on technical activities that relate to our other products, has put together <a href="http://download.autodesk.com/media/adn/AutoCAD_2010_dotNET_Wizards.zip">a new (currently draft) version of the AutoCAD .NET Wizard</a>. This tool integrates with the Visual Studio 2008 IDE (as well as the 2008 editions of Visual C# Express and Visual Basic Express), adding C#/VB.NET project templates for AutoCAD development. (This version of the tool only works with the 2008 versions – we’re currently evaluating whether (and how) to support the 2005 versions of Visual Studio [Express] or simply to recommend using <a href="http://through-the-interface.typepad.com/through_the_interface/2007/01/managed_applica.html">our previously posted templates</a>.)</p>  <p>When you select one of these “Autodesk” project templates you will get a skeleton project that defines the <a href="http://through-the-interface.typepad.com/through_the_interface/2006/09/optimizing_the_.html">application initialization protocol</a> plus a few placeholder commands while setting up the ability to <a href="http://through-the-interface.typepad.com/through_the_interface/2009/06/registering-autocad-commands-with-localized-names-using-net.html">define localized commands</a>.</p>  <p>Here are a few images stepping you through the installation of this Wizard (nothing very surprising, which is why I’ve kept the thumbnails so small :-):</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e20115711cf2f4970b-pi"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="AutoCAD 2010 NET Wizards install" border="0" alt="AutoCAD 2010 NET Wizards install" src="/assets/image_53526.jpg" width="84" height="70" /></a> <a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201157027be57970c-pi"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="AutoCAD 2010 NET Wizards install location" border="0" alt="AutoCAD 2010 NET Wizards install location" src="/assets/image_115484.jpg" width="84" height="70" /></a> <a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201157027be66970c-pi"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="AutoCAD 2010 NET Wizards install confirmation" border="0" alt="AutoCAD 2010 NET Wizards install confirmation" src="/assets/image_983937.jpg" width="84" height="70" /></a> <a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e20115711cf30b970b-pi"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="AutoCAD 2010 NET Wizards install progress" border="0" alt="AutoCAD 2010 NET Wizards install progress" src="/assets/image_203724.jpg" width="84" height="70" /></a> <a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201157027be7a970c-pi"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="AutoCAD 2010 NET Wizards install complete" border="0" alt="AutoCAD 2010 NET Wizards install complete" src="/assets/image_969304.jpg" width="84" height="70" /></a> </p>  <p>[Note: the current installer requests an install location, which is unnecessary. The installer only uses this location for temporary files, removing them afterwards. This step will be removed from a future build of the tool.]</p>  <p>Once installed (and Visual Studio 2008 has been re-started), you will get some new options when you start a new project…</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201157027be8b970c-pi"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="AutoCAD 2010 NET Wizards new project menu item" border="0" alt="AutoCAD 2010 NET Wizards new project menu item" src="/assets/image_76996.jpg" width="240" height="192" /></a> </p>  <p>… that include the “AutoCAD 2010 plug-in” project template:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e20115711cf32a970b-pi"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="AutoCAD 2010 NET Wizards new project template" border="0" alt="AutoCAD 2010 NET Wizards new project template" src="/assets/image_921682.jpg" width="468" height="333" /></a></p>  <p>We’ve numbered these templates “2010”, as they provide support for API features delivered with AutoCAD 2010, but if you don’t select these features the created project should work with older versions of AutoCAD. At least that’s the theory. :-)</p>  <p>When you first select one of these project types, you will be asked to select the location of your ObjectARX SDK:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e20115711cf339970b-pi"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="AutoCAD 2010 NET Wizards configurator" border="0" alt="AutoCAD 2010 NET Wizards configurator" src="/assets/image_305182.jpg" width="304" height="213" /></a> </p>  <p>You should specify this along with the assemblies you would like to reference for this particular project:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201157027bea9970c-pi"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="AutoCAD 2010 NET Wizards configurated" border="0" alt="AutoCAD 2010 NET Wizards configurated" src="/assets/image_774244.jpg" width="304" height="213" /></a> </p>  <p>On completion of this dialog your skeleton project will be created.</p>  <p>[Something else to note: the tool currently creates projects which allow addition of Windows Presentation Foundation content – to do this we had to add a little piece of XML to the project file that specifies a target .NET Framework version of 3.0 or above as well as a GUID to identify the project as WPF-compatible. This tells Visual Studio to list WPF item-types when you add new items to the project, but I expect this to become another configuration option in a future version as some developers will want to target framework versions where WPF is unavailable.]</p>  <p>Let’s take a look at the skeleton code created for a C# project, reformatted to fit the width of the blog…</p>  <p>First the myPlugin.cs file:</p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> System;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.Runtime;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.ApplicationServices;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.DatabaseServices;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.Geometry;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.EditorInput;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">// This line is not mandatory, but improves loading performance</span></p>    <p style="margin: 0px"><span style="line-height: 140%">[</span><span style="line-height: 140%; color: blue">assembly</span><span style="line-height: 140%">: </span><span style="line-height: 140%; color: #2b91af">ExtensionApplication</span><span style="line-height: 140%">(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">typeof</span><span style="line-height: 140%">(Autodesk.AutoCAD.AutoCAD_2010_plug_in1.</span><span style="line-height: 140%; color: #2b91af">MyPlugin</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">)]</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">namespace</span><span style="line-height: 140%"> Autodesk.AutoCAD.AutoCAD_2010_plug_in1</span></p>    <p style="margin: 0px"><span style="line-height: 140%">{</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: green">// This class is instantiated by AutoCAD once and kept alive for </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: green">// the duration of the session. If you don't do any one time </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: green">// initialization then you should remove this class.</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">class</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">MyPlugin</span><span style="line-height: 140%"> : </span><span style="line-height: 140%; color: #2b91af">IExtensionApplication</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; {</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">IExtensionApplication</span><span style="line-height: 140%">.Initialize()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// Add one time initialization here</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// One common scenario is to setup a callback function here</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// that unmanaged code can call. </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// To do this:</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// 1. Export a function from unmanaged code that takes a</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">//&#160;&#160;&#160; function pointer and stores the passed in value in a</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">//&#160;&#160;&#160; global variable.</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// 2. Call this exported function in this function passing</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">//&#160;&#160;&#160; delegate.</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// 3. When unmanaged code needs the services of this managed</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">//&#160;&#160;&#160; module you simply call acrxLoadApp() and by the time</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">//&#160;&#160;&#160; acrxLoadApp returns&#160; global function pointer is</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">//&#160;&#160;&#160; initialized to point to the C# delegate.</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// For more info see: </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">//http://msdn2.microsoft.com/en-US/library/5zwkzwf4(VS.80).aspx</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">//http://msdn2.microsoft.com/en-us/library/44ey4b32(VS.80).aspx</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">//http://msdn2.microsoft.com/en-US/library/7esfatk4.aspx</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// as well as some of the existing AutoCAD managed apps.</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// Initialize your plug-in application here</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">IExtensionApplication</span><span style="line-height: 140%">.Terminate()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// Do plug-in application clean up here</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">}</span></p> </div> <!--EndFragment-->  <p>And now the myCommands.cs file:</p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> System;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.Runtime;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.ApplicationServices;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.DatabaseServices;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.Geometry;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.EditorInput;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">// This line is not mandatory, but improves loading performances</span></p>    <p style="margin: 0px"><span style="line-height: 140%">[</span><span style="line-height: 140%; color: blue">assembly</span><span style="line-height: 140%">: </span><span style="line-height: 140%; color: #2b91af">CommandClass</span><span style="line-height: 140%">(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">typeof</span><span style="line-height: 140%">(Autodesk.AutoCAD.AutoCAD_2010_plug_in1.</span><span style="line-height: 140%; color: #2b91af">MyCommands</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">)]</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">namespace</span><span style="line-height: 140%"> Autodesk.AutoCAD.AutoCAD_2010_plug_in1</span></p>    <p style="margin: 0px"><span style="line-height: 140%">{</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: green">// This class is instantiated by AutoCAD for each document when</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: green">// a command is called by the user the first time in the context</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: green">// of a given document. In other words, non static data in this</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: green">// class is implicitly per-document!</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">class</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">MyCommands</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// The CommandMethod attribute can be applied to any public</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// member function of any public class.</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// The function should take no arguments and return nothing.</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// If the method is an intance member then the enclosing class is </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// intantiated for each document. If the member is a static</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// member then the enclosing class is NOT intantiated.</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">//</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// NOTE: CommandMethod has overloads where you can provide helpid</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// and context menu.</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// Modal Command with localized name</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; [</span><span style="line-height: 140%; color: #2b91af">CommandMethod</span><span style="line-height: 140%">(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;MyGroup&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;MyCommand&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;MyCommandLocal&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #2b91af">CommandFlags</span><span style="line-height: 140%">.Modal</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; )]</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> MyCommand() </span><span style="line-height: 140%; color: green">// This method can have any name</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// Put your command code here</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// Modal Command with pickfirst selection</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; [</span><span style="line-height: 140%; color: #2b91af">CommandMethod</span><span style="line-height: 140%">(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;MyGroup&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;MyPickFirst&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;MyPickFirstLocal&quot;</span><span style="line-height: 140%">,</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">CommandFlags</span><span style="line-height: 140%">.Modal | </span><span style="line-height: 140%; color: #2b91af">CommandFlags</span><span style="line-height: 140%">.UsePickSet</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; )]</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> MyPickFirst() </span><span style="line-height: 140%; color: green">// This method can have any name</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">PromptSelectionResult</span><span style="line-height: 140%"> result =</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Application</span><span style="line-height: 140%">.DocumentManager.MdiActiveDocument.Editor.</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; SelectImplied();</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (result.Status == </span><span style="line-height: 140%; color: #2b91af">PromptStatus</span><span style="line-height: 140%">.OK)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// There are selected entities</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// Put your command using pickfirst set code here</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">else</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// There are no selected entities</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// Put your command code here</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// Application Session Command with localized name</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; [</span><span style="line-height: 140%; color: #2b91af">CommandMethod</span><span style="line-height: 140%">(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;MyGroup&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;MySessionCmd&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;MySessionCmdLocal&quot;</span><span style="line-height: 140%">,</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">CommandFlags</span><span style="line-height: 140%">.Modal | </span><span style="line-height: 140%; color: #2b91af">CommandFlags</span><span style="line-height: 140%">.Session</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; )]</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> MySessionCmd() </span><span style="line-height: 140%; color: green">// This method can have any name</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// Put your command code here</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// LispFunction is similar to CommandMethod but it creates a </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// lisp callable function. Many return types are supported not</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// just string or integer.</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; [</span><span style="line-height: 140%; color: #2b91af">LispFunction</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: #a31515">&quot;MyLispFunction&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;MyLispFunctionLocal&quot;</span><span style="line-height: 140%">)]</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">int</span><span style="line-height: 140%"> MyLispFunction(</span><span style="line-height: 140%; color: #2b91af">ResultBuffer</span><span style="line-height: 140%"> args)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// This method can have any name</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// Put your command code here</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// Return a value to the AutoCAD Lisp Interpreter</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> 1;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">}</span></p> </div>  <p>The myCommands.resx file needed to define the local command names (for the MySessionCmd command) has also been added to the project automatically to help with command localization.</p>  <p>All well and good… but it may be that these project templates don’t quite fit your internal needs, whether due to the copyright notices in the source and assembly properties [something I do expect to be removed from a future build – it doesn’t make sense for Autodesk copyright notices to be placed in your project skeleton] or because you have a standard approach you’ve adopted for command registration (or whatever). The good news is that it’s pretty easy for you to modify these baseline templates for your own needs:</p>  <ol>   <li>Locate the template you wish to update, e.g. “C:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE\ProjectTemplates\CSharp\Autodesk\AutoCAD 2010 plug-in.zip” (this path will vary if you’re running on a 64-bit or localized OS or if you’re using an Express version of Visual Studio, but the technique should still work). </li>    <li>Unzip the files somewhere. </li>    <li>Modify the source code and project setup to meet your needs. </li>    <li>Modify the template file (MyTemplate.vstemplate – an XML file providing Visual Studio with additional information not stored in the project), as needed. </li>    <li>ZIP the files back up, choosing a new name for the .ZIP archive. </li>    <li>Post the file within the ProjectTemplates folder structure. </li>    <li>Run Visual Studio with the /InstallVSTemplates command parameter (the easiest way is to open a “Visual Studio 2008 Command Prompt” and use it to execute “devenv /InstallVSTemplates”). </li> </ol>  <p>As mentioned a few times, I do expect us to provide a new version of this tool with some minor wrinkles ironed out, but it’s pretty much ready-to-go (and certainly ready for people to try out and respond with their feedback :-). Please let us know how you get on, whether by posting a comment or by <a href="mailto:oarxwiz-feedback@autodesk.com">emailing our wizard developers</a>.</p>
