---
layout: "post"
title: "More Capturefinery enhancements"
date: "2019-05-29 13:58:33"
author: "Kean Walmsley"
categories:
  - "Autodesk Research"
  - "Dynamo"
  - "Generative design"
original_url: "https://www.keanw.com/2019/05/more-capturefinery-enhancements.html "
typepad_basename: "more-capturefinery-enhancements"
typepad_status: "Publish"
---

<p>I’m happy to announce that the <a href="https://www.keanw.com/2019/05/introducing-capturefinery-a-dynamo-package-that-creates-presentation-graphics-for-refinery-studies.html" target="_blank">Capturefinery package for Dynamo (and Refinery)</a> is finally ready for posting to the package manager! My main misgivings – stopping me from posting it sooner – had been around the basic UX (fixed in <a href="https://www.keanw.com/2019/05/capturefinery-updated-to-help-track-down-errors.html" target="_blank">the last update</a>) and the fact that the tool requires (or required) the system to basically be dedicated to the capture operation. These have all now been addressed.</p><p><a href="https://through-the-interface.typepad.com/.a/6a00d83452464869e20240a46111d4200c-pi" target="_blank"><img width="498" height="375" title="Latest Capturefinery UI" style="margin: 30px auto; border-image: none; float: none; display: block; background-image: none;" alt="Latest Capturefinery UI" src="/assets/image_448570.jpg" border="0"></a></p><p>Here are the enhancements I made today:</p><ul><li>The graphics are now captured via the Dynamo API, rather than via the OS (i.e. the screen)</li><ul><li>This means you can keep Dynamo minimised and work on other things</li><li>It also doesn’t care about notifications, etc.</li><li>Thanks to Simon Breslav for this suggestion!</li></ul><li>You can choose via the UI whether to create animations or not</li><ul><li>This is useful when performing multiple partial runs that will be assembled into a single animation (see below)</li></ul><li>You can choose to load existing images – from previous runs – when creating animations</li><ul><li>The individual frames are named using their index in the sequence, so the tool will pre-load images with smaller indices and post-load images with larger ones</li></ul><li>The tool now checks for use of Escape during execution</li><ul><li>The user can more easily (i.e. without killing the Dynamo process) cancel a capture operation</li><li>This is currently global, so may be triggered by the use of Escape when using other applications while Capturefinery runs in the background</li></ul></ul><p>I also tried it out with the background colour set to pure white by editing the <em>%ProgramFiles%\Dynamo\Dynamo Core\2\UI\Themes\Modern\DynamoColorsAndBrushes.xaml</em> file, as suggested by <a href="https://forum.dynamobim.com/t/background-3d-node-connector-colours/5788" target="_blank">this forum post</a>. (I changed both <font face="Courier New">WorkspaceBackgroundHome</font> and <font face="Courier New">WorkspaceBackgroundCustom</font> to <font face="Courier New">#FFFFFF</font>.) This makes a big difference to the quality of the animation – especially for the smaller images that have been resized and squashed into the GIF format’s 256 colour-space.</p><p>Here’s a sample animation generated by the latest version tool, to give you some idea of the results. I created this one from 4 separate runs, to make sure it all works. (I did post-process the generated file using GIMP to make the frames display for 300ms each, mind.)</p><p><a href="https://through-the-interface.typepad.com/.a/6a00d83452464869e20240a48a6bd3200d-pi" target="_blank"><img width="500" height="283" title="The smallest size - ideal for social media" style="margin: 30px auto; float: none; display: block;" alt="The smallest size - ideal for social media" src="/assets/image_795650.jpg"></a></p><p>I actually like the fact it strips off the Dynamo UI and focuses on the generated graphics rather than including the Dynamo graph. Although that’s also accessible… we could add an option to include the graph, too, if people want that.</p><p>I still need to document the tool’s usage and tidy things up a bit before posting, but I expect to do that sometime next week. (We’re starting the long <a href="https://en.wikipedia.org/wiki/Feast_of_the_Ascension" target="_blank">Ascension</a> weekend, here in continental Europe, so I won’t be looking at this until I’m back and have finished up my AU London preparation, as the presentation material is due on June 5th.)</p><p>If you’re impatient to give it a try, please feel free to clone <a href="https://github.com/KeanW/Capturefinery" target="_blank">the Git repo</a> and build it using Visual Studio, in the meantime.</p>
