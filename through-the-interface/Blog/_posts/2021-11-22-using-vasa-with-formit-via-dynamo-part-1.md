---
layout: "post"
title: "Using VASA with FormIt via Dynamo &ndash; Part 1"
date: "2021-11-22 14:04:00"
author: "Kean Walmsley"
categories:
  - "Autodesk"
  - "Autodesk Research"
  - "Dynamo"
  - "FormIt"
  - "VASA"
original_url: "https://www.keanw.com/2021/11/using-vasa-with-formit-via-dynamo-part-1.html "
typepad_basename: "using-vasa-with-formit-via-dynamo-part-1"
typepad_status: "Publish"
---

<p>In <a href="https://www.keanw.com/2021/11/autodesk-formit-and-its-javascript-api.html" target="_blank">this recent post</a> we looked at FormIt’s JavaScript API and learned how Brett Garrison was able to use it to develop a Maze Generator plugin. In this post we look at one way to find solutions for the mazes generated by this plugin using VASA from Dynamo.</p><p>When I first started looking into VASA with FormIt, Rhys Goldstein sent across a Dynamo graph he’d used to grab contextual building geometry from FormIt – to create a voxel model of the space – and then send the pathfinding results back afterwards. I’ve <a href="https://through-the-interface.typepad.com/files/VASA-Formit-Amazing.dyn" target="_blank">adapted this graph to work with the results of the Maze Generator plugin</a>.</p><p><a href="https://through-the-interface.typepad.com/.a/6a00d83452464869e2026bdf00ce24200c-pi" target="_blank"><img alt="Dynamo graph to use VASA with FormIt" border="0" height="150" src="/assets/image_244308.jpg" style="margin: 30px auto; border: 0px currentcolor; border-image: none; float: none; display: block; background-image: none;" title="Dynamo graph to use VASA with FormIt" width="500" /></a></p><p>To get started with this, we need to install the plugin (something we saw in <a href="https://www.keanw.com/2021/11/autodesk-formit-and-its-javascript-api.html" target="_blank">the previous post in the series</a>) and then generate a maze with the settings of our choice. These settings will need to be transferred manually into the Dynamo graph if you change them from the defaults.</p><p>You can use FormIt for Web to created the graph – as the Maze Generator plugin will work there – but to work with Dynamo you’ll need to load the sketch (or run the plugin directly) in FormIt for Windows.</p><p><a href="https://through-the-interface.typepad.com/.a/6a00d83452464869e2026bdf00ccf4200c-pi" target="_blank"><img alt="Generate a maze using the FormIt plugin" border="0" height="312" src="/assets/image_230362.jpg" style="margin: 30px auto; border: 0px currentcolor; border-image: none; float: none; display: block; background-image: none;" title="Generate a maze using the FormIt plugin" width="500" /></a></p><p>To launch the Dynamo graph, you’ll probably need to save it in a known location and then connect to that location via the “Link Dynamo Directory” button at the top-left of the Dynamo panel inside FormIt for Windows. You can then open the graph inside Dynamo via the pull-down on the graph.</p><p><a href="https://through-the-interface.typepad.com/.a/6a00d83452464869e2026bdf00cd0e200c-pi" target="_blank"><img alt="Launch Dynamo from FormIt, using the provided graph" border="0" height="312" src="/assets/image_281897.jpg" style="margin: 30px auto; border: 0px currentcolor; border-image: none; float: none; display: block; background-image: none;" title="Launch Dynamo from FormIt, using the provided graph" width="500" /></a></p><p>When it first loads you’ll see warnings: this is completely expected, as you haven’t yet selected geometry inside FormIt. To do so, you’ll need to click on the “Select from FormIt” node. </p><p><a href="https://through-the-interface.typepad.com/.a/6a00d83452464869e202788058a7fd200d-pi" target="_blank"><img alt="Warnings are normal at this stage" border="0" height="312" src="/assets/image_328568.jpg" style="margin: 30px auto; border: 0px currentcolor; border-image: none; float: none; display: block; background-image: none;" title="Warnings are normal at this stage" width="500" /></a></p><p>At which point you should have the prompt inside FormIt to select maze geometry. I tend to use window-select for this.</p><p><a href="https://through-the-interface.typepad.com/.a/6a00d83452464869e202788058a81a200d-pi" target="_blank"><img alt="After clicking on the Select from FormIt button, window select geometry inside FormIt" border="0" height="312" src="/assets/image_524748.jpg" style="margin: 30px auto; border: 0px currentcolor; border-image: none; float: none; display: block; background-image: none;" title="After clicking on the Select from FormIt button, window select geometry inside FormIt" width="500" /></a></p><p>After clicking the tick (or the checkmark) you should at least start to see maze geometry inside FormIt. If you’re lucky – and the settings don’t need changing – then it will hopefully already show a path, otherwise you’ll need to tweak the settings to match the ones specified in the UI for the Maze Generator.</p><p><a href="https://through-the-interface.typepad.com/.a/6a00d83452464869e20282e1312789200b-pi" target="_blank"><img alt="Make sure the settings match those used to generate the maze" border="0" height="312" src="/assets/image_14727.jpg" style="margin: 30px auto; border: 0px currentcolor; border-image: none; float: none; display: block; background-image: none;" title="Make sure the settings match those used to generate the maze" width="500" /></a></p><p>At this point you should have a path shown in red.</p><p><a href="https://through-the-interface.typepad.com/.a/6a00d83452464869e20282e1312792200b-pi" target="_blank"><img alt="Hopefully at this point the graph runs" border="0" height="312" src="/assets/image_340415.jpg" style="margin: 30px auto; border: 0px currentcolor; border-image: none; float: none; display: block; background-image: none;" title="Hopefully at this point the graph runs" width="500" /></a></p><p>You can see it clearly by switching to the geometry view.</p><p><a href="https://through-the-interface.typepad.com/.a/6a00d83452464869e202788058a840200d-pi" target="_blank"><img alt="We should have path geometry" border="0" height="312" src="/assets/image_248754.jpg" style="margin: 30px auto; border: 0px currentcolor; border-image: none; float: none; display: block; background-image: none;" title="We should have path geometry" width="500" /></a></p><p>Sometimes the path geometry – for me, anyway – doesn’t show up automatically inside FormIt, which may very well be a quirk of using it inside a Parallels VM on my Mac. In any case, clicking the Dynamo graph should cause it to run again and the “Send to FormIt” node to execute.</p><p><a href="https://through-the-interface.typepad.com/.a/6a00d83452464869e20282e13127a8200b-pi" target="_blank"><img alt="Sometimes you need to click the Dynamo button once more to get the geometry across" border="0" height="312" src="/assets/image_873864.jpg" style="margin: 30px auto; border: 0px currentcolor; border-image: none; float: none; display: block; background-image: none;" title="Sometimes you need to click the Dynamo button once more to get the geometry across" width="500" /></a></p><p>At which point selecting the origin will bring the path geometry into FormIt so that it matches the maze geometry. And solves it!</p><p><a href="https://through-the-interface.typepad.com/.a/6a00d83452464869e202788058a80e200d-pi" target="_blank"><img alt="If so, place it at the origin" border="0" height="312" src="/assets/image_797756.jpg" style="margin: 30px auto; border: 0px currentcolor; border-image: none; float: none; display: block; background-image: none;" title="If so, place it at the origin" width="500" /></a></p><p><a href="https://youtu.be/d28Im-CLeJI" target="_blank">Here’s a video</a> showing the full process (slightly sped up):</p><p style="text-align: center"><br /></p><p style="text-align: center"><iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="" frameborder="0" height="283" src="https://www.youtube.com/embed/d28Im-CLeJI" title="YouTube video player" width="500"></iframe></p><p style="text-align: center"><br /></p><p>It’s worth noting that it’s important to use the right voxel resolution for your geometry: when I first ran the Dynamo graph it was using 16 times as many voxels as required, and it therefore took much longer to execute than expected. The video in <a href="https://www.keanw.com/2021/11/a-video-on-pathfinding-with-vasa.html" target="_blank">this recent post</a> talks in depth about how to change these resolution settings, so be sure to check it out if you’re experiencing performance issues with VASA.</p><p>That video also showed the scenario where we work with 2D geometry: I’ve chosen to keep the voxelization and pathfinding in 3D, despite the maze-solving problem being fundamentally 2D in nature. In the next part of this 2-part series we’ll take a look at how we can use 2D pathfinding with geometry generated by <a href="https://formit.autodesk.com/blog/post/3d-context-in-formit/" target="_blank">matterlab’s excellent 3D Context Creator plugin</a>. In the post after that we’ll come back to solving mazes, taking a quick look at how it’s possible to call VASA from WebAssembly directly from a plugin (although as the WASM package for VASA hasn’t yet been published, this is more for reference or context than for people to be able to try themselves, for now).</p>
