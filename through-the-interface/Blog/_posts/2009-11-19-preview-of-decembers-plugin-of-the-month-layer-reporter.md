---
layout: "post"
title: "Preview of December&rsquo;s Plugin of the Month: Layer Reporter"
date: "2009-11-19 17:03:03"
author: "Kean Walmsley"
categories:
  - "AutoCAD"
  - "AutoCAD .NET"
  - "Drawing structure"
  - "Plugin of the Month"
  - "User interface"
original_url: "https://www.keanw.com/2009/11/preview-of-decembers-plugin-of-the-month-layer-reporter.html "
typepad_basename: "preview-of-decembers-plugin-of-the-month-layer-reporter"
typepad_status: "Publish"
---

<p>I feel like I’m posting a lot about our Plugin of the Month initiative, at the moment, but then I suppose it’s to some degree a function of what I’m spending time on. It’s definitely eating into the time I would normally focus on blogging… after a number of AU-related posts coming out over the next few weeks (as I finish my AU prep next week and then blog from the event the week after) I’d hope to return to somewhat more typical posts in December (although as I’m going on to Japan, Korea and China from Las Vegas, this might be a bit optimistic).</p>  <p>Anyway, I thought it was a good time to unveil December’s plugin, a tool donated by our old friend Terry Dotson. Terry’s company, <a href="http://www.dotsoft.com">DotSoft</a>, has been a member of the <a href="http://www.autodesk.com/joinadn">Autodesk Developer Network</a> since 1992 (since before it was even called ADN, in fact :-). I’ve spent a little time changing variable names and reformatting the code to be consistent with this blog, but the techniques shown are very much Terry’s.</p>  <p>I really like this tool: it makes heavy use of the WinForms web browser control (System.Windows.Forms.WebBrowser) to display a report generated from the contents of the active drawing’s layer table. The application generates HTML based on the layers in the drawing and then saves it to a temporary folder before loading it into the browser control. The original implementation just set the DocumentText of the browser, but we found this limited the formats the control could save to (more on this feature in a moment). Once the report is displayed the user can customize the font and font-size as well as the choice of which columns to include in the report. These settings get saved by the application, so if you wish to generate reports for multiple drawings there’s not need to make the changes each time. Once the report looks right you can save it to file – whether to a web archive (.MHT), complete or simple web pages (.HTM) or to a plain text file (.TXT) – or print it.</p>  <p>Here’s an example of the results of the REPORTLAYERS command on a blank drawing:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2012875b83354970c-pi"><img alt="Basic Layer Report" border="0" height="158" src="/assets/image_644668.jpg" style="border-right-width: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto" title="Basic Layer Report" width="471" /></a> </p>  <p>Now let’s run it on a more complex drawing with more layers, and adjust the settings to suit our particular needs:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2012875b8336c970c-pi"><img alt="Fancier Layer Report" border="0" height="454" src="/assets/image_583929.jpg" style="border-right-width: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto" title="Fancier Layer Report" width="473" /></a> </p>  <p>We can save the report…</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e20120a6b66a44970b-pi"><img alt="Save dialog for our Layer Report" border="0" height="280" src="/assets/image_897945.jpg" style="border-right-width: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto" title="Save dialog for our Layer Report" width="351" /></a> </p>  <p>We can configure its page setup…</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2012875b8338a970c-pi"><img alt="Page setup for our Layer Report" border="0" height="281" src="/assets/image_882568.jpg" style="border-right-width: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto" title="Page setup for our Layer Report" width="345" /></a> </p>  <p>Preview the print session…</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2012875b833c4970c-pi"><img alt="Print preview of our Layer Report" border="0" height="482" src="/assets/image_223612.jpg" style="border-right-width: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto" title="Print preview of our Layer Report" width="449" /></a> </p>  <p>Or just go ahead and print it directly…</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e20120a6b66a86970b-pi"><img alt="Print dialog for our Layer Report" border="0" height="289" src="/assets/image_371593.jpg" style="border-right-width: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; margin-left: auto; border-left-width: 0px; margin-right: auto" title="Print dialog for our Layer Report" width="321" /></a></p>  <br />  <p>Now for the code. The application was written in VB.NET (which is great, as it gives us – so far – a monthly alternation between C# and VB). You can <span class="asset asset-generic at-xid-6a00d83452464869e20120a6b66c6f970b"><a href="http://through-the-interface.typepad.com/files/layerreporter.zip">download a preview version of the tool with source code here.</a></span></p>  <p>Here’s the main “code behind” the Report class, which does the bulk of the work:</p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%; color: blue">Imports</span><span style="line-height: 140%"> Autodesk.AutoCAD.DatabaseServices</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%; color: blue">Imports</span><span style="line-height: 140%"> Autodesk.AutoCAD.ApplicationServices</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%; color: blue">Imports</span><span style="line-height: 140%"> Autodesk.AutoCAD.Colors</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%; color: blue">Imports</span><span style="line-height: 140%"> System.Text</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%; color: blue">Imports</span><span style="line-height: 140%"> System.Drawing</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%; color: blue">Public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Class</span><span style="line-height: 140%"> Report</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: blue">Private</span><span style="line-height: 140%"> _init </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Boolean</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: blue">Private</span><span style="line-height: 140%"> _bmps </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">New</span><span style="line-height: 140%"> Dictionary(</span><span style="line-height: 140%; color: blue">Of</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">String</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: blue">String</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: blue">Private</span><span style="line-height: 140%"> _tmpHtm </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">String</span><span style="line-height: 140%"> = </span><span style="line-height: 140%; color: #a31515">&quot;&quot;</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: blue">Private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Const</span><span style="line-height: 140%"> kApp = </span><span style="line-height: 140%; color: #a31515">&quot;ADNPlugin-LayerReporter&quot;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: blue">Private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Const</span><span style="line-height: 140%"> kSec = </span><span style="line-height: 140%; color: #a31515">&quot;GenerateReport&quot;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: blue">Private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Const</span><span style="line-height: 140%"> kFontName = </span><span style="line-height: 140%; color: #a31515">&quot;FontName&quot;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: blue">Private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Const</span><span style="line-height: 140%"> kFontSize = </span><span style="line-height: 140%; color: #a31515">&quot;FontSize&quot;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: blue">Private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Const</span><span style="line-height: 140%"> kRetainBmps = </span><span style="line-height: 140%; color: #a31515">&quot;RetainBitmaps&quot;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: blue">Private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Const</span><span style="line-height: 140%"> kFieldFlags = </span><span style="line-height: 140%; color: #a31515">&quot;FieldFlags&quot;</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: blue">Private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span><span style="line-height: 140%"> AppReport_FormClosing( _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">ByVal</span><span style="line-height: 140%"> sender </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Object</span><span style="line-height: 140%">, _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">ByVal</span><span style="line-height: 140%"> e </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> System.Windows.Forms.FormClosingEventArgs) _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Handles</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Me</span><span style="line-height: 140%">.FormClosing</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> flags </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> Int32 = 0</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> statusFld.Checked </span><span style="line-height: 140%; color: blue">Then</span><span style="line-height: 140%"> flags += 1</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> onFld.Checked </span><span style="line-height: 140%; color: blue">Then</span><span style="line-height: 140%"> flags += 2</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> freezeFld.Checked </span><span style="line-height: 140%; color: blue">Then</span><span style="line-height: 140%"> flags += 4</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> lockFld.Checked </span><span style="line-height: 140%; color: blue">Then</span><span style="line-height: 140%"> flags += 8</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> colorFld.Checked </span><span style="line-height: 140%; color: blue">Then</span><span style="line-height: 140%"> flags += 16</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> ltypeFld.Checked </span><span style="line-height: 140%; color: blue">Then</span><span style="line-height: 140%"> flags += 32</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> lweightFld.Checked </span><span style="line-height: 140%; color: blue">Then</span><span style="line-height: 140%"> flags += 64</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> pstyleFld.Checked </span><span style="line-height: 140%; color: blue">Then</span><span style="line-height: 140%"> flags += 128</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> plotFld.Checked </span><span style="line-height: 140%; color: blue">Then</span><span style="line-height: 140%"> flags += 256</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> descFld.Checked </span><span style="line-height: 140%; color: blue">Then</span><span style="line-height: 140%"> flags += 512</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> xrefsFld.Checked </span><span style="line-height: 140%; color: blue">Then</span><span style="line-height: 140%"> flags += 1024</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; SaveSetting(kApp, kSec, kFontName, fontName.Text)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; SaveSetting(kApp, kSec, kFontSize, fontSize.Text)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; SaveSetting(kApp, kSec, kRetainBmps, bmpsFld.Checked)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; SaveSetting(kApp, kSec, kFieldFlags, flags)</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">&#39; Clean up temporary bitmaps?</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Not</span><span style="line-height: 140%"> bmpsFld.Checked </span><span style="line-height: 140%; color: blue">Then</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">For</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Each</span><span style="line-height: 140%"> kv </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> KeyValuePair(</span><span style="line-height: 140%; color: blue">Of</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">String</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: blue">String</span><span style="line-height: 140%">) </span><span style="line-height: 140%; color: blue">In</span><span style="line-height: 140%"> _bmps</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> File.Exists(kv.Value) </span><span style="line-height: 140%; color: blue">Then</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; File.Delete(kv.Value)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">If</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Next</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">If</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> _tmpHtm &lt;&gt; </span><span style="line-height: 140%; color: #a31515">&quot;&quot;</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">And</span><span style="line-height: 140%"> File.Exists(_tmpHtm) </span><span style="line-height: 140%; color: blue">Then</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; File.Delete(_tmpHtm)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">If</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: blue">Private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span><span style="line-height: 140%"> AppReport_Load( _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">ByVal</span><span style="line-height: 140%"> sender </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> System.Object, _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">ByVal</span><span style="line-height: 140%"> e </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> System.EventArgs) _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Handles</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">MyBase</span><span style="line-height: 140%">.Load</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; _init = </span><span style="line-height: 140%; color: blue">True</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">&#39; Export bitmaps to Temp folder and store in dictionary.</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">&#39; This lets us easily refer to the bitmap file by key name</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">&#39; later and get the files when it&#39;s time to clean up.</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> tmpLoc </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">String</span><span style="line-height: 140%"> = Path.GetTempPath</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> bmps() </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">String</span><span style="line-height: 140%"> = _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; {</span><span style="line-height: 140%; color: #a31515">&quot;frz&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;loc&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;nop&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;off&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;onn&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;plt&quot;</span><span style="line-height: 140%">, _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #a31515">&quot;thw&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;unl&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;use&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;unu&quot;</span><span style="line-height: 140%">}</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">For</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Each</span><span style="line-height: 140%"> key </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">String</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">In</span><span style="line-height: 140%"> bmps</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> resname </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">String</span><span style="line-height: 140%"> = </span><span style="line-height: 140%; color: #a31515">&quot;lay&quot;</span><span style="line-height: 140%"> &amp; key</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> fname </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">String</span><span style="line-height: 140%"> = tmpLoc &amp; resname &amp; </span><span style="line-height: 140%; color: #a31515">&quot;.bmp&quot;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; _bmps.Add(key, fname)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Using</span><span style="line-height: 140%"> tmpBmp </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> Bitmap = _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">My</span><span style="line-height: 140%">.Resources.ResourceManager.GetObject(resname)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; tmpBmp.Save(fname)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Using</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Next</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">&#39; Put font names in popdown list</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">For</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Each</span><span style="line-height: 140%"> fntFam </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> FontFamily </span><span style="line-height: 140%; color: blue">In</span><span style="line-height: 140%"> FontFamily.Families</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; fontName.Items.Add(fntFam.Name)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Next</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; fontName.Text = _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; GetSetting(kApp, kSec, kFontName, </span><span style="line-height: 140%; color: #a31515">&quot;Arial&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; fontSize.Text = _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; GetSetting(kApp, kSec, kFontSize, </span><span style="line-height: 140%; color: #a31515">&quot;medium&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; bmpsFld.Checked = _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; GetSetting(kApp, kSec, kRetainBmps, </span><span style="line-height: 140%; color: blue">False</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> flags </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> Int32 = _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; GetSetting(kApp, kSec, kFieldFlags, 1023)</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; statusFld.Checked = flags </span><span style="line-height: 140%; color: blue">And</span><span style="line-height: 140%"> 1</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; onFld.Checked = flags </span><span style="line-height: 140%; color: blue">And</span><span style="line-height: 140%"> 2</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; freezeFld.Checked = flags </span><span style="line-height: 140%; color: blue">And</span><span style="line-height: 140%"> 4</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; lockFld.Checked = flags </span><span style="line-height: 140%; color: blue">And</span><span style="line-height: 140%"> 8</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; colorFld.Checked = flags </span><span style="line-height: 140%; color: blue">And</span><span style="line-height: 140%"> 16</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; ltypeFld.Checked = flags </span><span style="line-height: 140%; color: blue">And</span><span style="line-height: 140%"> 32</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; lweightFld.Checked = flags </span><span style="line-height: 140%; color: blue">And</span><span style="line-height: 140%"> 64</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; pstyleFld.Checked = flags </span><span style="line-height: 140%; color: blue">And</span><span style="line-height: 140%"> 128</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; plotFld.Checked = flags </span><span style="line-height: 140%; color: blue">And</span><span style="line-height: 140%"> 256</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; descFld.Checked = flags </span><span style="line-height: 140%; color: blue">And</span><span style="line-height: 140%"> 512</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; xrefsFld.Checked = flags </span><span style="line-height: 140%; color: blue">And</span><span style="line-height: 140%"> 1024</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Call</span><span style="line-height: 140%"> GenerateReport()</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; _init = </span><span style="line-height: 140%; color: blue">False</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: green">&#39; The SelectedIndexChanged event fires when the user changes</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: green">&#39; a value in the related popdown menu at the top of the form.</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: blue">Private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span><span style="line-height: 140%"> fontName_SelectedIndexChanged( _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">ByVal</span><span style="line-height: 140%"> sender </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Object</span><span style="line-height: 140%">, _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">ByVal</span><span style="line-height: 140%"> e </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> System.EventArgs) _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Handles</span><span style="line-height: 140%"> fontName.SelectedIndexChanged</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Not</span><span style="line-height: 140%"> _init </span><span style="line-height: 140%; color: blue">Then</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Call</span><span style="line-height: 140%"> GenerateReport()</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">If</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: blue">Private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span><span style="line-height: 140%"> fontSize_SelectedIndexChanged( _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">ByVal</span><span style="line-height: 140%"> sender </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Object</span><span style="line-height: 140%">, _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">ByVal</span><span style="line-height: 140%"> e </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> System.EventArgs) _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Handles</span><span style="line-height: 140%"> fontSize.SelectedIndexChanged</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Not</span><span style="line-height: 140%"> _init </span><span style="line-height: 140%; color: blue">Then</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Call</span><span style="line-height: 140%"> GenerateReport()</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">If</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: green">&#39; Shared Sub handles all Options toggles to regenerate</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: green">&#39; the report, note that each click event is included and</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: green">&#39; separated by commas.</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: blue">Private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span><span style="line-height: 140%"> MenuReact( _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">ByVal</span><span style="line-height: 140%"> sender </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> System.Object, _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">ByVal</span><span style="line-height: 140%"> e </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> System.EventArgs) _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Handles</span><span style="line-height: 140%"> statusFld.Click, onFld.Click, freezeFld.Click, _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; lockFld.Click, colorFld.Click, ltypeFld.Click, _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; lweightFld.Click, pstyleFld.Click, plotFld.Click, _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; descFld.Click, xrefsFld.Click</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Call</span><span style="line-height: 140%"> GenerateReport()</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: blue">Private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span><span style="line-height: 140%"> GenerateReport()</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">&#39; Dimension some variables as placeholders for repeatedly</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">&#39; used strings for smaller more readable code below.</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> dwg </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">String</span><span style="line-height: 140%"> = _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; Application.GetSystemVariable(</span><span style="line-height: 140%; color: #a31515">&quot;DWGPREFIX&quot;</span><span style="line-height: 140%">) &amp; _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; Application.GetSystemVariable(</span><span style="line-height: 140%; color: #a31515">&quot;DWGNAME&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> stylePre </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">String</span><span style="line-height: 140%"> = _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #a31515">&quot;style=&#39;font-family: &quot;</span><span style="line-height: 140%"> &amp; fontName.Text &amp; </span><span style="line-height: 140%; color: #a31515">&quot;; font-size: &quot;</span><span style="line-height: 140%"> &amp; _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; fontSize.Text</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> headPre </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">String</span><span style="line-height: 140%"> = </span><span style="line-height: 140%; color: #a31515">&quot;&lt;th&gt;&quot;</span><span style="line-height: 140%"> &amp; </span><span style="line-height: 140%; color: #a31515">&quot;&amp;nbsp;&quot;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> headSuf </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">String</span><span style="line-height: 140%"> = </span><span style="line-height: 140%; color: #a31515">&quot;&amp;nbsp;&quot;</span><span style="line-height: 140%"> &amp; </span><span style="line-height: 140%; color: #a31515">&quot;&lt;/th&gt;&quot;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> imgPre </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">String</span><span style="line-height: 140%"> = _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #a31515">&quot;&lt;td align=&#39;center&#39;&gt;&amp;nbsp;&lt;img src=&#39;&quot;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> imgSuf </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">String</span><span style="line-height: 140%"> = </span><span style="line-height: 140%; color: #a31515">&quot;&#39;/&gt;&amp;nbsp;&lt;/td&gt;&quot;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> txtPre </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">String</span><span style="line-height: 140%"> = </span><span style="line-height: 140%; color: #a31515">&quot;&lt;td&gt;&quot;</span><span style="line-height: 140%"> &amp; </span><span style="line-height: 140%; color: #a31515">&quot;&amp;nbsp;&quot;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> txtSuf </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">String</span><span style="line-height: 140%"> = </span><span style="line-height: 140%; color: #a31515">&quot;&amp;nbsp;&quot;</span><span style="line-height: 140%"> &amp; </span><span style="line-height: 140%; color: #a31515">&quot;&lt;/td&gt;&quot;</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">&#39; Get an instance of the database and layer table and create</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">&#39; a transaction by using &#39;Using&#39; instead of &#39;Dim&#39; the instance</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">&#39; will be automatically disposed after execution is complete.</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Using</span><span style="line-height: 140%"> db </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> Database = _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; Application.DocumentManager.MdiActiveDocument.Database</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Using</span><span style="line-height: 140%"> tr </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> Transaction = _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; db.TransactionManager.StartTransaction</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Using</span><span style="line-height: 140%"> lt </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> LayerTable = _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; db.LayerTableId.GetObject(OpenMode.ForRead)</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">&#39; Loop through the layer table and build a list of</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">&#39; qualifying layer names so we can sort it for output.</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">&#39; The default order is likely the order created.</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> lays </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">New</span><span style="line-height: 140%"> List(</span><span style="line-height: 140%; color: blue">Of</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">String</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">For</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Each</span><span style="line-height: 140%"> layId </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> ObjectId </span><span style="line-height: 140%; color: blue">In</span><span style="line-height: 140%"> lt</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> ltr </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> LayerTableRecord = _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; tr.GetObject(layId, OpenMode.ForRead)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> xrefsFld.Checked </span><span style="line-height: 140%; color: blue">Then</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; lays.Add(ltr.Name)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Else</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Not</span><span style="line-height: 140%"> ltr.IsDependent </span><span style="line-height: 140%; color: blue">Then</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; lays.Add(ltr.Name)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">If</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">If</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Next</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; lays.Sort()</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">&#39; The System.Text.StringBuilder is an extremely fast way</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">&#39; of concatenating strings, see the .NET help for more</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">&#39; details on this versatile object!</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> sb </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">New</span><span style="line-height: 140%"> StringBuilder()</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; sb.Append( _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #a31515">&quot;&lt;html&gt;&lt;head&gt;&quot;</span><span style="line-height: 140%"> &amp; _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #a31515">&quot;&lt;title&gt;&quot;</span><span style="line-height: 140%"> &amp; dwg &amp; </span><span style="line-height: 140%; color: #a31515">&quot;&lt;/title&gt;&quot;</span><span style="line-height: 140%"> &amp; _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #a31515">&quot;&lt;/head&gt;&quot;</span><span style="line-height: 140%"> &amp; _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #a31515">&quot;&lt;body&gt;&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; sb.Append(</span><span style="line-height: 140%; color: #a31515">&quot;&lt;center&gt;&lt;div &quot;</span><span style="line-height: 140%"> &amp; stylePre &amp; </span><span style="line-height: 140%; color: #a31515">&quot;&#39;&gt;&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; sb.Append( _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #a31515">&quot;&lt;b&gt;&quot;</span><span style="line-height: 140%"> &amp; </span><span style="line-height: 140%; color: #a31515">&quot;Layer Report&quot;</span><span style="line-height: 140%"> &amp; _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #a31515">&quot;&lt;/b&gt;&quot;</span><span style="line-height: 140%"> &amp; </span><span style="line-height: 140%; color: #a31515">&quot;&lt;br/&gt;&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; sb.Append( _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #a31515">&quot;&lt;b&gt;&quot;</span><span style="line-height: 140%"> &amp; dwg &amp; </span><span style="line-height: 140%; color: #a31515">&quot;&lt;/b&gt;&quot;</span><span style="line-height: 140%"> &amp; </span><span style="line-height: 140%; color: #a31515">&quot;&lt;br/&gt;&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; sb.Append( _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Format(Now, </span><span style="line-height: 140%; color: #a31515">&quot;Long Date&quot;</span><span style="line-height: 140%">) &amp; </span><span style="line-height: 140%; color: #a31515">&quot;&#0160; &quot;</span><span style="line-height: 140%"> &amp; _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Format(Now, </span><span style="line-height: 140%; color: #a31515">&quot;Long Time&quot;</span><span style="line-height: 140%">) &amp; </span><span style="line-height: 140%; color: #a31515">&quot;&lt;br/&gt;&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; sb.Append( _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #a31515">&quot;&lt;table &quot;</span><span style="line-height: 140%"> &amp; stylePre &amp; </span><span style="line-height: 140%; color: #a31515">&quot;;border-collapse: collapse; &quot;</span><span style="line-height: 140%"> &amp; _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #a31515">&quot;border=&#39;0&#39; &quot;</span><span style="line-height: 140%"> &amp; _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #a31515">&quot;cellpadding=&#39;0&#39;&gt;&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; sb.Append(</span><span style="line-height: 140%; color: #a31515">&quot;&lt;tr&gt;&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> statusFld.Checked </span><span style="line-height: 140%; color: blue">Then</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; sb.Append(headPre &amp; </span><span style="line-height: 140%; color: #a31515">&quot;Status&quot;</span><span style="line-height: 140%"> &amp; headSuf)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">If</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; sb.Append(headPre &amp; </span><span style="line-height: 140%; color: #a31515">&quot;Name&quot;</span><span style="line-height: 140%"> &amp; headSuf)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> onFld.Checked </span><span style="line-height: 140%; color: blue">Then</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; sb.Append(headPre &amp; </span><span style="line-height: 140%; color: #a31515">&quot;On&quot;</span><span style="line-height: 140%"> &amp; headSuf)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">If</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> freezeFld.Checked </span><span style="line-height: 140%; color: blue">Then</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; sb.Append(headPre &amp; </span><span style="line-height: 140%; color: #a31515">&quot;Freeze&quot;</span><span style="line-height: 140%"> &amp; headSuf)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">If</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> lockFld.Checked </span><span style="line-height: 140%; color: blue">Then</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; sb.Append(headPre &amp; </span><span style="line-height: 140%; color: #a31515">&quot;Lock&quot;</span><span style="line-height: 140%"> &amp; headSuf)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">If</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> colorFld.Checked </span><span style="line-height: 140%; color: blue">Then</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; sb.Append(headPre &amp; </span><span style="line-height: 140%; color: #a31515">&quot;Color&quot;</span><span style="line-height: 140%"> &amp; headSuf)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">If</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> ltypeFld.Checked </span><span style="line-height: 140%; color: blue">Then</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; sb.Append(headPre &amp; </span><span style="line-height: 140%; color: #a31515">&quot;Linetype&quot;</span><span style="line-height: 140%"> &amp; headSuf)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">If</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> lweightFld.Checked </span><span style="line-height: 140%; color: blue">Then</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; sb.Append(headPre &amp; </span><span style="line-height: 140%; color: #a31515">&quot;Lineweight&quot;</span><span style="line-height: 140%"> &amp; headSuf)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">If</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> pstyleFld.Checked </span><span style="line-height: 140%; color: blue">Then</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; sb.Append(headPre &amp; </span><span style="line-height: 140%; color: #a31515">&quot;PlotStyle&quot;</span><span style="line-height: 140%"> &amp; headSuf)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">If</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> plotFld.Checked </span><span style="line-height: 140%; color: blue">Then</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; sb.Append(headPre &amp; </span><span style="line-height: 140%; color: #a31515">&quot;Plot&quot;</span><span style="line-height: 140%"> &amp; headSuf)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">If</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> descFld.Checked </span><span style="line-height: 140%; color: blue">Then</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; sb.Append(headPre &amp; </span><span style="line-height: 140%; color: #a31515">&quot;Description&quot;</span><span style="line-height: 140%"> &amp; headSuf)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">If</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; sb.Append(</span><span style="line-height: 140%; color: #a31515">&quot;&lt;/tr&gt;&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; sb.Append(</span><span style="line-height: 140%; color: #a31515">&quot;&lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">&#39; The title and header section is done, time to fill in</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">&#39; the layer rows.</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">For</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Each</span><span style="line-height: 140%"> lay </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">String</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">In</span><span style="line-height: 140%"> lays</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">&#39; Get the layer record by its key name string using the</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">&#39; transactions.GetObject()</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> ltr </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> LayerTableRecord = _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; tr.GetObject(lt(lay), OpenMode.ForRead)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; sb.Append(</span><span style="line-height: 140%; color: #a31515">&quot;&lt;tr&gt;&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> statusFld.Checked </span><span style="line-height: 140%; color: blue">Then</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; sb.Append( _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; imgPre &amp; _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; IIf(ltr.IsUsed, _bmps(</span><span style="line-height: 140%; color: #a31515">&quot;use&quot;</span><span style="line-height: 140%">), _bmps(</span><span style="line-height: 140%; color: #a31515">&quot;unu&quot;</span><span style="line-height: 140%">)) &amp; _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; imgSuf)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">If</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; sb.Append(txtPre &amp; ltr.Name &amp; txtSuf)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> onFld.Checked </span><span style="line-height: 140%; color: blue">Then</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; sb.Append( _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; imgPre &amp; _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; IIf(ltr.IsOff, _bmps(</span><span style="line-height: 140%; color: #a31515">&quot;off&quot;</span><span style="line-height: 140%">), _bmps(</span><span style="line-height: 140%; color: #a31515">&quot;onn&quot;</span><span style="line-height: 140%">)) &amp; _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; imgSuf)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">If</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> freezeFld.Checked </span><span style="line-height: 140%; color: blue">Then</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; sb.Append( _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; imgPre &amp; _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; IIf(ltr.IsFrozen, _bmps(</span><span style="line-height: 140%; color: #a31515">&quot;frz&quot;</span><span style="line-height: 140%">), _bmps(</span><span style="line-height: 140%; color: #a31515">&quot;thw&quot;</span><span style="line-height: 140%">)) &amp; _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; imgSuf)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">If</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> lockFld.Checked </span><span style="line-height: 140%; color: blue">Then</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; sb.Append( _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; imgPre &amp; _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; IIf(ltr.IsLocked, _bmps(</span><span style="line-height: 140%; color: #a31515">&quot;loc&quot;</span><span style="line-height: 140%">), _bmps(</span><span style="line-height: 140%; color: #a31515">&quot;unl&quot;</span><span style="line-height: 140%">)) &amp; _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; imgSuf)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">If</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> colorFld.Checked </span><span style="line-height: 140%; color: blue">Then</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">&#39; Used so we can show the square bullet in the</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">&#39; layers color</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; sb.Append( _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #a31515">&quot;&lt;td&gt;&amp;nbsp;&lt;span style=&#39;font-family: Wingdings; &quot;</span><span style="line-height: 140%"> &amp; _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #a31515">&quot;color: &quot;</span><span style="line-height: 140%"> &amp; Col2Str(ltr.Color) &amp; </span><span style="line-height: 140%; color: #a31515">&quot;&#39;&gt;n&lt;/span&gt;&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; sb.Append( _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #a31515">&quot;&amp;nbsp;&quot;</span><span style="line-height: 140%"> &amp; _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ltr.Color.ColorNameForDisplay &amp; _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #a31515">&quot;&amp;nbsp;&quot;</span><span style="line-height: 140%"> &amp; </span><span style="line-height: 140%; color: #a31515">&quot;&lt;/td&gt;&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">If</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> ltypeFld.Checked </span><span style="line-height: 140%; color: blue">Then</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">&#39; The layer record stores the linetype as an ObjectId,</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">&#39; not a string.&#0160; This means we need to look up the</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">&#39; linetype in that table to get it&#39;s string name.</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> ltt </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> LinetypeTable = _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; db.LinetypeTableId.GetObject(OpenMode.ForRead)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> lttr </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> LinetypeTableRecord = _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; tr.GetObject(ltr.LinetypeObjectId, OpenMode.ForRead)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; sb.Append(txtPre &amp; lttr.Name &amp; txtSuf)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">If</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> lweightFld.Checked </span><span style="line-height: 140%; color: blue">Then</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; sb.Append( _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; txtPre &amp; _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Wght2Str(ltr.LineWeight) &amp; _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; txtSuf)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">If</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> pstyleFld.Checked </span><span style="line-height: 140%; color: blue">Then</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">&#39; The plot style is stored as a string, we can simply</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">&#39; include it</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; sb.Append(txtPre &amp; ltr.PlotStyleName &amp; txtSuf)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">If</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> plotFld.Checked </span><span style="line-height: 140%; color: blue">Then</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; sb.Append( _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; imgPre &amp; _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; IIf(ltr.IsPlottable, _bmps(</span><span style="line-height: 140%; color: #a31515">&quot;plt&quot;</span><span style="line-height: 140%">), _bmps(</span><span style="line-height: 140%; color: #a31515">&quot;nop&quot;</span><span style="line-height: 140%">)) _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &amp; imgSuf)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">If</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> descFld.Checked </span><span style="line-height: 140%; color: blue">Then</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; sb.Append(txtPre &amp; ltr.Description &amp; txtSuf)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">If</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; sb.Append(</span><span style="line-height: 140%; color: #a31515">&quot;&lt;/tr&gt;&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Next</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; sb.Append(</span><span style="line-height: 140%; color: #a31515">&quot;&lt;/table&gt;&lt;/div&gt;&lt;/center&gt;&lt;/body&gt;&lt;/html&gt;&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">&#39; Write the HTML content to a file and then load it</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> _tmpHtm = </span><span style="line-height: 140%; color: #a31515">&quot;&quot;</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Then</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; _tmpHtm = Path.GetTempFileName() + </span><span style="line-height: 140%; color: #a31515">&quot;.htm&quot;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">If</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Using</span><span style="line-height: 140%"> file </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> StreamWriter = _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">New</span><span style="line-height: 140%"> StreamWriter(_tmpHtm, </span><span style="line-height: 140%; color: blue">False</span><span style="line-height: 140%">, Encoding.Default)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; file.Write(sb.ToString)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; file.Close()</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Using</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; webWin.SuspendLayout()</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; webWin.Navigate(_tmpHtm)</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">&#39; Wait for the control to finish</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">While</span><span style="line-height: 140%"> webWin.IsBusy</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; System.Windows.Forms.Application.DoEvents()</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">While</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; webWin.ResumeLayout()</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; statTxt.Text = _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; lays.Count.ToString &amp; </span><span style="line-height: 140%; color: #a31515">&quot; layer&quot;</span><span style="line-height: 140%"> &amp; _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; IIf(lays.Count = 1, </span><span style="line-height: 140%; color: #a31515">&quot;&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;s&quot;</span><span style="line-height: 140%">) &amp; </span><span style="line-height: 140%; color: #a31515">&quot; listed&quot;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Using</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Using</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Using</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: blue">Private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span><span style="line-height: 140%"> printBut_Click( _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">ByVal</span><span style="line-height: 140%"> sender </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> System.Object, _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">ByVal</span><span style="line-height: 140%"> e </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> System.EventArgs) </span><span style="line-height: 140%; color: blue">Handles</span><span style="line-height: 140%"> printBut.Click</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; webWin.ShowPrintDialog()</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: blue">Private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span><span style="line-height: 140%"> prevBut_Click( _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">ByVal</span><span style="line-height: 140%"> sender </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> System.Object, _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">ByVal</span><span style="line-height: 140%"> e </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> System.EventArgs) </span><span style="line-height: 140%; color: blue">Handles</span><span style="line-height: 140%"> prevBut.Click</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; webWin.ShowPrintPreviewDialog()</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: blue">Private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span><span style="line-height: 140%"> saveBut_Click( _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">ByVal</span><span style="line-height: 140%"> sender </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> System.Object, _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">ByVal</span><span style="line-height: 140%"> e </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> System.EventArgs) </span><span style="line-height: 140%; color: blue">Handles</span><span style="line-height: 140%"> saveBut.Click</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; webWin.ShowSaveAsDialog()</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: blue">Private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span><span style="line-height: 140%"> setupBut_Click( _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">ByVal</span><span style="line-height: 140%"> sender </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> System.Object, _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">ByVal</span><span style="line-height: 140%"> e </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> System.EventArgs) </span><span style="line-height: 140%; color: blue">Handles</span><span style="line-height: 140%"> setupBut.Click</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; webWin.ShowPageSetupDialog()</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: green">&#39; Helper function for the square bullet displayed, takes an _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: green">&#39; AutoCAD color as input as returns a string like #00FF00.</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: blue">Private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Function</span><span style="line-height: 140%"> Col2Str( _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">ByVal</span><span style="line-height: 140%"> c </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> Autodesk.AutoCAD.Colors.Color) </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">String</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> col </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> Int32</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> c.ColorMethod = ColorMethod.ByAci </span><span style="line-height: 140%; color: blue">Then</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> bytes() </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Byte</span><span style="line-height: 140%"> = _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; BitConverter.GetBytes( _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; EntityColor.LookUpRgb(c.ColorIndex))</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; col = RGB(bytes(0), bytes(1), bytes(2))</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Else</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; col = RGB(c.Blue, c.Green, c.Red)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">If</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Return</span><span style="line-height: 140%"> ColorTranslator.ToHtml( _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; System.Drawing.Color.FromArgb(col))</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Function</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: green">&#39; Helper function for lineweights, takes the stored value</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: green">&#39; and returns&#0160; a string similar to AutoCAD&#39;s layer dialog</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: green">&#39; (in the current units).</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: blue">Private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Function</span><span style="line-height: 140%"> Wght2Str(</span><span style="line-height: 140%; color: blue">ByVal</span><span style="line-height: 140%"> weight </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Single</span><span style="line-height: 140%">) _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">String</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Select</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Case</span><span style="line-height: 140%"> weight</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Case</span><span style="line-height: 140%"> -3</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Return</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #a31515">&quot;Default&quot;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Case</span><span style="line-height: 140%"> -2</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Return</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #a31515">&quot;ByBlock&quot;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Case</span><span style="line-height: 140%"> -1</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Return</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #a31515">&quot;ByLayer&quot;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Case</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Else</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> Application.GetSystemVariable(</span><span style="line-height: 140%; color: #a31515">&quot;LWUNITS&quot;</span><span style="line-height: 140%">) = 1 </span><span style="line-height: 140%; color: blue">Then</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Return</span><span style="line-height: 140%"> Format(weight / 100.0, </span><span style="line-height: 140%; color: #a31515">&quot;0.00&quot;</span><span style="line-height: 140%">) &amp; </span><span style="line-height: 140%; color: #a31515">&quot;mm&quot;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Else</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Return</span><span style="line-height: 140%"> Format(weight / 25.4 / 100.0, </span><span style="line-height: 140%; color: #a31515">&quot;0.000&quot;</span><span style="line-height: 140%">) &amp; Chr(34)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">If</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Select</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Function</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Class</span></p> </div>   <p>There’s an additional Commands.vb file:</p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%; color: blue">Imports</span><span style="line-height: 140%"> Autodesk.AutoCAD.ApplicationServices</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%; color: blue">Imports</span><span style="line-height: 140%"> Autodesk.AutoCAD.Runtime</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%; color: blue">Imports</span><span style="line-height: 140%"> LayerReporter.DemandLoading</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%; color: blue">Public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Class</span><span style="line-height: 140%"> Commands</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: blue">Implements</span><span style="line-height: 140%"> IExtensionApplication</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: green">&#39; AutoCAD fires the Initialize Sub when the assembly is loaded,</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: green">&#39; so we check to see if the command is registered by looking for</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: green">&#39; the existance of the Registry keys.&#0160; If not found, we attempt</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: green">&#39; to add them so the command will automatically load in future</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: green">&#39; sessions.&#0160; This means it only needs to be NETLOADed once.</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: blue">Public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span><span style="line-height: 140%"> Initialize() </span><span style="line-height: 140%; color: blue">Implements</span><span style="line-height: 140%"> IExtensionApplication.Initialize</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; RegistryUpdate.RegisterForDemandLoading()</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: blue">Public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span><span style="line-height: 140%"> Terminate() </span><span style="line-height: 140%; color: blue">Implements</span><span style="line-height: 140%"> IExtensionApplication.Terminate</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">&#39; Only fires when AutoCAD is shutting down</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; &lt;CommandMethod(</span><span style="line-height: 140%; color: #a31515">&quot;ADNPLUGINS&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;REMOVELR&quot;</span><span style="line-height: 140%">, CommandFlags.Modal)&gt; _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: blue">Public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Shared</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span><span style="line-height: 140%"> RemoveLayerReporter()</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; RegistryUpdate.UnregisterForDemandLoading()</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: green">&#39; Establish our command name to use to start the tool.&#0160; It</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: green">&#39; dimensions an instance of the form and displays it with</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: green">&#39; AutoCAD&#39;s ShowModalDialog.&#0160; Don&#39;t use Windows Form.Show!</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; &lt;CommandMethod(</span><span style="line-height: 140%; color: #a31515">&quot;ADNPLUGINS&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;REPORTLAYERS&quot;</span><span style="line-height: 140%">, CommandFlags.Modal)&gt; _</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: blue">Public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Shared</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span><span style="line-height: 140%"> ReportLayers()</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">Using</span><span style="line-height: 140%"> dlg </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">New</span><span style="line-height: 140%"> Report()</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; Application.ShowModalDialog(dlg)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Using</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span></p>    <p style="margin: 0px; font-size: 8pt">&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Class</span></p> </div>  <p>And the Demand_Loading.vb file is the same as was used in the ClipboardManager tool.</p>  <p>If you have any feedback to share please post a comment or <a href="mailto:labs.plugins@autodesk.com">send us an email</a>.</p>
