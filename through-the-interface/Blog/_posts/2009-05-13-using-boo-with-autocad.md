---
layout: "post"
title: "Using Boo with AutoCAD"
date: "2009-05-13 09:52:44"
author: "Kean Walmsley"
categories:
  - "AutoCAD"
  - "AutoCAD .NET"
  - "Custom objects"
  - "Notification / Events"
  - "Overrules"
  - "Solid modeling"
original_url: "https://www.keanw.com/2009/05/using-boo-with-autocad.html "
typepad_basename: "using-boo-with-autocad"
typepad_status: "Publish"
---

<p>I might also have called this post “Overruling AutoCAD 2010’s entity display and explode using Boo”, as it complements the equivalent posts for <a href="http://through-the-interface.typepad.com/through_the_interface/2009/04/overruling-explode-in-autocad-2010-using-net.html">C#</a>, <a href="http://through-the-interface.typepad.com/through_the_interface/2009/03/customizing-the-display-of-standard-autocad-objects-using-f.html">F#</a>,&#160; <a href="http://through-the-interface.typepad.com/through_the_interface/2009/04/overruling-autocad-2010s-entity-display-and-explode-using-ironpython.html">IronPython</a> and <a href="http://through-the-interface.typepad.com/through_the_interface/2009/05/overruling-autocad-2010s-entity-display-and-explode-using-ironruby.html">IronRuby</a>, but I felt it appropriate to combine the post with an introduction to what Boo is all about.</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201157083bf6d970b-pi"><img style="border-right-width: 0px; margin: 0px 10px 0px 20px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="Boo logo" border="0" alt="Boo logo" align="right" src="/assets/image_544476.jpg" width="138" height="138" /></a> What is Boo and how did I come to look into it? Knowing of my recent interest in the various scripting technologies being made available for .NET, a colleague at Autodesk recently pointed me at the <a href="http://en.wikipedia.org/wiki/Boo_(programming_language)">Boo programming language</a> (and <a href="http://boo.codehaus.org/">here is the official page</a> for the language, including its various downloads).</p>  <p>First, to get this out the way: Boo is really cool. I can relate to <a href="http://boo.codehaus.org/BooManifesto.pdf">the drivers behind it</a>, which were to create a statically-typed language based on Python that works really well with .NET. And with many of the rough edges smoothed away, especially those related to object-orientation, which tends to feel as though it was bolted on to Python as an afterthought.</p>  <p>As it’s statically-typed, Boo provides compile-time code checking and in theory could also provide intellisense and code completion (to which I unfortunately find myself increasingly addicted). It uses type inference – just as <a href="http://through-the-interface.typepad.com/through_the_interface/f">F#</a> does – so there’s no need for the complex variable declarations we’re used to seeing in C#.</p>  <p>I’ve had fun playing around with dynamically typed languages (such as IronPython and IronRuby, which are based on Microsoft’s Dynamic Language Runtime), but for now I still find the benefits brought by static typing to be compelling, especially when you have to launch a relatively heavyweight desktop application to run your code. As far as I can tell much of the productivity benefit of working with dynamic languages in such an environment come from using an integrated <a href="http://en.wikipedia.org/wiki/Read-eval-print_loop">REPL</a> – just as AutoLISP has via AutoCAD’s command-line – but right now we don’t have that kind of capability built into our products for other scripting languages.</p>  <p>While primarily statically-typed, Boo also has dynamic capabilities. For instance, you can very easily make use of <a href="http://en.wikipedia.org/wiki/Duck_typing">duck typing</a> within your code, just as we will get with C# 4.0’s dynamic keyword. Duck typing allows you to get away from deriving sub-classes and implementing interfaces: as long as you expose appropriately-named methods from your object, they will get called (for those of you who aren’t aware, the term comes from the phrase “<em>If it walks like a duck and quacks like a duck, it must be a duck.</em>” :-).</p>  <p>Boo is compiled: it allows you to create executables and class libraries (.DLLs) with custom .NET attributes, which makes it much easier to implement commands inside AutoCAD (we can use the standard NETLOAD command directly, rather than needing to implement something like PYLOAD and RBLOAD). Boo doesn’t use the DLR, as it’s not really a dynamic language, which means the IL generated is similar to what you’d expect from C# or VB.NET. Take a look using <a href="http://www.red-gate.com/products/reflector/">Reflector</a>, if you’re interested.</p>  <p>How did I get started with Boo? My first step was to install <a href="http://www.codeplex.com/BooLangStudio">BooLangStudio</a>, a Boo integration for Visual Studio 2008. I didn’t even need to download the Boo language separately, which was nice. The BooLangStudio integration is still in Alpha but generally works pretty well. Aside from missing intellisense I also found that I wasn’t able to debug into Class Libraries, but in theory both of these capabilities are altogether doable. Oh, and I had a problem using the <a href="http://www.jtleigh.com/people/colin/software/CopySourceAsHtml/">CopySourceAsHtml</a> plugin, which I ended up having to rebuild to workaround an issue with the default tab size not being available for .boo source files.</p>  <p>To get the code working, I started by copying the Python code from the post I mentioned earlier and then proceeded to update it for <a href="http://boo.codehaus.org/Gotchas+for+Python+Users">the differences Boo has with Python</a>.</p>  <p>I very much liked the OO- and CLR-related changes:</p>  <ul>   <li>You specifically identify virtual method implementations with the override keyword</li>    <ul>     <li>On the downside I found it important to nail down argument types with the as keyword, which is slightly more cumbersome</li>      <ul>       <li>Unless you use duck typing you will generally need to cast more often, but that seems acceptable</li>     </ul>   </ul>    <li>The somewhat ugly __init__ methods are now named constructor, instead (yay)</li>    <li>The self argument is now implicit (double-yay)</li> </ul>  <p>All very logical modifications to the Python language, in my opinion.</p>  <p>Some additional things to call out:</p>  <ul>   <li>Boo doesn’t yet support global variables, so these had to be declared as static members of a class</li>    <li>There were a few minor issues with enumerations that needed working around (but these were thankfully compile-time errors, so easy to chase down)</li> </ul>  <p>Here’s the Boo code:</p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%; color: blue">namespace</span><span style="line-height: 140%"> OverruleSample</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">import</span><span style="line-height: 140%"> System</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">import</span><span style="line-height: 140%"> Autodesk.AutoCAD.Runtime</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">import</span><span style="line-height: 140%"> Autodesk.AutoCAD.ApplicationServices</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">import</span><span style="line-height: 140%"> Autodesk.AutoCAD.DatabaseServices</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">import</span><span style="line-height: 140%"> Autodesk.AutoCAD.EditorInput</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">import</span><span style="line-height: 140%"> Autodesk.AutoCAD.GraphicsInterface</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">import</span><span style="line-height: 140%"> Autodesk.AutoCAD.Geometry</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">import</span><span style="line-height: 140%"> Autodesk.AutoCAD.Colors</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: green"># Set some global constants &amp; variables</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">class</span><span style="line-height: 140%"> Globals:&#160; </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">static</span><span style="line-height: 140%"> appName = </span><span style="line-height: 140%; color: #a31515">&quot;TTIF_PIPE&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">static</span><span style="line-height: 140%"> appCode = 1001</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">static</span><span style="line-height: 140%"> radCode = 1040</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">static</span><span style="line-height: 140%"> radius = 0.0</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">static</span><span style="line-height: 140%"> overruling = </span><span style="line-height: 140%; color: blue">false</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">class</span><span style="line-height: 140%"> PipeDrawOverrule(DrawableOverrule):</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: green">/*</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">&#160; The base class for our draw overrules specifying the</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">&#160; registered application name for the XData upon which</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">&#160; to filter</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">&#160; */</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">protected</span><span style="line-height: 140%"> _sweepOpts</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">def</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">constructor</span><span style="line-height: 140%">():</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">/*</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">&#160;&#160;&#160; Tell AutoCAD to filter on our application name</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">&#160;&#160;&#160; (this means our overrule will only be called</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">&#160;&#160;&#160; on objects possessing XData with this name)</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">&#160;&#160;&#160; */</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">cast</span><span style="line-height: 140%">(DrawableOverrule, </span><span style="line-height: 140%; color: blue">self</span><span style="line-height: 140%">).SetXDataFilter(Globals.appName)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">class</span><span style="line-height: 140%"> LinePipeDrawOverrule(PipeDrawOverrule):</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: green">/*</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">&#160; An overrule to make a pipe out of a line</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">&#160; */</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">static</span><span style="line-height: 140%"> theOverrule = LinePipeDrawOverrule()</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">def</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">constructor</span><span style="line-height: 140%">():</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; _sweepOpts = SweepOptions()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">super</span><span style="line-height: 140%">()</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">override</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">def</span><span style="line-height: 140%"> WorldDraw(d </span><span style="line-height: 140%; color: blue">as</span><span style="line-height: 140%"> Drawable, wd </span><span style="line-height: 140%; color: blue">as</span><span style="line-height: 140%"> WorldDraw):</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; radius = PipeRadiusForObject(d)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> radius &gt; 0.0:</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green"># Draw the line as is, with overruled attributes</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">super</span><span style="line-height: 140%">(d, wd)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; ln = d </span><span style="line-height: 140%; color: blue">as</span><span style="line-height: 140%"> Line</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">not</span><span style="line-height: 140%"> d.Id.IsNull </span><span style="line-height: 140%; color: blue">and</span><span style="line-height: 140%"> ln.Length &gt; 0.0:</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green"># Draw a pipe around the line</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; c = wd.SubEntityTraits.TrueColor</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; wd.SubEntityTraits.TrueColor = EntityColor(0x00AFAFFF)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; wd.SubEntityTraits.LineWeight = LineWeight.LineWeight000</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; start = ln.StartPoint</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; end = ln.EndPoint</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; norm = Vector3d(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; end.X - start.X,</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; end.Y - start.Y,</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; end.Z - start.Z</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; )</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; clr = Circle(start, norm, radius)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; pipe = ExtrudedSurface()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">try</span><span style="line-height: 140%">:</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; pipe.CreateExtrudedSurface(clr, norm, _sweepOpts)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">except</span><span style="line-height: 140%">:</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; doc = Application.DocumentManager.MdiActiveDocument</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; doc.Editor.WriteMessage(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;\nFailed with CreateExtrudedSurface.&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; )</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; clr.Dispose()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; pipe.WorldDraw(wd)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; pipe.Dispose()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; wd.SubEntityTraits.TrueColor = c</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">true</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">super</span><span style="line-height: 140%">(d, wd)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">override</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">def</span><span style="line-height: 140%"> SetAttributes(d </span><span style="line-height: 140%; color: blue">as</span><span style="line-height: 140%"> Drawable, t </span><span style="line-height: 140%; color: blue">as</span><span style="line-height: 140%"> DrawableTraits):</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; b = </span><span style="line-height: 140%; color: blue">super</span><span style="line-height: 140%">(d, t)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; radius = PipeRadiusForObject(d)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> radius &gt; 0.0:</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green"># Set color to magenta</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; t.Color = 6</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green"># and lineweight to .40 mm</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; t.LineWeight = LineWeight.LineWeight040</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> b</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">class</span><span style="line-height: 140%"> CirclePipeDrawOverrule(PipeDrawOverrule):</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: green">/*</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">&#160; An overrule to make a pipe out of a circle</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">&#160; */</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">static</span><span style="line-height: 140%"> theOverrule = CirclePipeDrawOverrule()</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">def</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">constructor</span><span style="line-height: 140%">():</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; _sweepOpts = SweepOptions()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">super</span><span style="line-height: 140%">()</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">override</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">def</span><span style="line-height: 140%"> WorldDraw(d </span><span style="line-height: 140%; color: blue">as</span><span style="line-height: 140%"> Drawable, wd </span><span style="line-height: 140%; color: blue">as</span><span style="line-height: 140%"> WorldDraw):</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; radius = PipeRadiusForObject(d)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> radius &gt; 0.0:</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green"># Draw the circle as is, with overruled attributes</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">super</span><span style="line-height: 140%">(d, wd)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; cir = d </span><span style="line-height: 140%; color: blue">as</span><span style="line-height: 140%"> Circle</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green"># Needed to avoid ill-formed swept surface</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> cir.Radius &gt; radius:</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green"># Draw a pipe around the circle</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; c = wd.SubEntityTraits.TrueColor</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; wd.SubEntityTraits.TrueColor = EntityColor(0x3FFFE0E0)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; wd.SubEntityTraits.LineWeight = LineWeight.LineWeight000</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; start = cir.StartPoint</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; cen = cir.Center</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; norm = Vector3d(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; cen.X - start.X,</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; cen.Y - start.Y,</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; cen.Z - start.Z</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; )</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; clr = Circle(start, norm.CrossProduct(cir.Normal), radius)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; pipe = SweptSurface()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; pipe.CreateSweptSurface(clr, d, _sweepOpts)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; clr.Dispose()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; pipe.WorldDraw(wd)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; pipe.Dispose()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; wd.SubEntityTraits.TrueColor = c</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">true</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">super</span><span style="line-height: 140%">(d, wd)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">override</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">def</span><span style="line-height: 140%"> SetAttributes(d </span><span style="line-height: 140%; color: blue">as</span><span style="line-height: 140%"> Drawable, t </span><span style="line-height: 140%; color: blue">as</span><span style="line-height: 140%"> DrawableTraits):</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; b = </span><span style="line-height: 140%; color: blue">super</span><span style="line-height: 140%">(d, t)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; radius = PipeRadiusForObject(d)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> radius &gt; 0.0:</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green"># Set color to yellow</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; t.Color = 2</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green"># and lineweight to .60 mm</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; t.LineWeight = LineWeight.LineWeight060</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> b</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">class</span><span style="line-height: 140%"> LinePipeTransformOverrule(TransformOverrule):</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: green">/*</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">&#160; An overrule to explode a linear pipe into Solid3d objects</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">&#160; */</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">static</span><span style="line-height: 140%"> theOverrule = LinePipeTransformOverrule()</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">private</span><span style="line-height: 140%"> _sweepOpts</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">def</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">constructor</span><span style="line-height: 140%">():</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; _sweepOpts = SweepOptions()</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">override</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">def</span><span style="line-height: 140%"> Explode(e </span><span style="line-height: 140%; color: blue">as</span><span style="line-height: 140%"> Entity, objs </span><span style="line-height: 140%; color: blue">as</span><span style="line-height: 140%"> DBObjectCollection):</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; radius = PipeRadiusForObject(e)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> radius &gt; 0.0:</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; ln = e </span><span style="line-height: 140%; color: blue">as</span><span style="line-height: 140%"> Line</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">not</span><span style="line-height: 140%"> e.Id.IsNull </span><span style="line-height: 140%; color: blue">and</span><span style="line-height: 140%"> ln.Length &gt; 0.0:</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green"># Draw a pipe around the line</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; start = ln.StartPoint</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; end = ln.EndPoint</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; norm = Vector3d(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; end.X - start.X,</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; end.Y - start.Y,</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; end.Z - start.Z</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; )</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; clr = Circle(start, norm, radius)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; pipe = ExtrudedSurface()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">try</span><span style="line-height: 140%">:</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; pipe.CreateExtrudedSurface(clr, norm, _sweepOpts)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">except</span><span style="line-height: 140%">:</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; doc = Application.DocumentManager.MdiActiveDocument</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; doc.Editor.WriteMessage(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;\nFailed with CreateExtrudedSurface.&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; )</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; clr.Dispose()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; objs.Add(pipe)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">super</span><span style="line-height: 140%">(e, objs)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">class</span><span style="line-height: 140%"> CirclePipeTransformOverrule(TransformOverrule):</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: green">/*</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">&#160; An overrule to explode a circular pipe into Solid3d objects</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">&#160; */</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">static</span><span style="line-height: 140%"> theOverrule = CirclePipeTransformOverrule()</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">private</span><span style="line-height: 140%"> _sweepOpts</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">def</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">constructor</span><span style="line-height: 140%">():</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; _sweepOpts = SweepOptions()</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">override</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">def</span><span style="line-height: 140%"> Explode(e </span><span style="line-height: 140%; color: blue">as</span><span style="line-height: 140%"> Entity, objs </span><span style="line-height: 140%; color: blue">as</span><span style="line-height: 140%"> DBObjectCollection):</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; radius = PipeRadiusForObject(e)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> radius &gt; 0.0:</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; cir = e </span><span style="line-height: 140%; color: blue">as</span><span style="line-height: 140%"> Circle&#160;&#160;&#160; </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> cir.Radius &gt; radius:</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; start = cir.StartPoint</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; cen = cir.Center</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; norm = Vector3d(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; cen.X - start.X,</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; cen.Y - start.Y,</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; cen.Z - start.Z</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; )</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; clr = Circle(start, norm.CrossProduct(cir.Normal), radius)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; pipe = SweptSurface()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; pipe.CreateSweptSurface(clr, e, _sweepOpts)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; clr.Dispose()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; objs.Add(pipe)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">super</span><span style="line-height: 140%">(e, objs)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">def</span><span style="line-height: 140%"> EnableOverrule(enable):</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: green">/*</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">&#160; Regen to see the effect</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">&#160; (turn on/off Overruling and LWDISPLAY)</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">&#160; */</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; Overrule.Overruling = enable</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> enable:</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; Application.SetSystemVariable(</span><span style="line-height: 140%; color: #a31515">&quot;LWDISPLAY&quot;</span><span style="line-height: 140%">, 1)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">else</span><span style="line-height: 140%">:</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; Application.SetSystemVariable(</span><span style="line-height: 140%; color: #a31515">&quot;LWDISPLAY&quot;</span><span style="line-height: 140%">, 0)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; doc = Application.DocumentManager.MdiActiveDocument</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; doc.SendStringToExecute(</span><span style="line-height: 140%; color: #a31515">&quot;REGEN3\n&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: blue">true</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: blue">false</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: blue">false</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; doc.Editor.Regen()</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">class</span><span style="line-height: 140%"> Commands:</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; [CommandMethod(</span><span style="line-height: 140%; color: #a31515">&quot;OVERRULE1&quot;</span><span style="line-height: 140%">)]</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">def</span><span style="line-height: 140%"> Overrule1():</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green"># Only add the overrule if not currently attached</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">not</span><span style="line-height: 140%"> Globals.overruling:</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; ObjectOverrule.AddOverrule(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; RXClass.GetClass(</span><span style="line-height: 140%; color: blue">typeof</span><span style="line-height: 140%">(Line)),</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; LinePipeDrawOverrule.theOverrule,</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">true</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; )</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; ObjectOverrule.AddOverrule(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; RXClass.GetClass(</span><span style="line-height: 140%; color: blue">typeof</span><span style="line-height: 140%">(Line)),</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; LinePipeTransformOverrule.theOverrule,</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">true</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; )</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; ObjectOverrule.AddOverrule(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; RXClass.GetClass(</span><span style="line-height: 140%; color: blue">typeof</span><span style="line-height: 140%">(Circle)),</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; CirclePipeDrawOverrule.theOverrule,</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">true</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; )</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; ObjectOverrule.AddOverrule(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; RXClass.GetClass(</span><span style="line-height: 140%; color: blue">typeof</span><span style="line-height: 140%">(Circle)),</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; CirclePipeTransformOverrule.theOverrule,</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">true</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; )</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; Globals.overruling = </span><span style="line-height: 140%; color: blue">true</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; EnableOverrule(</span><span style="line-height: 140%; color: blue">true</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; [CommandMethod(</span><span style="line-height: 140%; color: #a31515">&quot;OVERRULE0&quot;</span><span style="line-height: 140%">)]</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">def</span><span style="line-height: 140%"> Overrule0():</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green"># Only remove the overrule if previously added</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> Globals.overruling:</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; ObjectOverrule.RemoveOverrule(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; RXClass.GetClass(</span><span style="line-height: 140%; color: blue">typeof</span><span style="line-height: 140%">(Line)),</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; LinePipeDrawOverrule.theOverrule</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; )</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; ObjectOverrule.RemoveOverrule(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; RXClass.GetClass(</span><span style="line-height: 140%; color: blue">typeof</span><span style="line-height: 140%">(Line)),</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; LinePipeTransformOverrule.theOverrule</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; )</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; ObjectOverrule.RemoveOverrule(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; RXClass.GetClass(</span><span style="line-height: 140%; color: blue">typeof</span><span style="line-height: 140%">(Circle)),</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; CirclePipeDrawOverrule.theOverrule</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; )</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; ObjectOverrule.RemoveOverrule(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; RXClass.GetClass(</span><span style="line-height: 140%; color: blue">typeof</span><span style="line-height: 140%">(Circle)),</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; CirclePipeTransformOverrule.theOverrule</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; )</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; Globals.overruling = </span><span style="line-height: 140%; color: blue">false</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; EnableOverrule(</span><span style="line-height: 140%; color: blue">false</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: green"># Should be able to use CommandFlags.UsePickSet instead of 2</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; [CommandMethod(</span><span style="line-height: 140%; color: #a31515">&quot;MP&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: blue">cast</span><span style="line-height: 140%">(CommandFlags,2))]</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">def</span><span style="line-height: 140%"> MakePipe():</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; doc = Application.DocumentManager.MdiActiveDocument</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; db = doc.Database</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; ed = doc.Editor</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green"># Ask the user to select the entities to make into pipes</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; pso = PromptSelectionOptions()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; pso.AllowDuplicates = </span><span style="line-height: 140%; color: blue">false</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; pso.MessageForAdding = </span><span style="line-height: 140%; color: #a31515">&quot;\nSelect objects to turn into pipes: &quot;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; selRes = ed.GetSelection(pso)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green"># If the user didn't make valid selection, we return</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green"># Should be able to use PromptStatus.OK instead of 5100</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> selRes.Status != </span><span style="line-height: 140%; color: blue">cast</span><span style="line-height: 140%">(PromptStatus,5100):</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; ss = selRes.Value</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green"># Ask the user for the pipe radius to set</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; pdo = PromptDoubleOptions(</span><span style="line-height: 140%; color: #a31515">&quot;\nSpecify pipe radius:&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green"># Use the previous value, if if already called</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> Globals.radius &gt; 0.0:</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; pdo.DefaultValue = Globals.radius</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; pdo.UseDefaultValue = </span><span style="line-height: 140%; color: blue">true</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; pdo.AllowNegative = </span><span style="line-height: 140%; color: blue">false</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; pdo.AllowZero = </span><span style="line-height: 140%; color: blue">false</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; pdr = ed.GetDouble(pdo)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green"># Return if something went wrong</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green"># Should be able to use PromptStatus.OK instead of 5100</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> pdr.Status != </span><span style="line-height: 140%; color: blue">cast</span><span style="line-height: 140%">(PromptStatus,5100):</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green"># Set the &quot;last radius&quot; value for when</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green"># the command is called next</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; Globals.radius = pdr.Value</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green"># Use a transaction to edit our various objects</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; tr = db.TransactionManager.StartTransaction()</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green"># Loop through the selected objects</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">for</span><span style="line-height: 140%"> o </span><span style="line-height: 140%; color: blue">as</span><span style="line-height: 140%"> SelectedObject </span><span style="line-height: 140%; color: blue">in</span><span style="line-height: 140%"> ss:</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green"># We could choose only to add XData to the objects</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green"># we know will use it (Lines and Circles, for now)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; obj = tr.GetObject(o.ObjectId, OpenMode.ForWrite)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; SetPipeRadiusOnObject(tr, obj, Globals.radius)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; tr.Commit()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; tr.Dispose()</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;</span><span style="line-height: 140%; color: blue">def</span><span style="line-height: 140%"> PipeRadiusForObject(obj </span><span style="line-height: 140%; color: blue">as</span><span style="line-height: 140%"> DBObject):</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: green">/*</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">&#160; Get the XData for a particular object</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">&#160; and return the &quot;pipe radius&quot; if it exists</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">&#160; */</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; res = 0.0</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">try</span><span style="line-height: 140%">:</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; rb = obj.XData</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> rb </span><span style="line-height: 140%; color: blue">is</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">null</span><span style="line-height: 140%">:</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> res</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; foundStart = </span><span style="line-height: 140%; color: blue">false</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">for</span><span style="line-height: 140%"> tv </span><span style="line-height: 140%; color: blue">as</span><span style="line-height: 140%"> TypedValue </span><span style="line-height: 140%; color: blue">in</span><span style="line-height: 140%"> rb:</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (tv.TypeCode == Globals.appCode</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">and</span><span style="line-height: 140%"> tv.Value == Globals.appName):</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; foundStart = </span><span style="line-height: 140%; color: blue">true</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">else</span><span style="line-height: 140%">:</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> foundStart:</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> tv.TypeCode == Globals.radCode:</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; res = tv.Value</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">break</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; rb.Dispose()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">except</span><span style="line-height: 140%">:</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> 0.0</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> res</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">def</span><span style="line-height: 140%"> SetPipeRadiusOnObject(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; tr </span><span style="line-height: 140%; color: blue">as</span><span style="line-height: 140%"> Transaction, obj </span><span style="line-height: 140%; color: blue">as</span><span style="line-height: 140%"> DBObject, radius</span></p>    <p style="margin: 0px"><span style="line-height: 140%">):</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: green">/*</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">&#160; Set the pipe radius as XData on a particular object</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">&#160; */</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; db = obj.Database</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: green"># Make sure the application is registered</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: green"># (we could separate this out to be called</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: green"># only once for a set of operations)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; rat </span><span style="line-height: 140%; color: blue">as</span><span style="line-height: 140%"> SymbolTable = tr.GetObject(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; db.RegAppTableId, OpenMode.ForRead</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; )</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">not</span><span style="line-height: 140%"> rat.Has(Globals.appName):</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; rat.UpgradeOpen()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; ratr = RegAppTableRecord()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; ratr.Name = Globals.appName</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; rat.Add(ratr)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; tr.AddNewlyCreatedDBObject(ratr, </span><span style="line-height: 140%; color: blue">true</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: green"># Create the XData and set it on the object</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; rb = ResultBuffer(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; TypedValue(Globals.appCode, Globals.appName),</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; TypedValue(Globals.radCode, Globals.radius)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; )</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; obj.XData = rb</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; rb.Dispose()</span></p> </div> <!--EndFragment-->  <p>Once the code is built into a Class Library, you should be able to load it via NETLOAD and execute the commands it defines, MP, OVERRULE0 and OVERRULE1.</p>  <p>As for the results of running these commands, they should be identical to what we’ve seen in the previous posts in this series. No need for yet more identical screenshots… :-)</p>  <p>I’m sure many of you are rolling your eyes at having yet another programming option presented to you… so far I’ve been presenting lots of different options, without necessarily telling people what they should use. This is deliberate: my aim is to present the information I’ve been able to glean on the various language options rather than to pass judgment on them.</p>  <p>All the languages I’ve presented thus far relate to the use of .NET, whether via the CLR or the DLR. The future may hold different decisions, depending on the product and its platform, but for now here’s my thought process when working with AutoCAD and .NET…</p>  <p>I personally expect to use C# and F# for the majority of projects upon which I work (the choice will depend on the problem domain), but I can imagine tackling the occasional task in IronPython – as it’s more stable than IronRuby at the time of writing - if I really need something more dynamic. This is likely to be for certain types of problem where dynamic – probably even self-modifying – code makes more sense to me… for the occasional project that is likely to benefit from duck typing I’m more likely to use Boo (or C#, in time). But then I’m still getting my head around the type of problem best suited to dynamic languages: these will, I’m sure, become more obvious, in time. As more of our products support dynamic language capabilities directly this will also play a role in the decision process.</p>
