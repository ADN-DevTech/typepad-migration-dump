---
layout: "post"
title: "Gluing a point to an AutoCAD curve using overrules from .NET &ndash; Part 2"
date: "2009-08-26 22:52:09"
author: "Kean Walmsley"
categories:
  - "AutoCAD"
  - "AutoCAD .NET"
  - "Geometry"
  - "Notification / Events"
  - "Overrules"
original_url: "https://www.keanw.com/2009/08/gluing-a-point-to-an-autocad-curve-using-overrules-from-net-part-1-1.html "
typepad_basename: "gluing-a-point-to-an-autocad-curve-using-overrules-from-net-part-1-1"
typepad_status: "Publish"
---

<p>In <a href="http://through-the-interface.typepad.com/through_the_interface/2009/08/gluing-a-point-to-an-autocad-curve-using-overrules-from-net-part-1.html">the last post</a> we looked at some code to create a point on a curve, and make sure it stays on that curve when edited.</p>  <p>In this post we’re extending that code (albeit slightly) to work with a network of curves: the idea is that any curve which has a point created on it becomes a candidate for any point to snap onto as it moves around. This could clearly be extended to provided a better way of specifying the curves forming the network, of course.</p>  <p>Here’s the updated C# code, with the modified/new lines in <font color="#ff0000">red</font> (the full source file is available <span class="at-xid-6a00d83452464869e20120a521cfce970b"><a href="http://through-the-interface.typepad.com/files/transform-overrule-point-on-network.cs">here</a></span>):</p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160;&#0160; 1</span>&#0160;<span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.ApplicationServices;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160;&#0160; 2</span>&#0160;<span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.DatabaseServices;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160;&#0160; 3</span>&#0160;<span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.EditorInput;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160;&#0160; 4</span>&#0160;<span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.Geometry;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160;&#0160; 5</span>&#0160;<span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.Runtime;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160;&#0160; 6</span>&#0160;<span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> System.Collections.Generic;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160;&#0160; 7</span>&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160;&#0160; 8</span>&#0160;<span style="line-height: 140%; color: blue">namespace</span><span style="line-height: 140%"> PointOnCurveTest</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160;&#0160; 9</span>&#0160;<span style="line-height: 140%">{</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 10</span>&#0160;<span style="line-height: 140%">&#0160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">class</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">PtTransOverrule</span><span style="line-height: 140%"> : </span><span style="line-height: 140%; color: #2b91af">TransformOverrule</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 11</span>&#0160;<span style="line-height: 140%">&#0160; {</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 12</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">// A static pointer to our overrule instance</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 13</span>&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 14</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">static</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">PtTransOverrule</span><span style="line-height: 140%"> theOverrule =</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 15</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">PtTransOverrule</span><span style="line-height: 140%">();</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 16</span>&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 17</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">// A list of the curves that have had points</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 18</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">// attached to</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 19</span>&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 20</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">static</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">internal</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">List</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: #2b91af">ObjectId</span><span style="line-height: 140%">&gt; _curves =</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 21</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">List</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: #2b91af">ObjectId</span><span style="line-height: 140%">&gt;();</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 22</span>&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 23</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">// A flag to indicate whether we&#39;re overruling</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 24</span>&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 25</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">static</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">bool</span><span style="line-height: 140%"> overruling = </span><span style="line-height: 140%; color: blue">false</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 26</span>&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 27</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> PtTransOverrule() { }</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 28</span>&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 29</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">// Out primary overruled function</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 30</span>&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 31</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">override</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> TransformBy(</span><span style="line-height: 140%; color: #2b91af">Entity</span><span style="line-height: 140%"> e, </span><span style="line-height: 140%; color: #2b91af">Matrix3d</span><span style="line-height: 140%"> mat)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 32</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160; {</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 33</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">// We only care about points</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 34</span>&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 35</span>&#0160;&#0160;&#0160; <span style="line-height: 140%">&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af">DBPoint</span><span style="line-height: 140%"> pt = e </span><span style="line-height: 140%; color: blue">as</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">DBPoint</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 36</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (pt != </span><span style="line-height: 140%; color: blue">null</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 37</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 38</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af">Database</span><span style="line-height: 140%"> db = </span><span style="line-height: 140%; color: #2b91af">HostApplicationServices</span><span style="line-height: 140%">.WorkingDatabase;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 39</span>&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="color: red">&#0160;&#0160; 40</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">// Work through the curves to find the closest to our</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: red">&#0160;&#0160; 41</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">// transformed point</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: red">&#0160;&#0160; 42</span>&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="color: red">&#0160;&#0160; 43</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">double</span><span style="line-height: 140%"> min = 0.0;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: red">&#0160;&#0160; 44</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af">Point3d</span><span style="line-height: 140%"> bestPt = </span><span style="line-height: 140%; color: #2b91af">Point3d</span><span style="line-height: 140%">.Origin;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: red">&#0160;&#0160; 45</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">bool</span><span style="line-height: 140%"> first = </span><span style="line-height: 140%; color: blue">true</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 46</span>&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 47</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">// We&#39;re using an Open/Close transaction, to avoid</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 48</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">// problems with us using transactions in an event</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 49</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">// handler</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 50</span>&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 51</span>&#0160;&#0160;&#0160; <span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af">OpenCloseTransaction</span><span style="line-height: 140%"> tr =</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 52</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; db.TransactionManager.StartOpenCloseTransaction();</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 53</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> (tr)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 54</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 55</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">foreach</span><span style="line-height: 140%"> (</span><span style="line-height: 140%; color: #2b91af">ObjectId</span><span style="line-height: 140%"> curId </span><span style="line-height: 140%; color: blue">in</span><span style="line-height: 140%"> _curves)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 56</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 57</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af">DBObject</span><span style="line-height: 140%"> obj =</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 58</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; tr.GetObject(curId, </span><span style="line-height: 140%; color: #2b91af">OpenMode</span><span style="line-height: 140%">.ForRead);</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 59</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af">Curve</span><span style="line-height: 140%"> cur = obj </span><span style="line-height: 140%; color: blue">as</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Curve</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 60</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (cur != </span><span style="line-height: 140%; color: blue">null</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 61</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: red">&#0160;&#0160; 62</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af">Point3d</span><span style="line-height: 140%"> ptLoc =</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: red">&#0160;&#0160; 63</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; pt.Position.TransformBy(mat);</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: red">&#0160;&#0160; 64</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af">Point3d</span><span style="line-height: 140%"> ptOnCurve =</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: red">&#0160;&#0160; 65</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; cur.GetClosestPointTo(ptLoc, </span><span style="line-height: 140%; color: blue">false</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: red">&#0160;&#0160; 66</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af">Vector3d</span><span style="line-height: 140%"> dist = ptOnCurve - ptLoc;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: red">&#0160;&#0160; 67</span>&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="color: red">&#0160;&#0160; 68</span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="line-height: 140%">&#0160;&#0160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (first || dist.Length &lt; min)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: red">&#0160;&#0160; 69</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: red">&#0160;&#0160; 70</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; first = </span><span style="line-height: 140%; color: blue">false</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: red">&#0160;&#0160; 71</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; min = dist.Length;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: red">&#0160;&#0160; 72</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; bestPt = ptOnCurve;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: red">&#0160;&#0160; 73</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 74</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 75</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: red">&#0160;&#0160; 76</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; pt.Position = bestPt;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 77</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 78</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 79</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160; }</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 80</span>&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 81</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160; [</span><span style="line-height: 140%; color: #2b91af">CommandMethod</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: #a31515">&quot;POC&quot;</span><span style="line-height: 140%">)]</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 82</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> CreatePointOnCurve()</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 83</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160; {</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 84</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af">Document</span><span style="line-height: 140%"> doc =</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 85</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af">Application</span><span style="line-height: 140%">.DocumentManager.MdiActiveDocument;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 86</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af">Database</span><span style="line-height: 140%"> db = doc.Database;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 87</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af">Editor</span><span style="line-height: 140%"> ed = doc.Editor;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 88</span>&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 89</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">// Ask the user to select a curve</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 90</span>&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 91</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af">PromptEntityOptions</span><span style="line-height: 140%"> opts =</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 92</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">PromptEntityOptions</span><span style="line-height: 140%">(</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 93</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #a31515">&quot;\nSelect curve at the point to create: &quot;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 94</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; );</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 95</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; opts.SetRejectMessage(</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 96</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #a31515">&quot;\nEntity must be a curve.&quot;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 97</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; );</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 98</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; opts.AddAllowedClass(</span><span style="line-height: 140%; color: blue">typeof</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: #2b91af">Curve</span><span style="line-height: 140%">), </span><span style="line-height: 140%; color: blue">false</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160;&#0160; 99</span>&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 100</span>&#0160;&#0160;&#0160; <span style="line-height: 140%">&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af">PromptEntityResult</span><span style="line-height: 140%"> per = ed.GetEntity(opts);</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 101</span>&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 102</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af">ObjectId</span><span style="line-height: 140%"> curId = per.ObjectId;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 103</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (curId != </span><span style="line-height: 140%; color: #2b91af">ObjectId</span><span style="line-height: 140%">.Null)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 104</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 105</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">// Let&#39;s make sure we&#39;ll be able to see our point</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 106</span>&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 107</span>&#0160;&#0160;&#0160; <span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160; db.Pdmode = 97;&#0160; </span><span style="line-height: 140%; color: green">// square with a circle</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 108</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; db.Pdsize = -10; </span><span style="line-height: 140%; color: green">// relative to the viewport size</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 109</span>&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 110</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af">Transaction</span><span style="line-height: 140%"> tr =</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 111</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; doc.TransactionManager.StartTransaction();</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 112</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> (tr)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 113</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 114</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af">DBObject</span><span style="line-height: 140%"> obj =</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 115</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; tr.GetObject(curId, </span><span style="line-height: 140%; color: #2b91af">OpenMode</span><span style="line-height: 140%">.ForRead);</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 116</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af">Curve</span><span style="line-height: 140%"> cur = obj </span><span style="line-height: 140%; color: blue">as</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Curve</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 117</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (cur != </span><span style="line-height: 140%; color: blue">null</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 118</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 119</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">// Our initial point should be the closest point</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 120</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">// on the curve to the one picked</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 121</span>&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 122</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af">Point3d</span><span style="line-height: 140%"> pos =</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 123</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; cur.GetClosestPointTo(per.PickedPoint, </span><span style="line-height: 140%; color: blue">false</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 124</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af">DBPoint</span><span style="line-height: 140%"> pt = </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">DBPoint</span><span style="line-height: 140%">(pos);</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 125</span>&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 126</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">// Add it to the same space as the curve</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 127</span>&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 128</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af">BlockTableRecord</span><span style="line-height: 140%"> btr =</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 129</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (</span><span style="line-height: 140%; color: #2b91af">BlockTableRecord</span><span style="line-height: 140%">)tr.GetObject(</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 130</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; cur.BlockId,</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 131</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af">OpenMode</span><span style="line-height: 140%">.ForWrite</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 132</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; );</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 133</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af">ObjectId</span><span style="line-height: 140%"> ptId = btr.AppendEntity(pt);</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 134</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; tr.AddNewlyCreatedDBObject(pt, </span><span style="line-height: 140%; color: blue">true</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 135</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 136</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; tr.Commit();</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 137</span>&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 138</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">// And add the curve to our central list</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 139</span>&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 140</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; _curves.Add(curId);</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 141</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 142</span>&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 143</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">// Turn on the transform overrule if it isn&#39;t already</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 144</span>&#0160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 145</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (!overruling)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 146</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 147</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af">ObjectOverrule</span><span style="line-height: 140%">.AddOverrule(</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 148</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af">RXClass</span><span style="line-height: 140%">.GetClass(</span><span style="line-height: 140%; color: blue">typeof</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: #2b91af">DBPoint</span><span style="line-height: 140%">)),</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 149</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af">PtTransOverrule</span><span style="line-height: 140%">.theOverrule,</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 150</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">true</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 151</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; );</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 152</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; overruling = </span><span style="line-height: 140%; color: blue">true</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 153</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af">TransformOverrule</span><span style="line-height: 140%">.Overruling = </span><span style="line-height: 140%; color: blue">true</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 154</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 155</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 156</span>&#0160;<span style="line-height: 140%">&#0160;&#0160;&#0160; }</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 157</span>&#0160;<span style="line-height: 140%">&#0160; }</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="color: #2b91af">&#0160; 158</span>&#0160;<span style="line-height: 140%">}</span></p> </div>  <p>Now after having run our POC command to add points to a number of curves – effectively adding them to the “network” – we can grip-move a point, and should another curve in the network be closer, the point being edited will snap across to that one:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e20120a5789cda970c-pi"><img alt="Moving a point between curves" border="0" height="214" src="/assets/image_7801.jpg" style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="Moving a point between curves" width="485" /></a></p>
