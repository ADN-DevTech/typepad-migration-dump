---
layout: "post"
title: "Handling DPI scaling in your .NET application&rsquo;s forms"
date: "2011-03-11 16:34:27"
author: "Kean Walmsley"
categories:
  - "User interface"
  - "Visual Studio"
original_url: "https://www.keanw.com/2011/03/handling-dpi-scaling-in-your-net-applications-forms.html "
typepad_basename: "handling-dpi-scaling-in-your-net-applications-forms"
typepad_status: "Publish"
---

<p><em>This topic isn’t at all specific to AutoCAD – in fact it was encountered by Adam Nagy with the recent <a href="http://labs.autodesk.com/utilities/ADN_plugins" target="_blank">Plugin of the Month</a> he developed for Revit – but it seemed something people might hit. Thanks to Adam for proposing this topic and providing the information to share with everyone. :-)</em></p>  <p>In recent versions of Windows – at least with Vista and Windows 7, but perhaps versions before that – it’s possible for the user to adjust DPI Scaling options on their system as part of the usability/accessibility options. This can cause issues with how your dialogs are displayed, as sometimes the contents are scaled beyond the size of the dialog itself.</p>  <p>On Vista it’s this setting is accessible via <strong>Control Panel</strong> –&gt; <strong>Ease of Access</strong> –&gt; <strong>Optimize visual display</strong> (or <strong>Personalization</strong> –&gt; <strong>Adjust font size (DPI)</strong>, if in Classic View):</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2014e5fcabb3a970c-pi"><img style="background-image: none; border-right-width: 0px; margin: 0px auto; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="Getting to the settings on Vista" border="0" alt="Getting to the settings on Vista" src="/assets/image_411210.jpg" width="423" height="319" /></a></p>  <p>The DPI settings can be modified in the following dialog:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e20147e325b2b0970b-pi"><img style="background-image: none; border-right-width: 0px; margin: 0px auto; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="Vista DPI Scaling" border="0" alt="Vista DPI Scaling" src="/assets/image_594912.jpg" width="296" height="319" /></a></p>  <p>On Windows 7, things look a little different (I don’t have a Windows 7 machine, so am using a screenshot of Adam’s for this):</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2014e5fcabb92970c-pi"><img style="background-image: none; border-right-width: 0px; margin: 0px auto; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="Win7 DPI Scaling" border="0" alt="Win7 DPI Scaling" src="/assets/image_198495.jpg" width="475" height="305" /></a></p>  <p>As mentioned, the problem can potentially arise that DPI scaling leads to dialog content scaling beyond the dialog’s limits. When the setting was at 150% Win7, Adam’s Revit plugin’s main form was cropped at the bottom.</p>  <p>I will admit, despite my efforts to reproduce this behaviour in a standalone application on Windows Vista, I have not been able to. A comparable dialog looks like this at 96 and 120 DPI, respectively:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2014e86a5b873970d-pi"><img style="background-image: none; border-right-width: 0px; margin: 0px 20px 0px 10px; padding-left: 0px; padding-right: 0px; display: inline; float: left; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="The dialog at 96 DPI" border="0" alt="The dialog at 96 DPI" align="left" src="/assets/image_21010.jpg" width="209" height="144" /></a></p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2014e86a5b890970d-pi"><img style="background-image: none; border-right-width: 0px; margin: 0px 10px 0px 20px; padding-left: 0px; padding-right: 0px; display: inline; float: right; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="The dialog at 120 DPI" border="0" alt="The dialog at 120 DPI" align="right" src="/assets/image_398573.jpg" width="204" height="144" /></a></p>  <p>&#160;</p>  <p>&#160;</p>  <p>&#160;</p>  <p>&#160;</p>  <p>&#160;</p>  <p>Obviously neither are cropped, but presumably scaling further – and perhaps the fact the plugin is hosted in Revit rather than standalone – can cause unwanted content cropping.</p>  <p>The solution Adam found was to edit the form’s properties, to make sure it a) AutoSized and b) used the <strong>Dpi</strong> AutoScaleMode:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e20147e325b341970b-pi"><img style="background-image: none; border-right-width: 0px; margin: 0px auto; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="Form properties" border="0" alt="Form properties" src="/assets/image_94133.jpg" width="323" height="315" /></a></p>  <p>This scenario was new to me, but I do suggest testing your applications with the DPI scaling set to 150%, to make sure it doesn’t cause a problem for your GUI.</p>  <p>A quick tip that saved me time during my failed efforts to reproduce the erroneous behaviour: after changing the setting you can simply log out rather than performing a full reboot (as was recommended by Vista, at least).</p>
