---
layout: "post"
title: "AutoCAD 2008 - new ObjectARX samples"
date: "2007-02-14 19:00:00"
author: "Kean Walmsley"
categories:
  - "AutoCAD"
  - "ObjectARX"
original_url: "https://www.keanw.com/2007/02/autocad_2008_ne.html "
typepad_basename: "autocad_2008_ne"
typepad_status: "Publish"
---

<p>The coming posts will look at the various new APIs in AutoCAD 2008. Here is the way I’ve decided to serialize the information:</p>

<ul><li><strong>New ObjectARX samples</strong> - this post</li>

<li><strong>New .NET samples</strong> - the next post</li>

<li><strong>Other new APIs</strong> - the following post</li></ul>

<p>So this post focuses on the new C++ samples on the ObjectARX SDK for AutoCAD 2008, talking about their corresponding features and APIs. Thanks to Stephen Preston, our DevTech Americas Manager and the presenter you may seen in <a href="http://through-the-interface.typepad.com/through_the_interface/2007/02/autocad_2008_64.html">the previous post</a>, for providing the bulk of this information.</p>

<p><strong>Annotation Scaling</strong></p>

<p>One of the most highly anticipated new features in AutoCAD 2008 is annotation scaling. This new feature addresses the problem of getting annotation elements to display at the same ‘paper size’, regardless of the scale of the viewport they are displayed in. In the past, users would normally address this problem by adding multiple versions of the same annotations on different layers, and turning those layers on or off depending on the viewport scale. This new feature avoids all that by allowing the user to simply specify the display size of each annotation object for each viewport layer it displays in. </p>

<p>The sample demonstrates how your application and any custom entities it defines can work seamlessly with the annotation scaling feature. Annotation scaling works through Protocol Extensions, but (unlike most protocol extensions) it does require code to be added to your custom entity.</p>

<p>The sample shows how to derive a custom entity from a standard annotative entity and add additional annotative features to it. The standard annotative entities are:</p>

<ul><li>AcDbText</li>

<li>AcDbMText</li>

<li>AcDbHatch</li>

<li>AcDbBlockReference</li>

<li>AcDbDimension</li>

<li>AcDbLeader</li>

<li>AcDbFcf</li></ul>

<p>For those of you not interested in custom entities, the sample also demonstrates how to query and manipulate the annotation scales and entities in a drawing.</p>

<p><strong>Table</strong></p>

<p>AcDbTable and its associated classes have been greatly enhanced in this release. They are well worth a look – of particular interest is the increased capacity to link between AutoCAD Tables and Excel worksheets.</p>

<p>We’ve added additional commands to the existing ObjectARX sample to demonstrate:</p>

<ul><li>Creating a data link between a table and an Excel worksheet.</li>

<li>Breaking a table (and then restoring it afterwards)</li>

<li>Creating a template from an existing table that can then easily be used to set the same style for other tables.</li>

<li>Adding multiple content to a single table cell – a mix of blocks and text, for example.</li></ul>

<p>The Table API also includes other formatting enhancements to more fully control the style of the table. These include cell styles, auto-fill, cell tooltips, cell locking, and formulae.</p>

<p><strong>SectionPlane</strong></p>

<p>A section plane allows you to display a section, or slice, through three dimensional geometry in your drawing. The feature was introduced in AutoCAD 2007, and we included a very simple demonstration of the API in the ObjectARX 2007 SDK Surface_Helix sample. To better demonstrate this feature, we’ve now enhanced the functionality and broken it out into its own sample.</p>

<p>The new sample allows you to define a section plane in your drawing and then walk the section through your geometry, recording snapshots of the section as you go. The snapshots are recorded as block table records. Other commands demonstrate querying section properties.</p>

<p><strong>Material</strong></p>

<p>AutoCAD 2008 has filled in a few of the missing pieces from the 3D-oriented AutoCAD 2007 release. One area we’ve enhanced is the use of materials inside AutoCAD. Our aim is to provide all the functionality in AutoCAD that previously required the VIZ Render application.</p>

<p>The existing material sample has been extended to demonstrate the use of the new procedural material types – speckle, wave, checker and tile. The sample also expands previous commands to show how to assign materials and landscape materials to a custom entity.</p>

<p><strong>Render</strong></p>

<p>Another enhancement to the AutoCAD visualization functionality in this release is enhanced lighting. (What’s the use of all these new materials styles if you can’t light them properly? :-)</p>

<p>This release sees the introduction of parametric lighting, including support for the Illuminating Engineering Society (IES) ‘web’ file format.</p>

<p>Other features include: enhanced sun and skylight properties; tone operator support for high dynamic range lighting in scenes; and a new look 3D sky background for the interactive viewport; </p>

<p>The Render sample has been extended to demonstrate the use of these new lighting and shadow effects.</p>

<p><em>Note on VSPROPS:</em></p><blockquote dir="ltr"><p>All our ObjectARX samples have now been updated to make use of common &quot;<a href="http://msdn2.microsoft.com/en-us/library/a4xbdz1e(VS.80).aspx">project property sheet</a>&quot; (VSPROPS) files. These files store common Visual Studio (C++) project properties, which clearly help reduce the effort required to maintain these settings in each of our various samples, as well as demonstrating how to use this useful Visual Studio feature. The relative paths to these property files are hardcoded in the sample project settings, so you’ll need to edit them if you copy a sample to a different location. These VSPROPS files (rxsdk_common.vsprops, rxsdk_debugcfg.vsprops, rxsdk_releasecfg.vsprops) are stored in the ObjectARX SDK inc folders.</p></blockquote>
