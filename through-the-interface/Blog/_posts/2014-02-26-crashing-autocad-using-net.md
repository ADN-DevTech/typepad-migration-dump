---
layout: "post"
title: "Crashing AutoCAD using .NET"
date: "2014-02-26 18:15:10"
author: "Kean Walmsley"
categories:
  - "AutoCAD"
  - "AutoCAD .NET"
  - "Runtime"
original_url: "https://www.keanw.com/2014/02/crashing-autocad-using-net.html "
typepad_basename: "crashing-autocad-using-net"
typepad_status: "Publish"
---

<p>I’m still mainly on holiday this week, so this is a really silly post that I don’t realistically expect to be of use to anyone. But then you never know. :-)</p>  <p>A colleague in Product Support asked me for a quick way to cause AutoCAD to crash, the other day. I didn’t ask too much about why he needed to – I trusted he had his reasons – and so went ahead and gave it a try.</p>  <p>One very standard way to cause software to crash – at least software that is either written using a pointer-friendly programming language or implements a plugin model that can load in-process modules that are – is to dereference a null pointer. My first thought was to attempt to do this in LISP, whether by applying a nil pointer as a lambda function or something along those lines. I didn’t have much, though, and neither did I find an undocumented “CRASH” command that could be used, so I ended up implementing something very simple in C#.</p>  <p>And here it is:</p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.Runtime;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">namespace</span><span style="line-height: 140%"> CrashAutoCAD</span></p>    <p style="margin: 0px"><span style="line-height: 140%">{</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">class</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Commands</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; [</span><span style="line-height: 140%; color: #2b91af">CommandMethod</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: #a31515">&quot;CRASH&quot;</span><span style="line-height: 140%">)]</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">static</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> Crash()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">object</span><span style="line-height: 140%"> o = </span><span style="line-height: 140%; color: blue">null</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; o.ToString();</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">}</span></p> </div>  <p>When we run our CRASH command we see this:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201a51176ccab970c-pi" target="_blank"><img style="background-image: none; border-bottom: 0px; border-left: 0px; margin: 20px auto; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top: 0px; border-right: 0px; padding-top: 0px" title="Crash" border="0" alt="Crash" src="/assets/image_378742.jpg" width="234" height="111" /></a></p>  <p>And then, predictably enough, this:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201a3fcc6e86d970b-pi" target="_blank"><img style="background-image: none; border-bottom: 0px; border-left: 0px; margin: 20px auto; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top: 0px; border-right: 0px; padding-top: 0px" title="CER dialog" border="0" alt="CER dialog" src="/assets/image_103049.jpg" width="254" height="334" /></a></p>  <p>If any of you have tricks to crash AutoCAD that doesn’t involve a plugin, please do let me know – I’d be interested to hear about them.</p>
