---
layout: "post"
title: "Commands that &ldquo;work&rdquo; in the AutoCAD 2013 Core Console"
date: "2012-03-23 06:39:00"
author: "Kean Walmsley"
categories:
  - "AutoCAD"
  - "AutoCAD .NET"
  - "Core Console"
original_url: "https://www.keanw.com/2012/03/commands-that-work-in-the-autocad-2013-core-console.html "
typepad_basename: "commands-that-work-in-the-autocad-2013-core-console"
typepad_status: "Publish"
---

<p>After seeing the feedback regarding <a href="http://through-the-interface.typepad.com/through_the_interface/2012/02/the-autocad-2013-core-console.html" target="_blank">this interesting feature in AutoCAD 2013</a>, I decided to do a little detective work to establish which commands could be called from inside the AutoCAD 2013 Core Console. I hope this proves to be of use to at least some of the many people I expect to take advantage of this tool.</p>
<p>Before I go into the details on generating the list – and then look at the list itself – it’s worth mentioning some additional background regarding this feature. I certainly see the Core Console as being extremely useful to many people, but it didn’t necessarily start life as a headline feature for the 2013 release. It was made possible by the Big Split, and proved to be a good, early way to test out the capabilities of <em>AcCore.dll</em>, but it only became part of the product later in the product cycle. It’s been used to implement at least one core feature inside AutoCAD 2013 – and I can certainly see it as being used much more extensively, over time – but this is a tool that has not yet benefited from much documentation investment (for instance). And – as we’ll see later on – there are even some areas you just want to avoid: our test suite includes various commands to ensure our internal developers don’t break important Core Console functionality, but there are full AutoCAD commands that currently prove problematic when executed from within the Core Console.</p>
<p>Generating the list was an interesting process: I started by implementing a core .NET module that read in the commands to test from a file (for AutoCAD OEM we maintain a list of AutoCAD commands in a file called OEMCMDS.txt, which I borrowed for this process). This module then queued up each command using SendStringToExecute() and fired off a simple AutoLISP function right after to check whether the command was active via CMDNAMES (or whether it was a sysvar – these are also included in the list) before cancelling the command (if it was still running) via an escape character. The LISP function wrote the name of the command or sysvar to the relevant file (for known or unknown commands). I also piped the output of the Core Console execution off to another text file, to help cross-check any issues.</p>
<p>This worked well enough, but didn’t show whether commands that succeeded and returned without any user input worked or not (it assumed they did not, as they were no longer active). So I went back to the drawing board and attached some event handlers from C# to watch for commands that started and those that weren’t found. These ended up proving much more reliable for commands, but less reliable for system variables.</p>
<p>Speaking of system variables: these have apparently not been stripped out of the Core Console, but many of the commands (and internal code) that use them won’t be available, so please adjust your expectations accordingly.</p>
<p>Here’s the C# code I used to generate the command lists:</p>
<div style="font-family: courier new; background: white; color: black; font-size: 8pt;">
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> Autodesk.AutoCAD.ApplicationServices.Core;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> Autodesk.AutoCAD.ApplicationServices;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> Autodesk.AutoCAD.EditorInput;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> Autodesk.AutoCAD.Runtime;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> System.Collections.Generic;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> System.IO;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> System.Linq;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">namespace</span><span style="line-height: 140%;"> TestCommandsForCoreConsole</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="line-height: 140%; color: blue;">public</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">class</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">Commands</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">// Lists to be populated by our events</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af;">List</span><span style="line-height: 140%;">&lt;</span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;">&gt; _found = </span><span style="line-height: 140%; color: blue;">null</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af;">List</span><span style="line-height: 140%;">&lt;</span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;">&gt; _notFound = </span><span style="line-height: 140%; color: blue;">null</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">// Command to test the various commands in the console</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; [</span><span style="line-height: 140%; color: #2b91af;">CommandMethod</span><span style="line-height: 140%;">(</span><span style="line-height: 140%; color: #a31515;">&quot;TCS&quot;</span><span style="line-height: 140%;">)]</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">public</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">void</span><span style="line-height: 140%;"> TestCommands()</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af;">Document</span><span style="line-height: 140%;"> doc =</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af;">Application</span><span style="line-height: 140%;">.DocumentManager.MdiActiveDocument;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af;">Editor</span><span style="line-height: 140%;"> ed = doc.Editor;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">// Create or clear our command lists</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">if</span><span style="line-height: 140%;"> (_found == </span><span style="line-height: 140%; color: blue;">null</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; _found = </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">List</span><span style="line-height: 140%;">&lt;</span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;">&gt;();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">else</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; _found.Clear();</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">if</span><span style="line-height: 140%;"> (_notFound == </span><span style="line-height: 140%; color: blue;">null</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; _notFound = </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">List</span><span style="line-height: 140%;">&lt;</span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;">&gt;();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">else</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; _notFound.Clear();</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">// Attach our event handlers</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160; doc.UnknownCommand +=</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">UnknownCommandEventHandler</span><span style="line-height: 140%;">(OnUnknownCommand);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160; doc.CommandWillStart +=</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">CommandEventHandler</span><span style="line-height: 140%;">(OnCommandWillStart);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">// Read in the list of commands to execute</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">var</span><span style="line-height: 140%;"> values =</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">from</span><span style="line-height: 140%;"> l </span><span style="line-height: 140%; color: blue;">in</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">File</span><span style="line-height: 140%;">.ReadAllLines(</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #a31515;">&quot;c:\\users\\walmslk\\desktop\\OEMCMDS.TXT&quot;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; )</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">let</span><span style="line-height: 140%;"> cols = l.Split(</span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;">[] { </span><span style="line-height: 140%; color: #a31515;">&#39;;&#39;</span><span style="line-height: 140%;"> })</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">select</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> { Command = cols.First() };</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">foreach</span><span style="line-height: 140%;"> (</span><span style="line-height: 140%; color: blue;">var</span><span style="line-height: 140%;"> obj </span><span style="line-height: 140%; color: blue;">in</span><span style="line-height: 140%;"> values)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; doc.SendStringToExecute(</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; obj.Command + </span><span style="line-height: 140%; color: #a31515;">&quot; \x1B&quot;</span><span style="line-height: 140%;">, </span><span style="line-height: 140%; color: blue;">false</span><span style="line-height: 140%;">, </span><span style="line-height: 140%; color: blue;">true</span><span style="line-height: 140%;">, </span><span style="line-height: 140%; color: blue;">true</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; );</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">// Dump our collected commands out to text files</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160; doc.SendStringToExecute(</span><span style="line-height: 140%; color: #a31515;">&quot;DUMPCMDS &quot;</span><span style="line-height: 140%;">, </span><span style="line-height: 140%; color: blue;">false</span><span style="line-height: 140%;">, </span><span style="line-height: 140%; color: blue;">true</span><span style="line-height: 140%;">, </span><span style="line-height: 140%; color: blue;">true</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; }</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">void</span><span style="line-height: 140%;"> OnCommandWillStart(</span><span style="line-height: 140%; color: blue;">object</span><span style="line-height: 140%;"> sender, </span><span style="line-height: 140%; color: #2b91af;">CommandEventArgs</span><span style="line-height: 140%;"> e)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> cmd = e.GlobalCommandName;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">if</span><span style="line-height: 140%;"> (!_found.Contains(cmd) &amp;&amp;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (cmd != </span><span style="line-height: 140%; color: #a31515;">&quot;SETVAR&quot;</span><span style="line-height: 140%;"> || cmd != </span><span style="line-height: 140%; color: #a31515;">&quot;DUMPCMDS&quot;</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; )</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; _found.Add(cmd);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">if</span><span style="line-height: 140%;"> (_notFound.Contains(cmd))</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; _notFound.Remove(cmd);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; }</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">void</span><span style="line-height: 140%;"> OnUnknownCommand(</span><span style="line-height: 140%; color: blue;">object</span><span style="line-height: 140%;"> sender, </span><span style="line-height: 140%; color: #2b91af;">UnknownCommandEventArgs</span><span style="line-height: 140%;"> e)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> cmd = e.GlobalCommandName;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">if</span><span style="line-height: 140%;"> (!_notFound.Contains(cmd))</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; _notFound.Add(cmd);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; }</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">void</span><span style="line-height: 140%;"> WriteCommands(</span><span style="line-height: 140%; color: #2b91af;">List</span><span style="line-height: 140%;">&lt;</span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;">&gt; cmds, </span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> answer)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af;">StreamWriter</span><span style="line-height: 140%;"> sw =</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">StreamWriter</span><span style="line-height: 140%;">(</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #a31515;">&quot;c:\\users\\walmslk\\desktop\\events-&quot;</span><span style="line-height: 140%;"> + answer + </span><span style="line-height: 140%; color: #a31515;">&quot;.txt&quot;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; );</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> (sw)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">foreach</span><span style="line-height: 140%;"> (</span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> cmd </span><span style="line-height: 140%; color: blue;">in</span><span style="line-height: 140%;"> cmds)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; sw.WriteLine(cmd);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; sw.Close();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; }</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; [</span><span style="line-height: 140%; color: #2b91af;">CommandMethod</span><span style="line-height: 140%;">(</span><span style="line-height: 140%; color: #a31515;">&quot;DUMPCMDS&quot;</span><span style="line-height: 140%;">)]</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">public</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">void</span><span style="line-height: 140%;"> DumpCommands()</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160; _found.Sort();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160; _notFound.Sort();</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160; WriteCommands(_found, </span><span style="line-height: 140%; color: #a31515;">&quot;yes&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160; WriteCommands(_notFound, </span><span style="line-height: 140%; color: #a31515;">&quot;no&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af;">Document</span><span style="line-height: 140%;"> doc =</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af;">Application</span><span style="line-height: 140%;">.DocumentManager.MdiActiveDocument;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af;">Editor</span><span style="line-height: 140%;"> ed = doc.Editor;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160; doc.UnknownCommand -=</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">UnknownCommandEventHandler</span><span style="line-height: 140%;">(OnUnknownCommand);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160; doc.CommandWillStart -=</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">CommandEventHandler</span><span style="line-height: 140%;">(OnCommandWillStart);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160; ed.WriteMessage(</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #a31515;">&quot;\nFound a total of {0} commands, didn&#39;t find {1} others.&quot;</span><span style="line-height: 140%;">,</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; _found.Count, _notFound.Count</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160; );</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
<p>Here’s a list of the 573 commands I found to be available in the Core Console (and <a href="http://through-the-interface.typepad.com/files/Working%20Core%20Console%20commands.txt" target="_blank">here they are as a text file</a>):</p>
<p><span style="font-size: xx-small;">?, +CONSTRAINTSETTINGS, +PUBLISH, +SAVEAS, +UCSMAN, +VPORTS, 3DALIGN, 3DCLIP, -3DCONFIG, 3DCONFIG, 3DCORBIT, 3DDISTANCE, 3DDWF, 3DDWFPUBLISH, 3DEDITBAR, 3DFACE, 3DFLY, 3DFORBIT, 3DMESH, 3DMOVE, 3DORBIT, 3DORBITCTR, 3DORBITTRANSPARENT, -3DOSNAP, 3DOSNAP, 3DPAN, 3DPAN2, 3DPANTRANSPARENT, 3DPOLY, 3DROTATE, 3DSCALE, 3DSWIVEL, 3DSWIVELTRANSPARENT, 3DWALK, 3DZOOM, 3DZOOM2, 3DZOOMTRANSPARENT, ABOUT, ACADWBLOCKDIALOG, ACGZDRAGACTION, ACISIN, ACISOUT, ACTMDRAGACTION, ACUCSEDITACTION, ADDSELECTED, AECDISPLAYMANAGERCONFIGSSELECTION, -AECDWGUNITS, -AECEXPORTTOAUTOCAD, AECFILEOPENMESSAGE, AECFILESAVEMESSAGE, AECOBJECTCOPYMESSAGE, AECOBJRELDUMP, AECOBJRELSHOW, AECOBJRELUPDATE, AECPOSTDXFINFIX, AECSETXREFCONFIG, AECVERSION, AI_EMPTYPRINC, AI_MOLC, AI_VIEWPORTS_ALERT, AIDIMFLIPARROW, AIDIMPREC, AIDIMSTYLE, AIDIMTEXTMOVE, AIMLEADEREDITADD, AIMLEADEREDITREMOVE, AIOBJECTSCALEADD, AIOBJECTSCALEREMOVE, ALIGN, ALLPLAY, AMECONVERT, ANNORESET, ANNOUPDATE, APERTURE, ARC, AREA, -ARRAY, ARRAY, -ARRAYCLOSE, ARRAYCLOSE, ARRAYEDIT, ARRAYPATH, ARRAYPOLAR, ARRAYRECT, ARX, -ATTDEF, ATTDEF, ATTDISP, -ATTEDIT, ATTEDIT, -ATTEXT, ATTEXT, AUDIT, AUTOCOMPLETE, AUTOCONSTRAIN, AUTOPUBLISH, BASE, -BHATCH, BHATCH, BLEND, -BLOCK, BLOCK, BLOOKUPTABLE, BMAKE, BMOD, BMPOUT, -BOUNDARY, BOUNDARY, BOX, BPOLY, BREAK, BREP, CAL, CELLSELECT, CHAMFER, CHAMFEREDGE, CHANGE, CHPROP, CIRCLE, CLASSICGROUP, CLASSICXREF, CLEANSCREENOFF, CLEANSCREENON, CLIP, CLOSEALL, -COLOR, COLOR, COMPILE, CONE, CONSTRAINTBAR, CONSTRAINTSETTINGS, CONVERT, CONVERTPOLY, CONVTONURBS, CONVTOSOLID, CONVTOSURFACE, COPY, COPYBASE, COPYCLIP, COPYHIST, COPYLINK, -COPYTOLAYER, COPYTOLAYER, CUTCLIP, CVADD, CVHIDE, -CVREBUILD, CVREBUILD, CVREMOVE, CVSHOW, CYLINDER, -DATAEXTRACTION, DATAEXTRACTION, DATALINK, DATALINKUPDATE, DBLIST, DCALIGNED, DCANGULAR, DCCONVERT, DCDIAMETER, DCDISPLAY, DCFORM, DCHORIZONTAL, DCLINEAR, DCRADIUS, DCVERTICAL, DDEDIT, DELAY, DELCONSTRAINT, DGNADJUST, DGNLAYERS, DIM, DIM1, DIMALIGNED, DIMANGULAR, DIMARC, DIMBASELINE, DIMBREAK, DIMCENTER, DIMCONSTRAINT, DIMCONTINUE, DIMDIAMETER, DIMDISASSOCIATE, DIMEDIT, DIMHORIZONTAL, -DIMINSPECT, DIMINSPECT, DIMJOGGED, DIMJOGLINE, DIMLINEAR, DIMORDINATE, DIMOVERRIDE, DIMRADIUS, DIMREASSOCIATE, DIMREGEN, DIMROTATED, DIMSPACE, -DIMSTYLE, DIMSTYLE, DIMTEDIT, DIMVERTICAL, DIST, DISTANTLIGHT, DIVIDE, DONUT, DOUGHNUT, DRAGMODE, DRAWORDER, DROPGEOM, DTEXT, DUMPCMDS, DVIEW, -DWFADJUST, DWFADJUST, -DWFATTACH, DWFATTACH, DWFCLIP, DWFFORMAT, DWFLAYERS, DXBIN, DXFIN, DXFOUT, -EATTEXT, EATTEXT, EDGESURF, EDITTABLECELL, ELEV, ELLIPSE, END, EPLOTEXT, ERASE, EXPLODE, -EXPORT, EXPORT, EXPORTDWF, EXPORTDWFX, EXPORTPDF, EXPORTSETTINGS, EXTEND, EXTRUDE, FILEOPEN, FILL, FILLET, FILLETEDGE, FLATSHOT, FREESPOT, FREEWEB, GCCOINCIDENT, GCCOLLINEAR, GCCONCENTRIC, GCEQUAL, GCFIX, GCHORIZONTAL, GCPARALLEL, GCPERPENDICULAR, GCSMOOTH, GCSYMMETRIC, GCTANGENT, GCVERTICAL, GEOMCONSTRAINT, GRADIENT, -GRAPHICSCONFIG, GRAPHICSCONFIG, GRAPHSCR, GRID, -GROUP, GROUP, GROUPEDIT, -HATCH, HATCH, -HATCHEDIT, HATCHEDIT, HATCHGENERATEBOUNDARY, HATCHSETBOUNDARY, HATCHSETORIGIN, HATCHTOBACK, HELIX, HELP, HIDE, HIDEOBJECTS, ID, -IMAGE, -IMAGEADJUST, IMAGECLIP, IMAGEQUALITY, IMPLIEDFACEX, IMPORT, IMPRINT, -INSERT, INSERT, -INTERFERE, INTERFERE, INTERSECT, ISOLATEOBJECTS, ISOPLANE, JOIN, JPGOUT, JUSTIFYTEXT, LAYCUR, -LAYDEL, LAYDEL, -LAYER, LAYERCLOSE, LAYERP, LAYERPMODE, LAYFRZ, LAYISO, LAYLCK, -LAYMCH, LAYMCH, LAYMCUR, -LAYMRG, LAYMRG, LAYOFF, LAYON, -LAYOUT, LAYOUT, LAYTHW, LAYULK, LAYUNISO, LAYVPI, LEADER, LENGTHEN, LIGHT, LIMITS, LINE, -LINETYPE, LINETYPE, LIST, LIVESECTION, LOAD, LOFT, LOGFILEOFF, LOGFILEON, LTSCALE, -LWEIGHT, LWEIGHT, MASSPROP, MATCHCELL, MEASURE, MEASUREGEOM, MESH, MESHCAP, MESHCOLLAPSE, MESHCREASE, MESHEXTRUDE, MESHMERGE, MESHOPTIONS, MESHPRIMITIVEOPTIONS, MESHREFINE, MESHSMOOTH, MESHSMOOTHLESS, MESHSMOOTHMORE, MESHSPIN, MESHSPLIT, MESHUNCREASE, MINSERT, MIRROR, MIRROR3D, MLEADER, MLEADERALIGN, MLEADERCOLLECT, MLEADERCONTENTEDIT, MLEADEREDIT, MLINE, MODEL, MOVE, MREDO, MTEDIT, -MTEXT, MTEXT, MTPROP, MULTIPLE, NAVBAR, NAVVCUBE, NCOPY, NETLOAD, NEW, -OBJECTSCALE, OFFSET, OOPS, OPEN, OPTCHPROP, ORTHO, -OSNAP, OSNAP, -OVERKILL, PAGESETUP, -PAN, -PARAMETERS, PARAMETERS, PARAMETERSCLOSE, -PARTIALOAD, PARTIALOAD, -PARTIALOPEN, PASTEBLOCK, PASTEORIG, PEDIT, PFACE, PLAN, PLANESURF, PLINE, -PLOT, PLOT, -PLOTSTAMP, -PLOTSTYLE, PNGOUT, POINT, POINTLIGHT, POLYGON, POLYSOLID, PRESSPULL, PREVIEW, PROJECTGEOMETRY, -PSETUPIN, PSETUPIN, PSFILL, PSOUT, PSPACE, -PUBLISH, PUBLISH, -PURGE, PURGE, PYRAMID, QDIM, QLEADER, QNEW, QSAVE, QTEXT, RAY, RECOVER, RECTANG, RECTANGLE, REDO, REDRAW, REDRAWALL, REGEN, REGEN3, REGENALL, REGENAUTO, REGION, -RENAME, RENAME, RESETBLOCK, RESUME, REVCLOUD, REVERSE, REVOLVE, REVSURF, ROTATE, ROTATE3D, RULESURF, SAVE, SAVEAS, SCALE, -SCALELISTEDIT, SCALETEXT, SCRIPT, SECTION, SECTIONPLANE, SECTIONPLANEJOG, SECTIONPLANESETTINGS, SECTIONPLANETOBLOCK, SELECT, SELECTSIMILAR, SEQUENCEPLAY, SETBYLAYER, SETVAR, -SHADE, SHADE, -SHADEMODE, SHADEMODE, SHAPE, SKETCH, SLICE, SNAP, SOLDRAW, SOLID, SOLIDEDIT, SOLPROF, SOLVIEW, SPACEMOUSEACTION, SPACETRANS, SPHERE, SPLINE, SPLINEDIT, SPOTLIGHT, STLOUT, STRETCH, -STYLE, STYLE, SUBTRACT, SURFBLEND, SURFEXTEND, SURFEXTRACTCURVE, SURFFILLET, SURFNETWORK, SURFOFFSET, SURFPATCH, SURFSCULPT, SURFTRIM, SURFUNTRIM, SWEEP, -TABLE, TABLE, TABLEDIT, TABLEEXPORT, TABLESTYLE, TABLET, TABSURF, TARGETPOINT, -TEXT, TEXT, TEXTEDIT, TEXTSCR, TEXTTOFRONT, THICKEN, TIFOUT, TIME, TINSERT, TOLERANCE, TORUS, TRACE, TRANSPARENCY, TRIM, U, UCS, UCSICON, UCSMAN, UNDEFINE, UNDO, UNGROUP, UNION, UNISOLATEOBJECTS, -UNITS, UNITS, UPDATETHUMBSNOW, -VIEW, VIEWBACK, VIEWCUBEACTION, VIEWFORWARD, VIEWGO, VIEWPLAY, VIEWPLOTDETAILS, VIEWPORTS, VIEWRES, -VISUALSTYLES, VPCLIP, VPLAYER, VPMAX, VPMIN, -VPORTS, VPORTS, VSCURRENT, VSSAVE, WALKFLYSETTINGS, -WBLOCK, WBLOCK, WEBLIGHT, WEDGE, WHOHAS, WIPEOUT, WMFIN, WMFOUT, -XBIND, XBIND, XCLIP, XEDGES, XLINE, XOPEN, -XREF, XREF, ZOOM.</span></p>
<p><strong>Important note</strong>: not all of these commands actually do something useful – some simply return directly to the user, where they would otherwise have displayed a dialog, etc. – so you’ll still need to test the commands you need by entering them or by executing your scripts.</p>
<p>I’m not going to list the commands that aren’t available in the Core Console – if the command isn’t in the above list, it’s a fair bet that it isn’t there – but there is another list of commands that is worth mentioning, as they currently cause the Core Console to crash (on my system, at least):</p>
<p><span style="font-size: xx-small;">ACTBASEPOINT, ACTMANAGER, ACTRECORD, -ACTSTOP, ACTSTOP, ACTUSERINPUT, -ACTUSERMESSAGE, ACTUSERMESSAGE, ADJUST, CLASSICLAYER, CLOSE, CUI, CUIEXPORT, CUIIMPORT, -DGNATTACH, DGNATTACH, -DGNBIND, DGNCLIP, -LAYER, LAYER, MLEDIT, MLSTYLE, -NAVSMOTION, NAVSMOTION, NAVSMOTIONCLOSE, NAVSWHEEL, OBJECTSCALE, PAN, PASTEASHYPERLINK, PASTECLIP, -PDFADJUST, PDFADJUST, -PDFATTACH, PDFATTACH, PDFCLIP, PDFLAYERS, QCCLOSE, QUICKCALC, QUICKCUI, -QVDRAWING, QVDRAWING, QVDRAWINGCLOSE, -QVLAYOUT, QVLAYOUT, QVLAYOUTCLOSE, RECOVERALL, RIBBON, RIBBONCLOSE, RTPAN, RTZOOM, SCALELISTEDIT, ULAYERS, VTOPTIONS</span></p>
<p>I hope it goes without saying that these should be avoided – the good news is that they are mostly not commands you’ll need in the Core Console. If you find you do need something from full AutoCAD that’s not on the “working” list – and it’s reasonable to expect would work in a version of AutoCAD with a very limited UI – please do make sure the ADN team is aware (whether by contacting them directly or posting to <a href="http://forums.autodesk.com/t5/NET/bd-p/152" target="_blank">the AutoCAD .NET Discussion Group</a>).</p>
<p>And then, last but not least, there are just a few commands that actually show some UI when launched from the Core Console (and these clearly need attention from our side):</p>
<p><span style="font-size: xx-small;">BESETTINGS, PLOTSTYLE, VLIDE</span></p>
<p>I hope this little analysis proves to be of use to you when working with the Core Console. In the absence of more formal documentation, we (meaning the ADN team and I) will continue to do our best to make sure you at least have some guidance on how best to work with it.</p>
