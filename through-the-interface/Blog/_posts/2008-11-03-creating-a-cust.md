---
layout: "post"
title: "Creating a custom AutoCAD table style using .NET"
date: "2008-11-03 06:56:00"
author: "Kean Walmsley"
categories:
  - "AutoCAD"
  - "AutoCAD .NET"
  - "Tables"
original_url: "https://www.keanw.com/2008/11/creating-a-cust.html "
typepad_basename: "creating-a-cust"
typepad_status: "Publish"
---

<p>The question of how to define a new table style programmatically has come up a couple of times over the last week or so, so this post shows how to approach this. I&#39;ve used the code from <a href="http://through-the-interface.typepad.com/through_the_interface/2007/06/creating_an_aut.html">this previous post</a> as a basis for this post&#39;s.</p>
<p>The important thing to know is that TableStyle objects are stored in a special dictionary, which can be accessed via a Database&#39;s TableStyleDictionaryId property. This ObjectId property allows you to access the dictionary, from which you can query the contents, determine whether your style exists and add a new one if it doesn&#39;t. The code to specify the colour and formatting of the table style is reasonably straightforward.</p>
<p>Here&#39;s some C# code to define a new &quot;Garish Table Style&quot; with a red header/title area, yellow data area and magenta text throughout (better put on your sunglasses before running it... :-):</p>
<div style="FONT-SIZE: 8pt; BACKGROUND: white; COLOR: black; FONT-FAMILY: courier new">
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="COLOR: blue; LINE-HEIGHT: 140%">using</span><span style="LINE-HEIGHT: 140%"> Autodesk.AutoCAD.ApplicationServices;</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="COLOR: blue; LINE-HEIGHT: 140%">using</span><span style="LINE-HEIGHT: 140%"> Autodesk.AutoCAD.DatabaseServices;</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="COLOR: blue; LINE-HEIGHT: 140%">using</span><span style="LINE-HEIGHT: 140%"> Autodesk.AutoCAD.EditorInput;</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="COLOR: blue; LINE-HEIGHT: 140%">using</span><span style="LINE-HEIGHT: 140%"> Autodesk.AutoCAD.Runtime;</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="COLOR: blue; LINE-HEIGHT: 140%">using</span><span style="LINE-HEIGHT: 140%"> Autodesk.AutoCAD.Colors;</span></p><br />
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="COLOR: blue; LINE-HEIGHT: 140%">namespace</span><span style="LINE-HEIGHT: 140%"> TableAndStyleCreation</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">{</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; </span><span style="COLOR: blue; LINE-HEIGHT: 140%">public</span><span style="LINE-HEIGHT: 140%">&#0160;</span><span style="COLOR: blue; LINE-HEIGHT: 140%">class</span><span style="LINE-HEIGHT: 140%">&#0160;</span><span style="COLOR: #2b91af"><span style="COLOR: #2b91af; LINE-HEIGHT: 140%">Commands</span></span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; {</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; [</span><span style="COLOR: #2b91af"><span style="COLOR: #2b91af; LINE-HEIGHT: 140%">CommandMethod</span></span><span style="LINE-HEIGHT: 140%">(</span><span style="COLOR: #a31515"><span style="COLOR: #a31515; LINE-HEIGHT: 140%">&quot;CTWS&quot;</span></span><span style="LINE-HEIGHT: 140%">)]</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; </span><span style="COLOR: blue; LINE-HEIGHT: 140%">static</span><span style="LINE-HEIGHT: 140%">&#0160;</span><span style="COLOR: blue; LINE-HEIGHT: 140%">public</span><span style="LINE-HEIGHT: 140%">&#0160;</span><span style="COLOR: blue; LINE-HEIGHT: 140%">void</span><span style="LINE-HEIGHT: 140%"> CreateTableWithStyle()</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; {</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;</span><span style="COLOR: #2b91af"><span style="COLOR: #2b91af; LINE-HEIGHT: 140%">Document</span></span><span style="LINE-HEIGHT: 140%"> doc =</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="COLOR: #2b91af"><span style="COLOR: #2b91af; LINE-HEIGHT: 140%">Application</span></span><span style="LINE-HEIGHT: 140%">.DocumentManager.MdiActiveDocument;</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;</span><span style="COLOR: #2b91af"><span style="COLOR: #2b91af; LINE-HEIGHT: 140%">Database</span></span><span style="LINE-HEIGHT: 140%"> db = doc.Database;</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;</span><span style="COLOR: #2b91af"><span style="COLOR: #2b91af; LINE-HEIGHT: 140%">Editor</span></span><span style="LINE-HEIGHT: 140%"> ed = doc.Editor;</span></p><br />
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;</span><span style="COLOR: #2b91af"><span style="COLOR: #2b91af; LINE-HEIGHT: 140%">PromptPointResult</span></span><span style="LINE-HEIGHT: 140%"> pr =</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; ed.GetPoint(</span><span style="COLOR: #a31515"><span style="COLOR: #a31515; LINE-HEIGHT: 140%">&quot;\nEnter table insertion point: &quot;</span></span><span style="LINE-HEIGHT: 140%">);</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;</span><span style="COLOR: blue; LINE-HEIGHT: 140%">if</span><span style="LINE-HEIGHT: 140%"> (pr.Status == </span><span style="COLOR: #2b91af"><span style="COLOR: #2b91af; LINE-HEIGHT: 140%">PromptStatus</span></span><span style="LINE-HEIGHT: 140%">.OK)</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;{</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="COLOR: #2b91af"><span style="COLOR: #2b91af; LINE-HEIGHT: 140%">Transaction</span></span><span style="LINE-HEIGHT: 140%"> tr =</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; doc.TransactionManager.StartTransaction();</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="COLOR: blue; LINE-HEIGHT: 140%">using</span><span style="LINE-HEIGHT: 140%"> (tr)</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; {</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="COLOR: green; LINE-HEIGHT: 140%">// First let us create our custom style,</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="COLOR: green; LINE-HEIGHT: 140%">//&#0160; if it doesn&#39;t exist</span></p><br />
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="COLOR: blue; LINE-HEIGHT: 140%">const</span><span style="LINE-HEIGHT: 140%">&#0160;</span><span style="COLOR: blue; LINE-HEIGHT: 140%">string</span><span style="LINE-HEIGHT: 140%"> styleName = </span><span style="COLOR: #a31515"><span style="COLOR: #a31515; LINE-HEIGHT: 140%">&quot;Garish Table Style&quot;</span></span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="COLOR: #2b91af"><span style="COLOR: #2b91af; LINE-HEIGHT: 140%">ObjectId</span></span><span style="LINE-HEIGHT: 140%"> tsId = </span><span style="COLOR: #2b91af"><span style="COLOR: #2b91af; LINE-HEIGHT: 140%">ObjectId</span></span><span style="LINE-HEIGHT: 140%">.Null;</span></p><br />
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="COLOR: #2b91af"><span style="COLOR: #2b91af; LINE-HEIGHT: 140%">DBDictionary</span></span><span style="LINE-HEIGHT: 140%"> sd =</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;(</span><span style="COLOR: #2b91af"><span style="COLOR: #2b91af; LINE-HEIGHT: 140%">DBDictionary</span></span><span style="LINE-HEIGHT: 140%">)tr.GetObject(</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; db.TableStyleDictionaryId,</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="COLOR: #2b91af"><span style="COLOR: #2b91af; LINE-HEIGHT: 140%">OpenMode</span></span><span style="LINE-HEIGHT: 140%">.ForRead</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;);</span></p><br />
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="COLOR: green; LINE-HEIGHT: 140%">// Use the style if it already exists</span></p><br />
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="COLOR: blue; LINE-HEIGHT: 140%">if</span><span style="LINE-HEIGHT: 140%"> (sd.Contains(styleName))</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; {</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;tsId = sd.GetAt(styleName);</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; }</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="COLOR: blue; LINE-HEIGHT: 140%">else</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; {</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;</span><span style="COLOR: green; LINE-HEIGHT: 140%">// Otherwise we have to create it</span></p><br />
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;</span><span style="COLOR: #2b91af"><span style="COLOR: #2b91af; LINE-HEIGHT: 140%">TableStyle</span></span><span style="LINE-HEIGHT: 140%"> ts = </span><span style="COLOR: blue; LINE-HEIGHT: 140%">new</span><span style="LINE-HEIGHT: 140%">&#0160;</span><span style="COLOR: #2b91af"><span style="COLOR: #2b91af; LINE-HEIGHT: 140%">TableStyle</span></span><span style="LINE-HEIGHT: 140%">();</span></p><br />
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;</span><span style="COLOR: green; LINE-HEIGHT: 140%">// Make the header area red</span></p><br />
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;ts.SetBackgroundColor(</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="COLOR: #2b91af"><span style="COLOR: #2b91af; LINE-HEIGHT: 140%">Color</span></span><span style="LINE-HEIGHT: 140%">.FromColorIndex(</span><span style="COLOR: #2b91af"><span style="COLOR: #2b91af; LINE-HEIGHT: 140%">ColorMethod</span></span><span style="LINE-HEIGHT: 140%">.ByAci, 1),</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; (</span><span style="COLOR: blue; LINE-HEIGHT: 140%">int</span><span style="LINE-HEIGHT: 140%">)(</span><span style="COLOR: #2b91af"><span style="COLOR: #2b91af; LINE-HEIGHT: 140%">RowType</span></span><span style="LINE-HEIGHT: 140%">.HeaderRow | </span><span style="COLOR: #2b91af"><span style="COLOR: #2b91af; LINE-HEIGHT: 140%">RowType</span></span><span style="LINE-HEIGHT: 140%">.TitleRow)</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;);</span></p><br />
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;</span><span style="COLOR: green; LINE-HEIGHT: 140%">// And the data area yellow</span></p><br />
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;ts.SetBackgroundColor(</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="COLOR: #2b91af"><span style="COLOR: #2b91af; LINE-HEIGHT: 140%">Color</span></span><span style="LINE-HEIGHT: 140%">.FromColorIndex(</span><span style="COLOR: #2b91af"><span style="COLOR: #2b91af; LINE-HEIGHT: 140%">ColorMethod</span></span><span style="LINE-HEIGHT: 140%">.ByAci, 2),</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; (</span><span style="COLOR: blue; LINE-HEIGHT: 140%">int</span><span style="LINE-HEIGHT: 140%">)</span><span style="COLOR: #2b91af"><span style="COLOR: #2b91af; LINE-HEIGHT: 140%">RowType</span></span><span style="LINE-HEIGHT: 140%">.DataRow</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;);</span></p><br />
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;</span><span style="COLOR: green; LINE-HEIGHT: 140%">// With magenta text everywhere (yeuch :-)</span></p><br />
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;ts.SetColor(</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="COLOR: #2b91af"><span style="COLOR: #2b91af; LINE-HEIGHT: 140%">Color</span></span><span style="LINE-HEIGHT: 140%">.FromColorIndex(</span><span style="COLOR: #2b91af"><span style="COLOR: #2b91af; LINE-HEIGHT: 140%">ColorMethod</span></span><span style="LINE-HEIGHT: 140%">.ByAci, 6),</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; (</span><span style="COLOR: blue; LINE-HEIGHT: 140%">int</span><span style="LINE-HEIGHT: 140%">)(</span><span style="COLOR: #2b91af"><span style="COLOR: #2b91af; LINE-HEIGHT: 140%">RowType</span></span><span style="LINE-HEIGHT: 140%">.HeaderRow |</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="COLOR: #2b91af"><span style="COLOR: #2b91af; LINE-HEIGHT: 140%">RowType</span></span><span style="LINE-HEIGHT: 140%">.TitleRow |</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="COLOR: #2b91af"><span style="COLOR: #2b91af; LINE-HEIGHT: 140%">RowType</span></span><span style="LINE-HEIGHT: 140%">.DataRow)</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;);</span></p><br />
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;</span><span style="COLOR: green; LINE-HEIGHT: 140%">// Add our table style to the dictionary</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;</span><span style="COLOR: green; LINE-HEIGHT: 140%">//&#0160; and to the transaction</span></p><br />
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;sd.UpgradeOpen();</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;tsId = sd.SetAt(styleName, ts);</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;tr.AddNewlyCreatedDBObject(ts, </span><span style="COLOR: blue; LINE-HEIGHT: 140%">true</span><span style="LINE-HEIGHT: 140%">);</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;sd.DowngradeOpen();</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; }</span></p><br />
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="COLOR: #2b91af"><span style="COLOR: #2b91af; LINE-HEIGHT: 140%">BlockTable</span></span><span style="LINE-HEIGHT: 140%"> bt =</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;(</span><span style="COLOR: #2b91af"><span style="COLOR: #2b91af; LINE-HEIGHT: 140%">BlockTable</span></span><span style="LINE-HEIGHT: 140%">)tr.GetObject(</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; doc.Database.BlockTableId,</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="COLOR: #2b91af"><span style="COLOR: #2b91af; LINE-HEIGHT: 140%">OpenMode</span></span><span style="LINE-HEIGHT: 140%">.ForRead</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;);</span></p><br />
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="COLOR: #2b91af"><span style="COLOR: #2b91af; LINE-HEIGHT: 140%">Table</span></span><span style="LINE-HEIGHT: 140%"> tb = </span><span style="COLOR: blue; LINE-HEIGHT: 140%">new</span><span style="LINE-HEIGHT: 140%">&#0160;</span><span style="COLOR: #2b91af"><span style="COLOR: #2b91af; LINE-HEIGHT: 140%">Table</span></span><span style="LINE-HEIGHT: 140%">();</span></p><br />
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="COLOR: green; LINE-HEIGHT: 140%">// Use our table style</span></p><br />
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="COLOR: blue; LINE-HEIGHT: 140%">if</span><span style="LINE-HEIGHT: 140%"> (tsId == </span><span style="COLOR: #2b91af"><span style="COLOR: #2b91af; LINE-HEIGHT: 140%">ObjectId</span></span><span style="LINE-HEIGHT: 140%">.Null)</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;</span><span style="COLOR: green; LINE-HEIGHT: 140%">// This should not happen, unless the</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;</span><span style="COLOR: green; LINE-HEIGHT: 140%">//&#0160; above logic changes</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;tb.TableStyle = db.Tablestyle;</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="COLOR: blue; LINE-HEIGHT: 140%">else</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;tb.TableStyle = tsId;</span></p><br />
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; tb.NumRows = 5;</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; tb.NumColumns = 3;</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; tb.SetRowHeight(3);</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; tb.SetColumnWidth(15);</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; tb.Position = pr.Value;</span></p><br />
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="COLOR: green; LINE-HEIGHT: 140%">// Create a 2-dimensional array</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="COLOR: green; LINE-HEIGHT: 140%">// of our table contents</span></p><br />
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="COLOR: blue; LINE-HEIGHT: 140%">string</span><span style="LINE-HEIGHT: 140%">[,] str = </span><span style="COLOR: blue; LINE-HEIGHT: 140%">new</span><span style="LINE-HEIGHT: 140%">&#0160;</span><span style="COLOR: blue; LINE-HEIGHT: 140%">string</span><span style="LINE-HEIGHT: 140%">[5, 4];</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; str[0, 0] = </span><span style="COLOR: #a31515"><span style="COLOR: #a31515; LINE-HEIGHT: 140%">&quot;Part No.&quot;</span></span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; str[0, 1] = </span><span style="COLOR: #a31515"><span style="COLOR: #a31515; LINE-HEIGHT: 140%">&quot;Name &quot;</span></span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; str[0, 2] = </span><span style="COLOR: #a31515"><span style="COLOR: #a31515; LINE-HEIGHT: 140%">&quot;Material &quot;</span></span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; str[1, 0] = </span><span style="COLOR: #a31515"><span style="COLOR: #a31515; LINE-HEIGHT: 140%">&quot;1876-1&quot;</span></span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; str[1, 1] = </span><span style="COLOR: #a31515"><span style="COLOR: #a31515; LINE-HEIGHT: 140%">&quot;Flange&quot;</span></span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; str[1, 2] = </span><span style="COLOR: #a31515"><span style="COLOR: #a31515; LINE-HEIGHT: 140%">&quot;Perspex&quot;</span></span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; str[2, 0] = </span><span style="COLOR: #a31515"><span style="COLOR: #a31515; LINE-HEIGHT: 140%">&quot;0985-4&quot;</span></span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; str[2, 1] = </span><span style="COLOR: #a31515"><span style="COLOR: #a31515; LINE-HEIGHT: 140%">&quot;Bolt&quot;</span></span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; str[2, 2] = </span><span style="COLOR: #a31515"><span style="COLOR: #a31515; LINE-HEIGHT: 140%">&quot;Steel&quot;</span></span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; str[3, 0] = </span><span style="COLOR: #a31515"><span style="COLOR: #a31515; LINE-HEIGHT: 140%">&quot;3476-K&quot;</span></span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; str[3, 1] = </span><span style="COLOR: #a31515"><span style="COLOR: #a31515; LINE-HEIGHT: 140%">&quot;Tile&quot;</span></span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; str[3, 2] = </span><span style="COLOR: #a31515"><span style="COLOR: #a31515; LINE-HEIGHT: 140%">&quot;Ceramic&quot;</span></span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; str[4, 0] = </span><span style="COLOR: #a31515"><span style="COLOR: #a31515; LINE-HEIGHT: 140%">&quot;8734-3&quot;</span></span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; str[4, 1] = </span><span style="COLOR: #a31515"><span style="COLOR: #a31515; LINE-HEIGHT: 140%">&quot;Kean&quot;</span></span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; str[4, 2] = </span><span style="COLOR: #a31515"><span style="COLOR: #a31515; LINE-HEIGHT: 140%">&quot;Mostly water&quot;</span></span><span style="LINE-HEIGHT: 140%">;</span></p><br />
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="COLOR: green; LINE-HEIGHT: 140%">// Use a nested loop to add and format each cell</span></p><br />
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="COLOR: blue; LINE-HEIGHT: 140%">for</span><span style="LINE-HEIGHT: 140%"> (</span><span style="COLOR: blue; LINE-HEIGHT: 140%">int</span><span style="LINE-HEIGHT: 140%"> i = 0; i &lt; 5; i++)</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; {</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;</span><span style="COLOR: blue; LINE-HEIGHT: 140%">for</span><span style="LINE-HEIGHT: 140%"> (</span><span style="COLOR: blue; LINE-HEIGHT: 140%">int</span><span style="LINE-HEIGHT: 140%"> j = 0; j &lt; 3; j++)</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;{</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; tb.SetTextHeight(i, j, 1);</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; tb.SetTextString(i, j, str[i, j]);</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; tb.SetAlignment(i, j, </span><span style="COLOR: #2b91af"><span style="COLOR: #2b91af; LINE-HEIGHT: 140%">CellAlignment</span></span><span style="LINE-HEIGHT: 140%">.MiddleCenter);</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;}</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; }</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; tb.GenerateLayout();</span></p><br />
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="COLOR: #2b91af"><span style="COLOR: #2b91af; LINE-HEIGHT: 140%">BlockTableRecord</span></span><span style="LINE-HEIGHT: 140%"> btr =</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;(</span><span style="COLOR: #2b91af"><span style="COLOR: #2b91af; LINE-HEIGHT: 140%">BlockTableRecord</span></span><span style="LINE-HEIGHT: 140%">)tr.GetObject(</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; bt[</span><span style="COLOR: #2b91af"><span style="COLOR: #2b91af; LINE-HEIGHT: 140%">BlockTableRecord</span></span><span style="LINE-HEIGHT: 140%">.ModelSpace],</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="COLOR: #2b91af"><span style="COLOR: #2b91af; LINE-HEIGHT: 140%">OpenMode</span></span><span style="LINE-HEIGHT: 140%">.ForWrite</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;);</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; btr.AppendEntity(tb);</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; tr.AddNewlyCreatedDBObject(tb, </span><span style="COLOR: blue; LINE-HEIGHT: 140%">true</span><span style="LINE-HEIGHT: 140%">);</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; tr.Commit();</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; }</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;}</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; }</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">&#0160; }</span></p>
<p style="FONT-SIZE: 8pt; MARGIN: 0px"><span style="LINE-HEIGHT: 140%">}</span></p></div>
<p>Here&#39;s what happens when we load the module and run the CTWS command, selecting a location for our &quot;garish&quot; table:</p>
<p><a href="http://through-the-interface.typepad.com/through_the_interface/WindowsLiveWriter/Custom%20garishly-styled%20table.png"><img alt="Custom garishly-styled table" border="0" height="188" src="/assets/Custom%20garishly-styled%20table_thumb.png" style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" width="456" /></a> </p>
<p>And if we launch AutoCAD&#39;s TABLESTYLE command we can see our custom style in the list:</p>
<p><a href="http://through-the-interface.typepad.com/through_the_interface/WindowsLiveWriter/AutoCAD&#39;s%20Table%20Style%20dialog%20with%20our%20new%20style.png"><img alt="AutoCAD&#39;s Table Style dialog with our new style" border="0" height="294" src="/assets/image_614553.jpg" style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" width="431" /></a></p>
<p><strong><em>Update</em></strong></p>
<p><a href="http://through-the-interface.typepad.com/through_the_interface/2009/01/more-fun-with-autocad-tables-and-their-styles-using-net.html">A further post</a> on this topic has now been published.</p>
