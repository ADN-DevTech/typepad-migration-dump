---
layout: "post"
title: "Transforming a list of RegAppIds from XML to HTML using XSLT"
date: "2011-01-31 15:01:36"
author: "Kean Walmsley"
categories:
  - "AutoCAD"
  - "AutoCAD .NET"
  - "Batch processing"
  - "Drawing structure"
  - "XML"
original_url: "https://www.keanw.com/2011/01/transforming-a-list-of-regappids-from-xml-to-html-using-xslt.html "
typepad_basename: "transforming-a-list-of-regappids-from-xml-to-html-using-xslt"
typepad_status: "Publish"
---

<p>As raised as a possibility at the end of <a href="http://through-the-interface.typepad.com/through_the_interface/2011/01/persisting-regappid-data-from-an-external-autocad-drawing-to-xml-using-net.html" target="_blank">the last post</a>, I did choose to throw together a quick <a href="http://en.wikipedia.org/wiki/XSLT">XSLT</a> stylesheet to generate an HTML report of the XML data created by our XRA command.</p>  <p>To enable this I did make a few changes to our command implementation, which we’ll take a look at first.</p>  <p>Here’s the updated C# code, with new/modified lines in <font color="#ff0000">red</font> (and here’s <a href="http://through-the-interface.typepad.com/files/recurse-xrefs-external-xml-updated.cs" target="_blank">the updated source file</a>):</p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160;&#160; 1</span>&#160;<span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.ApplicationServices;</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160;&#160; 2</span>&#160;<span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.DatabaseServices;</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160;&#160; 3</span>&#160;<span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.EditorInput;</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160;&#160; 4</span>&#160;<span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.Runtime;</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160;&#160; 5</span>&#160;<span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> System.Collections.Generic;</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160;&#160; 6</span>&#160;<span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> System.Text;</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160;&#160; 7</span>&#160;<span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> System.Xml;</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160;&#160; 8</span>&#160;<span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> System.Xml.Serialization;</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160;&#160; 9</span>&#160;<span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> System.IO;</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 10</span>&#160;<span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> System;</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 11</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 12</span>&#160;<span style="line-height: 140%; color: blue">namespace</span><span style="line-height: 140%"> XrefRegApps</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 13</span>&#160;<span style="line-height: 140%">{</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 14</span>&#160;<span style="line-height: 140%">&#160; [</span><span style="line-height: 140%; color: #2b91af">XmlRoot</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: #a31515">&quot;RegAppData&quot;</span><span style="line-height: 140%">)]</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 15</span>&#160;<span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">class</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">RegAppData</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 16</span>&#160;<span style="line-height: 140%">&#160; {</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 17</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// The name of our drawing</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 18</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 19</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%"> _name;</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 20</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 21</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; [</span><span style="line-height: 140%; color: #2b91af">XmlAttribute</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: #a31515">&quot;Name&quot;</span><span style="line-height: 140%">)]</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 22</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%"> Name</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 23</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 24</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">get</span><span style="line-height: 140%"> { </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> _name; }</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 25</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">set</span><span style="line-height: 140%"> { _name = </span><span style="line-height: 140%; color: blue">value</span><span style="line-height: 140%">; }</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 26</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 27</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 28</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// The location of our drawing</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 29</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 30</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%"> _dwg;</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 31</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 32</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; [</span><span style="line-height: 140%; color: #2b91af">XmlAttribute</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: #a31515">&quot;File&quot;</span><span style="line-height: 140%">)]</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 33</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%"> File</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 34</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 35</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">get</span><span style="line-height: 140%"> { </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> _dwg; }</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 36</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">set</span><span style="line-height: 140%"> { _dwg = </span><span style="line-height: 140%; color: blue">value</span><span style="line-height: 140%">; }</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 37</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 38</span>&#160;</p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 39</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%"> _dwgVersion;</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 40</span>&#160;</p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 41</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; [</span><span style="line-height: 140%; color: #2b91af">XmlAttribute</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: #a31515">&quot;DwgVersion&quot;</span><span style="line-height: 140%">)]</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 42</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%"> DwgVersion</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 43</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 44</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">get</span><span style="line-height: 140%"> { </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> _dwgVersion; }</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 45</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">set</span><span style="line-height: 140%"> { _dwgVersion = </span><span style="line-height: 140%; color: blue">value</span><span style="line-height: 140%">; }</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 46</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 47</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 48</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// The list of our drawing's Registered Application IDs</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 49</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 50</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">List</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%">&gt; _regAppIds = </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">List</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%">&gt;();</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 51</span>&#160;</p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 52</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; [</span><span style="line-height: 140%; color: #2b91af">XmlArrayItem</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: #a31515">&quot;RegAppId&quot;</span><span style="line-height: 140%">)]</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 53</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">List</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%">&gt; RegAppIds</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 54</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 55</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">get</span><span style="line-height: 140%"> { </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> _regAppIds; }</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 56</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">set</span><span style="line-height: 140%"> { _regAppIds = </span><span style="line-height: 140%; color: blue">value</span><span style="line-height: 140%">; }</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 57</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 58</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 59</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> AddRegAppId(</span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%"> id)</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 60</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 61</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (!_regAppIds.Contains(id))</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 62</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; _regAppIds.Add(id);</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 63</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 64</span>&#160;<span style="line-height: 140%">&#160; }</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 65</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 66</span>&#160;<span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">class</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Commands</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 67</span>&#160;<span style="line-height: 140%">&#160; {</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 68</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">const</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%"> regAppDataXml = </span><span style="line-height: 140%; color: #a31515">&quot;c:\\RegAppData.xml&quot;</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 69</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 70</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> SerializeRegAppData(</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 71</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Dictionary</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #2b91af">RegAppData</span><span style="line-height: 140%">&gt; dict</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 72</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; )</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 73</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 74</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (dict.Count &gt; 0)</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 75</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 76</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// No direct way to serialize a dictionary to XML,</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 77</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// so we'll create a list from it and serialize that</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 78</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 79</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">List</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: #2b91af">RegAppData</span><span style="line-height: 140%">&gt; regData =</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 80</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">List</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: #2b91af">RegAppData</span><span style="line-height: 140%">&gt;(dict.Count);</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 81</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">foreach</span><span style="line-height: 140%"> (</span><span style="line-height: 140%; color: #2b91af">KeyValuePair</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #2b91af">RegAppData</span><span style="line-height: 140%">&gt; kv </span><span style="line-height: 140%; color: blue">in</span><span style="line-height: 140%"> dict)</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 82</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 83</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; regData.Add(kv.Value);</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 84</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 85</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 86</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// Serialize our list to the specified XML file</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 87</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 88</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">XmlSerializer</span><span style="line-height: 140%"> xs =</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 89</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">XmlSerializer</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: blue">typeof</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: #2b91af">List</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: #2b91af">RegAppData</span><span style="line-height: 140%">&gt;));</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 90</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">XmlTextWriter</span><span style="line-height: 140%"> xw =</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 91</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">XmlTextWriter</span><span style="line-height: 140%">(regAppDataXml, </span><span style="line-height: 140%; color: #2b91af">Encoding</span><span style="line-height: 140%">.UTF8);</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 92</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; xw.WriteProcessingInstruction(</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 93</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;xml-stylesheet&quot;</span><span style="line-height: 140%">,</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 94</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;type=\&quot;text/xsl\&quot; href=\&quot;RegAppData.xslt\&quot;&quot;</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 95</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; );</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 96</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; xs.Serialize(xw, regData);</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 97</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; xw.Close();</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 98</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 99</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 100</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 101</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// Read and return the previous Registered Application data</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 102</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// from our stored XML file</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 103</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 104</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Dictionary</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #2b91af">RegAppData</span><span style="line-height: 140%">&gt;</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 105</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; DeserializeRegAppData()</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 106</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 107</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (</span><span style="line-height: 140%; color: #2b91af">File</span><span style="line-height: 140%">.Exists(regAppDataXml))</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 108</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 109</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">XmlSerializer</span><span style="line-height: 140%"> xs =</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 110</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">XmlSerializer</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: blue">typeof</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: #2b91af">List</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: #2b91af">RegAppData</span><span style="line-height: 140%">&gt;));</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 111</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">XmlTextReader</span><span style="line-height: 140%"> xr = </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">XmlTextReader</span><span style="line-height: 140%">(regAppDataXml);</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 112</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (xs.CanDeserialize(xr))</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 113</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 114</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// No direct way to serialize a dictionary to XML,</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 115</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// so we'll read a list and populate a dictionary</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 116</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// from it</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 117</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 118</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">List</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: #2b91af">RegAppData</span><span style="line-height: 140%">&gt; regData =</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 119</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: #2b91af">List</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: #2b91af">RegAppData</span><span style="line-height: 140%">&gt;)xs.Deserialize(xr);</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 120</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; xr.Close();</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 121</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Dictionary</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #2b91af">RegAppData</span><span style="line-height: 140%">&gt; dict =</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 122</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Dictionary</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #2b91af">RegAppData</span><span style="line-height: 140%">&gt;();</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 123</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">foreach</span><span style="line-height: 140%"> (</span><span style="line-height: 140%; color: #2b91af">RegAppData</span><span style="line-height: 140%"> rad </span><span style="line-height: 140%; color: blue">in</span><span style="line-height: 140%"> regData)</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 124</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 125</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; dict.Add(rad.File, rad);</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 126</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 127</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> dict;</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 128</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 129</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 130</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Dictionary</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #2b91af">RegAppData</span><span style="line-height: 140%">&gt;();</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 131</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 132</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 133</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; [</span><span style="line-height: 140%; color: #2b91af">CommandMethod</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: #a31515">&quot;XRA&quot;</span><span style="line-height: 140%">)]</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 134</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> ExternalReferenceRegisteredApps()</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 135</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 136</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Document</span><span style="line-height: 140%"> doc =</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 137</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Application</span><span style="line-height: 140%">.DocumentManager.MdiActiveDocument;</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 138</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Database</span><span style="line-height: 140%"> db = doc.Database;</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 139</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Editor</span><span style="line-height: 140%"> ed = doc.Editor;</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 140</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 141</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// Prompt the user for the path to a DWG to test</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 142</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 143</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">PromptStringOptions</span><span style="line-height: 140%"> pso =</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 144</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">PromptStringOptions</span><span style="line-height: 140%">(</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 145</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;\nEnter path to root drawing file: &quot;</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 146</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; );</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 147</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; pso.AllowSpaces = </span><span style="line-height: 140%; color: blue">true</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 148</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">PromptResult</span><span style="line-height: 140%"> pr = ed.GetString(pso);</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 149</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (pr.Status != </span><span style="line-height: 140%; color: #2b91af">PromptStatus</span><span style="line-height: 140%">.OK)</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 150</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 151</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 152</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (!</span><span style="line-height: 140%; color: #2b91af">File</span><span style="line-height: 140%">.Exists(pr.StringResult))</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 153</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 154</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</span><span style="line-height: 140%; color: #a31515">&quot;\nFile does not exist.&quot;</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 155</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 156</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 157</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 158</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">try</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 159</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 160</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// We start by reading any existing RegApp data</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 161</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// from XML</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 162</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 163</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Dictionary</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #2b91af">RegAppData</span><span style="line-height: 140%">&gt; regData =</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 164</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; DeserializeRegAppData();</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 165</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 166</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// Load the DWG into a side database</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 167</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 168</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Database</span><span style="line-height: 140%"> mainDb = </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Database</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: blue">false</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: blue">true</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 169</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> (mainDb)</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 170</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 171</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; mainDb.ReadDwgFile(</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 172</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; pr.StringResult,</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 173</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">FileOpenMode</span><span style="line-height: 140%">.OpenForReadAndAllShare,</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 174</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">true</span><span style="line-height: 140%">,</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 175</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">null</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 176</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; );</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 177</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 178</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// We need an additional step to resolve Xrefs</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 179</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 180</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; mainDb.ResolveXrefs(</span><span style="line-height: 140%; color: blue">false</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: blue">false</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 181</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 182</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// Get the XrefGraph for the specified database</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 183</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 184</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">XrefGraph</span><span style="line-height: 140%"> xg = mainDb.GetHostDwgXrefGraph(</span><span style="line-height: 140%; color: blue">true</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 185</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 186</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// Loop through the nodes in the graph</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 187</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 188</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">for</span><span style="line-height: 140%"> (</span><span style="line-height: 140%; color: blue">int</span><span style="line-height: 140%"> i = 0; i &lt; xg.NumNodes; i++)</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 189</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 190</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// Get each node and check its status</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 191</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 192</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">XrefGraphNode</span><span style="line-height: 140%"> xgn = xg.GetXrefNode(i);</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 193</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 194</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">switch</span><span style="line-height: 140%"> (xgn.XrefStatus)</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 195</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 196</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// If Un*, print a message</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 197</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 198</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">case</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">XrefStatus</span><span style="line-height: 140%">.Unresolved:</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 199</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 200</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;\nUnresolved xref \&quot;{0}\&quot;&quot;</span><span style="line-height: 140%">, xgn.Name</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 201</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; );</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 202</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">break</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 203</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">case</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">XrefStatus</span><span style="line-height: 140%">.Unloaded:</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 204</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 205</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;\nUnloaded xref \&quot;{0}\&quot;&quot;</span><span style="line-height: 140%">, xgn.Name</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 206</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; );</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 207</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">break</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 208</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">case</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">XrefStatus</span><span style="line-height: 140%">.Unreferenced:</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 209</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 210</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;\nUnreferenced xref \&quot;{0}\&quot;&quot;</span><span style="line-height: 140%">, xgn.Name</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 211</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; );</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 212</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">break</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 213</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">case</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">XrefStatus</span><span style="line-height: 140%">.Resolved:</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 214</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 215</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// If Resolved, get the RegAppTable</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 216</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 217</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Database</span><span style="line-height: 140%"> xdb = xgn.Database;</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 218</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (xdb != </span><span style="line-height: 140%; color: blue">null</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 219</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 220</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Transaction</span><span style="line-height: 140%"> tr =</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 221</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; xdb.TransactionManager.StartTransaction();</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 222</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> (tr)</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 223</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 224</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">RegAppTable</span><span style="line-height: 140%"> rat =</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 225</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: #2b91af">RegAppTable</span><span style="line-height: 140%">)tr.GetObject(</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 226</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; xdb.RegAppTableId,</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 227</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">OpenMode</span><span style="line-height: 140%">.ForRead</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 228</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; );</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 229</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 230</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// We'll store our RegApp data in an</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 231</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// object</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 232</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 233</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">RegAppData</span><span style="line-height: 140%"> dwgData = </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">RegAppData</span><span style="line-height: 140%">();</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 234</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; dwgData.Name =</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 235</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (i == 0 ?</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 236</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Path</span><span style="line-height: 140%">.GetFileNameWithoutExtension(</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 237</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; xgn.Name</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 238</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ) :</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 239</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; xgn.Name</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 240</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; );</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 241</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; dwgData.File = xdb.Filename;</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 242</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; dwgData.DwgVersion =</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 243</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; xdb.OriginalFileVersion.ToString();</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 244</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 245</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// Collect the contained names of the</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 246</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// RegAppTableRecords (the RegAppIds)</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 247</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// in a list</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 248</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 249</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">foreach</span><span style="line-height: 140%"> (</span><span style="line-height: 140%; color: #2b91af">ObjectId</span><span style="line-height: 140%"> id </span><span style="line-height: 140%; color: blue">in</span><span style="line-height: 140%"> rat)</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 250</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 251</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">RegAppTableRecord</span><span style="line-height: 140%"> ratr =</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 252</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: #2b91af">RegAppTableRecord</span><span style="line-height: 140%">)tr.GetObject(</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 253</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; id,</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 254</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">OpenMode</span><span style="line-height: 140%">.ForRead</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 255</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; );</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 256</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; dwgData.AddRegAppId(ratr.Name);</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 257</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 258</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 259</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// Store the object in our dictionary,</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 260</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// replacing any existing item</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 261</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// (keyed off the entire DWG path, not</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 262</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// just the name)</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 263</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 264</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (regData.ContainsKey(dwgData.File))</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 265</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; regData.Remove(dwgData.File);</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 266</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; regData.Add(dwgData.File, dwgData);</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 267</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 268</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// Print the drawing information</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 269</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// and the RegAppId count</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 270</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 271</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 272</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;\nDrawing \&quot;{0}\&quot; (\&quot;{1}\&quot;) with &quot;</span><span style="line-height: 140%"> +</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 273</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;{2} RegAppIds&quot;</span><span style="line-height: 140%">,</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 274</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; dwgData.Name,</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 275</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; dwgData.File,</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 276</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; dwgData.RegAppIds.Count</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 277</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; );</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 278</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 279</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// Even if only reading, commit the</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 280</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// transaction (it's cheaper than</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 281</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// aborting)</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 282</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 283</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; tr.Commit();</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 284</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 285</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 286</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">break</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 287</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 288</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 289</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 290</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// Save our data to XML</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 291</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 292</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; SerializeRegAppData(regData);</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 293</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 294</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 295</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">catch</span><span style="line-height: 140%"> (System.</span><span style="line-height: 140%; color: #2b91af">Exception</span><span style="line-height: 140%"> ex)</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 296</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 297</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 298</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;\nProblem reading/processing \&quot;{0}\&quot;: {1}&quot;</span><span style="line-height: 140%">,</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 299</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; pr.StringResult, ex.Message</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 300</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; );</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 301</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 302</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 303</span>&#160;<span style="line-height: 140%">&#160; }</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 304</span>&#160;<span style="line-height: 140%">}</span></p> </div> <!--EndFragment-->  <p>The changes are very minor: we’ve added a DwgVersion attribute to our XML, as well as adjusting the save type of RegAppIds from being a simple string attribute to an array of elements (which allows us to determine the number of RegAppIds per drawing more easily).</p>  <p>We've hardcoded the path of the XML file to <em>C:\</em> (feel free to change this, of course), as well as writing a stylesheet reference directly into the XML to just let the browser take care of the transformation to HTML.</p>  <p>Speaking of the stylesheet, here’s the <em>RegAppData.xslt</em> file to be placed alongside the XML output (currently in <em>C:\</em>, as just mentioned):</p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%; color: blue">&lt;?</span><span style="line-height: 140%; color: #a31515">xml</span><span style="line-height: 140%; color: blue"> </span><span style="line-height: 140%; color: red">version</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">1.0</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue"> </span><span style="line-height: 140%; color: red">encoding</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">utf-8</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">?&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&lt;</span><span style="line-height: 140%; color: #2b91af">xsl:stylesheet</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160; </span><span style="line-height: 140%; color: red">version</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">1.0</span><span style="line-height: 140%">&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160; </span><span style="line-height: 140%; color: red">xmlns:xsl</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">http://www.w3.org/1999/XSL/Transform</span><span style="line-height: 140%">&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160; &lt;</span><span style="line-height: 140%; color: #2b91af">xsl:output</span><span style="line-height: 140%; color: blue"> </span><span style="line-height: 140%; color: red">method</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">html</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue"> </span><span style="line-height: 140%; color: red">indent</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">yes</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue"> </span><span style="line-height: 140%; color: red">version</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">4.0</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">/&gt;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160; &lt;</span><span style="line-height: 140%; color: #2b91af">xsl:template</span><span style="line-height: 140%; color: blue"> </span><span style="line-height: 140%; color: red">match</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">ArrayOfRegAppData</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">h2</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">Registered application IDs per drawing</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">h2</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">table</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">tr</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">td</span><span style="line-height: 140%; color: blue">&gt;&lt;</span><span style="line-height: 140%; color: #a31515">em</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">Drawing name</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">em</span><span style="line-height: 140%; color: blue">&gt;&lt;/</span><span style="line-height: 140%; color: #a31515">td</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">td</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">em</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">Number of RegAppIds</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">em</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/</span><span style="line-height: 140%; color: #a31515">td</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;/</span><span style="line-height: 140%; color: #a31515">tr</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #2b91af">xsl:apply-templates</span><span style="line-height: 140%; color: blue"> </span><span style="line-height: 140%; color: red">select</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">*</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">/&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; &lt;/</span><span style="line-height: 140%; color: #a31515">table</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160; &lt;/</span><span style="line-height: 140%; color: #2b91af">xsl:template</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160; &lt;</span><span style="line-height: 140%; color: #2b91af">xsl:template</span><span style="line-height: 140%; color: blue"> </span><span style="line-height: 140%; color: red">match</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">RegAppData</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">tr</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">td</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">b</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #2b91af">xsl:attribute</span><span style="line-height: 140%; color: blue"> </span><span style="line-height: 140%; color: red">name</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">Title</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #2b91af">xsl:value-of</span><span style="line-height: 140%; color: blue"> </span><span style="line-height: 140%; color: red">select</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">@File</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">/&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #2b91af">xsl:text</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%"> (</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #2b91af">xsl:text</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #2b91af">xsl:value-of</span><span style="line-height: 140%; color: blue"> </span><span style="line-height: 140%; color: red">select</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">@DwgVersion</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">/&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #2b91af">xsl:text</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">)</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #2b91af">xsl:text</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/</span><span style="line-height: 140%; color: #2b91af">xsl:attribute</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #2b91af">xsl:value-of</span><span style="line-height: 140%; color: blue"> </span><span style="line-height: 140%; color: red">select</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">@Name</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">/&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/</span><span style="line-height: 140%; color: #a31515">b</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;/</span><span style="line-height: 140%; color: #a31515">td</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">td</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #2b91af">xsl:attribute</span><span style="line-height: 140%; color: blue"> </span><span style="line-height: 140%; color: red">name</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">Title</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #2b91af">xsl:for-each</span><span style="line-height: 140%; color: blue"> </span><span style="line-height: 140%; color: red">select</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">RegAppIds/RegAppId</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #2b91af">xsl:value-of</span><span style="line-height: 140%; color: blue"> </span><span style="line-height: 140%; color: red">select</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">node()</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">/&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #2b91af">xsl:if</span><span style="line-height: 140%; color: blue"> </span><span style="line-height: 140%; color: red">test</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">position() != last()</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #2b91af">xsl:text</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%; color: red">&amp;#x0A;</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #2b91af">xsl:text</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/</span><span style="line-height: 140%; color: #2b91af">xsl:if</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/</span><span style="line-height: 140%; color: #2b91af">xsl:for-each</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/</span><span style="line-height: 140%; color: #2b91af">xsl:attribute</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">center</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #2b91af">xsl:value-of</span><span style="line-height: 140%; color: blue"> </span><span style="line-height: 140%; color: red">select</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">count(RegAppIds/RegAppId)</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">/&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/</span><span style="line-height: 140%; color: #a31515">center</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;/</span><span style="line-height: 140%; color: #a31515">td</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; &lt;/</span><span style="line-height: 140%; color: #a31515">tr</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160; &lt;/</span><span style="line-height: 140%; color: #2b91af">xsl:template</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #2b91af">xsl:stylesheet</span><span style="line-height: 140%; color: blue">&gt;</span></p> </div> <!--EndFragment-->  <p>The stylesheet is also quite simple: it creates an HTML file containing a table of two columns – one with the names of our drawings (with the path and version in a tooltip) and the number of RegAppIds found in that drawing (with the specific names in a tooltip). We’ll see that in action a bit.</p>  <p>Running the XRA command just as we did in the last post, we should see this kind of XML output:</p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%; color: blue">&lt;?</span><span style="line-height: 140%; color: #a31515">xml-stylesheet</span><span style="line-height: 140%; color: blue"> </span><span style="line-height: 140%; color: gray">type=&quot;text/xsl&quot; href=&quot;RegAppData.xslt&quot;</span><span style="line-height: 140%; color: blue">?&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&lt;</span><span style="line-height: 140%; color: #a31515">ArrayOfRegAppData</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160; </span><span style="line-height: 140%; color: red">xmlns:xsi</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">http://www.w3.org/2001/XMLSchema-instance</span><span style="line-height: 140%">&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160; </span><span style="line-height: 140%; color: red">xmlns:xsd</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">http://www.w3.org/2001/XMLSchema</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppData</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; </span><span style="line-height: 140%; color: red">Name</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">A-01</span><span style="line-height: 140%">&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; </span><span style="line-height: 140%; color: red">File</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">C:\Program Files\Autodesk\AutoCAD 2011\Sample\Sheet Sets\Architectural\A-01.dwg</span><span style="line-height: 140%">&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; </span><span style="line-height: 140%; color: red">DwgVersion</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">Current</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppIds</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">ACAD</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">CONTENTBLOCKDESCRIPTION</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">CONTENTBLOCKICON</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">CONTENTTABDATA</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">CONTENTCURRENTTAB</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">ACAD_PSEXT</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">PE_URL</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">RAK</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">AcAecLayerStandard</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">ACAD_DSTYLE_DIMTEXT_FILL</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">ACAD_EXEMPT_FROM_CAD_STANDARDS</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">AcDbBlockRepETag</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">AcDbDynamicBlockTrueName</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">AcDbDynamicBlockGUID</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">AcDbBlockRepBTag</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">ACAD_DSTYLE_DIMEXT_LENGTH</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">ACAD_DSTYLE_DIMEXT_ENABLED</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">ACAD_DSTYLE_DIM_LINETYPE</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">ACAD_DSTYLE_DIM_EXT1_LINETYPE</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">ACAD_DSTYLE_DIM_EXT2_LINETYPE</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">ACAD_MLEADERVER</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; &lt;/</span><span style="line-height: 140%; color: #a31515">RegAppIds</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160; &lt;/</span><span style="line-height: 140%; color: #a31515">RegAppData</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppData</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; </span><span style="line-height: 140%; color: red">Name</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">Grid Plan</span><span style="line-height: 140%">&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; </span><span style="line-height: 140%; color: red">File</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">C:\Program Files\Autodesk\AutoCAD 2011\Sample\Sheet Sets\Architectural\Res\Grid Plan.dwg</span><span style="line-height: 140%">&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; </span><span style="line-height: 140%; color: red">DwgVersion</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">AC1021</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppIds</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">ACAD</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">CONTENTBLOCKDESCRIPTION</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">CONTENTBLOCKICON</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">CONTENTTABDATA</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">CONTENTCURRENTTAB</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">ACAD_PSEXT</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">ACAD_DSTYLE_DIMTEXT_FILL</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; &lt;/</span><span style="line-height: 140%; color: #a31515">RegAppIds</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160; &lt;/</span><span style="line-height: 140%; color: #a31515">RegAppData</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppData</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; </span><span style="line-height: 140%; color: red">Name</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">Wall Base</span><span style="line-height: 140%">&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; </span><span style="line-height: 140%; color: red">File</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">C:\Program Files\Autodesk\AutoCAD 2011\Sample\Sheet Sets\Architectural\Res\Wall Base.dwg</span><span style="line-height: 140%">&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; </span><span style="line-height: 140%; color: red">DwgVersion</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">AC1021</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppIds</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">ACAD</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">CONTENTBLOCKDESCRIPTION</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">CONTENTBLOCKICON</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">CONTENTTABDATA</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">CONTENTCURRENTTAB</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">RAK</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">AcAecLayerStandard</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">ACAD_PSEXT</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">PE_URL</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">ACAD_DSTYLE_DIMTEXT_FILL</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">ACAD_MLEADERVER</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; &lt;/</span><span style="line-height: 140%; color: #a31515">RegAppIds</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160; &lt;/</span><span style="line-height: 140%; color: #a31515">RegAppData</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppData</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; </span><span style="line-height: 140%; color: red">Name</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">Master Site Plan</span><span style="line-height: 140%">&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; </span><span style="line-height: 140%; color: red">File</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">C:\Program Files\Autodesk\AutoCAD 2011\Sample\Sheet Sets\Civil\Master Site Plan.dwg</span><span style="line-height: 140%">&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; </span><span style="line-height: 140%; color: red">DwgVersion</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">AC1021</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppIds</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">ACAD</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">RAK</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">DCA_FIGURE_XENT</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">ADE</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">ALIGNMENT_DB_APP</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">SDI_PROFILE</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">SDSK_POINT</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">SVPLINE</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">ADCADD_ZZ</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">SDSK_PMN</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">CIVIL_DRAFT</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">CIVIL_LINE_TABLE</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">CIVIL_CURVE_TABLE</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">CIVIL_SPIRAL_TABLE</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">SDI_XSECTIONS</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">ACAD_PSEXT</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">ACAD_MLEADERVER</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">DCO15</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; &lt;/</span><span style="line-height: 140%; color: #a31515">RegAppIds</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160; &lt;/</span><span style="line-height: 140%; color: #a31515">RegAppData</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppData</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; </span><span style="line-height: 140%; color: red">Name</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">PB-BASE</span><span style="line-height: 140%">&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; </span><span style="line-height: 140%; color: red">File</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">C:\Program Files\Autodesk\AutoCAD 2011\Sample\Sheet Sets\Civil\PB-BASE.dwg</span><span style="line-height: 140%">&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; </span><span style="line-height: 140%; color: red">DwgVersion</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">AC1021</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppIds</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">ACAD</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">RAK</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">DCA_FIGURE_XENT</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">ALIGNMENT_DB_APP</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">SDI_PROFILE</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">ACAD_PSEXT</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">ACAD_MLEADERVER</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; &lt;/</span><span style="line-height: 140%; color: #a31515">RegAppIds</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160; &lt;/</span><span style="line-height: 140%; color: #a31515">RegAppData</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppData</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; </span><span style="line-height: 140%; color: red">Name</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">PB-EX41</span><span style="line-height: 140%">&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; </span><span style="line-height: 140%; color: red">File</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">C:\Program Files\Autodesk\AutoCAD 2011\Sample\Sheet Sets\Civil\PB-EX41.dwg</span><span style="line-height: 140%">&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; </span><span style="line-height: 140%; color: red">DwgVersion</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">AC1021</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppIds</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">ACAD</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">SDSK_POINT</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">SVPLINE</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">ACAD_PSEXT</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">DCO15</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">ACAD_MLEADERVER</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; &lt;/</span><span style="line-height: 140%; color: #a31515">RegAppIds</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160; &lt;/</span><span style="line-height: 140%; color: #a31515">RegAppData</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppData</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; </span><span style="line-height: 140%; color: red">Name</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">PB-EX61</span><span style="line-height: 140%">&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; </span><span style="line-height: 140%; color: red">File</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">C:\Program Files\Autodesk\AutoCAD 2011\Sample\Sheet Sets\Civil\PB-EX61.dwg</span><span style="line-height: 140%">&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; </span><span style="line-height: 140%; color: red">DwgVersion</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">AC1021</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppIds</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">ACAD</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">SVPLINE</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">ACAD_PSEXT</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">DCO15</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">ACAD_MLEADERVER</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RegAppId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; &lt;/</span><span style="line-height: 140%; color: #a31515">RegAppIds</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160; &lt;/</span><span style="line-height: 140%; color: #a31515">RegAppData</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">ArrayOfRegAppData</span><span style="line-height: 140%; color: blue">&gt;</span></p> </div> <!--EndFragment-->  <p>Which, when loaded into a browser, should be displayed like this:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e20148c830fcb9970c-pi"><img style="background-image: none; border-right-width: 0px; margin: 0px auto; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="Our HTML report on RegAppIds" border="0" alt="Our HTML report on RegAppIds" src="/assets/image_837504.jpg" width="354" height="430" /></a></p>  <p>As we hover over the name of a drawing in which we’re interested, we see its path and drawing version:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e20148c830fcdc970c-pi"><img style="background-image: none; border-right-width: 0px; margin: 0px auto; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="With our drawing location and version" border="0" alt="With our drawing location and version" src="/assets/image_527513.jpg" width="354" height="430" /></a></p>  <p>And as we hover over the RegAppId count, we see the names of the individual IDs:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e20148c830fd76970c-pi"><img style="background-image: none; border-right-width: 0px; margin: 0px auto; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="And our RegAppIds listed" border="0" alt="And our RegAppIds listed" src="/assets/image_65969.jpg" width="354" height="430" /></a></p>  <p>That’s it for this post. We’ll wrap this series up by making some modifications to ScriptPro 2.0 in the next post.</p>
