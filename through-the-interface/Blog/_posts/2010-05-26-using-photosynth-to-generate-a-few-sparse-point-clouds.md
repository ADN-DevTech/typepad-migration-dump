---
layout: "post"
title: "Using Photosynth to generate a few sparse point clouds"
date: "2010-05-26 20:55:12"
author: "Kean Walmsley"
categories:
  - "AutoCAD"
  - "AutoCAD .NET"
  - "Point clouds"
  - "Reality capture"
original_url: "https://www.keanw.com/2010/05/using-photosynth-to-generate-a-few-sparse-point-clouds.html "
typepad_basename: "using-photosynth-to-generate-a-few-sparse-point-clouds"
typepad_status: "Publish"
---

<p>While on my way to San Francisco, last weekend, I had a 7-hour layover in Washington D.C. Given the amount of time available to me I decided to head from Dulles into the centre of the city and do something fun: I ended up choosing to visit the Natural History Museum at <a href="http://www.si.edu/" target="_blank">The Smithsonian</a>, which proved to be really interesting even to my somewhat bleary eyes.</p>
<p>Part of my motivation was to try to capture something for bringing into Photosynth (as I’d borrowed my wife’s digital SLR for taking some snaps at the wedding I was attending in Las Vegas). I’m becoming increasingly fascinated with the field of <a href="http://en.wikipedia.org/wiki/Computer_vision" target="_blank">computer vision</a> (I’ve talked in the past about <a href="http://through-the-interface.typepad.com/through_the_interface/2010/03/reality-check.html" target="_blank">some of the possibilities it brings to our industry</a>), and am doing what I can to get to know more about it, which will prove especially important if <a href="http://through-the-interface.typepad.com/through_the_interface/2010/05/voting-open-for-au-2010-sessions.html" target="_blank">I end up talking about it at AU</a>.</p>
<p>Before I show – and talk about – the results of these efforts, here are the basic steps for creating a Photosynth.</p>
<p>Firstly you clearly need to take pictures. I won’t give much advice on how to do this – as I seem not to be getting the best results, myself – but the trick appears to be to make sure you take enough pictures of a chosen target that has a lot of “features” which can be matches between these images. A point needs to be shared across a minimum of three photos taken from different angles, it seems, for it to be coordinated properly in 3D space.</p>
<p>Once you have a set of snaps, go to the <a href="http://photosynth.net" target="_blank">Photosynth</a> website and select the “Upload” button at the top-right of the page followed by the “Create a Synth” button on the following page (at you will need to log in via your Microsoft Live login). You should see a UI allowing you to select images and name your synth:</p>
<p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2013481da594a970c-pi"><img alt="The UI for creating a synth" border="0" height="354" src="/assets/image_185384.jpg" style="display: block; float: none; margin-left: auto; margin-right: auto; border-width: 0px;" title="The UI for creating a synth" width="471" /></a></p>
<p>Once you’ve specified basic information for your synth and have selected the photos to use, you can choose the “Synth” button, which will fire off a sequence of operations:</p>
<p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2013481da5e72970c-pi"><img alt="Creating a Photosynth" border="0" height="126" src="/assets/image_752398.jpg" style="display: inline; border-width: 0px;" title="Creating a Photosynth" width="204" /></a>&#0160;<a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2013481da63e3970c-pi"><img alt="Extracting image features" border="0" height="126" src="/assets/image_605826.jpg" style="display: inline; border-width: 0px;" title="Extracting image features" width="204" /></a> <a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2013481da68c8970c-pi"><img alt="Matching images" border="0" height="126" src="/assets/image_926044.jpg" style="display: inline; border-width: 0px;" title="Matching images" width="204" /></a> <a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2013481da6de8970c-pi"><img alt="Reconstructing scene" border="0" height="126" src="/assets/image_963579.jpg" style="display: inline; border-width: 0px;" title="Reconstructing scene" width="204" /></a> <a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e20133eea96525970b-pi"><img alt="Generating synth files" border="0" height="126" src="/assets/image_627397.jpg" style="display: inline; border-width: 0px;" title="Generating synth files" width="204" /></a> <a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e20133eea96780970b-pi"><img alt="Uploading files" border="0" height="126" src="/assets/image_986476.jpg" style="display: inline; border-width: 0px;" title="Uploading files" width="204" /></a> <a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2013481da777f970c-pi"><img alt="Completed" border="0" height="126" src="/assets/image_428687.jpg" style="display: inline; border-width: 0px;" title="Completed" width="204" /></a></p>
<p>Now despite the fact that there’s <a href="http://photosynth.net/photosynthws/PhotosynthService.asmx" target="_blank">a web service</a> providing access to Photosynth data, a lot of the heavy lifting needed to create the synth (such as extracting the image features and matching them across the various images) is performed in the “Synther” part of the Photosynth client, while the photos themselves are being uploaded: a systems architecture apparently known as <a href="http://en.wikipedia.org/wiki/Edge_computing" target="_blank">edge computing</a>. While in some ways being an efficient use of computing resources, this approach does appear to limit the ability to just use the web service to create synths – something I would love to do – which is a shame. [If someone is able to tell me I’m wrong about this, I’ll very happily buy them a beer. :-)]</p>
<p>It’s also important to note that the algorithm used to match features between images is <a href="http://en.wikipedia.org/wiki/Nonlinear_system" target="_blank">non-linear</a> – in this case each image needs to be compared with each of the others, from what I understand, which makes it an n-squared problem – so you will see the time taken get proportionally longer as you add images to your set. I’m very interested as to why the decision was made to run these operations locally, rather than to just throw them at “the cloud”. Perhaps the economics behind a potentially high-usage service such as Photosynth doesn’t/didn’t lend itself to performing such operations centrally, and that it makes sense for the client to take a share of the burden.</p>
<p>I created a few synths of skeletons from images taken at <a href="http://en.wikipedia.org/wiki/Smithsonian_Institution" target="_blank">The Smithsonian</a>:</p>
<iframe frameborder="0" height="240" src="http://photosynth.net/embed.aspx?cid=62a98197-2a31-41c2-8253-ca1efee7f554&amp;delayLoad=true&amp;slideShowPlaying=false" width="400"></iframe> Oh deer     <iframe frameborder="0" height="240" src="http://photosynth.net/embed.aspx?cid=3f5e7c47-24f1-4399-9a62-68481e82bce2&amp;delayLoad=true&amp;slideShowPlaying=false" width="400"></iframe> A skinny bird     <iframe frameborder="0" height="240" src="http://photosynth.net/embed.aspx?cid=cadec28d-efdc-421b-9944-e4f67486b2dd&amp;delayLoad=true&amp;slideShowPlaying=false" width="400"></iframe> A scary looking beast
<p>None of these synths came out especially well, in my opinion: they have quite low “synthiness” scores, which reflects how many of the images contributed to the point cloud, probably because I felt a bit foolish taking more than 30 or so pictures of any one thing in a museum and also the varying effects of the flash probably hampered the ability to stitch these images together.</p>
<p>One more thing to bear in mind: Photosynth really only provides a “sparse” point cloud – the points needed to help coordinate the camera positions of the various images. It’s clearly possible to sample more points to create a more dense cloud once you have accurate camera positions, but this isn’t currently the focus of the Photosynth service, and so expectations should be set appropriately. That’s not to say it’s not possible to create clouds of 1M+ points using Photosynth – <a href="http://photosynth.net/view.aspx?cid=4dee6f33-43a7-4120-bedb-770040c95f2a" target="_blank">I’ve seen that happen</a> – but it really takes a lot of dedication to get up to that level of detail.</p>
<p>As <a href="http://video-jsoe.ucsd.edu/asx/AguerayArcas.asx" target="_blank">Blaise Aguera y Arcas states</a>, it’s possible to densify point clouds coming out of systems such as Photosynth – by using tools such as <a href="http://grail.cs.washington.edu/projects/mvscpc/" target="_blank">MVSCPC</a> – but for that you need that camera location information (which does appear to be accessible, based on <a href="http://synthexport.codeplex.com/releases/view/45675" target="_blank">the latest version of Christoph Hausner’s exporter</a>). Just as point clouds are really only a by-product of Photosynth, for a 3D editing system with computer vision/photogrammetry integrated more closely, the need to make use of the base point cloud is reduced: you could be generating a mesh or even some more appropriate 3D geometry instead.</p>
<p>Near the end of my week in the Bay Area, I spent some time chatting about this field with <a href="http://images.autodesk.com/adsk/files/brian_mathews_bio.pdf" target="_blank">Brian Mathews</a>, the VP of <a href="http://labs.autodesk.com" target="_blank">Autodesk Labs</a>. Brian is a scarily bright fellow with deep insights into many different areas of technology. To demo something his team is working on – once again, watch this space :-) – he took a set of photos that I’ve also uploaded into Photosynth:</p>
<iframe frameborder="0" height="240" src="http://photosynth.net/embed.aspx?cid=761487ac-bc5b-461f-89fa-528df84ab72f&amp;delayLoad=true&amp;slideShowPlaying=false" width="400"></iframe> Kean’s head
<p>To get a feel for the results, here’s a screenshot of the point cloud inside AutoCAD. You can try this yourself using <a href="http://through-the-interface.typepad.com/through_the_interface/2010/04/importing-photosynth-point-clouds-into-autocad-2011-part-4.html" target="_blank">the Photosynth import plugin</a> I’ve shown in recent posts. It’s a very light point cloud – just 9,425 points from the 31 source images – but at least it looks like me from a distance. :-)</p>
<p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2013481da7a7b970c-pi"><img alt="Kean&#39;s head in AutoCAD" border="0" height="372" src="/assets/image_985913.jpg" style="display: block; float: none; margin-left: auto; margin-right: auto; border: 0px;" title="Kean&#39;s head in AutoCAD" width="377" /></a></p>
<p><em>Thanks to Nate Lawrence for pointing me at </em><a href="http://synthexport.codeplex.com/Thread/View.aspx?ThreadId=204015" target="_blank"><em>a related discussion</em></a><em> on some of the above issues (I’d been planning a post along these lines, but when Nate pinged me it reminded me of some relevant resources he listed therein).</em></p>
