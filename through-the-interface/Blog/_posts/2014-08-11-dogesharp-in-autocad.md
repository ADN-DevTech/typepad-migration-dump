---
layout: "post"
title: "DogeSharp in AutoCAD"
date: "2014-08-11 17:42:01"
author: "Kean Walmsley"
categories:
  - "AutoCAD"
  - "AutoCAD .NET"
  - "JavaScript"
  - "Web/Tech"
original_url: "https://www.keanw.com/2014/08/dogesharp-in-autocad.html "
typepad_basename: "dogesharp-in-autocad"
typepad_status: "Publish"
---

<p>Sometimes you just need to ease back into work after a few weeks off. So today I decided to have a go at integrating <a href="https://github.com/returnString/DogeSharp" target="_blank">DogeSharp</a> – a programming language on top of of .NET inspired by <a href="http://dogescript.com" target="_blank">Dogescript</a> – into AutoCAD. There was absolutely no reason to do so, other than to cause myself some amusement. Which is actually a pretty good reason, now that I think about it.</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201a3fd44cb4d970b-pi" target="_blank"><img title="Doge" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; float: none; padding-top: 0px; padding-left: 0px; margin: 20px auto; display: block; padding-right: 0px; border-top-width: 0px" border="0" alt="Doge" src="/assets/image_89064.jpg" width="399" height="300" /></a></p>  <p>For those of you who – like me – are almost completely unaware of Internet memes such as <a href="http://knowyourmeme.com/memes/doge" target="_blank">Doge</a>, this was apparently a big one in 2013 and all started with <a href="http://kabosu112.exblog.jp/9944144" target="_blank">this blog post</a>. Although as the meme has since grown big enough for <a href="http://imgur.com/r/doge/vM0Tewd" target="_blank">advertisers</a> and <a href="http://www.businessinsider.com/doge-memes-congress-steve-stockman-massie-2013-12" target="_blank">politicians</a> to jump on the bandwagon, at this point it seems to be well past its prime.</p>  <p>But programmers don’t necessarily care about such mundane things as external validation. And we often look at things on a different timescale. Code can end up having a surprising lifespan – it can be used once and then disappear or it can stay around forever – and as we all know this sadly isn’t necessarily based on its quality. Who knows what tomorrow will bring… why not write code in a language that causes you and the people around you some entertainment? (I’m not actually advocating this, of course… apart from anything else, the <a href="http://autodesk.com/joinadn" target="_blank">ADN</a> team won’t thank me if they end up having to provide support for Doge[script|Sharp]. :-)</p>  <p>The Dogescript and DogeSharp languages make use of the usual Dogesque words: so, such, much, many, very, wow, amaze, plz, etc. Here’s some code I ended up getting working to builds a functional AutoCAD command (I saved this code in a file named <em>AutoCAD.ds</em>):</p>  <div style="font-size: 8pt; font-family: courier new; background: white; color: black; line-height: 140%">   <p style="margin: 0px">many System</p>    <p style="margin: 0px">many Autodesk.AutoCAD.Runtime</p>    <p style="margin: 0px">many Autodesk.AutoCAD.ApplicationServices</p>    <p style="margin: 0px">many Autodesk.AutoCAD.EditorInput</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">much MyClass</p>    <p style="margin: 0px">&#160;&#160;&#160; [such CommandMethod many &quot;DOGE&quot;]</p>    <p style="margin: 0px">&#160;&#160;&#160; very TestCommand so void much static much public</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; such doc Application.DocumentManager.MdiActiveDocument</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; such ed doc.Editor</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; such num plz NumFunc;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; plz ed.WriteMessage many &quot;wow – such amaze ... &quot;;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; plz ed.WriteMessage many plz num.ToString;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; very NumFunc so long much static</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; such rand gimme Random;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; such num plz rand.Next;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; amaze num;</p> </div>  <p>I did have to work around one minor quirk: I ended up making multiple calls to WriteMessage() as the formatting string didn’t get passed through as expected. No big deal, though.</p>  <p>Just as Dogescript compiles to JavaScript, DogeSharp gets translated to C# which then builds a .NET executable (whether a .EXE or .DLL). The DogeSharp project on GitHub basically implements a command-line executable that passes a .ds file and generates an appropriate assembly as per the command-line arguments. (<strike>I did have to make a minor change to the DogeSharp code to allow classes to be public and so visible to AutoCAD, but </strike><a href="https://twitter.com/returnString/statuses/498823032438554625" target="_blank"><strike>I’m told this will be fixed soon</strike></a><strike>.</strike> This has now been fixed. Thanks, Ruan!)</p>  <p>Here are the command-line arguments I added to the DogeSharp samples’ <em>build.bat</em> to build the desired <em>AutoCAD-DS.dll</em> (after copying <em>AcMgd.dll</em>, <em>AcDbMgd.dll</em> and <em>AcCoreMgd.dll</em> from the ObjectARX SDK’s inc folder into DogeSharp’s <em>Samples\Libs</em> folder):</p>  <div style="font-size: 8pt; font-family: courier new; background: white; color: black; line-height: 140%">   <p>echo Building AutoCAD sample </p>    <p style="margin: 0px">%dsc% AutoCAD.ds /target:library /out:AutoCAD-DS.dll /reference:Libs\AcDbMgd.dll /reference:Libs\AcCoreMgd.dll</p>    <p style="margin: 0px">/reference:Libs\AcMgd.dll /reference:System.dll /preservetranslated</p> </div>  <p>The %dsc% system variable resolves to the dsc.exe executable built by the DogeSharp project… the DSC tool isn’t truly integrated into the VS project environment, but as <em>build.bat</em> gets executed as a post-build step (or rather a pre-build step on the chained Samples project), everything gets launched from within Visual Studio.</p>  <p>I mean to say, what’s not to like about a command-line tool that populates the VS output with such cool ASCII art? :-)</p>  <div style="font-size: 8pt; font-family: courier new; background: white; color: black; line-height: 140%">   <p style="margin: 0px">1&gt;&#160; Building AutoCAD sample</p>    <p style="margin: 0px">1&gt;&#160; </p>    <p style="margin: 0px">1&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ▄&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ▄</p>    <p style="margin: 0px">1&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ▌▒█&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ▄▀▒▌</p>    <p style="margin: 0px">1&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ▌▒▒█&#160;&#160;&#160;&#160;&#160;&#160;&#160; ▄▀▒▒▒▐</p>    <p style="margin: 0px">1&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ▐▄▀▒▒▀▀▀▀▄▄▄▀▒▒▒▒▒▐</p>    <p style="margin: 0px">1&gt;&#160;&#160;&#160;&#160;&#160;&#160; ▄▄▀▒░▒▒▒▒▒▒▒▒▒█▒▒▄█▒▐</p>    <p style="margin: 0px">1&gt;&#160;&#160;&#160;&#160; ▄▀▒▒▒░░░▒▒▒░░░▒▒▒▀██▀▒▌</p>    <p style="margin: 0px">1&gt;&#160;&#160;&#160; ▐▒▒▒▄▄▒▒▒▒░░░▒▒▒▒▒▒▒▀▄▒▒▌</p>    <p style="margin: 0px">1&gt;&#160;&#160;&#160; ▌░░▌█▀▒▒▒▒▒▄▀█▄▒▒▒▒▒▒▒█▒▐</p>    <p style="margin: 0px">1&gt;&#160;&#160; ▐░░░▒▒▒▒▒▒▒▒▌██▀▒▒░░░▒▒▒▀▄▌</p>    <p style="margin: 0px">1&gt;&#160;&#160; ▌░▒▄██▄▒▒▒▒▒▒▒▒▒░░░░░░▒▒▒▒▌</p>    <p style="margin: 0px">1&gt;&#160; ▀▒▀▐▄█▄█▌▄░▀▒▒░░░░░░░░░░▒▒▒▐</p>    <p style="margin: 0px">1&gt;&#160; ▐▒▒▐▀▐▀▒░▄▄▒▄▒▒▒▒▒▒░▒░▒░▒▒▒▒▌</p>    <p style="margin: 0px">1&gt;&#160; ▐▒▒▒▀▀▄▄▒▒▒▄▒▒▒▒▒▒▒▒░▒░▒░▒▒▐</p>    <p style="margin: 0px">1&gt;&#160;&#160; ▌▒▒▒▒▒▒▀▀▀▒▒▒▒▒▒░▒░▒░▒░▒▒▒▌</p>    <p style="margin: 0px">1&gt;&#160;&#160; ▐▒▒▒▒▒▒▒▒▒▒▒▒▒▒░▒░▒░▒▒▄▒▒▐</p>    <p style="margin: 0px">1&gt;&#160;&#160;&#160; ▀▄▒▒▒▒▒▒▒▒▒▒▒░▒░▒░▒▄▒▒▒▒▌</p>    <p style="margin: 0px">1&gt;&#160;&#160;&#160;&#160;&#160; ▀▄▒▒▒▒▒▒▒▒▒▒▄▄▄▀▒▒▒▒▄▀</p>    <p style="margin: 0px">1&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ▀▄▄▄▄▄▄▀▀▀▒▒▒▒▒▄▄▀</p>    <p style="margin: 0px">1&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ▒▒▒▒▒▒▒▒▒▒▀▀</p>    <p style="margin: 0px">1&gt;&#160; </p>    <p style="margin: 0px">1&gt;&#160; </p>    <p style="margin: 0px">1&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; many D#</p>    <p style="margin: 0px">1&gt;&#160; </p>    <p style="margin: 0px">1&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; very c Ruan Pearce-Authers</p>    <p style="margin: 0px">1&gt;&#160; </p>    <p style="margin: 0px">1&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; much programming</p>    <p style="margin: 0px">1&gt;&#160; </p>    <p style="margin: 0px">1&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; such language</p>    <p style="margin: 0px">1&gt;&#160; </p>    <p style="margin: 0px">1&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; very translating...</p>    <p style="margin: 0px">1&gt;&#160; </p>    <p style="margin: 0px">1&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160; much translation: AutoCAD.ds</p>    <p style="margin: 0px">1&gt;&#160; </p>    <p style="margin: 0px">1&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; so forwarding: /target:library</p>    <p style="margin: 0px">1&gt;&#160; </p>    <p style="margin: 0px">1&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; very references: Libs\AcDbMgd.dll, Libs\AcCoreMgd.dll, Libs\AcMgd.dll, System.dll</p>    <p style="margin: 0px">1&gt;&#160; </p>    <p style="margin: 0px">1&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; such translated, wow</p>    <p style="margin: 0px">1&gt;&#160; </p>    <p style="margin: 0px">1&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; many compiling...</p>    <p style="margin: 0px">1&gt;&#160; </p>    <p style="margin: 0px">1&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; such compiled, wow</p>    <p style="margin: 0px">1&gt;&#160; </p>    <p style="margin: 0px">1&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; many time, such elapsed, so milliseconds: 451</p>    <p style="margin: 0px">1&gt;&#160; </p>    <p style="margin: 0px">1&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; many success: AutoCAD-DS.dll</p>    <p style="margin: 0px">1&gt;&#160; </p>    <p style="margin: 0px">1&gt;&#160; Samples -&gt; Z:\GitHub\DogeSharp\Samples\bin\Debug\Samples.dll</p> </div>  <p>When NETLOADed into AutoCAD, <em>AutoCAD-DS.dll</em> defines the DOGE command that prints a message and a random number:</p>  <div style="font-size: 8pt; font-family: courier new; background: white; color: black; line-height: 140%">   <p style="margin: 0px">Command: <font color="#ff0000">DOGE</font></p>    <p style="margin: 0px">wow - such amaze . . .1391841392</p> </div>  <p>If you do end up messing around with DogeSharp, please do pass on any feedback/suggestions to the author, <a href="https://twitter.com/returnString" target="_blank">Ruan Pearce-Authers</a>.</p>
