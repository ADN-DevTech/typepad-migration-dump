---
layout: "post"
title: "AU 2012 Handout: Developing a simple Metro-style application for Windows 8 &ndash; Part 2"
date: "2012-11-19 11:01:00"
author: "Kean Walmsley"
categories:
  - "AU"
  - "AutoCAD"
  - "AutoCAD .NET"
  - "Core Console"
  - "WinRT"
original_url: "https://www.keanw.com/2012/11/au-2012-handout-developing-a-simple-metro-style-application-for-windows-8-part-2.html "
typepad_basename: "au-2012-handout-developing-a-simple-metro-style-application-for-windows-8-part-2"
typepad_status: "Publish"
---

<p><em>This post contains the second part of the handout for </em><a href="https://www.autodeskuniversity2012.com/connect/sessionDetail.ww?SESSION_ID=1921" target="_blank"><em>my Windows 8-related session at AU 2012</em></a><em> (</em><a href="http://through-the-interface.typepad.com/through_the_interface/2012/11/au-2012-handout-developing-a-simple-metro-style-application-for-windows-8-part-1.html" target="_blank"><em>here’s the first part</em></a><em>). <a href="http://through-the-interface.typepad.com/files/MetroCAD-4.zip" target="_blank">Here’s the accompanying source project for the MetroCAD application</a>, which has now been upgraded to work on the shipping version of Windows 8.</em></p>  <h3>What can be done with AutoCAD?</h3>  <p>Something that’s being promoted by Microsoft to developers of “heavyweight” desktop apps is the idea of a companion app. These are essentially Windows Store apps that complement desktop apps such as AutoCAD.</p>  <p>We’re going to see one such companion app in this session: an app called MetroCAD that is basically a browser for MRU (Most Recently Used) file information that gets created by AutoCAD on the current system.</p>  <p>This browser app will work as a companion to AutoCAD, showing file-level information – including drawing thumbnails – and even provide the capability to launch AutoCAD (or the application that has been most recently associated with the DWG file-type).</p>  <h3>Browsing AutoCAD’s MRU data in WinRT </h3>  <p>AutoCAD stores is MRU-related information in the Registry – which those of you who have been paying attention will remember cannot be accessed directly from WinRT – so in order for this app to work we will need a desktop-resident component that extracts this information and makes it available to WinRT apps with appropriate permissions.</p>  <p>This extraction component could work from within AutoCAD or be completely standalone, and ideally would be automated.</p>  <p>In our case, we’re actually going to implement something in-between that makes use of a new feature in AutoCAD 2013, the Core Console.</p>  <h3>Extracting AutoCAD MRU data from the Registry</h3>  <p>We need a simple app that can query the Registry and populate some data on our file-system. We’ll store an overall manifest of the browsed DWGs in an XML file and supplement that with a set of thumbnail images we extract from the various DWG files.</p>  <p>We’ll also copy the source DWG into a specific folder, as launching a DWG from an arbitrary location is going to be problematic (this is one downside of the launching capability that we’ll see in more detail later on).</p>  <p>Here’s the C# code for our app. The project containing is a standard C# Class Library with project references to System.Drawing, AcDbMgd.dll and AcCoreMgd.dll. </p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.ApplicationServices.Core;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.DatabaseServices;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.EditorInput;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.Runtime;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Microsoft.Win32;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> System.Collections.Generic;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> System.Drawing.Imaging;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> System.Drawing;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> System.IO;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> System;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">namespace</span><span style="line-height: 140%"> MruExtraction</span></p>    <p style="margin: 0px"><span style="line-height: 140%">{</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">class</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Commands</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%"> basePath =</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Environment</span><span style="line-height: 140%">.GetFolderPath(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Environment</span><span style="line-height: 140%">.</span><span style="line-height: 140%; color: #2b91af">SpecialFolder</span><span style="line-height: 140%">.MyDocuments</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; ) + </span><span style="line-height: 140%; color: #a31515">&quot;\\MetroCAD\\&quot;</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">const</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">char</span><span style="line-height: 140%"> stringSep = </span><span style="line-height: 140%; color: #a31515">'|'</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%">[] GetMruFiles()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">List</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%">&gt; files = </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">List</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%">&gt;();</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">RegistryKey</span><span style="line-height: 140%"> ack =</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Registry</span><span style="line-height: 140%">.CurrentUser.OpenSubKey(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">HostApplicationServices</span><span style="line-height: 140%">.Current.UserRegistryProductRootKey,</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">true</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; );</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> (ack)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">RegistryKey</span><span style="line-height: 140%"> mruk = ack.CreateSubKey(</span><span style="line-height: 140%; color: #a31515">&quot;Recent File List&quot;</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> (mruk)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">for</span><span style="line-height: 140%"> (</span><span style="line-height: 140%; color: blue">int</span><span style="line-height: 140%"> i = 1; i &lt;= 35; i++)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%"> file =</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%">)mruk.GetValue(</span><span style="line-height: 140%; color: #a31515">&quot;File&quot;</span><span style="line-height: 140%"> + i.ToString());</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (</span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%">.IsNullOrEmpty(file))</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">break</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">else</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (</span><span style="line-height: 140%; color: #2b91af">Path</span><span style="line-height: 140%">.GetExtension(file) == </span><span style="line-height: 140%; color: #a31515">&quot;.dwg&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%"> fileTime =</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%">)mruk.GetValue(</span><span style="line-height: 140%; color: #a31515">&quot;FileTime&quot;</span><span style="line-height: 140%"> + i.ToString());</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; files.Add(file + stringSep + fileTime);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> files.ToArray();</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">static</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">DateTime</span><span style="line-height: 140%"> UnixTimeStampToDateTime(</span><span style="line-height: 140%; color: blue">long</span><span style="line-height: 140%"> timeStamp)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// Unix timestamp is seconds past epoch </span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">DateTime</span><span style="line-height: 140%"> epoch = </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">DateTime</span><span style="line-height: 140%">(1970, 1, 1, 0, 0, 0, 0);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> epoch.AddSeconds(timeStamp).ToLocalTime();</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; [</span><span style="line-height: 140%; color: #2b91af">CommandMethod</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: #a31515">&quot;EMI&quot;</span><span style="line-height: 140%">)]</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> ExtractMruInformation()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%">[] files = GetMruFiles();</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">int</span><span style="line-height: 140%"> created = 0;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">StreamWriter</span><span style="line-height: 140%"> sw = </span><span style="line-height: 140%; color: #2b91af">File</span><span style="line-height: 140%">.CreateText(basePath + </span><span style="line-height: 140%; color: #a31515">&quot;mru.xml&quot;</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; sw.WriteLine(</span><span style="line-height: 140%; color: #a31515">&quot;&lt;MruFiles&gt;&quot;</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> (sw)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">for</span><span style="line-height: 140%"> (</span><span style="line-height: 140%; color: blue">int</span><span style="line-height: 140%"> i = 0; i &lt; files.Length; i++)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">int</span><span style="line-height: 140%"> sepLoc = files[i].IndexOf(stringSep);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%"> file = files[i].Substring(0, sepLoc);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%"> fileTime = files[i].Substring(sepLoc + 1);</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">DateTime</span><span style="line-height: 140%"> lastRead =</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; UnixTimeStampToDateTime(</span><span style="line-height: 140%; color: blue">long</span><span style="line-height: 140%">.Parse(fileTime));</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> (</span><span style="line-height: 140%; color: #2b91af">Database</span><span style="line-height: 140%"> db = </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Database</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: blue">false</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: blue">true</span><span style="line-height: 140%">))</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; db.ReadDwgFile(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; file, </span><span style="line-height: 140%; color: #2b91af">FileOpenMode</span><span style="line-height: 140%">.OpenForReadAndReadShare, </span><span style="line-height: 140%; color: blue">false</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; );</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Bitmap</span><span style="line-height: 140%"> thumb = db.ThumbnailBitmap;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (thumb != </span><span style="line-height: 140%; color: blue">null</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// Generate a filename and save the image to it</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%"> imageFile = </span><span style="line-height: 140%; color: #a31515">&quot;MruImage&quot;</span><span style="line-height: 140%"> + i.ToString() + </span><span style="line-height: 140%; color: #a31515">&quot;.png&quot;</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; thumb.Save(basePath + imageFile, </span><span style="line-height: 140%; color: #2b91af">ImageFormat</span><span style="line-height: 140%">.Png);</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// Get the time the drawing was last modified</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">DateTime</span><span style="line-height: 140%"> lastMod = </span><span style="line-height: 140%; color: #2b91af">File</span><span style="line-height: 140%">.GetLastAccessTime(file);</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// Get the base file name</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%"> baseName =</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Path</span><span style="line-height: 140%">.GetFileNameWithoutExtension(file);</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// Write a line of XML for each file</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; sw.WriteLine(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;&lt;MruFile Name=\&quot;{0}\&quot; &quot;</span><span style="line-height: 140%"> +</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;LastAccess=\&quot;{1}\&quot; &quot;</span><span style="line-height: 140%"> +</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;DayOfWeek=\&quot;{2}\&quot; &quot;</span><span style="line-height: 140%"> +</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;LastEdit=\&quot;{3}\&quot; &quot;</span><span style="line-height: 140%"> +</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;FilePath=\&quot;{4}\&quot; &quot;</span><span style="line-height: 140%"> +</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;ImageFile=\&quot;{5}\&quot; /&gt;&quot;</span><span style="line-height: 140%">,</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; baseName,</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; lastRead.ToShortDateString(),</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; lastRead.DayOfWeek,</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; lastMod.ToShortDateString(),</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; file,</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; imageFile</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; );</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// Make a local copy of the file</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">var</span><span style="line-height: 140%"> outPath = basePath + baseName + </span><span style="line-height: 140%; color: #a31515">&quot;.dwg&quot;</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (!file.StartsWith(</span><span style="line-height: 140%; color: #a31515">&quot;\\\\&quot;</span><span style="line-height: 140%">) &amp;&amp; !</span><span style="line-height: 140%; color: #2b91af">File</span><span style="line-height: 140%">.Exists(outPath))</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">File</span><span style="line-height: 140%">.Copy(file, outPath);</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// Increment our count to report at the end</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; created++;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; sw.WriteLine(</span><span style="line-height: 140%; color: #a31515">&quot;&lt;/MruFiles&gt;&quot;</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; sw.Close();</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Application</span><span style="line-height: 140%">.DocumentManager.MdiActiveDocument.Editor.</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; WriteMessage(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;\nExtracted thumbnails for {0} drawing{1}&quot;</span><span style="line-height: 140%"> +</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot; in the MRU list.&quot;</span><span style="line-height: 140%">,</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; created, created == 1 ? </span><span style="line-height: 140%; color: #a31515">&quot;&quot;</span><span style="line-height: 140%"> : </span><span style="line-height: 140%; color: #a31515">&quot;s&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; );</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">}</span></p> </div>  <p>This app can be loaded and run in full AutoCAD or the Core Console. Let’s see that inside the Core Console. We’ll use the NETLOAD command to load the DWG and then the EMI command to extract the various MRU data and place it under our Documents folder.</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2017d3de9ad56970c-pi" target="_blank"><img style="background-image: none; border-right-width: 0px; margin: 20px auto; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="MRU Extractor in the Core Console" border="0" alt="MRU Extractor in the Core Console" src="/assets/image_577976.jpg" width="434" height="234" /></a>We should now find the image files along with the XML “manifest” under <em>My Documents\MetroCAD</em>.</p>  <h3>Creating the Basic Browser</h3>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2017ee55eb57d970d-pi" target="_blank"><img style="background-image: none; border-right-width: 0px; margin: 0px 0px 10px 20px; padding-left: 0px; padding-right: 0px; display: inline; float: right; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="Grid View project template" border="0" alt="Grid View project template" align="right" src="/assets/image_738394.jpg" width="187" height="357" /></a>Now that we have the data we want to browse stored in a place that’s accessible to a WinRT, we can go ahead and create our basic browser.</p>  <p>Visual Studio 2012 provides some excellent foundational project templates for WinRT apps. The one that best fits our purposes is the Grid View template. We’re not going to go through the detailed process of adding all the functionality we need to this project, but we will be looking at areas of code that are implement various interesting capabilities.</p>  <p>If you really want to see all the differences in detail, you might create a basic Grid View app and then perform a “diff” with the files in the finished project.</p>  <p>The first “big ticket” item is to adjust the data-source for our items to reflect the data we want to store for each DWG. Then it’s clearly necessary to go ahead and adjust the XAML to bind to this data in various locations.</p>  <p>Now we’re going to take a look at various interesting features of Windows Store apps, to see how they can be implemented in our MRU browser app.</p>  <h3>Semantic Zoom</h3>  <p>Semantic zoom is an interesting capability for any app that’s display lots of data. It lets the user “zoom out” on the data, showing it at a lower level of detail. For instance, rather than having the items listed with larger icons and their title (which is already a level of detail less than the full item view) we can implement a view that just shows smaller thumbnails for all the DWGs accessed on a particular day.</p>  <p>Here’s the general, “zoomed in” view of our browser app:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2017d3de9add8970c-pi" target="_blank"><img style="background-image: none; border-right-width: 0px; margin: 20px auto; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="Our zoomed-in group view" border="0" alt="Our zoomed-in group view" src="/assets/image_266716.jpg" width="454" height="250" /></a></p>  <p>We can pinch-zoom to zoom out and get a different level of detail:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2017ee55eb60f970d-pi" target="_blank"><img style="background-image: none; border-right-width: 0px; margin: 20px auto; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="Our zoomed-out group view" border="0" alt="Our zoomed-out group view" src="/assets/image_644223.jpg" width="254" height="272" /></a></p>  <p>Some work is needed from the developer to support this view: they basically need to add a SemanticZoom element with ZoomedInView and ZoomedOutView sub-elements for the respective views.</p>  <p>The user can choose to display this view by simply pinch-zooming the display (or pressing the Ctrl key and using the mouse-wheel if relying on mouse and keyboard).</p>  <h3>Contracts</h3>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2017ee55eb64a970d-pi" target="_blank"><img style="background-image: none; border-right-width: 0px; margin: 0px 0px 10px 20px; padding-left: 0px; padding-right: 0px; display: inline; float: right; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="Charmed, I&#39;m sure" border="0" alt="Charmed, I&#39;m sure" align="right" src="/assets/image_53470.jpg" width="46" height="274" /></a>For an application to hook into the core Windows 8 UI at a user-level – allowing the user to interact with the application via the standard Windows 8 Charms – it can implement various “contracts”. We’ll now take a look at code to implement contracts for Share, Search and Settings.</p>  <p>Implementing a contract typically means registering an event-handler for core WinRT events. These events get fired by WinRT and allow your application to provide the appropriate behavior for the specific scenario.    <br />The application calls the static GetForCurrentView() method on the appropriate class and uses the returned object to register the event handler.</p>  <h4>Contracts – Share </h4>  <p>For instance, the contract for sharing – in the case of acting as a source for the sharing operation – requires handling of the DataTransferManager.DataRequested event. The application’s code then populates a DataTarget object with the data it wants to share.</p>  <p>You can share various types of data with other applications, but be warned: the standard Mail app – which is the one most commonly used to test out your application’s ability to act as a sharing source – doesn’t handle the title and subject information if attachments have been provided.</p>  <p>To more effectively test your app’s sharing capabilities, there are both source and target sample applications on MSDN that will prove more helpful:</p>  <p><a href="http://code.msdn.microsoft.com/Sharing-Content-Source-App-d9bffd84">http://code.msdn.microsoft.com/Sharing-Content-Source-App-d9bffd84</a>     <br /><a href="http://code.msdn.microsoft.com/Sharing-Content-Target-App-e2689782">http://code.msdn.microsoft.com/Sharing-Content-Target-App-e2689782</a></p>  <h4>Contracts – Search</h4>  <p>To implement the search contract, your app needs to implement a handler for the SearchPane.QuerySubmitted event. When the event is called, your code needs to generate a group of items that meet the search criteria.</p>  <p>Generating the group is straightforward with LINQ:</p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%; color: blue">var</span><span style="line-height: 140%"> query =</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">from</span><span style="line-height: 140%"> item </span><span style="line-height: 140%; color: blue">in</span><span style="line-height: 140%"> Items</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">where</span><span style="line-height: 140%"> item.Content.Contains(queryText)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">select</span><span style="line-height: 140%"> item;</span></p> </div>  <p>One thing to note about our implementation: we actually clone the items into the new group, as this makes it simpler to avoid issues related to items having links to their containing group.</p>  <p>Once we have the group we can simply navigate to it, causing it to be displayed in the UI.</p>  <h4>Contracts – Settings</h4>  <p>For an application to have its settings displayed via the Settings charm, it needs to implement the settings contract. It does this by responding to SettingsPane.CommandsRequested, registering its commands here to be integrated with the charms UI.</p>  <p>When the specific command-handler executes, it updates the application’s settings. If stored via the Application.Current.RoamingSettings object the settings will follow the user from device to device via their Live ID. Once the settings has been either retrieved or stored, the application can then adjust the UI to reflect the user’s intention.</p>  <h3>Live Tile Notifications</h3>  <p>An application’s Start screen tile is not only the way the user launches an application, it’s the window a user has into any activity that’s related to the application. Static tiles are just that – they don’t display updated information – but “live” tiles are more interesting: they display dynamic information that’s relevant to the app. </p>  <p>For instance, the Mail app’s live tile displays recent email messages the user has received. </p>  <p>Application developers have different formats available to them. Here are examples of the wide format – the tile on the left is static and just displays the app’s logo, the one on the right is dynamic and shows information about one of the recently opened DWG files:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2017c33bb1e01970b-pi" target="_blank"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: left; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="Wide, static tile" border="0" alt="Wide, static tile" align="left" src="/assets/image_925486.jpg" width="200" height="101" /></a></p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2017c33bb1e51970b-pi" target="_blank"><img style="background-image: none; border-right-width: 0px; margin: 0px 0px 0px 40px; padding-left: 0px; padding-right: 0px; display: inline; float: left; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="Wide, live tile" border="0" alt="Wide, live tile" align="left" src="/assets/image_382098.jpg" width="200" height="101" /></a></p>  <p>&#160;</p>  <p>&#160;</p>  <p>&#160;</p>  <p>&#160;</p>  <p>If the developer has chosen a wide format for their application’s tile, the user can still choose to shrink it to be square:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2017d3de9aec3970c-pi" target="_blank"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: left; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="Square, static tile" border="0" alt="Square, static tile" align="left" src="/assets/image_512469.jpg" width="103" height="101" /></a></p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2017ee55eb743970d-pi" target="_blank"><img style="background-image: none; border-right-width: 0px; margin: 0px 0px 0px 50px; padding-left: 0px; padding-right: 0px; display: inline; float: left; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="Square, live tile" border="0" alt="Square, live tile" align="left" src="/assets/image_137959.jpg" width="103" height="101" /></a></p>  <p>&#160;</p>  <p>&#160;</p>  <p>&#160;</p>  <p>&#160;</p>  <p>The specific notifications that get presented to the user are managed via Windows.UI.Notification.TileUpdateManager. Up to 5 notifications can be displayed to the user in a rotating queue.</p>  <h3>Snapping</h3>  <p>One interesting capability of Windows Store apps is that they can dock: something that’s especially useful considering their otherwise full-screen nature. And for companion apps it can prove to be even more important, as they can dock to the side of the desktop.</p>  <p>A snapped app has up to 320 pixels wide of screen real estate available to it. Within this area it can show the view it feels appropriate, whether a single item or a group of them.</p>  <p>The implementation of snapping occurs in XAML (for a C#/VB/C++ app) or HTML (for a JavaScript app). There’s a particular VisualStyle with the “Snapped” name, and this controls the animation of the UI to the snapped state.</p>  <h3>Launching</h3>  <p>One feature that’s of great interest to companion apps is launching. Applications can launch the desktop application associated with a particular file-type via a file that the app can access. Which means it needs to be in a known folder the app can access and using a file-type that the app has an association with.</p>  <p>Here’s some code that will launch AutoCAD for a DWG file found in the current user’s Documents folder:</p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%; color: blue">var</span><span style="line-height: 140%"> file = </span><span style="line-height: 140%; color: blue">await</span><span style="line-height: 140%"> <font color="#4bacc6">KnownFolders</font>.DocumentsLibrary.GetFileAsync(</span><span style="line-height: 140%; color: #a31515">&quot;A.dwg&quot;</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">await</span><span style="line-height: 140%"> <font color="#4bacc6">Launcher</font>.LaunchFileAsync(file);</span></p> </div>  <p>For our browser app we will perform this when an item is double-clicked. The standalone MRU extractor copies the DWG files into a specific location inside the Documents folder, so when we launch we’re not actually editing the original document (something that could be considered a significant limitation). If all DWG files are stored beneath the Documents folder then this limitation could presumably be lifted with modest coding effort.</p>  <h3>Summary</h3>  <p>WinRT is a brave departure – and a big risk – from Microsoft. They are maintaining the ability for legacy apps to be used on the new OS – at least when installed on a device powered by an Intel chip – but presenting a brand new application model that risks confusing users as well as bringing some pain to application developers.</p>  <p>The restrictions imposed by the WinRT programming model are for the best of reasons: to increase trust and improve the control users have over application functionality, but it remains to be seen whether these restrictions in some way limit the generation of usable Windows Store applications: it’s far from the case that existing apps of any complexity will be ported across to WinRT with ease (and it’s not Microsoft’s expectation that this will happen: presumably they would be happy if application developers in significant numbers invested in creating the next generation Windows experience using WinRT).</p>  <p>There does appear to be an interesting possibility for developers of heavyweight desktop apps to create companion apps that can be installed from the Windows Store and connect in some way to the desktop environment.</p>  <p>WinRT apps have some interesting UI capabilities that we saw in this session:</p>  <ul>   <li>Semantic Zoom, allowing different levels of detail in summarizing items </li>    <li>Contracts enabling apps to integrate with the Search, Share and Settings charms </li>    <li>Live tile notifications, allowing apps to present information to users via the Start screen </li>    <li>Snapping, allowing apps to dock with other apps </li>    <li>Launching of desktop apps associated with a particular file-type </li> </ul>  <h3>Blog References</h3>  <p><a href="http://through-the-interface.typepad.com/through_the_interface/2012/03/attended-the-windows-8-techconference.html">Attended the Windows 8 TechConference</a></p>  <p><a href="http://through-the-interface.typepad.com/through_the_interface/2012/03/a-simple-mru-browser-for-autocad-data-using-winrt.html">A simple MRU browser for AutoCAD data using WinRT</a> </p>  <p><a href="http://through-the-interface.typepad.com/through_the_interface/2012/03/implementing-contracts-in-the-autocad-mru-browser-using-winrt.html">Implementing contracts in the AutoCAD MRU browser using WinRT</a> </p>  <p><a href="http://through-the-interface.typepad.com/through_the_interface/2012/04/adding-snapping-to-the-autocad-mru-browser-using-winrt.html">Adding snapping to the AutoCAD MRU browser using WinRT</a></p>
