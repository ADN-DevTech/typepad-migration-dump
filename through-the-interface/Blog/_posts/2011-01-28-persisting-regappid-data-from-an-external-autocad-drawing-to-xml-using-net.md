---
layout: "post"
title: "Persisting RegAppId data from an external AutoCAD drawing to XML using .NET"
date: "2011-01-28 11:21:38"
author: "Kean Walmsley"
categories:
  - "AutoCAD"
  - "AutoCAD .NET"
  - "Batch processing"
  - "Drawing structure"
  - "XML"
original_url: "https://www.keanw.com/2011/01/persisting-regappid-data-from-an-external-autocad-drawing-to-xml-using-net.html "
typepad_basename: "persisting-regappid-data-from-an-external-autocad-drawing-to-xml-using-net"
typepad_status: "Publish"
---

<p>This post takes the code from <a href="http://through-the-interface.typepad.com/through_the_interface/2011/01/counting-the-regappids-for-a-specific-autocad-drawing-and-its-external-references-using-net.html" target="_blank">the last post</a> and extends it to serialize the collected RegAppId data to an XML file, as per Step 3 below:</p>  <ol>   <li>Implement a command to collect RegAppId information for the active document </li>    <li>Extend this command to work on a drawing not loaded in the editor </li>    <li>Save our RegAppId information to some persistent location (XML) </li>    <li>Create a modified version of ScriptPro 2.0 (one of our <a href="http://labs.autodesk.com/utilities/ADN_plugins" target="_blank">Plugins of the Month</a>) to call our command without opening the drawing </li> </ol>  <p>I’ve chosen once again to leverage the very handy XmlSerializer class to handle serialization to and from XML: all we have to do is get our data in a data structure with appropriate metadata and the rest is taken care of by .NET. More or less, anyway. :-)</p>  <p>Here’s the updated code, with the new/modified lines in <font color="#ff0000">red</font> (and here’s <a href="http://through-the-interface.typepad.com/files/recurse-xrefs-external-xml.cs" target="_blank">the updated source file</a>):</p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160;&#160; 1</span>&#160;<span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.ApplicationServices;</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160;&#160; 2</span>&#160;<span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.DatabaseServices;</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160;&#160; 3</span>&#160;<span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.EditorInput;</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160;&#160; 4</span>&#160;<span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.Runtime;</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160;&#160; 5</span>&#160;<span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> System.Collections.Generic;</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160;&#160; 6</span>&#160;<span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> System.Text;</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160;&#160; 7</span>&#160;<span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> System.Xml;</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160;&#160; 8</span>&#160;<span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> System.Xml.Serialization;</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160;&#160; 9</span>&#160;<span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> System.IO;</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 10</span>&#160;<span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> System;</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 11</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 12</span>&#160;<span style="line-height: 140%; color: blue">namespace</span><span style="line-height: 140%"> XrefRegApps</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 13</span>&#160;<span style="line-height: 140%">{</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 14</span>&#160;<span style="line-height: 140%">&#160; [</span><span style="line-height: 140%; color: #2b91af">XmlRoot</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: #a31515">&quot;RegAppData&quot;</span><span style="line-height: 140%">)]</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 15</span>&#160;<span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">class</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">RegAppData</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 16</span>&#160;<span style="line-height: 140%">&#160; {</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 17</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// The name of our drawing</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 18</span>&#160;</p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 19</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%"> _name;</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 20</span>&#160;</p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 21</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; [</span><span style="line-height: 140%; color: #2b91af">XmlAttribute</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: #a31515">&quot;Name&quot;</span><span style="line-height: 140%">)]</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 22</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%"> Name</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 23</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 24</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">get</span><span style="line-height: 140%"> { </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> _name; }</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 25</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">set</span><span style="line-height: 140%"> { _name = </span><span style="line-height: 140%; color: blue">value</span><span style="line-height: 140%">; }</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 26</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 27</span>&#160;</p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 28</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// The location of our drawing</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 29</span>&#160;</p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 30</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%"> _dwg;</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 31</span>&#160;</p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 32</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; [</span><span style="line-height: 140%; color: #2b91af">XmlAttribute</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: #a31515">&quot;File&quot;</span><span style="line-height: 140%">)]</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 33</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%"> File</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 34</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 35</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">get</span><span style="line-height: 140%"> { </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> _dwg; }</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 36</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">set</span><span style="line-height: 140%"> { _dwg = </span><span style="line-height: 140%; color: blue">value</span><span style="line-height: 140%">; }</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 37</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 38</span>&#160;</p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 39</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// The list of our drawing's Registered Application IDs</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 40</span>&#160;</p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 41</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">List</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%">&gt; _regAppIds = </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">List</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%">&gt;();</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 42</span>&#160;</p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 43</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; [</span><span style="line-height: 140%; color: #2b91af">XmlAttribute</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: #a31515">&quot;RegAppIds&quot;</span><span style="line-height: 140%">)]</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 44</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">List</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%">&gt; RegAppIds</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 45</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 46</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">get</span><span style="line-height: 140%"> { </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> _regAppIds; }</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 47</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">set</span><span style="line-height: 140%"> { _regAppIds = </span><span style="line-height: 140%; color: blue">value</span><span style="line-height: 140%">; }</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 48</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 49</span>&#160;</p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 50</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> AddRegAppId(</span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%"> id)</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 51</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 52</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (!_regAppIds.Contains(id))</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 53</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; _regAppIds.Add(id);</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 54</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 55</span>&#160;<span style="line-height: 140%">&#160; }</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 56</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 57</span>&#160;<span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">class</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Commands</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160;&#160; 58</span>&#160;<span style="line-height: 140%">&#160; {</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 59</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">const</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%"> regAppDataXml = </span><span style="line-height: 140%; color: #a31515">&quot;RegAppData.xml&quot;</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 60</span>&#160;</p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 61</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> SerializeRegAppData(</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 62</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Dictionary</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #2b91af">RegAppData</span><span style="line-height: 140%">&gt; dict</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 63</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; )</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 64</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 65</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (dict.Count &gt; 0)</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 66</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 67</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// No direct way to serialize a dictionary to XML,</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 68</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// so we'll create a list from it and serialize that</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 69</span>&#160;</p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 70</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">List</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: #2b91af">RegAppData</span><span style="line-height: 140%">&gt; regData =</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 71</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">List</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: #2b91af">RegAppData</span><span style="line-height: 140%">&gt;(dict.Count);</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 72</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">foreach</span><span style="line-height: 140%"> (</span><span style="line-height: 140%; color: #2b91af">KeyValuePair</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #2b91af">RegAppData</span><span style="line-height: 140%">&gt; kv </span><span style="line-height: 140%; color: blue">in</span><span style="line-height: 140%"> dict)</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 73</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 74</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; regData.Add(kv.Value);</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 75</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 76</span>&#160;</p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 77</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// Serialize our list to the specified XML file</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 78</span>&#160;</p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 79</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">XmlSerializer</span><span style="line-height: 140%"> xs =</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 80</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">XmlSerializer</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: blue">typeof</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: #2b91af">List</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: #2b91af">RegAppData</span><span style="line-height: 140%">&gt;));</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 81</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">XmlTextWriter</span><span style="line-height: 140%"> xw =</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 82</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">XmlTextWriter</span><span style="line-height: 140%">(regAppDataXml, </span><span style="line-height: 140%; color: #2b91af">Encoding</span><span style="line-height: 140%">.UTF8);</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 83</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; xs.Serialize(xw, regData);</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 84</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; xw.Close();</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 85</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 86</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 87</span>&#160;</p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 88</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// Read and return the previous Registered Application data</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 89</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// from our stored XML file</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 90</span>&#160;</p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 91</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Dictionary</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #2b91af">RegAppData</span><span style="line-height: 140%">&gt;</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 92</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; DeserializeRegAppData()</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 93</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 94</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (</span><span style="line-height: 140%; color: #2b91af">File</span><span style="line-height: 140%">.Exists(regAppDataXml))</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 95</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 96</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">XmlSerializer</span><span style="line-height: 140%"> xs =</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 97</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">XmlSerializer</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: blue">typeof</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: #2b91af">List</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: #2b91af">RegAppData</span><span style="line-height: 140%">&gt;));</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 98</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">XmlTextReader</span><span style="line-height: 140%"> xr = </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">XmlTextReader</span><span style="line-height: 140%">(regAppDataXml);</span></p>    <p style="margin: 0px"><span style="color: red">&#160;&#160; 99</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (xs.CanDeserialize(xr))</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 100</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 101</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// No direct way to serialize a dictionary to XML,</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 102</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// so we'll read a list and populate a dictionary</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 103</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// from it</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 104</span>&#160;</p>    <p style="margin: 0px"><span style="color: red">&#160; 105</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">List</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: #2b91af">RegAppData</span><span style="line-height: 140%">&gt; regData =</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 106</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: #2b91af">List</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: #2b91af">RegAppData</span><span style="line-height: 140%">&gt;)xs.Deserialize(xr);</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 107</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; xr.Close();</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 108</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Dictionary</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #2b91af">RegAppData</span><span style="line-height: 140%">&gt; dict =</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 109</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Dictionary</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #2b91af">RegAppData</span><span style="line-height: 140%">&gt;();</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 110</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">foreach</span><span style="line-height: 140%"> (</span><span style="line-height: 140%; color: #2b91af">RegAppData</span><span style="line-height: 140%"> rad </span><span style="line-height: 140%; color: blue">in</span><span style="line-height: 140%"> regData)</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 111</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 112</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; dict.Add(rad.File, rad);</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 113</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 114</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> dict;</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 115</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 116</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 117</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Dictionary</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #2b91af">RegAppData</span><span style="line-height: 140%">&gt;();</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 118</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 119</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 120</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; [</span><span style="line-height: 140%; color: #2b91af">CommandMethod</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: #a31515">&quot;XRA&quot;</span><span style="line-height: 140%">)]</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 121</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> ExternalReferenceRegisteredApps()</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 122</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 123</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Document</span><span style="line-height: 140%"> doc =</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 124</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Application</span><span style="line-height: 140%">.DocumentManager.MdiActiveDocument;</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 125</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Database</span><span style="line-height: 140%"> db = doc.Database;</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 126</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Editor</span><span style="line-height: 140%"> ed = doc.Editor;</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 127</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 128</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// Prompt the user for the path to a DWG to test</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 129</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 130</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">PromptStringOptions</span><span style="line-height: 140%"> pso =</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 131</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">PromptStringOptions</span><span style="line-height: 140%">(</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 132</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;\nEnter path to root drawing file: &quot;</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 133</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; );</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 134</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; pso.AllowSpaces = </span><span style="line-height: 140%; color: blue">true</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 135</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">PromptResult</span><span style="line-height: 140%"> pr = ed.GetString(pso);</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 136</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (pr.Status != </span><span style="line-height: 140%; color: #2b91af">PromptStatus</span><span style="line-height: 140%">.OK)</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 137</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 138</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 139</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (!</span><span style="line-height: 140%; color: #2b91af">File</span><span style="line-height: 140%">.Exists(pr.StringResult))</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 140</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 141</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</span><span style="line-height: 140%; color: #a31515">&quot;\nFile does not exist.&quot;</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 142</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 143</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 144</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 145</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">try</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 146</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 147</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// We start by reading any existing RegApp data</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 148</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// from XML</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 149</span>&#160;</p>    <p style="margin: 0px"><span style="color: red">&#160; 150</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Dictionary</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #2b91af">RegAppData</span><span style="line-height: 140%">&gt; regData =</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 151</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; DeserializeRegAppData();</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 152</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 153</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// Load the DWG into a side database</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 154</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 155</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Database</span><span style="line-height: 140%"> mainDb = </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Database</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: blue">false</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: blue">true</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 156</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> (mainDb)</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 157</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 158</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; mainDb.ReadDwgFile(</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 159</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; pr.StringResult,</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 160</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">FileOpenMode</span><span style="line-height: 140%">.OpenForReadAndAllShare,</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 161</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">true</span><span style="line-height: 140%">,</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 162</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">null</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 163</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; );</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 164</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 165</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// We need an additional step to resolve Xrefs</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 166</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 167</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; mainDb.ResolveXrefs(</span><span style="line-height: 140%; color: blue">false</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: blue">false</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 168</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 169</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// Get the XrefGraph for the specified database</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 170</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 171</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">XrefGraph</span><span style="line-height: 140%"> xg = mainDb.GetHostDwgXrefGraph(</span><span style="line-height: 140%; color: blue">true</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 172</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 173</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// Loop through the nodes in the graph</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 174</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 175</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">for</span><span style="line-height: 140%"> (</span><span style="line-height: 140%; color: blue">int</span><span style="line-height: 140%"> i = 0; i &lt; xg.NumNodes; i++)</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 176</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 177</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// Get each node and check its status</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 178</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 179</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">XrefGraphNode</span><span style="line-height: 140%"> xgn = xg.GetXrefNode(i);</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 180</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 181</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">switch</span><span style="line-height: 140%"> (xgn.XrefStatus)</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 182</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 183</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// If Un*, print a message</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 184</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 185</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">case</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">XrefStatus</span><span style="line-height: 140%">.Unresolved:</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 186</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 187</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;\nUnresolved xref \&quot;{0}\&quot;&quot;</span><span style="line-height: 140%">, xgn.Name</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 188</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; );</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 189</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">break</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 190</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">case</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">XrefStatus</span><span style="line-height: 140%">.Unloaded:</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 191</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 192</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;\nUnloaded xref \&quot;{0}\&quot;&quot;</span><span style="line-height: 140%">, xgn.Name</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 193</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; );</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 194</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">break</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 195</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">case</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">XrefStatus</span><span style="line-height: 140%">.Unreferenced:</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 196</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 197</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;\nUnreferenced xref \&quot;{0}\&quot;&quot;</span><span style="line-height: 140%">, xgn.Name</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 198</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; );</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 199</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">break</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 200</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">case</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">XrefStatus</span><span style="line-height: 140%">.Resolved:</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 201</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 202</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// If Resolved, get the RegAppTable</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 203</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 204</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Database</span><span style="line-height: 140%"> xdb = xgn.Database;</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 205</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (xdb != </span><span style="line-height: 140%; color: blue">null</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 206</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 207</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Transaction</span><span style="line-height: 140%"> tr =</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 208</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; xdb.TransactionManager.StartTransaction();</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 209</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> (tr)</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 210</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 211</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">RegAppTable</span><span style="line-height: 140%"> rat =</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 212</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: #2b91af">RegAppTable</span><span style="line-height: 140%">)tr.GetObject(</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 213</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; xdb.RegAppTableId,</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 214</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">OpenMode</span><span style="line-height: 140%">.ForRead</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 215</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; );</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 216</span>&#160;</p>    <p style="margin: 0px"><span style="color: red">&#160; 217</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// We'll store our RegApp data in an</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 218</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// object</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 219</span>&#160;</p>    <p style="margin: 0px"><span style="color: red">&#160; 220</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">RegAppData</span><span style="line-height: 140%"> dwgData = </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">RegAppData</span><span style="line-height: 140%">();</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 221</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; dwgData.Name =</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 222</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (i == 0 ?</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 223</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Path</span><span style="line-height: 140%">.GetFileNameWithoutExtension(</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 224</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; xgn.Name</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 225</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ) :</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 226</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; xgn.Name</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 227</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; );</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 228</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; dwgData.File = xdb.Filename;</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 229</span>&#160;</p>    <p style="margin: 0px"><span style="color: red">&#160; 230</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// Collect the contained names of the</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 231</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// RegAppTableRecords (the RegAppIds)</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 232</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// in a list</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 233</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 234</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">foreach</span><span style="line-height: 140%"> (</span><span style="line-height: 140%; color: #2b91af">ObjectId</span><span style="line-height: 140%"> id </span><span style="line-height: 140%; color: blue">in</span><span style="line-height: 140%"> rat)</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 235</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 236</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">RegAppTableRecord</span><span style="line-height: 140%"> ratr =</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 237</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: #2b91af">RegAppTableRecord</span><span style="line-height: 140%">)tr.GetObject(</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 238</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; id,</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 239</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">OpenMode</span><span style="line-height: 140%">.ForRead</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 240</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; );</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 241</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; dwgData.AddRegAppId(ratr.Name);</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 242</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 243</span>&#160;</p>    <p style="margin: 0px"><span style="color: red">&#160; 244</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// Store the object in our dictionary,</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 245</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// replacing any existing item</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 246</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// (keyed off the entire DWG path, not</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 247</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// just the name)</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 248</span>&#160;</p>    <p style="margin: 0px"><span style="color: red">&#160; 249</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (regData.ContainsKey(dwgData.File))</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 250</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; regData.Remove(dwgData.File);</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 251</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; regData.Add(dwgData.File, dwgData);</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 252</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 253</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// Print the drawing information</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 254</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// and the RegAppId count</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 255</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 256</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 257</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;\nDrawing \&quot;{0}\&quot; (\&quot;{1}\&quot;) with &quot;</span><span style="line-height: 140%"> +</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 258</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;{2} RegAppIds&quot;</span><span style="line-height: 140%">,</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 259</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; dwgData.Name,</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 260</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; dwgData.File,</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 261</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; dwgData.RegAppIds.Count</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 262</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; );</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 263</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 264</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// Even if only reading, commit the</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 265</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// transaction (it's cheaper than</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 266</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// aborting)</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 267</span>&#160;</p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 268</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; tr.Commit();</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 269</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 270</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 271</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">break</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 272</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 273</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 274</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 275</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// Save our data to XML</span></p>    <p style="margin: 0px"><span style="color: red">&#160; 276</span>&#160;</p>    <p style="margin: 0px"><span style="color: red">&#160; 277</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; SerializeRegAppData(regData);</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 278</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 279</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 280</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">catch</span><span style="line-height: 140%"> (System.</span><span style="line-height: 140%; color: #2b91af">Exception</span><span style="line-height: 140%"> ex)</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 281</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 282</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 283</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;\nProblem reading/processing \&quot;{0}\&quot;: {1}&quot;</span><span style="line-height: 140%">,</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 284</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; pr.StringResult, ex.Message</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 285</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; );</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 286</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 287</span>&#160;<span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 288</span>&#160;<span style="line-height: 140%">&#160; }</span></p>    <p style="margin: 0px"><span style="color: #2b91af">&#160; 289</span>&#160;<span style="line-height: 140%">}</span></p> </div> <!--EndFragment-->  <p>When we first run the XRA command with our Civil sample file, we see the contents of the XML file (which seems to be written to the current directory – we could easily hardcode another location, of course) are:</p>  <div class="e"><span class="b"><strong><font color="#ff0000" face="Courier New">&#160;</font></strong></span> <font color="#0000ff"><span class="m">&lt;?</span><span class="pi">xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; </span><span class="m">?&gt;</span></font> </div>  <div class="e">   <div style="text-indent: -2em; margin-left: 1em" class="c"><a class="b" onfocus="h()" onclick="return false" href="http://through-the-interface.typepad.com/#"><strong><font color="#ff0000" face="Courier New">-</font></strong></a> <span class="m"><font color="#0000ff">&lt;</font></span><span class="t"><font color="#990000">ArrayOfRegAppData</font></span><span class="ns"><font color="#ff0000"> xmlns:xsi</font></span><span class="m"><font color="#0000ff">=&quot;</font></span><b class="ns"><font color="#ff0000">http://www.w3.org/2001/XMLSchema-instance</font></b><span class="m"><font color="#0000ff">&quot;</font></span><span class="ns"><font color="#ff0000"> xmlns:xsd</font></span><span class="m"><font color="#0000ff">=&quot;</font></span><b class="ns"><font color="#ff0000">http://www.w3.org/2001/XMLSchema</font></b><font color="#0000ff"><span class="m">&quot;</span><span class="m">&gt;</span></font></div>    <div>     <div class="e">       <div style="text-indent: -2em; margin-left: 1em"><span class="b"><strong><font color="#ff0000" face="Courier New">&#160;</font></strong></span> <span class="m"><font color="#0000ff">&lt;</font></span><span class="t"><font color="#990000">RegAppData</font></span> <span class="t"><font color="#990000">Name</font></span><span class="m"><font color="#0000ff">=&quot;</font></span><b>Master Site Plan</b><span class="m"><font color="#0000ff">&quot;</font></span><span class="t"><font color="#990000"> File</font></span><span class="m"><font color="#0000ff">=&quot;</font></span><b>C:\Program Files\Autodesk\AutoCAD 2011\Sample\Sheet Sets\Civil\Master Site Plan.dwg</b><span class="m"><font color="#0000ff">&quot;</font></span><span class="t"><font color="#990000"> RegAppIds</font></span><span class="m"><font color="#0000ff">=&quot;</font></span><b>ACAD RAK DCA_FIGURE_XENT ADE ALIGNMENT_DB_APP SDI_PROFILE SDSK_POINT SVPLINE ADCADD_ZZ SDSK_PMN CIVIL_DRAFT CIVIL_LINE_TABLE CIVIL_CURVE_TABLE CIVIL_SPIRAL_TABLE SDI_XSECTIONS ACAD_PSEXT ACAD_MLEADERVER DCO15</b><font color="#0000ff"><span class="m">&quot;</span><span class="m"> /&gt;</span></font> </div>     </div>      <div class="e">       <div style="text-indent: -2em; margin-left: 1em"><span class="b"><strong><font color="#ff0000" face="Courier New">&#160;</font></strong></span> <span class="m"><font color="#0000ff">&lt;</font></span><span class="t"><font color="#990000">RegAppData</font></span> <span class="t"><font color="#990000">Name</font></span><span class="m"><font color="#0000ff">=&quot;</font></span><b>PB-BASE</b><span class="m"><font color="#0000ff">&quot;</font></span><span class="t"><font color="#990000"> File</font></span><span class="m"><font color="#0000ff">=&quot;</font></span><b>C:\Program Files\Autodesk\AutoCAD 2011\Sample\Sheet Sets\Civil\PB-BASE.dwg</b><span class="m"><font color="#0000ff">&quot;</font></span><span class="t"><font color="#990000"> RegAppIds</font></span><span class="m"><font color="#0000ff">=&quot;</font></span><b>ACAD RAK DCA_FIGURE_XENT ALIGNMENT_DB_APP SDI_PROFILE ACAD_PSEXT ACAD_MLEADERVER</b><font color="#0000ff"><span class="m">&quot;</span><span class="m"> /&gt;</span></font> </div>     </div>      <div class="e">       <div style="text-indent: -2em; margin-left: 1em"><span class="b"><strong><font color="#ff0000" face="Courier New">&#160;</font></strong></span> <span class="m"><font color="#0000ff">&lt;</font></span><span class="t"><font color="#990000">RegAppData</font></span> <span class="t"><font color="#990000">Name</font></span><span class="m"><font color="#0000ff">=&quot;</font></span><b>PB-EX41</b><span class="m"><font color="#0000ff">&quot;</font></span><span class="t"><font color="#990000"> File</font></span><span class="m"><font color="#0000ff">=&quot;</font></span><b>C:\Program Files\Autodesk\AutoCAD 2011\Sample\Sheet Sets\Civil\PB-EX41.dwg</b><span class="m"><font color="#0000ff">&quot;</font></span><span class="t"><font color="#990000"> RegAppIds</font></span><span class="m"><font color="#0000ff">=&quot;</font></span><b>ACAD SDSK_POINT SVPLINE ACAD_PSEXT DCO15 ACAD_MLEADERVER</b><font color="#0000ff"><span class="m">&quot;</span><span class="m"> /&gt;</span></font> </div>     </div>      <div class="e">       <div style="text-indent: -2em; margin-left: 1em"><span class="b"><strong><font color="#ff0000" face="Courier New">&#160;</font></strong></span> <span class="m"><font color="#0000ff">&lt;</font></span><span class="t"><font color="#990000">RegAppData</font></span> <span class="t"><font color="#990000">Name</font></span><span class="m"><font color="#0000ff">=&quot;</font></span><b>PB-EX61</b><span class="m"><font color="#0000ff">&quot;</font></span><span class="t"><font color="#990000"> File</font></span><span class="m"><font color="#0000ff">=&quot;</font></span><b>C:\Program Files\Autodesk\AutoCAD 2011\Sample\Sheet Sets\Civil\PB-EX61.dwg</b><span class="m"><font color="#0000ff">&quot;</font></span><span class="t"><font color="#990000"> RegAppIds</font></span><span class="m"><font color="#0000ff">=&quot;</font></span><b>ACAD SVPLINE ACAD_PSEXT DCO15 ACAD_MLEADERVER</b><font color="#0000ff"><span class="m">&quot;</span><span class="m"> /&gt;</span></font> </div>     </div>      <div><span class="b"><strong><font color="#ff0000" face="Courier New">&#160;</font></strong></span> <span class="m"><font color="#0000ff">&lt;/</font></span><span class="t"><font color="#990000">ArrayOfRegAppData</font></span><span class="m"><font color="#0000ff">&gt;</font></span></div>   </div> </div>  <p>if we run the XRA command again, this time specifying a file from the Architectural sample:</p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%">Command: <font color="#ff0000">XRA</font></span></p>    <p style="margin: 0px"><span style="line-height: 140%">Enter path to root drawing file: <font color="#ff0000">C:\Program Files\Autodesk\AutoCAD 2011\Sample\Sheet Sets\Architectural\A-01.dwg</font></span></p>    <p style="margin: 0px"><span style="line-height: 140%">Drawing &quot;A-01&quot; (&quot;C:\Program Files\Autodesk\AutoCAD 2011\Sample\Sheet Sets\Architectural\A-01.dwg&quot;) with 21 RegAppIds</span></p>    <p style="margin: 0px"><span style="line-height: 140%">Drawing &quot;Grid Plan&quot; (&quot;C:\Program Files\Autodesk\AutoCAD 2011\Sample\Sheet Sets\Architectural\Res\Grid Plan.dwg&quot;) with 7 RegAppIds</span></p>    <p style="margin: 0px"><span style="line-height: 140%">Drawing &quot;Wall Base&quot; (&quot;C:\Program Files\Autodesk\AutoCAD 2011\Sample\Sheet Sets\Architectural\Res\Wall Base.dwg&quot;) with 11 RegAppIds</span></p> </div> <!--EndFragment-->  <p>We will see the XML now contains additional entries:</p>  <div class="e"><span class="b"><strong><font color="#ff0000" face="Courier New">&#160;</font></strong></span> <font color="#0000ff"><span class="m">&lt;?</span><span class="pi">xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; </span><span class="m">?&gt;</span></font> </div>  <div class="e">   <div style="text-indent: -2em; margin-left: 1em" class="c"><a class="b" onfocus="h()" onclick="return false" href="http://through-the-interface.typepad.com/#"><strong><font color="#ff0000" face="Courier New">-</font></strong></a> <span class="m"><font color="#0000ff">&lt;</font></span><span class="t"><font color="#990000">ArrayOfRegAppData</font></span><span class="ns"><font color="#ff0000"> xmlns:xsi</font></span><span class="m"><font color="#0000ff">=&quot;</font></span><b class="ns"><font color="#ff0000">http://www.w3.org/2001/XMLSchema-instance</font></b><span class="m"><font color="#0000ff">&quot;</font></span><span class="ns"><font color="#ff0000"> xmlns:xsd</font></span><span class="m"><font color="#0000ff">=&quot;</font></span><b class="ns"><font color="#ff0000">http://www.w3.org/2001/XMLSchema</font></b><font color="#0000ff"><span class="m">&quot;</span><span class="m">&gt;</span></font></div>    <div>     <div class="e">       <div style="text-indent: -2em; margin-left: 1em"><span class="b"><strong><font color="#ff0000" face="Courier New">&#160;</font></strong></span> <span class="m"><font color="#0000ff">&lt;</font></span><span class="t"><font color="#990000">RegAppData</font></span> <span class="t"><font color="#990000">Name</font></span><span class="m"><font color="#0000ff">=&quot;</font></span><b>Master Site Plan</b><span class="m"><font color="#0000ff">&quot;</font></span><span class="t"><font color="#990000"> File</font></span><span class="m"><font color="#0000ff">=&quot;</font></span><b>C:\Program Files\Autodesk\AutoCAD 2011\Sample\Sheet Sets\Civil\Master Site Plan.dwg</b><span class="m"><font color="#0000ff">&quot;</font></span><span class="t"><font color="#990000"> RegAppIds</font></span><span class="m"><font color="#0000ff">=&quot;</font></span><b>ACAD RAK DCA_FIGURE_XENT ADE ALIGNMENT_DB_APP SDI_PROFILE SDSK_POINT SVPLINE ADCADD_ZZ SDSK_PMN CIVIL_DRAFT CIVIL_LINE_TABLE CIVIL_CURVE_TABLE CIVIL_SPIRAL_TABLE SDI_XSECTIONS ACAD_PSEXT ACAD_MLEADERVER DCO15</b><font color="#0000ff"><span class="m">&quot;</span><span class="m"> /&gt;</span></font> </div>     </div>      <div class="e">       <div style="text-indent: -2em; margin-left: 1em"><span class="b"><strong><font color="#ff0000" face="Courier New">&#160;</font></strong></span> <span class="m"><font color="#0000ff">&lt;</font></span><span class="t"><font color="#990000">RegAppData</font></span> <span class="t"><font color="#990000">Name</font></span><span class="m"><font color="#0000ff">=&quot;</font></span><b>PB-BASE</b><span class="m"><font color="#0000ff">&quot;</font></span><span class="t"><font color="#990000"> File</font></span><span class="m"><font color="#0000ff">=&quot;</font></span><b>C:\Program Files\Autodesk\AutoCAD 2011\Sample\Sheet Sets\Civil\PB-BASE.dwg</b><span class="m"><font color="#0000ff">&quot;</font></span><span class="t"><font color="#990000"> RegAppIds</font></span><span class="m"><font color="#0000ff">=&quot;</font></span><b>ACAD RAK DCA_FIGURE_XENT ALIGNMENT_DB_APP SDI_PROFILE ACAD_PSEXT ACAD_MLEADERVER</b><font color="#0000ff"><span class="m">&quot;</span><span class="m"> /&gt;</span></font> </div>     </div>      <div class="e">       <div style="text-indent: -2em; margin-left: 1em"><span class="b"><strong><font color="#ff0000" face="Courier New">&#160;</font></strong></span> <span class="m"><font color="#0000ff">&lt;</font></span><span class="t"><font color="#990000">RegAppData</font></span> <span class="t"><font color="#990000">Name</font></span><span class="m"><font color="#0000ff">=&quot;</font></span><b>PB-EX41</b><span class="m"><font color="#0000ff">&quot;</font></span><span class="t"><font color="#990000"> File</font></span><span class="m"><font color="#0000ff">=&quot;</font></span><b>C:\Program Files\Autodesk\AutoCAD 2011\Sample\Sheet Sets\Civil\PB-EX41.dwg</b><span class="m"><font color="#0000ff">&quot;</font></span><span class="t"><font color="#990000"> RegAppIds</font></span><span class="m"><font color="#0000ff">=&quot;</font></span><b>ACAD SDSK_POINT SVPLINE ACAD_PSEXT DCO15 ACAD_MLEADERVER</b><font color="#0000ff"><span class="m">&quot;</span><span class="m"> /&gt;</span></font> </div>     </div>      <div class="e">       <div style="text-indent: -2em; margin-left: 1em"><span class="b"><strong><font color="#ff0000" face="Courier New">&#160;</font></strong></span> <span class="m"><font color="#0000ff">&lt;</font></span><span class="t"><font color="#990000">RegAppData</font></span> <span class="t"><font color="#990000">Name</font></span><span class="m"><font color="#0000ff">=&quot;</font></span><b>PB-EX61</b><span class="m"><font color="#0000ff">&quot;</font></span><span class="t"><font color="#990000"> File</font></span><span class="m"><font color="#0000ff">=&quot;</font></span><b>C:\Program Files\Autodesk\AutoCAD 2011\Sample\Sheet Sets\Civil\PB-EX61.dwg</b><span class="m"><font color="#0000ff">&quot;</font></span><span class="t"><font color="#990000"> RegAppIds</font></span><span class="m"><font color="#0000ff">=&quot;</font></span><b>ACAD SVPLINE ACAD_PSEXT DCO15 ACAD_MLEADERVER</b><font color="#0000ff"><span class="m">&quot;</span><span class="m"> /&gt;</span></font> </div>     </div>      <div class="e">       <div style="text-indent: -2em; margin-left: 1em"><span class="b"><strong><font color="#ff0000" face="Courier New">&#160;</font></strong></span> <span class="m"><font color="#0000ff">&lt;</font></span><span class="t"><font color="#990000">RegAppData</font></span> <span class="t"><font color="#990000">Name</font></span><span class="m"><font color="#0000ff">=&quot;</font></span><b>A-01</b><span class="m"><font color="#0000ff">&quot;</font></span><span class="t"><font color="#990000"> File</font></span><span class="m"><font color="#0000ff">=&quot;</font></span><b>C:\Program Files\Autodesk\AutoCAD 2011\Sample\Sheet Sets\Architectural\A-01.dwg</b><span class="m"><font color="#0000ff">&quot;</font></span><span class="t"><font color="#990000"> RegAppIds</font></span><span class="m"><font color="#0000ff">=&quot;</font></span><b>ACAD CONTENTBLOCKDESCRIPTION CONTENTBLOCKICON CONTENTTABDATA CONTENTCURRENTTAB ACAD_PSEXT PE_URL RAK AcAecLayerStandard ACAD_DSTYLE_DIMTEXT_FILL ACAD_EXEMPT_FROM_CAD_STANDARDS AcDbBlockRepETag AcDbDynamicBlockTrueName AcDbDynamicBlockGUID AcDbBlockRepBTag ACAD_DSTYLE_DIMEXT_LENGTH ACAD_DSTYLE_DIMEXT_ENABLED ACAD_DSTYLE_DIM_LINETYPE ACAD_DSTYLE_DIM_EXT1_LINETYPE ACAD_DSTYLE_DIM_EXT2_LINETYPE ACAD_MLEADERVER</b><font color="#0000ff"><span class="m">&quot;</span><span class="m"> /&gt;</span></font> </div>     </div>      <div class="e">       <div style="text-indent: -2em; margin-left: 1em"><span class="b"><strong><font color="#ff0000" face="Courier New">&#160;</font></strong></span> <span class="m"><font color="#0000ff">&lt;</font></span><span class="t"><font color="#990000">RegAppData</font></span> <span class="t"><font color="#990000">Name</font></span><span class="m"><font color="#0000ff">=&quot;</font></span><b>Grid Plan</b><span class="m"><font color="#0000ff">&quot;</font></span><span class="t"><font color="#990000"> File</font></span><span class="m"><font color="#0000ff">=&quot;</font></span><b>C:\Program Files\Autodesk\AutoCAD 2011\Sample\Sheet Sets\Architectural\Res\Grid Plan.dwg</b><span class="m"><font color="#0000ff">&quot;</font></span><span class="t"><font color="#990000"> RegAppIds</font></span><span class="m"><font color="#0000ff">=&quot;</font></span><b>ACAD CONTENTBLOCKDESCRIPTION CONTENTBLOCKICON CONTENTTABDATA CONTENTCURRENTTAB ACAD_PSEXT ACAD_DSTYLE_DIMTEXT_FILL</b><font color="#0000ff"><span class="m">&quot;</span><span class="m"> /&gt;</span></font> </div>     </div>      <div class="e">       <div style="text-indent: -2em; margin-left: 1em"><span class="b"><strong><font color="#ff0000" face="Courier New">&#160;</font></strong></span> <span class="m"><font color="#0000ff">&lt;</font></span><span class="t"><font color="#990000">RegAppData</font></span> <span class="t"><font color="#990000">Name</font></span><span class="m"><font color="#0000ff">=&quot;</font></span><b>Wall Base</b><span class="m"><font color="#0000ff">&quot;</font></span><span class="t"><font color="#990000"> File</font></span><span class="m"><font color="#0000ff">=&quot;</font></span><b>C:\Program Files\Autodesk\AutoCAD 2011\Sample\Sheet Sets\Architectural\Res\Wall Base.dwg</b><span class="m"><font color="#0000ff">&quot;</font></span><span class="t"><font color="#990000"> RegAppIds</font></span><span class="m"><font color="#0000ff">=&quot;</font></span><b>ACAD CONTENTBLOCKDESCRIPTION CONTENTBLOCKICON CONTENTTABDATA CONTENTCURRENTTAB RAK AcAecLayerStandard ACAD_PSEXT PE_URL ACAD_DSTYLE_DIMTEXT_FILL ACAD_MLEADERVER</b><font color="#0000ff"><span class="m">&quot;</span><span class="m"> /&gt;</span></font> </div>     </div>      <div><span class="b"><strong><font color="#ff0000" face="Courier New">&#160;</font></strong></span> <span class="m"><font color="#0000ff">&lt;/</font></span><span class="t"><font color="#990000">ArrayOfRegAppData</font></span><span class="m"><font color="#0000ff">&gt;</font></span></div>   </div> </div>  <p>This is really a reasonably simple way of storing our data: it should be trivial to add additional data to the XML, such as the version of the DWG, an entry holding the number of entries in the RegAppId list (although we do have the list itself).</p>  <p>In the next post we may move on to modifying ScriptPro 2.0, but we may take a quick detour and put together an XML stylesheet to visualize the data – let’s see next week.</p>
