---
layout: "post"
title: "Sorting an AutoCAD Point2dCollection or Point3dCollection using .NET"
date: "2011-01-14 14:07:49"
author: "Kean Walmsley"
categories:
  - "AutoCAD"
  - "AutoCAD .NET"
  - "Geometry"
original_url: "https://www.keanw.com/2011/01/sorting-an-autocad-point2dcollection-or-point3dcollection-using-net.html "
typepad_basename: "sorting-an-autocad-point2dcollection-or-point3dcollection-using-net"
typepad_status: "Publish"
---

<p><em>Thanks to Virupaksha Aithal, from DevTech India, for providing the technical response to an ADN member than inspired this post.</em></p>  <p>When working with the Point2d and Point3d objects from AutoCAD’s .NET API it’s common to use the in-built collection types, Point2dCollection and Point3dCollection. Neither of these objects provides the capability to sort their contents (and, in any case, sorting would mean different things to different people when it comes to containers of objects with multiple data entries).</p>  <p>So how can you sort one of these collections?</p>  <p>The answer is fairly straightforward: you convert them to a .NET array, sort them using standard .NET capabilities and then recreate an AutoCAD collection.</p>  <p>The below C# code does this for collections of both Point2d and Point3d objects.</p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.ApplicationServices;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.EditorInput;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.Geometry;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.Runtime;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> System.Collections.Generic;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> System;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">namespace</span><span style="line-height: 140%"> PointSort</span></p>    <p style="margin: 0px"><span style="line-height: 140%">{</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">internal</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">class</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">sort2dByX</span><span style="line-height: 140%"> : </span><span style="line-height: 140%; color: #2b91af">IComparer</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: #2b91af">Point2d</span><span style="line-height: 140%">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">static</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">bool</span><span style="line-height: 140%"> IsZero(</span><span style="line-height: 140%; color: blue">double</span><span style="line-height: 140%"> a)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Math</span><span style="line-height: 140%">.Abs(a) &lt; </span><span style="line-height: 140%; color: #2b91af">Tolerance</span><span style="line-height: 140%">.Global.EqualPoint;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">static</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">bool</span><span style="line-height: 140%"> IsEqual(</span><span style="line-height: 140%; color: blue">double</span><span style="line-height: 140%"> a, </span><span style="line-height: 140%; color: blue">double</span><span style="line-height: 140%"> b)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> IsZero(b - a);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">int</span><span style="line-height: 140%"> Compare(</span><span style="line-height: 140%; color: #2b91af">Point2d</span><span style="line-height: 140%"> a, </span><span style="line-height: 140%; color: #2b91af">Point2d</span><span style="line-height: 140%"> b)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (IsEqual(a.X, b.X)) </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> 0; </span><span style="line-height: 140%; color: green">// ==</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (a.X &lt; b.X) </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> -1; </span><span style="line-height: 140%; color: green">// &lt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> 1; </span><span style="line-height: 140%; color: green">// &gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">internal</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">class</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">sort3dByX</span><span style="line-height: 140%"> : </span><span style="line-height: 140%; color: #2b91af">IComparer</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: #2b91af">Point3d</span><span style="line-height: 140%">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">static</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">bool</span><span style="line-height: 140%"> IsZero(</span><span style="line-height: 140%; color: blue">double</span><span style="line-height: 140%"> a)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Math</span><span style="line-height: 140%">.Abs(a) &lt; </span><span style="line-height: 140%; color: #2b91af">Tolerance</span><span style="line-height: 140%">.Global.EqualPoint;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">static</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">bool</span><span style="line-height: 140%"> IsEqual(</span><span style="line-height: 140%; color: blue">double</span><span style="line-height: 140%"> a, </span><span style="line-height: 140%; color: blue">double</span><span style="line-height: 140%"> b)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> IsZero(b - a);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">int</span><span style="line-height: 140%"> Compare(</span><span style="line-height: 140%; color: #2b91af">Point3d</span><span style="line-height: 140%"> a, </span><span style="line-height: 140%; color: #2b91af">Point3d</span><span style="line-height: 140%"> b)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (IsEqual(a.X, b.X)) </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> 0; </span><span style="line-height: 140%; color: green">// ==</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (a.X &lt; b.X) </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> -1; </span><span style="line-height: 140%; color: green">// &lt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> 1; </span><span style="line-height: 140%; color: green">// &gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">class</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Commands</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">double</span><span style="line-height: 140%"> DeNormalize(</span><span style="line-height: 140%; color: blue">double</span><span style="line-height: 140%"> a, </span><span style="line-height: 140%; color: blue">double</span><span style="line-height: 140%"> max)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// Random numbers are from 0 to 1.0, so we</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// multiply it out to be within our range</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// (this will create a value from -max to max)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> (2 * a - 1) * max;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Point2d</span><span style="line-height: 140%"> Random2dPoint(</span><span style="line-height: 140%; color: #2b91af">Random</span><span style="line-height: 140%"> rnd, </span><span style="line-height: 140%; color: blue">double</span><span style="line-height: 140%"> max)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">double</span><span style="line-height: 140%"> x = rnd.NextDouble(),</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; y = rnd.NextDouble();</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Point2d</span><span style="line-height: 140%">(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; DeNormalize(x, max),</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; DeNormalize(y, max)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; );</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Point3d</span><span style="line-height: 140%"> Random3dPoint(</span><span style="line-height: 140%; color: #2b91af">Random</span><span style="line-height: 140%"> rnd, </span><span style="line-height: 140%; color: blue">double</span><span style="line-height: 140%"> max)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">double</span><span style="line-height: 140%"> x = rnd.NextDouble(),</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; y = rnd.NextDouble(),</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; z = rnd.NextDouble();</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Point3d</span><span style="line-height: 140%">(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; DeNormalize(x, max),</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; DeNormalize(y, max),</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; DeNormalize(z, max)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; );</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Point2dCollection</span><span style="line-height: 140%"> Random2dPoints(</span><span style="line-height: 140%; color: blue">int</span><span style="line-height: 140%"> num, </span><span style="line-height: 140%; color: blue">double</span><span style="line-height: 140%"> max)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Point2dCollection</span><span style="line-height: 140%"> pts = </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Point2dCollection</span><span style="line-height: 140%">(num);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Random</span><span style="line-height: 140%"> rnd = </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Random</span><span style="line-height: 140%">();</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">for</span><span style="line-height: 140%"> (</span><span style="line-height: 140%; color: blue">int</span><span style="line-height: 140%"> i = 0; i &lt; num; i++)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; pts.Add(Random2dPoint(rnd, max));</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> pts;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Point3dCollection</span><span style="line-height: 140%"> Random3dPoints(</span><span style="line-height: 140%; color: blue">int</span><span style="line-height: 140%"> num, </span><span style="line-height: 140%; color: blue">double</span><span style="line-height: 140%"> max)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Point3dCollection</span><span style="line-height: 140%"> pts = </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Point3dCollection</span><span style="line-height: 140%">();</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Random</span><span style="line-height: 140%"> rnd = </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Random</span><span style="line-height: 140%">();</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">for</span><span style="line-height: 140%"> (</span><span style="line-height: 140%; color: blue">int</span><span style="line-height: 140%"> i = 0; i &lt; num; i++)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; pts.Add(Random3dPoint(rnd, max));</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> pts;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> PrintPoints(</span><span style="line-height: 140%; color: #2b91af">Editor</span><span style="line-height: 140%"> ed, </span><span style="line-height: 140%; color: #2b91af">Point2dCollection</span><span style="line-height: 140%"> pts)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">foreach</span><span style="line-height: 140%"> (</span><span style="line-height: 140%; color: #2b91af">Point2d</span><span style="line-height: 140%"> pt </span><span style="line-height: 140%; color: blue">in</span><span style="line-height: 140%"> pts)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</span><span style="line-height: 140%; color: #a31515">&quot;{0}\n&quot;</span><span style="line-height: 140%">, pt);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> PrintPoints(</span><span style="line-height: 140%; color: #2b91af">Editor</span><span style="line-height: 140%"> ed, </span><span style="line-height: 140%; color: #2b91af">Point3dCollection</span><span style="line-height: 140%"> pts)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">foreach</span><span style="line-height: 140%"> (</span><span style="line-height: 140%; color: #2b91af">Point3d</span><span style="line-height: 140%"> pt </span><span style="line-height: 140%; color: blue">in</span><span style="line-height: 140%"> pts)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</span><span style="line-height: 140%; color: #a31515">&quot;{0}\n&quot;</span><span style="line-height: 140%">, pt);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; [</span><span style="line-height: 140%; color: #2b91af">CommandMethod</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: #a31515">&quot;PTS&quot;</span><span style="line-height: 140%">)]</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> PointSort()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Document</span><span style="line-height: 140%"> doc =</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Application</span><span style="line-height: 140%">.DocumentManager.MdiActiveDocument;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Editor</span><span style="line-height: 140%"> ed = doc.Editor;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Point2dCollection</span><span style="line-height: 140%"> pts2d = Random2dPoints(20, 1000.0);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Point2d</span><span style="line-height: 140%">[] raw = pts2d.ToArray();</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Array</span><span style="line-height: 140%">.Sort(raw, </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">sort2dByX</span><span style="line-height: 140%">());</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Point2dCollection</span><span style="line-height: 140%"> sorted2d = </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Point2dCollection</span><span style="line-height: 140%">(raw);</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</span><span style="line-height: 140%; color: #a31515">&quot;\n2D points before sort:\n\n&quot;</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; PrintPoints(ed, pts2d);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</span><span style="line-height: 140%; color: #a31515">&quot;\n\n2D points after sort:\n\n&quot;</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; PrintPoints(ed, sorted2d);</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Point3dCollection</span><span style="line-height: 140%"> pts3d = Random3dPoints(20, 1000.0);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Point3d</span><span style="line-height: 140%">[] raw3d = </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Point3d</span><span style="line-height: 140%">[pts3d.Count];</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; pts3d.CopyTo(raw3d, 0);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Array</span><span style="line-height: 140%">.Sort(raw3d, </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">sort3dByX</span><span style="line-height: 140%">());</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Point3dCollection</span><span style="line-height: 140%"> sorted3d = </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Point3dCollection</span><span style="line-height: 140%">(raw3d);</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</span><span style="line-height: 140%; color: #a31515">&quot;\n3D points before sort:\n\n&quot;</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; PrintPoints(ed, pts3d);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</span><span style="line-height: 140%; color: #a31515">&quot;\n\n3D points after sort:\n\n&quot;</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; PrintPoints(ed, sorted3d);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">}</span></p> </div> <!--EndFragment-->  <p>Some notes on this implementation:</p>  <ul>   <li>For the purposes of this example, we’re assuming “sorting” means to sort on the X value of each point      <ul>       <li>It should be obvious how to change the implementation to use different sort criteria </li>     </ul>   </li>    <li>To test the sorting, we’re populating the collections with a set of randomly-generated points      <ul>       <li>We create 20 points in each collection, each with coordinates in the range of –1000 to 1000 </li>        <li>I’ve kept the number of points in each collection low, just to keep the post to a reasonable length and still be able to include the results </li>     </ul>   </li>    <li>Converting to a .NET array is a little different for 2D and 3D collections      <ul>       <li>Point2dCollection has the ToArray() method </li>        <li>Point3dCollection has the CopyTo() method </li>     </ul>   </li> </ul>  <p>Something I will say about the above code... It’s code like this that makes me yearn for a more dynamic environment (I’m writing this in “classic”, statically-typed C#). There are several duplicate classes with basically the same implementation but taking different types: plenty of code that just feels redundant.</p>  <p>It would be interesting to rework this IronPython, to see what that it brings (or even to see if using the dynamic keyword would help – I should really install VS 2010 and give it a try). This is also exactly the kind of problem that F# excels at solving, so I’ll expect I’ll be giving that a try, too, before too long, just to see how much code can be ripped out.</p>  <p>Here are some sample results from&#160; running the PTS command: </p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%">Command: <font color="#ff0000">PTS</font></span>&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">2D points before sort:</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">(546.62044884014,333.683370302284)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(273.865409788613,671.008432130799)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(786.237089795171,-664.37283328938)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(-951.588503062533,-221.942868652727)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(-362.490728200642,-93.6347987007512)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(-938.590817124858,-889.46122764119)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(628.55356355596,-180.880018128492)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(485.986099339084,329.109809980313)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(525.820961001246,-659.813289372164)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(-902.095012321181,-931.107034874664)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(683.452251219867,931.710177069395)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(110.748492698534,-899.346025613763)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(47.6774876227963,-794.155224130561)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(-993.500254113926,438.08932389975)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(994.927220044158,-722.431948279232)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(198.020555636855,462.94129894252)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(-693.78015850381,-930.635690656787)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(-330.415913523369,497.267734025264)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(-855.102567866027,951.917634323201)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(520.609316192851,-779.07530860001)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">2D points after sort:</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">(-993.500254113926,438.08932389975)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(-951.588503062533,-221.942868652727)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(-938.590817124858,-889.46122764119)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(-902.095012321181,-931.107034874664)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(-855.102567866027,951.917634323201)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(-693.78015850381,-930.635690656787)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(-362.490728200642,-93.6347987007512)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(-330.415913523369,497.267734025264)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(47.6774876227963,-794.155224130561)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(110.748492698534,-899.346025613763)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(198.020555636855,462.94129894252)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(273.865409788613,671.008432130799)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(485.986099339084,329.109809980313)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(520.609316192851,-779.07530860001)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(525.820961001246,-659.813289372164)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(546.62044884014,333.683370302284)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(628.55356355596,-180.880018128492)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(683.452251219867,931.710177069395)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(786.237089795171,-664.37283328938)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(994.927220044158,-722.431948279232)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">3D points before sort:</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">(-282.271111981138,909.546242053409,285.631638618946)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(371.393521023632,762.584686168742,-119.380790330181)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(386.957248387373,-908.643945077734,648.815548815213)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(494.069362754966,93.28737999,323.425575775758)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(494.450510244095,586.600064107496,680.753123797827)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(489.99652056489,712.608007580325,660.061542717768)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(132.996848380657,-910.9989078301,-602.627639473708)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(564.335921576403,-454.319581135325,78.9875290724391)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(276.740193961533,837.884722202031,922.783010603293)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(-314.830172487921,370.544476141475,-925.548076594969)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(865.08049995875,-543.389787684842,101.277599624022)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(-267.499718473991,616.808070622761,558.13882665622)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(-782.131620581323,-289.302226756374,373.464381961834)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(832.297310155024,-629.765324122163,523.183570021383)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(614.174030541523,-112.834495079161,366.034026893803)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(-234.866094419205,43.4879246370345,265.665525228561)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(-255.009830582426,195.9628114458,-851.765022544081)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(374.128198891007,532.42736753655,-900.2289231402)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(-385.354406845455,153.392966442459,363.865823188734)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(-793.355890453493,-905.346672937901,924.69996396671)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">3D points after sort:</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">(-793.355890453493,-905.346672937901,924.69996396671)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(-782.131620581323,-289.302226756374,373.464381961834)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(-385.354406845455,153.392966442459,363.865823188734)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(-314.830172487921,370.544476141475,-925.548076594969)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(-282.271111981138,909.546242053409,285.631638618946)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(-267.499718473991,616.808070622761,558.13882665622)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(-255.009830582426,195.9628114458,-851.765022544081)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(-234.866094419205,43.4879246370345,265.665525228561)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(132.996848380657,-910.9989078301,-602.627639473708)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(276.740193961533,837.884722202031,922.783010603293)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(371.393521023632,762.584686168742,-119.380790330181)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(374.128198891007,532.42736753655,-900.2289231402)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(386.957248387373,-908.643945077734,648.815548815213)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(489.99652056489,712.608007580325,660.061542717768)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(494.069362754966,93.28737999,323.425575775758)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(494.450510244095,586.600064107496,680.753123797827)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(564.335921576403,-454.319581135325,78.9875290724391)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(614.174030541523,-112.834495079161,366.034026893803)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(832.297310155024,-629.765324122163,523.183570021383)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">(865.08049995875,-543.389787684842,101.277599624022)</span></p> </div> <!--EndFragment-->  <p><strong><em>Update</em></strong></p>  <p>Thanks to Dan Smith for provide a refactored version of the code: if you use multiple inheritance – in the case of our “comparer” classes – and generics/LINQ – in the case of the point generation piece – then it’s certainly possible to factor out the redundant code in good old C#. (You will have to target .NET Framework 3.5 or higher to get this to build.)</p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.ApplicationServices;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.EditorInput;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.Geometry;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.Runtime;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> System.Collections.Generic;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> System.Linq;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> System;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">namespace</span><span style="line-height: 140%"> PointSort</span></p>    <p style="margin: 0px"><span style="line-height: 140%">{</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">internal</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">class</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">sortByX</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">protected</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">static</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">bool</span><span style="line-height: 140%"> IsZero(</span><span style="line-height: 140%; color: blue">double</span><span style="line-height: 140%"> a)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Math</span><span style="line-height: 140%">.Abs(a) &lt; </span><span style="line-height: 140%; color: #2b91af">Tolerance</span><span style="line-height: 140%">.Global.EqualPoint;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">protected</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">static</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">bool</span><span style="line-height: 140%"> IsEqual(</span><span style="line-height: 140%; color: blue">double</span><span style="line-height: 140%"> a, </span><span style="line-height: 140%; color: blue">double</span><span style="line-height: 140%"> b)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> IsZero(b - a);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">protected</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">int</span><span style="line-height: 140%"> Compare(</span><span style="line-height: 140%; color: blue">double</span><span style="line-height: 140%"> aX, </span><span style="line-height: 140%; color: blue">double</span><span style="line-height: 140%"> bX)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (IsEqual(aX, bX)) </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> 0; </span><span style="line-height: 140%; color: green">// ==</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (aX &lt; bX) </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> -1; </span><span style="line-height: 140%; color: green">// &lt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> 1; </span><span style="line-height: 140%; color: green">// &gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">internal</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">class</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">sort2dByX</span><span style="line-height: 140%"> : </span><span style="line-height: 140%; color: #2b91af">sortByX</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #2b91af">IComparer</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: #2b91af">Point2d</span><span style="line-height: 140%">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">int</span><span style="line-height: 140%"> Compare(</span><span style="line-height: 140%; color: #2b91af">Point2d</span><span style="line-height: 140%"> a, </span><span style="line-height: 140%; color: #2b91af">Point2d</span><span style="line-height: 140%"> b)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">base</span><span style="line-height: 140%">.Compare(a.X, b.X);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">internal</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">class</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">sort3dByX</span><span style="line-height: 140%"> : </span><span style="line-height: 140%; color: #2b91af">sortByX</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #2b91af">IComparer</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: #2b91af">Point3d</span><span style="line-height: 140%">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">int</span><span style="line-height: 140%"> Compare(</span><span style="line-height: 140%; color: #2b91af">Point3d</span><span style="line-height: 140%"> a, </span><span style="line-height: 140%; color: #2b91af">Point3d</span><span style="line-height: 140%"> b)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">base</span><span style="line-height: 140%">.Compare(a.X, b.X);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">class</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Commands</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">double</span><span style="line-height: 140%"> DeNormalize(</span><span style="line-height: 140%; color: blue">double</span><span style="line-height: 140%"> a, </span><span style="line-height: 140%; color: blue">double</span><span style="line-height: 140%"> max)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// Random numbers are from 0 to 1.0, so we</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// multiply it out to be within our range</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// (this will create a value from -max to max)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> (2 * a - 1) * max;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Point2d</span><span style="line-height: 140%"> Random2dPoint(</span><span style="line-height: 140%; color: #2b91af">Random</span><span style="line-height: 140%"> rnd, </span><span style="line-height: 140%; color: blue">double</span><span style="line-height: 140%"> max)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">double</span><span style="line-height: 140%"> x = rnd.NextDouble(),</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; y = rnd.NextDouble();</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Point2d</span><span style="line-height: 140%">(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; DeNormalize(x, max),</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; DeNormalize(y, max)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; );</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Point3d</span><span style="line-height: 140%"> Random3dPoint(</span><span style="line-height: 140%; color: #2b91af">Random</span><span style="line-height: 140%"> rnd, </span><span style="line-height: 140%; color: blue">double</span><span style="line-height: 140%"> max)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">double</span><span style="line-height: 140%"> x = rnd.NextDouble(),</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; y = rnd.NextDouble(),</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; z = rnd.NextDouble();</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Point3d</span><span style="line-height: 140%">(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; DeNormalize(x, max),</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; DeNormalize(y, max),</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; DeNormalize(z, max)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; );</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; TPoint[] RandomPoints&lt;TPoint&gt;(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">int</span><span style="line-height: 140%"> num, </span><span style="line-height: 140%; color: blue">double</span><span style="line-height: 140%"> max, </span><span style="line-height: 140%; color: #2b91af">Func</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: #2b91af">Random</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: blue">double</span><span style="line-height: 140%">, TPoint&gt; generator</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; )</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">var</span><span style="line-height: 140%"> pts = </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> TPoint[num];</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">var</span><span style="line-height: 140%"> rnd = </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Random</span><span style="line-height: 140%">();</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">for</span><span style="line-height: 140%"> (</span><span style="line-height: 140%; color: blue">int</span><span style="line-height: 140%"> i = 0; i &lt; num; i++)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; pts[i] = generator(rnd, max);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> pts;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Point2dCollection</span><span style="line-height: 140%"> Random2dPoints(</span><span style="line-height: 140%; color: blue">int</span><span style="line-height: 140%"> num, </span><span style="line-height: 140%; color: blue">double</span><span style="line-height: 140%"> max)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">var</span><span style="line-height: 140%"> pts = RandomPoints&lt;</span><span style="line-height: 140%; color: #2b91af">Point2d</span><span style="line-height: 140%">&gt;(num, max, Random2dPoint);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Point2dCollection</span><span style="line-height: 140%">(pts);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Point3dCollection</span><span style="line-height: 140%"> Random3dPoints(</span><span style="line-height: 140%; color: blue">int</span><span style="line-height: 140%"> num, </span><span style="line-height: 140%; color: blue">double</span><span style="line-height: 140%"> max)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">var</span><span style="line-height: 140%"> pts = RandomPoints&lt;</span><span style="line-height: 140%; color: #2b91af">Point3d</span><span style="line-height: 140%">&gt;(num, max, Random3dPoint);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Point3dCollection</span><span style="line-height: 140%">(pts);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> PrintPoints(</span><span style="line-height: 140%; color: #2b91af">Editor</span><span style="line-height: 140%"> ed, </span><span style="line-height: 140%; color: #2b91af">Point2dCollection</span><span style="line-height: 140%"> pts)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">foreach</span><span style="line-height: 140%"> (</span><span style="line-height: 140%; color: #2b91af">Point2d</span><span style="line-height: 140%"> pt </span><span style="line-height: 140%; color: blue">in</span><span style="line-height: 140%"> pts)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</span><span style="line-height: 140%; color: #a31515">&quot;{0}\n&quot;</span><span style="line-height: 140%">, pt);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> PrintPoints(</span><span style="line-height: 140%; color: #2b91af">Editor</span><span style="line-height: 140%"> ed, </span><span style="line-height: 140%; color: #2b91af">Point3dCollection</span><span style="line-height: 140%"> pts)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">foreach</span><span style="line-height: 140%"> (</span><span style="line-height: 140%; color: #2b91af">Point3d</span><span style="line-height: 140%"> pt </span><span style="line-height: 140%; color: blue">in</span><span style="line-height: 140%"> pts)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</span><span style="line-height: 140%; color: #a31515">&quot;{0}\n&quot;</span><span style="line-height: 140%">, pt);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; [</span><span style="line-height: 140%; color: #2b91af">CommandMethod</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: #a31515">&quot;PTS&quot;</span><span style="line-height: 140%">)]</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> PointSort()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Document</span><span style="line-height: 140%"> doc =</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Application</span><span style="line-height: 140%">.DocumentManager.MdiActiveDocument;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Editor</span><span style="line-height: 140%"> ed = doc.Editor;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Point2dCollection</span><span style="line-height: 140%"> pts2d = Random2dPoints(20, 1000.0);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Point2d</span><span style="line-height: 140%">[] raw = pts2d.ToArray();</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Array</span><span style="line-height: 140%">.Sort(raw, </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">sort2dByX</span><span style="line-height: 140%">());</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Point2dCollection</span><span style="line-height: 140%"> sorted2d = </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Point2dCollection</span><span style="line-height: 140%">(raw);</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</span><span style="line-height: 140%; color: #a31515">&quot;\n2D points before sort:\n\n&quot;</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; PrintPoints(ed, pts2d);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</span><span style="line-height: 140%; color: #a31515">&quot;\n\n2D points after sort:\n\n&quot;</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; PrintPoints(ed, sorted2d);</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Point3dCollection</span><span style="line-height: 140%"> pts3d = Random3dPoints(20, 1000.0);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Point3d</span><span style="line-height: 140%">[] raw3d = </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Point3d</span><span style="line-height: 140%">[pts3d.Count];</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; pts3d.CopyTo(raw3d, 0);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Array</span><span style="line-height: 140%">.Sort(raw3d, </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">sort3dByX</span><span style="line-height: 140%">());</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Point3dCollection</span><span style="line-height: 140%"> sorted3d = </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Point3dCollection</span><span style="line-height: 140%">(raw3d);</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</span><span style="line-height: 140%; color: #a31515">&quot;\n3D points before sort:\n\n&quot;</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; PrintPoints(ed, pts3d);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</span><span style="line-height: 140%; color: #a31515">&quot;\n\n3D points after sort:\n\n&quot;</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; PrintPoints(ed, sorted3d);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">}</span></p> </div> <!--EndFragment-->  <p>It’s still more verbose than I’d like, given the relatively low complexity of the problem, so I’ll still give IronPython and F# a go to see how they compare, when I get the chance.</p>
