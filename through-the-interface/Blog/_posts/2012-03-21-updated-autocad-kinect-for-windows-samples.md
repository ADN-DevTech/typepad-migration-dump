---
layout: "post"
title: "Updated AutoCAD + Kinect for Windows samples"
date: "2012-03-21 17:48:17"
author: "Kean Walmsley"
categories:
  - "AU"
  - "AutoCAD"
  - "AutoCAD .NET"
  - "Kinect"
original_url: "https://www.keanw.com/2012/03/updated-autocad-kinect-for-windows-samples.html "
typepad_basename: "updated-autocad-kinect-for-windows-samples"
typepad_status: "Publish"
---

<p>Thanks to <a href="http://channel9.msdn.com/coding4fun/kinect/AutoCAD-and-the-Kinect" target="_blank">some recent coverage on a Channel 9 blog</a> (which I consider a great honour – I’ve been a huge fan of Channel 9 since its inception :-), I decided to get around to posting an update to <a href="http://through-the-interface.typepad.com/through_the_interface/2011/11/au-2011-samples-integrating-microsoft-kinect-with-autocad.html" target="_blank">the AutoCAD + Kinect samples</a> <a href="http://through-the-interface.typepad.com/through_the_interface/2011/11/adding-speech-recognition-to-autocad-via-kinect.html" target="_blank">I demonstrated</a> <a href="http://through-the-interface.typepad.com/through_the_interface/2011/11/adding-speech-recognition-to-autocad-via-kinect-continued.html" target="_blank">at AU 2011</a>.</p>  <p>While attending <a href="http://through-the-interface.typepad.com/through_the_interface/2012/03/in-the-bay-area.html" target="_blank">the recent hackathon</a>, I spent a fair amount of time porting my AutoCAD-Kinect integration samples from the Beta 2 of the Microsoft Kinect SDK (for the Kinect for Xbox 360 sensor) to the released SDK for the Kinect for Windows.</p>  <p>It was pretty impressive just how many of the Kinect APIs were broken between Beta 2 SDK and the final release (you can hear some additional commentary on this in <a href="http://www.dotnetrocks.com/default.aspx?showNum=748" target="_blank">this .NET Rocks episode</a>). I understand the desire to get the API in shape prior to release – you really want to minimise any messy, legacy dependencies – but the full extent of the changes certainly took me by surprise. The good news is that there are a number of APIs that make point cloud creation simpler, for instance, so I was able to pull out some of the more icky code from the samples.</p>  <p>Anyway, <a href="http://through-the-interface.typepad.com/files/KinectSamples-v1.zip" target="_blank">here are the updated samples</a>. If you’d like to diff the changes with the original version for the Beta 2 SDK, <a href="http://through-the-interface.typepad.com/files/KinectSamples2.zip" target="_blank">here these are, too</a>, although be warned that I did take the opportunity to do some refactoring, particularly with respect to the speech recognition capability (I’ve now added some events to allow derived classes to add words to be recognised – previously it was all munged into base KinectJig class).</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201676410f114970b-pi" target="_blank"><img style="background-image: none; border-bottom: 0px; border-left: 0px; margin: 20px auto; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top: 0px; border-right: 0px; padding-top: 0px" title="Point cloud in AutoCAD via Kinect" border="0" alt="Point cloud in AutoCAD via Kinect" src="/assets/image_581928.jpg" width="470" height="337" /></a></p>  <p>Aside from the complexity of the migration (which was thankfully minimised due to the fact I’d previously implemented a base class with much of the needed functionality), there were a few behaviours that still seem a little quirky: once started, the sensor now never seems to turn off, even after it has been stopped. You can unplug it, of course, but that doesn’t seem quite right. And having the red light stay on makes me feel like I’m being watched – it reminds me of the glowing red eyes in <a href="http://www.imdb.com/title/tt0103064/" target="_blank">Terminator 2</a> (gulp).</p>  <p>Also, at first the speech recognition seemed more flakey, but that no longer seems to be the case: I’ve been working on a command to let you digitise a spline by saying voice commands like “start”, “point” and “end”, but I didn’t feel comfortable getting this working well at the hackathon (there’s nothing more disturbing than someone waving their hands and shouting at their computer when you’re trying to solve a tricky coding problem :-). Now that I’ve had some time in a more private coding environment, things seem to be working well enough.</p>  <p>I did follow the updated Kinect audio samples that implement a 4-second delay for speech recognition to initialise properly, so perhaps that helped, too.</p>  <p>I’ll put the finishing touches on the spline creation sample – which I see as potentially handy when digitising real-world objects – and get that posted sometime in the coming weeks.</p>
