---
layout: "post"
title: "Signing your application modules for AutoCAD 2016 &ndash; Part 1"
date: "2015-05-28 19:25:52"
author: "Kean Walmsley"
categories:
  - "AutoCAD"
  - "AutoCAD .NET"
  - "AutoLISP / Visual LISP"
  - "ObjectARX"
  - "Runtime"
  - "Security"
  - "Visual Basic &amp; VBA"
original_url: "https://www.keanw.com/2015/05/signing-your-application-modules-for-autocad-2016-part-1.html "
typepad_basename: "signing-your-application-modules-for-autocad-2016-part-1"
typepad_status: "Publish"
---

<p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201bb0835dbbb970d-pi" target="_blank"><img title="Padlocks" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; float: none; padding-top: 0px; padding-left: 0px; margin: 20px auto; display: block; padding-right: 0px; border-top-width: 0px" border="0" alt="Padlocks" src="/assets/image_47551.jpg" width="394" height="264" /></a></p>  <p>This series of posts is one I’ve been meaning to write since AutoCAD 2016 started shipping. Thankfully a number of other people have filled the void, in the meantime, so I’ve created an appendix of related posts that you can find at the bottom of each post in this series.</p>  <p>The series is about how we’re working to improve security inside AutoCAD, and what this means for application developers. <a href="http://lynn.blogs.com/lynn_allens_blog/2015/04/autocad-hacked-part-1.html" target="_blank">Dieter’s</a> <a href="http://lynn.blogs.com/lynn_allens_blog/2015/04/autocad-hacked-part-2.html" target="_blank">posts</a> on Lynn’s blog help explain some of the background to this work, much as I’ve <a href="http://through-the-interface.typepad.com/through_the_interface/2014/06/thinking-about-security-part-1.html" target="_blank">posted</a> <a href="http://through-the-interface.typepad.com/through_the_interface/2014/06/thinking-about-security-part-2.html" target="_blank">here</a> in the past, too.</p>  <p>Perhaps the biggest security change in AutoCAD 2016 is around the increased emphasis on program modules being digitally signed. Signing has really become “best practice” for software being deployed to customers, and we’re really encouraging AutoCAD developers to go along this path. Signing tells customers that modules have been created by a trusted source and haven’t been tampered since the moment they were signed.</p>  <p>So how do you sign your program modules? The first step is to get hold of a <strong>digital certificate</strong>, whether by <a href="http://knowledge.autodesk.com/search-result/caas/CloudHelp/cloudhelp/2016/ENU/AutoCAD-Customization/files/GUID-26D7B31C-4165-410C-9FC4-2D556749D517-htm.html" target="_blank">making one</a> (for testing) or buying one from a reliable vendor such as <a href="http://www.symantec.com/code-signing/" target="_blank">Symantec (VeriSign)</a>, <a href="https://www.digicert.com/order/order-1.php" target="_blank">DigiCert</a>, <a href="https://www.godaddy.com/ssl/code-signing-certificate.aspx" target="_blank">GoDaddy</a>, <a href="https://www.thawte.com/code-signing/" target="_blank">Thawte</a> or <a href="https://www.globalsign.com/en/code-signing/" target="_blank">GlobalSign</a>. Make sure you get a <u>code signing</u> certificate<em> </em>that supports <em>Microsoft Authenticode</em>. You should expect to pay around $200-$500 per year for such a certificate, depending on where you get it from. This may seem expensive, but signing is becoming increasingly important to companies and it’s a cost you can amortise across your various applications and customers.</p>  <p>Once you have a certificate, you’ll need to <a href="http://knowledge.autodesk.com/search-result/caas/CloudHelp/cloudhelp/2016/ENU/AutoCAD-Customization/files/GUID-DC1B25FE-E063-486C-B90C-565AB5E87BBC-htm.html" target="_blank">create a PFX file for it</a>: this will make it a lot easier to sign standard OS modules such as .NET DLLs, ARXs, CRXs, DBXs and EXEs. To perform this type of signing you use <em>SignTool.exe</em>, which can be <a href="http://knowledge.autodesk.com/search-result/caas/CloudHelp/cloudhelp/2016/ENU/AutoCAD-Customization/files/GUID-3DA95353-9EF3-4E29-9671-6AEB7704EBE6-htm.html" target="_blank">run from a standard command prompt</a> or <a href="http://knowledge.autodesk.com/search-result/caas/CloudHelp/cloudhelp/2016/ENU/AutoCAD-Customization/files/GUID-AA7BBBED-98D0-4003-8C80-D66173664DBA-htm.html" target="_blank">from a Visual Studio post-build event</a>.</p>  <p>You’ll also want to <a href="http://knowledge.autodesk.com/search-result/caas/CloudHelp/cloudhelp/2016/ENU/AutoCAD-Customization/files/GUID-19D6716A-0AD1-4A7A-82BA-A067E6D65F66-htm.html" target="_blank">import the certificate into the Windows certificate store</a>: this will allow you to use it to sign AutoLISP files and also to verify the signature of signed modules on your system. (Strictly speaking it shouldn’t be required to import the certificate to sign LISP files: at some point we’re planning to enable the signing tool to work directly from the PFX file and other places, much as <em>SignTool.exe</em> does.)</p>  <p>Signing AutoLISP is perhaps even easier than .DLLs, as the app that does it provides a GUI: <em>AcSignApply.exe</em> is found in AutoCAD’s <em>Program Files</em> folder and can be used to sign .LSP (and .FAS, .VLX &amp; .MNL) as well as drawing files and eTransmit archives.</p>  <p>Here’s the UI for this tool:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201bb0835dbbf970d-pi" target="_blank"><img title="AcSignApply about to sign a LSP file" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; float: none; padding-top: 0px; padding-left: 0px; margin: 20px auto; display: block; padding-right: 0px; border-top-width: 0px" border="0" alt="AcSignApply about to sign a LSP file" src="/assets/image_813651.jpg" width="283" height="264" /></a></p>  <p>There are some “executable” file types that currently can’t be signed, such as .CUI, CUIx, .DVB, .JS, .PGP and .SCR. It’s recommended that these files be placed in read-only locations, as these could otherwise become attack vectors for malicious applications.</p>  <p>In tomorrow’s post we’ll take a look at how AutoCAD behaves when loading signed/unsigned modules, as well as what a signed .LSP looks like.</p>  <p><strong><em>Appendix</em></strong></p>  <ul>   <li>Product documentation      <ul>       <li><a href="http://knowledge.autodesk.com/search-result/caas/CloudHelp/cloudhelp/2016/ENU/AutoCAD-Customization/files/GUID-0A93626D-8389-45FC-969B-B86A2F37D691-htm.html" target="_blank">About Digitally Signing Custom Program Files</a> </li>        <li><a href="http://knowledge.autodesk.com/search-result/caas/CloudHelp/cloudhelp/2016/ENU/AutoCAD-Core/files/GUID-EDBB6671-94A9-4B0C-A6F2-BC3EFBBBCBC2-htm.html" target="_blank">About Digital Signatures for Executable Files</a> </li>        <li><a href="http://knowledge.autodesk.com/search-result/caas/CloudHelp/cloudhelp/2016/ENU/AutoCAD-Customization/files/GUID-5CE8D264-FB3B-4E66-A637-183EB999F210-htm.html" target="_blank">About Loading A Digitally Signed Custom Program File</a> </li>        <li><a href="http://knowledge.autodesk.com/search-result/caas/CloudHelp/cloudhelp/2016/ENU/AutoCAD-Customization/files/GUID-26D7B31C-4165-410C-9FC4-2D556749D517-htm.html" target="_blank">To Make a Digital Certificate</a> </li>        <li><a href="http://knowledge.autodesk.com/search-result/caas/CloudHelp/cloudhelp/2016/ENU/AutoCAD-Customization/files/GUID-DC1B25FE-E063-486C-B90C-565AB5E87BBC-htm.html" target="_blank">To Create A Personal Information Exchange (PFX) File</a> </li>        <li><a href="http://knowledge.autodesk.com/search-result/caas/CloudHelp/cloudhelp/2016/ENU/AutoCAD-Customization/files/GUID-19D6716A-0AD1-4A7A-82BA-A067E6D65F66-htm.html" target="_blank">To Import a Digital Certificate</a><!--EndFragment--> </li>        <li><a href="http://knowledge.autodesk.com/search-result/caas/CloudHelp/cloudhelp/2016/ENU/AutoCAD-Customization/files/GUID-A63E8C40-6870-4874-BF7E-FD75E87268AA-htm.html" target="_blank">To Digitally Sign an AutoLISP File</a> </li>        <li><a href="http://knowledge.autodesk.com/search-result/caas/CloudHelp/cloudhelp/2016/ENU/AutoCAD-Customization/files/GUID-3DA95353-9EF3-4E29-9671-6AEB7704EBE6-htm.html" target="_blank">To Digitally Sign a Binary (ObjectARX or Managed .NET) File</a> </li>        <li><a href="http://knowledge.autodesk.com/search-result/caas/CloudHelp/cloudhelp/2016/ENU/AutoCAD-Customization/files/GUID-AA7BBBED-98D0-4003-8C80-D66173664DBA-htm.html" target="_blank">To Digitally Sign a Binary (ObjectARX or Managed .NET) File with a Post-Build Event in Microsoft Visual Studio</a> </li>     </ul>   </li>    <li>ADN DevBlog      <ul>       <li><a href="http://adndevblog.typepad.com/autocad/2015/05/autocad-2016-trusted-paths-and-autoloader.html" target="_blank">AutoCAD 2016: Trusted paths and AutoLoader</a> </li>        <li><a href="http://adndevblog.typepad.com/autocad/2015/04/how-to-avoid-trust-this-publisher-dialog.html" target="_blank">How to avoid ‘Trust This Publisher’ Dialog</a> </li>        <li><a href="http://adndevblog.typepad.com/autocad/2015/01/digitally-signing-plug-in-files.html" target="_blank">Digitally signing plug-in files</a> </li>     </ul>   </li>    <li>Dieter Schlaepfer’s posts on Lynn Allen’s blog      <ul>       <li><a href="http://lynn.blogs.com/lynn_allens_blog/2015/04/autocad-hacked-part-1.html" target="_blank">AutoCAD Hacked! - Part 1</a> </li>        <li><a href="http://lynn.blogs.com/lynn_allens_blog/2015/04/autocad-hacked-part-2.html" target="_blank">AutoCAD Hacked! - Part 2</a> </li>     </ul>   </li> </ul>  <p><font color="#a5a5a5">Photo credit: </font><a href="http://www.flickr.com/photos/64119933@N00/5704881994"><font color="#a5a5a5">Cadenas</font></a><font color="#a5a5a5"> via </font><a href="http://photopin.com"><font color="#a5a5a5">photopin</font></a><font color="#a5a5a5"> </font><a href="https://creativecommons.org/licenses/by-nc/2.0/"><font color="#a5a5a5">(license)</font></a></p>
