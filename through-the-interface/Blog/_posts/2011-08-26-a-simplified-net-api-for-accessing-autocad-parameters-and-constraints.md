---
layout: "post"
title: "A simplified .NET API for accessing AutoCAD parameters and constraints"
date: "2011-08-26 17:58:56"
author: "Kean Walmsley"
categories:
  - "AutoCAD"
  - "AutoCAD .NET"
  - "Geometry"
  - "ObjectARX"
  - "Runtime"
original_url: "https://www.keanw.com/2011/08/a-simplified-net-api-for-accessing-autocad-parameters-and-constraints.html "
typepad_basename: "a-simplified-net-api-for-accessing-autocad-parameters-and-constraints"
typepad_status: "Publish"
---

<p>In the 2010 release, we introduced 2D geometric constraints to AutoCAD. The feature was implemented using AutoCAD’s low-level – and very powerful – Associative Framework, which has subsequently been used to implement features such as parametric surfaces in AutoCAD 2011 (more information on that <a href="http://through-the-interface.typepad.com/through_the_interface/2010/08/devtv-on-autocad-2011s-associative-surfaces-api.html" target="_blank">here</a>). Our initial API implementation for creating and accessing geometric constraints (which you can find out more about via the DevTV session linked to from <a href="http://through-the-interface.typepad.com/through_the_interface/2010/12/some-content-from-au-2010.html" target="_blank">this previous post</a>) in many ways reflects the low-level nature of the underlying framework: it was unfortunately just a bit too complicated for most mortals to get to grips with.</p>  <p>Philippe Leefsma, from DevTech EMEA, and Gopinath Taget, from DevTech Americas, have worked with our Engineering team to develop a “high-level” API for constraints inside AutoCAD, which does a great job of abstracting away much of this complexity.</p>  <p><a href="http://through-the-interface.typepad.com/files/AdnAssocConstraintAPI.zip" target="_blank">The API distribution</a> includes a single VS 2008 solution – as the API has been implemented using ObjectARX, which currently requires the use of VS 2008 – containing projects for the C++ API, the mixed-mode layer exposing this to .NET and a test project for each of these managed and unmanaged APIs.</p>  <p>For people such as myself using VS 2010, the best thing to do is to load this solution – converting the various projects – and then unload the projects you don’t need: AdnAssocConstraintAPI, AdnAssocConstraintAPIMgd and ArxConstraintAPITest. You will then need to set a “Reference Path” in the remaining project (MgdConstraintAPITest), pointing it to the compiled <em>AdnAssocConstraintAPIMgd.dll</em> file in the “bin resource” folder, as well as to the usual <em>AcDbMgd.dll</em> and <em>AcMgd.dll</em> files.</p>  <p>Beyond that, the implementation should be relatively straightforward: I suggest trying out the various commands implemented in the test project to get a feel for what’s possible, as well as taking a look at the compiled help-file provided in the Help folder.</p>  <p>Here are a list of these commands with a brief description of what they do:</p>  <ul>   <li>MGHLCOIN – creates a coincident constraint </li>    <li>MGHLPAR – creates a parallel constraint </li>    <li>MGHLPERP – creates a perpendicular constraint </li>    <li>MGHLCONC – creates a concentric constraint </li>    <li>MGHLCOLIN – creates a co-linear constraint </li>    <li>MGHLHOR – creates a horizontal constraint </li>    <li>MGHLVERT – creates a vertical constraint </li>    <li>MGHLFIX – creates a fix constraint </li>    <li>MGHLTAN – creates a tangent constraint </li>    <li>MGHLG2SM – creates a smooth constraint </li>    <li>MGHLSYM – creates a symmetric constraint </li>    <li>MGHLEQLN – creates a equal length constraint </li>    <li>MGHLEQRAD – creates a equal radius constraint </li>    <li>MGHLDIMALIGN – creates an aligned dimensional constraint </li>    <li>MGHLPARAM – illustrates several functionalities of AssocUtil Parameter API (query, creation, modification, renaming) </li> </ul>  <p>Thanks to Philippe and Gopi for their hard work on this very helpful API!</p>
