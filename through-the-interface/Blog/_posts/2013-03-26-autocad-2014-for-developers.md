---
layout: "post"
title: "AutoCAD 2014 for developers"
date: "2013-03-26 11:36:41"
author: "Kean Walmsley"
categories:
  - "AutoCAD"
  - "AutoCAD .NET"
  - "JavaScript"
original_url: "https://www.keanw.com/2013/03/autocad-2014-for-developers.html "
typepad_basename: "autocad-2014-for-developers"
typepad_status: "Publish"
---

<p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2017d424e0951970c-pi" target="_blank"><img style="background-image: none; border-bottom: 0px; border-left: 0px; margin: 0px 0px 10px 10px; padding-left: 0px; padding-right: 0px; display: inline; float: right; border-top: 0px; border-right: 0px; padding-top: 0px" title="AutoCAD 2014 logo" border="0" alt="AutoCAD 2014 logo" align="right" src="/assets/image_679352.jpg" width="160" height="160" /></a>Today is the official launch of 2014 family of products. AutoCAD 2014 will be available in the coming days to customers around the world. You’ll no doubt find lots of information on the interwebs regarding the product’s features, so I’m going to focus specifically on the opportunities – and requirements – the new release presents to developers.</p>  <p>Firstly, ADN members should refer to the (as ever) thorough information produced by the DevTech team and posted under the “Events” section of the ADN website. I expect the AutoCAD DevBlog will be making much of this available to a broader audience over the coming days/weeks. Be sure to check there often.</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2017c381d8caf970b-pi" target="_blank"><img style="background-image: none; border-right-width: 0px; margin: 20px auto; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="AutoCAD 2014 splash screen" border="0" alt="AutoCAD 2014 splash screen" src="/assets/image_329385.jpg" width="454" height="287" /></a>In today’s post we’ll take a high-level look at AutoCAD 2014 for developers, and then drill into a couple of the specific areas over the coming days/weeks.</p>  <h3>Binary compatible release</h3>  <p>The first thing to mention is that this release is binary application compatible with AutoCAD 2013. (If you’re not sure what this means, <a href="http://through-the-interface.typepad.com/through_the_interface/2006/06/compatibility_o.html" target="_blank">this ancient – at least from this blog’s perspective – post</a> should help.) Applications built for AutoCAD 2013 should just work with AutoCAD 2014. It’s also worth noting that we’re still targeting .NET Framework 4.0 with this release.</p>  <p>Reading between the lines, you should realise that we’re still building AutoCAD 2014 with the C++ compiler provided in Visual Studio 2010, for now (although we’re using the VS 2012 IDE with the 2010 platform toolset, in case that’s of interest to people). </p>  <p>Aside from application compatibility, this is also a DWG compatible release: we’re not changing the DWG file format in AutoCAD 2014.</p>  <h3>Security features</h3>  <p>While it’s true that existing AutoCAD 2013 applications “should just work” with AutoCAD 2014, there’s an important caveat. Building on <a href="http://through-the-interface.typepad.com/through_the_interface/2012/08/service-pack-1-for-autocad-2013.html" target="_blank">concepts originally introduced in AutoCAD 2013 SP 1.1</a>, AutoCAD 2014 has a much more stringent security model in place for applications. This has been introduced to combat the rise of AutoCAD-targeting malware (see <a href="http://au.autodesk.com/?nd=class&amp;session_id=10634" target="_blank">my recent AUv class</a> for some background).</p>  <p>We’ll go into this in more detail in a near-future post, but for now you’re likely to see this dialog when AutoCAD attempts to load a DLL from a location it doesn’t explicitly trust:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2017ee9c0b307970d-pi" target="_blank"><img style="background-image: none; border-bottom: 0px; border-left: 0px; margin: 20px auto; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top: 0px; border-right: 0px; padding-top: 0px" title="Security dialog in AutoCAD 2014" border="0" alt="Security dialog in AutoCAD 2014" src="/assets/image_695626.jpg" width="394" height="180" /></a></p>  <h3><font size="2"><font style="font-weight: normal">There are a number of ways to resolve this (i.e. to stop the dialog from being displayed each time AutoCAD tries to load a module from an untrusted location):</font></font></h3>  <ul>   <li>Use the Autoloader to load the module</li>    <ul>     <li>The Autoloader folders are trusted automatically</li>   </ul>    <li>Make sure the module has been <a href="http://msdn.microsoft.com/en-us/library/ms537361(v=vs.85).aspx" target="_blank">digitally signed</a></li>    <ul>     <li>Authenticode-signed executables are trusted automatically</li>      <ul>       <li>This is not the same as “signing the assembly” in Visual Studio, which refers to the act of assigning a strong name to a .NET assembly</li>     </ul>   </ul>    <li>Add the module’s folder to the TRUSTEDPATHS (or TRUSTEDDOMAINS – see below) system variable</li>    <li>Set SECURELOAD to 0</li>    <ul>     <li>Please do <strong>not</strong> do this: it really does defeat the object and leaves your system open to malware attack</li>   </ul> </ul>  <h3>JavaScript API</h3>  <p>This, for me, is the “big ticket” item for this year’s release (from a developer perspective, of course). With it being the “lingua franca” of the web (including the mobile web and increasingly the world of cross-platform development), JavaScript is the latest programming language to be enabled to work with AutoCAD. I, for one, welcome our new web-centric overlords!</p>  <p>Just as with the introduction of AutoCAD’s .NET API, back in AutoCAD 2005, we weren’t “done” in just one release. The first release of <a href="http://www.autocadws.com/jsapi/v1/docs/index.html" target="_blank">the JavaScript API</a> has been implemented with very focused goals, to allow you to:</p>  <ul>   <li>Drive “in canvas” user interface activities, such as querying for user input and displaying transient graphics</li>    <li>Manipulate the current view: zoom, pan, switch Visual Style, etc.</li>    <li>Implement “out of canvas” user interface dialogs via HTML5 that connect back to AutoCAD via JavaScript</li> </ul>  <p>The Design Feed feature inside AutoCAD makes use of this new capability, so we’re “drinking our own champagne” (apparently another – more polite, vegetarian compatible? – way of saying “<a href="http://en.wikipedia.org/wiki/Eating_your_own_dog_food" target="_blank">eating your own dog food</a>”) with this API from day one.</p>  <p>So how do these goals translate to exposure of individual parts of AutoCAD’s core object model? Here are the pieces targeted in the V1 release:</p>  <ul>   <li>Prompts</li>    <li>Transient graphics and input</li>    <li>Dragger (e.g. Jigs)</li>    <li>View manipulation</li>    <li>Commands</li>    <li>Windows</li>    <li>Drawing object operations and events</li>    <li>Bindable Object Layer (BOL)</li>    <li>Application object (miscellaneous properties)</li> </ul>  <p>You’ll be able to use these capabilities inside a JavaScript file or HTML page and load it inside AutoCAD using the new WEBLOAD command, Application.LoadJSScript() from .NET or acjsLoadJSScript() from ObjectARX.</p>  <p>That said, the way you’re most likely to implement JavaScript functionality in this release of AutoCAD is to implement an HTML5 palette that can be loaded into AutoCAD via a new overload of the PaletteSet.Add() method (one which now takes a URI parameter). You’ll need a local module (.NET or ObjectARX) to load the palette by calling this API method, but the UI itself can be hosted elsewhere and therefore be updated more easily.</p>  <p>If dealing with standard modal/modeless windows, you’ll use a different protocol:</p>  <ul>   <li>In .NET: new overloads for the Application class methods, ShowModalWindow() and ShowModelessWindow()</li>    <li>In ObjectARX: acedShowHTMLModalWindow(), acedShowHTMLModelessWindow() and acedAddHTMLPalette()</li>    <li>In LISP: (showHTMLModalWindow) [as it only deals with modal UI]</li> </ul>  <p>Now as a V1 implementation, there are certainly holes in <a href="http://www.autocadws.com/jsapi/v1/docs/contents.html" target="_blank">the API coverage</a>. If you want to fill these, as a stop-gap, you can implement additional capabilities in .NET (using the JavaScriptCallback attribute to mark a method accordingly) or ObjectARX (using acjsDefun()) and then call them from JavaScript. The functions get called with a JSON fragment containing any arguments being passed. We’ll look at this mechanism in more detail in a future post.</p>  <p>Because it’s now possible to host such program content on the web – and not in a local folder – we’ve added the TRUSTEDDOMAINS sysvar (which is analogous to TRUSTEDPATHS for the local system) to enable specific internet domains to be marked as trusted. This URL list is not accessible via the OPTIONS dialog, but you can append to it easily via LISP [e.g. (setvar &quot;TRUSTEDDOMAINS&quot; (strcat (getvar &quot;TRUSTEDDOMAINS&quot;) &quot;;through-the-interface.typepad.com&quot;)) ] or via the Registry.</p>  <p>While the JavaScript API allows us to provide a more convenient protocol for certain operations – such as Acad.Editor.CurrentViewport.zoomWindow(pt1, pt2, true) to perform a Zoom Window with an animated view transition – even in addition to the ability to host content centrally it’s not enough to justify the development and introduction of a new API. The plan is to take this API technology beyond the desktop, at some point in the future. Exciting times!</p>  <h3>GeoLocation API</h3>  <p>The AutoCAD Map 3D team has implemented a key feature in AutoCAD 2014, allowing drawings to be geo-referenced. ObjectARX and .NET APIs (via the AcDbGeoData and GeoLocationData classes, respectively) have been provided that allow you to add geo-location information into an AutoCAD drawing.</p>  <p>Various properties exist that allow you to define the mapping between drawing coordinates and the real-world. Again, we’ll take a closer look at this capability in a future post.</p>  <h3>VBA 7.1</h3>          <p>In AutoCAD 2014 we’ve upgraded the core VBA version from 6.3 to 7.1. VBA is still being provided as a separate download, but this version now provides native support for 64-bit Windows.</p>  <p>We’ve been telling developers for some time to move from VBA to .NET, mainly as Microsoft’s investment in VBA was far from    <br />clear (and the performance that was possible when using VBA 6.3 on a 64-bit OS was poor).</p>  <p>New life has now been breathed into the technology, which is good news, although – based on the information that was available at the time – many people have invested significant effort into porting away from it. We still see .NET as a better platform for professional, Windows-centric development, so I hope people don’t consider this effort to have been wasted.</p>  <h3>Summary</h3>  <p>That’s it for this quick introduction to the developer-centric capabilities in AutoCAD 2014. In the coming posts we’ll dig into the JavaScript API, defining a simple command using JavaScript before creating a simple HTML5 dialog that we’ll load into an AutoCAD palette.</p>
