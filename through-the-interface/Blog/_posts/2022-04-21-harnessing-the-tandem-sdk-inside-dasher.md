---
layout: "post"
title: "Harnessing the Tandem SDK inside Dasher"
date: "2022-04-21 16:02:00"
author: "Kean Walmsley"
categories:
  - "APS (Forge)"
  - "Autodesk Research"
  - "IoT"
original_url: "https://www.keanw.com/2022/04/harnessing-the-tandem-sdk-inside-dasher.html "
typepad_basename: "harnessing-the-tandem-sdk-inside-dasher"
typepad_status: "Publish"
---

<p>Back in September we started the work to integrate the (currently still internal) SDK for Autodesk Tandem into <a href="https://dasher360.com" target="_blank">Project Dasher</a>. This is what I’ve referred to, in the past, as “<a href="https://www.keanw.com/2021/11/getting-ready-for-tandem-a-call-to-action-for-forge-developers.html" target="_blank">Tandem inside Dasher</a>” (as opposed to “<a href="https://www.keanw.com/2021/11/want-to-see-dasher-inside-tandem-tell-us-what-you-need.html" target="_blank">Dasher inside Tandem</a>”).</p><p>The work hasn’t been happening constantly: it’s been intermittent, as changes were needed to both Tandem and the core Forge viewer to support certain workflows. I’m happy to say that, as of this week, the integration is pretty close to having parity with the version based on the traditional Forge viewer, with a few gaps that should be filled in over the coming months. This work isn’t intended for public consumption, to be clear: it was to better align Dasher with the Tandem platform but also to test out a few key component integrations.</p><p>Here’s a quick run-down of the capabilities we’ve (re-)implemented using the Tandem SDK.</p><p>We started by getting all the level and room information from Tandem, as opposed to having these defined manually in the project settings. So the breadcrumbs and building navigation panel are driven purely by the data coming from Tandem. This greatly simplifies project setup, and also means we can very easily tweak level assignment options inside the Tandem application rather than having to do this work inside Revit and re-exporting/re-translating in Forge.</p><p><a href="https://through-the-interface.typepad.com/.a/6a00d83452464869e2027880780307200d-pi"><img alt="Levels from Tandem in Dasher" height="281" src="/assets/image_2873.jpg" style="margin: 30px auto; float: none; display: block;" title="Levels from Tandem in Dasher" width="500" /></a></p><p>The next big piece of work related to sensor dots. As you may have seen in the product demo from <a href="https://www.keanw.com/2022/03/the-recording-of-the-march-tandem-webinar.html" target="_blank">the March 2022 Tandem webinar</a>, the Tandem team have implemented a new approach that clusters sensor dots according to proximity. This is a parallel mechanism to the <a href="https://forge.autodesk.com/en/docs/dataviz/v1/developers_guide/introduction/overview/" target="_blank">Data Visualization Extension’s</a> sprites, and we’ll see how/whether the two converge, over time.</p><p><a href="https://through-the-interface.typepad.com/.a/6a00d83452464869e202942fa5bff7200c-pi"><img alt="Tandem sensor dots in Dasher" height="281" src="/assets/image_806930.jpg" style="margin: 30px auto; float: none; display: block;" title="Tandem sensor dots in Dasher" width="500" /></a></p><p>An interesting side note: the Tandem “stream markers” are implemented using SVG elements that are placed in the DOM. This is conceptually pretty similar to what we had in Dasher a few years ago: we switched across to use a GPU-rendered point cloud to help with scalability, when we had to display thousands of sensor locations. The Tandem team have elegantly side-stepped this issue by implementing clustering, which means that you’re very unlikely to see thousands of sensors at a time, as they will cluster together when zoomed out. It doesn’t mean that they won’t end up using a GPU-centric approach, of course: there are definitely pros and cons in terms of performance, styling flexibility, etc., but this initial implementation certainly seems to work well for now.</p><p>There are still some things to work out around sensors dots: we control visibility via filtering based on types, etc., so need more control over that, but also need to wire up events for hover (to display tooltips) and click (to show data graphs), but this is a good start, for sure.</p><p>The last big piece of work was around surface shading. The main issue with implementing this was around the fact the Forge viewer Data Visualization Extension worked with rooms coming from a central model: as mentioned in a previous post, Tandem inherently works with multiple models loaded into the viewer, and you can’t assume that only one of them will source the room objects for surface shading.</p><p>The Forge team integrated support for multiple model surface shading in v7.60 of the viewer. This means there’s an additional model option you can pass to <a href="https://forge.autodesk.com/en/docs/dataviz/v1/reference/Core/DataVisualization/#setupsurfaceshading-model-shadingdata-options" target="_blank">setupSurfaceShading()</a>, <a href="https://forge.autodesk.com/en/docs/dataviz/v1/reference/Core/DataVisualization/#rendersurfaceshading-nodeids-sensortype-valuecallback-heatmapconfig" target="_blank">renderSurfaceShading()</a>,&#0160; <a href="https://forge.autodesk.com/en/docs/dataviz/v1/reference/Core/DataVisualization/#updatesurfaceshading-valuecallback-heatmapconfig" target="_blank">updateSurfaceShading()</a> and <a href="https://forge.autodesk.com/en/docs/dataviz/v1/reference/Core/DataVisualization/#registersurfaceshadingcolors-sensortype-colors-alpha" target="_blank">registerSurfaceShadingColors()</a>.</p><p>This is now working well:</p><p><a href="https://through-the-interface.typepad.com/.a/6a00d83452464869e20282e1509b28200b-pi"><img alt="Surface shading in Dasher with Tandem" height="281" src="/assets/image_57746.jpg" style="margin: 30px auto; float: none; display: block;" title="Surface shading in Dasher with Tandem" width="500" /></a></p><p>I’m really happy with how things have come together, and that we now have an implementation of Dasher that makes use of the Tandem platform for key capabilities. We’ll be keeping this in sync with the work being done by the Tandem team – they’re working at a pretty aggressive pace to implement new features – and it’ll continue to be a useful test integration for the Tandem platform.</p><p><em>A big thanks to the Tandem team for their support getting this implementation working, in particular to James Awe (for the core SDK), to Manuel Wellman (for sensor dots) and Traian Stanev (for digging into a number of issues including surface shading). And to the Forge viewer team for promptly implementing support for multiple models in the Data Visualization Extension, of course.</em></p>
