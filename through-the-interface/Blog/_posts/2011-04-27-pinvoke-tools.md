---
layout: "post"
title: "P/Invoke tools"
date: "2011-04-27 10:35:19"
author: "Kean Walmsley"
categories:
  - "Visual Studio"
original_url: "https://www.keanw.com/2011/04/pinvoke-tools.html "
typepad_basename: "pinvoke-tools"
typepad_status: "Publish"
---

<p>The topic of P/Invoke came up this morning in a discussion with Stephen Preston and Viru Aithal. Stephen mentioned a couple of interesting P/Invoke-related tools he’d stumbled upon, and Viru pointed me at an interesting technique he’d used for P/Invoking unmanaged member functions.</p>  <p>In this post I’ll present the tools, in a later post I’ll show Viru’s code.</p>  <p>The first tool is <a href="http://www.red-gate.com/products/dotnet-development/pinvoke" target="_blank">the PInvoke Visual Studio Add-in</a> from <a href="http://www.red-gate.com" target="_blank">Red Gate Software</a> (the UK-based provider of various development tools, including Reflector Pro). It appears to be a Visual Studio Add-in for VS2003 and 2005 (I can’t see an update for VS2008 or 2010, which also means I can’t try it). The tool provides simplified access to the excellent <a href="http://pinvoke.net" target="_blank">PInvoke.net</a> website, to which I often refer when developing .NET apps. I don’t actually use <em>that</em> many P/Invoke statements that I feel I need an Add-In, though – which is perhaps why the add-in doesn’t appear to have been updated for more recent Visual Studio versions – but it seemed worth mentioning.</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2015431f994fc970c-pi" target="_blank"><img style="background-image: none; border-right-width: 0px; margin: 10px 0px; padding-left: 0px; padding-right: 0px; display: inline; float: left; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="PInvoke Visual Studio Add-in menu item" border="0" alt="PInvoke Visual Studio Add-in menu item" align="left" src="/assets/image_587541.jpg" width="242" height="162" /></a><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2015431f99510970c-pi" target="_blank"><img style="background-image: none; border-right-width: 0px; margin: 10px 0px 10px 10px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="PInvoke Visual Studio Add-in dialog" border="0" alt="PInvoke Visual Studio Add-in dialog" src="/assets/image_609172.jpg" width="212" height="163" /></a></p>  <p align="left">The second – in my opinion more interesting – tool is <a href="http://blogs.msdn.com/b/vbteam/archive/2008/03/14/making-pinvoke-easy.aspx" target="_blank">the P/Invoke Interop Assistant</a> (here’s <a href="http://msdn.microsoft.com/en-us/magazine/cc164193.aspx" target="_blank">a more in-depth article</a>, <a href="http://clrinterop.codeplex.com/" target="_blank">the CodePlex hosting site</a> and <a href="http://channel9.msdn.com/posts/funkyonex/The-P-Invoke-Interop-Assistant/" target="_blank">a Channel 9 interview with one of the authors</a>). This tool generates P/Invoke signatures for use from C# and VB.NET, as well as the ability to determine the P/Invoke signatures used in compiled binaries:</p>  <ul>   <li>Generating P/Invoke declarations while searching for commonly-used (presumably Win32) functions, structures, messages, etc.      <ul>       <li>This seems the more useful capability, in my opinion.</li>     </ul>   </li> </ul>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2014e881a2c7b970d-pi" target="_blank"><img style="background-image: none; border-right-width: 0px; margin: 0px auto; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="SigImp Search" border="0" alt="SigImp Search" src="/assets/image_179326.jpg" width="404" height="244" /></a></p>  <ul>   <li>Translating C code snippets into equivalent P/Invoke declarations.     <ul>       <li>May be useful, but not for most “pure” .NET developers.</li>     </ul>   </li> </ul>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2014e881a2c94970d-pi" target="_blank"><img style="background-image: none; border-right-width: 0px; margin: 0px auto; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="SigImp Translate Snippet" border="0" alt="SigImp Translate Snippet" src="/assets/image_546861.jpg" width="404" height="244" /></a></p>  <ul>   <li>Reverse-engineers the C/C++ method declaration used within managed binaries.     <ul>       <li>An interesting intellectual exercise, perhaps (and potentially interesting information for some), but I can’t imagine needing to use this, myself.</li>     </ul>   </li> </ul>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201538e268c19970b-pi" target="_blank"><img style="background-image: none; border-right-width: 0px; margin: 0px auto; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="SigExp" border="0" alt="SigExp" src="/assets/image_231567.jpg" width="404" height="244" /></a></p>  <p>The tool has been around for a while, but I hope some of you find the information in this post useful (it was certainly news to me). Does anyone else use a P/Invoke tool they’d like to share with this blog’s readership?</p>
