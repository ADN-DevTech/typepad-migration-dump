---
layout: "post"
title: "Testing truth"
date: "2010-02-08 06:40:00"
author: "Kean Walmsley"
categories:
  - "AutoCAD .NET"
  - "ObjectARX"
  - "Visual Basic &amp; VBA"
  - "Visual Studio"
original_url: "https://www.keanw.com/2010/02/testing-truth.html "
typepad_basename: "testing-truth"
typepad_status: "Publish"
---

<p><em>This is a minor </em><a href="http://en.wikipedia.org/wiki/Pet_peeve"><em>pet peeve</em></a><em> of mine that I felt like sharing. Feel free to post a comment if you agree, disagree or have your own pet coding peeve to share with other readers of this blog.</em></p>
<p>I quite often see .NET code that tests for the value of a <a href="http://en.wikipedia.org/wiki/Boolean_data_type">Boolean</a> to see whether it’s true or false:</p>
<div style="FONT-FAMILY: courier new; BACKGROUND: white; COLOR: black; FONT-SIZE: 8pt">
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> (booleanVariable == </span><span style="LINE-HEIGHT: 140%; COLOR: blue">true</span><span style="LINE-HEIGHT: 140%">)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">{</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; …</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">}</span></p></div>
<p>or</p>
<div style="FONT-FAMILY: courier new; BACKGROUND: white; COLOR: black; FONT-SIZE: 8pt">
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%; COLOR: blue">If</span><span style="LINE-HEIGHT: 140%"> isBooleanFunction() = </span><span style="LINE-HEIGHT: 140%; COLOR: blue">False</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">Then</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; …</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%; COLOR: blue">End</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">If</span></p></div>
<p>Now while not strictly incorrect, this style is, at least, redundant: a Boolean is by nature true or false, and testing for equality with another Boolean returns a Boolean.</p>
<p>I personally prefer to use this:</p>
<div style="FONT-FAMILY: courier new; BACKGROUND: white; COLOR: black; FONT-SIZE: 8pt">
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> (booleanVariable)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">{</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; …</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">}</span></p></div>
<p>or</p>
<div style="FONT-FAMILY: courier new; BACKGROUND: white; COLOR: black; FONT-SIZE: 8pt">
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%; COLOR: blue">If</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">Not</span><span style="LINE-HEIGHT: 140%">(isBooleanFunction()) </span><span style="LINE-HEIGHT: 140%; COLOR: blue">Then</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; …</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%; COLOR: blue">End</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">If</span></p></div>
<p>Now I’m fully aware I’m taking a purist’s perspective on this: when you take a look at the underlying <a href="http://en.wikipedia.org/wiki/Common_Intermediate_Language">IL</a> created by Visual Studio (something <a href="http://through-the-interface.typepad.com/through_the_interface/2010/02/debugging-into-autocads-net-api-layer-using-reflector-part-1.html">you can do very easily with .NET Reflector 6</a>) there is absolutely no difference in the generated code – the additional test is optimized out - but even if there’s no impact from an efficiency perspective (and the additional source code bytes don’t eat up a huge amount of hard-drive capacity) it just feels inelegant. Sorry.</p>
<p>There are interesting historical reasons for explicit testing, though, which I’d like to mention. Back before C++ had a native Boolean data-type – and this is still true of C – Booleans were represented as integers which would usually be generated by a pre-processor symbol (such as via Win32’s TRUE and FALSE) or by an enumeration (such as ObjectARX’s Adesk::kTrue and kFalse). So you would have to test for equality explicitly:</p>
<div style="FONT-FAMILY: courier new; BACKGROUND: white; COLOR: black; FONT-SIZE: 8pt">
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> (booleanVariable == Adesk::kTrue)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">{</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; …</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">}</span></p></div>
<p>As C’s (and therefore C++’s – but not C#’s) <a href="http://msdn.microsoft.com/en-us/library/fh88ctk1.aspx">if statement</a> checks for whether the expression passed in is non-zero, it’s in practice probably just fine not to care about the comparison with Adesk::True, but that would make a potentially dangerous assumption about the values of true and false, which isn’t a good idea (things can change, as we’ll see below :-). C# is different: if you try to pass a numeric expression into an if statement the compiler will ask for a Boolean, as that’s the appropriate native type.</p>
<p>So is truth relative or absolute? Here’s an interesting language quirk that can occasional cause the odd, subtle error: most modern languages who provide the concept of mapping Booleans to integers – perhaps because that’s what they use to implement them - work on the principle that false is 0 and true is non-zero, usually defaulting to 1. Visual Basic (prior to .NET) was different (and presumably this is still true of VBA): false was indeed 0 but the <em>default</em> value for true was –1. This quirk was rationalised out at the introduction of VB.NET, but still causes the odd migration problem if code makes the mistake of depending on absolute truth. :-)</p>
<p>Another interesting aside, as you will sometimes come across code like this… when I was writing C++ code regularly, I’d often invert the sides of the equality test to avoid a subtle class of error (this is a technique I learned from a colleague many years ago):</p>
<div style="FONT-FAMILY: courier new; BACKGROUND: white; COLOR: black; FONT-SIZE: 8pt">
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> (Adesk::kTrue == booleanVariable)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">{</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; …</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">}</span></p></div>
<p>The reason for the inversion is that if you happen to omit one of the <a href="http://en.wikipedia.org/wiki/Equals_sign">equals signs</a> (which is quite a common typo to make, especially if you also code in languages that use a single equals sign for testing equality), the C++ compiler will at least tell you there’s an error, as you’re attempting to assign to an <a href="http://en.wikipedia.org/wiki/Value_(computer_science)">r-value</a> (which comes from the fact it typically belongs to the right side of an equation rather than the left… l-values are assignable but not r-values). So as a force of habit I would start with the value we’re checking against, to avoid this problem.</p>
<p>It turns out there’s less risk of hitting this kind of issue if you’re coding in C#, at least (I haven’t checked modern C++ compilers), at least here you get a helpful warning message:</p>
<p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201287772aeaa970c-pi"><img alt="A helpful warning message" border="0" height="68" src="/assets/image_395.jpg" style="BORDER-RIGHT-WIDTH: 0px; DISPLAY: inline; BORDER-TOP-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px" title="A helpful warning message" width="485" /></a>&#0160;</p>
<p>Alright, that’s it for today. Thanks for indulging my little rant and please do post a comment if you have something to add.</p>
