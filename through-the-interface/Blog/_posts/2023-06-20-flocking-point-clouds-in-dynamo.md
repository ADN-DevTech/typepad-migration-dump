---
layout: "post"
title: "Flocking point clouds in Dynamo"
date: "2023-06-20 09:01:21"
author: "Kean Walmsley"
categories:
  - "Dynamo"
  - "Point clouds"
  - "VASA"
original_url: "https://www.keanw.com/2023/06/flocking-point-clouds-in-dynamo.html "
typepad_basename: "flocking-point-clouds-in-dynamo"
typepad_status: "Publish"
---

<p>I was thrilled to see a <a href="https://www.linkedin.com/feed/update/urn:li:activity:7076121521500405760/" target="_blank">post by Long Nguyen</a> over the weekend announcing his publication of a Dynamo package called WhatTheFlock – with <a href="https://github.com/LongNguyenP/WhatTheFlock" target="_blank">full source code</a> – that implements a <a href="https://en.wikipedia.org/wiki/Boids" target="_blank">Boids</a>-like flocking simulation. This work is significant not because ornithologists will use Dynamo to predict or simulate <a href="https://en.wiktionary.org/wiki/murmuration" target="_blank">murmurations</a> (although that in itself is a fun thought) but because Long has demonstrated a valuable technique that might be used to implement other arguably more useful types of multi-agent simulation inside Dynamo.</p><p>Long is using a background process to perform calculations before rendering the results into the Dynamo window. A really useful and interesting pattern.</p><p align="center"><br></p><p align="center"><iframe width="500" height="283" title="YouTube video player" src="https://www.youtube.com/embed/QHL_f3soUxM" frameborder="0" allowfullscreen="" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"></iframe></p><p><br></p><p>My first thought on seeing the flocking agents placed randomly in a cube was “wouldn’t it be cool to be able to set their positions from a point cloud?” I could just imagine scans of spaces erupting into flocks of birds. Again, not especially useful, but lots and lots of fun.</p><p>I posted the suggestion in <a href="https://www.linkedin.com/feed/update/urn:li:activity:7076121521500405760?commentUrn=urn%3Ali%3Acomment%3A%28activity%3A7076121521500405760%2C7076180453560332288%29&amp;dashCommentUrn=urn%3Ali%3Afsd_comment%3A%287076180453560332288%2Curn%3Ali%3Aactivity%3A7076121521500405760%29" target="_blank">a comment</a> and Long was quick to implement the ability to specify initial agent positions and directions in v 1.0.1 of the package.</p><p>I dusted off some code that Rhys Goldstein had originally written to read in points from an ASCII-based PTS file (one of the simpler but least efficient point cloud formats) and used that to read in the initial locations from a classic sample point cloud of the Stanford bunny. I integrated this into the sample WhatTheFlock.dyn file Long provided with the package.</p><p><a href="https://through-the-interface.typepad.com/.a/6a00d83452464869e202c1a6cb2ea2200b-pi" target="_blank"><img width="500" height="312" title="WhatTheFlockingBunny" style="margin: 30px auto; border-image: none; float: none; display: block; background-image: none;" alt="WhatTheFlockingBunny" src="/assets/image_198436.jpg" border="0"></a></p><p>This was a good start – and it worked well enough with this file – but I really wanted something more “architectural”. The best I could do at short notice was to translate <a href="https://www.recon-3d.com/sample-data?pgid=l41vjbnx-9c413796-0e51-4674-8f08-fd9377406eb4" target="_blank">an e57 file of an outdoor oven</a> into a PTS file. Here’s the original file, loaded into <a href="https://www.cloudcompare.org/" target="_blank">CloudCompare</a>:</p><p><a href="https://through-the-interface.typepad.com/.a/6a00d83452464869e202c1a6cbca13200b-pi" target="_blank"><img width="501" height="298" title="Outdoor oven in Cloud Compare" style="margin: 30px auto; border: 0px currentcolor; border-image: none; float: none; display: block; background-image: none;" alt="Outdoor oven in Cloud Compare" src="/assets/image_699538.jpg" border="0"></a></p><p>I could then save it as a space-separated PTS file that could be read into Dynamo.</p><p><a href="https://through-the-interface.typepad.com/.a/6a00d83452464869e202b751a8a500200c-pi" target="_blank"><img width="500" height="312" title="WhatTheFlockingOven" style="margin: 30px auto; border: 0px currentcolor; border-image: none; float: none; display: block; background-image: none;" alt="WhatTheFlockingOven" src="/assets/image_322396.jpg" border="0"></a></p><p>If you want to see how the package works with these two point clouds without trying it for yourself, here’s a video I recorded.</p><p align="center"><br></p><p align="center"><iframe width="500" height="283" title="YouTube video player" src="https://www.youtube.com/embed/rLQa8lfwZUE" frameborder="0" allowfullscreen="" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"></iframe></p><p><br></p><p><a href="https://through-the-interface.typepad.com/files/WhatTheFlockingPointClouds.zip" target="_blank">Here’s a ZIP file containing the two point cloud files along with the Dynamo graphs</a> that load and run them (they should just work if you extract them to the same folder). The oven model weighed in at a whopping 192 MB when uncompressed, which means the archive is chunkier than it otherwise might be at a little over 60 MB. The graphs are basically the same but have different options for the two files: for instance, you’ll see some logic in the graph that helps chooses a subset of the point cloud to extract – otherwise the number of points is too high – but you can play with the sliders to get things working well for you on your system.</p><p>As I mentioned at the start of this post: this approach has great potential to be used for integrating other types of simulation into Dynamo. I fully expect us to use this approach when representing results of spatial analyses performed using <a href="https://keanw.com/VASA" target="_blank">VASA</a>, for instance. Many thanks to Long for this valuable contribution to the Dynamo community!</p>
