---
layout: "post"
title: "Building an Installer &ndash; Part 3"
date: "2010-09-17 21:50:00"
author: "Kean Walmsley"
categories:
  - "AutoCAD"
  - "AutoCAD .NET"
  - "Installation"
  - "User interface"
  - "Visual Studio"
original_url: "https://www.keanw.com/2010/09/building-an-installer-part-3.html "
typepad_basename: "building-an-installer-part-3"
typepad_status: "Publish"
---

<p>In <a href="http://through-the-interface.typepad.com/through_the_interface/2010/09/building-an-installer-part-1.html" target="_blank">the first part</a> in this series, we looked at getting our basic installer to install files and in <a href="http://through-the-interface.typepad.com/through_the_interface/2010/09/building-an-installer-part-2.html" target="_blank">the second part</a> we focused on checking and modifying the Registry. In this part we’re going to finish up our installer by tweaking the user interface.</p>  <p>Let’s get started with some fundamentals: the name of the MSI file itself. This can be modified via the Installer project’s property page (which I pulled up by right-clicking the project in the Solution Explorer and selecting “Properties”):</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2013487736c1a970c-pi"><img style="border-right-width: 0px; margin: 20px auto; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="Change the MSI name" border="0" alt="Change the MSI name" src="/assets/image_424690.jpg" width="361" height="257" /></a></p>  <p>A pretty simple one, but one that’s worth making, nonetheless. Let’s go ahead and spruce up our installer’s look &amp; feel.</p>  <p>When we run the installer we’ve created, we can see it looks pretty boring:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2013487736c30970c-pi"><img style="border-right-width: 0px; margin: 20px auto; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="First page of our installer" border="0" alt="First page of our installer" src="/assets/image_162261.jpg" width="261" height="213" /></a> There’s something about that banner logo that makes me think of the early 1990s (at least it doesn’t have a floppy disk on it, I suppose :-). Luckily it’s easy enough to change.</p>  <p>We’ll start by viewing our user interface options:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e20133f45412ca970b-pi"><img style="border-right-width: 0px; margin: 20px auto; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="View the user interface options" border="0" alt="View the user interface options" src="/assets/image_98624.jpg" width="297" height="291" /></a>From here we can see a node in the tree for each of our installation wizard’s pages, each of which has one or more properties associated:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2013487736cda970c-pi"><img style="border-right-width: 0px; margin: 20px auto; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="Our user interface options with the BannerBitmap property" border="0" alt="Our user interface options with the BannerBitmap property" src="/assets/image_471140.jpg" width="437" height="372" /></a>We can change the BannerBitmap property by browsing to a JPG or BMP on the local file system for our updated banner. Here’s my effort, which I’m actually pretty pleased with:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2013487736cff970c-pi"><img style="border-right-width: 0px; margin: 20px auto; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="Installer banner" border="0" alt="Installer banner" src="/assets/image_87771.jpg" width="485" height="70" /></a>When we add it into the project, the file gets added automatically to the install-set – but is <strong>excluded</strong>, which means that it gets installed to the selected folder for the duration of the install (or is held in memory and accessed from there – either way, the end result is that it’s not left behind on the user’s hard drive once installation has completed). [In the final installer, which you’ll be able to download from the link at the end, I’ve included this image in the Installer project source, so that people can rebuild it, if they so choose. So I’ve ended up not excluding this particular file in this final installer.]</p>  <p>We should change this on each of our installer’s pages (and I don’t know of a way to streamline this – I changed it on every single one).</p>  <p>Here’s the page for the Installation Folder settings. If you have perfect recall – and actually read it – then you will remember me saying in the previous post that we were going to specify “Just Me” as the only option, and remove the radio button enabling this selecting. We can make that UI change on this page, too:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e20133f454137b970b-pi"><img style="border-right-width: 0px; margin: 20px auto; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="Installation folder page properties" border="0" alt="Installation folder page properties" src="/assets/image_981619.jpg" width="166" height="172" /></a> While we remember, we should make sure the default project setting (which will no longer be visible) should be “Just Me”. That’s the default, if I recall correctly, but you can double check in the Installer project’s properties:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e20133f45413a5970b-pi"><img style="border-right-width: 0px; margin: 20px auto; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="Making sure the install is just for me" border="0" alt="Making sure the install is just for me" src="/assets/image_5805.jpg" width="222" height="301" /></a>While we’re on this page, we might as well make sure a few other things have been changed, such as the Manufacturer (to avoid the “, Inc.” being added to our install path) as well as the Product Name and the Title. All these little changes lead to a much more professional-looking installer.</p>  <p>Once you’ve updated the BannerBitmap for all your various pages, you should be ready to go.</p>  <p>Here are the various pages of the final installer:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e20133f45413c4970b-pi"><img style="border-right-width: 0px; margin: 20px auto; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="First page of our prettier installer" border="0" alt="First page of our prettier installer" src="/assets/image_168821.jpg" width="260" height="213" /></a><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e20133f45413d8970b-pi"><img style="border-right-width: 0px; margin: 20px auto; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="Select the installation location" border="0" alt="Select the installation location" src="/assets/image_422524.jpg" width="260" height="212" /></a></p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e20133f45413e8970b-pi"><img style="border-right-width: 0px; margin: 20px auto; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="And we confirm" border="0" alt="And we confirm" src="/assets/image_608259.jpg" width="260" height="212" /></a><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e20133f4541400970b-pi"><img style="border-right-width: 0px; margin: 20px auto; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="Our progress" border="0" alt="Our progress" src="/assets/image_109712.jpg" width="260" height="212" /></a><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2013487736d8d970c-pi"><img style="border-right-width: 0px; margin: 20px auto; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="Our progress 2" border="0" alt="Our progress 2" src="/assets/image_278615.jpg" width="260" height="212" /></a> <a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2013487736daa970c-pi"><img style="border-right-width: 0px; margin: 20px auto; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="Installation is complete" border="0" alt="Installation is complete" src="/assets/image_882412.jpg" width="260" height="212" /></a> And should we choose to repair or remove the application, we will see the same look and feel:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2013487736e13970c-pi"><img style="border-right-width: 0px; margin: 20px auto; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="Repair or remove the application" border="0" alt="Repair or remove the application" src="/assets/image_486288.jpg" width="260" height="212" /></a> One last change is to update the Programs &amp; Features icon, visible via our control panel. For this we go back to the Installer project’s properties and select “Browse” for the AddRemoveProgramsIcon property. Once we select a file – and I chose the <em>Browser.ico</em> file from the Browser project – it gets added to the install set, but is not going to be excluded: this icon needs to remain accessible while the application is installed, so will remain in the Application folder (or wherever you choose to add it).</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2013487736e54970c-pi"><img style="border-right-width: 0px; margin: 20px auto; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="Our Programs and Features icon" border="0" alt="Our Programs and Features icon" src="/assets/image_359002.jpg" width="395" height="304" /></a></p>  <p>That’s it for this series. If you’re interested in trying the final installer, <a href="http://through-the-interface.typepad.com/files/BrowsePhotosynth.msi" target="_blank">here it is</a>. I’ve made a few late changes – such as updating RegDL to support some local logging (I plan on posting the updated source for RegDL sometime next week). You’ll find the installer creates a Source sub-folder beneath the installed program folder, where you should be able to find the fully-buildable project: I also had some hoops to jump through to make sure this project builds once it’s installed, so that’s another area where the final project differs from what I’ve documented here: if you have any questions, just post a comment.</p>  <p>The same also goes for all you installer experts, out there: there may well be “gotchas” that this implementation doesn’t address adequately, in which case please do let me know.</p>
