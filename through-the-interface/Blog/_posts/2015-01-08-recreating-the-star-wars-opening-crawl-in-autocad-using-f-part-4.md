---
layout: "post"
title: "Recreating the Star Wars opening crawl in AutoCAD using F# &ndash; Part 4"
date: "2015-01-08 19:22:18"
author: "Kean Walmsley"
categories:
  - "AutoCAD"
  - "AutoCAD .NET"
  - "Drawing structure"
  - "F#"
  - "Geometry"
  - "Graphics system"
original_url: "https://www.keanw.com/2015/01/recreating-the-star-wars-opening-crawl-in-autocad-using-f-part-4.html "
typepad_basename: "recreating-the-star-wars-opening-crawl-in-autocad-using-f-part-4"
typepad_status: "Publish"
---

<p>Happy Friday! It’s time to unveil the completed Star Wars opening crawl inside AutoCAD…</p>  <p>After an <a href="http://through-the-interface.typepad.com/through_the_interface/2015/01/recreating-the-star-wars-opening-crawl-in-autocad-using-f-part-1.html" target="_blank">intro</a> and seeing <a href="http://through-the-interface.typepad.com/through_the_interface/2015/01/recreating-the-star-wars-opening-crawl-in-autocad-using-f-part-2.html" target="_blank">various</a> <a href="http://through-the-interface.typepad.com/through_the_interface/2015/01/recreating-the-star-wars-opening-crawl-in-autocad-using-f-part-3.html" target="_blank">pieces</a> implemented, in today’s post we’re going to add the crawl text and animate its movement into the distance.</p>  <ol>   <li>The initial blue text </li>    <li>The theme music </li>    <li>The star field </li>    <li>The disappearing Star Wars logo </li>    <li><strong>The crawling text</strong> <!--EndFragment--></li> </ol>  <p>As the surprise “bonus” item 6, I decided to add a planet and – at the end of the crawl – shift the view downwards to show its surface: an effect I’ve seen in the opening crawl for at least one of the films (I forget which). The effect took me some work to get it looking right. If you run the code, try orbiting the view to see the relative positions… I ended up having to both pan and orbit to get effect I wanted. The planet itself could look better: I would have liked to give the surface some texture and even a translucent atmosphere, and some of the stars appear in the foreground… but you have to stop somewhere.</p>  <p>It’s in this post that we’ll finally use the <a href="http://swapi.co" target="_blank">Star Wars API</a> to get the opening crawl text for the various episodes. We’ll ask the user to choose the episode to display, and get the text associated with that (although as the API understandably lists the films in order of cinematic release rather than the internal chronology, we get the data for all the films and select the text for the one with the matching episode number).</p>  <p>There isn’t very much to the whole thing: we create the crawl text based on what’s provided by the API, adding in some text for the episode number (in roman numerals) and title. The effect is OK: I struggled for some time to get the exact angle as used in the films, but didn’t quite manage it. Once again the speed of the crawl is likely to vary per-system – I haven’t taken the time or effort to get this to synchronise the timing perfectly for different hardware profiles.</p>  <p>Without further ado, here are videos of all six opening crawls. Yes, during a lull in my day I went ahead and captured all of them. The only difference between them is the crawl text contents: feel free to choose your favourite episode and just watch that. :-)</p>  <p>[Apologies for any advertising that pops up as you're watching: YouTube cleverly noticed the use of the (copyrighted) Star Wars theme music in the video, so I acknowledged the 3rd party content, giving the owner the right to remunerate people watching the videos. Fair enough, considering (I'm not using YouTube ads to generate revenue for myself). As long as they don't decide to pull the videos, which could still happen.]</p>  <br />  <p align="center"><strong>Episode I: The Phantom Menace</strong></p>  <br /><iframe height="264" src="//www.youtube.com/embed/c8G0tJEKWc8?rel=0&amp;showinfo=0" frameborder="0" width="470" allowfullscreen="allowfullscreen"></iframe>  <br />  <br />  <p align="center"><strong>Episode II: Attack of the Clones</strong></p>  <br /><iframe height="264" src="//www.youtube.com/embed/yg97b72TRrM?rel=0&amp;showinfo=0" frameborder="0" width="470" allowfullscreen="allowfullscreen"></iframe>  <br />  <br />  <p align="center"><strong>Episode III: Revenge of the Sith</strong></p>  <br /><iframe height="264" src="//www.youtube.com/embed/SOARjbm4smo?rel=0&amp;showinfo=0" frameborder="0" width="470" allowfullscreen="allowfullscreen"></iframe>  <br />  <br />  <p align="center"><strong>Episode IV: A New Hope</strong></p>  <br /><iframe height="264" src="//www.youtube.com/embed/EwULS9-tGlo?rel=0&amp;showinfo=0" frameborder="0" width="470" allowfullscreen="allowfullscreen"></iframe>  <br />  <br />  <p align="center"><strong>Episode V: The Empire Strikes Back</strong></p>  <br /><iframe height="264" src="//www.youtube.com/embed/QgaBsAipHmw?rel=0&amp;showinfo=0" frameborder="0" width="470" allowfullscreen="allowfullscreen"></iframe>  <br />  <br />  <p align="center"><strong>Episode VI: Return of the Jedi</strong></p>  <br /><iframe height="264" src="//www.youtube.com/embed/fct4-nY3hSw?rel=0&amp;showinfo=0" frameborder="0" width="470" allowfullscreen="allowfullscreen"></iframe>  <br />  <br />  <p align="center"><strong>Episode VII: The Force Awakens</strong></p> <img title="Star Wars Episode VII - The Force Awakens" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; float: none; padding-top: 0px; padding-left: 0px; margin: 20px auto 50px; display: block; padding-right: 0px; border-top-width: 0px" border="0" alt="Star Wars Episode VII - The Force Awakens" src="/assets/image_353968.jpg" width="470" height="264" />   <p>Here’s the final F# code. The code for accessing SWAPI is really greatly simplified thanks to the use of F#’s JSON Type Provider (although in a real application I’d have added code to catch the exception thrown when the service is inaccessible).</p>  <div style="font-size: 8pt; font-family: courier new; background: white; color: black; line-height: 140%">   <p style="margin: 0px"><span style="color: blue">module</span> StarWars.Crawler</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">open</span> Autodesk.AutoCAD.ApplicationServices</p>    <p style="margin: 0px"><span style="color: blue">open</span> Autodesk.AutoCAD.ApplicationServices.Core</p>    <p style="margin: 0px"><span style="color: blue">open</span> Autodesk.AutoCAD.DatabaseServices</p>    <p style="margin: 0px"><span style="color: blue">open</span> Autodesk.AutoCAD.EditorInput</p>    <p style="margin: 0px"><span style="color: blue">open</span> Autodesk.AutoCAD.Geometry</p>    <p style="margin: 0px"><span style="color: blue">open</span> Autodesk.AutoCAD.Runtime</p>    <p style="margin: 0px"><span style="color: blue">open</span> FSharp.Data</p>    <p style="margin: 0px"><span style="color: blue">open</span> System</p>    <p style="margin: 0px"><span style="color: blue">open</span> System.Windows.Media</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: green">// Our JSON Type Provider providing access to SWAPI</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">type</span> Film = JsonProvider&lt;<span style="color: #a31515">&quot;http://swapi.co/api/films&quot;</span>&gt;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: green">// The intro music MP3 file</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">let</span> mp3 =</p>    <p style="margin: 0px">&#160; <span style="color: #a31515">&quot;http://s.cdpn.io/1202/Star_Wars_original_opening_crawl_1977.mp3&quot;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: green">// The layers we want to create as a list of (name, (r, g, b))</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">let</span> layers =</p>    <p style="margin: 0px">&#160; [</p>    <p style="margin: 0px">&#160;&#160;&#160; (<span style="color: #a31515">&quot;Stars&quot;</span>, (255, 255, 255));</p>    <p style="margin: 0px">&#160;&#160;&#160; (<span style="color: #a31515">&quot;Intro&quot;</span>, (75, 213, 238));</p>    <p style="margin: 0px">&#160;&#160;&#160; (<span style="color: #a31515">&quot;Crawl&quot;</span>, (229, 177, 58));</p>    <p style="margin: 0px">&#160;&#160;&#160; (<span style="color: #a31515">&quot;Planet&quot;</span>, (238, 232, 170))</p>    <p style="margin: 0px">&#160; ]</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: green">// Create layers based on the provided names and colour values</span></p>    <p style="margin: 0px"><span style="color: green">// (only creates layers if they don't already exist... could be</span></p>    <p style="margin: 0px"><span style="color: green">// updated to make sure the layers are on/thawed and have the</span></p>    <p style="margin: 0px"><span style="color: green">// right colour values)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">let</span> createLayers (tr:Transaction) (db:Database) =</p>    <p style="margin: 0px">&#160; <span style="color: blue">let</span> lt =</p>    <p style="margin: 0px">&#160;&#160;&#160; tr.GetObject(db.LayerTableId, OpenMode.ForWrite) :?&gt; LayerTable</p>    <p style="margin: 0px">&#160; layers |&gt;</p>    <p style="margin: 0px">&#160; List.iter (<span style="color: blue">fun</span> (name, (r, g, b)) <span style="color: blue">-&gt;</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">if</span> not(lt.Has(name)) <span style="color: blue">then</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">let</span> lay = <span style="color: blue">new</span> LayerTableRecord()</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; lay.Color &lt;-</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; Autodesk.AutoCAD.Colors.Color.FromRgb(byte r, byte g, byte b)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; lay.Name &lt;- name</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; lt.Add(lay) |&gt; ignore</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; tr.AddNewlyCreatedDBObject(lay, <span style="color: blue">true</span>)</p>    <p style="margin: 0px">&#160;&#160;&#160; )</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: green">// Get a view by name</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">let</span> getView (tr:Transaction) (db:Database) (name:string) =</p>    <p style="margin: 0px">&#160; <span style="color: blue">let</span> vt =</p>    <p style="margin: 0px">&#160;&#160;&#160; tr.GetObject(db.ViewTableId, OpenMode.ForRead) :?&gt; ViewTable</p>    <p style="margin: 0px">&#160; <span style="color: blue">if</span> vt.Has(name) <span style="color: blue">then</span></p>    <p style="margin: 0px">&#160;&#160;&#160; tr.GetObject(vt.[name], OpenMode.ForRead) :?&gt; ViewTableRecord</p>    <p style="margin: 0px">&#160; <span style="color: blue">else</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">null</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: green">// Add an entity to a block and a transaction</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">let</span> addToDatabase (tr:Transaction) (btr:BlockTableRecord) o =</p>    <p style="margin: 0px">&#160; btr.AppendEntity(o) |&gt; ignore</p>    <p style="margin: 0px">&#160; tr.AddNewlyCreatedDBObject(o, <span style="color: blue">true</span>)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: green">// Flush the graphics for a particular document</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">let</span> refresh (doc:Document) =</p>    <p style="margin: 0px">&#160; doc.TransactionManager.QueueForGraphicsFlush()</p>    <p style="margin: 0px">&#160; doc.TransactionManager.FlushGraphics()</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: green">// Transform between the Display and World Coordinate Systems</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">let</span> dcs2wcs (vtr:AbstractViewTableRecord) =</p>    <p style="margin: 0px">&#160; Matrix3d.Rotation(-vtr.ViewTwist, vtr.ViewDirection, vtr.Target) *</p>    <p style="margin: 0px">&#160; Matrix3d.Displacement(vtr.Target - Point3d.Origin) * </p>    <p style="margin: 0px">&#160; Matrix3d.PlaneToWorld(vtr.ViewDirection)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: green">// Poll until a music file has downloaded fully</span></p>    <p style="margin: 0px"><span style="color: green">// (could sleep or use a callback to avoid this being too</span></p>    <p style="margin: 0px"><span style="color: green">// CPU-intensive, but hey)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">let</span> <span style="color: blue">rec</span> waitForComplete (mp:MediaPlayer) =</p>    <p style="margin: 0px">&#160; <span style="color: blue">if</span> mp.DownloadProgress &lt; 1. <span style="color: blue">then</span></p>    <p style="margin: 0px">&#160;&#160;&#160; System.Windows.Forms.Application.DoEvents()</p>    <p style="margin: 0px">&#160;&#160;&#160; waitForComplete mp</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: green">// Poll until a specified delay has elapsed since start</span></p>    <p style="margin: 0px"><span style="color: green">// (could sleep or use a callback to avoid this being too</span></p>    <p style="margin: 0px"><span style="color: green">// CPU-intensive, but hey)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">let</span> <span style="color: blue">rec</span> waitForElapsed (start:DateTime) delay =</p>    <p style="margin: 0px">&#160; <span style="color: blue">let</span> elapsed = DateTime.Now - start</p>    <p style="margin: 0px">&#160; <span style="color: blue">if</span> elapsed.Seconds &lt; delay <span style="color: blue">then</span></p>    <p style="margin: 0px">&#160;&#160;&#160; System.Windows.Forms.Application.DoEvents()</p>    <p style="margin: 0px">&#160;&#160;&#160; waitForElapsed start delay</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: green">// Run operation f n times and then wait until</span></p>    <p style="margin: 0px"><span style="color: green">// a specified delay has elapsed since start</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">let</span> <span style="color: blue">rec</span> performNTimesOrUntilElapsed (start:DateTime) delay f n =</p>    <p style="margin: 0px">&#160; <span style="color: blue">let</span> elapsed = DateTime.Now - start</p>    <p style="margin: 0px">&#160; <span style="color: blue">if</span> n &gt; 0 || elapsed.Seconds &lt; delay <span style="color: blue">then</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">if</span> n &gt; 0 <span style="color: blue">then</span> f()</p>    <p style="margin: 0px">&#160;&#160;&#160; System.Windows.Forms.Application.DoEvents()</p>    <p style="margin: 0px">&#160;&#160;&#160; performNTimesOrUntilElapsed start delay f (n-1)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: green">// Get the roman numerals for an integer</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">let</span> roman n =</p>    <p style="margin: 0px">&#160; <span style="color: blue">let</span> numerals =</p>    <p style="margin: 0px">&#160;&#160;&#160; [(1000, <span style="color: #a31515">&quot;M&quot;</span>); (900, <span style="color: #a31515">&quot;CM&quot;</span>); (500, <span style="color: #a31515">&quot;D&quot;</span>); (400, <span style="color: #a31515">&quot;CD&quot;</span>); (100, <span style="color: #a31515">&quot;C&quot;</span>);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160; (90, <span style="color: #a31515">&quot;XC&quot;</span>); (50, <span style="color: #a31515">&quot;L&quot;</span>); (40, <span style="color: #a31515">&quot;XL&quot;</span>); (10, <span style="color: #a31515">&quot;X&quot;</span>); (9, <span style="color: #a31515">&quot;IX&quot;</span>);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160; (5, <span style="color: #a31515">&quot;V&quot;</span>); (4, <span style="color: #a31515">&quot;IV&quot;</span>); (1, <span style="color: #a31515">&quot;I&quot;</span>)]</p>    <p style="margin: 0px">&#160; <span style="color: blue">let</span> <span style="color: blue">rec</span> acc (v, r) (m, s) =</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">if</span> (v &lt; m) <span style="color: blue">then</span> (v, r) <span style="color: blue">else</span> acc (v-m, r+s) (m, s)</p>    <p style="margin: 0px">&#160; List.fold acc (n, <span style="color: #a31515">&quot;&quot;</span>) numerals |&gt; snd</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: green">// Get info on all 6 Star Wars episodes</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">let</span> allFilms =</p>    <p style="margin: 0px">&#160; <span style="color: blue">let</span> films = Film.Load(<span style="color: #a31515">&quot;http://swapi.co/api/films&quot;</span>)</p>    <p style="margin: 0px">&#160; films.Results</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: green">// Create the intro text as an MText object relative to the view</span></p>    <p style="margin: 0px"><span style="color: green">// (has a parameter to the function doesn't execute when loaded...</span></p>    <p style="margin: 0px"><span style="color: green">// also has hardcoded values that make it view-specific)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">let</span> createIntro _ =</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: blue">let</span> mt = <span style="color: blue">new</span> MText()</p>    <p style="margin: 0px">&#160; mt.Contents &lt;-</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #a31515">&quot;{\\fFranklin Gothic Book|b0|i0|c0|p34;&quot;</span> +</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #a31515">&quot;A long time ago, in a galaxy far,\\Pfar away...}&quot;</span></p>    <p style="margin: 0px">&#160; mt.Layer &lt;- <span style="color: #a31515">&quot;Intro&quot;</span></p>    <p style="margin: 0px">&#160; mt.TextHeight &lt;- 0.5</p>    <p style="margin: 0px">&#160; mt.Width &lt;- 10.</p>    <p style="margin: 0px">&#160; mt.Normal &lt;- Vector3d.ZAxis</p>    <p style="margin: 0px">&#160; mt.TransformBy(Matrix3d.Displacement(<span style="color: blue">new</span> Vector3d(1., 6., 0.)))</p>    <p style="margin: 0px">&#160; mt</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: green">// Generate a quantity of randomly located stars... a list of (x,y)</span></p>    <p style="margin: 0px"><span style="color: green">// tuples where x and y are between 0 and 1. These will later</span></p>    <p style="margin: 0px"><span style="color: green">// get transformed into the relevant space (on the screen, etc.)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">let</span> locateStars quantity =</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: green">// Create our random number generator</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: blue">let</span> ran = <span style="color: blue">new</span> System.Random()</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: green">// Note: _ is only used to make sure this function gets</span></p>    <p style="margin: 0px">&#160; <span style="color: green">// executed when it is called... if we have no argument</span></p>    <p style="margin: 0px">&#160; <span style="color: green">// it's a value that doesn't require repeated execution</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: blue">let</span> randomPoint _ =</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">// Get random values between 0 and 1 for our x and y coordinates</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; (ran.NextDouble(), ran.NextDouble())</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: green">// Local recursive function to create n stars at random</span></p>    <p style="margin: 0px">&#160; <span style="color: green">// locations (in the plane of the screen)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: blue">let</span> <span style="color: blue">rec</span> randomStars n =</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">match</span> n <span style="color: blue">with</span></p>    <p style="margin: 0px">&#160;&#160;&#160; | 0 <span style="color: blue">-&gt;</span> []</p>    <p style="margin: 0px">&#160;&#160;&#160; | _ <span style="color: blue">-&gt;</span> (randomPoint 0.) :: randomStars (n-1)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: green">// Create the specified number of stars at random locations</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; randomStars quantity</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: green">// Take locations from 0-1 in X and Y and place them</span></p>    <p style="margin: 0px"><span style="color: green">// relative to the screen</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">let</span> putOnScreen wid hgt dcs (x, y) =</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: green">// We want to populate a space that's 2 screens high (so we</span></p>    <p style="margin: 0px">&#160; <span style="color: green">// can pan/rotate downwards at the end of the crawl), hence</span></p>    <p style="margin: 0px">&#160; <span style="color: green">// the additional multiplier on y</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: blue">let</span> pt = <span style="color: blue">new</span> Point3d(wid * (x - 0.5), hgt * ((y * -1.5) + 0.5), 0.)</p>    <p style="margin: 0px">&#160; pt.TransformBy(dcs)&#160;&#160;&#160; </p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: green">// Create a polyline from a vertex list</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">let</span> polyFromVerts n w m lay verts =</p>    <p style="margin: 0px">&#160; <span style="color: blue">let</span> pl = <span style="color: blue">new</span> Polyline(List.length verts)</p>    <p style="margin: 0px">&#160; pl.Normal &lt;- n</p>    <p style="margin: 0px">&#160; List.iteri</p>    <p style="margin: 0px">&#160;&#160;&#160; (<span style="color: blue">fun</span> i v <span style="color: blue">-&gt;</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; pl.AddVertexAt(i, <span style="color: blue">new</span> Point2d(fst v, snd v), 0., w, w)</p>    <p style="margin: 0px">&#160;&#160;&#160; )</p>    <p style="margin: 0px">&#160;&#160;&#160; verts</p>    <p style="margin: 0px">&#160; pl.Closed &lt;- <span style="color: blue">true</span></p>    <p style="margin: 0px">&#160; pl.TransformBy(m)</p>    <p style="margin: 0px">&#160; pl.Layer &lt;- lay</p>    <p style="margin: 0px">&#160; pl</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: green">// Create the Star Wars logo from a list of vertex lists</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">let</span> createLogo n w (p:Point3d) =</p>    <p style="margin: 0px">&#160; <span style="color: blue">let</span> verts =</p>    <p style="margin: 0px">&#160;&#160;&#160; [</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; [</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (3.44258, 3.55679214868466);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (3.44258, 3.17553);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (2.8459, 3.17553);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (2.8459, 2.26434);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (2.40686, 2.26434);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (2.40686, 3.17612262061896);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.75655462335279, 3.17429248415801);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.72128333960472, 3.16669182023216);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.70763551483587, 3.15445862216978);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.70053119527792, 3.13782570874412);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.69872472722736, 3.12280350074472);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.69905468222644, 3.1191373340882);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.70087251722259, 3.11283393221843);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.70607593564196, 3.10180962306061);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.71621799674036, 3.08484068174517);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.73226620616926, 3.06151479594735);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.75494342528422, 3.03081841447927);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.78484748611009, 2.99191745820677);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.82294826291299, 2.94341738705363);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.87617804512918, 2.87460815638392);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.92246977710667, 2.81233246534401);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.95733932573181, 2.76278154528292);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.97888966827266, 2.72730122581048);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.99798396461003, 2.61953152517619);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.97570333908842, 2.50537461239132);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.91940141039899, 2.40109844384521);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.83646768287547, 2.32393324739609);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.80352751564867, 2.30404166777099);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.77133382731068, 2.28892985436458);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.73039688525943, 2.27813889539216);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.6754267050528, 2.27134897179126);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.59812878352077, 2.26745012799826);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.48927961179153, 2.26536230567172);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.33992701030606, 2.26450009692313);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.14136357854396, 2.26434001353564);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.04351, 2.26434);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (0.353207, 2.26434);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (0.353207, 2.68233);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.40159102170787, 2.68233);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.41748209051223, 2.69338144406387);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.43267712171974, 2.70939240011938);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.44055338604423, 2.73157466234716);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.44119451950013, 2.7367666633397);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.44105860097375, 2.73978455802721);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.43997063735183, 2.74322220229697);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.43439829934938, 2.75301581981413);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.4213959120805, 2.77071589918082);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.39979463633981, 2.7968603003749);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.36874714824015, 2.83262747962015);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.32697107584659, 2.87983734880692);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.23683919774444, 2.98529715322583);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.18339822046774, 3.06424778707422);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.16026089514802, 3.13669377471704);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.15987518361763, 3.21768150787052);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.18779743410553, 3.32756187144587);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.25599700588018, 3.43654449583423);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.36395601807001, 3.52111523123897);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.50483659505006, 3.55390286925382)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; ];</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; [</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (4.39994870002626, 3.54702);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (4.84743214991296, 2.25278501118727);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (4.41662097329373, 2.25517027344357);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (4.36118115868732, 2.43645696748207);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (3.81392247714979, 2.4388933038331);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (3.75959503424206, 2.26439);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (3.32291291955518, 2.26439);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (3.76562469596367, 3.54702)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; ];</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; [</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (3.93947639266304, 2.78028246119739);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (4.0036225829752, 2.96145971580626);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (4.09333768797878, 3.21205266525835);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (4.17869162137176, 2.9611015523335);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (4.23989035006252, 2.78062648416092)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; ];</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; [</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.54586280271403, 3.54702);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.73207467832675, 3.54636901457996);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.88112842531212, 3.54435138355133);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.98711334518623, 3.54111056421452);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.04631520398901, 3.53650379705603);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.11453578628832, 3.51811946058964);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.17810911285892, 3.48782673131194);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.23583237180861, 3.44644129584782);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.28596484458466, 3.39522327740142);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.32595493380338, 3.3422331096743);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.35270689747694, 3.29157143345469);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.3680867123442, 3.23557047460095);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.37643733628869, 3.16568660578167);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.36992931993028, 3.05606170860937);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.33210762885031, 2.95400067046692);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.26513711406835, 2.86555263333169);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.17366080953793, 2.79497351541438);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.14309800665153, 2.7769730033941);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.11700705528388, 2.76203194437172);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.1127843266014, 2.7596756036369);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.13885495853737, 2.73241774032095);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.17040343063679, 2.70456002005355);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.19335603450253, 2.68673568368009);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.86633739559967, 2.67707780533635);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.8742792314147, 2.26439);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.43526528939969, 2.26439);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.2418481178589, 2.26499101663952);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.11292604672176, 2.26701660378081);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.03406510582276, 2.27102207373412);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.9876655077232, 2.2786416155789);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.93407000168671, 2.30917788766821);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.85931623340334, 2.36822655452807);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.75524877978626, 2.46058692597491);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.61622131796047, 2.59075075972907);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.53661647932702, 2.66649674082322);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.5380039627306, 2.26439);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.0687, 2.26439);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.0687, 3.54702)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; ];</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; [</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.53061, 3.22193);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.67562434528338, 3.22193);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.76549694080276, 3.22143652653738);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.8227611211413, 3.21969654059112);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.85910049504742, 3.21603930873005);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.8835168373915, 3.20907338608929);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.91186718137154, 3.19493342317029);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.93449705925347, 3.17520079608985);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.9461460801979, 3.14851545023844);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.94993368385409, 3.1219164675812);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.95063789889132, 3.09471968284322);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.94382358152697, 3.06635439430217);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.92659250539508, 3.04172336065536);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.90396433067426, 3.02224480067035);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.89094323070014, 3.01257677365093);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.85401438673261, 3.00939777579999);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.81195751173521, 3.00827403940718);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.75772390976083, 3.00788023741928);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.69388269742043, 3.00778);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.53061, 3.00778)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; ];</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; [</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.57896862502186, 2.10589);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.67880828853815, 1.81260822369826);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.71379594628957, 1.71227377415791);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.73527827819659, 1.65374851057995);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.75920847744905, 1.72143678846549);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.79238473443157, 1.81629031452661);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.82529369636899, 1.9108498644361);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.85381147382987, 1.99319569627039);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.87388905179331, 2.05149770143778);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.8912822178088, 2.10154);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (2.32183990237932, 2.10154);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.87988984918951, 0.813874);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.58239936659396, 0.813874);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.56171424001044, 0.873466415317032);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.53295553769481, 0.956661589981072);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.49226696124087, 1.07432847254541);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.44570537030483, 1.20935203857834);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.39914465363298, 1.34447313546997);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.35858792560323, 1.46260098506068);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.35731504835852, 1.46634287831389);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.12278635463374, 0.823096);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (0.828087008371704, 0.823096);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (0.391580354628849, 2.10592925972778);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (0.820152580844014, 2.10564013321748);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (0.837989023926543, 2.05516759780397);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (0.859154236649471, 1.99519000485767);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (0.889137620919735, 1.91045548589063);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (0.92363489102879, 1.81330725414169);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (0.95817174136269, 1.71621235357281);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (0.979127616594254, 1.65771496109079);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (1.13684321996318, 2.10589)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; ];</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; [</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (3.28904785776228, 2.11550813590997);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (3.73761724891686, 0.824937551963215);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (3.30662126941653, 0.822954990623427);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (3.24971008910397, 1.00471601224713);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (2.69993521628902, 1.00914873793685);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (2.64593333868056, 0.827492143980233);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (2.21818710344123, 0.831947254825196);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (2.6611172170532, 2.11491182100224)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; ];</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; [</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (2.83075227905127, 1.35366041729816);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (2.87923452796852, 1.48620742282014);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (2.91710514665256, 1.58972911414478);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (2.98271654250203, 1.76897755710787);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (3.04320129635346, 1.59028356566733);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (3.05209063261682, 1.56402552642664);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (3.06700400017455, 1.52004510187737);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (3.0854341923654, 1.46582399091646);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (3.12362427253239, 1.35375);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (2.96565, 1.35375)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; ];</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; [</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.86738701658834, 2.11055);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.86636282954738, 1.71143316113769);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.80968306747308, 1.71166033453278);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.76879036498295, 1.71182022759786);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.70799358315783, 1.71199016269997);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.63307325593112, 1.7122001636159);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.55001968254444, 1.71242014609799);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.46487686643307, 1.71259008296755);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.38353162001043, 1.71274);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.3119, 1.71274);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.27257783369629, 1.71274);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.24205274248879, 1.71264056973548);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.22660212251127, 1.7125107967416);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.2251332275232, 1.71152567832907);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.21826693670348, 1.69895889104225);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.21368777582741, 1.67971131922799);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.21435024322066, 1.66802861722527);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.21739642079077, 1.6617633178101);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.23123505854596, 1.64006984102296);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.25133503104544, 1.61172470022028);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.27506976405328, 1.58087731010094);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.30343445446908, 1.54536194073766);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.33613016667173, 1.50446982038211);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.36882765268814, 1.46364795338937);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.39759648916047, 1.42768942522637);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.42698279823146, 1.39058529555372);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.45061281453046, 1.35962111552111);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.46946283661554, 1.33294897542795);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.48427168722091, 1.30886051606526);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.49558070778541, 1.2857968585775);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.50373858922054, 1.26288773947885);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.50912773260329, 1.23975035055556);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.51327721344814, 1.21302571797147);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.51175336049161, 1.12736501317236);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.48652470110405, 1.04165809320606);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.44008974336086, 0.963007688635264);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.37622624858673, 0.897126531506992);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.34136126462528, 0.869847315902196);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.30454078761051, 0.848196296706673);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.25735068769598, 0.832813348711309);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.1946926284406, 0.82334703105736);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.10791480816548, 0.817863341131013);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.98694154482626, 0.815070019097485);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.82230156071494, 0.814036130538472);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.60480157525874, 0.813819020750331);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.57579464995636, 0.813819);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.31033615083933, 0.814524554163534);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.1147019020476, 0.816483302483575);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (4.987492484323, 0.819719154126808);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (4.92211642121057, 0.824809172133531);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (4.86255265351012, 0.851353630113647);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (4.78599624454765, 0.907412194416292);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (4.67949985067332, 1.00068616876809);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (4.53106852156296, 1.14052267830742);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (4.47120745637841, 1.19730089863496);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (4.43722713582279, 1.22872889310876);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (4.43479568627557, 0.813638441379537);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (3.97790059619618, 0.815626482435268);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (3.9754088950639, 2.09644);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (4.85435350955452, 2.09644);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (4.9524384120744, 2.08116590914619);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.0421132756076, 2.04495127286902);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.11968748422517, 1.9926567681356);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.18396561975463, 1.92855365816238);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.23369876113581, 1.8565584931861);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.26760265295347, 1.78012486674058);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.28395979085181, 1.70241419345942);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.28004510702221, 1.62839637688364);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.25918823660479, 1.55956085936412);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.23129767989095, 1.49769758838801);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.19287713035147, 1.44636773420326);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.14201539837177, 1.39663698792505);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.08439692602106, 1.35247865701708);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.02763448373853, 1.32012290369814);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.01926153493527, 1.31567062139799);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.0201401696421, 1.31465755077974);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.03635825437325, 1.29789855762624);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.05404454395319, 1.28126513332677);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.07123638095395, 1.26662725426366);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.08545995358084, 1.25609066762876);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.09155854789262, 1.25261446887105);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.11520296200932, 1.24773262641588);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.1839384665362, 1.2437210842384);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.31499237416825, 1.24167909762829);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.52681922465014, 1.24108996855417);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.63722185856806, 1.24103002684722);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.75066647981753, 1.24129939671563);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.83424919549954, 1.24231918109318);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.89196733024185, 1.24477834974135);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.92703259711752, 1.248815584514);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.94186413459469, 1.25312246895092);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.94452720971008, 1.2550352046588);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.94806585844389, 1.26045738811548);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.95485974741274, 1.27515168783283);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.95764005574495, 1.28273863090887);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.95785068079404, 1.28531001171654);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.95662977011935, 1.29060599364051);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.95018212309273, 1.30349479459504);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.9355344205503, 1.32495058423466);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.9118829225398, 1.3549665197346);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.87849452603907, 1.39425562054069);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.83444545149862, 1.44431638015785);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.73724255457614, 1.5576766597549);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.68852920511552, 1.65032448217977);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.6739520592985, 1.72315250284916);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.67339629718887, 1.7776616505618);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.67582917215106, 1.81532530917471);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.6869349467792, 1.86440938045866);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.70875633588307, 1.91894581413262);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.74384006043308, 1.97499767954953);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.79476342169442, 2.02753710966927);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.86330983842433, 2.07103004485607);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (5.95041130228872, 2.10023544319704);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (6.0548074435266, 2.11055)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; ];</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; [</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (4.4345937394936, 1.56212643206149);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (4.43518042620646, 1.67044148437216);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (4.43556787492364, 1.77298062965549);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (4.59383378518243, 1.77217924888779);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (4.64881620553342, 1.77178759329077);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (4.70616920376935, 1.77085699790493);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (4.75610194813188, 1.76893449843586);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (4.79998632985362, 1.76368084421198);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (4.84719213337829, 1.71746157785606);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (4.8610886482744, 1.66244080023347);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (4.85668777505293, 1.63727739146715);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (4.84628131477829, 1.61325711967745);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (4.82603724633321, 1.58950045930602);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (4.79564620691826, 1.57081593809471);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (4.76918190987008, 1.56332632934342);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (4.73276899886416, 1.5595967363527);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (4.67535969661275, 1.55779395371568);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (4.58510256995686, 1.55724810481441);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (4.52224299866422, 1.5581940498193)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; ]</p>    <p style="margin: 0px">&#160;&#160;&#160; ]</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: green">// Displace our vertices to the specified point and then</span></p>    <p style="margin: 0px">&#160; <span style="color: green">// apply a hardcoded, view-specific scaling</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: blue">let</span> m1 = Matrix3d.Displacement(p.GetAsVector())</p>    <p style="margin: 0px">&#160; <span style="color: blue">let</span> m = m1 * Matrix3d.Scaling(1.4, p + <span style="color: blue">new</span> Vector3d(3.5,0.,0.))</p>    <p style="margin: 0px">&#160; verts |&gt; List.map (polyFromVerts n w m <span style="color: #a31515">&quot;Crawl&quot;</span>)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: green">// Format the &quot;opening crawl&quot; text appropriately for MText</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">let</span> crawlText num (title:string) (text:string) =</p>    <p style="margin: 0px">&#160; <span style="color: blue">let</span> lines =</p>    <p style="margin: 0px">&#160;&#160;&#160; text.Split([|<span style="color: #a31515">&quot;\r\n&quot;</span>|], StringSplitOptions.None) |&gt;</p>    <p style="margin: 0px">&#160;&#160;&#160; Array.toList</p>    <p style="margin: 0px">&#160; <span style="color: blue">let</span> <span style="color: blue">rec</span> convert (lns:string list) =</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">match</span> lns <span style="color: blue">with</span></p>    <p style="margin: 0px">&#160;&#160;&#160; | [] <span style="color: blue">-&gt;</span> <span style="color: #a31515">&quot;&quot;</span></p>    <p style="margin: 0px">&#160;&#160;&#160; | (x::xs) <span style="color: blue">-&gt;</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">let</span> ln =</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> xs = [] || (xs &lt;&gt; [] &amp;&amp; xs.Head = <span style="color: #a31515">&quot;&quot;</span>) <span style="color: blue">then</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #a31515">&quot;\\pql;&quot;</span> + x + <span style="color: #a31515">&quot;\\P&quot;</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">else</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #a31515">&quot;\\pqd;&quot;</span> + x + <span style="color: #a31515">&quot;\\P&quot;</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; ln + convert xs</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; String.Format(</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #a31515">&quot;\\pxsm1.5,qc;{{\\fFranklin Gothic Demi|b0|i0|c0|p34;&quot;</span> +</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #a31515">&quot;Episode {0}\\P\\P\\fFranklin Gothic Medium Cond|b0|i0|c0|p34;&quot;</span> +</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #a31515">&quot;\\H1.3333x;\\W0.95;{1}\\P\\fFranklin Gothic Demi|b0|i0|c0|&quot;</span> +</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #a31515">&quot;p34;\\H0.74999x;\\W1;\\P\\pqd;\\H0.83334x;{2}}}&quot;</span>,</p>    <p style="margin: 0px">&#160;&#160;&#160; roman num, title.ToUpper(), convert lines</p>    <p style="margin: 0px">&#160; )</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: green">// Create the crawl text object with the provided text contents</span></p>    <p style="margin: 0px"><span style="color: green">// (again with hardcoded values that are view-specific)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">let</span> createCrawlText text =</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: green">// Create our MText object</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: blue">let</span> mt = <span style="color: blue">new</span> MText()</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: green">// Set its contents and other properties</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; mt.Contents &lt;- text&#160;&#160;&#160; </p>    <p style="margin: 0px">&#160; mt.Layer &lt;- <span style="color: #a31515">&quot;Crawl&quot;</span></p>    <p style="margin: 0px">&#160; mt.TextHeight &lt;- 0.3</p>    <p style="margin: 0px">&#160; mt.Width &lt;- 6.</p>    <p style="margin: 0px">&#160; mt</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: green">// Move the crawl text through space in a number of increments</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">let</span> moveThroughSpace (doc:Document) (ent:Entity) steps delay =</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: green">// Record our start time, so we stop when delay has elapsed</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: blue">let</span> start = DateTime.Now</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: green">// Specify our displacement increment</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: blue">let</span> mat = Matrix3d.Displacement(<span style="color: blue">new</span> Vector3d(0.,0.2,0.))</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: green">// Define a local recursive function to move the object</span></p>    <p style="margin: 0px">&#160; <span style="color: green">// n times (but to check for user escape and terminate, as</span></p>    <p style="margin: 0px">&#160; <span style="color: green">// needed)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: blue">let</span> <span style="color: blue">rec</span> moveLoop n =</p>    <p style="margin: 0px">&#160;&#160;&#160; ent.TransformBy(mat)</p>    <p style="margin: 0px">&#160;&#160;&#160; refresh doc</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">let</span> elapsed = DateTime.Now - start</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">if</span> n &gt; 0 &amp;&amp;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; not(</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (HostApplicationServices.Current.UserBreak() ||</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; elapsed.TotalSeconds &gt;= delay)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; ) <span style="color: blue">then</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; moveLoop (n-1)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: green">// Move the MText a number of times along the Y axis</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; moveLoop steps</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: green">// Commands to recreate the open crawl experience for a selected</span></p>    <p style="margin: 0px"><span style="color: green">// Star Wars episode</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">[&lt;CommandMethod(<span style="color: #a31515">&quot;EPISODE&quot;</span>)&gt;]</p>    <p style="margin: 0px"><span style="color: blue">let</span> episode() =</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: green">// Make sure the active document is valid before continuing</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: blue">let</span> doc = Application.DocumentManager.MdiActiveDocument</p>    <p style="margin: 0px">&#160; <span style="color: blue">if</span> doc &lt;&gt; <span style="color: blue">null</span> <span style="color: blue">then</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">let</span> db = doc.Database</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">let</span> ed = doc.Editor</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">// Ask for the episode number</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">let</span> pso = <span style="color: blue">new</span> PromptIntegerOptions(<span style="color: #a31515">&quot;\nEnter episode&quot;</span>)</p>    <p style="margin: 0px">&#160;&#160;&#160; pso.LowerLimit &lt;- 1</p>    <p style="margin: 0px">&#160;&#160;&#160; pso.UpperLimit &lt;- 6 <span style="color: green">// Change to 7 in December 2015... :-)</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">let</span> psr = ed.GetInteger(pso)</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">if</span> psr.Status = PromptStatus.OK <span style="color: blue">then</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">// Start our transaction and create the required layers</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">use</span> tr = doc.TransactionManager.StartTransaction()</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; createLayers tr db</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">// Get our special Initial and Crawl views</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">let</span> ivtr = getView tr db <span style="color: #a31515">&quot;Initial&quot;</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">let</span> cvtr = getView tr db <span style="color: #a31515">&quot;Crawl&quot;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> ivtr = <span style="color: blue">null</span> || cvtr = <span style="color: blue">null</span> <span style="color: blue">then</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #a31515">&quot;\nPlease load StarWarsCrawl.dwg before running command.&quot;</span>)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; doc.TransactionManager.EnableGraphicsFlush(<span style="color: blue">true</span>)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">let</span> btr =</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; tr.GetObject(doc.Database.CurrentSpaceId, OpenMode.ForWrite)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; :?&gt; BlockTableRecord</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">// Set the initial view: this gives us higher quality text</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; ed.SetCurrentView(ivtr)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">// First we create the intro text</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">let</span> intro = createIntro ()</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; intro |&gt; addToDatabase tr btr</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">// Make sure the intro text is visible</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; doc |&gt; refresh</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; ed.UpdateScreen()</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">// We'll now perform a number of start-up tasks, while our</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">// initial intro text is visible... we'll start vy recording</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">// our start time, so we can synchronise our delay</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">let</span> start = DateTime.Now</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">// Get our view's DCS matrix</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">let</span> dcs = dcs2wcs(cvtr)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">// Create our planet with hardcoded, view-specific values</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">// (do it here as demand-loading ASM may take time)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">let</span> planet = <span style="color: blue">new</span> Solid3d()</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; planet.CreateSphere(3.)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; planet.Layer &lt;- <span style="color: #a31515">&quot;Planet&quot;</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">let</span> bot =</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; Point3d.Origin.TransformBy(dcs) +</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">new</span> Vector3d(0.,-1.1,-3.2)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; planet.TransformBy(Matrix3d.Displacement(bot.GetAsVector()))</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; planet |&gt; addToDatabase tr btr</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">// Create a host of stars at random screen positions</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; locateStars 1000 |&gt;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; List.iter</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (<span style="color: blue">fun</span> xy <span style="color: blue">-&gt;</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">let</span> p = putOnScreen cvtr.Width cvtr.Height dcs xy</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">let</span> dbp = <span style="color: blue">new</span> DBPoint(p)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; dbp.Layer &lt;- <span style="color: #a31515">&quot;Stars&quot;</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; dbp |&gt; addToDatabase tr btr)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">// Open the intro music over the web</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">let</span> mp = <span style="color: blue">new</span> MediaPlayer()</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; mp.Open(<span style="color: blue">new</span> Uri(mp3))</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">// Wait for the download to complete before playing it</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; waitForComplete mp</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">// Get the data associated with the specified episode</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">// (this can take some time)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">let</span> epNum = psr.Value</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">let</span> epInfo =</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; allFilms |&gt;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; Array.pick</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (<span style="color: blue">fun</span> e <span style="color: blue">-&gt;</span> <span style="color: blue">if</span> e.EpisodeId = epNum <span style="color: blue">then</span> Some(e) <span style="color: blue">else</span> None)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">// Have a minimum delay of 5 seconds showing the intro text</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; waitForElapsed start 5</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">// Start the audio at 8.5 seconds in</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; mp.Position &lt;- <span style="color: blue">new</span> TimeSpan(0, 0, 0, 8, 500)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; mp.Play()</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">// Switch to the crawl view: this will also change the</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">// visual style from 2D Wireframe to Realistic</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; ed.SetCurrentView(cvtr)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">// Remove the intro text</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; intro.Erase()</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">// Draw the SW logo and &quot;move it away&quot; from the camera,</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">// once again with hardcoded, view-specific values</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">let</span> es =</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; createLogo cvtr.ViewDirection 0.0833</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (<span style="color: blue">new</span> Point3d(-1.,-5.,0.))</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; es |&gt; List.iter (addToDatabase tr btr)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">// Use a simple scaling to give the impression of movement</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">// (yes, with hardcoded, view-specific values)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">let</span> <span style="color: blue">rec</span> moveAway (es:Polyline list) n =</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">let</span> m = Matrix3d.Scaling(0.91, <span style="color: blue">new</span> Point3d(3.,12.,0.))</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; es |&gt;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; List.iter</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (<span style="color: blue">fun</span> e <span style="color: blue">-&gt;</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; e.TransformBy(m)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; refresh doc</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; System.Threading.Thread.Sleep(15))</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> n &gt; 0 &amp;&amp;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; not(HostApplicationServices.Current.UserBreak()) <span style="color: blue">then</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; moveAway es (n-1)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; moveAway es 40</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">// Remove the polylines making up the logo</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; es |&gt; List.iter (<span style="color: blue">fun</span> e <span style="color: blue">-&gt;</span> e.Erase())</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> not(HostApplicationServices.Current.UserBreak()) <span style="color: blue">then</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// Create the crawl text</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">let</span> crawl =</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; crawlText epNum epInfo.Title epInfo.OpeningCrawl |&gt;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; createCrawlText</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; crawl |&gt; addToDatabase tr btr</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// Start moving it through space, with 300 steps or for 68</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// seconds (whichever comes first)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; moveThroughSpace doc crawl 300 68.</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; crawl.Erase()</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// After the crawl is done, rotate the view down onto</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// the surface of the planet</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> not(HostApplicationServices.Current.UserBreak()) <span style="color: blue">then</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// We'll display the target by a portion of the distance</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// between the top set of stars and the bottom</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">let</span> pt2 = <span style="color: blue">new</span> Point3d(0., -0.5 * cvtr.Height, 0.)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">let</span> dpt1 = Point3d.Origin.TransformBy(dcs)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">let</span> dpt2 = pt2.TransformBy(dcs)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">let</span> del = (dpt2 - dpt1) / 100.</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">let</span> disp = Matrix3d.Displacement(del)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// We'll rotate the view direction at the same time,</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// so that the planet appears at the bottom</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">let</span> rot =</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Matrix3d.Rotation(-0.005, Vector3d.XAxis, cvtr.Target)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// Our view table record needs to be writeable, of course</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; cvtr.UpgradeOpen()</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// Perform the specified view changes 100 times,</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// waiting until 12 seconds have elapsed</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; performNTimesOrUntilElapsed DateTime.Now 12</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (<span style="color: blue">fun</span> f <span style="color: blue">-&gt;</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; cvtr.Target &lt;- cvtr.Target.TransformBy(disp)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; cvtr.ViewDirection &lt;-</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; cvtr.ViewDirection.TransformBy(rot)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.SetCurrentView(cvtr)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; System.Threading.Thread.Sleep(50)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; )</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 100</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; tr.Commit() <span style="color: green">// Commit the transaction</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; mp.Stop() <span style="color: green">// Stop the music</span></p>    <p style="margin: 0px"><span style="color: green"></span></p>    <p style="margin: 0px"><span style="color: green"></span></p> </div>  <p>I hope you’ve found this series entertaining, if not particularly useful. It was certainly a fun diversion – for me, at least – to work through the various challenges around getting this to work with a tolerable level of quality. It never ceases to amaze me what you can do inside AutoCAD with the right programming language, a bit of time and a mildly obsessive personality. :-)</p>  <p><strong><em>Update:</em></strong></p>  <p>See <a href="http://through-the-interface.typepad.com/through_the_interface/2015/12/the-force-awakens-in-autocad.html" target="_blank">this more recent post</a> for the opening crawl for <em>Episode VII: The Force Awakens</em>.</p>
