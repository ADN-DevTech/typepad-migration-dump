---
layout: "post"
title: "Hosting our ASP.NET Web API project on Windows Azure &ndash; Part 1"
date: "2012-04-16 06:20:00"
author: "Kean Walmsley"
categories:
  - "ASP.NET"
  - "Azure"
  - "F#"
  - "SaaS"
original_url: "https://www.keanw.com/2012/04/hosting-our-aspnet-web-api-project-on-windows-azure-part-1.html "
typepad_basename: "hosting-our-aspnet-web-api-project-on-windows-azure-part-1"
typepad_status: "Publish"
---

<p>Having built <a href="http://through-the-interface.typepad.com/through_the_interface/2012/04/exposing-a-restful-web-service-for-use-inside-autocad-using-the-aspnet-web-api-part-1.html" target="_blank">our local ASP.NET</a> <a href="http://through-the-interface.typepad.com/through_the_interface/2012/04/exposing-a-restful-web-service-for-use-inside-autocad-using-the-aspnet-web-api-part-2.html" target="_blank">Web API project</a> and <a href="http://through-the-interface.typepad.com/through_the_interface/2012/04/consuming-data-from-a-restful-web-service-inside-autocad-using-net.html" target="_blank">consumed its data inside AutoCAD</a>, we’re now ready to deploy our web-service to the cloud. In this first part, we’ll look at some background information on Azure, in particular, and then get ready for the publishing process, which we’ll complete in the next post in the series.</p>
<h4>Choosing a provider</h4>
<p>As is obvious from the title, for these posts we’re going to use <a href="http://microsoft.com/azure" target="_blank">Windows Azure</a>. Alternatives such as <a href="http://aws.amazon.com/" target="_blank">Amazon Web Services (AWS)</a> provide IaaS (Infrastructure-as-a-Service) capabilities related to hosting ASP.NET – you basically get the ability to deploy Windows Servers in the cloud you can connect to and host your application on – but what’s interesting about Windows Azure is a tighter integration, something known as PaaS (Platform-as-a-Service). If you’re interested in understanding the difference between IaaS, PaaS and SaaS, then <a href="http://en.wikipedia.org/wiki/Cloud_computing#Service_Models" target="_blank">this should help</a>.</p>
<p>On the subject of hosting providers… I found <a href="http://en.wikipedia.org/wiki/Cloud_computing#Service_Models" target="_blank">this debate</a> to be very interesting, with proponents of both Azure and AWS fighting their respective corners. I suspect that for this audience – as it was the case for me – the arguments in favour of Azure tend to be more compelling, as we’re working closely with the .NET stack. On the other hand, Autodesk is currently a significant user of AWS. Over time I can imagine that the benefits of tighter integration – co-location of compute and storage resources being of particular importance – might lead to our developers and customers choosing to host their own services alongside ours, but we’re a long way from this being a significant issue, and I expect there to continue to be changes in the cloud-hosting landscape over the coming few years.</p>
<h4>Background information</h4>
<p>To get started with Azure, I recommend a few background resources. For those of you somewhat familiar with ASP.NET, <a href="http://blogs.msdn.com/b/uscloud/archive/2012/03/22/windows-azure-for-the-asp-net-developer-series.aspx" target="_blank">this set of articles</a> will probably be of use. I also sat through <a href="http://channel9.msdn.com/posts/Windows-Azure-Jump-Start-01-Windows-Azure-Overview" target="_blank">this introductory jump-start video</a>, but didn’t make it to its brethren – it was mostly extolling the benefits of cloud computing in general.</p>
<p>If you’re going to watch one video on Windows Azure, <a href="http://channel9.msdn.com/Blogs/Windows-Azure-Developer-Experience-Videos/NET-Windows-Azure-Introduction" target="_blank">this is it</a>. Scott Guthrie does a fantastic job of keeping it simple and to the point: he creates an ASP.NET MVC app and deploys it on Azure in around 4 minutes.</p>
<p>We’re basically going to follow the same process as Scott did – which is a big reason for using VS2010 to build our ASP.NET MVC 4 project, as there currently isn’t a Windows Azure SDK for .NET that integrates with VS11 – but we’ll also be adding a few steps of our own to help us further down the line.</p>
<p>Before we look at getting our project deployed on Windows Azure, a quick disclaimer: I’m largely learning this as I go. While I’ve used <a href="http://en.wikipedia.org/wiki/Internet_Information_Services" target="_blank">IIS</a> and ASP, back in the day, I haven’t recently used ASP.NET, and working with the cloud is altogether new for me. But that should also encourage people that you don’t need to know the ins and outs of AWS or Azure to get started with this stuff – it’s surprisingly easy.</p>
<p>Now for those steps that will save us some headaches, later on:</p>
<p>In the main <em>Web.config</em> file in the ApollonianPackingWebApi project, inside the &lt;system.web&gt; element, we’re going to add the following setting:</p>
<div style="font-family: courier new; background: white; color: black; font-size: 8pt;">
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&lt;</span><span style="line-height: 140%; color: #a31515;">customErrors</span><span style="line-height: 140%; color: blue;"> </span><span style="line-height: 140%; color: red;">mode</span><span style="line-height: 140%; color: blue;">=</span><span style="line-height: 140%;">&quot;</span><span style="line-height: 140%; color: blue;">Off</span><span style="line-height: 140%;">&quot;</span><span style="line-height: 140%; color: blue;">/&gt;</span></p>
</div>
<p>This allows any web-service errors to be passed through to the browser on the client, rather than us needing to open a Remote Desktop session on the server in order to get the error locally via a browser there.</p>
<p>This change helped me to understand the reason the application didn’t work when initially deployed to Azure: I needed to make sure F# was available to the project. While we clearly have a reference to FSharp.Core.dll in our F# library, we also need a reference to it – <a href="http://int.social.msdn.microsoft.com/Forums/en-AU/windowsazure/thread/200d1437-a136-47b7-94a2-4ab37d3b1734" target="_blank">with CopyLocal set to True</a> – in our primary C# project. A tricky one to track down, but I can see why it needs to happen.</p>
<h4>Getting started with Azure</h4>
<p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2016764fd6c43970b-pi" target="_blank"><img align="right" alt="Option-to-add-a-Windows-Azure-deploy[2]" border="0" height="183" src="/assets/image_349689.jpg" style="background-image: none; margin: 0px 0px 0px 10px; padding-left: 0px; padding-right: 0px; display: inline; float: right; padding-top: 0px; border-width: 0px;" title="Option-to-add-a-Windows-Azure-deploy[2]" width="152" /></a></p>
<p>To get the integration between VS2010 and the Azure tools, you’re going to need to install the latest <a href="http://www.microsoft.com/download/en/details.aspx?id=28045" target="_blank">Windows Azure SDK for .NET</a>, which I did myself <a href="http://go.microsoft.com/fwlink/?LinkID=156784" target="_blank">via the Web Platform Installer</a>.</p>
<p>This should provide you with the ability to – just as Scott did in the video – right-click the main C# project in our solution and select “Add Windows Azure Deployment Project”. It’s that easy to get the deployment project in place. :-)</p>
<p>Via this project, it’s possible to choose the number and size of the instances available to your application’s load-balancer:</p>
<p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2016764fd6ca9970b-pi" target="_blank"><img alt="Our-deployment-settings_thumb1" border="0" height="380" src="/assets/image_756378.jpg" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="Our-deployment-settings_thumb1" width="474" /></a></p>
<p>Now that we’ve prepared our deployment settings, in the next post we’ll go ahead and publish the project to Windows Azure.</p>
