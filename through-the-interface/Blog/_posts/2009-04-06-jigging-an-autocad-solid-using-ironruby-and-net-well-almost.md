---
layout: "post"
title: "Jigging an AutoCAD solid using IronRuby and .NET (well, almost)"
date: "2009-04-06 22:54:13"
author: "Kean Walmsley"
categories:
  - "AutoCAD"
  - "AutoCAD .NET"
  - "IronRuby"
  - "Ruby"
  - "Solid modeling"
original_url: "https://www.keanw.com/2009/04/jigging-an-autocad-solid-using-ironruby-and-net-well-almost.html "
typepad_basename: "jigging-an-autocad-solid-using-ironruby-and-net-well-almost"
typepad_status: "Publish"
---

<p>In <a href="http://through-the-interface.typepad.com/through_the_interface/2009/04/using-ironruby-inside-autocad.html">the last post</a> I introduced a very simple “Hello World!” IronRuby application working with AutoCAD, <a href="http://through-the-interface.typepad.com/through_the_interface/2009/03/using-ironpython-with-autocad.html">just as I’d previously done with IronPython</a>. My idea for this post was to take the code from <a href="http://through-the-interface.typepad.com/through_the_interface/2009/03/jigging-an-autocad-solid-using-ironpython-and-net.html">my second IronPython post</a> – which showed how to jig an AutoCAD solid from IronPython – and get it working with IronRuby, forcing me to learn a little more Ruby in the process.</p>  <p>All started out well: to convert the basic syntax from Python to Ruby was straightforward, and I have a definite liking for the syntax of the Ruby language. Especially when working with object orientation: the code for implementing classes feels cleaner than Python and it’s really OO from top to bottom (<em>everything’s</em> an object). I even found a way to avoid all those namespaces everywhere in the code – you just assign them to symbols and use those intead.</p>  <p>So what didn’t work? Well, it turns out there’s a problem with the definition of the EntityJig class, which is the parent of our SolidJig: IronRuby tells me it doesn’t have a default constructor defined. It’s very similar in nature to the problem I had deriving the IronPython version of my SolidJig class, but in this case I had to make sure my code very specifically implemented an __init__ function taking an entity (IronRuby uses initialize() instead of __init__ and is really clean in the way it allows you to super-message to your parent class, but right now it seems there’s something getting in the way – IronRuby is at version 0.3, after all).</p>  <p>Here’s my IronRuby script – for the RBLOAD command look at the C# code in <a href="http://through-the-interface.typepad.com/through_the_interface/2009/04/using-ironruby-inside-autocad.html">the last post</a>.</p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">require 'C:\Program Files\Autodesk\AutoCAD 2009\acmgd.dll'</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">require 'C:\Program Files\Autodesk\AutoCAD 2009\acdbmgd.dll'</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">require 'C:\Program Files\Autodesk\AutoCAD 2009\acmgdinternal.dll'</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Ai =&#160; Autodesk::AutoCAD::Internal</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Aiu = Autodesk::AutoCAD::Internal::Utils</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Aas = Autodesk::AutoCAD::ApplicationServices</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Ads = Autodesk::AutoCAD::DatabaseServices</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Aei = Autodesk::AutoCAD::EditorInput</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Ag =&#160; Autodesk::AutoCAD::Geometry</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Ar =&#160; Autodesk::AutoCAD::Runtime</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">def print_message(msg)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160; app = Aas::Application</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160; doc = app.DocumentManager.MdiActiveDocument</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160; ed = doc.Editor</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160; ed.WriteMessage(msg)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">end</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%"># Function to register AutoCAD commands</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">def autocad_command(cmd)&#160; </span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160; cc = Ai::CommandCallback.new method(cmd)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160; Aiu.AddCommand('rbcmds', cmd, cmd, Ar::CommandFlags.Modal, cc)</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160; # Let's now write a message to the command-line</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160; print_message(&quot;\nRegistered Ruby command: &quot; + cmd)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">end</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">def add_commands(names)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160; names.each { |n| autocad_command n }</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">end</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%"># Let's do something a little more complex...</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">class SolidJig &lt; Aei::EntityJig</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160; # Initialization function</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160; def initialize(ent)</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; # Call the base class and store the object</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; super</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; @sol = ent</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160; end</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160; # The function called to run the jig</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160; def StartJig(ed, pt)</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; # The start point is specified outside the jig</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; @start = pt</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; @end = pt</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; return ed.Drag(self)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160; end</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160; # The sampler function</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160; def Sampler(prompts)</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; # Set up our selection options</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; jo = Aei::JigPromptPointOptions.new</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; jo.UserInputControls = (</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; Aei::UserInputControls.Accept3dCoordinates |</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; Aei::UserInputControls.NoZeroResponseAccepted |</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; Aei::UserInputControls.NoNegativeResponseAccepted)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; jo.Message = &quot;\nSelect end point: &quot;&#160;&#160;&#160;&#160;&#160; </span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; # Get the end point of our box</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; res = prompts.AcquirePoint(jo)</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; if @end == res.Value</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; return Aei::SamplerStatus.NoChange</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; else</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; @end = res.Value</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; end</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; return Aei::SamplerStatus.OK</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160; end</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160; # The update function</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160; def Update()</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; # Recreate our Solid3d box</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; begin</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; # Get the width (x) and depth (y)</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; x = @end.X - @start.X</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; y = @end.Y - @start.Y</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; # We need a non-zero Z value, so we copy Y</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; z = y</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; # Create our box and move it to the right place</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; @sol.CreateBox(x,y,z)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; @sol.TransformBy(</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; Ag::Matrix3d.Displacement(</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Ag::Vector3d.new(</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; @start.X + x/2,</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; @start.Y + y/2,</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; @start.Z + z/2)))</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; rescue</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; return false</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; end&#160; </span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; return true</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160; end</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">end</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%"># Create a box using a jig</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">def boxjig</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160; app = Aas::Application</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160; doc = app.DocumentManager.MdiActiveDocument</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160; db = doc.Database</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160; ed = doc.Editor</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160; # Select the start point before entering the jig</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160; ppr = ed.GetPoint(&quot;\nSelect start point: &quot;)</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160; if ppr.Status == Aei::PromptStatus.OK</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; # We'll add our solid to the modelspace</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; tr = doc.TransactionManager.StartTransaction</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; bt =</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; tr.GetObject(</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; db.BlockTableId,</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; Ads::OpenMode.ForRead)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; btr =</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; tr.GetObject(db.CurrentSpaceId,Ads::OpenMode.ForWrite)</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; # Make sure we're recording history to allow grip editing</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; sol = Ads::Solid3d.new</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; sol.RecordHistory = true</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; # Now we add our solid</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; btr.AppendEntity(sol)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; tr.AddNewlyCreatedDBObject(sol, true)</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; # And call the jig before finishing</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; begin</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; sj = SolidJig.new sol</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; ppr2 = sj.StartJig(ed, ppr.Value)</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; # Only commit if all completed well</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; if ppr2.Status == Aei::PromptStatus.OK</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; tr.Commit</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; end</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; rescue</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; print_message(&quot;\nProblem found: &quot; + $! + &quot;\n&quot;)</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; end</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; tr.Dispose</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160; end</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">end</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">add_commands [&quot;boxjig&quot;]</span></p> </div>  <p>When we run the RBLOAD command and select this script, our BOXJIG command gets defined.</p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Registered Ruby command: boxjig</span></p> </div> <!--EndFragment-->  <p>When this is run, our Begin-Rescue block (equivalent to Try-Catch in most other modern programming languages :-) catches the exception and prints an error statement at the command-line:</p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Command: <font color="#ff0000">BOXJIG</font></span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Select start point:</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Problem found: Parent does not have a default constructor. The default </span><span style="line-height: 140%">constructor must be explicitly defined.</span></p> </div> <!--EndFragment-->  <p>I’m hoping the root cause of the issue is obvious to someone familiar with IronRuby, whether in the above calling code, the design of the API exposed by AutoCAD or the implementation of IronRuby itself.</p>  <p>I do prefer not to post code that doesn’t actually work, but I feel there’s still value in seeing the comparison between the Python and Ruby scripts, for people to get a feel for how the languages differ. And - apart from anything else – I’ve hit my head against this for long enough that I at least want to get a post out of it. :-)</p>  <p><strong><em>Update:</em></strong></p>  <p>Ivan Porto Carrero – who’s working on the book <a href="http://www.manning.com/carrero/">IronRuby in Action</a> – is able to reproduce the issue outside of AutoCAD and has offered to log a bug. Hopefully it’ll get addressed in a future build of IronRuby (or someone will spell out how I can handle it cleanly from my side).</p>
