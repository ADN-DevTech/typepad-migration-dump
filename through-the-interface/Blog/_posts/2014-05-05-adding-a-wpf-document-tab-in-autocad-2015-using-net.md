---
layout: "post"
title: "Adding a WPF document tab in AutoCAD 2015 using .NET"
date: "2014-05-05 18:05:40"
author: "Kean Walmsley"
categories:
  - "AutoCAD"
  - "AutoCAD .NET"
  - "Documents"
  - "User interface"
  - "WPF"
original_url: "https://www.keanw.com/2014/05/adding-a-wpf-document-tab-in-autocad-2015-using-net.html "
typepad_basename: "adding-a-wpf-document-tab-in-autocad-2015-using-net"
typepad_status: "Publish"
---

<p>A few people expressed an interest in understanding how AutoCAD 2015’s ability to open HTML pages inside its frame – shown in <a href="http://through-the-interface.typepad.com/through_the_interface/2014/04/adding-a-web-page-as-a-document-tab-in-autocad-2015-using-net.html" target="_blank">this recent post</a> – could be extended to work with “native” user interfaces. This post shows how that can be done using WPF – the other supported mechanism for adding new documents to AutoCAD’s main frame introduced in the 2015 release.</p>  <p>Just as with last week’s post, there really isn’t that much to it: you just need to add your own WPF UserControl to the project and load that into an Autodesk.AutoCAD.Windows.WPFDocumentWindow object and pass it to other version of the DocumentCollection.AddWindowDocument() method. So I went ahead and added a little code to load some hardcoded XML data into a DataGrid hosted by said UserControl. It’s very basic – I haven’t taken care of any real-world concerns in this sample – but then it’s better than staring at a blank window. :-)</p>  <p>Here’s the updated C# code that adds our ADW command to the code we saw last week. You’ll notice it also adds a couple of single-line commands to tile child windows vertically and horizontally, to show how simple that is to implement.</p>  <div style="font-size: 8pt; font-family: courier new; background: white; color: black; line-height: 140%">   <p style="margin: 0px"><span style="color: blue">using</span> Autodesk.AutoCAD.ApplicationServices;</p>    <p style="margin: 0px"><span style="color: blue">using</span> Autodesk.AutoCAD.Runtime;</p>    <p style="margin: 0px"><span style="color: blue">using</span> Autodesk.AutoCAD.Windows;</p>    <p style="margin: 0px"><span style="color: blue">using</span> System;</p>    <p style="margin: 0px"><span style="color: blue">using</span> System.Net;</p>    <p style="margin: 0px"><span style="color: blue">using</span> System.Threading.Tasks;</p>    <p style="margin: 0px"><span style="color: blue">using</span> System.Xml.Linq;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">namespace</span> NewDocumentWindow</p>    <p style="margin: 0px">{</p>    <p style="margin: 0px">&#160; <span style="color: green">// To check whether a page exists, we can use a HEAD request</span></p>    <p style="margin: 0px">&#160; <span style="color: green">// rather than a full GET. Derive a custom client to do that</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: blue">class</span> <span style="color: #2b91af">HeadClient</span> : <span style="color: #2b91af">WebClient</span></p>    <p style="margin: 0px">&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">protected</span> <span style="color: blue">override</span> <span style="color: #2b91af">WebRequest</span> GetWebRequest(<span style="color: #2b91af">Uri</span> address)</p>    <p style="margin: 0px">&#160;&#160;&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">var</span> req = <span style="color: blue">base</span>.GetWebRequest(address);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> (req.Method == <span style="color: #a31515">&quot;GET&quot;</span>)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; req.Method = <span style="color: #a31515">&quot;HEAD&quot;</span>;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">return</span> req;</p>    <p style="margin: 0px">&#160;&#160;&#160; }</p>    <p style="margin: 0px">&#160; }</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: blue">public</span> <span style="color: blue">class</span> <span style="color: #2b91af">Commands</span></p>    <p style="margin: 0px">&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">// Asynchronous helper that checks whether a URL exists</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">// (i.e. that the URL is valid and can be loaded)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">private</span> <span style="color: blue">async</span> <span style="color: blue">static</span> <span style="color: #2b91af">Task</span>&lt;<span style="color: blue">bool</span>&gt; PageExists(<span style="color: blue">string</span> url)</p>    <p style="margin: 0px">&#160;&#160;&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">// First check whether the URL is valid</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">Uri</span> uriResult;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> (</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; !<span style="color: #2b91af">Uri</span>.TryCreate(url, <span style="color: #2b91af">UriKind</span>.Absolute, <span style="color: blue">out</span> uriResult) ||</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; uriResult.Scheme != <span style="color: #2b91af">Uri</span>.UriSchemeHttp</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; )</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">return</span> <span style="color: blue">false</span>;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">// Then we try to peform a HEAD request on the page</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">// (a WebException will be fired if it doesn't exist)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">try</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">using</span>(<span style="color: blue">var</span> client = <span style="color: blue">new</span> <span style="color: #2b91af">HeadClient</span>())</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">await</span> client.DownloadStringTaskAsync(url);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">return</span> <span style="color: blue">true</span>;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; }</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">catch</span> (<span style="color: #2b91af">WebException</span>)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">return</span> <span style="color: blue">false</span>;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; }</p>    <p style="margin: 0px">&#160;&#160;&#160; }</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; [<span style="color: #2b91af">CommandMethod</span>(<span style="color: #a31515">&quot;BLOG&quot;</span>)]</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">public</span> <span style="color: blue">async</span> <span style="color: blue">static</span> <span style="color: blue">void</span> OpenBlog()</p>    <p style="margin: 0px">&#160;&#160;&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">const</span> <span style="color: blue">string</span> url =</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #a31515">&quot;http://blogs.autodesk.com/through-the-interface&quot;</span>;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">// As we're calling an async function, we need to await</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">// (and mark the command itself as async)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> (<span style="color: blue">await</span> PageExists(url))</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// Now that we've validated the URL, we can call the</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// new API in AutoCAD 2015 to load our page</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">Application</span>.DocumentWindowCollection.AddDocumentWindow(</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #a31515">&quot;Kean's blog&quot;</span>, <span style="color: blue">new</span> System.<span style="color: #2b91af">Uri</span>(url)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; );</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; }</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">else</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// Print a helpful message if the URL wasn't loadable</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">var</span> doc = <span style="color: #2b91af">Application</span>.DocumentManager.MdiActiveDocument;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">var</span> ed = doc.Editor;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #a31515">&quot;\nCould not load url: \&quot;{0}\&quot;.&quot;</span>, url</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; );</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; }</p>    <p style="margin: 0px">&#160;&#160;&#160; }</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; [<span style="color: #2b91af">CommandMethod</span>(<span style="color: #a31515">&quot;ADW&quot;</span>)]</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">public</span> <span style="color: blue">static</span> <span style="color: blue">void</span> AddDocumentWindow()</p>    <p style="margin: 0px">&#160;&#160;&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">// Hardcode some XML data</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">var</span> xdoc =</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">XElement</span>.Parse(<span style="color: #a31515">@&quot;</span></p>    <p style="margin: 0px"><span style="color: #a31515">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;orders&gt;</span></p>    <p style="margin: 0px"><span style="color: #a31515">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;order Customer=&quot;&quot;ACME&quot;&quot; Item=&quot;&quot;Widget&quot;&quot; Price=&quot;&quot;100&quot;&quot; /&gt;</span></p>    <p style="margin: 0px"><span style="color: #a31515">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;order Customer=&quot;&quot;ACME&quot;&quot; Item=&quot;&quot;Tyre&quot;&quot; Price=&quot;&quot;200&quot;&quot; /&gt;</span></p>    <p style="margin: 0px"><span style="color: #a31515">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;order Customer=&quot;&quot;Amazon&quot;&quot; Item=&quot;&quot;Pen&quot;&quot; Price=&quot;&quot;50&quot;&quot;/&gt;</span></p>    <p style="margin: 0px"><span style="color: #a31515">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;order Customer=&quot;&quot;Amazon&quot;&quot; Item=&quot;&quot;Paper&quot;&quot; Price=&quot;&quot;20&quot;&quot;/&gt;</span></p>    <p style="margin: 0px"><span style="color: #a31515">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;order Customer=&quot;&quot;Autodesk&quot;&quot; Item=&quot;&quot;CAD&quot;&quot; Price=&quot;&quot;10&quot;&quot;/&gt;</span></p>    <p style="margin: 0px"><span style="color: #a31515">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;order Customer=&quot;&quot;Autodesk&quot;&quot; Item=&quot;&quot;File&quot;&quot; Price=&quot;&quot;40&quot;&quot;/&gt;</span></p>    <p style="margin: 0px"><span style="color: #a31515">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;order Customer=&quot;&quot;ABC&quot;&quot; Item=&quot;&quot;Flowers&quot;&quot; Price=&quot;&quot;503&quot;&quot;/&gt;</span></p>    <p style="margin: 0px"><span style="color: #a31515">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;order Customer=&quot;&quot;ABC&quot;&quot; Item=&quot;&quot;Sand&quot;&quot; Price=&quot;&quot;706&quot;&quot;/&gt;</span></p>    <p style="margin: 0px"><span style="color: #a31515">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/orders&gt;&quot;</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; );</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">// Create our WindowContent WPF UserControl and set the</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">// XML data on our DataGrid object</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">var</span> wc = <span style="color: blue">new</span> <span style="color: #2b91af">WindowContent</span>();</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; wc.MyGrid.DataContext = xdoc;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">// Create a WPFDocumentWindow for our content then open it</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">var</span> dw = <span style="color: blue">new</span> <span style="color: #2b91af">WPFDocumentWindow</span>(wc);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; dw.Title = <span style="color: #a31515">&quot;WPF Document Window&quot;</span>;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">Application</span>.DocumentWindowCollection.AddDocumentWindow(dw);</p>    <p style="margin: 0px">&#160;&#160;&#160; }</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; [<span style="color: #2b91af">CommandMethod</span>(<span style="color: #a31515">&quot;TV&quot;</span>)]</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">public</span> <span style="color: blue">static</span> <span style="color: blue">void</span> TileVertically()</p>    <p style="margin: 0px">&#160;&#160;&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">Application</span>.DocumentWindowCollection.TileVertically();</p>    <p style="margin: 0px">&#160;&#160;&#160; }</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; [<span style="color: #2b91af">CommandMethod</span>(<span style="color: #a31515">&quot;TH&quot;</span>)]</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">public</span> <span style="color: blue">static</span> <span style="color: blue">void</span> TileHorizontally()</p>    <p style="margin: 0px">&#160;&#160;&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">Application</span>.DocumentWindowCollection.TileHorizontally();</p>    <p style="margin: 0px">&#160;&#160;&#160; }</p>    <p style="margin: 0px">&#160; }</p>    <p style="margin: 0px">}</p> </div>  <p>Here’s also the XAML definition of the WPF UserControl I added to the project. Again, very simple stuff.</p>  <div style="font-size: 8pt; font-family: courier new; background: white; color: black; line-height: 140%">   <p style="margin: 0px"><span style="color: blue">&lt;</span><span style="color: #a31515">UserControl</span></p>    <p style="margin: 0px">&#160;<span style="color: red"> x</span><span style="color: blue">:</span><span style="color: red">Class</span><span style="color: blue">=&quot;NewDocumentWindow.WindowContent&quot;</span></p>    <p style="margin: 0px">&#160;<span style="color: red"> xmlns</span><span style="color: blue">=&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></p>    <p style="margin: 0px">&#160;<span style="color: red"> xmlns</span><span style="color: blue">:</span><span style="color: red">x</span><span style="color: blue">=&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span></p>    <p style="margin: 0px">&#160;<span style="color: red"> xmlns</span><span style="color: blue">:</span><span style="color: red">mc</span><span style="color: blue">=</span></p>    <p style="margin: 0px">&#160;&#160; <span style="color: blue">&quot;http://schemas.openxmlformats.org/markup-compatibility/2006&quot;</span> </p>    <p style="margin: 0px">&#160;<span style="color: red"> xmlns</span><span style="color: blue">:</span><span style="color: red">d</span><span style="color: blue">=&quot;http://schemas.microsoft.com/expression/blend/2008&quot;</span> </p>    <p style="margin: 0px">&#160;<span style="color: red"> mc</span><span style="color: blue">:</span><span style="color: red">Ignorable</span><span style="color: blue">=&quot;d&quot;</span> </p>    <p style="margin: 0px">&#160;<span style="color: red"> d</span><span style="color: blue">:</span><span style="color: red">DesignHeight</span><span style="color: blue">=&quot;300&quot;</span><span style="color: red"> d</span><span style="color: blue">:</span><span style="color: red">DesignWidth</span><span style="color: blue">=&quot;300&quot;&gt;</span></p>    <p style="margin: 0px">&#160; <span style="color: blue">&lt;</span><span style="color: #a31515">Grid</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">&lt;</span><span style="color: #a31515">DataGrid</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160; <span style="color: red">x</span><span style="color: blue">:</span><span style="color: red">Name</span><span style="color: blue">=&quot;MyGrid&quot;</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160; <span style="color: red">AutoGenerateColumns</span><span style="color: blue">=&quot;False&quot;</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160; <span style="color: red">ItemsSource</span><span style="color: blue">=&quot;{</span><span style="color: #a31515">Binding</span><span style="color: red"> Path</span><span style="color: blue">=Elements[order]}&quot;</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160; <span style="color: red">HorizontalContentAlignment</span><span style="color: blue">=&quot;Stretch&quot;</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160; <span style="color: red">VerticalContentAlignment</span><span style="color: blue">=&quot;Stretch&quot;</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160; <span style="color: red">FontFamily</span><span style="color: blue">=&quot;Gisha&quot;</span><span style="color: red"> FontSize</span><span style="color: blue">=&quot;24&quot;&gt;</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">&lt;</span><span style="color: #a31515">DataGrid.Columns</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">&lt;</span><span style="color: #a31515">DataGridTextColumn</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: red">Header</span><span style="color: blue">=&quot;Customer&quot;</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: red">Binding</span><span style="color: blue">=&quot;{</span><span style="color: #a31515">Binding</span><span style="color: red"> Path</span><span style="color: blue">=Attribute[Customer].Value}&quot;/&gt;</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">&lt;</span><span style="color: #a31515">DataGridTextColumn</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: red">Header</span><span style="color: blue">=&quot;Item&quot;</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: red">Binding</span><span style="color: blue">=&quot;{</span><span style="color: #a31515">Binding</span><span style="color: red"> Path</span><span style="color: blue">=Attribute[Item].Value}&quot;/&gt;</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">&lt;</span><span style="color: #a31515">DataGridTextColumn</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: red">Header</span><span style="color: blue">=&quot;Price&quot;</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: red">Binding</span><span style="color: blue">=&quot;{</span><span style="color: #a31515">Binding</span><span style="color: red"> Path</span><span style="color: blue">=Attribute[Price].Value}&quot;/&gt;</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">&lt;/</span><span style="color: #a31515">DataGrid.Columns</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">&lt;/</span><span style="color: #a31515">DataGrid</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px">&#160; <span style="color: blue">&lt;/</span><span style="color: #a31515">Grid</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&lt;/</span><span style="color: #a31515">UserControl</span><span style="color: blue">&gt;</span></p> </div>  <p>When we run the ADW command, we see our new window gets created inside the AutoCAD frame:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201a3fd017083970b-pi" target="_blank"><img title="Our WPF-defined document window" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin: 20px auto; border-left: 0px; display: block; padding-right: 0px" border="0" alt="Our WPF-defined document window" src="/assets/image_953725.jpg" width="454" height="348" /></a></p>  <p>If we run the TH command, we see our two windows get tiled horizontally:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201a511b1176c970c-pi" target="_blank"><img title="Horizontally tiled" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin: 20px auto; border-left: 0px; display: block; padding-right: 0px" border="0" alt="Horizontally tiled" src="/assets/image_881880.jpg" width="454" height="348" /></a></p>  <p>Running the previously-defined BLOG command and then tiling vertically using the TV command gives us three windows across the width of the application frame:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201a511b1177d970c-pi" target="_blank"><img title="Vertically tiled" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin: 20px auto; border-left: 0px; display: block; padding-right: 0px" border="0" alt="Vertically tiled" src="/assets/image_164721.jpg" width="454" height="348" /></a></p>  <p>With sub-windows in tiled mode, the Windows theme does impact the overall visual impression given by AutoCAD’s dark theme, but then this is likely to be an uncommon way for people to work (and then it’s always an option for the user to adjust the Windows theme, too).</p>  <p>That’s it for this post. From a UI perspective there are still some capabilities I’d like to explore in AutoCAD 2015, particularly around the theming of PaletteSets. Hopefully we’ll take a look at that in the next week or so.</p>
