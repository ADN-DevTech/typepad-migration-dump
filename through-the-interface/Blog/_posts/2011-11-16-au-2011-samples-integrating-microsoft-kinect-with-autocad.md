---
layout: "post"
title: "AU 2011 Samples: Integrating Microsoft&reg; Kinect&trade; with AutoCAD&reg;"
date: "2011-11-16 18:38:49"
author: "Kean Walmsley"
categories:
  - "AU"
  - "AutoCAD"
  - "AutoCAD .NET"
  - "Jigs"
  - "Kinect"
original_url: "https://www.keanw.com/2011/11/au-2011-samples-integrating-microsoft-kinect-with-autocad.html "
typepad_basename: "au-2011-samples-integrating-microsoft-kinect-with-autocad"
typepad_status: "Publish"
---

<p>Yesterday evening, I had a nice chat by phone with a local development partner, here in Switzerland. I’m meeting with a member of his development team, next week, and we were establishing a way of us identifying one another at the train station. Rather than offering to wear a pink carnation, I suggested the visitor check the photo on my blog before coming. The developer – who had seen me in person, before – suggested it might be helpful if he mentioned to his colleague that I was “short and bald”… I’m apparently shorter than he’d initially expected – clearly not helped by the fact I only have a headshot posted on my blog. It did make me feel a bit like Kurt Russell’s character in <em>Escape from L.A.</em>, where he keeps being told “<a href="http://www.imdb.com/title/tt0116225/quotes?qt=qt0385674" target="_blank">I thought you’d be taller</a>”. Not something <a href="http://thebuildingcoder.typepad.com" target="_blank">Jeremy Tammik</a> ever hears, I suspect. :-)</p>  <p>Anyway, I’ve had some fun over the last few days combining the various Kinect samples I’ve posted on this blog into <a href="http://through-the-interface.typepad.com/files/KinectSamples.zip" target="_blank">a single “KinectSamples” project</a>, which will form the core of the Kinect demos I’ll present at AU 2011. I took the opportunity to factor out common functionality from many of the samples, introducing something of a class hierarchy, in the process.</p>  <p>Here are the commands for you to build and try: </p>  <ul>   <li>KINSKEL      <ul>       <li>“My first Kinect” sample, showing how to create a rudimentary jig to display skeleton data inside AutoCAD </li>     </ul>   </li>    <li>KINECT      <ul>       <li>Dynamically displays a point cloud at the chosen resolution (see KINBOUNDS), and captures/imports a full resolution, colorised point cloud on click </li>     </ul>   </li>    <li>KINBOTH      <ul>       <li>Overlays both skeleton and point cloud data in an AutoCAD jig, creating linear geometry and importing a point cloud on click </li>     </ul>   </li>    <li>KINSNAPS      <ul>       <li>Captures a sequence of point clouds and combines them prior to import </li>     </ul>   </li>    <li>KINSAMP      <ul>       <li>A system variable, rather than a command, that specifies the sampling rate for the point cloud display (50 means one in fifty points gets displayed, 1 means they all do) </li>     </ul>   </li>    <li>KINBOUNDS      <ul>       <li>Allows definition of a clipping volume for point cloud display and import. This clipping volume is respected by all commands in the sample allowing point cloud import </li>     </ul>   </li>    <li>KINPOLY      <ul>       <li>Draws a sequence of 3D polylines while jigging (and then importing) a point cloud </li>     </ul>   </li>    <li>KINEXT      <ul>       <li>Sweeps a circular profile along a spline path </li>     </ul>   </li>    <li>KINEXT2      <ul>       <li>Sweeps a circular profile along a spline path, creating regular segments to improve performance and reliability </li>     </ul>   </li>    <li>KINNAV      <ul>       <li>Navigates a 3D model by adjusting the view based on input from Kinect </li>     </ul>   </li> </ul>  <p>Many of these samples now use the following class hierarchy (listed with a brief description and the names of the commands they help implement):</p>  <ul>   <li>DrawJig (the core AutoCAD base class)      <ul>       <li>KinectSkeletonJig (our simplest sample, kept as a flat class, to simplify copy &amp; paste into a new project – KINSKEL) </li>        <li>KinectJig (base class for the more complex samples, handles sensor initialisation and message forcing)          <ul>           <li>KinectPointCloudJig (handles display of a point cloud - KINECT)              <ul>               <li>KinectCombinedJig (displays a skeleton on top – KINBOTH) </li>                <li>KinectDelayJig (combines a sequence of snapshots – KINSNAPS) </li>                <li>KinectPolyJig (draws 3D polylines – KINPOLY) </li>                <li>KinectSolidsJig (sweeps a circle along a spline path – KINEXT) </li>                <li>KinectSegmentedSolidsJig (ditto in segments – KINEXT2) </li>             </ul>           </li>         </ul>       </li>     </ul>   </li> </ul>  <p>I may yet factor some more in advance of AU – there may be an opportunity to put some kind of gesture handling base class in there, for instance – but having too deep a hierarchy may also make it a little harder to understand the code. We’ll see what makes sense (and I get time for).</p>
