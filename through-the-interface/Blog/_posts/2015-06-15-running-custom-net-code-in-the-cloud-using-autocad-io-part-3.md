---
layout: "post"
title: "Running custom .NET code in the cloud using AutoCAD I/O &ndash; Part 3"
date: "2015-06-15 16:34:43"
author: "Kean Walmsley"
categories:
  - "AutoCAD .NET"
  - "AutoCAD I/O"
  - "Runtime"
  - "XML"
original_url: "https://www.keanw.com/2015/06/running-custom-net-code-in-the-cloud-using-autocad-io-part-3.html "
typepad_basename: "running-custom-net-code-in-the-cloud-using-autocad-io-part-3"
typepad_status: "Publish"
---

<p>After <a href="http://through-the-interface.typepad.com/through_the_interface/2015/06/running-custom-net-code-in-the-cloud-using-autocad-io-part-1.html" target="_blank">introducing the series</a> and looking at <a href="http://through-the-interface.typepad.com/through_the_interface/2015/06/running-custom-net-code-in-the-cloud-using-autocad-io-part-2.html" target="_blank">the additional code needed for a .NET CRX app to work with AutoCAD I/O</a>, in this post we’re going to go the extra small step to prepare the Autoloader manifest, getting it ready to create the Activity and its AppPackage.</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201b8d1282bfb970c-pi" target="_blank"><img title="The sample project on GitHub" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: none; padding-top: 0px; padding-left: 0px; margin: 20px auto; border-left: 0px; display: block; padding-right: 0px" border="0" alt="The sample project on GitHub" src="/assets/image_49323.jpg" width="400" height="288" /></a></p>  <p>To simplify the process of developing this app, I recommend a couple of things: download <a href="https://github.com/Developer-Autodesk/workflow-custom-activity-with-apppackage-autocad.io" target="_blank">the sample on GitHub</a> I pointed you at, last time – whether by cloning the project or downloading it as a ZIP – and make modifications directly to that. To build the sample I’m creating, for instance, you can drop the C# code from the last post into <em>CrxApp\Commands.cs</em> and today’s XML data into <em>CrxApp\PackageContents.xml</em>.</p>  <p>The actual creation of the AppPackage – and its upload to AutoCAD I/O – will be taken care of by the <em>Client</em> sub-project: this is a command-line administration tool that does all that for you. It only needs to be performed once – or only as often as your AppPackage needs to be updated, anyway.</p>  <p>Here’s the XML manifest for our Autoloader package:</p>  <div style="font-size: 8pt; font-family: courier new; background: white; color: black; line-height: 140%">   <p style="margin: 0px"><span style="color: blue">&lt;?</span><span style="color: #a31515">xml</span><span style="color: blue"> </span><span style="color: red">version</span><span style="color: blue">=</span>&quot;<span style="color: blue">1.0</span>&quot;<span style="color: blue"> </span><span style="color: red">encoding</span><span style="color: blue">=</span>&quot;<span style="color: blue">utf-8</span>&quot;<span style="color: blue"> ?&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&lt;</span><span style="color: #a31515">ApplicationPackage</span></p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160; </span><span style="color: red">SchemaVersion</span><span style="color: blue">=</span>&quot;<span style="color: blue">1.0</span>&quot;</p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160; </span><span style="color: red">Version</span><span style="color: blue">=</span>&quot;<span style="color: blue">1.0</span>&quot;</p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160; </span><span style="color: red">ProductCode</span><span style="color: blue">=</span>&quot;&quot;</p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160; </span><span style="color: red">HelpFile</span><span style="color: blue">=</span>&quot;&quot;</p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160; </span><span style="color: red">Name</span><span style="color: blue">=</span>&quot;<span style="color: blue">JigsawPackage</span>&quot;</p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160; </span><span style="color: red">Description</span><span style="color: blue">=</span>&quot;<span style="color: blue">Jigsaw Creation Package</span>&quot;</p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160; </span><span style="color: red">Author</span><span style="color: blue">=</span>&quot;<span style="color: blue">Kean Walmsley</span>&quot;<span style="color: blue"> &gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160; &lt;</span><span style="color: #a31515">CompanyDetails</span></p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160; </span><span style="color: red">Name</span><span style="color: blue">=</span>&quot;<span style="color: blue">Autodesk, Inc</span>&quot;</p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160; </span><span style="color: red">Phone</span><span style="color: blue">=</span>&quot;<span style="color: blue">415.555.5555</span>&quot;</p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160; </span><span style="color: red">Url</span><span style="color: blue">=</span>&quot;<span style="color: blue">www.autodesk.com</span>&quot;</p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160; </span><span style="color: red">Email</span><span style="color: blue">=</span>&quot;<span style="color: blue">kean.walmsley@autodesk.com</span>&quot;<span style="color: blue"> /&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160; &lt;</span><span style="color: #a31515">Components</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="color: #a31515">RuntimeRequirements</span><span style="color: blue"> </span></p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: red">OS</span><span style="color: blue">=</span>&quot;<span style="color: blue">Win64</span>&quot;<span style="color: blue"> </span></p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: red">Platform</span><span style="color: blue">=</span>&quot;<span style="color: blue">AutoCAD</span>&quot;<span style="color: blue"> /&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="color: #a31515">ComponentEntry</span></p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: red">AppName</span><span style="color: blue">=</span>&quot;<span style="color: blue">JigsawPackage</span>&quot;</p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: red">ModuleName</span><span style="color: blue">=</span>&quot;<span style="color: blue">./Contents/Jigsaw.dll</span>&quot;</p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: red">AppDescription</span><span style="color: blue">=</span>&quot;<span style="color: blue">Jigsaw creation app</span>&quot;</p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: red">LoadOnCommandInvocation</span><span style="color: blue">=</span>&quot;<span style="color: blue">True</span>&quot;</p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: red">LoadOnAutoCADStartup</span><span style="color: blue">=</span>&quot;<span style="color: blue">False</span>&quot;<span style="color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="color: #a31515">Commands</span><span style="color: blue"> </span><span style="color: red">GroupName</span><span style="color: blue">=</span>&quot;<span style="color: blue">Commands</span>&quot;<span style="color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="color: #a31515">Command</span><span style="color: blue"> </span><span style="color: red">Global</span><span style="color: blue">=</span>&quot;<span style="color: blue">JIGG</span>&quot;<span style="color: blue"> </span><span style="color: red">Local</span><span style="color: blue">=</span>&quot;<span style="color: blue">JIGG</span>&quot;<span style="color: blue"> /&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="color: #a31515">Command</span><span style="color: blue"> </span><span style="color: red">Global</span><span style="color: blue">=</span>&quot;<span style="color: blue">JIGIO</span>&quot;<span style="color: blue"> </span><span style="color: red">Local</span><span style="color: blue">=</span>&quot;<span style="color: blue">JIGIO</span>&quot;<span style="color: blue"> /&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="color: #a31515">Command</span><span style="color: blue"> </span><span style="color: red">Global</span><span style="color: blue">=</span>&quot;<span style="color: blue">WIGL</span>&quot;<span style="color: blue"> </span><span style="color: red">Local</span><span style="color: blue">=</span>&quot;<span style="color: blue">WIGL</span>&quot;<span style="color: blue"> /&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="color: #a31515">Command</span><span style="color: blue"> </span><span style="color: red">Global</span><span style="color: blue">=</span>&quot;<span style="color: blue">JIGL</span>&quot;<span style="color: blue"> </span><span style="color: red">Local</span><span style="color: blue">=</span>&quot;<span style="color: blue">JIGL</span>&quot;<span style="color: blue"> /&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="color: #a31515">Command</span><span style="color: blue"> </span><span style="color: red">Global</span><span style="color: blue">=</span>&quot;<span style="color: blue">JIG</span>&quot;<span style="color: blue"> </span><span style="color: red">Local</span><span style="color: blue">=</span>&quot;<span style="color: blue">JIG</span>&quot;<span style="color: blue"> /&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/</span><span style="color: #a31515">Commands</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="color: #a31515">AssemblyMappings</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="color: #a31515">AssemblyMapping</span></p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: red">Name</span><span style="color: blue">=</span>&quot;<span style="color: blue">JigsawPackage.Newtonsoft.Json</span>&quot;</p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: red">Path</span><span style="color: blue">=</span>&quot;<span style="color: blue">./Contents/Newtonsoft.Json.dll</span>&quot;<span style="color: blue"> /&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/</span><span style="color: #a31515">AssemblyMappings</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160; &lt;/</span><span style="color: #a31515">ComponentEntry</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="color: #a31515">ComponentEntry</span></p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: red">AppName</span><span style="color: blue">=</span>&quot;<span style="color: blue">JigsawPackage.Newtonsoft.Json</span>&quot;</p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: red">AppType</span><span style="color: blue">=</span>&quot;<span style="color: blue">Dependency</span>&quot;</p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: red">ModuleName</span><span style="color: blue">=</span>&quot;<span style="color: blue">./Contents/Newtonsoft.Json.dll</span>&quot;</p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: red">AppDescription</span><span style="color: blue">=</span>&quot;<span style="color: blue">JSON processing library</span>&quot;</p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: red">LoadOnAutoCADStartup</span><span style="color: blue">=</span>&quot;<span style="color: blue">False</span>&quot;<span style="color: blue"> /&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&#160;&#160;&#160; &lt;/</span><span style="color: #a31515">Components</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&lt;/</span><span style="color: #a31515">ApplicationPackage</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="color: blue"></span></p>    <p style="margin: 0px"><span style="color: blue"></span></p> </div>  <p>You’ll notice a few things: we’ve enumerated the various commands, even though we could just have the module loaded on AutoCAD start-up. This is assuming you’ll want to use the same Autoloader bundle for your desktop and your AutoCAD I/O application (which may well not be the case).</p>  <p>You may also have spotted that we’re using <a href="https://www.nuget.org/packages/newtonsoft.json/" target="_blank">Newtonsoft’s Json.NET</a> module: this is fairly standard for a .NET app, these days. This is the component our own code (from the last post) requires to unpack the JSON parameters we read in from the text file, and therefore needs to be available to the module when up in the cloud.</p>  <p>In the next post we’ll see how to use the Client sub-project to create our Activity and its AppPackage in AutoCAD I/O.</p>
