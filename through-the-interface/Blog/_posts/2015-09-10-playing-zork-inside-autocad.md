---
layout: "post"
title: "Playing Zork inside AutoCAD"
date: "2015-09-10 19:05:36"
author: "Kean Walmsley"
categories:
  - "AutoCAD"
  - "Core Console"
  - "Games"
  - "Personal"
  - "Retro computing"
original_url: "https://www.keanw.com/2015/09/playing-zork-inside-autocad.html "
typepad_basename: "playing-zork-inside-autocad"
typepad_status: "Publish"
---

<p>The nostalgia is strong in this one. (In both this post and this blogger, in case you’re wondering.)</p>  <p>It started with <a href="http://through-the-interface.typepad.com/through_the_interface/2015/08/it-was-twenty-years-ago-today.html" target="_blank">my 20th anniversary at Autodesk</a>, but it got worse, last weekend, when I travelled to the UK to celebrate the <a href="http://www.kent.ac.uk/50" target="_blank">50th anniversary</a> of the <a href="http://www.kent.ac.uk" target="_blank">University of Kent</a> (where I studied, back in the day, about halfway through its history). I’d coordinated with a couple of close friends, so we descended on Canterbury from Switzerland, Connecticut and Windsor, and joined a thousand or so alumni for a really fun, celebratory weekend, revisiting old haunts and sharing old memories.</p>  <p>Doubling down on the somewhat dubious nostalgia derived from using the same student accommodation as I did back in 1991, I chose to burn through the first season of “<a href="https://en.wikipedia.org/wiki/Halt_and_Catch_Fire_(TV_series)" target="_blank">Halt and Catch Fire</a>” during the trip, too. This is set in 1983 and talks about the birth of the PC revolution, as John Walker did when I <a href="http://through-the-interface.typepad.com/through_the_interface/2008/09/an-interview-wi.html" target="_blank">interviewed</a> <a href="http://through-the-interface.typepad.com/through_the_interface/2008/09/an-interview--1.html" target="_blank">him</a>&#160;<a href="http://through-the-interface.typepad.com/through_the_interface/2008/09/an-interview--2.html" target="_blank">some</a> <a href="http://through-the-interface.typepad.com/through_the_interface/2008/10/an-interview-wi.html" target="_blank">years ago</a>. A brilliant show that I’m sure most people in our industry would thoroughly enjoy.</p>  <p>After getting back from the UK on Sunday, I hopped across to Prague on Tuesday morning for a <a href="http://through-the-interface.typepad.com/through_the_interface/2015/09/i-3-dwg-meetup-in-prague.html" target="_blank">Meetup</a>. I had a bit of time to kill in the hotel, on Wednesday morning, which is when the nostalgia peaked… on the trip over I’d started reading <a href="http://amzn.to/1FzG3CE" target="_blank">an excellent anthology of computer game-inspired short stories</a>, so I said to myself “wouldn’t it be cool to play old school <a href="https://en.wikipedia.org/wiki/Interactive_fiction" target="_blank">text adventures</a> directly inside AutoCAD? I wonder if it’s even possible?”</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201b7c7cbbc12970b-pi" target="_blank"><img title="Zork I" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; float: right; padding-top: 0px; padding-left: 0px; margin: 20px 0px 20px 50px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="Zork I" src="/assets/image_650326.jpg" width="222" align="right" height="264" /></a>What followed was a fun couple of caffeine-fuelled hours which led to a basic .NET application allowing you to play <a href="https://en.wikipedia.org/wiki/Zork" target="_blank">Zork</a> I, II &amp; III (along with a host of other games – more on that in a bit – directly inside AutoCAD via its command-line). It turns out that the old <a href="https://en.wikipedia.org/wiki/Infocom" target="_blank">Infocom</a> adventures – starting with Zork – were coded against a <a href="https://en.wikipedia.org/wiki/Virtual_machine" target="_blank">virtual machine</a> called <a href="https://en.wikipedia.org/wiki/Z-machine" target="_blank">Z-machine</a>, allowing them to be ported more easily to other platforms. And, guess what? There’s a .NET version of Z-machine available, called <a href="https://bitbucket.org/jmcgrew/zlr/overview" target="_blank">ZLR</a>, allowing you to play <a href="http://zmpp.sourceforge.net/games" target="_blank">a whole slew of Infocom games</a> (although apparently the Zork trilogy may well be the only ones not still under copyright) on Windows and integrated into Windows applications.</p>  <p>The C# code needed to integrate the ZLR into AutoCAD, and to wire it up to a few ROMs for the various Zork games, ended up being pretty trivial. I had to use Editor.GetString() and WriteMessage() – rather than Console.Read() and Write() – but nothing very tricky. Here’s <a href="http://through-the-interface.typepad.com/files/AcadZMachine.zip" target="_blank">the basic source project</a> – which includes a built DLL and the Zork trilogy ROMs, to save you some work – which enables the ZORK, ZORK2 and ZORK3 commands inside AutoCAD (as well as a ZM command to load an arbitrary Z-machine ROM you’ve downloaded yourself). Oh, and here’s a <a href="http://www.eristic.net/games/infocom/zork1.html" target="_blank">walkthrough</a>, in case you get stuck.</p>  <p>It’s a CRX app, so works well from the <a href="http://through-the-interface.typepad.com/through_the_interface/2012/02/the-autocad-2013-core-console.html" target="_blank">Core Console</a> (and would also work inside <a href="http://through-the-interface.typepad.com/through_the_interface/autocad-io/" target="_blank">AutoCAD I/O</a>, but then you can also play <a href="https://archive.org/details/a2_Zork_I_The_Great_Underground_Empire_1980_Infocom" target="_blank">Zork I</a>, <a href="https://archive.org/details/a2_Zork_II_The_Wizard_of_Frobozz_1981_Infocom_a" target="_blank">II</a> &amp; <a href="https://archive.org/details/a2_Zork_III_The_Dungeon_Master_1982_Infocom" target="_blank">III</a> online interactively, so it’s hard to find a sensible use-case for that ;-).</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201b7c7cbbc1a970b-pi"><img title="Zork in AutoCAD" style="float: none; margin: 50px auto; display: block" alt="Zork in AutoCAD" src="/assets/image_785473.jpg" width="474" height="474" /></a></p>  <p>I mentioned this bit of fun to my friend and colleague, <a href="http://through-the-interface.typepad.com/through_the_interface/2014/05/christer-janson-maker-of-the-day.html" target="_blank">Christer Janson</a>, and his first comment was “I spent hours drawing maps of Zork when I was a kid… can you have AutoCAD draw the map automatically as you play?” It turns out that Zork maps are notoriously tricky – the worlds typically aren’t simple grids of locations – but we’ll just have to see what we can do in a future post…</p>
