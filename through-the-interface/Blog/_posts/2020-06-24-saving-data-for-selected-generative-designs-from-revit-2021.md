---
layout: "post"
title: "Saving data for selected generative designs from Revit 2021"
date: "2020-06-24 14:55:04"
author: "Kean Walmsley"
categories:
  - "Dynamo"
  - "Generative design"
  - "Revit"
original_url: "https://www.keanw.com/2020/06/saving-data-for-selected-generative-designs-from-revit-2021.html "
typepad_basename: "saving-data-for-selected-generative-designs-from-revit-2021"
typepad_status: "Publish"
---

<p>In the last post we saw <a href="https://www.keanw.com/2020/06/managing-data-flow-to-and-from-generative-design-studies-in-revit-2021.html">how the Data.Gate node can be used to send geometry to Revit 2021 when the “Create Revit Elements” button gets pressed from the Explore Outcomes UI for a Generative Design study</a>. Phew.</p><p>In this post we’re going to dig into how this node can also be used to have other “<a href="https://en.wikipedia.org/wiki/Side_effect_(computer_science)">side effects</a>” such as storing the various input parameters to a text file. For the purpose of this workflow I’ve chosen to hack the standard <em>Three Box Massing.dyn</em> graph (which ships with Revit 2021 as a sample for the Generative Design feature).</p><p>The general approach I took was to take the graph’s input parameters and combine them into a list that gets encoded as a string. This is the input for the Data.Gate node (actually the second Data.Gate node, as I’ve left the one that controls the Revit geometry creation). When the gate is opened, this string will get appended to an arbitrary text file (which I happen to store at “<em>c:\temp\designs.txt</em>”).</p><p>Here’s the modified graph (which you <a href="https://through-the-interface.typepad.com/files/Three%20Box%20Massing%20-%20hacked.dyn" target="_blank">can also download from here</a>):</p><p><a href="https://through-the-interface.typepad.com/.a/6a00d83452464869e20263e9527d19200b-pi" target="_blank"><img width="503" height="316" title="The modified Three Box Massing graph" style="margin: 30px auto; float: none; display: block; background-image: none;" alt="The modified Three Box Massing graph" src="/assets/image_256542.jpg" border="0"></a></p><p>Here’s a close-up of the area with the most significant changes:</p><p><a href="https://through-the-interface.typepad.com/.a/6a00d83452464869e20264e2e49727200d-pi" target="_blank"><img width="503" height="316" title="A close-up of the file writing nodes" style="margin: 30px auto; float: none; display: block; background-image: none;" alt="A close-up of the file writing nodes" src="/assets/image_468947.jpg" border="0"></a></p><p>Let’s now take a look at the results of this workflow. I’ve compiled the below animation from screenshots of the various designs being selected in the Explore Outcomes UI alongside the output in the <em>designs.txt</em> text file. Bear in mind I haven’t shown the steps where the “Create Revit Elements” button is pressed, or the text file is (manually) reloaded into Notepad once the Revit elements have been created and <em>designs.txt</em> updated – something that I did manually after selecting each design</p><p><a href="https://through-the-interface.typepad.com/.a/6a00d83452464869e20263e952dd18200b-pi" target="_blank"><img width="500" height="313" title="Save to file" style="margin: 30px auto; float: none; display: block;" alt="Save to file" src="/assets/image_832719.jpg"></a></p><p>Of course more work will be needed to make sure the file is cleared at appropriate times (and perhaps having a separate file for each&nbsp; model).</p><p>One addition question relates to getting this working outside of Revit – such as when running Dynamo Sandbox (and the Generative Design feature in standalone mode). In this scenario there is no “Create Revit Elements” button: it’s replaced with a “Open in Dynamo” button, which doesn’t cause the Data.Gate nodes to be opened.</p><p>If you want your side effect to be executed when “Open in Dynamo” is pressed, the simplest answer is probably to publish a version of the graph that does not have a Data.Gate controlling this logic: in this scenario it would always write the input parameters to a file. Having the graph set to run automatically would also make the process a little more streamlined. The downside to this is – of course – that this side effect will happen for each execution of the graph, even when it’s being managed by the Generative Design feature. This isn’t necessarily a problem, but your workflow would need to manage the step of removing (or emptying) the file before the user selection process starts.</p><p>So what can we do with this set of selected designs? It would be a great way to drive a tool such as <a href="https://www.keanw.com/2019/06/capturefinery-is-live-on-the-dynamo-package-manager.html" target="_blank">Capturefinery</a> that collects more interesting graphical detail about the design, for instance. (Right now Capturefinery works with the output of the GD feature – which is stored in JSON and CSV files – but it wouldn’t be so hard to either create a file with a similar structure directly from Dynamo or to adapt <a href="https://github.com/KeanW/Capturefinery" target="_blank">the Capturefinery code</a> to load this simplified version of the parameter data.)</p>
