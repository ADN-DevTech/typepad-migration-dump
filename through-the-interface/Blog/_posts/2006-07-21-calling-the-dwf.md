---
layout: "post"
title: "Calling the DWFRender Web Service from HTML"
date: "2006-07-21 09:43:47"
author: "Kean Walmsley"
categories:
  - "AJAX"
  - "DWF"
  - "SaaS"
original_url: "https://www.keanw.com/2006/07/calling_the_dwf.html "
typepad_basename: "calling_the_dwf"
typepad_status: "Publish"
---

<p>I decided to go ahead and put a test page together for the <a href="http://dwfit.com/dwfRender.asmx">DWFRender Web Service</a>. It still wasn't feasible to make it part of the blog itself, given the issues with scripting, particularly, but I've included the files here for you to download and run locally:</p>

<p><a href="http://through-the-interface.typepad.com/through_the_interface/files/freewheel_web_service_test.zip">Download freewheel_web_service_test.zip</a></p>

<p>There are three web methods called by this code:</p>

<ul><li><strong>pdkVersion</strong> - gets the version of the PDK on the server (a string value)</li>

<li><strong>pageCount</strong> - gets the number of pages for a particular DWF file (an integer value)</li>

<li><strong>load</strong> - gets more detailed information about each page in a DWF (a more complex data structure is used for this)</li></ul>

<p>Web Services are generally called asynchronously from HTML, which means the call is made and the page then sits back until either a callback is invoked or an event is fired (the <a href="http://msdn.microsoft.com/workshop/author/webservice/webservice.asp">Web Service Behavior </a>used in the attached sample - and linked to in my previous post - can be made to work with both approaches... I've chosen to use callbacks in my code, as it allows more flexibility when handling different result types: you can have different callback functions invoked depending on the datatype you expect to receive).</p>

<p>The first two methods will return basic dataypes - here are typical results without the SOAP header:</p>

<p><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">pdkVersionResult</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;">1.4.1976.5fw</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">pdkVersionResult</span><span style="color: #0000ff;">&gt;</span> </p>

<p><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">pageCountResult</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;">5</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">pageCountResult</span><span style="color: #0000ff;">&gt;</span> </p>

<p dir="ltr"></p>

<p dir="ltr"></p>

<p>Inside the attached code it is simple to access these datatypes by using result.value in the callback receiving the results.</p>

<p>For the load method, however, things are more complicated. As a complex datatype is used to return the information about the various pages, you will need to use result.raw.xml to access the underlying XML content:<br /><span style="color: #0000ff;"><br />&lt;</span><span style="color: #800000;">loadResponse</span><span style="color: #0000ff;">&nbsp;</span><span style="color: #ff0000;">xmlns</span><span style="color: #0000ff;">=</span><span style="color: #0000ff;">&quot;</span><span style="color: #0000ff;">http://autodesk.com/DWFRender</span><span style="color: #0000ff;">&quot;</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> <br />&nbsp; &lt;</span><span style="color: #800000;">loadResult</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> <br />&nbsp; &nbsp; &lt;</span><span style="color: #800000;">pageCount</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;">5</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">pageCount</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> <br />&nbsp; &nbsp; &lt;</span><span style="color: #800000;">sectionInfo</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> <br />&nbsp; &nbsp;&nbsp; &nbsp;&lt;</span><span style="color: #800000;">SectionInformation</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> <br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &lt;</span><span style="color: #800000;">name</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;">Assembly Exploded:1</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">name</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> <br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &lt;</span><span style="color: #800000;">paperSize</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> <br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; &lt;</span><span style="color: #800000;">units</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;">kMillimeters</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">units</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> <br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; &lt;</span><span style="color: #800000;">width</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;">431.8</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">width</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> <br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; &lt;</span><span style="color: #800000;">height</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;">279.40000000000003</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">height</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> <br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &lt;/</span><span style="color: #800000;">paperSize</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> <br />&nbsp; &nbsp;&nbsp; &nbsp;&lt;/</span><span style="color: #800000;">SectionInformation</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> <br />&nbsp; &nbsp;&nbsp; &nbsp;&lt;</span><span style="color: #800000;">SectionInformation</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> <br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &lt;</span><span style="color: #800000;">name</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;">Assembly:2</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">name</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> <br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &lt;</span><span style="color: #800000;">paperSize</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> <br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; &lt;</span><span style="color: #800000;">units</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;">kMillimeters</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">units</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> <br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; &lt;</span><span style="color: #800000;">width</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;">431.8</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">width</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> <br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; &lt;</span><span style="color: #800000;">height</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;">279.40000000000003</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">height</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> <br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &lt;/</span><span style="color: #800000;">paperSize</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> <br />&nbsp; &nbsp;&nbsp; &nbsp;&lt;/</span><span style="color: #800000;">SectionInformation</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> <br />&nbsp; &nbsp;&nbsp; &nbsp;&lt;</span><span style="color: #800000;">SectionInformation</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> <br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &lt;</span><span style="color: #800000;">name</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;">Sony PSP Body:3</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">name</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> <br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &lt;</span><span style="color: #800000;">paperSize</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> <br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; &lt;</span><span style="color: #800000;">units</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;">kMillimeters</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">units</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> <br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; &lt;</span><span style="color: #800000;">width</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;">431.8</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">width</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> <br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; &lt;</span><span style="color: #800000;">height</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;">279.40000000000003</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">height</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> <br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &lt;/</span><span style="color: #800000;">paperSize</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> <br />&nbsp; &nbsp;&nbsp; &nbsp;&lt;/</span><span style="color: #800000;">SectionInformation</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> <br />&nbsp; &nbsp;&nbsp; &nbsp;&lt;</span><span style="color: #800000;">SectionInformation</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> <br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &lt;</span><span style="color: #800000;">name</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;">UMD COVER:4</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">name</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> <br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &lt;</span><span style="color: #800000;">paperSize</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> <br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; &lt;</span><span style="color: #800000;">units</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;">kMillimeters</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">units</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> <br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; &lt;</span><span style="color: #800000;">width</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;">279.40000000000003</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">width</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> <br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; &lt;</span><span style="color: #800000;">height</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;">215.9</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">height</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> <br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &lt;/</span><span style="color: #800000;">paperSize</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> <br />&nbsp; &nbsp;&nbsp; &nbsp;&lt;/</span><span style="color: #800000;">SectionInformation</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> <br />&nbsp; &nbsp;&nbsp; &nbsp;&lt;</span><span style="color: #800000;">SectionInformation</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> <br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &lt;</span><span style="color: #800000;">name</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;">MAGIC GATE COVER:5</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">name</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> <br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &lt;</span><span style="color: #800000;">paperSize</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> <br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; &lt;</span><span style="color: #800000;">units</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;">kMillimeters</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">units</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> <br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; &lt;</span><span style="color: #800000;">width</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;">279.40000000000003</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">width</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> <br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; &lt;</span><span style="color: #800000;">height</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;">215.9</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">height</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> <br />&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &lt;/</span><span style="color: #800000;">paperSize</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> <br />&nbsp; &nbsp;&nbsp; &nbsp;&lt;/</span><span style="color: #800000;">SectionInformation</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> <br />&nbsp; &nbsp; &lt;/</span><span style="color: #800000;">sectionInfo</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> <br />&nbsp; &lt;/</span><span style="color: #800000;">loadResult</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> <br />&lt;/</span><span style="color: #800000;">loadResponse</span><span style="color: #0000ff;">&gt;</span> </p>
