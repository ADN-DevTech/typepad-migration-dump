---
layout: "post"
title: "Registering AutoCAD commands with localized names using .NET"
date: "2009-06-08 08:55:07"
author: "Kean Walmsley"
categories:
  - "AutoCAD"
  - "AutoCAD .NET"
  - "Commands"
  - "Runtime"
original_url: "https://www.keanw.com/2009/06/registering-autocad-commands-with-localized-names-using-net.html "
typepad_basename: "registering-autocad-commands-with-localized-names-using-net"
typepad_status: "Publish"
---

<p>While I was preparing <a href="http://through-the-interface.typepad.com/through_the_interface/2009/05/creating-demand-loading-entries-automatically-for-your-autocad-application-using-net.html">this recent post</a> I put together a simple project which registered localized names for commands, to make sure they were picked up and used to create the appropriate demand-loading Registry keys. It was a little tricky to do this from the current documentation, so thankfully I had access to <a href="http://adn.autodesk.com/adn/servlet/devnote?siteID=4814862&amp;id=8146540&amp;linkID=4900509">this DevNote on the ADN site</a> which helped a great deal (this is only available to ADN members but don’t worry if you’re not one: this post should provide equivalent information and in certain ways goes beyond the original example).</p>  <p>Anyway, it seemed a relevant topic to cover in its own post, so here we are today looking at this question: how to register localized command-names – possibly for multiple target languages – for your AutoCAD commands.</p>  <p>First of all we need to register some commands, the code for which proves to be pretty straightforward. Here’s the C# code defining our commands, which we will save in a file named Commands.cs:</p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.ApplicationServices;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.Runtime;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">namespace</span><span style="line-height: 140%"> LocalizedCommands</span></p>    <p style="margin: 0px"><span style="line-height: 140%">{</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">class</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">LocCmds</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; [</span><span style="line-height: 140%; color: #2b91af">CommandMethod</span><span style="line-height: 140%">(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;LOCCMDS&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;HELLO&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;helloCmdId&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #2b91af">CommandFlags</span><span style="line-height: 140%">.Modal</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; )]</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> HelloCommand()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Application</span><span style="line-height: 140%">.DocumentManager.MdiActiveDocument.Editor.</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; WriteMessage(</span><span style="line-height: 140%; color: #a31515">&quot;\nHello!&quot;</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; [</span><span style="line-height: 140%; color: #2b91af">CommandMethod</span><span style="line-height: 140%">(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;LOCCMDS&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;GOODBYE&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;goodbyeCmdId&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #2b91af">CommandFlags</span><span style="line-height: 140%">.Modal</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; )]</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> GoodbyeCommand()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Application</span><span style="line-height: 140%">.DocumentManager.MdiActiveDocument.Editor.</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; WriteMessage(</span><span style="line-height: 140%; color: #a31515">&quot;\nGoodbye!&quot;</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">}</span></p> </div> <!--EndFragment-->  <p>You’ll notice straight away that we’re using a special version of the CommandMethod attribute which specifies more than the usual items (command name and flags are the most common ones). We start with the command group (“LOCCMDS”), the global names (“HELLO” and “GOODBYE”), the localized resource IDs (“helloCmdId” and “goodbyeCmdId”) and then come the flags (CommandFlags.Modal).</p>  <p>The localized command name is provided as a resource ID to aid localization. Let’s see how this helps… we’ll add some resources to the project for our neutral culture (US English) and for two additional cultures (French and German).</p>  <p>We can add resource files by right-clicking the project and selecting Add –&gt; New Item:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2011570d4467e970b-pi"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="Add a new item to the project" border="0" alt="Add a new item to the project" src="/assets/image_470907.jpg" width="354" height="301" /></a> </p>  <p>From here we can use the Add New Item dialog to add new resource files with the names “Commands.resx” (which is for the neutral culture, US English), “Commands.fr-FR.resx” and “Commands.de-DE.resx” (these three files will need to be added one-by-one). It’s important that the resource files use the same base name as the .cs file (they do not have to use the class name – LocCmds – and, in fact, you may run into name collisions if you attempt to do so).</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2011570d4471d970b-pi"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="Adding a new resource file" border="0" alt="Adding a new resource file" src="/assets/image_951413.jpg" width="479" height="289" /></a> </p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201156fdf39b0970c-pi"><img style="border-right-width: 0px; margin: 10px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="Our solution" border="0" alt="Our solution" align="right" src="/assets/image_484257.jpg" width="265" height="257" /></a></p>  <p>&#160;</p>  <p>So far, so good. We should now see the resultant files in our solution explorer, and be able to open them by double-clicking them.</p>  <p>The files will be blank initially, and we will want to add two string resources to each, one for each of our commands, using the IDs “helloCmdId” and “goodbyeCmdId”.</p>  <p>&#160;</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2011570d44801970b-pi"><img style="border-right-width: 0px; margin: 10px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="Question" border="0" alt="Question" align="right" src="/assets/image_953987.jpg" width="332" height="167" /></a></p>  <p>&#160;</p>  <p>When we come to edit the individual string resources, we may be presented with a warning dialog (it is safe to select Yes):</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2011570d44801970b-pi"></a></p>  <p>&#160;</p>  <p>Now we can go ahead and add localized string resources for our two commands in each of the three cultures:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201156fdf3aa0970c-pi"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; margin-left: 0px; border-left-width: 0px; margin-right: 0px" title="Our resources" border="0" alt="Our resources" src="/assets/image_723561.jpg" width="483" height="483" /></a> </p>  <p>It should now be possible to build our application. If we take a look at the output folder, we should see sub-folders for each of our cultures:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201156fdf3aac970c-pi"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; margin-left: 0px; border-left-width: 0px; margin-right: 0px" title="Directory structure with resource DLLs" border="0" alt="Directory structure with resource DLLs" src="/assets/image_470356.jpg" width="468" height="238" /></a> </p>  <p>The en-US folder will be empty, as we’ve included that as our base culture, but the other two will contain resource DLLs (also known as satellite assemblies) containing our localized strings for that target culture.</p>  <p>Now to see these in action. In order to fake the loading of our assembly into different language versions of AutoCAD, I put together a simple application to change the UI culture (the one used by the resource manager to choose the resources to load) of the current thread. This clearly needs to be in a separate assembly, as we want to change the culture before we use NETLOAD to load the assembly containing our localized commands.</p>  <p>Here’s the C# code:</p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.ApplicationServices;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.Runtime;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> System.Threading;</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> System.Globalization;</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%; color: blue">namespace</span><span style="line-height: 140%"> CultureShift</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">{</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">class</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Commands</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160; {</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> setCulture(</span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%"> culture)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Thread</span><span style="line-height: 140%">.CurrentThread.CurrentUICulture =</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">CultureInfo</span><span style="line-height: 140%">(culture);</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> setNeutralCulture(</span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%"> neutCult)</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Thread</span><span style="line-height: 140%">.CurrentThread.CurrentUICulture =</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">CultureInfo</span><span style="line-height: 140%">.CreateSpecificCulture(neutCult);</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; [</span><span style="line-height: 140%; color: #2b91af">CommandMethod</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: #a31515">&quot;SETFR&quot;</span><span style="line-height: 140%">)]</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> SetFrenchCulture()</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; setNeutralCulture(</span><span style="line-height: 140%; color: #a31515">&quot;fr&quot;</span><span style="line-height: 140%">); </span><span style="line-height: 140%; color: green">// or setCulture(&quot;fr-FR&quot;);</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; GetCulture();</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; [</span><span style="line-height: 140%; color: #2b91af">CommandMethod</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: #a31515">&quot;SETDE&quot;</span><span style="line-height: 140%">)]</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> SetGermanCulture()</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; setNeutralCulture(</span><span style="line-height: 140%; color: #a31515">&quot;de&quot;</span><span style="line-height: 140%">); </span><span style="line-height: 140%; color: green">// or setCulture(&quot;de-DE&quot;);</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; GetCulture();</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; [</span><span style="line-height: 140%; color: #2b91af">CommandMethod</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: #a31515">&quot;SETEN&quot;</span><span style="line-height: 140%">)]</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> SetEnglishCulture()</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; setNeutralCulture(</span><span style="line-height: 140%; color: #a31515">&quot;en&quot;</span><span style="line-height: 140%">); </span><span style="line-height: 140%; color: green">// or setCulture(&quot;en-US&quot;);</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; GetCulture();</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px; font-size: 8pt">&#160;</p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; [</span><span style="line-height: 140%; color: #2b91af">CommandMethod</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: #a31515">&quot;GETCUL&quot;</span><span style="line-height: 140%">)]</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> GetCulture()</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Application</span><span style="line-height: 140%">.DocumentManager.MdiActiveDocument.Editor.</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; WriteMessage(</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;\nCurrent UI culture is {0}.&quot;</span><span style="line-height: 140%">,</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Thread</span><span style="line-height: 140%">.CurrentThread.CurrentUICulture.Name</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; );</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">&#160; }</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">}</span></p> </div> <!--EndFragment-->  <p>This code implements a number of commands to set the UI culture to US English (SETEN), French (SETFR) and German (SETDE) as well as to check the current UI culture (GETCUL). The code chooses to set the culture neutrally – which sets the language but not the location – but the end result is the same for the cultures we’ve chosen. One thing to bear in mind: <em><strong>this code only actually works if running from the debugger</strong></em>. It doesn’t crash, otherwise, but the current UI culture always ends up as “en-US”. I assume this is a threading issue, but as this is really only for testing purposes it’s a tolerable requirement to run everything from the debugger.</p>  <p>Here’s what happens when (launching AutoCAD from the Visual Studio 2009 debugger) we load our test code, set the current UI culture to French and then load the main application, checking which commands work and which do not:</p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Command: <font color="#ff0000">NETLOAD</font></span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Command: <font color="#ff0000">GETCUL</font></span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Current UI culture is en-US.</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Command: <font color="#ff0000">SETFR</font></span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Current UI culture is fr-FR.</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Command: <font color="#ff0000">GETCUL</font></span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Current UI culture is fr-FR.</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Command: <font color="#ff0000">NETLOAD</font></span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Command: <font color="#ff0000">HELLO</font></span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Hello!</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Command: <font color="#ff0000">GOODBYE</font></span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Goodbye!</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Command: <font color="#ff0000">BONJOUR</font></span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Hello!</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Command: <font color="#ff0000">AUREVOIR</font></span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Goodbye!</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Command: <font color="#ff0000">GUTENTAG</font> Unknown command &quot;GUTENTAG&quot;.&#160; Press F1 for help.</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Command: <font color="#ff0000">BYE</font> Unknown command &quot;BYE&quot;.&#160; Press F1 for help.</span></p> </div> <!--EndFragment-->  <p>We can see that the global and the French-localized commands have indeed worked, while the German and US ones have not.</p>  <p>Let’s do the same for German:</p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Command: <font color="#ff0000">NETLOAD</font></span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Command: <font color="#ff0000">GETCUL</font></span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Current UI culture is en-US.</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Command: <font color="#ff0000">SETDE</font></span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Current UI culture is de-DE.</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Command: <font color="#ff0000">GETCUL</font></span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Current UI culture is de-DE.</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Command: <font color="#ff0000">NETLOAD</font></span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Command: <font color="#ff0000">HELLO</font></span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Hello!</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Command: <font color="#ff0000">GOODBYE</font></span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Goodbye!</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Command: <font color="#ff0000">BONJOUR</font> Unknown command &quot;BONJOUR&quot;.&#160; Press F1 for help.</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Command: <font color="#ff0000">GUTENTAG</font></span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Hello!</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Command: <font color="#ff0000">AUFWIEDERSEHEN</font></span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Goodbye!</span></p>    <p style="margin: 0px; font-size: 8pt"><span style="line-height: 140%">Command: <font color="#ff0000">BYE</font> Unknown command &quot;BYE&quot;.&#160; Press F1 for help.</span></p> </div> <!--EndFragment-->  <p>And sure enough, while the German and global commands work, the others do not.</p>  <p>For completeness, if we just load our application – without either launching from the debugger or loading our test application to change the current UI culture – and run the commands, here’s what we see:</p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%">Command: <font color="#ff0000">NETLOAD</font></span></p>    <p style="margin: 0px"><span style="line-height: 140%">Command: <font color="#ff0000">HELLO</font></span></p>    <p style="margin: 0px"><span style="line-height: 140%">Hello!</span></p>    <p style="margin: 0px"><span style="line-height: 140%">Command: <font color="#ff0000">GOODBYE</font></span></p>    <p style="margin: 0px"><span style="line-height: 140%">Goodbye!</span></p>    <p style="margin: 0px"><span style="line-height: 140%">Command: <font color="#ff0000">HI</font></span></p>    <p style="margin: 0px"><span style="line-height: 140%">Hello!</span></p>    <p style="margin: 0px"><span style="line-height: 140%">Command: <font color="#ff0000">BYE</font></span></p>    <p style="margin: 0px"><span style="line-height: 140%">Goodbye!</span></p>    <p style="margin: 0px"><span style="line-height: 140%">Command: <font color="#ff0000">BONJOUR</font> Unknown command &quot;BONJOUR&quot;.&#160; Press F1 for help.</span></p>    <p style="margin: 0px"><span style="line-height: 140%">Command: <font color="#ff0000">AUREVOIR</font> Unknown command &quot;AUREVOIR&quot;.&#160; Press F1 for help.</span></p>    <p style="margin: 0px"><span style="line-height: 140%">Command: <font color="#ff0000">GUTENTAG</font> Unknown command &quot;GUTENTAG&quot;.&#160; Press F1 for help.</span></p>    <p style="margin: 0px"><span style="line-height: 140%">Command: <font color="#ff0000">AUFWIEDERSEHEN</font> Unknown command &quot;AUFWIEDERSEHEN&quot;.&#160; Press F1 for help.</span></p>    <p style="margin: 0px"><span style="line-height: 140%"></span></p> </div> <!--EndFragment-->  <p>My assumption is that the current UI culture will be set appropriately in the different language versions of AutoCAD, and so the localized resources will be chosen correctly. If someone trying the technique for real were able to confirm, I'd certainly appreciate it. :-)</p>
