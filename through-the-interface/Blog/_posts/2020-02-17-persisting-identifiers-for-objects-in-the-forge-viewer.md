---
layout: "post"
title: "Persisting identifiers for objects in the Forge viewer"
date: "2020-02-17 12:24:00"
author: "Kean Walmsley"
categories:
  - "APS (Forge)"
  - "Autodesk Research"
  - "IoT"
original_url: "https://www.keanw.com/2020/02/persisting-identifiers-for-objects-in-the-forge-viewer.html "
typepad_basename: "persisting-identifiers-for-objects-in-the-forge-viewer"
typepad_status: "Publish"
---

<p><a href="https://through-the-interface.typepad.com/.a/6a00d83452464869e2025d9b33072d200c-pi" target="_blank"><img width="500" height="312" title="Levels" style="margin: 30px auto; float: none; display: block;" alt="Levels" src="/assets/image_818830.jpg"></a></p><p>In <a href="http://dasher360.com" target="_blank">Dasher</a> we have some interesting functionality to isolate parts of the building by level. This is increasingly something you can do via <a href="https://forge.autodesk.com/blog/consume-aec-data-which-are-model-derivative-api" target="_blank">“out of the box” Forge viewer functionality</a>, but we’ve found a couple of reasons to go beyond that basic capability:</p><ol><li>Not all elements or objects are assigned to the correct level.</li><li>Some elements – such as those belonging to the building facade or perhaps internal pipes – transcend levels, and so don’t behave well.</li></ol><p><a href="https://through-the-interface.typepad.com/.a/6a00d83452464869e2025d9b33072d200c-pi" target="_blank"><a href="https://through-the-interface.typepad.com/.a/6a00d83452464869e2025d9b3309b8200c-pi" target="_blank"><img width="500" height="312" title="First floor" style="margin: 30px auto; border: 0px currentcolor; border-image: none; float: none; display: block; background-image: none;" alt="First floor" src="/assets/image_471289.jpg" border="0"></a></p><p>It’s of course possible to split elements/objects that belong to the second category, but we tend to take the approach of allowing certain objects to be hidden completely from the “per-level” view of a building. This allows us to add things like ceilings or lights to the list, which allows the individual levels to be displayed much more cleanly and in a way that’s more useful to the user.</p><p><a href="https://through-the-interface.typepad.com/.a/6a00d83452464869e20240a50d425e200b-pi" target="_blank"><img width="500" height="312" title="Basement" style="margin: 30px auto; border: 0px currentcolor; border-image: none; float: none; display: block; background-image: none;" alt="Basement" src="/assets/image_978795.jpg" border="0"></a></p><p>Originally when we implemented this “ignoreAtLevel” list, we did so as a list of dbIds. This was overall a bad idea, as it wasn’t sustainable from version to version of a model. After that we tried using the Revit ElementId, which was a little better at dealing with versions, but was still subject to problems. In the end we decided to maintain a list of elements’ UniqueIds: while not guaranteed to be unique (for more on this topic read <a href="https://thebuildingcoder.typepad.com/blog/2014/04/element-id-export-unique-navisworks-and-other-ids.html" target="_blank">Jeremy’s excellent post</a>) they are much less likely to get remapped when combining model content from multiple sources or with models being edited in a worksharing environment.</p><p>When I first created these list it was a really manual process: I went through and selected each object to be hidden – one by one – and then used the Model Browser to get the object’s grandparent in the hierarchy. This was usually the object that contained the UniqeId for that particular element. What a pain!</p><p><a href="https://through-the-interface.typepad.com/.a/6a00d83452464869e20240a4e8a4ad200d-pi" target="_blank"><img width="500" height="312" title="Finding the UniqueId for an element" style="margin: 30px auto; float: none; display: block;" alt="Finding the UniqueId for an element" src="/assets/image_650977.jpg"></a></p><p>This worked for a while, but clearly doesn’t scale well. So I decided to implement a mechanism that allows you to select objects in the Forge viewer and then query their UniqueIds (via the object itself, its direct ancestor or its grandparent) and then get a list of these UniqueIds that can be copy &amp; pasted into the JSON settings file where we persist this information.</p><p>For this I needed a helper function that takes a list of dbIds (those selected in the viewer) and returns a list of property values (whether UniqueIds or something else). We use TypeScript, but it should be easy for people to convert it to JavaScript, as needed.</p><p>

<div class="vscode" style="white-space: pre;"><div><span style="color: rgb(212, 212, 212);">&nbsp; </span><span style="color: rgb(86, 156, 214);">private</span><span style="color: rgb(212, 212, 212);">&nbsp;</span><span style="color: rgb(220, 220, 170);">propertyValuesForNodeIds</span><span style="color: rgb(212, 212, 212);">(</span></div><div><span style="color: rgb(212, 212, 212);">&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(156, 220, 254);">model</span><span style="color: rgb(212, 212, 212);">: </span><span style="color: rgb(78, 201, 176);">Autodesk</span><span style="color: rgb(212, 212, 212);">.</span><span style="color: rgb(78, 201, 176);">Viewing</span><span style="color: rgb(212, 212, 212);">.</span><span style="color: rgb(78, 201, 176);">Model</span><span style="color: rgb(212, 212, 212);">,</span></div><div><span style="color: rgb(212, 212, 212);">&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(156, 220, 254);">dbIds</span><span style="color: rgb(212, 212, 212);">: </span><span style="color: rgb(78, 201, 176);">number</span><span style="color: rgb(212, 212, 212);">[],</span></div><div><span style="color: rgb(212, 212, 212);">&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(156, 220, 254);">catName</span><span style="color: rgb(212, 212, 212);">: </span><span style="color: rgb(78, 201, 176);">string</span><span style="color: rgb(212, 212, 212);">,</span></div><div><span style="color: rgb(212, 212, 212);">&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(156, 220, 254);">propName</span><span style="color: rgb(212, 212, 212);">: </span><span style="color: rgb(78, 201, 176);">string</span><span style="color: rgb(212, 212, 212);">,</span></div><div><span style="color: rgb(212, 212, 212);">&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(220, 220, 170);">callback</span><span style="color: rgb(212, 212, 212);">: (</span><span style="color: rgb(156, 220, 254);">vals</span><span style="color: rgb(212, 212, 212);">: </span><span style="color: rgb(78, 201, 176);">string</span><span style="color: rgb(212, 212, 212);">[]) </span><span style="color: rgb(86, 156, 214);">=&gt;</span><span style="color: rgb(212, 212, 212);">&nbsp;</span><span style="color: rgb(78, 201, 176);">void</span></div><div><span style="color: rgb(212, 212, 212);">&nbsp; ): </span><span style="color: rgb(78, 201, 176);">void</span><span style="color: rgb(212, 212, 212);"> {</span></div><div><span style="color: rgb(212, 212, 212);">&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(86, 156, 214);">const</span><span style="color: rgb(212, 212, 212);">&nbsp;</span><span style="color: rgb(156, 220, 254);">tree</span><span style="color: rgb(212, 212, 212);"> = </span><span style="color: rgb(156, 220, 254);">model</span><span style="color: rgb(212, 212, 212);">.</span><span style="color: rgb(220, 220, 170);">getData</span><span style="color: rgb(212, 212, 212);">().</span><span style="color: rgb(156, 220, 254);">instanceTree</span><span style="color: rgb(212, 212, 212);">;</span></div><div><span style="color: rgb(212, 212, 212);">&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(106, 153, 85);">// We'll create a list of 3 generations of node (nodes, parents, grandparents)</span></div><div><span style="color: rgb(212, 212, 212);">&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(106, 153, 85);">// as the relevant property is often a level or two up</span></div><div><span style="color: rgb(212, 212, 212);">&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(86, 156, 214);">const</span><span style="color: rgb(212, 212, 212);">&nbsp;</span><span style="color: rgb(156, 220, 254);">parents</span><span style="color: rgb(212, 212, 212);"> = </span><span style="color: rgb(156, 220, 254);">dbIds</span><span style="color: rgb(212, 212, 212);">.</span><span style="color: rgb(220, 220, 170);">map</span><span style="color: rgb(212, 212, 212);">(</span><span style="color: rgb(156, 220, 254);">id</span><span style="color: rgb(212, 212, 212);">&nbsp;</span><span style="color: rgb(86, 156, 214);">=&gt;</span><span style="color: rgb(212, 212, 212);">&nbsp;</span><span style="color: rgb(156, 220, 254);">tree</span><span style="color: rgb(212, 212, 212);">.</span><span style="color: rgb(220, 220, 170);">getNodeParentId</span><span style="color: rgb(212, 212, 212);">(</span><span style="color: rgb(156, 220, 254);">id</span><span style="color: rgb(212, 212, 212);">));</span></div><div><span style="color: rgb(212, 212, 212);">&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(86, 156, 214);">const</span><span style="color: rgb(212, 212, 212);">&nbsp;</span><span style="color: rgb(156, 220, 254);">grandparents</span><span style="color: rgb(212, 212, 212);"> = </span><span style="color: rgb(156, 220, 254);">parents</span><span style="color: rgb(212, 212, 212);">.</span><span style="color: rgb(220, 220, 170);">map</span><span style="color: rgb(212, 212, 212);">(</span><span style="color: rgb(156, 220, 254);">id</span><span style="color: rgb(212, 212, 212);">&nbsp;</span><span style="color: rgb(86, 156, 214);">=&gt;</span><span style="color: rgb(212, 212, 212);">&nbsp;</span><span style="color: rgb(156, 220, 254);">tree</span><span style="color: rgb(212, 212, 212);">.</span><span style="color: rgb(220, 220, 170);">getNodeParentId</span><span style="color: rgb(212, 212, 212);">(</span><span style="color: rgb(156, 220, 254);">id</span><span style="color: rgb(212, 212, 212);">));</span></div><div><span style="color: rgb(212, 212, 212);">&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(86, 156, 214);">const</span><span style="color: rgb(212, 212, 212);">&nbsp;</span><span style="color: rgb(156, 220, 254);">ids</span><span style="color: rgb(212, 212, 212);"> = </span><span style="color: rgb(156, 220, 254);">dbIds</span><span style="color: rgb(212, 212, 212);">.</span><span style="color: rgb(220, 220, 170);">concat</span><span style="color: rgb(212, 212, 212);">(</span><span style="color: rgb(156, 220, 254);">parents</span><span style="color: rgb(212, 212, 212);">).</span><span style="color: rgb(220, 220, 170);">concat</span><span style="color: rgb(212, 212, 212);">(</span><span style="color: rgb(156, 220, 254);">grandparents</span><span style="color: rgb(212, 212, 212);">);</span></div><div><span style="color: rgb(212, 212, 212);">&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(86, 156, 214);">const</span><span style="color: rgb(212, 212, 212);">&nbsp;</span><span style="color: rgb(156, 220, 254);">options</span><span style="color: rgb(212, 212, 212);"> = { </span><span style="color: rgb(156, 220, 254);">ignoreHidden:</span><span style="color: rgb(212, 212, 212);">&nbsp;</span><span style="color: rgb(86, 156, 214);">false</span><span style="color: rgb(212, 212, 212);">, </span><span style="color: rgb(156, 220, 254);">propFilter:</span><span style="color: rgb(212, 212, 212);"> [</span><span style="color: rgb(156, 220, 254);">propName</span><span style="color: rgb(212, 212, 212);">] };</span></div><div><span style="color: rgb(212, 212, 212);">&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(86, 156, 214);">const</span><span style="color: rgb(212, 212, 212);">&nbsp;</span><span style="color: rgb(220, 220, 170);">onCompleted</span><span style="color: rgb(212, 212, 212);"> = (</span><span style="color: rgb(156, 220, 254);">results</span><span style="color: rgb(212, 212, 212);">) </span><span style="color: rgb(86, 156, 214);">=&gt;</span><span style="color: rgb(212, 212, 212);"> {</span></div><div><span style="color: rgb(212, 212, 212);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(86, 156, 214);">const</span><span style="color: rgb(212, 212, 212);">&nbsp;</span><span style="color: rgb(156, 220, 254);">hasProperty</span><span style="color: rgb(212, 212, 212);"> =</span></div><div><span style="color: rgb(212, 212, 212);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(156, 220, 254);">p</span><span style="color: rgb(212, 212, 212);">&nbsp;</span><span style="color: rgb(86, 156, 214);">=&gt;</span><span style="color: rgb(212, 212, 212);">&nbsp;</span><span style="color: rgb(156, 220, 254);">p</span><span style="color: rgb(212, 212, 212);">.</span><span style="color: rgb(156, 220, 254);">displayName</span><span style="color: rgb(212, 212, 212);"> === </span><span style="color: rgb(156, 220, 254);">propName</span><span style="color: rgb(212, 212, 212);"> &amp;&amp; </span><span style="color: rgb(156, 220, 254);">p</span><span style="color: rgb(212, 212, 212);">.</span><span style="color: rgb(156, 220, 254);">displayCategory</span><span style="color: rgb(212, 212, 212);"> === </span><span style="color: rgb(156, 220, 254);">catName</span><span style="color: rgb(212, 212, 212);">;</span></div><div><span style="color: rgb(212, 212, 212);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(86, 156, 214);">const</span><span style="color: rgb(212, 212, 212);">&nbsp;</span><span style="color: rgb(156, 220, 254);">found</span><span style="color: rgb(212, 212, 212);"> = </span><span style="color: rgb(156, 220, 254);">results</span><span style="color: rgb(212, 212, 212);">.</span><span style="color: rgb(220, 220, 170);">map</span><span style="color: rgb(212, 212, 212);">(</span><span style="color: rgb(156, 220, 254);">r</span><span style="color: rgb(212, 212, 212);">&nbsp;</span><span style="color: rgb(86, 156, 214);">=&gt;</span><span style="color: rgb(212, 212, 212);">&nbsp;</span><span style="color: rgb(156, 220, 254);">r</span><span style="color: rgb(212, 212, 212);">.</span><span style="color: rgb(156, 220, 254);">properties</span><span style="color: rgb(212, 212, 212);">.</span><span style="color: rgb(220, 220, 170);">filter</span><span style="color: rgb(212, 212, 212);">(</span><span style="color: rgb(156, 220, 254);">hasProperty</span><span style="color: rgb(212, 212, 212);">));</span></div><div><span style="color: rgb(212, 212, 212);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(86, 156, 214);">const</span><span style="color: rgb(212, 212, 212);">&nbsp;</span><span style="color: rgb(156, 220, 254);">flattened</span><span style="color: rgb(212, 212, 212);"> = </span><span style="color: rgb(156, 220, 254);">found</span><span style="color: rgb(212, 212, 212);">.</span><span style="color: rgb(220, 220, 170);">flat</span><span style="color: rgb(212, 212, 212);">(</span><span style="color: rgb(181, 206, 168);">1</span><span style="color: rgb(212, 212, 212);">);</span></div><div><span style="color: rgb(212, 212, 212);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(86, 156, 214);">const</span><span style="color: rgb(212, 212, 212);">&nbsp;</span><span style="color: rgb(156, 220, 254);">values</span><span style="color: rgb(212, 212, 212);"> = </span><span style="color: rgb(156, 220, 254);">flattened</span><span style="color: rgb(212, 212, 212);">.</span><span style="color: rgb(220, 220, 170);">map</span><span style="color: rgb(212, 212, 212);">(</span><span style="color: rgb(156, 220, 254);">f</span><span style="color: rgb(212, 212, 212);">&nbsp;</span><span style="color: rgb(86, 156, 214);">=&gt;</span><span style="color: rgb(212, 212, 212);">&nbsp;</span><span style="color: rgb(206, 145, 120);">'"'</span><span style="color: rgb(212, 212, 212);"> + </span><span style="color: rgb(156, 220, 254);">f</span><span style="color: rgb(212, 212, 212);">.</span><span style="color: rgb(156, 220, 254);">displayValue</span><span style="color: rgb(212, 212, 212);"> + </span><span style="color: rgb(206, 145, 120);">'"'</span><span style="color: rgb(212, 212, 212);">);</span></div><div><span style="color: rgb(212, 212, 212);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(220, 220, 170);">callback</span><span style="color: rgb(212, 212, 212);">(</span><span style="color: rgb(156, 220, 254);">values</span><span style="color: rgb(212, 212, 212);">);</span></div><div><span style="color: rgb(212, 212, 212);">&nbsp;&nbsp;&nbsp; };</span></div><div><span style="color: rgb(212, 212, 212);">&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(156, 220, 254);">model</span><span style="color: rgb(212, 212, 212);">.</span><span style="color: rgb(220, 220, 170);">getBulkProperties2</span><span style="color: rgb(212, 212, 212);">(</span><span style="color: rgb(156, 220, 254);">ids</span><span style="color: rgb(212, 212, 212);">, </span><span style="color: rgb(156, 220, 254);">options</span><span style="color: rgb(212, 212, 212);">, </span><span style="color: rgb(156, 220, 254);">onCompleted</span><span style="color: rgb(212, 212, 212);">);</span></div><div><span style="color: rgb(212, 212, 212);">&nbsp; }</span></div><div><br></div></div>

<p></p>

<p>Calling this function, passing in a catName of “Element Properties” and a propName of “UniqueId”, results in UniqueIds for the specified dbIds being passed into the callback function for storage or display to the user.</p><p>To make it easier to manage what objects have been added to our “ignoreAtLevel” list, I also decided to go the other way and let the user request the viewer to select all the objects that have been listed there. For this I needed another helper function that creates a list of dbIds from a list of UniqueIds.</p><p><div class="vscode" style="white-space: pre;"><div><span style="color: rgb(212, 212, 212);">&nbsp; </span><span style="color: rgb(86, 156, 214);">private</span><span style="color: rgb(212, 212, 212);">&nbsp;</span><span style="color: rgb(220, 220, 170);">nodeIdsForPropertyValues</span><span style="color: rgb(212, 212, 212);">(</span></div><div><span style="color: rgb(212, 212, 212);">&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(156, 220, 254);">model</span><span style="color: rgb(212, 212, 212);">: </span><span style="color: rgb(78, 201, 176);">Autodesk</span><span style="color: rgb(212, 212, 212);">.</span><span style="color: rgb(78, 201, 176);">Viewing</span><span style="color: rgb(212, 212, 212);">.</span><span style="color: rgb(78, 201, 176);">Model</span><span style="color: rgb(212, 212, 212);">,</span></div><div><span style="color: rgb(212, 212, 212);">&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(156, 220, 254);">catName</span><span style="color: rgb(212, 212, 212);">: </span><span style="color: rgb(78, 201, 176);">string</span><span style="color: rgb(212, 212, 212);">,</span></div><div><span style="color: rgb(212, 212, 212);">&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(156, 220, 254);">propName</span><span style="color: rgb(212, 212, 212);">: </span><span style="color: rgb(78, 201, 176);">string</span><span style="color: rgb(212, 212, 212);">,</span></div><div><span style="color: rgb(212, 212, 212);">&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(156, 220, 254);">values</span><span style="color: rgb(212, 212, 212);">: </span><span style="color: rgb(78, 201, 176);">string</span><span style="color: rgb(212, 212, 212);">[],</span></div><div><span style="color: rgb(212, 212, 212);">&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(220, 220, 170);">callback</span><span style="color: rgb(212, 212, 212);">: (</span><span style="color: rgb(156, 220, 254);">ids</span><span style="color: rgb(212, 212, 212);">: </span><span style="color: rgb(78, 201, 176);">number</span><span style="color: rgb(212, 212, 212);">[]) </span><span style="color: rgb(86, 156, 214);">=&gt;</span><span style="color: rgb(212, 212, 212);">&nbsp;</span><span style="color: rgb(78, 201, 176);">void</span></div><div><span style="color: rgb(212, 212, 212);">&nbsp; ): </span><span style="color: rgb(78, 201, 176);">void</span><span style="color: rgb(212, 212, 212);"> {</span></div><div><span style="color: rgb(212, 212, 212);">&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(86, 156, 214);">const</span><span style="color: rgb(212, 212, 212);">&nbsp;</span><span style="color: rgb(156, 220, 254);">tree</span><span style="color: rgb(212, 212, 212);"> = </span><span style="color: rgb(156, 220, 254);">model</span><span style="color: rgb(212, 212, 212);">.</span><span style="color: rgb(220, 220, 170);">getData</span><span style="color: rgb(212, 212, 212);">().</span><span style="color: rgb(156, 220, 254);">instanceTree</span><span style="color: rgb(212, 212, 212);">;</span></div><div><span style="color: rgb(212, 212, 212);">&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(106, 153, 85);">// Use all the dbIds in the model</span></div><div><span style="color: rgb(212, 212, 212);">&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(86, 156, 214);">const</span><span style="color: rgb(212, 212, 212);">&nbsp;</span><span style="color: rgb(156, 220, 254);">ids</span><span style="color: rgb(212, 212, 212);"> = </span><span style="color: rgb(78, 201, 176);">Object</span><span style="color: rgb(212, 212, 212);">.</span><span style="color: rgb(220, 220, 170);">keys</span><span style="color: rgb(212, 212, 212);">(</span><span style="color: rgb(156, 220, 254);">tree</span><span style="color: rgb(212, 212, 212);">.</span><span style="color: rgb(156, 220, 254);">nodeAccess</span><span style="color: rgb(212, 212, 212);">.</span><span style="color: rgb(156, 220, 254);">dbIdToIndex</span><span style="color: rgb(212, 212, 212);">).</span><span style="color: rgb(220, 220, 170);">map</span><span style="color: rgb(212, 212, 212);">(</span><span style="color: rgb(156, 220, 254);">item</span><span style="color: rgb(212, 212, 212);">&nbsp;</span><span style="color: rgb(86, 156, 214);">=&gt;</span><span style="color: rgb(212, 212, 212);">&nbsp;</span><span style="color: rgb(220, 220, 170);">parseInt</span><span style="color: rgb(212, 212, 212);">(</span><span style="color: rgb(156, 220, 254);">item</span><span style="color: rgb(212, 212, 212);">, </span><span style="color: rgb(181, 206, 168);">10</span><span style="color: rgb(212, 212, 212);">));</span></div><div><span style="color: rgb(212, 212, 212);">&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(86, 156, 214);">const</span><span style="color: rgb(212, 212, 212);">&nbsp;</span><span style="color: rgb(156, 220, 254);">options</span><span style="color: rgb(212, 212, 212);"> = { </span><span style="color: rgb(156, 220, 254);">ignoreHidden:</span><span style="color: rgb(212, 212, 212);">&nbsp;</span><span style="color: rgb(86, 156, 214);">false</span><span style="color: rgb(212, 212, 212);">, </span><span style="color: rgb(156, 220, 254);">propFilter:</span><span style="color: rgb(212, 212, 212);"> [</span><span style="color: rgb(156, 220, 254);">propName</span><span style="color: rgb(212, 212, 212);">] };</span></div><div><span style="color: rgb(212, 212, 212);">&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(86, 156, 214);">const</span><span style="color: rgb(212, 212, 212);">&nbsp;</span><span style="color: rgb(220, 220, 170);">onCompleted</span><span style="color: rgb(212, 212, 212);"> = (</span><span style="color: rgb(156, 220, 254);">results</span><span style="color: rgb(212, 212, 212);">) </span><span style="color: rgb(86, 156, 214);">=&gt;</span><span style="color: rgb(212, 212, 212);"> {</span></div><div><span style="color: rgb(212, 212, 212);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(86, 156, 214);">const</span><span style="color: rgb(212, 212, 212);">&nbsp;</span><span style="color: rgb(156, 220, 254);">hasPropertyWithValue</span><span style="color: rgb(212, 212, 212);"> =</span></div><div><span style="color: rgb(212, 212, 212);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(156, 220, 254);">p</span><span style="color: rgb(212, 212, 212);">&nbsp;</span><span style="color: rgb(86, 156, 214);">=&gt;</span><span style="color: rgb(212, 212, 212);">&nbsp;</span><span style="color: rgb(156, 220, 254);">p</span><span style="color: rgb(212, 212, 212);">.</span><span style="color: rgb(156, 220, 254);">displayName</span><span style="color: rgb(212, 212, 212);"> === </span><span style="color: rgb(156, 220, 254);">propName</span><span style="color: rgb(212, 212, 212);"> &amp;&amp; </span><span style="color: rgb(156, 220, 254);">p</span><span style="color: rgb(212, 212, 212);">.</span><span style="color: rgb(156, 220, 254);">displayCategory</span><span style="color: rgb(212, 212, 212);"> === </span><span style="color: rgb(156, 220, 254);">catName</span><span style="color: rgb(212, 212, 212);"> &amp;&amp; </span><span style="color: rgb(156, 220, 254);">values</span><span style="color: rgb(212, 212, 212);">.</span><span style="color: rgb(220, 220, 170);">indexOf</span><span style="color: rgb(212, 212, 212);">(</span><span style="color: rgb(156, 220, 254);">p</span><span style="color: rgb(212, 212, 212);">.</span><span style="color: rgb(156, 220, 254);">displayValue</span><span style="color: rgb(212, 212, 212);">) &gt;= </span><span style="color: rgb(181, 206, 168);">0</span><span style="color: rgb(212, 212, 212);">;</span></div><div><span style="color: rgb(212, 212, 212);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(86, 156, 214);">const</span><span style="color: rgb(212, 212, 212);">&nbsp;</span><span style="color: rgb(156, 220, 254);">found</span><span style="color: rgb(212, 212, 212);"> = </span><span style="color: rgb(156, 220, 254);">results</span><span style="color: rgb(212, 212, 212);">.</span><span style="color: rgb(220, 220, 170);">filter</span><span style="color: rgb(212, 212, 212);">(</span><span style="color: rgb(156, 220, 254);">r</span><span style="color: rgb(212, 212, 212);">&nbsp;</span><span style="color: rgb(86, 156, 214);">=&gt;</span><span style="color: rgb(212, 212, 212);">&nbsp;</span><span style="color: rgb(156, 220, 254);">r</span><span style="color: rgb(212, 212, 212);">.</span><span style="color: rgb(156, 220, 254);">properties</span><span style="color: rgb(212, 212, 212);">.</span><span style="color: rgb(220, 220, 170);">findIndex</span><span style="color: rgb(212, 212, 212);">(</span><span style="color: rgb(156, 220, 254);">hasPropertyWithValue</span><span style="color: rgb(212, 212, 212);">) &gt;= </span><span style="color: rgb(181, 206, 168);">0</span><span style="color: rgb(212, 212, 212);">);</span></div><div><span style="color: rgb(212, 212, 212);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(86, 156, 214);">const</span><span style="color: rgb(212, 212, 212);">&nbsp;</span><span style="color: rgb(156, 220, 254);">dbIds</span><span style="color: rgb(212, 212, 212);"> = </span><span style="color: rgb(156, 220, 254);">found</span><span style="color: rgb(212, 212, 212);">.</span><span style="color: rgb(220, 220, 170);">map</span><span style="color: rgb(212, 212, 212);">(</span><span style="color: rgb(156, 220, 254);">f</span><span style="color: rgb(212, 212, 212);">&nbsp;</span><span style="color: rgb(86, 156, 214);">=&gt;</span><span style="color: rgb(212, 212, 212);">&nbsp;</span><span style="color: rgb(156, 220, 254);">f</span><span style="color: rgb(212, 212, 212);">.</span><span style="color: rgb(156, 220, 254);">dbId</span><span style="color: rgb(212, 212, 212);">);</span></div><div><span style="color: rgb(212, 212, 212);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(220, 220, 170);">callback</span><span style="color: rgb(212, 212, 212);">(</span><span style="color: rgb(156, 220, 254);">dbIds</span><span style="color: rgb(212, 212, 212);">);</span></div><div><span style="color: rgb(212, 212, 212);">&nbsp;&nbsp;&nbsp; };</span></div><div><span style="color: rgb(212, 212, 212);">&nbsp;&nbsp;&nbsp; </span><span style="color: rgb(156, 220, 254);">model</span><span style="color: rgb(212, 212, 212);">.</span><span style="color: rgb(220, 220, 170);">getBulkProperties2</span><span style="color: rgb(212, 212, 212);">(</span><span style="color: rgb(156, 220, 254);">ids</span><span style="color: rgb(212, 212, 212);">, </span><span style="color: rgb(156, 220, 254);">options</span><span style="color: rgb(212, 212, 212);">, </span><span style="color: rgb(156, 220, 254);">onCompleted</span><span style="color: rgb(212, 212, 212);">);</span></div><div><span style="color: rgb(212, 212, 212);">&nbsp; }</span></div><div><br></div></div><p>The results of calling this method can then be set to the viewer’s selection property.</p><p><a href="https://through-the-interface.typepad.com/.a/6a00d83452464869e20240a4e8a4b1200d-pi" target="_blank"><img width="500" height="276" title="Hidden NEST elements" style="margin: 30px auto; border: 0px currentcolor; border-image: none; float: none; display: block; background-image: none;" alt="Hidden NEST elements" src="/assets/image_454417.jpg" border="0"></a></p><p>The typical workflow I have in mind is to gradually build up the list of objects you want to hide – selecting them in chunks, to avoid messing up and having to start over – and then capturing their UniqueIds and adding them to a list (in the text editor of your choice). Once the list is “complete”, you can request to select these objects in the viewer and then request UniqueIds for the selected objects for saving to your settings. (I know this sounds circular, but it’s a handy way to rationalise the list, sorting it in order of the dbIds and removing any duplicate selections.)</p><p>All this is capability that has been added to Dasher for administrators to better manage projects, so isn’t something you can try out in the online demo, unfortunately. Nonetheless I hope thie technique is something that’s useful for people implementing comparable capabilities in their own tools.</p><p>I’m just about to head into our Soho office for my first full day at the first Forge Accelerator being held there. It’s really nice to see some familiar faces – more on this is a coming post.</p>
