---
layout: "post"
title: "Implementing task dialogs inside AutoCAD using .NET - Part 1"
date: "2008-11-10 06:38:00"
author: "Kean Walmsley"
categories:
  - "AutoCAD"
  - "AutoCAD .NET"
  - "Notification / Events"
  - "User interface"
original_url: "https://www.keanw.com/2008/11/implementing-ta.html "
typepad_basename: "implementing-ta"
typepad_status: "Publish"
---

<p>This is a topic I&#39;ve been meaning to get to for some time... as I finally had to research it for a side project I&#39;m working on, I decided to go ahead and post my findings here.</p>
<p>AutoCAD 2009 makes heavy use of task dialogs, which are basically message-boxes on steroids. MSDN contains documentation on <a href="http://msdn.microsoft.com/en-us/library/bb760441(VS.85).aspx">Microsoft&#39;s implementation of task dialogs</a>, although our implementation is a little different.</p>
<p>Why bother with these new task dialogs? They provide a way of asking more user-friendly questions using actual actions as answers rather than <em>yes/no/cancel</em> etc. It&#39;s a bit like the way I now often seem to be asked questions such as &quot;who packed this bag?&quot; when flying, these days, rather than &quot;did you pack this bag yourself?&quot; - you have to think a little more, but that usually increases the chances of getting accurate information. Alright, perhaps the airline security analogy wasn&#39;t all that appropriate, after all, but hopefully you get the idea.</p>
<p>In this first part of the two-part series we&#39;re going to look at the basic steps to add task dialogs to our projects, showing a very basic example that gives an idea of their capabilities, and in the next part we&#39;ll see a much more concrete, real-world implementation example.</p>
<p>The first thing to do to make use of task dialogs in your application is to add a reference to the <em>AdWindows.dll</em> assembly. You should find it in AutoCAD 2009 (but not previous versions), in the root application folder. As usual when adding AutoCAD&#39;s managed assemblies to your project, remember to set the &quot;<em>Copy Local</em>&quot; flag to false, to avoid problems later. Once we&#39;ve added this reference we&#39;re able to use the Autodesk.Windows namespace (not to be confused with Autodesk.AutoCAD.Windows, which is AutoCAD-specific).</p>
<p>Here&#39;s our initial C# code to show a very basic task dialog, without doing very much with the information provided:</p>
<div style="FONT-FAMILY: courier new; BACKGROUND: white; COLOR: black; FONT-SIZE: 8pt">
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%; COLOR: blue">using</span><span style="LINE-HEIGHT: 140%"> Autodesk.AutoCAD.ApplicationServices;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%; COLOR: blue">using</span><span style="LINE-HEIGHT: 140%"> Autodesk.AutoCAD.EditorInput;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%; COLOR: blue">using</span><span style="LINE-HEIGHT: 140%"> Autodesk.AutoCAD.Runtime;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%; COLOR: blue">using</span><span style="LINE-HEIGHT: 140%"> Autodesk.Windows;</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%; COLOR: blue">namespace</span><span style="LINE-HEIGHT: 140%"> TaskDialogs</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">{</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">public</span><span style="LINE-HEIGHT: 140%">&#0160;</span><span style="LINE-HEIGHT: 140%; COLOR: blue">class</span><span style="LINE-HEIGHT: 140%">&#0160;</span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">Commands</span></span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; [</span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">CommandMethod</span></span><span style="LINE-HEIGHT: 140%">(</span><span style="COLOR: #a31515"><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;Task1&quot;</span></span><span style="LINE-HEIGHT: 140%">)]</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">public</span><span style="LINE-HEIGHT: 140%">&#0160;</span><span style="LINE-HEIGHT: 140%; COLOR: blue">static</span><span style="LINE-HEIGHT: 140%">&#0160;</span><span style="LINE-HEIGHT: 140%; COLOR: blue">void</span><span style="LINE-HEIGHT: 140%"> TestingTaskDialogOptions()</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;</span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">Editor</span></span><span style="LINE-HEIGHT: 140%"> ed =</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">Application</span></span><span style="LINE-HEIGHT: 140%">.DocumentManager.MdiActiveDocument.Editor;</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;</span><span style="LINE-HEIGHT: 140%; COLOR: green">// Create the task dialog itself</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;</span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">TaskDialog</span></span><span style="LINE-HEIGHT: 140%"> td = </span><span style="LINE-HEIGHT: 140%; COLOR: blue">new</span><span style="LINE-HEIGHT: 140%">&#0160;</span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">TaskDialog</span></span><span style="LINE-HEIGHT: 140%">();</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;</span><span style="LINE-HEIGHT: 140%; COLOR: green">// Set the various textual settings</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;td.WindowTitle = </span><span style="COLOR: #a31515"><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;The title&quot;</span></span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;td.MainInstruction = </span><span style="COLOR: #a31515"><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;Something has happened.&quot;</span></span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;td.ContentText =</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="COLOR: #a31515"><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;Here&#39;s some text, with a &quot;</span></span><span style="LINE-HEIGHT: 140%"> +</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="COLOR: #a31515"><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;&lt;A HREF=\&quot;http://adn.autodesk.com\&quot;&gt;&quot;</span></span><span style="LINE-HEIGHT: 140%"> +</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="COLOR: #a31515"><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;link to the ADN site&lt;/A&gt;&quot;</span></span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;td.VerificationText = </span><span style="COLOR: #a31515"><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;Verification text&quot;</span></span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;td.FooterText =</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="COLOR: #a31515"><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;The footer with a &quot;</span></span><span style="LINE-HEIGHT: 140%">+</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="COLOR: #a31515"><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;&lt;A HREF=\&quot;http://blogs.autodesk.com/through&quot;</span></span><span style="LINE-HEIGHT: 140%"> +</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="COLOR: #a31515"><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;-the-interface\&quot;&gt;link to Kean&#39;s blog&lt;/A&gt;&quot;</span></span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;td.EnableHyperlinks = </span><span style="LINE-HEIGHT: 140%; COLOR: blue">true</span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;td.EnableVerificationHandler = </span><span style="LINE-HEIGHT: 140%; COLOR: blue">true</span><span style="LINE-HEIGHT: 140%">;</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;</span><span style="LINE-HEIGHT: 140%; COLOR: green">// And those for collapsed/expanded text</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;td.CollapsedControlText =</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="COLOR: #a31515"><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;This control text can be expanded.&quot;</span></span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;td.ExpandedControlText</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; = </span><span style="COLOR: #a31515"><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;This control text has been expanded...&quot;</span></span><span style="LINE-HEIGHT: 140%"> +</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="COLOR: #a31515"><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;\nTo span multiple lines.&quot;</span></span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;td.ExpandedText = </span><span style="COLOR: #a31515"><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;This footer text has been expanded.&quot;</span></span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;td.ExpandFooterArea = </span><span style="LINE-HEIGHT: 140%; COLOR: blue">true</span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;td.ExpandedByDefault = </span><span style="LINE-HEIGHT: 140%; COLOR: blue">false</span><span style="LINE-HEIGHT: 140%">;</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;</span><span style="LINE-HEIGHT: 140%; COLOR: green">// Set some standard icons and display of the progress bar</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;td.MainIcon = </span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">TaskDialogIcon</span></span><span style="LINE-HEIGHT: 140%">.Shield;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;td.FooterIcon = </span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">TaskDialogIcon</span></span><span style="LINE-HEIGHT: 140%">.Information;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;td.ShowProgressBar = </span><span style="LINE-HEIGHT: 140%; COLOR: blue">true</span><span style="LINE-HEIGHT: 140%">;</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;</span><span style="LINE-HEIGHT: 140%; COLOR: green">// A marquee progress bas just loops,</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;</span><span style="LINE-HEIGHT: 140%; COLOR: green">// it has no range&#0160; fixed upfront</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;</span><span style="LINE-HEIGHT: 140%; COLOR: green">//td.ShowMarqueeProgressBar = true;</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;</span><span style="LINE-HEIGHT: 140%; COLOR: green">// Now we add out task action buttons</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;td.UseCommandLinks = </span><span style="LINE-HEIGHT: 140%; COLOR: blue">true</span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;td.Buttons.Add(</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">new</span><span style="LINE-HEIGHT: 140%">&#0160;</span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">TaskDialogButton</span></span><span style="LINE-HEIGHT: 140%">(</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; 1,</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="COLOR: #a31515"><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;This is one course of action.&quot;</span></span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; )</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;td.Buttons.Add(</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">new</span><span style="LINE-HEIGHT: 140%">&#0160;</span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">TaskDialogButton</span></span><span style="LINE-HEIGHT: 140%">(</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; 2,</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="COLOR: #a31515"><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;Here is another course of action.&quot;</span></span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; )</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;td.Buttons.Add(</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">new</span><span style="LINE-HEIGHT: 140%">&#0160;</span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">TaskDialogButton</span></span><span style="LINE-HEIGHT: 140%">(</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; 3,</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="COLOR: #a31515"><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;And would you believe we have a third!&quot;</span></span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; )</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;);</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;</span><span style="LINE-HEIGHT: 140%; COLOR: green">// Set the default to be the third</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;td.DefaultButton = 3;</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;</span><span style="LINE-HEIGHT: 140%; COLOR: green">// And some radio buttons, too</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;td.RadioButtons.Add(</span><span style="LINE-HEIGHT: 140%; COLOR: blue">new</span><span style="LINE-HEIGHT: 140%">&#0160;</span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">TaskDialogButton</span></span><span style="LINE-HEIGHT: 140%">(4, </span><span style="COLOR: #a31515"><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;Yes&quot;</span></span><span style="LINE-HEIGHT: 140%">));</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;td.RadioButtons.Add(</span><span style="LINE-HEIGHT: 140%; COLOR: blue">new</span><span style="LINE-HEIGHT: 140%">&#0160;</span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">TaskDialogButton</span></span><span style="LINE-HEIGHT: 140%">(5, </span><span style="COLOR: #a31515"><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;No&quot;</span></span><span style="LINE-HEIGHT: 140%">));</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;td.RadioButtons.Add(</span><span style="LINE-HEIGHT: 140%; COLOR: blue">new</span><span style="LINE-HEIGHT: 140%">&#0160;</span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">TaskDialogButton</span></span><span style="LINE-HEIGHT: 140%">(6, </span><span style="COLOR: #a31515"><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;Maybe&quot;</span></span><span style="LINE-HEIGHT: 140%">));</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;</span><span style="LINE-HEIGHT: 140%; COLOR: green">// Set the default to be the second</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;td.DefaultRadioButton = 5;</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;</span><span style="LINE-HEIGHT: 140%; COLOR: green">// Allow the dialog to be cancelled</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;td.AllowDialogCancellation = </span><span style="LINE-HEIGHT: 140%; COLOR: blue">false</span><span style="LINE-HEIGHT: 140%">;</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;</span><span style="LINE-HEIGHT: 140%; COLOR: green">// Implement a callback for UI event notification</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;td.Callback =</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">delegate</span><span style="LINE-HEIGHT: 140%">(</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;</span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">ActiveTaskDialog</span></span><span style="LINE-HEIGHT: 140%"> atd,</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;</span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">TaskDialogEventArgs</span></span><span style="LINE-HEIGHT: 140%"> e,</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;</span><span style="LINE-HEIGHT: 140%; COLOR: blue">object</span><span style="LINE-HEIGHT: 140%"> sender</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; )</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;ed.WriteMessage(</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="COLOR: #a31515"><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;\nButton ID: {0}&quot;</span></span><span style="LINE-HEIGHT: 140%">,</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; e.ButtonId</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;ed.WriteMessage(</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="COLOR: #a31515"><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;\nNotification: {0}&quot;</span></span><span style="LINE-HEIGHT: 140%">,</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; e.Notification</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;);</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;</span><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> (e.Notification ==</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">TaskDialogNotification</span></span><span style="LINE-HEIGHT: 140%">.VerificationClicked)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;{</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; atd.SetProgressBarRange(0, 100);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; atd.SetProgressBarPosition(80);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;}</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;</span><span style="LINE-HEIGHT: 140%; COLOR: blue">else</span><span style="LINE-HEIGHT: 140%">&#0160;</span><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> (e.Notification ==</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">TaskDialogNotification</span></span><span style="LINE-HEIGHT: 140%">.HyperlinkClicked)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;{</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; ed.WriteMessage(</span><span style="COLOR: #a31515"><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot; &quot;</span></span><span style="LINE-HEIGHT: 140%"> + e.Hyperlink);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;}</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;ed.WriteMessage(</span><span style="COLOR: #a31515"><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;\n&quot;</span></span><span style="LINE-HEIGHT: 140%">);</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;</span><span style="LINE-HEIGHT: 140%; COLOR: green">// Returning true will prevent the dialog from</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;</span><span style="LINE-HEIGHT: 140%; COLOR: green">// being closed</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;</span><span style="LINE-HEIGHT: 140%; COLOR: blue">return</span><span style="LINE-HEIGHT: 140%">&#0160;</span><span style="LINE-HEIGHT: 140%; COLOR: blue">false</span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; };</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;td.Show(</span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">Application</span></span><span style="LINE-HEIGHT: 140%">.MainWindow.Handle);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">}</span></p></div>
<p>When we execute the TASK1 command, we can see this dialog gets displayed:</p>
<p><a href="http://through-the-interface.typepad.com/through_the_interface/WindowsLiveWriter/Basic%20task%20dialog%20with%20all%20the%20options.png"><img alt="Basic task dialog with all the options" border="0" height="389" src="/assets/Basic%20task%20dialog%20with%20all%20the%20options_thumb.png" style="BORDER-RIGHT-WIDTH: 0px; BORDER-TOP-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px" width="461" /></a> </p>
<p>This dialog exercises most of the UI options available in the TaskDialog class. You&#39;ll see a progress bar (which gets modified via the ActiveTaskDialog passed into the notification callback - try checking the &quot;Verification text&quot; box to see that happen) as well as option buttons, action buttons and some expandable text.</p>
<p>Here&#39;s how the dialog looks with the text expanded and the verification checkbox ticked:</p>
<p><a href="http://through-the-interface.typepad.com/through_the_interface/WindowsLiveWriter/Our%20basic%20task%20dialog%20with%20expanded%20text%20and%20verification%20ticked.png"><img alt="Our basic task dialog with expanded text and verification ticked" border="0" height="420" src="/assets/Our%20basic%20task%20dialog%20with%20expanded%20text%20and%20verification%20ticked_thumb.png" style="BORDER-RIGHT-WIDTH: 0px; BORDER-TOP-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px" width="462" /></a> </p>
<p>It&#39;s worth playing around with the code to see how the notification is provided to the application, and how the ActiveTaskDialog can be used from there to modify the state of the dialog. One thing you&#39;ll notice is that the hyperlinks don&#39;t automatically result in a browser being launched, which overall is a good thing, as the links can then be set up to result in other actions (the application has all the information it needs to know what was clicked in the notification callback - if it wants to launch a browser to the clicked URL, it is free to do so).</p>
<p>Now that we&#39;ve explored the various options open to us, in the next post we&#39;ll look at a more real-world example of using a task dialog to help manage potentially time-consuming application behaviour.</p>
<p><strong><em>Update</em></strong></p>
<p>In AutoCAD 2010 the TaskDialogEventArgs class was renamed to TaskDialogCallbackArgs, apparently&#0160;to be more consistent with .NET naming conventions. If you receive an error such as &quot;<em>The type or namespace name &#39;TaskDialogEventArgs&#39; could not be found (are you missing a using directive or an assembly reference?)</em>&quot; when building your application, updating the name to be TaskDialogCallbackArgs will resolve it.</p>
