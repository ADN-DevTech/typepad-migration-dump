---
layout: "post"
title: "Getting AutoCAD&rsquo;s command-line arguments using .NET"
date: "2014-03-13 14:29:33"
author: "Kean Walmsley"
categories:
  - "AutoCAD"
  - "AutoCAD .NET"
  - "Runtime"
original_url: "https://www.keanw.com/2014/03/getting-autocads-command-line-arguments-using-net.html "
typepad_basename: "getting-autocads-command-line-arguments-using-net"
typepad_status: "Publish"
---

<p>I’m starting to get ready for a trip to the US: I’m heading out on Monday and will be home on Thursday of the following week. While I expect I’ll have time to write a few posts during the trip – thank you, jetlag! – I’m going to write a couple of very simple ones today and tomorrow, just to free up time for preparations.</p>  <p>Both posts came out of an internal email discussion on trying to determine the language of the AutoCAD product your application is running in. The initial question was focused on getting this information from the command-line arguments passed into AutoCAD, hence the topic of this first post.</p>  <p>Adam Nagy, from DevTech EMEA, suggested the following <a href="http://msdn.microsoft.com/en-us/library/system.environment.commandline(v=vs.80).aspx" target="_blank">approach</a> while acknowledging there <a href="http://stackoverflow.com/questions/9287812/backslash-and-quote-in-command-line-arguments" target="_blank">might be issues</a> if choosing to use the same object to get the command-line arguments themselves.</p>  <p>Here are two C# commands to get the command-line information from System.Environment:</p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.ApplicationServices;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.Runtime;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">namespace</span><span style="line-height: 140%"> CommandLineArgs</span></p>    <p style="margin: 0px"><span style="line-height: 140%">{</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">class</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Commands</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; [</span><span style="line-height: 140%; color: #2b91af">CommandMethod</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: #a31515">&quot;CL&quot;</span><span style="line-height: 140%">)]</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">static</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> CommandLine()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Application</span><span style="line-height: 140%">.DocumentManager.MdiActiveDocument.Editor.</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; WriteMessage(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;\nCommand-line at AutoCAD launch was [{0}].&quot;</span><span style="line-height: 140%">,</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; System.</span><span style="line-height: 140%; color: #2b91af">Environment</span><span style="line-height: 140%">.CommandLine</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; );</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; [</span><span style="line-height: 140%; color: #2b91af">CommandMethod</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: #a31515">&quot;CLA&quot;</span><span style="line-height: 140%">)]</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">static</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> CommandLineArguments()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">var</span><span style="line-height: 140%"> ed = </span><span style="line-height: 140%; color: #2b91af">Application</span><span style="line-height: 140%">.DocumentManager.MdiActiveDocument.Editor;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">var</span><span style="line-height: 140%"> args = System.</span><span style="line-height: 140%; color: #2b91af">Environment</span><span style="line-height: 140%">.GetCommandLineArgs();</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;\nCommand-line arguments at AutoCAD launch were &quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; );</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">foreach</span><span style="line-height: 140%"> (</span><span style="line-height: 140%; color: blue">var</span><span style="line-height: 140%"> arg </span><span style="line-height: 140%; color: blue">in</span><span style="line-height: 140%"> args)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</span><span style="line-height: 140%; color: #a31515">&quot;[{0}] &quot;</span><span style="line-height: 140%">, arg);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">}</span></p> </div>  <p>If we run the first one we can see the full command-line, while the second chunks it up into separate arguments. Which you use is ultimately up to you, but you should bear in mind that – as explained in the StackOverflow discussion Adam mentioned – due to <a href="http://weblogs.asp.net/jgalloway/archive/2006/10/05/_5B002E00_NET-Gotcha_5D00_-Commandline-args-ending-in-_5C002200_-are-subject-to-CommandLineToArgvW-whackiness.aspx" target="_blank">GetCommandLineArgs()’s use of CommandLineToArgvW()</a>, you might get somewhat bizarre escaping behaviour especially if the command-line arguments contain backslashes.</p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%">Command: <font color="#ff0000">CL</font></span></p>    <p style="margin: 0px"><span style="line-height: 140%">Command-line at AutoCAD launch was [&quot;C:\Program Files\Autodesk\AutoCAD 2014\acad.exe&quot;&#160; /product &quot;ACAD&quot; /language &quot;en-US&quot;].</span></p>    <p style="margin: 0px"><span style="line-height: 140%">Command: <font color="#ff0000">CLA</font></span></p>    <p style="margin: 0px"><span style="line-height: 140%">Command-line arguments at AutoCAD launch were [C:\Program Files\Autodesk\AutoCAD 2014\acad.exe] [/product] [ACAD] [/language] [en-US]</span></p> </div>  <p>As you can see, the results are OK for standard AutoCAD usage. That said, for the particular scenario of wanting to determining the language of your AutoCAD product, there is a better way. More on that tomorrow.</p>
