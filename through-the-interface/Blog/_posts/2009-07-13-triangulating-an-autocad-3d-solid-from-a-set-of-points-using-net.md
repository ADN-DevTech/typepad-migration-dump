---
layout: "post"
title: "Triangulating an AutoCAD 3D solid from a set of points using .NET"
date: "2009-07-13 11:31:11"
author: "Kean Walmsley"
categories:
  - "AutoCAD"
  - "AutoCAD .NET"
  - "Solid modeling"
original_url: "https://www.keanw.com/2009/07/triangulating-an-autocad-3d-solid-from-a-set-of-points-using-net.html "
typepad_basename: "triangulating-an-autocad-3d-solid-from-a-set-of-points-using-net"
typepad_status: "Publish"
---

<p><em>As promised in </em><a href="http://through-the-interface.typepad.com/through_the_interface/2009/07/triangulating-an-autocad-sub-division-mesh-from-a-set-of-points-using-net.html"><em>this previous post</em></a><em>, we’re now going to an update to Zeljko’s triangulation code which creates Solid3d objects with a user-specified depth from our SubDMesh.</em></p>
<p>Here’s the C# code with the new/modified lines in <font color="#ff0000">red</font> (<span class="at-xid-6a00d83452464869e2011571fc9144970b"><a href="http://through-the-interface.typepad.com/files/triangulation.cs">here is the .cs source file</a></span>). I’ve modified the code to reformat it and to provide the various options side-by-side in separate commands</p>
<div style="FONT-FAMILY: courier new; BACKGROUND: white; COLOR: black; FONT-SIZE: 8pt">
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160;&#0160; 1</span>&#0160;<span style="LINE-HEIGHT: 140%; COLOR: blue">using</span><span style="LINE-HEIGHT: 140%"> Autodesk.AutoCAD.ApplicationServices;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160;&#0160; 2</span>&#0160;<span style="LINE-HEIGHT: 140%; COLOR: blue">using</span><span style="LINE-HEIGHT: 140%"> Autodesk.AutoCAD.DatabaseServices;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160;&#0160; 3</span>&#0160;<span style="LINE-HEIGHT: 140%; COLOR: blue">using</span><span style="LINE-HEIGHT: 140%"> Autodesk.AutoCAD.Runtime;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160;&#0160; 4</span>&#0160;<span style="LINE-HEIGHT: 140%; COLOR: blue">using</span><span style="LINE-HEIGHT: 140%"> Autodesk.AutoCAD.EditorInput;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160;&#0160; 5</span>&#0160;<span style="LINE-HEIGHT: 140%; COLOR: blue">using</span><span style="LINE-HEIGHT: 140%"> Autodesk.AutoCAD.Geometry;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160;&#0160; 6</span>&#0160;<span style="LINE-HEIGHT: 140%; COLOR: blue">using</span><span style="LINE-HEIGHT: 140%"> System;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160;&#0160; 7</span>&#0160;</p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160;&#0160; 8</span>&#0160;<span style="LINE-HEIGHT: 140%; COLOR: blue">public</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">class</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">Triangulate</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160;&#0160; 9</span>&#0160;<span style="LINE-HEIGHT: 140%">{</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 10</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">public</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">bool</span><span style="LINE-HEIGHT: 140%"> circum(</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 11</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">double</span><span style="LINE-HEIGHT: 140%"> x1, </span><span style="LINE-HEIGHT: 140%; COLOR: blue">double</span><span style="LINE-HEIGHT: 140%"> y1, </span><span style="LINE-HEIGHT: 140%; COLOR: blue">double</span><span style="LINE-HEIGHT: 140%"> x2,</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 12</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">double</span><span style="LINE-HEIGHT: 140%"> y2, </span><span style="LINE-HEIGHT: 140%; COLOR: blue">double</span><span style="LINE-HEIGHT: 140%"> x3, </span><span style="LINE-HEIGHT: 140%; COLOR: blue">double</span><span style="LINE-HEIGHT: 140%"> y3,</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 13</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">ref</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">double</span><span style="LINE-HEIGHT: 140%"> xc, </span><span style="LINE-HEIGHT: 140%; COLOR: blue">ref</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">double</span><span style="LINE-HEIGHT: 140%"> yc, </span><span style="LINE-HEIGHT: 140%; COLOR: blue">ref</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">double</span><span style="LINE-HEIGHT: 140%"> r)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 14</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 15</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: green">// Calculation of circumscribed circle coordinates and</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 16</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: green">// squared radius</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 17</span>&#0160;</p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 18</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">const</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">double</span><span style="LINE-HEIGHT: 140%"> eps = 1e-6;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 19</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">const</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">double</span><span style="LINE-HEIGHT: 140%"> big = 1e12;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 20</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">bool</span><span style="LINE-HEIGHT: 140%"> result = </span><span style="LINE-HEIGHT: 140%; COLOR: blue">true</span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 21</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">double</span><span style="LINE-HEIGHT: 140%"> m1, m2, mx1, mx2, my1, my2, dx, dy;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 22</span>&#0160;</p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 23</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> ((</span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">Math</span><span style="LINE-HEIGHT: 140%">.Abs(y1 - y2) &lt; eps) &amp;&amp; (</span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">Math</span><span style="LINE-HEIGHT: 140%">.Abs(y2 - y3) &lt; eps))</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 24</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 25</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; result = </span><span style="LINE-HEIGHT: 140%; COLOR: blue">false</span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 26</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; xc = x1; yc = y1; r = big;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 27</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 28</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">else</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 29</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 30</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> (</span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">Math</span><span style="LINE-HEIGHT: 140%">.Abs(y2 - y1) &lt; eps)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 31</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 32</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; m2 = -(x3 - x2) / (y3 - y2);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 33</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; mx2 = (x2 + x3) / 2;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 34</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; my2 = (y2 + y3) / 2;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 35</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; xc = (x2 + x1) / 2;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 36</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; yc = m2 * (xc - mx2) + my2;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 37</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 38</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">else</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> (</span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">Math</span><span style="LINE-HEIGHT: 140%">.Abs(y3 - y2) &lt; eps)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 39</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 40</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; m1 = -(x2 - x1) / (y2 - y1);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 41</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; mx1 = (x1 + x2) / 2;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 42</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; my1 = (y1 + y2) / 2;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 43</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; xc = (x3 + x2) / 2;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 44</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; yc = m1 * (xc - mx1) + my1;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 45</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 46</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">else</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 47</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 48</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; m1 = -(x2 - x1) / (y2 - y1);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 49</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; m2 = -(x3 - x2) / (y3 - y2);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 50</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> (</span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">Math</span><span style="LINE-HEIGHT: 140%">.Abs(m1 - m2) &lt; eps)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 51</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 52</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; result = </span><span style="LINE-HEIGHT: 140%; COLOR: blue">false</span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 53</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; xc = x1;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 54</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; yc = y1;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 55</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; r = big;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 56</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 57</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">else</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 58</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 59</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; mx1 = (x1 + x2) / 2;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 60</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; mx2 = (x2 + x3) / 2;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 61</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; my1 = (y1 + y2) / 2;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 62</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; my2 = (y2 + y3) / 2;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 63</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; xc = (m1 * mx1 - m2 * mx2 + my2 - my1) / (m1 - m2);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 64</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; yc = m1 * (xc - mx1) + my1;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 65</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 66</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 67</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 68</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; dx = x2 - xc;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 69</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; dy = y2 - yc;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 70</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; r = dx * dx + dy * dy;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 71</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">return</span><span style="LINE-HEIGHT: 140%"> result;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 72</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 73</span>&#0160;</p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 74</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">private</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">enum</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">OutputObjectType</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 75</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 76</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; PolyFaceMesh = 1,</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; <font color="#ff0000">77</font></span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; Solid3d = 2,</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; <font color="#ff0000">78</font></span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; SubDMesh = 4,</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; <font color="#ff0000">79</font></span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; All = 7</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 80</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 81</span>&#0160;</p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 82</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">private</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">void</span><span style="LINE-HEIGHT: 140%"> TriangulatePoints(</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 83</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">OutputObjectType</span><span style="LINE-HEIGHT: 140%"> objType, </span><span style="LINE-HEIGHT: 140%; COLOR: blue">int</span><span style="LINE-HEIGHT: 140%"> maxpoints</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 84</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160; )</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 85</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 86</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">Document</span><span style="LINE-HEIGHT: 140%"> doc =</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 87</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">Application</span><span style="LINE-HEIGHT: 140%">.DocumentManager.MdiActiveDocument;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 88</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">Database</span><span style="LINE-HEIGHT: 140%"> db = doc.Database;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 89</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">Editor</span><span style="LINE-HEIGHT: 140%"> ed = doc.Editor;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 90</span>&#0160;</p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 91</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">bool</span><span style="LINE-HEIGHT: 140%"> createSubDMesh =</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 92</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; (objType &amp; </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">OutputObjectType</span><span style="LINE-HEIGHT: 140%">.SubDMesh) &gt; 0;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 93</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">bool</span><span style="LINE-HEIGHT: 140%"> createPolyFaceMesh =</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 94</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; (objType &amp; </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">OutputObjectType</span><span style="LINE-HEIGHT: 140%">.PolyFaceMesh) &gt; 0;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160;&#0160; 95</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">bool</span><span style="LINE-HEIGHT: 140%"> createSolid3d =</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160;&#0160; 96</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; (objType &amp; </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">OutputObjectType</span><span style="LINE-HEIGHT: 140%">.Solid3d) &gt; 0;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 97</span>&#0160;</p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 98</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">TypedValue</span><span style="LINE-HEIGHT: 140%">[] tvs = { </span><span style="LINE-HEIGHT: 140%; COLOR: blue">new</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">TypedValue</span><span style="LINE-HEIGHT: 140%">(0, </span><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;POINT&quot;</span><span style="LINE-HEIGHT: 140%">) };</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160;&#0160; 99</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">SelectionFilter</span><span style="LINE-HEIGHT: 140%"> sf =</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 100</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">new</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">SelectionFilter</span><span style="LINE-HEIGHT: 140%">(tvs);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 101</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">PromptSelectionOptions</span><span style="LINE-HEIGHT: 140%"> pso = </span><span style="LINE-HEIGHT: 140%; COLOR: blue">new</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">PromptSelectionOptions</span><span style="LINE-HEIGHT: 140%">();</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 102</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; pso.MessageForAdding = </span><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;\nSelect points:&quot;</span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 103</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; pso.AllowDuplicates = </span><span style="LINE-HEIGHT: 140%; COLOR: blue">false</span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 104</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">PromptSelectionResult</span><span style="LINE-HEIGHT: 140%"> psr = ed.GetSelection(pso, sf);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 105</span>&#0160;</p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 106</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> (psr.Status == </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">PromptStatus</span><span style="LINE-HEIGHT: 140%">.Error) </span><span style="LINE-HEIGHT: 140%; COLOR: blue">return</span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 107</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> (psr.Status == </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">PromptStatus</span><span style="LINE-HEIGHT: 140%">.Cancel) </span><span style="LINE-HEIGHT: 140%; COLOR: blue">return</span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 108</span>&#0160;</p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 109</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">SelectionSet</span><span style="LINE-HEIGHT: 140%"> ss = psr.Value;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 110</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">int</span><span style="LINE-HEIGHT: 140%"> npts = ss.Count;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 111</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> (npts &lt; 3)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 112</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 113</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; ed.WriteMessage(</span><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;Minimum of 3 points must be selected!&quot;</span><span style="LINE-HEIGHT: 140%">);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 114</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">return</span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 115</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 116</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> (npts &gt; maxpoints)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 117</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 118</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; ed.WriteMessage(</span><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;Maximum number of points exceeded!&quot;</span><span style="LINE-HEIGHT: 140%">);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 119</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">return</span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 120</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 121</span>&#0160;</p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 122</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">double</span><span style="LINE-HEIGHT: 140%"> zref = 0.0;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 123</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> (createSolid3d)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 124</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 125</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">PromptDoubleResult</span><span style="LINE-HEIGHT: 140%"> ps =</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 126</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ed.GetDouble(</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 127</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;\nEnter Z coordinate of reference plane:&quot;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 128</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; );</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 129</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> (ps.Status != </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">PromptStatus</span><span style="LINE-HEIGHT: 140%">.OK) </span><span style="LINE-HEIGHT: 140%; COLOR: blue">return</span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 130</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; zref = ps.Value;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 131</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 132</span>&#0160;</p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 133</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">int</span><span style="LINE-HEIGHT: 140%"> i, j, k, ntri, ned, nouted, status1 = 0, status2 = 0;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 134</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">bool</span><span style="LINE-HEIGHT: 140%"> status;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 135</span>&#0160;</p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 136</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: green">// Point coordinates</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 137</span>&#0160;</p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 138</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">double</span><span style="LINE-HEIGHT: 140%">[] ptx = </span><span style="LINE-HEIGHT: 140%; COLOR: blue">new</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">double</span><span style="LINE-HEIGHT: 140%">[maxpoints + 3];</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 139</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">double</span><span style="LINE-HEIGHT: 140%">[] pty = </span><span style="LINE-HEIGHT: 140%; COLOR: blue">new</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">double</span><span style="LINE-HEIGHT: 140%">[maxpoints + 3];</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 140</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">double</span><span style="LINE-HEIGHT: 140%">[] ptz = </span><span style="LINE-HEIGHT: 140%; COLOR: blue">new</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">double</span><span style="LINE-HEIGHT: 140%">[maxpoints + 3];</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 141</span>&#0160;</p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 142</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: green">// Triangle definitions</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 143</span>&#0160;</p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 144</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">int</span><span style="LINE-HEIGHT: 140%">[] pt1 = </span><span style="LINE-HEIGHT: 140%; COLOR: blue">new</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">int</span><span style="LINE-HEIGHT: 140%">[maxpoints * 2 + 1];</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 145</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">int</span><span style="LINE-HEIGHT: 140%">[] pt2 = </span><span style="LINE-HEIGHT: 140%; COLOR: blue">new</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">int</span><span style="LINE-HEIGHT: 140%">[maxpoints * 2 + 1];</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 146</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">int</span><span style="LINE-HEIGHT: 140%">[] pt3 = </span><span style="LINE-HEIGHT: 140%; COLOR: blue">new</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">int</span><span style="LINE-HEIGHT: 140%">[maxpoints * 2 + 1];</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 147</span>&#0160;</p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 148</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: green">// Circumscribed circle</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 149</span>&#0160;</p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 150</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">double</span><span style="LINE-HEIGHT: 140%">[] cex = </span><span style="LINE-HEIGHT: 140%; COLOR: blue">new</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">double</span><span style="LINE-HEIGHT: 140%">[maxpoints * 2 + 1];</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 151</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">double</span><span style="LINE-HEIGHT: 140%">[] cey = </span><span style="LINE-HEIGHT: 140%; COLOR: blue">new</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">double</span><span style="LINE-HEIGHT: 140%">[maxpoints * 2 + 1];</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 152</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">double</span><span style="LINE-HEIGHT: 140%">[] rad = </span><span style="LINE-HEIGHT: 140%; COLOR: blue">new</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">double</span><span style="LINE-HEIGHT: 140%">[maxpoints * 2 + 1];</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 153</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">double</span><span style="LINE-HEIGHT: 140%"> xmin, ymin, xmax, ymax, dx, dy, xmid, ymid;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 154</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">int</span><span style="LINE-HEIGHT: 140%">[] ed1 = </span><span style="LINE-HEIGHT: 140%; COLOR: blue">new</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">int</span><span style="LINE-HEIGHT: 140%">[maxpoints * 2 + 1];</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 155</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">int</span><span style="LINE-HEIGHT: 140%">[] ed2 = </span><span style="LINE-HEIGHT: 140%; COLOR: blue">new</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">int</span><span style="LINE-HEIGHT: 140%">[maxpoints * 2 + 1];</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 156</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">int</span><span style="LINE-HEIGHT: 140%">[] outed1 = </span><span style="LINE-HEIGHT: 140%; COLOR: blue">null</span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 157</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> (createSolid3d)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 158</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; outed1 = </span><span style="LINE-HEIGHT: 140%; COLOR: blue">new</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">int</span><span style="LINE-HEIGHT: 140%">[maxpoints + 1];</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 159</span>&#0160;</p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 160</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">ObjectId</span><span style="LINE-HEIGHT: 140%">[] idarray = ss.GetObjectIds();</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 161</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">Transaction</span><span style="LINE-HEIGHT: 140%"> tr =</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 162</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; db.TransactionManager.StartTransaction();</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 163</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">using</span><span style="LINE-HEIGHT: 140%"> (tr)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 164</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 165</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">DBPoint</span><span style="LINE-HEIGHT: 140%"> ent;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 166</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; k = 0;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 167</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">for</span><span style="LINE-HEIGHT: 140%"> (i = 0; i &lt; npts; i++)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 168</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 169</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ent =</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 170</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (</span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">DBPoint</span><span style="LINE-HEIGHT: 140%">)tr.GetObject(</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 171</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; idarray[k], </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">OpenMode</span><span style="LINE-HEIGHT: 140%">.ForRead, </span><span style="LINE-HEIGHT: 140%; COLOR: blue">false</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 172</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; );</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 173</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ptx[i] = ent.Position[0];</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 174</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; pty[i] = ent.Position[1];</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 175</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ptz[i] = ent.Position[2];</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 176</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">for</span><span style="LINE-HEIGHT: 140%"> (j = 0; j &lt; i; j++)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 177</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> ((ptx[i] == ptx[j]) &amp;&amp; (pty[i] == pty[j]))</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 178</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 179</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; i--; npts--; status2++;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 180</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 181</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; k++;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 182</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 183</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; tr.Commit();</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 184</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 185</span>&#0160;</p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 186</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> (status2 &gt; 0)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 187</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; ed.WriteMessage(</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 188</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;\nIgnored {0} point(s) with same coordinates.&quot;</span><span style="LINE-HEIGHT: 140%">,</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 189</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; status2</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 190</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; );</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 191</span>&#0160;</p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 192</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: green">// Supertriangle </span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 193</span>&#0160;</p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 194</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; xmin = ptx[0]; xmax = xmin;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 195</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; ymin = pty[0]; ymax = ymin;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 196</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">for</span><span style="LINE-HEIGHT: 140%"> (i = 0; i &lt; npts; i++)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 197</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 198</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> (ptx[i] &lt; xmin) xmin = ptx[i];</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 199</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> (ptx[i] &gt; xmax) xmax = ptx[i];</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 200</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> (pty[i] &lt; xmin) ymin = pty[i];</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 201</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> (pty[i] &gt; xmin) ymax = pty[i];</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 202</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 203</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; dx = xmax - xmin; dy = ymax - ymin;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 204</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; xmid = (xmin + xmax) / 2; ymid = (ymin + ymax) / 2;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 205</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; i = npts;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 206</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; ptx[i] = xmid - (90 * (dx + dy)) - 100;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 207</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; pty[i] = ymid - (50 * (dx + dy)) - 100;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 208</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; ptz[i] = 0;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 209</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; pt1[0] = i;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 210</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; i++;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 211</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; ptx[i] = xmid + (90 * (dx + dy)) + 100;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 212</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; pty[i] = ymid - (50 * (dx + dy)) - 100;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 213</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; ptz[i] = 0;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 214</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; pt2[0] = i;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 215</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; i++;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 216</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; ptx[i] = xmid;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 217</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; pty[i] = ymid + 100 * (dx + dy + 1);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 218</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; ptz[i] = 0;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 219</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; pt3[0] = i;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 220</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; ntri = 1;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 221</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; circum(</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 222</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; ptx[pt1[0]], pty[pt1[0]], ptx[pt2[0]],</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 223</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; pty[pt2[0]], ptx[pt3[0]], pty[pt3[0]],</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 224</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">ref</span><span style="LINE-HEIGHT: 140%"> cex[0], </span><span style="LINE-HEIGHT: 140%; COLOR: blue">ref</span><span style="LINE-HEIGHT: 140%"> cey[0], </span><span style="LINE-HEIGHT: 140%; COLOR: blue">ref</span><span style="LINE-HEIGHT: 140%"> rad[0]</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 225</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; );</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 226</span>&#0160;</p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 227</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: green">// Main loop</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 228</span>&#0160;</p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 229</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">for</span><span style="LINE-HEIGHT: 140%"> (i = 0; i &lt; npts; i++)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 230</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 231</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; ned = 0;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 232</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; xmin = ptx[i]; ymin = pty[i];</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 233</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; j = 0;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 234</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">while</span><span style="LINE-HEIGHT: 140%"> (j &lt; ntri)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 235</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 236</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; dx = cex[j] - xmin; dy = cey[j] - ymin;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 237</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> (((dx * dx) + (dy * dy)) &lt; rad[j])</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 238</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 239</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ed1[ned] = pt1[j]; ed2[ned] = pt2[j];</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 240</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ned++;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 241</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ed1[ned] = pt2[j]; ed2[ned] = pt3[j];</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 242</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ned++;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 243</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ed1[ned] = pt3[j]; ed2[ned] = pt1[j];</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 244</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ned++;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 245</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ntri--;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 246</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; pt1[j] = pt1[ntri];</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 247</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; pt2[j] = pt2[ntri];</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 248</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; pt3[j] = pt3[ntri];</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 249</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; cex[j] = cex[ntri];</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 250</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; cey[j] = cey[ntri];</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 251</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; rad[j] = rad[ntri];</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 252</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; j--;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 253</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 254</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; j++;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 255</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 256</span>&#0160;</p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 257</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">for</span><span style="LINE-HEIGHT: 140%"> (j = 0; j &lt; ned - 1; j++)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 258</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">for</span><span style="LINE-HEIGHT: 140%"> (k = j + 1; k &lt; ned; k++)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 259</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> ((ed1[j] == ed2[k]) &amp;&amp; (ed2[j] == ed1[k]))</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 260</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 261</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ed1[j] = -1; ed2[j] = -1; ed1[k] = -1; ed2[k] = -1;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 262</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 263</span>&#0160;</p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 264</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">for</span><span style="LINE-HEIGHT: 140%"> (j = 0; j &lt; ned; j++)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 265</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> ((ed1[j] &gt;= 0) &amp;&amp; (ed2[j] &gt;= 0))</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 266</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 267</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; pt1[ntri] = ed1[j];</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 268</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; pt2[ntri] = ed2[j];</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 269</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; pt3[ntri] = i;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 270</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; status =</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 271</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; circum(</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 272</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ptx[pt1[ntri]], pty[pt1[ntri]], ptx[pt2[ntri]],</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 273</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; pty[pt2[ntri]], ptx[pt3[ntri]], pty[pt3[ntri]],</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 274</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">ref</span><span style="LINE-HEIGHT: 140%"> cex[ntri], </span><span style="LINE-HEIGHT: 140%; COLOR: blue">ref</span><span style="LINE-HEIGHT: 140%"> cey[ntri], </span><span style="LINE-HEIGHT: 140%; COLOR: blue">ref</span><span style="LINE-HEIGHT: 140%"> rad[ntri]</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 275</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; );</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 276</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> (!status)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 277</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 278</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; status1++;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 279</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 280</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ntri++;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 281</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 282</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 283</span>&#0160;</p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 284</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: green">// Removal of outer triangles</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 285</span>&#0160;</p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 286</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; i = 0; nouted = 0;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 287</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">while</span><span style="LINE-HEIGHT: 140%"> (i &lt; ntri)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 288</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 289</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> ((pt1[i] &gt;= npts) ||</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 290</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (pt2[i] &gt;= npts) ||</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 291</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (pt3[i] &gt;= npts))</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 292</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 293</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> (createSolid3d)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 294</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 295</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> ((pt1[i] &gt;= npts) &amp;&amp;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 296</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (pt2[i] &lt; npts) &amp;&amp;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 297</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (pt3[i] &lt; npts))</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 298</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 299</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ed1[nouted] = pt2[i];</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 300</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ed2[nouted] = pt3[i];</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 301</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; nouted++;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 302</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 303</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> ((pt2[i] &gt;= npts) &amp;&amp;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 304</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (pt1[i] &lt; npts) &amp;&amp;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 305</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (pt3[i] &lt; npts))</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 306</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 307</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ed1[nouted] = pt3[i];</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 308</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ed2[nouted] = pt1[i];</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 309</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; nouted++;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 310</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 311</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> ((pt3[i] &gt;= npts) &amp;&amp;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 312</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (pt1[i] &lt; npts) &amp;&amp;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 313</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (pt2[i] &lt; npts))</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 314</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 315</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ed1[nouted] = pt1[i];</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 316</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ed2[nouted] = pt2[i];</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 317</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; nouted++;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 318</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 319</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 320</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ntri--;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 321</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; pt1[i] = pt1[ntri];</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 322</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; pt2[i] = pt2[ntri];</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 323</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; pt3[i] = pt3[ntri];</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 324</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; cex[i] = cex[ntri];</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 325</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; cey[i] = cey[ntri];</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 326</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; rad[i] = rad[ntri];</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 327</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; i--;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 328</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 329</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; i++;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 330</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 331</span>&#0160;</p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 332</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> (createSolid3d)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 333</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 334</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; outed1[0] = 0;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 335</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">for</span><span style="LINE-HEIGHT: 140%"> (i = 1; i &lt; nouted; i++)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 336</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">for</span><span style="LINE-HEIGHT: 140%"> (j = 1; j &lt; nouted; j++)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 337</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> (ed2[outed1[i - 1]] == ed1[j])</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 338</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 339</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; outed1[i] = j;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 340</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; j = nouted;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 341</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 342</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; outed1[nouted] = 0;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 343</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 344</span>&#0160;</p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 345</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; tr = db.TransactionManager.StartTransaction();</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 346</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">using</span><span style="LINE-HEIGHT: 140%"> (tr)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 347</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 348</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">BlockTable</span><span style="LINE-HEIGHT: 140%"> bt =</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 349</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (</span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">BlockTable</span><span style="LINE-HEIGHT: 140%">)tr.GetObject(</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 350</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; db.BlockTableId,</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 351</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">OpenMode</span><span style="LINE-HEIGHT: 140%">.ForRead,</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 352</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">false</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 353</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; );</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 354</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">BlockTableRecord</span><span style="LINE-HEIGHT: 140%"> btr =</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 355</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (</span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">BlockTableRecord</span><span style="LINE-HEIGHT: 140%">)tr.GetObject(</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 356</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; bt[</span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">BlockTableRecord</span><span style="LINE-HEIGHT: 140%">.ModelSpace],</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 357</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">OpenMode</span><span style="LINE-HEIGHT: 140%">.ForWrite,</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 358</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">false</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 359</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; );</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 360</span>&#0160;</p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 361</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> (createPolyFaceMesh)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 362</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 363</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">PolyFaceMesh</span><span style="LINE-HEIGHT: 140%"> pfm = </span><span style="LINE-HEIGHT: 140%; COLOR: blue">new</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">PolyFaceMesh</span><span style="LINE-HEIGHT: 140%">();</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 364</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; btr.AppendEntity(pfm);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 365</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; tr.AddNewlyCreatedDBObject(pfm, </span><span style="LINE-HEIGHT: 140%; COLOR: blue">true</span><span style="LINE-HEIGHT: 140%">);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 366</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">for</span><span style="LINE-HEIGHT: 140%"> (i = 0; i &lt; npts; i++)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 367</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 368</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">PolyFaceMeshVertex</span><span style="LINE-HEIGHT: 140%"> vert =</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 369</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">new</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">PolyFaceMeshVertex</span><span style="LINE-HEIGHT: 140%">(</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 370</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">new</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">Point3d</span><span style="LINE-HEIGHT: 140%">(ptx[i], pty[i], ptz[i])</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 371</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; );</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 372</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; pfm.AppendVertex(vert);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 373</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; tr.AddNewlyCreatedDBObject(vert, </span><span style="LINE-HEIGHT: 140%; COLOR: blue">true</span><span style="LINE-HEIGHT: 140%">);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 374</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 375</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">for</span><span style="LINE-HEIGHT: 140%"> (i = 0; i &lt; ntri; i++)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 376</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 377</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">FaceRecord</span><span style="LINE-HEIGHT: 140%"> face =</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 378</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">new</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">FaceRecord</span><span style="LINE-HEIGHT: 140%">(</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 379</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (</span><span style="LINE-HEIGHT: 140%; COLOR: blue">short</span><span style="LINE-HEIGHT: 140%">)(pt1[i] + 1),</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 380</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (</span><span style="LINE-HEIGHT: 140%; COLOR: blue">short</span><span style="LINE-HEIGHT: 140%">)(pt2[i] + 1),</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 381</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (</span><span style="LINE-HEIGHT: 140%; COLOR: blue">short</span><span style="LINE-HEIGHT: 140%">)(pt3[i] + 1),</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 382</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; 0</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 383</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; );</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 384</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; pfm.AppendFaceRecord(face);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 385</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; tr.AddNewlyCreatedDBObject(face, </span><span style="LINE-HEIGHT: 140%; COLOR: blue">true</span><span style="LINE-HEIGHT: 140%">);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 386</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 387</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 388</span>&#0160;</p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 389</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> (createSubDMesh || createSolid3d)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 390</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 391</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">Point3dCollection</span><span style="LINE-HEIGHT: 140%"> vertarray = </span><span style="LINE-HEIGHT: 140%; COLOR: blue">new</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">Point3dCollection</span><span style="LINE-HEIGHT: 140%">();</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 392</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">Int32Collection</span><span style="LINE-HEIGHT: 140%"> facearray = </span><span style="LINE-HEIGHT: 140%; COLOR: blue">new</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">Int32Collection</span><span style="LINE-HEIGHT: 140%">();</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 393</span>&#0160;</p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 394</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">for</span><span style="LINE-HEIGHT: 140%"> (i = 0; i &lt; npts; i++)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 395</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; vertarray.Add(</span><span style="LINE-HEIGHT: 140%; COLOR: blue">new</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">Point3d</span><span style="LINE-HEIGHT: 140%">(ptx[i], pty[i], ptz[i]));</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 396</span>&#0160;</p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 397</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> (createSolid3d)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 398</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">for</span><span style="LINE-HEIGHT: 140%"> (i = 0; i &lt; nouted; i++)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 399</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; vertarray.Add(</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 400</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">new</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">Point3d</span><span style="LINE-HEIGHT: 140%">(</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 401</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ptx[ed1[outed1[i]]], pty[ed1[outed1[i]]], zref</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 402</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; )</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 403</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; );</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 404</span>&#0160;</p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 405</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; j = 0;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 406</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">for</span><span style="LINE-HEIGHT: 140%"> (i = 0; i &lt; ntri; i++)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 407</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 408</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; facearray.Add(3);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 409</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; facearray.Add(pt1[i]);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 410</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; facearray.Add(pt2[i]);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 411</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; facearray.Add(pt3[i]);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 412</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 413</span>&#0160;</p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 414</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> (createSolid3d)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 415</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 416</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">for</span><span style="LINE-HEIGHT: 140%"> (i = 0; i &lt; nouted; i++)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 417</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 418</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; facearray.Add(4);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 419</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; k = outed1[i];</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 420</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; facearray.Add(ed1[k]);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 421</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; facearray.Add(ed2[k]);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 422</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> (i == nouted - 1)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 423</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 424</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; facearray.Add(npts);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 425</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 426</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">else</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 427</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 428</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; facearray.Add(npts + i + 1);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 429</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 430</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; facearray.Add(npts + i);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 431</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 432</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; facearray.Add(nouted);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 433</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">for</span><span style="LINE-HEIGHT: 140%"> (i = 0; i &lt; nouted; i++)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 434</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; facearray.Add(npts + i);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 435</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 436</span>&#0160;</p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 437</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">SubDMesh</span><span style="LINE-HEIGHT: 140%"> sdm = </span><span style="LINE-HEIGHT: 140%; COLOR: blue">new</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">SubDMesh</span><span style="LINE-HEIGHT: 140%">();</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 438</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; sdm.SetDatabaseDefaults();</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 439</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; sdm.SetSubDMesh(vertarray, facearray, 0);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 440</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; btr.AppendEntity(sdm);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 441</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; tr.AddNewlyCreatedDBObject(sdm, </span><span style="LINE-HEIGHT: 140%; COLOR: blue">true</span><span style="LINE-HEIGHT: 140%">);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 442</span>&#0160;</p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 443</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> (createSolid3d)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 444</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 445</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">Solid3d</span><span style="LINE-HEIGHT: 140%"> sol = </span><span style="LINE-HEIGHT: 140%; COLOR: blue">null</span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 446</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">try</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 447</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 448</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; sol = sdm.ConvertToSolid(</span><span style="LINE-HEIGHT: 140%; COLOR: blue">false</span><span style="LINE-HEIGHT: 140%">, </span><span style="LINE-HEIGHT: 140%; COLOR: blue">false</span><span style="LINE-HEIGHT: 140%">);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 449</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; btr.AppendEntity(sol);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 450</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; tr.AddNewlyCreatedDBObject(sol, </span><span style="LINE-HEIGHT: 140%; COLOR: blue">true</span><span style="LINE-HEIGHT: 140%">);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 451</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 452</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">catch</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 453</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 454</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ed.WriteMessage(</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 455</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;\nMesh was too complex to turn into a solid.&quot;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 456</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; );</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 457</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 458</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> (!createSubDMesh)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 459</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; sdm.Erase();</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 460</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 461</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 462</span>&#0160;</p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 463</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; tr.Commit();</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 464</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 465</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> (status1 &gt; 0)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 466</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; ed.WriteMessage(</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 467</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;\nWarning! {0} thin triangle(s) found!&quot;</span><span style="LINE-HEIGHT: 140%"> +</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 468</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot; Wrong result possible!&quot;</span><span style="LINE-HEIGHT: 140%">,</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 469</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; status1</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 470</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160;&#0160;&#0160; );</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 471</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">Application</span><span style="LINE-HEIGHT: 140%">.UpdateScreen();</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 472</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 473</span>&#0160;</p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 474</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160; [</span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">CommandMethod</span><span style="LINE-HEIGHT: 140%">(</span><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;PFT&quot;</span><span style="LINE-HEIGHT: 140%">)]</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 475</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">public</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">void</span><span style="LINE-HEIGHT: 140%"> PolyFaceTriangulate()</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 476</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 477</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; TriangulatePoints(</span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">OutputObjectType</span><span style="LINE-HEIGHT: 140%">.PolyFaceMesh, 32767);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 478</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 479</span>&#0160;</p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 480</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160; [</span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">CommandMethod</span><span style="LINE-HEIGHT: 140%">(</span><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;SDT&quot;</span><span style="LINE-HEIGHT: 140%">)]</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 481</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">public</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">void</span><span style="LINE-HEIGHT: 140%"> SubDTriangulate()</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 482</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 483</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; TriangulatePoints(</span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">OutputObjectType</span><span style="LINE-HEIGHT: 140%">.SubDMesh, 200000);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 484</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 485</span>&#0160;</p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 486</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160; [</span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">CommandMethod</span><span style="LINE-HEIGHT: 140%">(</span><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;S3T&quot;</span><span style="LINE-HEIGHT: 140%">)]</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 487</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">public</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">void</span><span style="LINE-HEIGHT: 140%"> Solid3dTriangulate()</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 488</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 489</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160;&#0160;&#0160; TriangulatePoints(</span><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">OutputObjectType</span><span style="LINE-HEIGHT: 140%">.Solid3d, 200000);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #ff0000">&#0160; 490</span>&#0160;<span style="LINE-HEIGHT: 140%">&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="COLOR: #2b91af">&#0160; 491</span>&#0160;<span style="LINE-HEIGHT: 140%">}</span></p></div>
<p></p>
<p>Let’s now run the SDT command to create a SubDMesh on the left, and the S3T command to create a Solid3d with a particular depth on the right:</p>
<p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201157107ce3f970c-pi"><img alt="Results of SDT and S3T commands in 2D wireframe plan" border="0" height="198" src="/assets/image_222600.jpg" style="BORDER-RIGHT-WIDTH: 0px; DISPLAY: inline; BORDER-TOP-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px" title="Results of SDT and S3T commands in 2D wireframe plan" width="485" /></a></p>
<p>Now let’s compare them in a 3D view with the conceptual visual style applied:</p>
<p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201157107ce49970c-pi"><img alt="Results of SDT and S3T commands in conceptual 3D view" border="0" height="261" src="/assets/image_117883.jpg" style="BORDER-BOTTOM: 0px; BORDER-LEFT: 0px; DISPLAY: inline; BORDER-TOP: 0px; BORDER-RIGHT: 0px" title="Results of SDT and S3T commands in conceptual 3D view" width="482" /></a> </p>
<p>We can then use MASSPROP to determine the 3D solid’s volume (which I’m sure would be useful when analysing land surveys, for instance).</p>
<p>A quick word on performance: the Solid3d object is really not designed to represent large volumes derived from point clouds. This approach can work for modest datasets, but you should not expect it to work acceptably with many thousands of points.</p>
<p>Zeljko very cleverly implemented an alternative approach using (unsupported) P/Invoke calls to acdbEntMake() rather than creating the initial SubDMesh and converting it. This resulted in an improvement of nearly 50% (he ran it on a dataset of 5,000 points in 2 minutes, vs. 3:45 minutes with the above code), but ultimately the fundamental bottleneck is elsewhere: Solid3d objects are intended to be precise solid modelling primitives rather than containers for point clouds.</p>
<p>Thanks again for a fascinating series, Zeljko! :-)</p>
