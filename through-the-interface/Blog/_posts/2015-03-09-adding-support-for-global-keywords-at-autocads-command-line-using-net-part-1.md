---
layout: "post"
title: "Adding support for global keywords at AutoCAD&rsquo;s command-line using .NET &ndash; Part 1"
date: "2015-03-09 18:36:27"
author: "Kean Walmsley"
categories:
  - "AutoCAD"
  - "Commands"
  - "Notification / Events"
  - "Runtime"
  - "User interface"
original_url: "https://www.keanw.com/2015/03/adding-support-for-global-keywords-at-autocads-command-line-using-net-part-1.html "
typepad_basename: "adding-support-for-global-keywords-at-autocads-command-line-using-net-part-1"
typepad_status: "Publish"
---

<p>This post carries on from this series from a couple of weeks ago:</p>  <ul>   <li><a href="http://through-the-interface.typepad.com/through_the_interface/2015/02/adding-a-global-keyword-menu-to-autocad-using-wpf-part-1.html" target="_blank">Adding a global keyword menu to AutoCAD using WPF – Part 1</a> </li>    <li><a href="http://through-the-interface.typepad.com/through_the_interface/2015/02/adding-a-global-keyword-menu-to-autocad-using-wpf-part-2.html" target="_blank">Adding a global keyword menu to AutoCAD using WPF – Part 2</a> </li>    <li><a href="http://through-the-interface.typepad.com/through_the_interface/2015/02/enabling-global-commands-on-localized-autocad-versions-using-net.html" target="_blank">Enabling global commands on localized AutoCAD versions using .NET</a> </li> </ul>  <p>The overall goal behind these posts was to create a “command-line helper” tool to make it easier for people who know the English version of AutoCAD (or an AutoCAD-based vertical) to work with a corresponding localized version. Basically because some people learn AutoCAD using an English version – perhaps during their studies – but then become a bit lost when they find they suddenly have to work with a local-language version in a professional setting.</p>  <p>In previous posts we’ve added the ability to launch global commands without the underscore prefix (we check for “unknown commands” and try them again with the prefix) as well as displaying a helpful “global keyword list” dialog while commands prompt for keywords. Here’s a reminder of what this dialog looks like:</p>  <br /><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201b7c75e1433970b-pi"><img title="KeywordHelper" style="float: none; margin-left: auto; display: block; margin-right: auto" alt="KeywordHelper" src="/assets/image_360375.jpg" width="450" height="399" /></a>  <br />  <p>Which is a good start, but the next big hurdle was around entering global keywords without the underscore: it’s all well and good to be able to launch a global command via the command-line, but if you then have to double-click a UI element to enter a global keyword (or remember to add your own underscore prefix when typing it yourself) then it’s incomplete.</p>  <p>I spent much of today adding global keyword support into the command-line: what we wanted to do was insert an underscore prefix in front of a complete keyword being typed in at the command-line assuming it matches an expected global keyword (of which we handily already have a list in our popup dialog).</p>  <p>I wasn’t at all sure this was possible, I have to say. My thinking was to use the powerful-but-scary Application.PreTranslateMessage event – which <a href="http://through-the-interface.typepad.com/through_the_interface/2008/05/filtering-windo.html" target="_blank">I talked out many moons ago</a> – as this gives you really low level access to messages arriving via the input pipeline. But I wasn’t at all sure it would give you the access you need to achieve this.</p>  <p>It did turn out to be possible – as of about 30 minutes ago I managed to get something working – but there’s quite a bit of code I need to tidy up before posting. We’ll take a look at the solution either tomorrow or the day after. Watch this space!</p>
