---
layout: "post"
title: "Copying &amp; pasting code from this blog into Visual Studio"
date: "2011-09-30 05:03:00"
author: "Kean Walmsley"
categories:
  - "Personal"
  - "Visual Studio"
  - "Web/Tech"
original_url: "https://www.keanw.com/2011/09/copying-pasting-code-from-this-blog-into-visual-studio.html "
typepad_basename: "copying-pasting-code-from-this-blog-into-visual-studio"
typepad_status: "Publish"
---

<p>I’ve been meaning to post on this topic for some time, and <a href="http://through-the-interface.typepad.com/through_the_interface/2011/09/an-update-to-minesweeper-for-autocad.html#comment-6a00d83452464869e2015435a5285f970c" target="_blank">a recent comment</a> reminded me to do so.</p>
<p>As many of you will have noticed, when you do a straight copy &amp; paste of code from this blog into Visual Studio, it comes with unwanted line feeds.</p>
<p>For instance, taking some recently posted code using Internet Explorer 9:</p>
<p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2015435b4b2cf970c-pi" target="_blank"><img alt="Copying code from Internet Explorer into Visual Studio" border="0" height="319" src="/assets/image_311784.jpg" style="background-image: none; margin: 20px auto; padding-left: 0px; padding-right: 0px; display: block; float: none; padding-top: 0px; border-width: 0px;" title="Copying code from Internet Explorer into Visual Studio" width="385" /></a></p>
<p>And pasting it into VS2010 results in unwanted linefeeds in the code:</p>
<p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2015435b4b2dc970c-pi" target="_blank"><img alt="The code in VS2010" border="0" height="349" src="/assets/image_57324.jpg" style="background-image: none; margin: 20px auto; padding-left: 0px; padding-right: 0px; display: block; float: none; padding-top: 0px; border-width: 0px;" title="The code in VS2010" width="394" /></a></p>
<p>Less than ideal, to say the least. The reason this happens is probably the way the HTML gets formatted by the <a href="http://through-the-interface.typepad.com/through_the_interface/2006/08/some_cool_copyp.html" target="_blank">CopySourceAsHtml</a> <a href="http://through-the-interface.typepad.com/through_the_interface/2011/03/finally-working-with-visual-studio-2010.html" target="_blank">tool</a> I use to get the code from Visual Studio into Windows Live Writer (my preferred blogging tool).</p>
<p>When posting code to <a href="http://blogs.autodesk.com/thebuildingcoder" target="_blank">his blog</a>, Jeremy Tammik runs a Python script to edit the clipboard contents and minimise the code created (replacing hardcoded styles with CSS, adjusting the inclusion of linefeeds, etc,.), but I prefer not to: as far as it goes I’m actually pretty happy with the way the code comes across into the blog using CopySourceAsHtml, and don’t see the need to introduce an additional step in my posting process.</p>
<p>But I certainly acknowledge the ugliness of the linefeed issue when trying to reuse the code. To that end, this post lists three options for getting code from this blog cleanly into Visual Studio.</p>
<h3>1. Copy using Google Chrome</h3>
<p>This is, in many ways, the simplest solution I’ve found: if you copy the code from this blog using <a href="http://google.com/chrome" target="_blank">Google Chrome</a>, it comes across into Visual Studio without the additional whitespace. This is a nice option as it’s simple and free. But obviously means you have to install an additional browser, if you don’t already have it.</p>
<p>I happen to have Chrome installed in OS X on my system, but as Parallels Desktop shares a clipboard with OS X, it works well pasting into Visual Studio for me, too:</p>
<p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2014e8bd4fad3970d-pi" target="_blank"><img alt="Copying code from Google Chrome" border="0" height="369" src="/assets/image_126268.jpg" style="background-image: none; margin: 20px auto; padding-left: 0px; padding-right: 0px; display: block; float: none; padding-top: 0px; border-width: 0px;" title="Copying code from Google Chrome" width="458" /></a></p>
<h3>2. Use ClipboardFusion to search for &amp; replace double linefeeds</h3>
<p><a href="http://www.clipboardfusion.com" target="_blank">ClipboardFusion</a> from Binary Fortress Software is a free tool (with optional subscription pricing for ClipboardFusion Online) that allows you to “scrub” your clipboard. This may mean removing HTML tags, or some other activity. In our case we want to perform a simple search &amp; replace operation: we want to replace double-linefeeds with single ones.</p>
<p>Once the tool has been installed, you can edit the ClipboardFusion settings, to specify the desired “Text Replace” operation, to match “\n\n” and replace it with “\n”:</p>
<p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2015391e13c4d970b-pi" target="_blank"><img alt="ClipboardFusion Settings" border="0" height="287" src="/assets/image_164286.jpg" style="background-image: none; margin: 20px auto; padding-left: 0px; padding-right: 0px; display: block; float: none; padding-top: 0px; border-width: 0px;" title="ClipboardFusion Settings" width="408" /></a></p>
<p>You can set the scrubbing to occur on “double-copy” (if you copy the same text twice it scrubs), which is a nice feature:</p>
<p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2015391e13c59970b-pi" target="_blank"><img alt="ClipboardFusion Text Scrubbing" border="0" height="287" src="/assets/image_326985.jpg" style="background-image: none; margin: 20px auto; padding-left: 0px; padding-right: 0px; display: block; float: none; padding-top: 0px; border-width: 0px;" title="ClipboardFusion Text Scrubbing" width="408" /></a></p>
<p>Then, when a scrub occurs, you will get notified via a balloon (unless you prefer to opt for a sound being played, etc.):</p>
<p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2015391e13c6d970b-pi" target="_blank"><img alt="Scrubbing notification" border="0" height="69" src="/assets/image_560323.jpg" style="background-image: none; margin: 20px auto; padding-left: 0px; padding-right: 0px; display: block; float: none; padding-top: 0px; border-width: 0px;" title="Scrubbing notification" width="159" /></a></p>
<h3>3. Use ReSharper in Visual Studio</h3>
<p><em>Thanks to Kerry Brown for </em><a href="http://through-the-interface.typepad.com/through_the_interface/2011/09/an-update-to-minesweeper-for-autocad.html#comment-6a00d83452464869e2015391d38285970b" target="_blank"><em>this suggestion</em></a><em>.</em></p>
<p><a href="http://www.jetbrains.com/resharper/" target="_blank">ReSharper</a> from JetBrains is a productivity tool for Visual Studio that – among other things – helps with formatting and refactoring code you copy from the web. This is <a href="http://www.jetbrains.com/resharper/buy/index.jsp" target="_blank">not a free option</a> – outside the 30-day evaluation period – so do be aware of that.</p>
<p>One possible advantage of using ReSharper is its ability to apply various rules when reformatting your code – pretty handy if you have (for instance) a standard column width of &gt;70 (I use 70 characters per line to get code to fit my blog). You can also set up and deploy such standards acorss your programming team fairly easily, from what I can tell.</p>
<p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2014e8bd4fb1f970d-pi" target="_blank"><img alt="Uncheck &#39;keep existing line breaks&#39;" border="0" height="359" src="/assets/image_667788.jpg" style="background-image: none; margin: 20px auto; padding-left: 0px; padding-right: 0px; display: block; float: none; padding-top: 0px; border-width: 0px;" title="Uncheck &#39;keep existing line breaks&#39;" width="420" /></a></p>
<p>You can then run ReSharper –&gt; Tools –&gt; Cleanup code… (with a custom profile just specifying you want to reformat, should you wish) and your code will get reformatted.</p>
<p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2014e8bd4fb2b970d-pi" target="_blank"><img alt="Run Code Cleanup with custom profile" border="0" height="352" src="/assets/image_533715.jpg" style="background-image: none; margin: 20px auto; padding-left: 0px; padding-right: 0px; display: block; float: none; padding-top: 0px; border-width: 0px;" title="Run Code Cleanup with custom profile" width="412" /></a></p>
<p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2014e8bd4fb3d970d-pi" target="_blank"><img alt="The results of ReSharper&#39;s code cleanup" border="0" height="349" src="/assets/image_184570.jpg" style="background-image: none; margin: 20px auto; padding-left: 0px; padding-right: 0px; display: block; float: none; padding-top: 0px; border-width: 0px;" title="The results of ReSharper&#39;s code cleanup" width="408" /></a></p>
<h3>Conclusion</h3>
<p>Any of these three options seem valid, depending on your preference: Chrome is a straightforward option, but may mean browsing with another tool. ClipboardFusion is handy, but means some installation (and the need to live with the risk of it scrubbing your clipboard when you’d rather it didn’t). ReSharper gives you a lot of power to impose standards upon your code (and code you find from elsewhere), but will take time to set up, and doesn’t come for free.</p>
<p>I assume there are other options out there… if you have one to suggest, please post a comment!</p>
<p>Incidentally, I&#39;m going to be on vacation in Egypt&#0160;for the next two weeks. I&#39;ve queued up a few posts to keep things moving, while I&#39;m away, but please don&#39;t expect me to respond promptly to comments (despite me having asked people to post comments in this very post). I&#39;ll do my best to catch up quickly on my return.</p>
