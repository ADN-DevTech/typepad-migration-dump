---
layout: "post"
title: "Integrating web-based VR samples into a native Google Cardboard app using the Cardboard SDK for Android"
date: "2015-01-28 17:29:00"
author: "Kean Walmsley"
categories:
  - "Android"
  - "Autodesk"
  - "PaaS"
  - "Virtual Reality"
original_url: "https://www.keanw.com/2015/01/integrating-web-based-vr-samples-into-a-native-google-cardboard-app-using-the-cardboard-sdk-for-android.html "
typepad_basename: "integrating-web-based-vr-samples-into-a-native-google-cardboard-app-using-the-cardboard-sdk-for-android"
typepad_status: "Publish"
---

<p>I mentioned this in <a href="http://through-the-interface.typepad.com/through_the_interface/2015/01/hololens-for-cad.html" target="_blank">last Friday’s post</a>: after <a href="http://through-the-interface.typepad.com/through_the_interface/2015/01/building-a-gear-vr-app-using-the-oculus-mobile-sdk.html" target="_blank">building an Android app</a> to bring <a href="http://safe-reef-1847.herokuapp.com/stereo-gear.html" target="_blank">our web-based VR samples</a> to <a href="http://through-the-interface.typepad.com/through_the_interface/2015/01/a360-viewer-samsung-gear-vr.html" target="_blank">Gear VR</a>, it made sense to do the same for Google Cardboard. It made sense for 3 reasons:</p>  <ol>   <li>Most importantly, I wanted to see what the additional capabilities of the Android SDK would bring to the web-based VR samples, particularly around the magnetic trigger button. </li>    <li>Until the Note 4 gets its Lollipop update in “early 2015” – and WebViews support WebGL – there isn’t much more to do with Gear VR. I’ve completed the plumbing but am waiting for the toilet to arrive. OK, bad analogy. :-) My Nexus 4, on the other hand, is running Android Lollipop, so at least that’s one way to see how the web samples work when loaded inside a WebView. </li>    <li>The supported development environment for Google Cardboard, these days, is <a href="http://developer.android.com/tools/studio" target="_blank">Android Studio</a>. After wrestling with Eclipse to get my Gear VR built using the Oculus Mobile SDK, I was keen to give Android Studio a try. </li> </ol>  <p>The <a href="https://developers.google.com/cardboard/android/download" target="_blank">Cardboard SDK for Android</a> is really easy to include in your Android Studio project. I started by cloning <a href="https://github.com/googlesamples/cardboard-java" target="_blank">the primary sample from GitHub</a> and imported that into Android Studio. Once I had it working on my device, I <a href="https://developers.google.com/cardboard/android/get-started" target="_blank">created a project from scratch</a>, added the libs and copied across big chunks of the main activity.</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201bb07e3a19d970d-pi" target="_blank"><img alt="Android Studio - a breath of fresh air after Eclipse" border="0" height="314" src="/assets/image_289619.jpg" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; float: none; padding-top: 0px; padding-left: 0px; margin: 20px auto; display: block; padding-right: 0px; border-top-width: 0px" title="Android Studio - a breath of fresh air after Eclipse" width="470" /></a></p>  <p>As we’re doing the stereo rendering of the model via an embedded web-page, we’re primarily using the Cardboard SDK for information on when the magnetic trigger on the side of the device gets pulled (something that we couldn’t get from HTML).</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201bb07e3ae5e970d-pi" target="_blank"><img alt="Google Cardboard and its single button" border="0" height="264" src="/assets/image_783202.jpg" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; float: none; padding-top: 0px; padding-left: 0px; margin: 20px auto; display: block; padding-right: 0px; border-top-width: 0px" title="Google Cardboard and its single button" width="394" /></a></p>  <p>It would have been great to have had information regarding the speed or duration of the pull: you really only get told that it was pulled. But that’s fair enough… in the below Java file we make do with what we have by implementing some basic “double-click” logic:</p> <script src="https://gist.github.com/KeanW/9783554b172e47786576.js" type="text/javascript"></script>  <p>Beyond that we need to make sure the <em>AndroidManifest.xml</em> had the appropriate entries…</p>  <div style="font-size: 8pt; font-family: courier new; background: white; color: black; line-height: 140%">   <p style="margin: 0px"><span style="color: blue">&lt;?</span><span style="color: #a31515">xml</span><span style="color: red">version</span><span style="color: blue">=</span>&quot;<span style="color: blue">1.0</span>&quot;<span style="color: red">encoding</span><span style="color: blue">=</span>&quot;<span style="color: blue">utf-8</span>&quot;<span style="color: blue">?&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&lt;</span><span style="color: #a31515">manifest</span><span style="color: red">xmlns:android</span><span style="color: blue">=</span>&quot;<span style="color: blue">http://schemas.android.com/apk/res/android</span>&quot;</p>    <p style="margin: 0px"><span style="color: blue">&#0160;&#0160;&#0160; </span><span style="color: red">package</span><span style="color: blue">=</span>&quot;<span style="color: blue">com.autodesk.a360cardboard</span>&quot;<span style="color: blue">&gt;</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="color: blue">&#0160; &lt;</span><span style="color: #a31515">uses-permission</span><span style="color: red">android:name</span><span style="color: blue">=</span>&quot;<span style="color: blue">android.permission.CAMERA</span>&quot;<span style="color: blue">/&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&#0160; &lt;</span><span style="color: #a31515">uses-permission</span><span style="color: red">android:name</span><span style="color: blue">=</span>&quot;<span style="color: blue">android.permission.NFC</span>&quot;<span style="color: blue">/&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&#0160; &lt;</span><span style="color: #a31515">uses-permission</span><span style="color: red">android:name</span><span style="color: blue">=</span>&quot;<span style="color: blue">android.permission.VIBRATE</span>&quot;<span style="color: blue">/&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&#0160; &lt;</span><span style="color: #a31515">uses-permission</span><span style="color: red">android:name</span><span style="color: blue">=</span>&quot;<span style="color: blue">android.permission.INTERNET</span>&quot;<span style="color: blue">/&gt;</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="color: blue">&#0160; &lt;</span><span style="color: #a31515">application</span></p>    <p style="margin: 0px"><span style="color: blue">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: red">android:allowBackup</span><span style="color: blue">=</span>&quot;<span style="color: blue">true</span>&quot;</p>    <p style="margin: 0px"><span style="color: blue">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: red">android:icon</span><span style="color: blue">=</span>&quot;<span style="color: blue">@drawable/ic_launcher</span>&quot;</p>    <p style="margin: 0px"><span style="color: blue">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: red">android:label</span><span style="color: blue">=</span>&quot;<span style="color: blue">@string/app_name</span>&quot;</p>    <p style="margin: 0px"><span style="color: blue">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: red">android:theme</span><span style="color: blue">=</span>&quot;<span style="color: blue">@style/AppTheme</span>&quot;<span style="color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&#0160;&#0160;&#0160; &lt;</span><span style="color: #a31515">activity</span></p>    <p style="margin: 0px"><span style="color: blue">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: red">android:name</span><span style="color: blue">=</span>&quot;<span style="color: blue">.MainActivity</span>&quot;</p>    <p style="margin: 0px"><span style="color: blue">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: red">android:label</span><span style="color: blue">=</span>&quot;<span style="color: blue">@string/app_name</span>&quot;</p>    <p style="margin: 0px"><span style="color: blue">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: red">android:launchMode</span><span style="color: blue">=</span>&quot;<span style="color: blue">singleTask</span>&quot;</p>    <p style="margin: 0px"><span style="color: blue">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: red">android:screenOrientation</span><span style="color: blue">=</span>&quot;<span style="color: blue">landscape</span>&quot;</p>    <p style="margin: 0px"><span style="color: blue">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: red">android:configChanges</span><span style="color: blue">=</span>&quot;<span style="color: blue">orientation|keyboardHidden|keyboard</span>&quot;<span style="color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&#0160;&#0160;&#0160;&#0160;&#0160; &lt;</span><span style="color: #a31515">intent-filter</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &lt;</span><span style="color: #a31515">action</span><span style="color: red">android:name</span><span style="color: blue">=</span>&quot;<span style="color: blue">android.intent.action.MAIN</span>&quot;<span style="color: blue"> /&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &lt;</span><span style="color: #a31515">category</span><span style="color: red">android:name</span><span style="color: blue">=</span>&quot;<span style="color: blue">android.intent.category.LAUNCHER</span>&quot;<span style="color: blue">/&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &lt;</span><span style="color: #a31515">category</span></p>    <p style="margin: 0px"><span style="color: blue">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: red">android:name</span><span style="color: blue">=</span>&quot;<span style="color: blue">com.google.intent.category.CARDBOARD</span>&quot;<span style="color: blue">/&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&#0160;&#0160;&#0160;&#0160;&#0160; &lt;/</span><span style="color: #a31515">intent-filter</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&#0160;&#0160;&#0160;&#0160;&#0160; &lt;</span><span style="color: #a31515">intent-filter</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &lt;</span><span style="color: #a31515">action</span><span style="color: red">android:name</span><span style="color: blue">=</span>&quot;<span style="color: blue">android.nfc.action.NDEF_DISCOVERED</span>&quot;<span style="color: blue">/&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &lt;</span><span style="color: #a31515">category</span><span style="color: red">android:name</span><span style="color: blue">=</span>&quot;<span style="color: blue">android.intent.category.DEFAULT</span>&quot;<span style="color: blue">/&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &lt;</span><span style="color: #a31515">data</span></p>    <p style="margin: 0px"><span style="color: blue">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: red">android:mimeType</span><span style="color: blue">=</span>&quot;<span style="color: blue">application/com.autodesk.a360cardboard</span>&quot;<span style="color: blue">/&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&#0160;&#0160;&#0160;&#0160;&#0160; &lt;/</span><span style="color: #a31515">intent-filter</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&#0160;&#0160;&#0160; &lt;/</span><span style="color: #a31515">activity</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&#0160; &lt;/</span><span style="color: #a31515">application</span><span style="color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="color: blue">&lt;/</span><span style="color: #a31515">manifest</span><span style="color: blue">&gt;</span></p> </div>  <p>The interface itself is fairly rudimentary: it uses the same HTML/JavaScript as the Gear VR sample, but advances the selection when a single pull on the magnetic trigger is detected. If a double-pull is detected, the selected model is opened. A trigger-pull from within the model will go back to the main list by reloading the page… to get the selection in the list back to what it was we send the number of “down” clicks we’ve counted since the app was loaded and pass that through. The JavaScript does a modulo remainder to determine the item to select. A little crude, but this avoids us having the JavaScript need to call back into our Java code.</p>  <p>   <br /><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201b7c73fea5e970b-pi" target="_blank"><img alt="The menu" height="282" src="/assets/image_237650.jpg" style="display: inline" title="The menu" width="470" /></a>    <br />    <br /></p>  <p>Overall it works pretty well. The performance of the embedded WebView seems as good as with the web-based samples in Chrome for Android: they’ve done a good job of making sure the container itself doesn’t add overhead. Plus you get the benefits of being properly full-screen – without the need for some user input, as you have in HTML – and the “always on” is managed for you: no need to go and make sure your screen doesn’t turn off after 30 seconds (my Nexus has it set to 30 minutes, these days, which is good for VR but less good for normal usage).</p>  <p>The double-click takes a bit of practice to get right: at the beginning you single-click twice quite a bit, which means you have to loop back round to select the model you wanted (which is irritating). But it’s fairly useable, given the limited input options we have available.</p>  <p>Speaking of input options: I spent some time trying to work out how to enable speech recognition inside a WebView. This *should* be possible with Lollipop, as you can now pre-grant permissions for loaded web-pages as long as the app itself has compatible permissions granted by the user, but <a href="https://github.com/googlesamples/android-PermissionRequest/issues/1" target="_blank">I wasn’t able to get it working</a>. This is still at the bleeding edge, so I’m hopeful that will be enabled, at some point.</p>  <p>Next time we’re going to talk a little about NFC, and see how that can be used effectively with Google Cardboard to launch our custom Android app.</p>  <p><span style="color: #a5a5a5">photo credit: </span><a href="https://www.flickr.com/photos/othree/14356099558/"><span style="color: #a5a5a5">othree</span></a><span style="color: #a5a5a5"> via </span><a href="http://photopin.com"><span style="color: #a5a5a5">photopin</span></a><a href="http://creativecommons.org/licenses/by/2.0/"><span style="color: #a5a5a5">cc</span></a></p>
