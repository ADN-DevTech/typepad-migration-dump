---
layout: "post"
title: "No source available when debugging an AutoCAD plug-in"
date: "2011-09-22 13:42:06"
author: "Kean Walmsley"
categories:
  - "AU"
  - "AutoCAD"
  - "AutoCAD .NET"
  - "Debugging"
  - "Kinect"
  - "Visual Studio"
  - "WPF"
original_url: "https://www.keanw.com/2011/09/no-source-available-when-debugging-an-autocad-plug-in.html "
typepad_basename: "no-source-available-when-debugging-an-autocad-plug-in"
typepad_status: "Publish"
---

<p>Given the fact <a href="http://au.autodesk.com/" target="_blank">AU 2011</a> is quickly approaching, I decided it was time to dust off my Kinect-related code and getting it working with <a href="http://research.microsoft.com/en-us/um/redmond/projects/kinectsdk/default.aspx" target="_blank">the Beta SDK from Microsoft Research</a>. Part of the reason I haven’t been able to do this sooner is that my primary work machine is currently a MacBook Pro running Windows 7 via Parallels, and <a href="http://social.msdn.microsoft.com/Forums/en-US/kinectsdk/thread/86528a22-0643-4a1f-819f-8125d7668a68/" target="_blank">the Microsoft Kinect driver currently does not support working inside a Virtual Machine</a>.</p>  <p>I did start to try to get my previous implementation using <a href="http://www.openni.org/" target="_blank">OpenNI</a> + NITE to work on this system, but as it uses the <a href="http://nkinect.codeplex.com/" target="_blank">nKinect</a> component that is currently (and will probably remain) dependent on the 32-bit versions of the OpenNI/NITE SDKs, I couldn’t easily get that working with my 64-bit AutoCAD 2012 installation. Ho hum.</p>  <p>Anyway, thankfully our IT department came to the rescue and loaned me an old system, re-built with 32-bit Windows 7, so that I should now be in a position to demonstrate integrations using both the OpenNI and Microsoft SDKs inside AutoCAD during my Kinect-related session at AU. Which also means I’ll be carrying two machines with me to Las Vegas, but so it goes.</p>  <p>I now have a basic implementation using the Microsoft Kinect SDK working inside AutoCAD, but it’s not generating the point cloud as I’d expect it to. Which means I need to debug it. Unfortunately, the breakpoints I’ve set in my jig – while they appear to get hit while executing my command inside AutoCAD – do not lead to source code being displayed inside VS 2010:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e2014e8bbeb57e970d-pi" target="_blank"><img style="background-image: none; border-right-width: 0px; margin: 20px auto; padding-left: 0px; padding-right: 0px; display: block; float: none; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="No source available" border="0" alt="No source available" src="/assets/image_597783.jpg" width="394" height="230" /></a></p>  <p>[To help people find this post via a search engine, here the text in the dialog: “No Source Available. No symbols are loaded for any call stack frame. The source code cannot be displayed.”]</p>  <p>It took me some time to work out how to resolve this. I searched on the web and found a number of suggestions that I hoped would help:</p>  <ul>   <li>Enable “Just My Code” in the Debugging options </li>    <li>Disable “Require source files to exactly match the original version”, too </li>    <li>Set “Automatically load symbols for all modules” </li>    <li>Clear the symbol cache </li>    <li>Launched the debug session with my left hand, while crossing fingers on my right hand and whistling the Imperial March from Star Wars </li> </ul>  <p>[In case you’re wondering, the last approach didn’t seem to have any less effect than any of the others: the source was still not found. :-( :-) ]</p>  <p>Then, feeling somewhat foolish, I remembered the most likely source of the problem.</p>  <p>AutoCAD <a href="http://through-the-interface.typepad.com/through_the_interface/2006/10/some_background.html" target="_blank">still uses fibers</a>, which can cause a problem when debugging. I’ve known about this issue for some time, but had worked around the problem on my main system, and so no longer his the debugging issue.</p>  <p>The workaround is to set the NEXTFIBERWORLD system variable to 0, and then restart AutoCAD. You can check the current value of FIBERWORLD, to see what it is prior to doing so, of course:</p>    <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%">Command: <font color="#ff0000">FIBERWORLD</font></span></p>    <p style="margin: 0px"><span style="line-height: 140%">FIBERWORLD = 1 (read only)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">Command: <font color="#ff0000">NEXTFIBERWORLD</font></span></p>    <p style="margin: 0px"><span style="line-height: 140%">Enter new value for NEXTFIBERWORLD &lt;1&gt;: 0</span></p>    <p style="margin: 0px"><span style="line-height: 140%">Command: <font color="#ff0000">QUIT</font></span></p> </div>    <p>You have to restart for FIBERWORLD to be updated, as switching fiberless operation on or off is not something that can be done on-the-fly.</p>  <p>Now this approach is really something that you should enable and use sparingly: while we expect to make AutoCAD work perfectly without fibers, at some point, this is currently an unsupported mode of operation and can cause problems with WPF, in particular. In fact, one major issue I had on my system (one I only just realised was related to this) was that my ribbon would simply not work: while I could switch ribbon tabs and even successfully use ribbon customizations such as <a href="http://through-the-interface.typepad.com/through_the_interface/2011/07/automatic-translation-of-autocad-tooltips-using-net.html" target="_blank">TransTips</a> and <a href="http://through-the-interface.typepad.com/through_the_interface/2011/09/adding-an-expanding-textbox-to-autocads-ribbon-using-net.html" target="_blank">the expanding textbox control</a>, the actual commands selected from the ribbon were not getting executed. A problem which went away when setting NEXTFIBERWORLD back to 1 and restarting.</p>  <p>For ADN members interested in a bit more background on this topic, see <a href="http://adn.autodesk.com/adn/servlet/devnote?siteID=4814862&amp;id=16637351&amp;linkID=4900524" target="_blank">this DevNote</a> and an article in <a href="http://adn.autodesk.com/adn/servlet/item?siteID=4814862&amp;id=15529308" target="_blank">this newsletter edition</a>.</p>  <p>Right – now that I can at least see what’s happening in my code, I’d better go fix it and get it ready for posting. :-)</p>
