---
layout: "post"
title: "Implementing task dialogs inside AutoCAD using .NET - Part 2"
date: "2008-11-14 06:10:00"
author: "Kean Walmsley"
categories:
  - "AutoCAD"
  - "AutoCAD .NET"
  - "Notification / Events"
  - "User interface"
original_url: "https://www.keanw.com/2008/11/implementing--1.html "
typepad_basename: "implementing--1"
typepad_status: "Publish"
---

<p>In <a href="http://through-the-interface.typepad.com/through_the_interface/2008/11/implementing-ta.html">this previous post</a> we looked at a basic task dialog inside AutoCAD and exercised its various capabilities without showing how they might be used in a real application. This post goes beyond that to show how you might make use of the TaskDialog class to provide your users with relevant information at runtime that helps them decide how best to proceed in certain situations, effectively increasing your application&#39;s usability.</p>
<p>The specific scenario is this: if the user selects a lot of entities - too many for our command to handle quickly - we want to show a dialog that allows the user to decide whether to proceed anyway, to select fewer entities or to cancel completely from the command. For the sake of argument we&#39;re going to set a threshold of 1,000 entities being &quot;a lot&quot;, although it may well be that for your various operations 100 or 100,000 is a better number).</p>
<p>Here&#39;s some C# code that asks the user to select entities and then either performs an operation on them or presents a number of options to the user:</p>
<div style="FONT-FAMILY: courier new; BACKGROUND: white; COLOR: black; FONT-SIZE: 8pt">
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%; COLOR: blue">using</span><span style="LINE-HEIGHT: 140%"> Autodesk.AutoCAD.ApplicationServices;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%; COLOR: blue">using</span><span style="LINE-HEIGHT: 140%"> Autodesk.AutoCAD.EditorInput;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%; COLOR: blue">using</span><span style="LINE-HEIGHT: 140%"> Autodesk.AutoCAD.Runtime;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%; COLOR: blue">using</span><span style="LINE-HEIGHT: 140%"> Autodesk.Windows;</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%; COLOR: blue">namespace</span><span style="LINE-HEIGHT: 140%"> TaskDialogs</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">{</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">public</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">class</span><span style="LINE-HEIGHT: 140%"> </span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">Commands</span></span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; {</span></p><span style="LINE-HEIGHT: 140%">
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: green">// In a real application we would retrieve this</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: green">// persistent setting from somewhere</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">static bool</span><span style="LINE-HEIGHT: 140%"> neveragain = </span><span style="LINE-HEIGHT: 140%; COLOR: blue">false</span><span style="LINE-HEIGHT: 140%">;</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt">&#0160; &#0160; <span style="LINE-HEIGHT: 140%; COLOR: blue">enum</span><span style="LINE-HEIGHT: 140%"> </span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">DecisionOptions</span></span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;DoOperation,</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;Reselect,</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;Cancel</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; };</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; [</span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">CommandMethod</span></span><span style="LINE-HEIGHT: 140%">(</span><span style="COLOR: #a31515"><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;Task2&quot;</span></span><span style="LINE-HEIGHT: 140%">)]</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">public</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">static</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">void</span><span style="LINE-HEIGHT: 140%"> MoreRealisticTask()</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;</span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">Editor</span></span><span style="LINE-HEIGHT: 140%"> ed =</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">Application</span></span><span style="LINE-HEIGHT: 140%">.DocumentManager.MdiActiveDocument.Editor;</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;</span><span style="LINE-HEIGHT: 140%; COLOR: blue">bool</span><span style="LINE-HEIGHT: 140%"> done = </span><span style="LINE-HEIGHT: 140%; COLOR: blue">false</span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"> </p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;</span><span style="LINE-HEIGHT: 140%; COLOR: blue">while</span><span style="LINE-HEIGHT: 140%"> (!done)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;{</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">PromptSelectionResult</span></span><span style="LINE-HEIGHT: 140%"> psr = ed.GetSelection();</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> (psr.Status != </span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">PromptStatus</span></span><span style="LINE-HEIGHT: 140%">.OK)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; done = </span><span style="LINE-HEIGHT: 140%; COLOR: blue">true</span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">else</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">DecisionOptions</span></span><span style="LINE-HEIGHT: 140%"> decision = </span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">DecisionOptions</span></span><span style="LINE-HEIGHT: 140%">.DoOperation;</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> (psr.Value.Count &gt; 1000 &amp;&amp; !neveragain)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;</span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">TaskDialog</span></span><span style="LINE-HEIGHT: 140%"> td = </span><span style="LINE-HEIGHT: 140%; COLOR: blue">new</span><span style="LINE-HEIGHT: 140%"> </span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">TaskDialog</span></span><span style="LINE-HEIGHT: 140%">();</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;td.Width = 200;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;td.WindowTitle =</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="COLOR: #a31515"><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;Many objects selected&quot;</span></span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;td.MainInstruction =</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; psr.Value.Count.ToString() +</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="COLOR: #a31515"><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot; objects have been selected, &quot;</span></span><span style="LINE-HEIGHT: 140%"> +</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="COLOR: #a31515"><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;which may lead to a time-consuming operation.&quot;</span></span><span style="LINE-HEIGHT: 140%">;</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;td.UseCommandLinks = </span><span style="LINE-HEIGHT: 140%; COLOR: blue">true</span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;td.Buttons.Add(</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">new</span><span style="LINE-HEIGHT: 140%"> </span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">TaskDialogButton</span></span><span style="LINE-HEIGHT: 140%">(</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; 0,</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="COLOR: #a31515"><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;Perform the operation on the selected objects.&quot;</span></span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; )</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;td.Buttons.Add(</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">new</span><span style="LINE-HEIGHT: 140%"> </span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">TaskDialogButton</span></span><span style="LINE-HEIGHT: 140%">(</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; 1,</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="COLOR: #a31515"><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;Reselect objects to edit&quot;</span></span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; )</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;td.Buttons.Add(</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">new</span><span style="LINE-HEIGHT: 140%"> </span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">TaskDialogButton</span></span><span style="LINE-HEIGHT: 140%">(</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; 2,</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="COLOR: #a31515"><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;Do nothing and cancel the command&quot;</span></span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; )</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;);</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;td.VerificationText =</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="COLOR: #a31515"><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;Do not ask me this again&quot;</span></span><span style="LINE-HEIGHT: 140%">;</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;td.Callback =</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">delegate</span><span style="LINE-HEIGHT: 140%">(</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">ActiveTaskDialog</span></span><span style="LINE-HEIGHT: 140%"> atd,</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">TaskDialogEventArgs</span></span><span style="LINE-HEIGHT: 140%"> e,</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">object</span><span style="LINE-HEIGHT: 140%"> sender</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; )</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> (e.Notification ==</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">TaskDialogNotification</span></span><span style="LINE-HEIGHT: 140%">.ButtonClicked)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;</span><span style="LINE-HEIGHT: 140%; COLOR: blue">switch</span><span style="LINE-HEIGHT: 140%"> (e.ButtonId)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;{</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">case</span><span style="LINE-HEIGHT: 140%"> 0:</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; decision = </span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">DecisionOptions</span></span><span style="LINE-HEIGHT: 140%">.DoOperation;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">break</span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">case</span><span style="LINE-HEIGHT: 140%"> 1:</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; decision = </span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">DecisionOptions</span></span><span style="LINE-HEIGHT: 140%">.Reselect;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">break</span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">case</span><span style="LINE-HEIGHT: 140%"> 2:</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; decision = </span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">DecisionOptions</span></span><span style="LINE-HEIGHT: 140%">.Cancel;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">break</span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;}</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">if</span><span style="LINE-HEIGHT: 140%"> (e.Notification ==</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">TaskDialogNotification</span></span><span style="LINE-HEIGHT: 140%">.VerificationClicked)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;neveragain = </span><span style="LINE-HEIGHT: 140%; COLOR: blue">true</span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">return</span><span style="LINE-HEIGHT: 140%"> </span><span style="LINE-HEIGHT: 140%; COLOR: blue">false</span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; };</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;td.Show(</span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">Application</span></span><span style="LINE-HEIGHT: 140%">.MainWindow.Handle);</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">switch</span><span style="LINE-HEIGHT: 140%"> (decision)</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; {</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;</span><span style="LINE-HEIGHT: 140%; COLOR: blue">case</span><span style="LINE-HEIGHT: 140%"> </span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">DecisionOptions</span></span><span style="LINE-HEIGHT: 140%">.DoOperation:</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: green">// Perform the operation anyway...</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; ed.WriteMessage(</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="COLOR: #a31515"><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;\nThis is where we do something &quot;</span></span><span style="LINE-HEIGHT: 140%"> +</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; </span><span style="COLOR: #a31515"><span style="LINE-HEIGHT: 140%; COLOR: #a31515">&quot;with our {0} entities.&quot;</span></span><span style="LINE-HEIGHT: 140%">,</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; psr.Value.Count</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; );</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; done = </span><span style="LINE-HEIGHT: 140%; COLOR: blue">true</span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">break</span><span style="LINE-HEIGHT: 140%">;</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;</span><span style="LINE-HEIGHT: 140%; COLOR: blue">case</span><span style="LINE-HEIGHT: 140%"> </span><span style="COLOR: #2b91af"><span style="LINE-HEIGHT: 140%; COLOR: #2b91af">DecisionOptions</span></span><span style="LINE-HEIGHT: 140%">.Reselect:</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; done = </span><span style="LINE-HEIGHT: 140%; COLOR: blue">false</span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">break</span><span style="LINE-HEIGHT: 140%">;</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;</span><span style="LINE-HEIGHT: 140%; COLOR: green">// Includes DecisionOptions.Cancel...</span></p><br />
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;</span><span style="LINE-HEIGHT: 140%; COLOR: blue">default</span><span style="LINE-HEIGHT: 140%">:</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; done = </span><span style="LINE-HEIGHT: 140%; COLOR: blue">true</span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; &#0160;&#0160; </span><span style="LINE-HEIGHT: 140%; COLOR: blue">break</span><span style="LINE-HEIGHT: 140%">;</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; &#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;}</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;</span><span style="LINE-HEIGHT: 140%; COLOR: green">// This is where we would store the value of neveragain</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160;&#0160; &#0160;</span><span style="LINE-HEIGHT: 140%; COLOR: green">// in our persistent application settings</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; &#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">&#0160; }</span></p>
<p style="MARGIN: 0px; FONT-SIZE: 8pt"><span style="LINE-HEIGHT: 140%">}</span></p></span></div>
<p>Here&#39;s what happens when we run the TASK2 command and select 2,500 entities:</p>
<p><a href="http://through-the-interface.typepad.com/through_the_interface/WindowsLiveWriter/A%20real-world%20task%20dialog%20example.png"><img alt="A real-world task dialog example" border="0" height="293" src="/assets/A%20real-world%20task%20dialog%20example_thumb.png" style="BORDER-RIGHT-WIDTH: 0px; BORDER-TOP-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px" width="420" /></a> </p>
<p>The behaviour should be pretty predictable - you can reselect again and again, until you either:</p>
<ul>
<li>Go ahead and perform the operation (action 1) </li>
<li>Reselect fewer than the threshold of 1000 entities (action 2) </li>
<li>Give up and cancel the command (action 3) </li>
<li>Decide not to be asked the question again (the checkbox at the bottom)</li>
</ul>
<p>If you select the checkbox and reselect (action 2), for instance, you won&#39;t then be asked the question again during that session, even if you go ahead and select 100,000 entities. One thing the application doesn&#39;t do is to save the value of this setting - you would need to store it somewhere in your application settings (probably in the Registry or a configuration file of some kind), and ideally provide the user with some ability to re-enable the task dialog, should they decide it&#39;s a good idea to have it, after all.</p>
<p><strong><em>Update</em></strong></p>
<p>In AutoCAD 2010 the TaskDialogEventArgs class was renamed to TaskDialogCallbackArgs, apparently&#0160;to be more consistent with .NET naming conventions. If you receive an error such as &quot;<em>The type or namespace name &#39;TaskDialogEventArgs&#39; could not be found (are you missing a using directive or an assembly reference?)</em>&quot; when building your application, updating the name to be TaskDialogCallbackArgs will resolve it.</p>
