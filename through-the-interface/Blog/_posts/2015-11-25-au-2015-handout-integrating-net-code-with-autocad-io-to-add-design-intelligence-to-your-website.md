---
layout: "post"
title: "AU 2015 handout: Integrating .NET Code with AutoCAD I/O to Add Design Intelligence to Your Website"
date: "2015-11-25 11:38:31"
author: "Kean Walmsley"
categories:
  - "AU"
  - "AutoCAD I/O"
  - "HTML"
  - "JavaScript"
  - "PaaS"
  - "Web/Tech"
original_url: "https://www.keanw.com/2015/11/au-2015-handout-integrating-net-code-with-autocad-io-to-add-design-intelligence-to-your-website.html "
typepad_basename: "au-2015-handout-integrating-net-code-with-autocad-io-to-add-design-intelligence-to-your-website"
typepad_status: "Publish"
---

<p><em>With the clock ticking before next week’s AU 2015, here’s the second of my class handouts (here’s </em><a href="http://through-the-interface.typepad.com/through_the_interface/2015/11/au-2015-handout-virtual-reality-viewing-of-3d-models-using-autodesks-view-and-data-api.html" target="_blank"><em>a link to the first</em></a><em>). For those of you lucky enough to be heading to this year’s event, see you in Vegas!</em></p>  <p>&#160;</p>  <p><b>Introduction</b></p>  <p>During the course of this session, we’re going to look at the steps required to implement a web-site for turning pictures into jigsaw puzzles. We’re not going to go quite as far as creating the puzzles, themselves, but rather the DWG or DWF files that can be used to drive a laser cutter to do the work.</p>  <p>The premise for the application is the following: laser cutters are very good at cutting, but engraving can be very time-consuming, especially for larger projects. It can also be quite complicated to upload images for engraving and have them fit a cutting layer – there’s quite a lot of manual effort needed to get the positioning right.</p>  <p>Our site – <a href="http://jigsawify.com">Jigsawify.com</a> – takes a different approach. It performs edge detection (a common Computer Vision algorithm) on the chosen image, extracting the vectors (although in our case these will be encoded as pixels) and adds them on a separate cutting layer to the output file. The code will also create the outline for the puzzle itself, of course, which will be randomly generated based on the specified dimensions and number of pieces.</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201b8d17ae01f970c-pi" target="_blank"><img title="Jigsawify.com" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; float: none; padding-top: 0px; padding-left: 0px; margin: 50px auto; display: block; padding-right: 0px; border-top-width: 0px" border="0" alt="Jigsawify.com" src="/assets/image_585915.jpg" width="373" height="334" /></a></p>  <p>Now, though, it’s time to introduce AutoCAD I/O…</p>  <p><b>Getting Started with AutoCAD I/O</b></p>  <p>The first destination on your journey with AutoCAD I/O is the Autodesk developer portal. It’s from here that you’ll register your application and get hold of the credentials you’ll need to authenticate against and call the AutoCAD I/O web-service.</p>  <p><a href="http://developer.autodesk.com">http://developer.autodesk.com</a></p>  <p>Once you’ve registered and signed in, you’ll be able to create your first app via the <i>My Apps</i> tab.</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201b7c7f1276b970b-pi" target="_blank"><img title="There&#39;s a first time for everything" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; float: none; padding-top: 0px; padding-left: 0px; margin: 50px auto; display: block; padding-right: 0px; border-top-width: 0px" border="0" alt="There&#39;s a first time for everything" src="/assets/image_888695.jpg" width="422" height="333" /></a></p>  <p>Selecting <i>Create An App</i> will take you to a page where you can enter information regarding your app.</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201b7c7f1276f970b-pi" target="_blank"><img title="Choose your API and name your App" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; float: none; padding-top: 0px; padding-left: 0px; margin: 50px auto; display: block; padding-right: 0px; border-top-width: 0px" border="0" alt="Choose your API and name your App" src="/assets/image_707396.jpg" width="422" height="333" /></a></p>  <p>You need to select AutoCAD I/O API and enter a unique app name and a description.</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201b7c7f12777970b-pi" target="_blank"><img title="We&#39;&#39;ll choose AutoCAD I/O" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; float: none; padding-top: 0px; padding-left: 0px; margin: 50px auto; display: block; padding-right: 0px; border-top-width: 0px" border="0" alt="We&#39;&#39;ll choose AutoCAD I/O" src="/assets/image_898040.jpg" width="422" height="333" /></a></p>  <p>After which you specify a callback URL and an optional URL for your website. If you don’t currently have a URL to enter for these, don’t worry: it’s something you can edit afterwards, in case.</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201b7c7f1277b970b-pi" target="_blank"><img title="More data is requested" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; float: none; padding-top: 0px; padding-left: 0px; margin: 50px auto; display: block; padding-right: 0px; border-top-width: 0px" border="0" alt="More data is requested" src="/assets/image_680775.jpg" width="422" height="333" /></a></p>  <p>When you hit <i>Create App</i>, you’ll get access to your Consumer Key and Secret.</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201bb089544fa970d-pi" target="_blank"><img title="Our App is created" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; float: none; padding-top: 0px; padding-left: 0px; margin: 50px auto; display: block; padding-right: 0px; border-top-width: 0px" border="0" alt="Our App is created" src="/assets/image_554627.jpg" width="422" height="333" /></a></p>  <p>It’s this information that needs to be placed in your custom application for it to be able to access the AutoCAD I/O service.</p>  <p>At this stage it’s worth talking a bit about the need for care with these credentials: if someone uses them to access AutoCAD I/O – or another Autodesk web service – then any costs incurred (whether against a free quota or actually costing real money) will be from your account. It’s therefore very important not to embed this information in any module that gets shipped to your customers: we will certainly use these credentials when administering our AutoCAD I/O activities, for instance, but only from a local .NET application. At no point should that application be distributed externally.</p>  <p>The typical way to manage this is to place the credentials behind a web-service that exposes some kind of authentication function. You can call this from your web-site – or another web-service – to retrieve an authorization token to be used for calls into AutoCAD I/O.</p>  <p>Now that we have our credentials, it’s time to use them to call some functionality on AutoCAD I/O. It’s worth taking a look at the AutoCAD I/O documentation:</p>  <p><a href="https://developer.autodesk.com/api/autocadio/v2">https://developer.autodesk.com/api/autocadio/v2</a></p>  <p>This page gives a nice overview of the capabilities of AutoCAD I/O, including this high-level process diagram:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201b7c7f12783970b-pi" target="_blank"><img title="AutoCAD IO diagram" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; float: none; padding-top: 0px; padding-left: 0px; margin: 50px auto; display: block; padding-right: 0px; border-top-width: 0px" border="0" alt="AutoCAD IO diagram" src="/assets/image_482461.jpg" width="500" height="223" /></a></p>  <p>Our next stop is with the AutoCAD I/O samples on GitHub:</p>  <p><a href="https://github.com/Developer-Autodesk/AutoCAD.io">https://github.com/Developer-Autodesk/AutoCAD.io</a></p>  <p>The one we’re going to use is the “Simplest C#” sample that makes use of the standard PlotToPDF activity:</p>  <p><a href="https://github.com/Developer-Autodesk/autocad.io-simplest-CSharp">https://github.com/Developer-Autodesk/autocad.io-simplest-CSharp</a></p>  <p>Once we’ve cloned this sample to our local system, we can plug our credentials into the <i>Program.cs</i> file, build the sample in Visual Studio and then run it.</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201bb08954504970d-pi" target="_blank"><img title="The console app" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; float: none; padding-top: 0px; padding-left: 0px; margin: 50px auto; display: block; padding-right: 0px; border-top-width: 0px" border="0" alt="The console app" src="/assets/image_87031.jpg" width="504" height="257" /></a></p>  <p>If you take a look at My Documents on your system, you should find two files: <i>AIO-report.txt</i> and <i>AIO.pdf</i>. The first contains the command-line output from the AcCoreConsole.exe process that was used to execute the WorkItem, the second contains the PDF output:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201bb0895450c970d-pi" target="_blank"><img title="PDF output" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; float: none; padding-top: 0px; padding-left: 0px; margin: 50px auto; display: block; padding-right: 0px; border-top-width: 0px" border="0" alt="PDF output" src="/assets/image_862938.jpg" width="403" height="272" /></a></p>  <p>To understand a little more about what’s happening, let’s take a look at the primary sub-routine:</p>  <div style="font-size: 8pt; font-family: courier new; background: white; color: black; line-height: 140%">   <p style="margin: 0px"><span style="color: blue">static</span> <span style="color: blue">void</span> Main(<span style="color: blue">string</span>[] args)</p>    <p style="margin: 0px">{</p>    <p style="margin: 0px">&#160; <span style="color: green">//instruct client side library to insert token as Authorization value into each request</span></p>    <p style="margin: 0px">&#160; <span style="color: blue">var</span> container = <span style="color: blue">new</span> <span style="color: #2b91af">Container</span>(<span style="color: blue">new</span> <span style="color: #2b91af">Uri</span>(<span style="color: #a31515">&quot;https://developer.api.autodesk.com/autocad.io/us-east/v2/&quot;</span>));</p>    <p style="margin: 0px">&#160; <span style="color: blue">var</span> token = GetToken();</p>    <p style="margin: 0px">&#160; container.SendingRequest2 += (sender, e) =&gt; e.RequestMessage.SetHeader(<span style="color: #a31515">&quot;Authorization&quot;</span>, token);</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: green">//create a workitem</span></p>    <p style="margin: 0px">&#160; <span style="color: blue">var</span> wi = <span style="color: blue">new</span> <span style="color: #2b91af">WorkItem</span>()</p>    <p style="margin: 0px">&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160; Id = <span style="color: #a31515">&quot;&quot;</span>, <span style="color: green">//must be set to empty</span></p>    <p style="margin: 0px">&#160;&#160;&#160; Arguments = <span style="color: blue">new</span> <span style="color: #2b91af">Arguments</span>(),</p>    <p style="margin: 0px">&#160;&#160;&#160; ActivityId = <span style="color: #a31515">&quot;PlotToPDF&quot;</span> <span style="color: green">//PlotToPDF is a predefined activity</span></p>    <p style="margin: 0px">&#160; };</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; wi.Arguments.InputArguments.Add(<span style="color: blue">new</span> <span style="color: #2b91af">Argument</span>()</p>    <p style="margin: 0px">&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160; Name = <span style="color: #a31515">&quot;HostDwg&quot;</span>,<span style="color: green">// Must match the input parameter in activity</span></p>    <p style="margin: 0px">&#160;&#160;&#160; Resource = <span style="color: #a31515">&quot;http://download.autodesk.com/us/samplefiles/acad/blocks_and_tables_-_imperial.dwg&quot;</span>,</p>    <p style="margin: 0px">&#160;&#160;&#160; StorageProvider = <span style="color: #2b91af">StorageProvider</span>.Generic <span style="color: green">//Generic HTTP download (as opposed to A360)</span></p>    <p style="margin: 0px">&#160; });</p>    <p style="margin: 0px">&#160; wi.Arguments.OutputArguments.Add(<span style="color: blue">new</span> <span style="color: #2b91af">Argument</span>()</p>    <p style="margin: 0px">&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160; Name = <span style="color: #a31515">&quot;Result&quot;</span>, <span style="color: green">//must match the output parameter in activity</span></p>    <p style="margin: 0px">&#160;&#160;&#160; StorageProvider = <span style="color: #2b91af">StorageProvider</span>.Generic, <span style="color: green">//Generic HTTP upload (as opposed to A360)</span></p>    <p style="margin: 0px">&#160;&#160;&#160; HttpVerb = <span style="color: #2b91af">HttpVerbType</span>.POST, <span style="color: green">//use HTTP POST when delivering result</span></p>    <p style="margin: 0px">&#160;&#160;&#160; Resource = <span style="color: blue">null</span> <span style="color: green">//use storage provided by AutoCAD.IO</span></p>    <p style="margin: 0px">&#160; });</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; container.AddToWorkItems(wi);</p>    <p style="margin: 0px">&#160; <span style="color: #2b91af">Console</span>.WriteLine(<span style="color: #a31515">&quot;Submitting workitem...&quot;</span>);</p>    <p style="margin: 0px">&#160; container.SaveChanges();</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: green">//polling loop</span></p>    <p style="margin: 0px">&#160; <span style="color: blue">do</span></p>    <p style="margin: 0px">&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #2b91af">Console</span>.WriteLine(<span style="color: #a31515">&quot;Sleeping for 2 sec...&quot;</span>);</p>    <p style="margin: 0px">&#160;&#160;&#160; System.Threading.<span style="color: #2b91af">Thread</span>.Sleep(2000);</p>    <p style="margin: 0px">&#160;&#160;&#160; container.LoadProperty(wi, <span style="color: #a31515">&quot;Status&quot;</span>); <span style="color: green">//http request is made here</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #2b91af">Console</span>.WriteLine(<span style="color: #a31515">&quot;WorkItem status: {0}&quot;</span>, wi.Status);</p>    <p style="margin: 0px">&#160; }</p>    <p style="margin: 0px">&#160; <span style="color: blue">while</span> (wi.Status == <span style="color: #2b91af">ExecutionStatus</span>.Pending || wi.Status == <span style="color: #2b91af">ExecutionStatus</span>.InProgress);</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: green">//re-query the service so that we can look at the details provided by the service</span></p>    <p style="margin: 0px">&#160; container.MergeOption = Microsoft.OData.Client.<span style="color: #2b91af">MergeOption</span>.OverwriteChanges;</p>    <p style="margin: 0px">&#160; wi = container.WorkItems.ByKey(wi.Id).GetValue();</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: green">//Resource property of the output argument &quot;Result&quot; will have the output url</span></p>    <p style="margin: 0px">&#160; <span style="color: blue">var</span> url = wi.Arguments.OutputArguments.First(a =&gt; a.Name == <span style="color: #a31515">&quot;Result&quot;</span>).Resource;</p>    <p style="margin: 0px">&#160; DownloadToDocs(url, <span style="color: #a31515">&quot;AIO.pdf&quot;</span>);</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: green">//download the status report</span></p>    <p style="margin: 0px">&#160; url = wi.StatusDetails.Report;</p>    <p style="margin: 0px">&#160; DownloadToDocs(url, <span style="color: #a31515">&quot;AIO-report.txt&quot;</span>);</p>    <p style="margin: 0px">}</p>    <p style="margin: 0px">&#160;</p> </div>  <p>In a nutshell, we’re creating a WorkItem with one input argument – a standard sample DWG located on the web – and one output argument – the location at which the resultant PDF should be placed (and this has been left blank, as AutoCAD I/O is able to assign this for us).</p>  <p>Then we simply wait for the WorkItem to complete, at which point we download both the PDF and the status report.</p>  <p>&#160;</p>  <p><b>Creating core modules for your .NET apps</b></p>  <p>Our goal is to host custom code – which could be LISP or C++, as well as our own choice of .NET – in AutoCAD I/O. In order to do this, we need to create a module that can be loaded and executed by the Core Console.</p>  <p>To understand the capabilities of the Core Console, the simplest way is to open a command prompt, navigate to AutoCAD’s <i>Program Files</i> folder, and launch <i>AcCoreConsole.exe</i>:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201b7c7f1278b970b-pi" target="_blank"><img title="The Core Console" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; float: none; padding-top: 0px; padding-left: 0px; margin: 50px auto; display: block; padding-right: 0px; border-top-width: 0px" border="0" alt="The Core Console" src="/assets/image_514754.jpg" width="504" height="257" /></a></p>  <p>From here you get access to a very large subset of AutoCAD commands and API functionality. For instance, even though it’s at the command-line, there’s actually a significant amount of graphics-related functionality that’s available.</p>  <p>To target the Core Console from a .NET app, you need to make sure you reference only <i>AcDbMgd.dll</i> and <i>AcCoreMgd.dll</i> (not <i>AcMgd.dll</i>, which is specific to the full AutoCAD editor). You can also do this using NuGet by adding the <i>AutoCAD.NET.Core</i> package.</p>  <p>This will automatically give you access to the subset of functionality available to applications running in either the Core Console or in AutoCAD I/O. You’ll clearly need to provide a command-line interface to your commands: providing a GUI isn’t going to work.</p>  <p>At a first step, here’s a simple command that we call successfully from the Core Console:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201bb08954514970d-pi" target="_blank"><img title="JIGG command in the Core Console" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; float: none; padding-top: 0px; padding-left: 0px; margin: 50px auto; display: block; padding-right: 0px; border-top-width: 0px" border="0" alt="JIGG command in the Core Console" src="/assets/image_27413.jpg" width="504" height="257" /></a></p>  <p>If we save the results, we can load the DWG into AutoCAD to make sure it worked:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201b7c7f12797970b-pi" target="_blank"><img title="The output" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; float: none; padding-top: 0px; padding-left: 0px; margin: 50px auto; display: block; padding-right: 0px; border-top-width: 0px" border="0" alt="The output" src="/assets/image_827405.jpg" width="503" height="259" /></a></p>  <p>The thing is, this style of command-line interface – where we use methods such as Editor.GetString() to get the values for the individual parameters – can’t be used exactly like this for AutoCAD I/O. The parameters for AutoCAD I/O activities are passed as JSON, which gets written to a file on the local instance and read in by the command being executed.</p>  <p>It’s this level of indirection that allows AutoCAD I/O to have WorkItems with different parameter values, and the effort from a developer’s perspective is modest: they simply need to use Editor.GetString() to find the path to the JSON parameters file, and then use a component such as <i>Newtonsoft.Json.dll</i> to deserialize it into usable settings.</p>  <p>One way to do this is to have a single, shared function that gets called by the various command implementations – in our case JIGG and JIGIO.</p>  <p>&#160;</p>  <p><b>Creating a custom Activity with a .NET AppPackage</b></p>  <p>Now that we have a working CRX module (which is the term used for modules targeting the AutoCAD Core), we can package it up and create an Activity in AutoCAD I/O that we can (eventually) use from our WorkItems.</p>  <p>The simplest way to do this is to modify an existing project, such as this one:</p>  <p><a href="https://github.com/Developer-Autodesk/autocad.io-custom-activity-apppackage-CSharp">https://github.com/Developer-Autodesk/autocad.io-custom-activity-apppackage-CSharp</a></p>  <p>This base project has been integrated into the source project for the Jigsawify.com website:</p>  <p><a href="https://github.com/KeanW/jigsawify">https://github.com/KeanW/jigsawify</a></p>  <p>Once you’ve updated the CrxApp source to build your custom module – and made some other minor adjustments, elsewhere – you will be able to run the console app to generate both the AppPackage containing your module and the Activity that makes use of it.</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201bb08954518970d-pi" target="_blank"><img title="Administering our Activity and its AppPackage" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; float: none; padding-top: 0px; padding-left: 0px; margin: 50px auto; display: block; padding-right: 0px; border-top-width: 0px" border="0" alt="Administering our Activity and its AppPackage" src="/assets/image_275019.jpg" width="504" height="257" /></a></p>  <p>As you can see from the above output, it also contains some code to create a test WorkItem, just to make sure the Activity and its AppPackage work properly.</p>  <p>&#160;</p>  <p><b>Calling a custom Activity from your web-site</b></p>  <p>Now that we’ve created our custom Activity – and the AppPackage it depends on – we need to have our web-site call it.</p>  <p>In this case we’re going to review a few different architectures, to understand what works and what doesn’t.</p>  <p>In our application, we want to do some work in the browser – to perform some edge detection on a user-provided image, using the resultant pixels as an overlay for our jigsaw puzzle – and the tricky thing is communicating these pixels from the browser to our AutoCAD I/O Activity.</p>  <p>This is the first approach I took when developing the prototype. It involved encoding all the pixels as part of the URL fired off by the web-site:</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201bb0895451c970d-pi" target="_blank"><img title="First attempt" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; float: none; padding-top: 0px; padding-left: 0px; margin: 50px auto; display: block; padding-right: 0px; border-top-width: 0px" border="0" alt="First attempt" src="/assets/image_79390.jpg" width="504" height="221" /></a></p>  <p>This fails because there is a fairly small limit on the size of a valid URL (it’s around 2,000 characters, but that’s still not enough for complex engravings). I did try encoding the data in different ways, but generally this only pushed the limit out slightly.</p>  <p>The next approach required some additional complexity on the back-end: I decided to upload an appropriately scaled version of the selected image – returning an identifier to the browser – and then run the same JavaScript edge detection code on the server – this is in many ways the beauty of Node.js – to determine the pixels to send to AutoCAD I/O.</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201b7c7f1279c970b-pi" target="_blank"><img title="Second attempt" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; float: none; padding-top: 0px; padding-left: 0px; margin: 50px auto; display: block; padding-right: 0px; border-top-width: 0px" border="0" alt="Second attempt" src="/assets/image_890840.jpg" width="504" height="287" /></a></p>  <p>This worked well for small images, but soon caused issues on the server side with larger ones. It turns out that encoding the pixels inside the WorkItem parameters caused an issue when logging the WorkItem contents on the server side: if the size of the parameters passed exceeded 40K, the processing would fail. While arguably a server-side issue, it certainly required a process rethink.</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201b8d17ae039970c-pi" target="_blank"><img title="Third attempt" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; float: none; padding-top: 0px; padding-left: 0px; margin: 50px auto; display: block; padding-right: 0px; border-top-width: 0px" border="0" alt="Third attempt" src="/assets/image_192563.jpg" width="504" height="287" /></a></p>  <p>The next version, above, passed a URL as part of the parameters read by our Activity, which then attempts to download the pixel data stored in the custom web-service. This worked, initially, until the AutoCAD I/O team shored up the server-side security: Activities are not allowed direct access to external network resources, for very good reason. The machine instances that drive AutoCAD I/O run <i>AcCoreConsole.exe</i> in a sandbox – with limited user privileges, preventing (among other things) network access.</p>  <p>If you want to have data downloaded and made available to your Activity, you need to specify it as an input parameter: the Core Engine Runner process – part of AutoCAD I/O’s execution infrastructure – goes through the various input parameters and downloads their content for local usage.</p>  <p>Here’s the approach that finally worked: we have an additional input parameter that specifies the URL to out pixel data. The Core Engine Runner downloads the contents of this JSON file to the local system, from which our command can load and deserialize the data to do something with it.</p>  <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201b7c7f127a8970b-pi" target="_blank"><img title="The final, working architecture" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; float: none; padding-top: 0px; padding-left: 0px; margin: 50px auto; display: block; padding-right: 0px; border-top-width: 0px" border="0" alt="The final, working architecture" src="/assets/image_209890.jpg" width="504" height="287" /></a></p>  <p>The system is now working well, and can be used to generate DWG and DXF files to drive a laser cutter. Give it a try at <a href="http://jigsawify.com">Jigsawify.com</a> or <a href="https://github.com/KeanW/jigsawify">check out the source</a> to build your own site that uses AutoCAD I/O with custom .NET code for added design intelligence.</p>
