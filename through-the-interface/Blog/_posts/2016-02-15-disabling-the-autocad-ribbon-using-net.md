---
layout: "post"
title: "Disabling the AutoCAD ribbon using .NET"
date: "2016-02-15 16:26:40"
author: "Kean Walmsley"
categories:
  - "AutoCAD"
  - "AutoCAD .NET"
  - "User interface"
original_url: "https://www.keanw.com/2016/02/disabling-the-autocad-ribbon-using-net.html "
typepad_basename: "disabling-the-autocad-ribbon-using-net"
typepad_status: "Publish"
---

<p>I came across <a href="http://forums.autodesk.com/t5/net/toolbar-enable-disable-via-net/m-p/5878365" target="_blank">this interesting question</a> on <a href="http://forums.autodesk.com/t5/net/bd-p/152" target="_blank">the AutoCAD .NET forum</a>, posted by Pete Elliott:</p> <blockquote> <p><em>When AutoCAD is loading, I see that my toolbars are disabled (grayed-out) until the loading has finished.&nbsp; Our company does some additional data loading after AutoCAD has become idle.&nbsp; But if the user clicks certain custom toolbar buttons while our additional data is loading, AutoCAD fatal errors.&nbsp; Is there a way we can disable the toolbars (like AutoCAD does) until our loading is finished, and then enable them?&nbsp; I haven't been able to locate an API that provides this capability.&nbsp; Any suggestions greatly appreciated!</em></p></blockquote> <p>It seems this would be a very common requirement. For today’s post I’m going to assume that by “toolbars” Pete is actually referring to the ribbon. (It suits my purposes that this be the case, as I’ve found a way to make it work for the ribbon, but I’ll do my best to publish a follow-up post for toolbars, if that turns out to be the actual requirement. :-)</p> <p>The basic approach is fairly simple: you get access to the current “ribbon palette set” via the RibbonServices class (we call a method to create a new one, but typically this will just return the existing ribbon as we’re calling it from a command). We then use it to disable the “ribbon control” as well as its background tab rendering. We also turn off the display of tooltips while the ribbon is disabled.</p> <p>Here’s the C# code that disables and re-enables the ribbon respectively via DR and ER commands. These commands are really just examples of how you might call the EnableRibbon() function from your own code (you’d typically call EnableRibbon(false); as initializaton starts and EnableRibbon(true); when you’re done).</p> <div style="font-size: 8pt; font-family: courier new; background: white; color: black; line-height: 140%"> <p style="margin: 0px"><span style="color: blue">using</span> Autodesk.AutoCAD.Runtime;</p> <p style="margin: 0px"><span style="color: blue">using</span> Autodesk.Windows;</p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="color: blue">namespace</span> UserInterfaceManipulation</p> <p style="margin: 0px">{</p> <p style="margin: 0px">&nbsp; <span style="color: blue">public</span> <span style="color: blue">class</span> <span style="color: #2b91af">Commands</span></p> <p style="margin: 0px">&nbsp; {</p> <p style="margin: 0px">&nbsp;&nbsp;&nbsp; <span style="color: blue">private</span> <span style="color: blue">static</span> <span style="color: blue">bool</span> _showTipsOnDisabled = <span style="color: blue">false</span>;</p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px">&nbsp;&nbsp;&nbsp; [<span style="color: #2b91af">CommandMethod</span>(<span style="color: #a31515">"DR"</span>)]</p> <p style="margin: 0px">&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> <span style="color: blue">static</span> <span style="color: blue">void</span> DisableRibbonCommand()</p> <p style="margin: 0px">&nbsp;&nbsp;&nbsp; {</p> <p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; EnableRibbon(<span style="color: blue">false</span>);</p> <p style="margin: 0px">&nbsp;&nbsp;&nbsp; }</p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px">&nbsp;&nbsp;&nbsp; [<span style="color: #2b91af">CommandMethod</span>(<span style="color: #a31515">"ER"</span>)]</p> <p style="margin: 0px">&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> <span style="color: blue">static</span> <span style="color: blue">void</span> EnableRibbonCommand()</p> <p style="margin: 0px">&nbsp;&nbsp;&nbsp; {</p> <p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; EnableRibbon(<span style="color: blue">true</span>);</p> <p style="margin: 0px">&nbsp;&nbsp;&nbsp; }</p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px">&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> <span style="color: blue">static</span> <span style="color: blue">void</span> EnableRibbon(<span style="color: blue">bool</span> enable)</p> <p style="margin: 0px">&nbsp;&nbsp;&nbsp; {</p> <p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">// Start by making sure we have a ribbon</span></p> <p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">// (if calling from a command this will almost certainly just return</span></p> <p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">// the ribbin that already exists)</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">var</span> rps = Autodesk.AutoCAD.Ribbon.<span style="color: #2b91af">RibbonServices</span>.CreateRibbonPaletteSet();</p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">// Enable or disable it</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rps.RibbonControl.IsEnabled = enable;</p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">if</span> (!enable)</p> <p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p> <p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">// Store the current setting for "Show tooltips when the ribbon is disabled"</span></p> <p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">// and then modify the setting</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _showTipsOnDisabled = <span style="color: #2b91af">ComponentManager</span>.ToolTipSettings.ShowOnDisabled;</p> <p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #2b91af">ComponentManager</span>.ToolTipSettings.ShowOnDisabled = enable;</p> <p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p> <p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">else</span></p> <p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p> <p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">// Restore the setting for "Show tooltips when the ribbon is disabled"</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #2b91af">ComponentManager</span>.ToolTipSettings.ShowOnDisabled = _showTipsOnDisabled;</p> <p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: green">// Enable or disable background tab rendering</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rps.RibbonControl.IsBackgroundTabRenderingEnabled = enable;</p> <p style="margin: 0px">&nbsp;&nbsp;&nbsp; }</p> <p style="margin: 0px">&nbsp; }</p> <p style="margin: 0px">}</p> <p style="margin: 0px">&nbsp;</p></div> <p>Here are the two commands in action:</p> <p><a href="http://through-the-interface.typepad.com/.a/6a00d83452464869e201bb08ba9c1b970d-pi" target="_blank"><img title="Disabling and re-enabling the ribbon" style="float: none; margin: 30px auto; display: block" alt="Disabling and re-enabling the ribbon" src="/assets/image_780688.jpg" width="500" height="280"></a></p>
