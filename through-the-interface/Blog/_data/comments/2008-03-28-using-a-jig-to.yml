comments:
- author: Fernando Malard
  email: fpmalard@yahoo.com.br
  ip: 200.150.62.29
  url: http://arxdummies.blogspot.com
  date: '2008-03-28 20:50:34'
  body: 'Great Kean!


    Is it possible to create a Jig class on C# (as you did) and use it from inside
    an unmanaged C++ code module?


    Further, if I have a .NET wrapper around my custom entity C++ class can I use
    the same approach to create my custom class Jig inside C# ?


    Best regards.'
- author: Kean
  email: kean.walmsley@autodesk.com
  ip: 88.85.19.34
  url: http://blogs.autodesk.com/through-the-interface
  date: '2008-03-29 10:15:16'
  body: 'Hi Fernando,


    I haven''t tried it, but I think you can have managed sections within unmanaged
    C++ that can call (for instance) C# code.


    And yes - the same approach should work for custom entities with managed wrappers.


    Kean'
- author: dannyw
  email: dannywoodman@gmail.com
  ip: 79.23.65.76
  url: ''
  date: '2008-03-29 18:38:49'
  body: 'Hi Kean,


    Any time Great!!


    This is exactly what I was searching for... My only problem is that when I perform
    the rotation with the ROT command the only thing that moves is the upper segment
    of the rectangle and not the whole entity (like in your screenshot). I don''t
    know if I go wrong somewere (I only cut and pasted your code!) or what else...
    Anyone got the same problem?


    Regards,


    Danny'
- author: Kean
  email: kean.walmsley@autodesk.com
  ip: 88.85.19.34
  url: http://blogs.autodesk.com/through-the-interface
  date: '2008-03-29 19:12:43'
  body: 'Hi Danny,


    Sounds like your rectangle is actually a series of lines, rather than being a
    single polyline. Have you tried creating the rectangle via the RECTANG command?


    The code would need to be modified to handle a series of lines...


    Cheers,


    Kean'
- author: dannyw
  email: dannywoodman@gmail.com
  ip: 79.23.65.76
  url: ''
  date: '2008-03-29 19:53:30'
  body: 'Hi Kean,


    I create my rectangle with the command RECTANG and it''s actually a single Polyline.
    I didn''t change anything from your code and debugging things seems works.


    Here is a screenshot that show exactly the problem.


    http://download337.mediafire.com/2fofwymmchwg/iyh7ytsubym/jig_problem.png


    Cheers,


    Danny'
- author: Kean
  email: kean.walmsley@autodesk.com
  ip: 88.85.19.34
  url: http://blogs.autodesk.com/through-the-interface
  date: '2008-03-30 18:24:33'
  body: 'Hi Danny,


    Very strange. Please email me a DWG and let me know which version of AutoCAD you''re
    using.


    Cheers,


    Kean'
- author: AlexF
  email: alex.fielder@ntlworld.com
  ip: 62.22.30.116
  url: http://bigbeardy.co.uk
  date: '2008-08-04 11:24:12'
  body: 'Hi Kean, I''ve been experimenting with block insertion and rotation jigs
    and was wondering if you have any samples that show how to use a jig for scaling
    an object? (or if it''s even possible?)


    Thanks in advance,


    Alex.'
- author: Kean
  email: kean.walmsley@autodesk.com
  ip: 132.188.32.100
  url: http://blogs.autodesk.com/through-the-interface
  date: '2008-08-04 14:32:09'
  body: 'Hi Alex,


    I haven''t attempted this, myself.


    Regards,


    Kean'
- author: SUBIR KUMAR DUTTA
  email: subir.dutta@neilsoft.com
  ip: 59.163.223.130
  url: ''
  date: '2009-04-13 11:41:09'
  body: "Hi Kean,\n\n         Is there any feature in AutoCAD VBA similar to jig.\
    \ Actually I have developed an application using AutoCAD VBA to simulate the path\
    \ by a 2 ARM 3D Robot after reading a .cnc file with GCODEs. Its working smoothly.\n\
    \nBut what I also want to implement a rubber band like of thing . When user will\
    \ try to move the gripper of the robot ( a point object in gripper layer with\
    \ specific handle in my case ) , the robot arms will also react to rotate / align\
    \ using my earlier inverse kinematics solution.\n\nIn future I am planning to\
    \ convert it into ObjectARX code for multiple arms in 3D envelop ( not only moving\
    \ in 2d pane )."
- author: Kean Walmsley
  email: ''
  ip: 88.85.22.207
  url: http://profile.typepad.com/kean
  date: '2009-04-14 08:36:45'
  body: 'Hi Subir,


    I don''t know of a way to do this from VBA, other than by calling a command defined
    using ObjectARX or .NET.


    You should feel free to submit your support questions to my team via <a href="http://adn.autodesk.com">the
    ADN website</a>, as you work for an ADN member.


    Regards,


    Kean'
- author: aaron
  email: rockingaustin@yahoo.com
  ip: 198.102.62.250
  url: ''
  date: '2009-06-18 18:24:40'
  body: 'Hi kean,


    great work, is it possible to modify the point of rotation too?'
- author: Kean Walmsley
  email: ''
  ip: 88.85.22.207
  url: http://profile.typepad.com/kean
  date: '2009-06-18 21:49:06'
  body: 'Absolutely: check the assignment of the rotationPoint variable... you should
    be able to manipulate that to suit your needs.


    Kean'
- author: Mike
  email: mike@abs-structural.com
  ip: 66.240.127.98
  url: ''
  date: '2010-03-18 22:18:28'
  body: "Something doesn't seem quite right in the Sampler function.  I believe Update\
    \ gets called whenever Sampler returns SamplerStatus.OK.  Since m_deltaAngle is\
    \ set to 0.0 in Update, it will pretty much always be 0.0 in Sampler.  Thus, \n\
    \nif(m_deltaAngle == pdr.Value)\nwill always be false... and does nothing to reduce\
    \ flicker."
- author: Kean Walmsley
  email: ''
  ip: 88.85.16.194
  url: http://profile.typepad.com/kean
  date: '2010-03-19 09:19:30'
  body: 'You''re quite right, Mike.


    The test should be against m_baseAngle rather than m_deltaAngle.


    I''ve fixed the code in the post - thanks for bringing this to my attention.


    Kean'
- author: Modis
  email: www.modis@mail.ru
  ip: 195.34.233.214
  url: ''
  date: '2010-09-17 10:15:50'
  body: 'Hi, Kean. What to do if: i draw a polyline, then change WCS to UCS and then
    use your function? Base angle is incorrect'
- author: Kean Walmsley
  email: ''
  ip: 132.188.32.100
  url: http://profile.typepad.com/kean
  date: '2010-09-21 17:48:13'
  body: 'Hi Modis,


    The base angle could be considered in terms of the WCS, and therefore would need
    transforming relative to the current UCS (this would need to be done when getting
    the angle and then probably transformed backwards when setting it).


    This is unfortunately being left as an exercise for the reader...


    Good luck!


    Kean'
- author: Guillermo Bellmann
  email: gbellmann@gmail.com
  ip: 190.224.93.81
  url: http://gbellmann.wordpress.com/
  date: '2011-02-17 03:51:31'
  body: 'Hi Kean,

    I''ve tried this example in AutoCAD 2011 and got a strange behavior:

    When I rotate the rectangle the jig works fine, then, when I decide to finish,
    I just click the screen and the rectang doesn''t rotate.

    I tried putting a value for the angle, and this way it works fine.

    If I use the command with just the mouse click after the rectangle was rotated,
    it returns to the original position, i.e. zero degrees...

    Hope you can help.

    Thanks in advance.

    Regards'
- author: Kean Walmsley
  email: ''
  ip: 109.237.55.190
  url: http://profile.typepad.com/kean
  date: '2011-02-17 09:13:01'
  body: 'Hi Guillermo,


    I''ve made a small change to the above code (as described in the Update section
    at the bottom), to address this.


    Thanks for the feedback!


    Kean'
- author: Guillermo Bellmann
  email: gbellmann@gmail.com
  ip: 190.224.93.81
  url: http://gbellmann.wordpress.com/
  date: '2011-02-18 00:53:16'
  body: 'Excellent!!! Now it works as expected, thank you.

    BTW, great blog!'
- author: Jason
  email: jtuck@integral-group.net
  ip: 204.214.48.90
  url: ''
  date: '2011-07-12 15:26:58'
  body: "Hi Kean,\n Using the code above that checks against the tolerance, I notice\
    \ that when I cut ortho on - I can hit 90, 180, and 270 degree angles, but it\
    \ won't rotate back to 0. If I turn ortho off, I get full 360 degrees rotation.\n\
    \nAny ideas?\n\nThanks\nJason"
- author: Kean Walmsley
  email: ''
  ip: 80.83.34.178
  url: http://profile.typepad.com/kean
  date: '2011-07-12 20:29:44'
  body: 'Hi Jason,


    Does it only happen when checking the tolerance?


    Cheers,


    Kean'
- author: Jason
  email: jtuck@integral-group.net
  ip: 204.214.48.90
  url: ''
  date: '2011-07-13 17:04:02'
  body: Yes - when I comment out the tolerance check, it will rotate fine with ortho
    on - however it still inserts back at 0 rotation as mentioned above.
- author: Kean Walmsley
  email: ''
  ip: 80.83.34.178
  url: http://profile.typepad.com/kean
  date: '2011-07-21 11:38:52'
  body: 'Hi Jason,


    I''ve tried to work around this issue, but with no luck. The "incremental rotation"
    approach doesn''t play well with Ortho, given that additional Update() call in
    the jig.


    Perhaps ADN or someone on the AutoCAD .NET Discussion Group can help.


    Sorry for the bad news,


    Kean'
- author: Sam
  email: samgryan@gmail.com
  ip: 178.73.48.79
  url: ''
  date: '2011-07-23 19:51:21'
  body: 'Hi Kean,

    Could you suggest any modification to not display the original object during the
    rotation?

    Great blog BTW.'
- author: Kean Walmsley
  email: ''
  ip: 80.83.34.178
  url: http://profile.typepad.com/kean
  date: '2011-07-24 11:20:53'
  body: 'Hi Sam,


    Thanks!


    You might try setting the visibility to false (after selection) before the jig
    itself starts.


    Cheers,


    Kean'
- author: SS
  email: shevtsov.s.sergey@gmail.com
  ip: 37.112.134.169
  url: ''
  date: '2013-05-07 17:56:10'
  body: 'Hi Kean,

    Great job!

    But can you tell me can i use this code not for one selected object but for delection
    set?'
- author: Kean Walmsley
  email: ''
  ip: 83.68.204.241
  url: http://profile.typepad.com/kean
  date: '2013-05-07 18:48:11'
  body: 'Hi SS,


    You''d need to turn it into a DrawJig and then do some work to manipulate a list
    of entities.


    Which is beyond the scope of this post, unfortunately. Someone on the AutoCAD
    .NET Discussion Group may have something to share, though.


    Regards,


    Kean'
- author: Blog
  email: ''
  ip: 80.254.154.51
  url: http://profile.typepad.com/blog302
  date: '2013-07-01 09:35:16'
  body: 'Hi. First of all I''d just like to say that your blog has proven an invaluable
    resource for starting with developing of a CAD plugin. Lastly I''d like to ask
    why you are using "complex" matrix-transformations when a BlockReference has a
    perfectly good "Rotation" property? Or does that "Rotation"-property not work
    as I would expect it to?


    - Alxandr'
- author: Kean Walmsley
  email: ''
  ip: 132.188.32.22
  url: http://profile.typepad.com/kean
  date: '2013-07-01 09:55:41'
  body: 'Hi Alxandr,


    This code is intended to work with AutoCAD entities that don''t all have a handy
    Rotation property. If you want to target BlockReferences specifically, you could
    certainly choose to simplify the code slightly.


    Regards,


    Kean

    -----'
