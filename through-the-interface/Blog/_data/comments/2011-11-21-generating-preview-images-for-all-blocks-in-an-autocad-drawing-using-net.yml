comments:
- author: Craig
  email: cnicholas@stanburys.com
  ip: 217.36.60.45
  url: ''
  date: '2013-04-22 16:56:56'
  body: "Hello Kean,\nI'm hoping to be able to do this in AutoCAD 2013 or 2014.\n\
    I tried the code and had to change \nobject ActiveDocument = doc.AcadDocument;\n\
    to use the new extension method \nobject ActiveDocument = doc.GetAcadDocument();\n\
    but when I tried it with a number of blocks it either does not generate an icon\
    \ or fails in the attempt.\nIs there an alternative way to do this now?\nThanks\n\
    Craig"
- author: Kean Walmsley
  email: ''
  ip: 132.188.64.218
  url: http://profile.typepad.com/kean
  date: '2013-04-22 19:37:08'
  body: 'Hi Craig,


    I took a quick look: it does work on my system (although it takes some time to
    complete). It did result in a number of empty  icons (some were OK), and until
    I called BLOCKICON * to see if that helped (it did).


    So it may be worth moving the BLOCKICON call outside of the loop and use the *
    argument, before saving the blocks individually. At least that''s what I''d try
    first.


    Regards,


    Kean'
- author: Egor
  email: e.anastasyev@gmail.com
  ip: 85.233.84.153
  url: ''
  date: '2013-04-24 12:12:24'
  body: "Hi Kean,\n Its possible to set icon size? Or we can generate only 32x32 sized\
    \ thumbnails?\n\nThanks"
- author: Kean Walmsley
  email: ''
  ip: 74.95.195.137
  url: http://profile.typepad.com/kean
  date: '2013-04-24 16:26:15'
  body: 'Hi Egor,


    I don''t believe so. This code is just taking whatever is generated by AutoCAD.
    I''m not sure whether that''s controllable (I assume not).


    Regards,


    Kean'
- author: Todd
  email: todd@mccutcheon.com.au
  ip: 218.214.121.227
  url: ''
  date: '2013-07-03 08:59:15'
  body: 'Pardon my ignorance, I found this when searching for a way to export my blocks
    as images for palette or toolbars.


    How can I load this as an application or plugin.  I am quite familiar with lisp
    but not C#?'
- author: Kean Walmsley
  email: ''
  ip: 83.68.204.241
  url: http://profile.typepad.com/kean
  date: '2013-07-03 09:05:34'
  body: 'Hi Todd,


    <a href="http://through-the-interface.typepad.com/through_the_interface/2006/07/getting_started.html">This
    post</a> should be of some use.


    Otherwise I recommend the resources on <a href="http://autodesk.com/developautocad">the
    AutoCAD Developer Center</a>.


    Basically you need to copy the code, paste it into a (for instance) Visual C#
    Express Class Library project and add a few assembly references (AcDbMgd.dll and
    AcMgd.dll for AutoCAD 2012 and before, add AcCoreMgd.dll for AutoCAD 2013 onwards).
    The best is to use the AutoCAD .NET Wizard to generate the project skeleton, though.


    Regards,


    Kean'
- author: Todd
  email: todd@mccutcheon.com.au
  ip: 218.214.121.227
  url: ''
  date: '2013-07-03 10:34:22'
  body: Thanks very much, I will have a crack at it.
- author: Luigi Ballotta
  email: luigi.ballotta@valitalia.com
  ip: 85.46.59.210
  url: ''
  date: '2013-08-30 09:13:37'
  body: 'Hello Kean, Hello all.

    So I tried to convert this snippet in VB.NET and encountered an issue at the line:

    object[] data = { "_.BLOCKICON " + blk.Name + "\n" };


    Converting in: Dim data() as Object = {"_.BLOCKICON " + blk.Name + "\n" } it doesn''t
    work.


    After some few attempts this is the correct syntax:


    Dim data() As Object = {"_.BLOCKICON " + blk.Name + vbCr}


    Thankyou


    Regards'
- author: Kean Walmsley
  email: ''
  ip: 83.68.204.241
  url: http://profile.typepad.com/kean
  date: '2013-09-02 15:42:19'
  body: 'Thanks, Luigi. It''s always nice to see people posting such hints proactively.


    Kean'
- author: andrea
  email: andrea.tiveron@e-metodi.it
  ip: 2.227.50.137
  url: http://www.e-facility.it
  date: '2013-09-24 12:00:21'
  body: 'thanks Kean and Luigi

    now works fine also for me

    andrea'
- author: olivier.pavlin@gmail.com
  email: olivier.pavlin@gmail.com
  ip: 88.177.55.23
  url: ''
  date: '2013-10-31 10:31:41'
  body: "Hi,\nThis is a very interesting feature, but I wonder if we can do the same\
    \ with blocks that are not in the current drawing. \nMy problem is that I would\
    \ like to generate icons for blocks located in several external .dwg without opening\
    \ them ...\nAnd for what I have seen the BLOCKICON command works only for blocks\
    \ in the current database.\n\nThank you for your help,\nOlivier"
- author: Kean Walmsley
  email: ''
  ip: 83.68.204.241
  url: http://profile.typepad.com/kean
  date: '2013-10-31 11:15:47'
  body: 'Hi Oliver,


    You might want to look at the Core Console (available from AutoCAD 2013 onwards).
    This should allow you (I believe) to run the BLOCKICON command in non-current
    drawings.


    Regards,


    Kean'
- author: Olivier
  email: olivier.pavlin@gmail.com
  ip: 88.177.55.23
  url: ''
  date: '2013-10-31 11:26:35'
  body: 'Thanks I''m going to take a look at it. I''ll let you know if I succeed to
    do it.


    Oliver.'
- author: Olivier
  email: olivier.pavlin@gmail.com
  ip: 88.177.55.23
  url: ''
  date: '2013-11-13 16:43:00'
  body: "Hi Kean as Egor said, BLOCKICON works great but it's limited to 32*32 bitmap.\n\
    \nMy problem is to generate a block preview in a larger window to help the user\
    \ to choose it correctly. \nIt seems that the solution is to generate the block\
    \ inside an empty database and use the Database.ThumbnailBitmap function which\
    \ gets a nice 320*250 image.\n\nThis works perfectly if you use the -WBLOCK command\
    \ and then use db.ReadDwgFile and db.ThumbnailBitmap\n\nbut if I want to execute\
    \ something similar by code :\n\nusing (Database tempDb = sourceDb.Wblock(bt[blocName]))\n\
    {                            tempDb.SaveAs(\"C:\\\\temp\\\\temp.dwg\", true, DwgVersion.Newest,\
    \ tempDb.SecurityParameters);\n}\n\nI get a correct new drawing with the right\
    \ block inside but WITH NO PREVIEW... (tempDb.ThumbnailBitmap = null)\n\nLook\
    \ like a tricky one...I can't achieve the same result than -WBLOCK command in\
    \ .net :(\n\nThanks for your help,\nOlivier"
- author: Kean Walmsley
  email: ''
  ip: 83.68.204.241
  url: http://profile.typepad.com/kean
  date: '2013-11-13 19:19:39'
  body: 'Hi Olivier,


    By coincidence this very question came up in an internal discussion. I''m putting
    some code together and will post something by the end of the week.


    Regards,


    Kean'
- author: Kean Walmsley
  email: ''
  ip: 132.188.32.22
  url: http://profile.typepad.com/kean
  date: '2013-11-15 14:26:49'
  body: 'Hi Egor,


    Please see this post:


    <a href="http://through-the-interface.typepad.com/through_the_interface/2013/11/generating-larger-preview-images-for-all-blocks-in-an-autocad-drawing-using-net.html">http://through-the-interface.typepad.com/through_the_interface/2013/11/generating-larger-preview-images-for-all-blocks-in-an-autocad-drawing-using-net.html</a>


    Regards,


    Kean'
- author: Kean Walmsley
  email: ''
  ip: 132.188.32.22
  url: http://profile.typepad.com/kean
  date: '2013-11-15 14:27:10'
  body: 'Hi Olivier,


    As promised, here you go:


    <a href="http://through-the-interface.typepad.com/through_the_interface/2013/11/generating-larger-preview-images-for-all-blocks-in-an-autocad-drawing-using-net.html">http://through-the-interface.typepad.com/through_the_interface/2013/11/generating-larger-preview-images-for-all-blocks-in-an-autocad-drawing-using-net.html</a>


    Regards,


    Kean

    -----'
