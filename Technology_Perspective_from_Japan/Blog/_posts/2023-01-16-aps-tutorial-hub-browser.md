---
layout: "post"
title: "APS チュートリアル：Hub Browser"
date: "2023-01-16 00:01:38"
author: "Toshiaki Isezaki"
categories:
  - "API カスタマイズ"
  - "クラウドサービス"
original_url: "https://adndevblog.typepad.com/technology_perspective/2023/01/aps-tutorial-hub-browser.html "
typepad_basename: "aps-tutorial-hub-browser"
typepad_status: "Publish"
---

<p>APS 学習サイト、Learn APS Tutorials（<a href="https://tutorials.autodesk.io/" rel="noopener" target="_blank">https://tutorials.autodesk.io/</a>）になって、使用するサンプルが更新されていますので、GitHub リポジトリ、<a href="https://tutorials.autodesk.io/tutorials/hubs-browser/" rel="noopener" target="_blank">Hub Browser</a>（Node.js）- <a href="https://github.com/autodesk-platform-services/aps-hubs-browser-nodejs" rel="noopener" target="_blank">GitHub - autodesk-platform-services/aps-hubs-browser-nodejs: Hubs Browser (Node.js)</a>&#0160;を題材に、ローカル環境（Windows）にクローンして実行する手順を記しておきたいと思います。</p>
<hr />
<ol>
<li>Web ブラウザで GitHub 上の <strong><a href="https://github.com/autodesk-platform-services/aps-hubs-browser-nodejs" rel="noopener" target="_blank">Hubs Browser (Node.js)</a>&#0160;&#0160;</strong>リポジトリ ページを開きます。</li>
<li>画面右側の [Code] ボタンをクリックして、クローン元のリポジトリ URL <strong>https://github.com/autodesk-platform-services/aps-hubs-browser-nodejs.git</strong>&#0160;を<a href="https://ja.wikipedia.org/wiki/%E3%82%AF%E3%83%AA%E3%83%83%E3%83%97%E3%83%9C%E3%83%BC%E3%83%89" rel="noopener noreferrer" target="_blank">クリップボード</a>にコピーしておきます。<br /><a class="asset-img-link" href="https://adndevblog.typepad.com/.a/6a0167607c2431970b02af148b2181200c-pi" style="display: inline;"><img alt="Repo" border="0" class="asset  asset-image at-xid-6a0167607c2431970b02af148b2181200c image-full img-responsive" src="/assets/image_792653.jpg" title="Repo" /></a></li>
<li>リポジトリの内容をクライアント コンピュータにクローン（コピー）します。コマンド プロンプトを起動して、リポジトリ内容をコピーしたいフォルダ（ディレクトリ）に CD コマンドで移動し、<strong>git clone&#0160; https://github.com/autodesk-platform-services/aps-hubs-browser-nodejs.git</strong>（クリップボード内の URL）と入力します。 <strong>aps-hubs-browser-nodejs</strong> フォルダが作成されて、GitHub リポジトリからソースコードがコピーされます。<br /><a class="asset-img-link" href="https://adndevblog.typepad.com/.a/6a0167607c2431970b02af1c966d93200d-pi" style="display: inline;"><img alt="Clone" border="0" class="asset  asset-image at-xid-6a0167607c2431970b02af1c966d93200d image-full img-responsive" src="/assets/image_709088.jpg" title="Clone" /></a></li>
<li>クローンされたプロジェクトに Node.js の実行で必要となるパッケージ（ミドルウェア）をインストールします。CD コマンドで現在のフォルダを&#0160;<strong>aps-hubs-browser-nodejs</strong>フォルダへ移動してから、<strong>npm install</strong>&#0160;と入力します。<br /><a class="asset-img-link" href="https://adndevblog.typepad.com/.a/6a0167607c2431970b02af14acb8f4200b-pi" style="display: inline;"><img alt="Install" border="0" class="asset  asset-image at-xid-6a0167607c2431970b02af14acb8f4200b image-full img-responsive" src="/assets/image_977404.jpg" title="Install" /></a></li>
<li>このサンプルは実行時にシステム環境変数から Client ID と Client Secret、コールバック URL を取得するので、先にコマンド プロンプトでそれらを指定します。作成したアプリは、システム環境変数、<strong>APS_CLIENT_ID</strong>（使用する Client ID）、<strong>APS_CLIENT_SECRET</strong>（使用する Client Secret）、<strong>APS_CALLBACK_URL</strong>（3-legged OAuth で使用するコールバック URL）、<strong>SERVER_SESSION_SECRET</strong>（サーバー セッションクッキーの暗号化/復号化で使用する任意のフレーズ）を取得、利用します。メモ帳などのテキスト エディタとクリップボードを交互に利用して（コピー＆ペースト）、SET コマンドを実行してみてください。ここでは、ローカル環境での動作を前提に、コールバック URL を <strong>http://localhost:8080/api/auth/callback</strong> で設定します。コールバック URL は、事前に <strong><a href="https://adndevblog.typepad.com/technology_perspective/2016/07/app-registration-and-getting-keys-for-forge-api.html" rel="noopener" target="_blank">APS API を利用するアプリの登録とキーの取得</a></strong>&#0160;の手順で設定が必要です。<br /><a class="asset-img-link" href="https://adndevblog.typepad.com/.a/6a0167607c2431970b02af1c96855a200d-pi" style="display: inline;"><img alt="Variables" border="0" class="asset  asset-image at-xid-6a0167607c2431970b02af1c96855a200d image-full img-responsive" src="/assets/image_280570.jpg" title="Variables" /></a><br />
<pre><code>set APS_CLIENT_ID=&lt;&lt;YOUR CLIENT ID&gt;&gt;
set APS_CLIENT_SECRET=&lt;&lt;YOUR CLIENT SECRET&gt;&gt;
set APS_CALLBACK_URL=http://localhost:8080/api/auth/callback
set SERVER_SESSION_SECRET=&lt;&lt;セッションクッキーの暗号化/復号化に使用される任意の文字列&gt;&gt;</code></pre>
</li>
<li>ここまでの手順で実行の準備は完了です。カレント フォルダが <strong>aps-hubs-browser-nodejs</strong><strong>&#0160;</strong>フォルダであることを確認したら、<strong>npm start</strong> と入力して Node.js サーバーを起動します。<br /><a class="asset-img-link" href="https://adndevblog.typepad.com/.a/6a0167607c2431970b02af148b3961200c-pi" style="display: inline;"><img alt="Start" border="0" class="asset  asset-image at-xid-6a0167607c2431970b02af148b3961200c image-full img-responsive" src="/assets/image_316758.jpg" title="Start" /></a></li>
<li>Web ブラウザを起動して、URL 欄に <strong>localhost:8080</strong> と入力すると、ページが表示されるはずです。3-legged OAuth を使ってオートデスク クラウドストレージにアクセスするためのアクセストークンを取得します。ページ右上の [Login] ボタンをクリックしてください。<br /><a class="asset-img-link" href="https://adndevblog.typepad.com/.a/6a0167607c2431970b02af148b3985200c-pi" style="display: inline;"><img alt="Initial" border="0" class="asset  asset-image at-xid-6a0167607c2431970b02af148b3985200c image-full img-responsive" src="/assets/image_749229.jpg" title="Initial" /></a></li>
<li>Autodesk ID（オートデスク アカウント）の入力を求める画面が表示されます。A360 や Fusion Team、BIM 360、Autodesk Construction Cloud にアクセス可能なアカウント ユーザ名を入力して [次へ] ボタンをクリックします。&#0160;<br /><a class="asset-img-link" href="https://adndevblog.typepad.com/.a/6a0167607c2431970b02af1c968637200d-pi" style="display: inline;"><img alt="Username" border="0" class="asset  asset-image at-xid-6a0167607c2431970b02af1c968637200d image-full img-responsive" src="/assets/image_954335.jpg" title="Username" /></a></li>
<li>アカウントのパスワードを入力して [サインイン] ボタンをクリックします。<br /><a class="asset-img-link" href="https://adndevblog.typepad.com/.a/6a0167607c2431970b02af1c968660200d-pi" style="display: inline;"><img alt="Password" border="0" class="asset  asset-image at-xid-6a0167607c2431970b02af1c968660200d image-full img-responsive" src="/assets/image_436020.jpg" title="Password" /></a></li>
<li>左手に Hub - Project - Folder - Item - Version の階層が表示されます。Version に既にクラウド サービスで変換された SVF が存在していれば、クリックして同 Version の内容が Viewer に表示されるはずです。<br /><a class="asset-img-link" href="https://adndevblog.typepad.com/.a/6a0167607c2431970b02af1c9686ac200d-pi" style="display: inline;"><img alt="Viewer" border="0" class="asset  asset-image at-xid-6a0167607c2431970b02af1c9686ac200d image-full img-responsive" src="/assets/image_50172.jpg" title="Viewer" /></a><br />この例では、Fusion Team の Hub 配下から、既定の Demo Project に用意されている Robot.iam を表示しています。&#0160;<a class="asset-img-link" href="https://adndevblog.typepad.com/.a/6a0167607c2431970b02af14acd1a4200b-pi" style="display: inline;"><img alt="Fusion_team" border="0" class="asset  asset-image at-xid-6a0167607c2431970b02af14acd1a4200b image-full img-responsive" src="/assets/image_66930.jpg" title="Fusion_team" /></a><br />BIM 360、Autodesk Construction Cloud にアクセスする場合には、Account Admin の方が「カスタム統合」機能を使って Client ID を登録しておく必要があります。カスタム統合については、<a href="https://adndevblog.typepad.com/technology_perspective/2017/06/bim-360-docs-and-data-management-api-access.html" rel="noopener" target="_blank">BIM 360 Docs と Data Management API アクセス</a> を参照してみてください。<br /><a class="asset-img-link" href="https://adndevblog.typepad.com/.a/6a0167607c2431970b02af14acd213200b-pi" style="display: inline;"><img alt="Custom_integration" border="0" class="asset  asset-image at-xid-6a0167607c2431970b02af14acd213200b image-full img-responsive" src="/assets/image_578792.jpg" title="Custom_integration" /></a><br />なお、Autodesk Construction Cloud へのカスタム統合について、公式ドキュメントの <a href="https://aps.autodesk.com/en/docs/acc/v1/overview/bim-360-compatibility/bim-360-compatibility/" rel="noopener" target="_blank">BIM 360 Compatibility | Autodesk Construction Cloud APIs | Autodesk Platform Services</a> でページでは次のように紹介しています。<br /><a class="asset-img-link" href="https://adndevblog.typepad.com/.a/6a0167607c2431970b02af148d136f200c-pi" style="display: inline;"><img alt="Acc_provisoning" border="0" class="asset  asset-image at-xid-6a0167607c2431970b02af148d136f200c image-full img-responsive" src="/assets/image_185337.jpg" title="Acc_provisoning" /></a><br />一方、BIM 360 へのカスタム統合については、<a href="https://aps.autodesk.com/en/docs/bim360/v1/tutorials/getting-started/#step-1-provisioning-a-bim-360-account" rel="noopener" target="_blank">Getting Started | BIM 360 API | Autodesk Platform Services</a>&#0160;で手順が示されています。<br /><br />カスタム統合でアプリが使用する Client ID が正しく登録されると、BIM 360 ないし、Autodesk Construction Cloud&#0160; の Hub が表示されるようになります。プロジェクト配下で変換済の SVF を持つファイルがあれば、Viewer 上にモデルを表示出来ます。<br /><a class="asset-img-link" href="https://adndevblog.typepad.com/.a/6a0167607c2431970b02af14acd252200b-pi" style="display: inline;"><img alt="Bim_360" border="0" class="asset  asset-image at-xid-6a0167607c2431970b02af14acd252200b image-full img-responsive" src="/assets/image_117817.jpg" title="Bim_360" /></a></li>
</ol>
<hr />
<p>3-legged OAuth を使った Viewer への表示プロセスは、<a href="https://adndevblog.typepad.com/technology_perspective/2016/12/understanding-steps-to-use-viewer-on-postman2.html" rel="noopener" target="_blank">Postman による Viewer 利用手順の理解 - 3 legged 認証</a> でも把握いただけます。</p>
<p>このサンプルは、ファイルのアップロードはサポートしていません。Data Management API を使ったストレージへのアップロードは、公式ドキュメント <a href="https://aps.autodesk.com/en/docs/data/v2/tutorials/upload-file/" rel="noopener" target="_blank">Upload a File | Data Management API | Autodesk Platform Services</a>をご確認ください。</p>
<p>By Toshiaki Isezaki</p>
