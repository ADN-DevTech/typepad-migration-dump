---
layout: "post"
title: "2015対応アドイン製品のご紹介（再度）と3ds Max 2014にてNitrous SDKを使用する際のご注意"
date: "2014-05-29 01:05:19"
author: "Akira Kudo"
categories:
  - "API カスタマイズ"
  - "デスクトップ製品"
original_url: "https://adndevblog.typepad.com/technology_perspective/2014/05/nitroussdk2014.html "
typepad_basename: "nitroussdk2014"
typepad_status: "Publish"
---

<p></p>
<p></p>
<p class="MsoNormal"><span style="font-family: &#39;ＭＳ ゴシック&#39;; mso-ascii-theme-font: major-fareast; mso-fareast-theme-font: major-fareast; mso-hansi-theme-font: major-fareast;">Autodesk Developer Network<span lang="JA">の工藤　暁です。先日伊勢崎よりご案内させて頂きました</span><a href="http://adndevblog.typepad.com/technology_perspective/2014/05/new-arrival-of-2015-support-addins.html">2015<span lang="JA">対応アドイン製品</span></a><span lang="JA">ですが、</span>M&amp;E<span lang="JA">製品として</span></span><span lang="JA" style="font-family: &#39;ＭＳ Ｐゴシック&#39;; mso-ascii-font-family: Arial; mso-hansi-font-family: Arial;">株式会社</span><span lang="JA" style="font-family: &#39;ＭＳ Ｐゴシック&#39;; mso-ascii-font-family: Arial; mso-hansi-font-family: Arial;">ピー・ソフトハウ</span><span lang="JA" style="font-family: &#39;ＭＳ ゴシック&#39;; mso-ascii-theme-font: major-fareast; mso-fareast-theme-font: major-fareast; mso-hansi-theme-font: major-fareast;">ス様より</span></p>
<p class="MsoNormal"><strong><span style="font-family: &#39;Arial&#39;,&#39;sans-serif&#39;;"><a href="http://www.psoft.co.jp/jp/product/pencil/"><span style="font-weight: normal;">PSOFT Pencil+ 3</span></a> </span></strong><strong><span lang="JA" style="font-family: &#39;ＭＳ Ｐゴシック&#39;; mso-ascii-font-family: Arial; mso-hansi-font-family: Arial; mso-bidi-font-family: Arial;">及び　</span></strong><strong><span style="font-family: &#39;Arial&#39;,&#39;sans-serif&#39;;"><a href="http://www.psoft.co.jp/jp/product/liquid/"><span style="font-weight: normal;">PSOFT Liquid+&#0160;</span></a></span></strong><span lang="JA" style="font-family: &#39;ＭＳ Ｐゴシック&#39;; mso-ascii-font-family: Arial; mso-hansi-font-family: Arial;">が</span><a href="http://www.autodesk.co.jp/adsk/servlet/item?siteID=1169823&amp;id=23382726&amp;linkID=1158289"><span lang="JA" style="font-family: &#39;ＭＳ Ｐゴシック&#39;; mso-ascii-font-family: Arial; mso-hansi-font-family: Arial;">プレリリース</span></a><span lang="JA" style="font-family: &#39;ＭＳ Ｐゴシック&#39;; mso-ascii-font-family: Arial; mso-hansi-font-family: Arial;">されました事を改めてご紹介させて頂きます。　詳しくは上記リンクをご参照ください。</span></p>
<p class="MsoNormal"><span style="font-family: &#39;ＭＳ ゴシック&#39;; mso-ascii-theme-font: major-fareast; mso-fareast-theme-font: major-fareast; mso-hansi-theme-font: major-fareast;">&#0160;</span></p>
<p class="MsoNormal"><span lang="JA" style="font-family: &#39;ＭＳ ゴシック&#39;; mso-ascii-theme-font: major-fareast; mso-fareast-theme-font: major-fareast; mso-hansi-theme-font: major-fareast;">さて、</span><span style="font-family: &#39;ＭＳ ゴシック&#39;; mso-ascii-theme-font: major-fareast; mso-fareast-theme-font: major-fareast; mso-hansi-theme-font: major-fareast;">3ds Max 2014<span lang="JA">にて</span>Nitrous SDK<span lang="JA">を使用する際に問題が報告されましたので、回避方法と共にご紹介させて頂きます。</span></span></p>
<p class="MsoNormal"><span lang="JA" style="font-family: &#39;ＭＳ ゴシック&#39;; mso-ascii-theme-font: major-fareast; mso-fareast-theme-font: major-fareast; mso-hansi-theme-font: major-fareast;">問題としては下記のコードに様にカスタム</span><span style="font-family: &#39;ＭＳ ゴシック&#39;; mso-ascii-theme-font: major-fareast; mso-fareast-theme-font: major-fareast; mso-hansi-theme-font: major-fareast;">GeomObject<span lang="JA">プラグインにて</span>IObjectDisplay2<span lang="JA">を使用すると、常に</span>smooth<span lang="JA">にてビューポート</span>(Nitrous)<span lang="JA">に描画されてしまいます。</span></span></p>
<p class="MsoNormal"><span style="color: black;">&#0160;</span></p>
<p class="MsoNormal"><span style="font-size: 8.0pt;">&lt;code_begin&gt;</span></p>
<p class="MsoNormal"><span style="font-size: 8.0pt;">&#0160;&#0160;&#0160; <span style="color: #0070c0;">virtual bool </span>PrepareDisplay(<span style="color: #0070c0;">const </span>MaxContext&amp;, <span style="color: #0070c0;">const </span>UpdateDisplayContext&amp; displayContext) {</span></p>
<p class="MsoNormal"><span style="font-size: 8.0pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; const TimeValue t = displayContext.GetDisplayTime();</span></p>
<p class="MsoNormal"><span style="font-size: 8.0pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;GenerateMeshRenderItemsContext genContext;</span></p>
<p class="MsoNormal"><span style="font-size: 8.0pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; genContext.GenerateDefaultContext(displayContext);</span></p>
<p><span style="font-size: 8.0pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; IMeshDisplay2*pMeshDisplay = <span style="color: #0070c0;">static_cast</span>&lt;IMeshDisplay2*&gt;(mesh.GetInterface(IMesh_DISPLAY2_INTERFACE_ID));</span></p>
<p class="MsoNormal"><span style="font-size: 8.0pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #0070c0;">if</span> (pMeshDisplay == NULL) {</span></p>
<p class="MsoNormal"><span style="font-size: 8.0pt; color: #0070c0;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; return false</span><span style="font-size: 8.0pt;">;</span></p>
<p class="MsoNormal"><span style="font-size: 8.0pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p class="MsoNormal"><span style="font-size: 8.0pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; pMeshDisplay-&gt;PrepareDisplay(genContext);</span></p>
<p class="MsoNormal"><span style="font-size: 8.0pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; return true;</span></p>
<p class="MsoNormal"><span style="font-size: 8.0pt;">&#0160;&#0160;&#0160; }</span></p>
<p class="MsoNormal"><span style="font-size: 8.0pt;">&#0160;&#0160;&#0160; <span style="color: #0070c0;">virtual bool </span>UpdatePerNodeItems(<span style="color: #0070c0;">const </span>MaxContext&amp; maxContext,</span></p>
<p class="MsoNormal"><span style="font-size: 8.0pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #0070c0;">const </span>UpdateDisplayContext&amp; displayContext,</span></p>
<p class="MsoNormal"><span style="font-size: 8.0pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; UpdateNodeContext&amp; nodeContext, </span></p>
<p class="MsoNormal"><span style="font-size: 8.0pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; IRenderItemContainer&amp; targetRenderItemContainer) {</span></p>
<p class="MsoNormal"><span style="font-size: 8.0pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; GenerateMeshRenderItemsContext genContext;</span></p>
<p class="MsoNormal"><span style="font-size: 8.0pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; genContext.GenerateDefaultContext(displayContext);</span></p>
<p class="MsoNormal"><span style="font-size: 8.0pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; genContext.RemoveInvisibleMeshElementDescriptions(nodeContext.GetRenderNode());</span></p>
<p class="MsoNormal"><span style="font-size: 8.0pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; IMeshDisplay2*pMeshDisplay = <span style="color: #0070c0;">static_cast</span>&lt;IMeshDisplay2*&gt;(mesh.GetInterface(IMesh_DISPLAY2_INTERFACE_ID));</span></p>
<p class="MsoNormal"><span style="font-size: 8.0pt; color: #0070c0;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; if </span><span style="font-size: 8.0pt;">(pMeshDisplay == NULL) {</span></p>
<p class="MsoNormal"><span style="font-size: 8.0pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #0070c0;">return false</span>;</span></p>
<p class="MsoNormal"><span style="font-size: 8.0pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p class="MsoNormal"><span style="font-size: 8.0pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; RenderItemHandleArray renderItems;</span></p>
<p class="MsoNormal"><span style="font-size: 8.0pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; pMeshDisplay-&gt;GetRenderItems(maxContext, genContext, nodeContext, renderItems);</span></p>
<p class="MsoNormal"><span style="font-size: 8.0pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; targetRenderItemContainer.ClearAllRenderItems();</span></p>
<p class="MsoNormal"><span style="font-size: 8.0pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; targetRenderItemContainer.AddRenderItems(renderItems);</span></p>
<p class="MsoNormal"><span style="font-size: 8.0pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #0070c0;">return true</span>;</span></p>
<p class="MsoNormal"><span style="font-size: 8.0pt;">&#0160;&#0160;&#0160; }</span></p>
<p class="MsoNormal"><span style="font-size: 8.0pt;">&lt;code_end&gt;</span></p>
<p class="MsoNormal"><span style="font-family: &#39;ＭＳ ゴシック&#39;; mso-ascii-theme-font: major-fareast; mso-fareast-theme-font: major-fareast; mso-hansi-theme-font: major-fareast;">&#0160;</span></p>
<p class="MsoNormal"><span lang="JA" style="font-family: &#39;ＭＳ ゴシック&#39;; mso-ascii-theme-font: major-fareast; mso-fareast-theme-font: major-fareast; mso-hansi-theme-font: major-fareast;">残念ながら、</span><span style="font-family: &#39;ＭＳ ゴシック&#39;; mso-ascii-theme-font: major-fareast; mso-fareast-theme-font: major-fareast; mso-hansi-theme-font: major-fareast;">2014<span lang="JA">にてこの問題を回避するには</span>IObjectDisplay<span lang="JA">を使用して頂く事となります。</span></span></p>
<p class="MsoNormal"><span lang="JA" style="font-family: &#39;ＭＳ ゴシック&#39;; mso-ascii-theme-font: major-fareast; mso-fareast-theme-font: major-fareast; mso-hansi-theme-font: major-fareast;">尚、</span><span style="font-family: &#39;ＭＳ ゴシック&#39;; mso-ascii-theme-font: major-fareast; mso-fareast-theme-font: major-fareast; mso-hansi-theme-font: major-fareast;">2015<span lang="JA">では</span>IObjectDisplay2<span lang="JA">をご利用頂けます。</span></span></p>
<p class="MsoNormal"><span style="font-family: &#39;ＭＳ ゴシック&#39;; mso-ascii-theme-font: major-fareast; mso-fareast-theme-font: major-fareast; mso-hansi-theme-font: major-fareast;">&#0160;</span></p>
<p class="MsoNormal"><span lang="JA" style="font-family: &#39;ＭＳ ゴシック&#39;; mso-ascii-theme-font: major-fareast; mso-fareast-theme-font: major-fareast; mso-hansi-theme-font: major-fareast;">ご迷惑をお掛け致しますが、宜しくお願い致します。</span></p>
<p class="MsoNormal"><span lang="JA" style="font-family: &#39;ＭＳ ゴシック&#39;; mso-ascii-theme-font: major-fareast; mso-fareast-theme-font: major-fareast; mso-hansi-theme-font: major-fareast;"> <a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01a511c26da8970c-pi" style="display: inline;"><img alt="6a0167607c2431970b01a511b4361c970c-800wi" border="0" class="asset  asset-image at-xid-6a0167607c2431970b01a511c26da8970c image-full img-responsive" src="/assets/image_561293.jpg" title="6a0167607c2431970b01a511b4361c970c-800wi" /></a><br /><br /></span></p>
