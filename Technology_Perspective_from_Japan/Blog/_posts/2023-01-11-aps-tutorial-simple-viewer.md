---
layout: "post"
title: "APS チュートリアル：Simple Viewer"
date: "2023-01-11 00:16:02"
author: "Toshiaki Isezaki"
categories:
  - "API カスタマイズ"
  - "クラウドサービス"
original_url: "https://adndevblog.typepad.com/technology_perspective/2023/01/aps-tutorial-simple-viewer.html "
typepad_basename: "aps-tutorial-simple-viewer"
typepad_status: "Publish"
---

<p>APS 学習サイト、Learn APS Tutorials（<a href="https://tutorials.autodesk.io/" rel="noopener" target="_blank">https://tutorials.autodesk.io/</a>）になって使用するサンプルが更新されていますので、<a href="https://tutorials.autodesk.io/tutorials/simple-viewer/" rel="noopener" target="_blank">Simple Viewer</a>（Node.js）用の GitHub リポジトリ -&#0160;<a href="https://github.com/autodesk-platform-services/aps-simple-viewer-nodejs" rel="noopener" target="_blank">GitHub - autodesk-platform-services/aps-simple-viewer-nodejs: Simple Viewer (Node.js)</a> を題材に、ローカル環境（Windows）にクローンして実行する手順を記しておきたいと思います。</p>
<hr />
<ol>
<li>Web ブラウザで GitHub 上の <strong><a href="https://github.com/autodesk-platform-services/aps-simple-viewer-nodejs" rel="noopener" target="_blank"> Simple Viewer (Node.js)</a> &#0160;</strong>リポジトリ ページを開きます。</li>
<li>画面右側の [Code] ボタンをクリックして、クローン元のリポジトリ URL <strong>https://github.com/autodesk-platform-services/aps-simple-viewer-nodejs.git</strong>&#0160;を<a href="https://ja.wikipedia.org/wiki/%E3%82%AF%E3%83%AA%E3%83%83%E3%83%97%E3%83%9C%E3%83%BC%E3%83%89" rel="noopener noreferrer" target="_blank">クリップボード</a>にコピーしておきます。<br /><a class="asset-img-link" href="https://adndevblog.typepad.com/.a/6a0167607c2431970b02af14aca165200b-pi" style="display: inline;"><img alt="Repo" border="0" class="asset  asset-image at-xid-6a0167607c2431970b02af14aca165200b image-full img-responsive" src="/assets/image_277551.jpg" title="Repo" /></a></li>
<li>リポジトリの内容をクライアント コンピュータにクローン（コピー）します。コマンド プロンプトを起動して、リポジトリ内容をコピーしたいフォルダ（ディレクトリ）に CD コマンドで移動し、<strong>git clone&#0160;&#0160;</strong><strong>https://github.com/autodesk-platform-services/aps-simple-viewer-nodejs.git</strong> （クリップボード内の URL）と入力します。<strong>aps-simple-viewer-nodejs</strong> フォルダが作成されて、GitHub リポジトリからソースコードがコピーされます。<br /><a class="asset-img-link" href="https://adndevblog.typepad.com/.a/6a0167607c2431970b02af148b0904200c-pi" style="display: inline;"><img alt="Clone" border="0" class="asset  asset-image at-xid-6a0167607c2431970b02af148b0904200c image-full img-responsive" src="/assets/image_109725.jpg" title="Clone" /></a></li>
<li>クローンされたプロジェクトに Node.js の実行で必要となるパッケージ（ミドルウェア）をインストールします。CD コマンドで現在のフォルダを <strong>aps-simple-viewer-nodejs</strong> フォルダに移動してから、<strong>npm install</strong>&#0160;と入力します。<br /><a class="asset-img-link" href="https://adndevblog.typepad.com/.a/6a0167607c2431970b02af1c965506200d-pi" style="display: inline;"><img alt="Install" border="0" class="asset  asset-image at-xid-6a0167607c2431970b02af1c965506200d image-full img-responsive" src="/assets/image_892975.jpg" title="Install" /></a></li>
<li>作成するアプリは、システム環境変数、<strong>APS_CLIENT_ID</strong>（使用する Client ID）、<strong>APS_CLIENT_SECRET</strong>（使用する Client Secret）、<strong>APS_BUCKET</strong>（使用する Bucket 名）を取得して利用します。メモ帳などのテキスト エディタとクリップボードを交互に使用（コピー＆ペースト）しながら SET コマンドを実行してみてください。<br /><strong>APS_BUCKET</strong> を指定しない場合は、Client ID に ”-basic-app” が付加された Bucket 名で Bucket が作成されます。いずれの場合も、適用される <a href="https://adndevblog.typepad.com/technology_perspective/2016/07/summary-about-bucket.html" rel="noopener" target="_blank">Bucket ポリシー</a>は temporary です。<br /><img alt="Variables" border="0" class="asset  asset-image at-xid-6a0167607c2431970b02af1c965524200d image-full img-responsive" src="/assets/image_599789.jpg" title="Variables" /><br />
<pre><code>set APS_CLIENT_ID=&lt;&lt;YOUR CLIENT ID&gt;&gt;
set APS_CLIENT_SECRET=&lt;&lt;YOUR CLIENT SECRET&gt;&gt;
set APS_BUCKET=&lt;&lt;YOUR BUCKET NAME&gt;&gt;</code></pre>
</li>
<li>ここまでの手順で実行の準備は完了です。カレント フォルダが <strong>aps-simple-viewer-nodejs </strong>フォルダであることを確認したら、<strong>npm start</strong> と入力して Node.js サーバーを起動します。<br /><a class="asset-img-link" href="https://adndevblog.typepad.com/.a/6a0167607c2431970b02af1c965541200d-pi" style="display: inline;"><img alt="Start" border="0" class="asset  asset-image at-xid-6a0167607c2431970b02af1c965541200d image-full img-responsive" src="/assets/image_761084.jpg" title="Start" /></a></li>
<li>Web ブラウザを起動して、URL の&#0160;<strong>localhost:8080</strong> と入力してリターンすると、ページが表示されるはずです。まだ&#0160;Bucket がない場合には、Viewer 画面上には何も表示されませんが問題ありません。<br /><a class="asset-img-link" href="https://adndevblog.typepad.com/.a/6a0167607c2431970b02af148b095e200c-pi" style="display: inline;"><img alt="Initial" border="0" class="asset  asset-image at-xid-6a0167607c2431970b02af148b095e200c image-full img-responsive" src="/assets/image_121073.jpg" title="Initial" /></a></li>
<li>右上の [Upload] ボタンをクリックして、Viewer に表示したいデザイン ファイルをアップロードします。ファイル ダイアログでファイルを選択して [OK] ボタンをクリックすると、Data Management API によるファイルのアップロードが始まります。<br /><a class="asset-img-link" href="https://adndevblog.typepad.com/.a/6a0167607c2431970b02af148b097b200c-pi" style="display: inline;"><img alt="Uploading" border="0" class="asset  asset-image at-xid-6a0167607c2431970b02af148b097b200c image-full img-responsive" src="/assets/image_756122.jpg" title="Uploading" /></a></li>
<li>ファイルのアップロードが完了すると、右上のドロップダウン リストボックスにアップロードしたファイル名が表示されて、同時に Model Derivative API による SVF 変換が始まります。<br /><a class="asset-img-link" href="https://adndevblog.typepad.com/.a/6a0167607c2431970b02af1c965576200d-pi" style="display: inline;"><img alt="Translating" border="0" class="asset  asset-image at-xid-6a0167607c2431970b02af1c965576200d image-full img-responsive" src="/assets/image_474525.jpg" title="Translating" /></a></li>
<li>SVF 変換が完了すると、アップロードしたファイルの内容が Viewer に表示されるはずです。<br /><a class="asset-img-link" href="https://adndevblog.typepad.com/.a/6a0167607c2431970b02af1c96558d200d-pi" style="display: inline;"><img alt="Vewer" border="0" class="asset  asset-image at-xid-6a0167607c2431970b02af1c96558d200d image-full img-responsive" src="/assets/image_808187.jpg" title="Vewer" /></a><br />複数のファイルを Bucket にアップロード、SVF 変換すると、ドロップダウン リストボックスで表示を切り替えることが出来ます。ドロップダウン リストボックスに Bucket 内のファイルがリストされた場合でも、SVF がない場合（SVF 変換されていない場合）には、切り替え操作をしても Viewer に表示はされません。<br /><a class="asset-img-link" href="https://adndevblog.typepad.com/.a/6a0167607c2431970b02af14aca21f200b-pi" style="display: inline;"><img alt="Switch" border="0" class="asset  asset-image at-xid-6a0167607c2431970b02af14aca21f200b image-full img-responsive" src="/assets/image_309579.jpg" title="Switch" /></a></li>
</ol>
<hr />
<p>このサンプルは、<a href="https://adndevblog.typepad.com/technology_perspective/2022/05/ample-which-shows-bucket-data-using-2-legged-oauth.html" rel="noopener" target="_blank">2-Legged OAuth で Bucket データを表示するサンプル</a>でご紹介した <a data-pjax="#repo-content-pjax-container" href="https://github.com/Autodesk-Forge/learn.forge.viewmodels" rel="noopener" target="_blank">learn.forge.viewmodels</a> サンプル の内容とは少し異なりますが、2-legged OAuth を使ってアクセストークンを取得後、Bucket へのデザイン ファイルのアップロードと SVF 変換、Viewer への表示の手順を理解する上では同じシナリオを持ちます。</p>
<p>2-legged OAuth を使った Viewer への表示プロセスは、<a href="https://adndevblog.typepad.com/technology_perspective/2016/09/understanding-steps-to-use-viewer-on-postman.html" rel="noopener" target="_blank">Postman による Viewer 利用手順の理解 - 2 legged 認証</a>&#0160;や <a href="https://adndevblog.typepad.com/technology_perspective/2020/09/viewer-workflow-on-vs-code-forge-extension.html">VS Code Forge Extension を使った Viewer ワークフローの確認</a>&#0160;でも把握いただけます。</p>
<p>By Toshiaki Isezaki</p>
