---
layout: "post"
title: "Inventor製品のファイル検索順序について"
date: "2015-01-26 01:00:00"
author: "Shigelazu Saitou"
categories:
  - "API カスタマイズ"
  - "デスクトップ製品"
original_url: "https://adndevblog.typepad.com/technology_perspective/2015/01/inventor_file_search.html "
typepad_basename: "inventor_file_search"
typepad_status: "Publish"
---

<p>Inventor製品ではファイルを探し出すための検索順序が、普段私たちが使っているWindowsのOSの検索動作の順序とは異なります。</p>

<p>Inventor製品においては、以前「<a href="http://adndevblog.typepad.com/technology_perspective/2015/01/inventor_ProjectFile.html">Inventor製品のプロジェクトファイルについて</a>」で触れております、プロジェクトファイルの各パス設定も重要になります。</p>

<p>OS側の検索順序は、まず自身のフォルダ内のファイルを最初に検索して見つからなかった場合に限り、他の指定フォルダ（パス）に記述されている文字列群に対し、左より（；）セミコロン で区切られた文字列をフォルダパスとして順に検索する動作です。</p>

<p>一方、Inventor製品は、アクティブ プロジェクトに定義されているオプションとファイルの保存場所を使用して、参照ファイルを自動的に検索します。</p>

<p>Inventorファイルにはライブラリまたは非ライブラリのファイルのいずれかの参照情報が保存されており、「ライブラリ参照」と「非ライブラリ参照」に含まれている情報は以下の内容です。</p>

<p><strong>＜ライブラリ参照＞</strong><br />
ライブラリ名<br />
ファイル名<br />
サブフォルダの位置(存在する場合)<br />
<strong><br />
＜非ライブラリ参照＞</strong><br />
ファイル名<br />
サブフォルダの位置(存在する場合)</p>

<p>Inventorファイルを開くとAutodesk Inventor は、次の順序でコンポーネントを検索します。</p>

<p>ライブラリ検索パス(ライブラリ パーツがロードされている場合)。<br />
それ以外の場合は、ライブラリ パスは検索されません。</p>

<p>作業スペース<br />
作業グループ検索パス<br />
プロジェクト ファイルのあるフォルダ</p>

<p>Inventorはファイル検索のための独自のルールを持っており、概要からはまずライブラリやワークスペースのホルダー、次にプロジェクトで設定されたホルダー、最後に自身のホルダーを見に行くといった順序になっています。</p>

<p>Inventor製品はファイルが見つからない時の為に、自動解決用のファイルの検索プロセスのルールを持っており、設計を始められる前にプロジェクトファイルの設定の検討をされたり、他の環境で作成されたInventorファイルのやり取りを計画される場合や、APIでファイルの構築や配置されたコンポーネントのハンドリングする際に、構成されるファイルが見つからずに、[リンクを解決]ダイアログ ボックスなどが出現する事の無いように、この検索ルール（メカニズム）を頭の片隅にでも留め置いていただければ幸いです。</p>

<p><br />
１．API のイベントを介して完全な参照情報が取得されます。通常の Autodesk Inventor の動作の代わりに、PDM システムなどの関連のアドイン アプリケーションを使用することもできます。</p>

<p>２．参照にライブラリ名が保存されているか、ソース ファイルをライブラリの場所から開いた場合には、そのライブラリ名に関連付けられたプロジェクトの場所だけが検索されます。<br />
ライブラリ フォルダの検索でライブラリ名を使用する方法は、次の 3 つの条件によって異なります。</p>

<p>    (2-1). ソース ファイルがライブラリにないが、参照がライブラリ名を保持している。この場合には、参照のライブラリ名と一致する、プロジェクトのライブラリ位置が検索されます。<br />
    (2-2). 参照が非ライブラリ参照で、ライブラリ名の情報は空だが、ソース ファイルがライブラリの場所にある。この場合には、ソース ファイルを含むライブラリの場所が検索されます。<br />
    (2-3). 参照がライブラリ参照で、ソース ファイルがライブラリの場所にある。システムは複合的なライブラリ名の候補リストを生成し、プロジェクト内のライブラリ名のうち、一致するライブラリ名を長いものから順に検索します。</p>

<p>３．非ライブラリ参照では、作業スペース、作業グループ検索パスの各フォルダの順に検索が実行されます。作業グループ フォルダは、プロジェクト エディタにリストされている順に検索されます。</p>

<p>４．ライブラリ参照と非ライブラリ参照のいずれの場合も、上記の規則で検出されない場合には、ソース ファイルの格納場所のフォルダが検索されます。</p>

<p>５．それでも参照が見つからない場合は、[リンクを解決]ダイアログ ボックスに以前(同じ Autodesk Inventor セッションで)定義した方法が置き換え規則として適用され、検索プロセスが再度実行されます。同じ置き換え規則を使用して 1 つまたは複数の他の未解決の参照を検索できます。<br />
以下の場合には、置き換え規則を適用します。</p>

<p>    (5-1). あるライブラリのファイル セットあるいはフォルダ全体を別のライブラリに移動したり、作業グループ、別の編集フォルダまたはライブラリ フォルダ間で移動した場合。<br />
    (5-2). プロジェクト フォルダ内でサブフォルダの追加または削除を行ったり、ファイルに最も影響のあるプロジェクト フォルダのサブフォルダ パスを変更した場合。<br />
    (5-3). ファイル セットをプロジェクト フォルダからプロジェクト外のフォルダに移動した場合。</p>

<p>６．それでもファイルが見つからない場合、システムは、参照元ファイルを前回保存した時に参照先ファイルがあった位置への完全修飾の絶対パスをチェックします。ファイルがその場所で検出され、その場所がプロジェクトの場所のいずれかに含まれている場合、参照情報は自動的に再計算され、すなわち逆解決されます。次回以降使用するために、ソース ファイルは要保存とマークされ、参照が解決されます。</p>

<p>７．PDM ベンダには、Autodesk Inventor で実行したプロセスを引き継いだり、さらにプロセスを追加したりと、ファイルの解決を行う機会が再び提供されます。</p>

<p>８．以前に別のファイル名のファイルを手動で選択して解決した場合、全く同一の参照には、同じ置き換えが適用されます。</p>

<p><br />
一見すると複雑な検索動作に見えますが、Inventor製品はプロジェクトファイルを中心に自動的にファイルを検索している事がご理解いただけると思いますし、参照元ファイルの前回保存した時の参照ファイルがあった位置までもチェックしてくれて、参照情報を自動的に再計算して解決するなんていう離れ業の検索メカニズムを持っている事を知っている方は少ないのではないでしょうか。</p>

<p>By Shigekazu Saito<br />
</p>
