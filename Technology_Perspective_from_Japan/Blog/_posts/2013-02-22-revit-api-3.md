---
layout: "post"
title: "Revit API 入門 その３"
date: "2013-02-22 23:17:38"
author: "Mikako Harada"
categories:
  - "API カスタマイズ"
  - "デスクトップ製品"
original_url: "https://adndevblog.typepad.com/technology_perspective/2013/02/revit-api-%E5%85%A5%E9%96%80-%E3%81%9D%E3%81%AE%EF%BC%93.html "
typepad_basename: "revit-api-入門-その３"
typepad_status: "Publish"
---

<p>Revit API のトレーニングをする際など、これからAdd-inを作成しようとしている方に対して、私が必ずお勧めするいくつかのツールがあります。以下がそれらです：</p>
<ul>
<li>Revit Lookup</li>
<li>Add-In Manager</li>
<li>RevitAPIDllsPathUpdater.exe&#0160;</li>
<li>SDKSamples2013.sln</li>
<li>RvtSamples</li>
</ul>
<p>今日は、これらのうち、最初の2つについて説明したいと思います。</p>
<p>その前に、まだ、外部コマンドで Hello World を作成した経験がない方は、まずは、<a href="http://adndevblog.typepad.com/technology_perspective/2013/02/revit-api%E5%85%A5%E9%96%80-%E3%81%9D%E3%81%AE%EF%BC%92.html" target="_self" title="Revit API Intro Part 2 ">前回</a>お話した、Wiki Help やトレーニングの教材を見ていただき、最小のRevit の外部コマンドを作成してみてください。（まだ、これからというかたは、例えば、Wiki Helpにある、Hello World <a href="http://wikihelp.autodesk.com/Revit/enu/2013/Help/00006-API_Developer&#39;s_Guide/0001-Introduc1/0012-Getting_12/0014-Walkthro14" target="_self" title="Hello World C#">C#</a> あるいは<a href="http://wikihelp.autodesk.com/Revit/enu/2013/Help/00006-API_Developer&#39;s_Guide/0170-Appendic170/0190-Hello_Wo190" target="_self" title="Hello World VB.NET">VB.NET</a>の例をみて試していただくとよいでしょう。）それによって、RevitAPI.dll やRevitAPIUI.dll、.NETのクラスライブラリ、.addin マニフェストの意味を理解していただき、そのあと、ここでお話しするツールを見ていただくと、ツールのインストール方法もわかるはずです。</p>
<p><strong>Revit Lookup </strong></p>
<p>Revitのデータベース構造を&quot;のぞき見&quot;することができるツールです。ツールそのものがRevit APIで書かれてあるので、もしも、Revit Lookupで内部データを確認できるようであれば、APIでアクセスすることが可能です。学習用としてもデバッグ用としても、Revit APIのプログラマのためのなくてはならないツールです。このツールはRevit SDKのRevitLookupフォルダにあります。C#で書かれたプロジェクトです。Hello Worldと同様の方法で、RevitAPI.dll、RevitAPIUI.dllを参照、ビルドし、.addinマニフェストを実際のDllのロケーションに合わせて修正し、Revitにセットアップします。</p>
<p>以下にLookupツールのメニューと壁要素をひとつ選択した例をとって、Revit Lookupで内部データを見た例を示します。</p>
<p>Revit Lookupのメニュー：</p>
<p>　　　　　　　　　<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017c370b3f6c970b-pi" style="display: inline;"><img alt="RevitLookup menu" border="0" class="asset  asset-image at-xid-6a0167607c2431970b017c370b3f6c970b" src="/assets/image_498973.jpg" title="RevitLookup menu" /></a>　</p>
<p><br />壁要素を選択した例：</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017ee8ae6ca8970d-pi" style="display: inline;"><img alt="RevitLookup wall" border="0" class="asset  asset-image at-xid-6a0167607c2431970b017ee8ae6ca8970d image-full" src="/assets/image_309304.jpg" title="RevitLookup wall" /></a></p>
<p>太字で表示されている部分をクリックすると、さらに深くそのデータを「掘り込んで」いくことができます。以下が、Parameters をさらに詳しく見ていった例です：</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017c370b4759970b-pi" style="display: inline;"><img alt="RevitLookup wall param" border="0" class="asset  asset-image at-xid-6a0167607c2431970b017c370b4759970b image-full" src="/assets/image_116331.jpg" title="RevitLookup wall param" /></a></p>
<p><strong>&#0160;</strong></p>
<p><strong>Add-in Manager </strong></p>
<p>Revit APIで開発を始めたばかりの方がよく言われるのは、「.addinマニフェストを作成するのが面倒」ということです。確かにAutoCADですと、NETLOAD コマンドで、ロードでき、わざわざ、マニフェストファイルを作成する必要がありません。AutoCADでなれていらっしゃる方は特にそう思われるかもしれません。</p>
<p>あと、もうひとつはアンロードの問題です。これはAutoCADでも同じですが、.NET のアップリーケーションはアンロードが簡単にできないようになっています。これはマイクロソフトの仕様です。コードをビルド、Revitを立ち上げ、デバッグ。再度コードを修正してテストをしなおすとなると、再度Revitを立ち上げるとこになりますが、これが意外と時間がかかってしまうので、Revitを再起動しないでDebugを繰り返す方法はないのかという質問をよく受けます。</p>
<p>Add-In Manager はそういった要望のあるかたに便利なツールです。アドインをマニフェストで登録せずにコマンドを実行することができ、またRevitを実行している間に、DLLをアンロードロードすることが可能です。（ただし、Revitがすでにたちあがっているため、Revitのスタートアップで何かをするといったようなアプリケーションのデバッグは当然Revitを再度立ち上げる必要があります。）</p>
<p>このツールはRevit Lookup ツールと同じくSDKのAdd-In Managerフォルダにあります。MSIとして用意されていますので、単にダブルクリックしてインストーﾙするだけです。ソースコードは提供されていません。インストールすると、以下のようなメニューが外部ツールボタンに追加されます：</p>
<p>　　　　　<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017c370b5cc1970b-pi" style="display: inline;"><img alt="Addin Manager" border="0" class="asset  asset-image at-xid-6a0167607c2431970b017c370b5cc1970b" src="/assets/image_977955.jpg" title="Addin Manager" /></a><br />コマンドのトランザクションモードの種類によってマニュアル、読み込み専用、自動が用意されています。作成しているコマンドのモードに応じてそれらから選択します。Facelessの意味はUIなしで、前回使用したコマンドが実行されます。以下にダイアログの使用例を示します：</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017ee8ae8bbe970d-pi" style="display: inline;"><img alt="Addin Manager dialog" border="0" class="asset  asset-image at-xid-6a0167607c2431970b017ee8ae8bbe970d" src="/assets/image_507479.jpg" title="Addin Manager dialog" /></a></p>
<p>私もサポートの際によく使用します。ぜひ試してみてください。</p>
<p>原田</p>
