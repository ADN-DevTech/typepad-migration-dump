---
layout: "post"
title: "2-Legged OAuth で Bucket データを表示するサンプル"
date: "2022-05-02 00:03:47"
author: "Toshiaki Isezaki"
categories:
  - "API カスタマイズ"
  - "クラウドサービス"
original_url: "https://adndevblog.typepad.com/technology_perspective/2022/05/ample-which-shows-bucket-data-using-2-legged-oauth.html "
typepad_basename: "ample-which-shows-bucket-data-using-2-legged-oauth"
typepad_status: "Publish"
---

<p>Forge の学習サイト、<strong><a href="http://learnforge.autodesk.io/" rel="noopener" target="_blank">Learn Autodesk Forge</a></strong> には、2-Legged OAuth を利用して Bucket 内に保存したデザイン データの表示を説明する <a href="https://learnforge.autodesk.io/#/tutorials/viewmodels" rel="noopener" target="_blank">View your models</a> があります。手順に沿って実装していくことが出来ますが、GitHub リポジトリにも、ほぼ同じサンプルが記載されています。<strong class="mr-2 flex-self-stretch"><a data-pjax="#repo-content-pjax-container" href="https://github.com/Autodesk-Forge/learn.forge.viewmodels" rel="noopener" target="_blank">learn.forge.viewmodels</a>&#0160;</strong>サンプルです。ここでは、このサンプルをローカル Node.js 開発環境にクローンし、セットアップ、テストしていく手順をご案内します。</p>
<p>リポジトリの内容からローカルでテストするには、事前に Git for Windows や Node.js をセットアップしておく必要があります。また、実行時には Forge で利用する Client ID と Client Secret（Consumer Key と Consumer Secret）を事前に <strong><a href="https://forge.autodesk.com/" rel="noopener noreferrer" target="_blank">Forge ポータル</a></strong>&#0160;から取得しておく必要があります。これらの手順は、それぞれ、次のブログ記事でご案内しています。</p>
<p style="padding-left: 40px;"><strong><a href="https://adndevblog.typepad.com/technology_perspective/2017/01/development-environment-for-forge.html" rel="noopener noreferrer" target="_blank">Forge の開発環境</a></strong></p>
<p style="padding-left: 40px;"><strong><a href="https://adndevblog.typepad.com/technology_perspective/2016/07/app-registration-and-getting-keys-for-forge-api.html" rel="noopener noreferrer" target="_blank">Forge API を利用するアプリの登録とキーの取得</a></strong></p>
<p><a class="asset-img-link" href="https://adndevblog.typepad.com/.a/6a0167607c2431970b0282e152e26f200b-pi" style="display: inline;"><img alt="App_settings" border="0" class="asset  asset-image at-xid-6a0167607c2431970b0282e152e26f200b image-full img-responsive" src="/assets/image_333179.jpg" title="App_settings" /></a></p>
<hr />
<ol>
<li>Web ブラウザで GitHub 上の <strong class="mr-2 flex-self-stretch"><a data-pjax="#repo-content-pjax-container" href="https://github.com/Autodesk-Forge/learn.forge.viewmodels" rel="noopener" target="_blank">learn.forge.viewmodels</a></strong><strong>&#0160;</strong>リポジトリ ページを開きます。</li>
<li>画面右側の [Clone or download] ボタンをクリックして、表示される URL <strong>https://github.com/Autodesk-Forge/learn.forge.viewmodels.git</strong>&#0160;を<a href="https://ja.wikipedia.org/wiki/%E3%82%AF%E3%83%AA%E3%83%83%E3%83%97%E3%83%9C%E3%83%BC%E3%83%89" rel="noopener noreferrer" target="_blank">クリップボード</a>にコピーしておきます。<br /><a class="asset-img-link" href="https://adndevblog.typepad.com/.a/6a0167607c2431970b0278807a51c9200d-pi" style="display: inline;"><img alt="Copy_url" border="0" class="asset  asset-image at-xid-6a0167607c2431970b0278807a51c9200d image-full img-responsive" src="/assets/image_270704.jpg" title="Copy_url" /></a></li>
<li>GitHub 上のプロジェクトを 、リポジトリから開発に使用するクライアント コンピュータにコピーします。コマンド プロンプトを起動して、リポジトリ内容をコピーしたいフォルダ（ディレクトリ）に CD コマンドで移動し、<strong>git clone -b nodejs https://github.com/Autodesk-Forge/learn.forge.viewmodels.git</strong> （クリップボード内の URL）と入力します。例えば、C:\Users\&lt;Windows ログイン ユーザ名&gt;\Desktop\GitHub フォルダに移動して <strong>git clone -b nodejs https://github.com/Autodesk-Forge/learn.forge.viewmodels.git</strong> を実行すると、C:\Users\&lt;Windows ログイン ユーザ名&gt;\Documents\GitHub フォルダ下に&#0160; learn.forge.viewmodels フォルダが作成され、GitHub リポジトリからソースコードがコピーされます。<br /><a class="asset-img-link" href="https://adndevblog.typepad.com/.a/6a0167607c2431970b0282e152e2fa200b-pi" style="display: inline;"><img alt="Clone_repo" border="0" class="asset  asset-image at-xid-6a0167607c2431970b0282e152e2fa200b image-full img-responsive" src="/assets/image_106752.jpg" title="Clone_repo" /></a></li>
<li>クローン（コピー）されたプロジェクトに Node.js の実行で必要となるパッケージ（ミドルウェア）をインストールします。CD コマンドで現在のフォルダを learn.forge.viewmodels フォルダへ移動してから、<strong>npm install</strong>&#0160;と入力します。<br /><a class="asset-img-link" href="https://adndevblog.typepad.com/.a/6a0167607c2431970b0282e152e312200b-pi" style="display: inline;"><img alt="Npm_install" border="0" class="asset  asset-image at-xid-6a0167607c2431970b0282e152e312200b image-full img-responsive" src="/assets/image_891153.jpg" title="Npm_install" /></a></li>
<li>このサンプルでは、実行時にシステム環境変数から Client ID と Client Secret、CallBack URL を取得します。コマンド プロンプト上で SET コマンドを使って環境変数を指定します。作成したアプリから Client ID、Client Secret を読み取り、それぞれ、システム環境変数、FORGE_CLIENT_ID、FORGE_CLIENT_SECRET を設定します。クリップボードとメモ帳などを利用してコピー＆ペーストしながら SET コマンドを実行してみてください。<br />
<pre><code>set FORGE_CLIENT_ID=&lt;&lt;YOUR CLIENT ID FROM DEVELOPER PORTAL&gt;&gt;
set FORGE_CLIENT_SECRET=&lt;&lt;YOUR CLIENT SECRET&gt;&gt;</code></pre>
<a class="asset-img-link" href="https://adndevblog.typepad.com/.a/6a0167607c2431970b0282e152e350200b-pi" style="display: inline;"><img alt="Set_system_environment_environment" border="0" class="asset  asset-image at-xid-6a0167607c2431970b0282e152e350200b image-full img-responsive" src="/assets/image_719126.jpg" title="Set_system_environment_environment" /></a></li>
<li>ここまでの手順で実行の準備は完了です。カレント フォルダが learn.forge.viewmodels フォルダであることを確認したら、<strong>npm start</strong> と入力、リターンキーを押して Node.js サーバーを起動します。<br /><a class="asset-img-link" href="https://adndevblog.typepad.com/.a/6a0167607c2431970b022ad3bd2b98200d-pi" style="display: inline;"> </a><a class="asset-img-link" href="https://adndevblog.typepad.com/.a/6a0167607c2431970b0282e152e35c200b-pi" style="display: inline;"><img alt="Npm_start" border="0" class="asset  asset-image at-xid-6a0167607c2431970b0282e152e35c200b image-full img-responsive" src="/assets/image_86186.jpg" title="Npm_start" /></a><a class="asset-img-link" href="https://adndevblog.typepad.com/.a/6a0167607c2431970b022ad3bd2b98200d-pi" style="display: inline;"></a></li>
<li>Web ブラウザを起動して、URL の <strong>localhost:3000</strong> と入力してリターンすると、ページ左上に [New bucket] ボタンが表示されるはずです。<br /><a class="asset-img-link" href="https://adndevblog.typepad.com/.a/6a0167607c2431970b0282e152e3a6200b-pi" style="display: inline;"><img alt="Localhost_3000" border="0" class="asset  asset-image at-xid-6a0167607c2431970b0282e152e3a6200b image-full img-responsive" src="/assets/image_589582.jpg" title="Localhost_3000" /></a></li>
<li>[New bucket] ボタンをクリックして、作成したい Bucket 名を入力後、[Go ahead、create the bucket] ボタンをクリックいてください。<br /><a class="asset-img-link" href="https://adndevblog.typepad.com/.a/6a0167607c2431970b0278807a528e200d-pi" style="display: inline;"><img alt="New_bucket" border="0" class="asset  asset-image at-xid-6a0167607c2431970b0278807a528e200d image-full img-responsive" src="/assets/image_636249.jpg" title="New_bucket" /></a></li>
<li>入力した Bucket 名が画面左に表示されます。<br />※ 実際には Bucket 名の重複を避けるため、<strong>Client ID </strong>＋ &quot;<strong>-</strong>&quot; ＋ <strong>入力した名前</strong> の Bucket が作成されます。</li>
<li>Bucket 名を右クリックして、[Upload File] をクリックして Bucket にアップロードするファイルを選択します。<br /><a class="asset-img-link" href="https://adndevblog.typepad.com/.a/6a0167607c2431970b02942fa80ce3200c-pi" style="display: inline;"><img alt="Upload" border="0" class="asset  asset-image at-xid-6a0167607c2431970b02942fa80ce3200c image-full img-responsive" src="/assets/image_82975.jpg" title="Upload" /></a></li>
<li>アップロードが完了すると、Bucket のフォルダアイコン左側に ▷ 記号が表示されます。<br /><a class="asset-img-link" href="https://adndevblog.typepad.com/.a/6a0167607c2431970b02942fa80d1f200c-pi" style="display: inline;"><img alt="Uploaded" border="0" class="asset  asset-image at-xid-6a0167607c2431970b02942fa80d1f200c img-responsive" src="/assets/image_66174.jpg" title="Uploaded" /></a><br />この記号をクリックすると、Bucekt の配下にアップロードしたファイル（Object）が表示されます。<br /><a class="asset-img-link" href="https://adndevblog.typepad.com/.a/6a0167607c2431970b02942fa80d34200c-pi" style="display: inline;"><img alt="Object" border="0" class="asset  asset-image at-xid-6a0167607c2431970b02942fa80d34200c image-full img-responsive" src="/assets/image_165733.jpg" title="Object" /></a></li>
<li>ファイル名を右クリックすると、SVF 変換を実行するための [Translate] が表示されるので、ここでクリックします。<br /><a class="asset-img-link" href="https://adndevblog.typepad.com/.a/6a0167607c2431970b0282e152e572200b-pi" style="display: inline;"><img alt="Translate" border="0" class="asset  asset-image at-xid-6a0167607c2431970b0282e152e572200b image-full img-responsive" src="/assets/image_145398.jpg" title="Translate" /></a></li>
<li>一定の後、ファイル名をクリックすると、画面右に変換された 3D モデル、または 2D 図面が表示されます。<br /><a class="asset-img-link" href="https://adndevblog.typepad.com/.a/6a0167607c2431970b0282e152e590200b-pi" style="display: inline;"><img alt="Viewing" border="0" class="asset  asset-image at-xid-6a0167607c2431970b0282e152e590200b image-full img-responsive" src="/assets/image_996197.jpg" title="Viewing" /></a></li>
</ol>
<hr />
<p>作成した Bucket やアップロードしたファイルは、<a href="https://adndevblog.typepad.com/technology_perspective/2020/09/viewer-workflow-on-vs-code-forge-extension.html" rel="noopener" target="_blank"><strong>Forge VS Code Forge Extension を使った Viewer ワークフローの確認</strong></a> の方法で確認することが出来ます。（同じ Client ID と Client Secret の使用が前提）をご参照ください。</p>
<p>By Toshiaki Isezaki</p>
