---
layout: "post"
title: "Fusion 360 API と Data Management API の関係"
date: "2017-06-26 00:41:17"
author: "Toshiaki Isezaki"
categories:
  - "API カスタマイズ"
  - "クラウドサービス"
original_url: "https://adndevblog.typepad.com/technology_perspective/2017/06/relationship-between-fusion-360-api-and-data-management-api.html "
typepad_basename: "relationship-between-fusion-360-api-and-data-management-api"
typepad_status: "Publish"
---

<p>Fusion 36 <a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01bb09a90939970d-pi" style="float: right;"><img alt="Fusion Storage" border="0" class="asset  asset-image at-xid-6a0167607c2431970b01bb09a90939970d img-responsive" src="/assets/image_532553.jpg" style="margin: 0px 0px 5px 5px;" title="Fusion Storage" /></a>0 にはクライアント側で利用できる API が用意されていて、用途に応じて C++、Python、JavaScript を使ってスクリプトやアドインを作成して、Fusion 360 にロードして利用すことが出来ます。<strong><a href="http://adndevblog.typepad.com/technology_perspective/2015/10/fusion-360-api-overview.html" rel="noopener noreferrer" target="_blank">Fusion 360 API</a></strong> はモデリング機能を中心に実装が進んでいますが、データパネルに表示される内容、つまり、クラウド ストレージの内容へアクセス API も用意されています。</p>
<p><strong><a href="http://adndevblog.typepad.com/technology_perspective/2017/06/cloud-storage-for-fusion-360.html" rel="noopener noreferrer" target="_blank">Fusion 360 のクラウド ストレージ</a></strong> のブログ記事では、３-legged 認証でクラウド ストレージ領域の所有者であるユーザにアクセス許可を得ることが出来れば、Forge を使ったアプリもクラウド ストレージいアクセスが可能でることをご紹介しました。ただし、Fusion 360 API を使ってクラウド ストレージにアクセスする場合には、少し状況が異なります。Fusion 360 利用時にはユーザ アカウントでサインインすることが必須なので、Fusion 360 クライアント内でスクリプトやアドインとして実行される Fusion 360 API はユーザとしてクラウド ストレージにアクセスすることが可能です。Forge の Authentication API や Data Management API を使った処理は必要ありません。</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d27f4f7a970c-pi" style="display: inline;"><img alt="Fusion_360_datapanel" border="0" class="asset  asset-image at-xid-6a0167607c2431970b01b8d27f4f7a970c image-full img-responsive" src="/assets/image_273759.jpg" title="Fusion_360_datapanel" /></a></p>
<p>&#0160;Fusion 360 API で用意される <strong><a href="http://help.autodesk.com/view/fusion360/ENU/?guid=GUID-fa48f86c-bbdb-4566-af28-d70680bb2ec6" rel="noopener noreferrer" target="_blank">Data オブジェクト</a></strong> を利用すると、データパネルからデザイン ファイルを開いたり、編集中のデザイン ファイルを名前を付けて保存したり出来るほか、新規にデザインを作成するような処理も実装可能です。それぞれの情報は、下記のオンライン ヘルプ記事（英語）で紹介されています。</p>
<p style="padding-left: 30px;"><strong>Documents.open メソッド：<a href="http://help.autodesk.com/view/fusion360/ENU/?guid=GUID-879042c8-f064-4b31-927a-4b6a67134936" rel="noopener noreferrer" target="_blank">http://help.autodesk.com/view/fusion360/ENU/?guid=GUID-879042c8-f064-4b31-927a-4b6a67134936</a></strong></p>
<p style="padding-left: 30px;"><strong>Documents.add メソッド：<a href="http://help.autodesk.com/view/fusion360/ENU/?guid=GUID-2314d09a-c595-4f9a-ab8b-3e302dc5d860" rel="noopener noreferrer" target="_blank">http://help.autodesk.com/view/fusion360/ENU/?guid=GUID-2314d09a-c595-4f9a-ab8b-3e302dc5d860</a></strong></p>
<p style="padding-left: 30px;"><strong>Document.saveAs メソッド：<a href="http://help.autodesk.com/view/fusion360/ENU/?guid=GUID-7b292219-62fa-4a01-b522-2a1a297edb28" rel="noopener noreferrer" target="_blank">http://help.autodesk.com/view/fusion360/ENU/?guid=GUID-7b292219-62fa-4a01-b522-2a1a297edb28</a></strong></p>
<p>クラウド ストレージとは直接関係しませんが、Fusion 360 API では、Fusion 360 自身が提供するローカル トランスレータでデザイン ファイル形式を変換する処理を自動化することも出来ます。ブログ記事 <strong><a href="http://adndevblog.typepad.com/technology_perspective/2017/05/translatable-file-format-with-model-derivative-api-and-role.html " rel="noopener noreferrer" target="_blank">Model Derivative API の役割と変換可能なファイル形式</a></strong>&#0160;をご存じの方は、データ変換というと Forge では Model Derivative API を連想しがちですが、前述のとおり、Fusion 360 API &#0160;は Fusion 360 クライアント内でローカルに実装されることになるため、Model Derivative API に頼ることなく、そのまま Fusion 360 の機能を利用することが出来ます。</p>
<p>変換機能を用いたデザイン ファイルのエクスポートには <strong><a href="http://help.autodesk.com/view/fusion360/ENU/?guid=GUID-bb9ca64f-0fc0-43a8-a381-076bded65744" rel="noopener noreferrer" target="_blank">ExportManager オブジェクト</a>&#0160;</strong>を利用します。ExportManager オブジェクトを利用したサンプルは、次のオンライン ヘルプ記事（英語）で紹介されています。</p>
<p style="padding-left: 30px;"><strong>Export to other formats API Sample：<a href="http://help.autodesk.com/view/fusion360/ENU/?guid=GUID-d1462fe6-fd43-11e4-b6b4-f8b156d7cd97" rel="noopener noreferrer" target="_blank">http://help.autodesk.com/view/fusion360/ENU/?guid=GUID-d1462fe6-fd43-11e4-b6b4-f8b156d7cd97</a></strong></p>
<p style="padding-left: 30px;"><strong>ExportManager API Sample：<a href="http://help.autodesk.com/view/fusion360/ENU/?guid=GUID-B801DDA8-9A0C-42AD-AC06-F8244CA08D65" rel="noopener noreferrer" target="_blank">http://help.autodesk.com/view/fusion360/ENU/?guid=GUID-B801DDA8-9A0C-42AD-AC06-F8244CA08D65</a></strong></p>
<p style="padding-left: 30px;"><strong>STLExport API Sample：<a href="http://help.autodesk.com/view/fusion360/ENU/?guid=GUID-ECA8A484-7EDD-427D-B1E3-BD59A646F4FA" rel="noopener noreferrer" target="_blank">http://help.autodesk.com/view/fusion360/ENU/?guid=GUID-ECA8A484-7EDD-427D-B1E3-BD59A646F4FA</a></strong></p>
<p>同じくデザイン ファイルのインポートには <strong><a href="http://help.autodesk.com/view/fusion360/ENU/?guid=GUID-DA509909-1E13-48F1-8235-744BA6B94CBA" rel="noopener noreferrer" target="_blank">ImportManager オブジェクト</a></strong>&#0160;&#0160;を利用します。ImportManager オブジェクトを利用したサンプルは、次のオンライン ヘルプ記事（英語）で紹介されています。</p>
<p style="padding-left: 30px;"><strong>Import Manager API Sample：<a href="http://help.autodesk.com/view/fusion360/ENU/?guid=GUID-3f24e9e8-422d-11e5-937b-f8b156d7cd97" rel="noopener noreferrer" target="_blank">http://help.autodesk.com/view/fusion360/ENU/?guid=GUID-3f24e9e8-422d-11e5-937b-f8b156d7cd97</a></strong></p>
<p>このように、Fusion 360 API でもある程度、データパネルに表示されるクラウド ストレージ情報を得たり、デザイン ファイルの基本操作を自動化することが可能です。ただ、場合によっては Data Management API と連携して外部アプリ側でデザイン ファイルのサムネイル画像をダウンロードしたり、デザイン ファイルのマニフェスト情報を取得する必要が出てくる可能性もあります。</p>
<p>そのような場面では、最初から Forge の Data Management API や Model Derivative API にアクセスするのではなく、Fusion 360 API 側で当該ファイルの ID（ドキュメントID ＝ URN）を取得して、Forge 使用時に利用することも出来ます。</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01bb099820f8970d-pi" style="display: inline;"><img alt="Data_managment_api" border="0" class="asset  asset-image at-xid-6a0167607c2431970b01bb099820f8970d image-full img-responsive" src="/assets/image_259530.jpg" title="Data_managment_api" /></a></p>
<p>次の JavaScript コードは、現在 Fusion 360 にサインインしているユーザ アカウント配下にある Hub、Project、Folder、Item の情報を取得するスクリプトです。 プロジェクト配下の情報が多いと、処理に時間がかかるので注意が必要です。</p>
<pre>function run(context) {<br /><br />  &quot;use strict&quot;;<br />  if (adsk.debug === true) {<br />    /*jslint debug: true*/<br />    debugger;<br />  /*jslint debug: false*/<br />  }<br /> <br />  var ui;<br />  try {<br />    var app = adsk.core.Application.get();<br />    ui = app.userInterface;<br /> <br />    var hub = app.data.activeHub;<br /> <br />    var summary;<br />    summary = &quot;\nActive Hub = &quot; + hub.name;<br />    //summary += &quot;\nHub.id = &quot; + hub.id;<br /><br />    var projects, project;<br />    var folders, folder;<br />    var files, file;<br /> <br />    projects = hub.dataProjects;<br />    for(var index=0 ; index&lt;projects.count ; index++)<br />    {<br />      project = projects.item(index);<br />      summary += &quot;\n\nProject = &quot; + project.name;<br />      //summary += &quot;\nProject.id = &quot; + project.id;<br /> <br />      folder = project.rootFolder;<br />      summary += &quot;\n\n\tRoot Folder = &quot; + folder.name;<br />      summary += &quot;\n\tRoot Folder.id = &quot; + folder.id;<br />      files = folder.dataFiles;<br />      for(index=0 ; index&lt;files.count ; index++)<br />      {<br />        file = files.item(index);<br />        summary += &quot;\n\n\t\tFile = &quot; + file.name;<br />        summary += &quot;\n\t\tFile.id = &quot; + file.id;<br />      } <br />      folders = project.rootFolder.dataFolders;<br />      for(index=0 ; index&lt;folders.count ; index++)<br />      {<br />        folder = folders.item(index);<br />        summary += &quot;\n\n\t\tFolder = &quot; + folder.name;<br />        summary += &quot;\n\t\tFolder.id = &quot; + folder.id;<br />        files = folder.dataFiles;<br />        for(index=0 ; index&lt;files.count ; index++)<br />        {<br />          file = files.item(index);<br />          summary += &quot;\n\n\t\t\tFile = &quot; + file.name;<br />          summary += &quot;\n\t\t\tFile.id = &quot; + file.id;<br />        } <br />      }<br />    }<br /> <br />    ui.messageBox(summary); <br />    console.log(summary);<br />  } <br />  catch (e) {<br />    if (ui) {<br />      ui.messageBox(&#39;Failed : &#39; + (e.description ? e.description : e));<br />    }<br />     console.log(&#39;Failed : &#39; + (e.description ? e.description : e));<br />  }<br /><br />  adsk.terminate(); </pre>
<p>次の Python コードは、 上記 JavaScript と同様の内容を実装する スクリプトとなります。&#0160;</p>
<pre>import adsk.core, adsk.fusion, adsk.cam, traceback<br /><br />def run(context):<br />  ui = None<br />  try:<br />    app = adsk.core.Application.get()<br />    ui = app.userInterface<br /><br />    hub = app.data.activeHub;<br /> <br />    summary = &#39;\nActive Hub = &#39; + hub.name<br />    #summary += summary + &#39;\nHub.id = &#39; + hub.id<br /> <br />    projects = hub.dataProjects<br />    for index in range(0, projects.count):<br /><br />      project = projects.item(index)<br />      summary += &quot;\n\nProject = &quot; + project.name<br />      #summary += &quot;\n\nProject.id = &quot; + project.id<br /><br />      folder = project.rootFolder<br />      summary += &quot;\n\n\tRoot Folder = &quot; + folder.name<br />      summary += &quot;\n\tRoot Folder.id = &quot; + folder.id<br /> <br />      files = folder.dataFiles <br />      for index in range(0, files.count):<br /> <br />        file = files.item(index)<br />        summary += &quot;\n\n\t\tFile = &quot; + file.name<br />        summary += &quot;\n\t\tFile.id = &quot; + file.id<br /><br />        folders = project.rootFolder.dataFolders<br />        for index in range(0, folders.count):<br /> <br />          folder = folders.item(index)<br />          summary += &quot;\n\n\t\tFolder = &quot; + folder.name<br />          summary += &quot;\n\t\tFolder.id = &quot; + folder.id<br /> <br />          files = folder.dataFiles<br />          for index in range(0, files.count):<br /><br />            file = files.item(index)<br />            summary += &quot;\n\n\t\t\tFile = &quot; + file.name<br />            summary += &quot;\n\t\t\tFile.id = &quot; + file.id<br /><br />            ui.messageBox(summary)<br />            print(summary)<br /><br />  except:<br />    if ui:<br />      ui.messageBox(&#39;Failed:\n{}&#39;.format(traceback.format_exc()))</pre>
<p>このように、Fusion 360 API は、Forge との連携も含めた運用をスムーズにする API が用意されています。</p>
<p>By Toshiaki Isezaki</p>
