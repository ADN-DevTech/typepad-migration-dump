---
layout: "post"
title: "Fusion 360 のメニューカスタマイズ ～ Workspace"
date: "2015-03-23 00:32:00"
author: "Toshiaki Isezaki"
categories:
  - "API カスタマイズ"
  - "クラウドサービス"
original_url: "https://adndevblog.typepad.com/technology_perspective/2015/03/menu-customize-on-fusion-360-workspace.html "
typepad_basename: "menu-customize-on-fusion-360-workspace"
typepad_status: "Publish"
---

<p>前回に引き続き、 Fusion 360 のユーザ インタフェースについて、API の視点から解説していきたいと思います。今回 Workspace（ワークスペース）と、関連ずけられているメニューを重点的にご案内します。</p>
<p style="text-align: center;"><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01bb08086f46970d-pi" style="display: inline;"><img alt="Fusion_360_ui" border="0" class="asset  asset-image at-xid-6a0167607c2431970b01bb08086f46970d image-full img-responsive" src="/assets/image_264366.jpg" title="Fusion_360_ui" /></a></p>
<p>Fusion 360 では、モデリング画面上部のツールバー左端のボタンを選択することで、各フェーズに必要なユーザインタフェースの表示を切り替えます。この単位が Workspace&#0160;&#0160;で、それぞれ、表示されるツールが異なります。下記は、その例です。</p>
<p style="text-align: center;"><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d0edf4a3970c-pi" style="display: inline;"><img alt="Model ws" class="asset  asset-image at-xid-6a0167607c2431970b01b8d0edf4a3970c img-responsive" src="/assets/image_48721.jpg" style="width: 450px;" title="Model ws" /><br /></a>&lt;Model ワークスペース&gt;</p>
<p style="text-align: center;"><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b7c764708e970b-pi" style="display: inline;"><img alt="Patch ws" class="asset  asset-image at-xid-6a0167607c2431970b01b7c764708e970b img-responsive" src="/assets/image_77162.jpg" style="width: 430px;" title="Patch ws" /></a><br />&lt;Patch ワークスペース&gt;</p>
<p style="text-align: center;"><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d0edf4bc970c-pi" style="display: inline;"><img alt="Render ws" class="asset  asset-image at-xid-6a0167607c2431970b01b8d0edf4bc970c img-responsive" src="/assets/image_507343.jpg" style="width: 370px;" title="Render ws" /></a><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b7c7646b07970b-pi" style="display: inline;"><br /></a>&lt;Render ワークスペース&gt;</p>
<p>Fusion 360 API では、各 Workspace &#0160;は Workspaces コレクションに格納される Workspace オブジェクトとして扱われています。また、他のユーザ インタフェース要素と同様に、それぞれ ID で識別されていて、次の JavaScript コード（Script 実装）で Fusion 360 が定義している Workspace を列挙することが出来ます。</p>
<p style="padding-left: 30px;">//Author-<br />//Description-<br />/*globals adsk*/<br />(function () {</p>
<p style="padding-left: 30px;">&#0160;&#0160;&#0160;&#0160;&quot;use strict&quot;;<br /> <br /> &#0160;&#0160;&#0160;&#0160;if (adsk.debug === true) {<br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;/*jslint debug: true*/<br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;debugger;<br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;/*jslint debug: false*/<br /> &#0160;&#0160;&#0160;&#0160;}<br /> <br /> &#0160;&#0160;&#0160;&#0160;try {<br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;var app = adsk.core.Application.get();<br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;var ui = app.userInterface;<br />&#0160; &#0160; &#0160; &#0160; var workspace = null;<br />&#0160; &#0160; &#0160; &#0160; var workspaces = ui.workspaces;<br />&#0160; &#0160; &#0160; &#0160; var maxnum = workspaces.count;<br />&#0160; &#0160; &#0160; &#0160; for(var index = 0 ; index&lt;maxnum ; index++){<br />&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; workspace = workspaces.item(index);<br />&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; console.log(workspace.name + &quot; Workspace &gt;&gt; &quot; + workspace.id);<br />&#0160; &#0160; &#0160; &#0160; }<br />&#0160; &#0160; }<br />&#0160; &#0160; catch (e) {<br />&#0160; &#0160; &#0160; &#0160; if (ui) {<br />&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; ui.messageBox(&#39;Failed : &#39; + (e.description ? e.description : e));<br />&#0160; &#0160; &#0160; &#0160; }<br />&#0160; &#0160; }<br /><br />&#0160; &#0160; adsk.terminate();<br /><br />}());</p>
<p>このコードを実行すると、すべての Workspace を Web ブラウザのコンソール画面に表示します（Debug モードで実行）。Fusion 360 が内部的に保持していて、現在のバージョンでは表示されないものも存在している点に注意してください。&#0160;</p>
<p style="padding-left: 30px;">Sculpt Workspace &gt;&gt; TSplineEnvironment<br />Model Workspace &gt;&gt; FusionSolidEnvironment<br />Patch Workspace &gt;&gt; FusionSurfaceEnvironment<br />Render Workspace &gt;&gt; FusionRenderEnvironment<br />Animation Workspace &gt;&gt; Publisher3DEnvironment<br />CAM Workspace &gt;&gt; CAMEnvironment<br />Debug Workspace &gt;&gt; DebugEnvironment<br />Modeling Workspace &gt;&gt; FusionModelingEnvironment<br />Assemble Workspace &gt;&gt; FusionAssembleEnvironment<br />Visualization Workspace &gt;&gt; FusionVisualizationEnvironment<br />Modeling Workspace &gt;&gt; CAMModelingEnvironment<br />Documentation Workspace &gt;&gt; FusionDocumentationEnvironment</p>
<p>次に、Workspace に関連付けられているツールバーパネルとパネル内に配置されたコマンドの一覧を取得してみます。ここでは、Render ワークスペースをアクティブな状態にして次のコードを実行してみます。</p>
<p style="padding-left: 30px;">//Author-<br />//Description-<br />/*globals adsk*/<br />(function () {</p>
<p style="padding-left: 30px;">&#0160;&#0160;&#0160;&#0160;&quot;use strict&quot;;<br /> <br /> &#0160;&#0160;&#0160;&#0160;if (adsk.debug === true) {<br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;/*jslint debug: true*/<br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;debugger;<br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;/*jslint debug: false*/<br /> &#0160;&#0160;&#0160;&#0160;}<br /> <br /> &#0160;&#0160;&#0160;&#0160;try {<br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;var app = adsk.core.Application.get();<br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;var ui = app.userInterface;<br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;var toolBarPanel = null;<br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;var control = null;<br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;var currentWorkspace = ui.activeWorkspace;<br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;console.log(&quot;----------------- &quot; + currentWorkspace.name + &quot; Workspace&quot;);<br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;for(var index = 0 ; index&lt;currentWorkspace.toolbarPanels.count ; index++){<br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;toolBarPanel = currentWorkspace.toolbarPanels.item(index);<br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;if (toolBarPanel.isVisible){<br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;console.log(toolBarPanel.name);<br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;for(var index2 = 0 ; index2&lt;toolBarPanel.controls.count ; index2++){<br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;control = toolBarPanel.controls.item(index2);<br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;console.log(&quot; &gt; &quot; + control.id);<br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;} <br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;}<br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;}<br /> &#0160;&#0160;&#0160;&#0160;}<br /> &#0160;&#0160;&#0160;&#0160;catch (e) {<br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;if (ui) {<br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;ui.messageBox(&#39;Failed : &#39; + (e.description ? e.description : e));<br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;}<br /> &#0160;&#0160;&#0160;&#0160;}<br /> <br /> &#0160;&#0160;&#0160;&#0160;adsk.terminate();<br /><br />}());</p>
<p>Web ブラウザのコンソール画面には、このように ID を表示するはずです。先に示した Render ワークスペースのスクリーンショットと見比べてみてください。PhysicalMaterialCommand の ID を持つコマンドは、折りたたまれたパネル内に配置されています。</p>
<p style="padding-left: 30px;">----------------- Render Workspace<br />SETUP<br /> &#0160;&#0160;&#0160;&#0160;&gt; PhysicalMaterialCommand<br /> &#0160;&#0160;&#0160;&#0160;&gt; AppearanceCommand<br /> &#0160;&#0160;&#0160;&#0160;&gt; RenderingEnvCmd<br /> &#0160;&#0160;&#0160;&#0160;&gt; CameraSettingsCommand<br /> &#0160;&#0160;&#0160;&#0160;&gt; FusionAddEditDecalCommand<br />RENDER<br /> &#0160;&#0160;&#0160;&#0160;&gt; ShowRapidRTUICmd<br /> &#0160;&#0160;&#0160;&#0160;&gt; SaveAsImageCommand<br /> &#0160;&#0160;&#0160;&#0160;&gt; A360RenderCommand</p>
<p>簡単な走査方法ですが、これらを理解することで、Fusion 360 上の Workspace、ToolBarPanel とパネル内のコマンド（ToolbarControl オブジェクト）の関係を理解いただけるものと思います。</p>
<p>具体的な応用例として、Add-In 実装で独自のメニュー項目を追加する方法について、次のドキュメントを作成しましたので、必要に応じて内容をご確認ください。</p>
<p style="padding-left: 30px;"><strong><span class="asset  asset-generic at-xid-6a0167607c2431970b01b7c80f6f36970b img-responsive"><a href="http://adndevblog.typepad.com/files/qa-9575.pdf" target="_blank">QA-9575 ツールバーパネルに独自のメニューを追加したい</a></span></strong></p>
<p>By Toshiaki Isezaki&#0160;</p>
<p>&#0160;</p>
