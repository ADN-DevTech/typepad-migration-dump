---
layout: "post"
title: "プラットフォーム差による VBA の問題と AutoCAD 2014"
date: "2013-04-17 00:27:17"
author: "Toshiaki Isezaki"
categories:
  - "API カスタマイズ"
  - "デスクトップ製品"
original_url: "https://adndevblog.typepad.com/technology_perspective/2013/04/vba-performance-differences-per-platform.html "
typepad_basename: "vba-performance-differences-per-platform"
typepad_status: "Publish"
---

<p>以前の <strong><a href="http://adndevblog.typepad.com/technology_perspective/2013/03/migrate-autocad-api-addon-apps.html" target="_blank">ポスト</a> </strong>で、AutoCAD API の移植性についてご案内しました。その際に、AutoCAD 上で VBA をつかった場合、パフォーマンスや互換性に不具合が生じてしまうことをご説明しました。</p>
<p>念のため、そのポストを抜粋してここに記載しておきましょう。</p>
<p style="text-align: left; padding-left: 30px;">なお、AutoCAD 2009 以前で VBA プロジェクトを利用していた方は、AutoCAD 2010 以降の VBA 環境に注意してください。VBA コンポーネントは、AutoCAD 2010 から インストールメディア(DVD-ROM) には含まれず、<a href="http://www.autodesk.com/vba-download">http://www.autodesk.com/vba-download</a> からのダウンロード提供に切り替わっています。これは、Microsoft 社が提供する VBA コンポーネントが、32 ビット版でしか用意されていないためです。</p>
<p style="text-align: left; padding-left: 30px;">64 ビット版 Windows 上で動作する 64 ビット版 AutoCAD で、32 ビット版 VBA を動作させるには、プログラムの実行時に AutoCAD と VBA の内部的な通信が発生します。32 ビット版 Windows 上で動作する 32 ビット版 AutoCAD の場合には、同じ 32 ビット版 VBA は AutoCAD と同じメモリ空間で動作することが出来るので、この通信が発生しないのです。この結果、 64 ビット版 AutoCAD で VBA を実行すると、パフォーマンスが低下したり、一部の VBA プログラムの互換性が崩れることになってしまいました。</p>
<p style="text-align: center; padding-left: 30px;"><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d15cc72b970c-pi" style="display: inline;"><img alt="Vba_scheme_per_platform" border="0" class="asset  asset-image at-xid-6a0167607c2431970b01b8d15cc72b970c image-full img-responsive" src="/assets/image_115624.jpg" title="Vba_scheme_per_platform" /></a></p>
<p>今日は、32 ビットと 64 ビットのプラットフォーム差で、AutoCAD VBA の実行にどうった問題が発生するか、具体的に紹介しておきましょう。</p>
<p><strong>パフォーマンス差</strong></p>
<p>ここでは、モデル空間の原点を中心に、放射線状に線分を作図する簡単なプログラムで、パフォーマンスの差を実感してみましょう。仕様するプログラムは、次のコードです。&#0160;&#0160;&#0160;</p>
<table class="auto-style1" style="background: #F2F2F2; width: 100%;">
<tbody>
<tr>
<td class="auto-style4">
<p><span class="auto-style5">Public Sub PerformanceCheck()</span><br class="auto-style5" /> <br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; Dim strStart As Variant</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; strStart = Timer</span><br class="auto-style5" /> <br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; Dim ptStart(0 To 2) As Double</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; Dim ptEnd As Variant </span> <br class="auto-style5" /> <br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; ptStart(0) = 0#: ptStart(1) = 0#: ptStart(2) = 0#</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; Dim i As Double </span> <br class="auto-style5" /> <br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; For i = 0# To 360# Step 0.1</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ptEnd = ThisDrawing.Utility.PolarPoint(ptStart, i, 100#)</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Call ThisDrawing.ModelSpace.AddLine(ptStart, ptEnd)</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; Next i</span><br class="auto-style5" /> <br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; ThisDrawing.Utility.Prompt vbCrLf &amp; &quot;経過時間は ...&quot; &amp; Timer - strStart &amp; &quot;秒&quot; &amp; vbCrLf </span> <br class="auto-style5" /> <br class="auto-style5" /> <span class="auto-style5">End Sub</span></p>
</td>
</tr>
</tbody>
</table>
<p>AutoCAD のインストーラは、AutoCAD をインストールしようとする Windows プラットフォームにビット数に合わせて、同じビット数の AutoCAD をインストールするようになっています。先にご紹介しているように、VBA コンポーネントだけが、32 ビット版しか存在しないことに注意してください。それでは、この VBA マクロを 次の環境でテストしてみます。</p>
<ul>
<li>Windows 7 32 ビット版＋AutoCAD 2013 32 ビット版＋VBA 32 ビット版</li>
<li>Windows 7 64 ビット版＋AutoCAD 2013&#0160;64 ビット版＋VBA 32 ビット版</li>
</ul>
<p style="text-align: center;">&#0160;<iframe frameborder="0" height="281" src="http://www.youtube.com/embed/yyN54qiZtE8?feature=oembed" width="500"></iframe>&#0160;</p>
<p>Windows では、異なるビット数を同じプロセス内で一緒に動作させることが出来ないため、AutoCAD 64 ビット版と VBA 32 ビット版の各プロセス間を、プロセス間通信で補っているためです。このプロセス間通信をしているコンポーネントが、AutoCAD 2013 の場合 x64VBAServer19.exe で、AutoCAD 本体の acad.exe と通信しながら VBA マクロを実行しているため、全体のパフォーマンスが低下した結果に表れます。</p>
<p>32 ビット版 Windows に場合には、AutoCAD と VBA がどちらも 32 ビット版となるため、AutoCAD のプロセス内で VBA を動作させることができます。このため、プロセス間通信は発生しないので、高速に VBA マクロを実行することができるのです。</p>
<p><strong>VBA マクロ プログラムの互換性</strong></p>
<p>もう 1 つ、ここでは、64 ビット環境に移植できない VBA マクロのプログラム例をご紹介します。</p>
<table class="auto-style1" style="background: #F2F2F2; width: 100%;">
<tbody>
<tr>
<td class="auto-style4">
<p><span class="auto-style5">Public Sub Main()</span><br class="auto-style5" /> <br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; &#39; 新しい表スタイルの作成</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; On Error Resume Next</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; Dim oTblDict As AcadDictionary</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; Set oTblDict = ThisDrawing.Dictionaries.Item(&quot;ACAD_TABLESTYLE&quot;)</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; Dim oTblStyle As AcadTableStyle</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; Set oTblStyle = oTblDict.Item(&quot;MyTableStyle&quot;)</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; If Err Then</span><br class="auto-style5" /> <br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; 新しい表スタイル &quot;MyTableStyle&quot; を作成</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Err.Clear</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Set oTblStyle = oTblDict.AddObject(&quot;MyTableStyle&quot;, &quot;AcDbTableStyle&quot;)</span><br class="auto-style5" /> <br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; タイトル欄の設定（背景色：青、文字色：白、文字高さ：4.0）</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Dim oColor As AcadAcCmColor</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Set oColor = AcadApplication.GetInterfaceObject(&quot;AutoCAD.AcCmColor.18&quot;)</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Call oColor.SetRGB(255, 255, 255)</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oTblStyle.SetColor acTitleRow, oColor</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oColor.ColorIndex = acBlue</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oTblStyle.SetBackgroundColor acTitleRow, oColor</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oTblStyle.SetTextHeight acTitleRow, 4#</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oTblStyle.TitleSuppressed = False</span><br class="auto-style5" /> <br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; 列見出し欄の色設定（背景色：白、文字色：緑、文字高さ：2.5）</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oColor.ColorIndex = acWhite</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oTblStyle.SetColor acHeaderRow, oColor</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oColor.ColorIndex = acGreen</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oTblStyle.SetBackgroundColorNone acHeaderRow, False</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oTblStyle.SetBackgroundColor acHeaderRow, oColor</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oTblStyle.SetTextHeight acHeaderRow, 2.5</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oTblStyle.HeaderSuppressed = False</span><br class="auto-style5" /> <br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; データ欄の色設定（背景色：なし、文字色：白、文字高さ：2.5）</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oColor.ColorIndex = acWhite</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oTblStyle.SetColor acDataRow, oColor</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oTblStyle.SetBackgroundColorNone acDataRow, True</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oTblStyle.SetTextHeight acDataRow, 2.5</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oTblStyle.SetAlignment acDataRow, acMiddleCenter</span><br class="auto-style5" /> <br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; End If</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; On Error GoTo 0</span><br class="auto-style5" /> <br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; &#39; 配置基点を指示</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; Dim ptBase As Variant</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; ThisDrawing.Utility.InitializeUserInput 1</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; ptBase = ThisDrawing.Utility.GetPoint(, vbCrLf &amp; &quot;表の配置点を指定:&quot;)</span><br class="auto-style5" /> <br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; &#39; 表特性の算出</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; Dim nRow As Integer</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; Dim nCol As Integer</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; Dim dHeight As Double</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; nRow = ThisDrawing.ModelSpace.Count + 2 &#39; タイトル＋列見出し</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; nCol = 3</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; dHeight = ThisDrawing.GetVariable(&quot;TEXTSIZE&quot;)</span><br class="auto-style5" /> <br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; &#39; 現在のレイアウトに表を配置</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; Dim oTbl As AcadTable</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; Set oTbl = ThisDrawing.ActiveLayout.Block.AddTable(ptBase, nRow, nCol, dHeight, dHeight * 10#)</span><br class="auto-style5" /> <br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; oTbl.RegenerateTableSuppressed = True</span><br class="auto-style5" /> <br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; oTbl.StyleName = &quot;MyTableStyle&quot;</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; oTbl.GenerateLayout</span><br class="auto-style5" /> <br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; &#39; タイトルの設定</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; oTbl.SetText 0, 0, &quot;モデル空間図形の色一覧&quot;</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; oTbl.SetRowHeight 0, 7#</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; oTbl.SetText 1, 0, &quot;ハンドル番号&quot;</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; oTbl.SetText 1, 1, &quot;クラス名&quot;</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; oTbl.SetText 1, 2, &quot;色&quot;</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; oTbl.SetRowHeight 1, 5#</span><br class="auto-style5" /> <br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; &#39; データの設定</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; Dim nRowCnt As Integer</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; Dim strField As String</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; Dim oEnt As AcadEntity</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; For nRowCnt = 2 To ThisDrawing.ModelSpace.Count</span><br class="auto-style5" /> <br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; モデル空間要素の取得</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Set oEnt = ThisDrawing.ModelSpace.Item(nRowCnt - 2)</span><br class="auto-style5" /> <br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; ハンドル番号</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oTbl.SetText nRowCnt, 0, oEnt.Handle</span><br class="auto-style5" /> <br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; クラス名</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oTbl.SetText nRowCnt, 1, oEnt.ObjectName</span><br class="auto-style5" /> <br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; フィールド式（オブジェクトID で特定したオブジェクトの色）</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; strField = &quot;%&lt;\AcObjProp Object(%&lt;\_ObjId &quot; &amp; CStr(oEnt.ObjectID) &amp; &quot;&gt;%).TrueColor&gt;%&quot;</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oTbl.SetText nRowCnt, 2, strField</span><br class="auto-style5" /> <br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39; 行高さの設定</span><br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oTbl.SetRowHeight nRowCnt, 5#</span><br class="auto-style5" /> <br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; Next</span><br class="auto-style5" /> <br class="auto-style5" /> <span class="auto-style5">&#0160;&#0160;&#0160; oTbl.RegenerateTableSuppressed = False</span><br class="auto-style5" /> <br class="auto-style5" /> <span class="auto-style5">End Sub </span></p>
</td>
</tr>
</tbody>
</table>
<p>この VBA プログラムは、モデル空間に作図されている図形のハンドル番号、色、図形タイプを AutoCAD の表オブジェクトに書き出す処理をしています。色番号の部分では、それぞれの図形の色を <strong><a href="http://docs.autodesk.com/ACD/2013/JPN/files/GUID-B9ADAE6A-2DD1-4C44-B126-CF3FF92EBC68.htm" target="_self">フィールド</a></strong> として書き出されている点に注意してください。フィールドは、図面内の特定の情報を監視して、その情報を文字として表示する機能があります。このプログラムでは、モデル空間の図形、1 つ 1 つを監視して、その図形の色を文字として表示しています。</p>
<p style="text-align: justify;"><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d15cc9fe970c-pi" style="display: inline;"><img alt="Field_Table" border="0" class="asset  asset-image at-xid-6a0167607c2431970b01b8d15cc9fe970c image-full img-responsive" src="/assets/image_330797.jpg" title="Field_Table" /></a><br />&lt;左手のソリッド図形の色を表右手でフィールド文字として表示&gt;</p>
<p style="text-align: left;">このため、VBA マクロで作図した表の作成後に、参照されている図形の色を変更して、REGEN[再作図] コマンドを実行すると、変更した図形の色が表に自動的に反映されることがわかります（32 ビット プラットフォームのみ）。</p>
<p style="text-align: left;">そして、この VBA マクロは残念ながら 64 ビット版の AutoCAD では実行時にエラーで正しく動作しません。なぜなら、フィールド文字として図形の色を関連付けるときに、<strong><a href="http://docs.autodesk.com/ACD/2013/JPN/files/GUID-8D56532D-2B17-48D1-8C81-B4AD89603A1C.htm" target="_self">オブジェクト ID</a></strong> と呼ばれる識別子 ObjectID プロパティで利用しているためです。</p>
<p style="text-align: left;">&#0160;&#0160;&#0160; &#39; フィールド式（オブジェクトID で特定したオブジェクトの色）<br />&#0160;&#0160;&#0160; strField =&#0160;&#0160; &quot;%&lt;\AcObjProp Object(%&lt;\_ObjId &quot; &amp; CStr(oEnt.<strong><span style="color: #0000ff;">ObjectID</span></strong>) &amp; &quot;&gt;%).TrueColor&gt;%&quot;</p>
<p style="text-align: left;">オブジェクトID は、ObjectARX や AutoCAD .NET API を利用されている方にはおなじみの識別子ですが、この識別子は、プラットフォーム依存なので、このような非互換な結果になってしまうのです。</p>
<p style="text-align: left;">こういったプラットフォーム差を吸収するために、オートデスクでは、VBA マクロを同じ Visual Basic 言語を利用できる&#0160;AutoCAD .NET API&#0160;に移植することをお勧めしています。</p>
<p style="text-align: left;"><strong>AutoCAD 2014 と 64 ビット版 VBA</strong></p>
<p style="text-align: left;">ここに来て、32 ビット版のコンポーネントしかリリースしていなかった Microsoft 社が、64 ビット版のコンポーネントをリリースすることになりました。つまり、64 ビット版の AutoCAD と同じプロセス内で VBA が実行できるようになります。そして、新しくリリースされた AutoCAD 2014 では、64 ビット版の AutoCAD 用に <a href="http://www.autodesk.com/vba-download">http://www.autodesk.com/vba-download</a> から 64 ビット版の VBA をダウンロード提供しています。残念ながら、AutoCAD 2014 にしか適用することは出来ませんが、これによって、32 ビット版 AutoCAD と 64 ビット版の AutoCAD で、VBA のぱパフォーマンス差やコードの非互換性も解消できることが期待できます。</p>
<p style="text-align: center;"><iframe frameborder="0" height="281" src="http://www.youtube.com/embed/g-y2d3YJNUk?feature=oembed" width="500"></iframe></p>
<p style="text-align: left;">ただし、この状況でも、オートデスクは AutoCAD .NET API への移植を推奨している点に注意してください。VBA の言語仕様は、十数年前の Visual Basic 6.0 のままです。VBA が持つ COM との互換性があり、.NET Framework ベースの新しい VB.NET を使うことが可能な &#0160;AutoCAD .NET API が移植先として最適なのです。</p>
<p style="text-align: left;">By Toshiaki Isezaki</p>
<p style="text-align: left;">&#0160;</p>
<p style="text-align: left;"><span class="asset  asset-generic at-xid-6a0167607c2431970b017c38af7324970b">&#0160;</span></p>
