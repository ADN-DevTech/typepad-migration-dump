---
layout: "post"
title: "Model Derivative API の役割と変換可能なファイル形式"
date: "2017-05-08 02:12:00"
author: "Toshiaki Isezaki"
categories:
  - "API カスタマイズ"
  - "クラウドサービス"
original_url: "https://adndevblog.typepad.com/technology_perspective/2017/05/translatable-file-format-with-model-derivative-api-and-role.html "
typepad_basename: "translatable-file-format-with-model-derivative-api-and-role"
typepad_status: "Publish"
---

<p>Forge Viewer で 3D モデルや 2D 図面を表示する場合には、事前 <a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b7c8ec7e1d970b-pi" style="float: right;"><img alt="Icon-model_derivative_api" class="asset  asset-image at-xid-6a0167607c2431970b01b7c8ec7e1d970b img-responsive" src="/assets/image_94526.jpg" style="margin: 0px 0px 5px 5px;" title="Icon-model_derivative_api" /></a>にデザインファイルを Model Derivative API で SVF ファイルに変換する必要があります。変換が正常に終了して SVF ファイルのドキュメント ID（URN）がわかれば、HTML ファイルの &lt;div&gt;～&lt;/div&gt; タグで指定した領域に、適切な Viewer コードで 3D モデルや 2D 図面をストリーミングで表示することが出来ます。</p>
<p>Model Derivative API には、この他にも変換時にサムネイル画像を生成する機能や、Manifest（マニフェスト）と呼ばれる情報からデザインファイルに登録されたビュー情報などを提供する機能があります。また、<a href="https://adndevblog.typepad.com/cloud_and_mobile/2017/01/why-it-still-takes-time-to-get-metadata-after-the-translation-has-been-completed.html" rel="noopener noreferrer" target="_blank">情報の生成に若干時間がかかりますが</a>、オブジェクトの階層構造やジオメトリのメタデータを取得することも出来ます。</p>
<p>SVF ファイル変換とは別に、Model Derivative API には 、Data Management API でアップロードしたデザイン ファイルを他のデザイン ファイル形式に変換する機能も実装されています。</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d276d36c970c-pi" style="display: inline;"><img alt="Supported_conversion" border="0" class="asset  asset-image at-xid-6a0167607c2431970b01b8d276d36c970c image-full img-responsive" src="/assets/image_326553.jpg" title="Supported_conversion" /></a></p>
<p><strong><a href="http://adndevblog.typepad.com/technology_perspective/2017/03/3rd_forge-1-day-workshop.html" rel="noopener noreferrer" target="_blank">Forge Workshop</a></strong>&#0160;などでよく受けるご質問の中に「<strong>どのデザイン ファイル形式を変換出来るのか？</strong>」というものがあります。</p>
<p>実はこの解も Model Derivative API &#0160;で提供されています。endpoint&#0160; <strong><a href="https://developer.autodesk.com/en/docs/model-derivative/v2/reference/http/formats-GET/" rel="noopener noreferrer" target="_blank">https://developer.api.autodesk.com/modelderivative/v2/designdata/formats</a></strong>、メソッド &#0160;<strong>GET&#0160;</strong>で返される JSON レスポンスで、ファイル間の変換でサポートされるファイル形式を把握することが出来ます。2017年4月の時点で返される JSON は、少し長くなりますが次のとおりです。</p>
<pre>{<br />  &quot;formats&quot;: {<br />    &quot;stl&quot;: [<br />      &quot;f3d&quot;,<br />      &quot;fbx&quot;,<br />      &quot;iam&quot;,<br />      &quot;ipt&quot;,<br />      &quot;wire&quot;<br />    ],<br />    &quot;step&quot;: [<br />      &quot;f3d&quot;,<br />      &quot;fbx&quot;,<br />      &quot;iam&quot;,<br />      &quot;ipt&quot;,<br />      &quot;wire&quot;<br />    ],<br />    &quot;dwg&quot;: [<br />      &quot;f2d&quot;,<br />      &quot;f3d&quot;,<br />      &quot;rvt&quot;<br />    ],<br />    &quot;iges&quot;: [<br />      &quot;f3d&quot;,<br />      &quot;fbx&quot;,<br />      &quot;iam&quot;,<br />      &quot;ipt&quot;,<br />      &quot;wire&quot;<br />    ],<br />    &quot;obj&quot;: [<br />      &quot;asm&quot;,<br />      &quot;f3d&quot;,<br />      &quot;fbx&quot;,<br />      &quot;iam&quot;,<br />      &quot;ipt&quot;,<br />      &quot;neu&quot;,<br />      &quot;prt&quot;,<br />      &quot;sldasm&quot;,<br />      &quot;sldprt&quot;,<br />      &quot;step&quot;,<br />      &quot;stp&quot;,<br />      &quot;stpz&quot;,<br />      &quot;wire&quot;,<br />      &quot;x_b&quot;,<br />      &quot;x_t&quot;,<br />      &quot;asm\\.\\d+$&quot;,<br />      &quot;neu\\.\\d+$&quot;,<br />      &quot;prt\\.\\d+$&quot;<br />    ],<br />    &quot;svf&quot;: [<br />      &quot;3dm&quot;,<br />      &quot;3ds&quot;,<br />      &quot;asm&quot;,<br />      &quot;catpart&quot;,<br />      &quot;catproduct&quot;,<br />      &quot;cgr&quot;,<br />      &quot;collaboration&quot;,<br />      &quot;dae&quot;,<br />      &quot;dgn&quot;,<br />      &quot;dlv3&quot;,<br />      &quot;dwf&quot;,<br />      &quot;dwfx&quot;,<br />      &quot;dwg&quot;,<br />      &quot;dwt&quot;,<br />      &quot;dxf&quot;,<br />      &quot;exp&quot;,<br />      &quot;f3d&quot;,<br />      &quot;fbx&quot;,<br />      &quot;g&quot;,<br />      &quot;gbxml&quot;,<br />      &quot;iam&quot;,<br />      &quot;idw&quot;,<br />      &quot;ifc&quot;,<br />      &quot;ige&quot;,<br />      &quot;iges&quot;,<br />      &quot;igs&quot;,<br />      &quot;ipt&quot;,<br />      &quot;jt&quot;,<br />      &quot;max&quot;,<br />      &quot;model&quot;,<br />      &quot;neu&quot;,<br />      &quot;nwc&quot;,<br />      &quot;nwd&quot;,<br />      &quot;obj&quot;,<br />      &quot;pdf&quot;,<br />      &quot;prt&quot;,<br />      &quot;rcp&quot;,<br />      &quot;rvt&quot;,<br />      &quot;sab&quot;,<br />      &quot;sat&quot;,<br />      &quot;session&quot;,<br />      &quot;skp&quot;,<br />      &quot;sldasm&quot;,<br />      &quot;sldprt&quot;,<br />      &quot;smb&quot;,<br />      &quot;smt&quot;,<br />      &quot;ste&quot;,<br />      &quot;step&quot;,<br />      &quot;stl&quot;,<br />      &quot;stla&quot;,<br />      &quot;stlb&quot;,<br />      &quot;stp&quot;,<br />      &quot;stpz&quot;,<br />      &quot;wire&quot;,<br />      &quot;x_b&quot;,<br />      &quot;x_t&quot;,<br />      &quot;xas&quot;,<br />      &quot;xpr&quot;,<br />      &quot;zip&quot;,<br />      &quot;asm\\.\\d+$&quot;,<br />      &quot;neu\\.\\d+$&quot;,<br />      &quot;prt\\.\\d+$&quot;<br />    ],<br />    &quot;thumbnail&quot;: [<br />      &quot;3dm&quot;,<br />      &quot;3ds&quot;,<br />      &quot;asm&quot;,<br />      &quot;catpart&quot;,<br />      &quot;catproduct&quot;,<br />      &quot;cgr&quot;,<br />      &quot;collaboration&quot;,<br />      &quot;dae&quot;,<br />      &quot;dgn&quot;,<br />      &quot;dlv3&quot;,<br />      &quot;dwf&quot;,<br />      &quot;dwfx&quot;,<br />      &quot;dwg&quot;,<br />      &quot;dwt&quot;,<br />      &quot;dxf&quot;,<br />      &quot;exp&quot;,<br />      &quot;f3d&quot;,<br />      &quot;fbx&quot;,<br />      &quot;g&quot;,<br />      &quot;gbxml&quot;,<br />      &quot;iam&quot;,<br />      &quot;idw&quot;,<br />      &quot;ifc&quot;,<br />      &quot;ige&quot;,<br />      &quot;iges&quot;,<br />      &quot;igs&quot;,<br />      &quot;ipt&quot;,<br />      &quot;jt&quot;,<br />      &quot;max&quot;,<br />      &quot;model&quot;,<br />      &quot;neu&quot;,<br />      &quot;nwc&quot;,<br />      &quot;nwd&quot;,<br />      &quot;obj&quot;,<br />      &quot;pdf&quot;,<br />      &quot;prt&quot;,<br />      &quot;rcp&quot;,<br />      &quot;rvt&quot;,<br />      &quot;sab&quot;,<br />      &quot;sat&quot;,<br />      &quot;session&quot;,<br />      &quot;skp&quot;,<br />      &quot;sldasm&quot;,<br />      &quot;sldprt&quot;,<br />      &quot;smb&quot;,<br />      &quot;smt&quot;,<br />      &quot;ste&quot;,<br />      &quot;step&quot;,<br />      &quot;stl&quot;,<br />      &quot;stla&quot;,<br />      &quot;stlb&quot;,<br />      &quot;stp&quot;,<br />      &quot;stpz&quot;,<br />      &quot;wire&quot;,<br />      &quot;x_b&quot;,<br />      &quot;x_t&quot;,<br />      &quot;xas&quot;,<br />      &quot;xpr&quot;,<br />      &quot;zip&quot;,<br />      &quot;asm\\.\\d+$&quot;,<br />      &quot;neu\\.\\d+$&quot;,<br />      &quot;prt\\.\\d+$&quot;<br />    ],<br />    &quot;fbx&quot;: [<br />      &quot;f3d&quot;<br />    ],<br />    &quot;ifc&quot;: [<br />      &quot;rvt&quot;<br />    ]<br />  }<br />}</pre>
<p>ここでは冒頭の dwg ファイルの記述に着目してみます。</p>
<pre>&#0160;&#0160;&#0160;&#0160; ：<br />&#0160;   &quot;dwg&quot;: [<br />      &quot;f2d&quot;,<br />      &quot;f3d&quot;,<br />      &quot;rvt&quot;<br />    ],<br />     ：</pre>
<p>整形された状態で JSON を示しているので若干分かりやすくなっていると思いますが、一番内側の文字列がサポートされる変換前のファイル形式で、それらを囲む 1 レベル外側に明記されているのが変換後の拡張子です。つまり、f3d（Fusion 360 3D &#0160;アーカイブ形式）、f2d（Fusion 360 図面アーカイブ形式）、rvt（Revit プロジェクト形式）を dwg（AutoCAD 図面ファイル形式）に変換出来ることを意味しています。</p>
<p>同じレベルで svf ファイルに着目すると、SVF ファイルをさまざまファイル形式から変換出来ることがわかります。この場合、Forge Viewer に表示出来るということになります。</p>
<p>なお、変換可能なファイル形式と変換前のファイル形式については、<strong><a href="https://developer.autodesk.com" rel="noopener noreferrer" target="_blank">デベロッパ ポータル</a></strong>上で Model Derivative API の Overview &gt;&gt; <strong><a href="https://developer.autodesk.com/en/docs/model-derivative/v2/overview/supported-translations/" rel="noopener noreferrer" target="_blank">Supported Translation ページ</a></strong>（<a href="https://developer.autodesk.com/en/docs/model-derivative/v2/overview/supported-translations/" rel="noopener noreferrer" target="_blank">https://developer.autodesk.com/en/docs/model-derivative/v2/overview/supported-translations/</a>）でも紹介されています。</p>
<p>1 つ誤解が生じているのが SVF ファイルに変換可能となっている RCP ファイル形式についてです。RCP ファイルは、ReCap Project ファイル形式を示していますが、この形式に 2 種類が存在している点に注意が必要です。1 つは、写真から 3D データを生成する&#0160;<strong><a href="https://recap360.autodesk.com/" rel="noopener noreferrer" target="_blank">ReCap 360 クラウド サービス</a></strong> のプロジェクト ファイルで、もう 1 つは、点群データの統合や編集をおこなう <strong><a href="http://www.autodesk.com/products/recap/overview" rel="noopener noreferrer" target="_blank">ReCap デスクトップ製品</a></strong>&#0160;のプロジェクト ファイルです。</p>
<p>前者はテクスチャ画像付きの 3D メッシュ用であり、後者は点群用とも考えることが出来ます。<strong><a href="https://developer.autodesk.com/en/docs/model-derivative/v2/overview/supported-translations/" rel="noopener noreferrer" target="_blank">Supported Translation ページ</a>&#0160;</strong>で RCP ファイルがサポート対象になっているのは、ReCap 360 クラウド サービスが内部的に使用している テクスチャ画像付きの 3D メッシュ用のもので、残念ながら、ReCap デスクトップ製品で保存可能な点群用の RCP ファイルを表示するものではありません。</p>
<p>現在（2017年5月現在）、Forge Viewer には点群データを表示する機能はありませんのでご注意ください。ReCap 360 クラウドサービスや Forge の Reality Capture API（ベータ）が生成した テクスチャ画像付きの 3D メッシュ データは、OBJ ファイルをテクスチャ画像と MTL ファイルとを ZIP 圧縮したものを Model Derivative API で変換することで、Forge Viewer で表示することが出来ます。</p>
<p>By Toshiaki Isezaki</p>
