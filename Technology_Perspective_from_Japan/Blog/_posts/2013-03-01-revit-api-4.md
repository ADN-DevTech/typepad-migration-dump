---
layout: "post"
title: "Revit API 入門 その４"
date: "2013-03-01 11:30:00"
author: "Mikako Harada"
categories:
  - "API カスタマイズ"
  - "デスクトップ製品"
original_url: "https://adndevblog.typepad.com/technology_perspective/2013/02/revit-api-%E5%85%A5%E9%96%80-%E3%81%9D%E3%81%AE%EF%BC%94.html "
typepad_basename: "revit-api-入門-その４"
typepad_status: "Publish"
---

<p>APIを学ぶ際、なくてはならないのがサンプルです。Revitのサンプルは主にSDKのSamplesフォルダにあります。現時点で１２０以上のサンプル用意されており、その数はリリースが進むごとに新機能と共に増えています。（その昔、Revit API が初めて公開された当時は、サンプルもドキュメントも、もちろんRevit&#0160; Lookupといったようなツールもなく、まるで、目をつぶって手探りで、プログラムしていたといった感じで、その時のことを思うと、今はまるで夢のようです。）</p>
<p>あればあるほどうれしいはずのサンプル。ところが、ある程度数が増えてきた時点で、今度は別の問題がもちあがってきました。ちょっと試して見ようと思っても、数がありすぎて、ビルドするのも、Revitのアドインマニフェストに登録するのも、手間がかかってしまうのです。とくに、これからRevit APIを使って開発をされようというかたにとっては、どのようなサンプルがあるのか、試してみたいところでしょう。開発やサポート側にとってもメインテナンスだけでも大仕事。新しいSDKが提供されるたびに、同じ作業を繰り返すのはちっとも楽しい作業ではありません。</p>
<p>ということで、今回は、１２０以上あるサンプルを１０分でRevit上で実行可能にする便利な以下のツールをご紹介します：</p>
<ul>
<li>RevitAPIDllsPathUpdater.exe</li>
<li>SDKSaples2013.sln</li>
<li>RvtSamples</li>
</ul>
<p>これらは、すべてRevit SDKのSamplesフォルダ下あり、以下の順序で一緒に使っていただくと便利です。<br /><br /></p>
<p><strong>RevitAPIDllsPathUpdater.exe</strong></p>
<p>RevitAPIDllsPathUpdaterツールは、一定のフォルダー下にあるマイクロソフトVisual Studio (MSVS) のプロジェクトでRevitAPIのdllの参照を指定したパスに置き換えるプログラムです。実際には、.csprojあるいは.vbprojファイルを走査し、その中のRevit API のdllのパスを変更します。使用方法は簡単：</p>
<ol>
<li>.exe ファイルをダブルクリックして実行。</li>
<li>表示されたダイアログで一行目にSDKのサンプルが保存されているフォルダを指定。</li>
<li>二行目に、RevitAPI.dll と RevitAPIUI.dllのある場所を指定。</li>
<li>クリック”Run” 。</li>
</ol>
<p>実行すると変更されたプロジェクトファイルの一覧が表示されます。以下に使用例のイメージを示します。 </p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017d413f06c7970c-pi" style="display: inline;"><img alt="Revit sample dll updater" border="0" class="asset  asset-image at-xid-6a0167607c2431970b017d413f06c7970c image-full" src="/assets/image_741646.jpg" title="Revit sample dll updater" /></a></p>
<p><strong>SDKSaples2013.sln</strong></p>
<p>これはRevit SDK Samplesフォルダー内のサンプルプロジェクトをすべて含んだMSVSのソリューションファイルです。上記のRevitAPIDllsPathUpdater.exeをもちいて、参照がすべて設定してあると、ビルド &gt;&gt; ビルド ソリューション ですべてビルドされるはずです。（ただし、時折プロジェクトをうっかり忘れたりすることがありますので、それに気づいた場合は、適宜修正してください。）<br /><br /></p>
<p><strong>RvtSamples</strong></p>
<p>これはSamplesフォルダーにあり、一見他のサンプルと同じように提供してありますが、 本来の目的は、すべてのサンプルをシステマティックにRevitに登録し、実行可能とするツールとして提供されているサンプルです。このサンプルを実行すると、以下のようなリボンパネルがAdd-Insタブに追加されます。そこから、カテゴリーごとのプルダウンメニューを介して個々のサンプルを実行することができます。</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017d413f07e1970c-pi" style="display: inline;"><img alt="RvtSamplePanel" border="0" class="asset  asset-image at-xid-6a0167607c2431970b017d413f07e1970c image-full" src="/assets/image_779238.jpg" title="RvtSamplePanel" /></a></p>
<p>このツールを使用する方法は以下のようになります：</p>
<ol>
<li>Samples\RvtSamples\CSの下に、RvtSamples.txtというファイルがあります。これをノートパッド（Notepad）といったテキストエディターツールで開きます。</li>
<li>ファイルの中では、それぞれのサンプルのDLLがZ:\SDK2013\Samples\XXXX という相対位置で定義されているので、それらを実際のパスに変更します。たとえば、Notepadの「すべて置き換え」（Replace All）といった機能を使用して一挙に変更します：</li>
</ol>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017c370fc4eb970b-pi" style="display: inline;"><img alt="RvtSample txt" border="0" class="asset  asset-image at-xid-6a0167607c2431970b017c370fc4eb970b image-full" src="/assets/image_951145.jpg" title="RvtSample txt" /></a></p>
<p>&#0160;&#0160;&#0160;&#0160;3.　ファイルを保存。</p>
<p>&#0160;&#0160;&#0160;&#0160;4.　RvtSample.addinマニフェストのDllの位置を修正し、Revitが認識するアドインの位置にコピーします：i.e., <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;%AppData%\Autodesk\Revit\Addins\2013&#0160; あるいは<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;%ProgramData%\Autodesk\Revit\Addins\2013<br /><br />この後Revitを立ち上げると、上記に示したRvtSamplesのリボンパネルがAdd-insタブに表示されます。</p>
<p>これで、試してみたいサンプルはいつでも実行可能です。</p>
<p>原田</p>
