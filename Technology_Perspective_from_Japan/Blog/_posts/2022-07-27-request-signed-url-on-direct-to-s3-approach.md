---
layout: "post"
title: "Direct-to-S3 アプローチの署名付き URL 要求について"
date: "2022-07-27 00:08:57"
author: "Toshiaki Isezaki"
categories:
  - "API カスタマイズ"
  - "クラウドサービス"
original_url: "https://adndevblog.typepad.com/technology_perspective/2022/07/request-signed-url-on-direct-to-s3-approach.html "
typepad_basename: "request-signed-url-on-direct-to-s3-approach"
typepad_status: "Publish"
---

<p><a class="asset-img-link" href="https://adndevblog.typepad.com/.a/6a0167607c2431970b02a2eecd85c9200d-pi" style="display: inline;"> </a><a class="asset-img-link" href="https://adndevblog.typepad.com/.a/6a0167607c2431970b02a30d44e50f200b-pi" style="display: inline;"><img alt="Screen Shot 2022-03-16 at 6.14.40 PM" border="0" class="asset  asset-image at-xid-6a0167607c2431970b02a30d44e50f200b image-full img-responsive" src="/assets/image_259738.jpg" title="Screen Shot 2022-03-16 at 6.14.40 PM" /></a><a class="asset-img-link" href="https://adndevblog.typepad.com/.a/6a0167607c2431970b02a2eecd85c9200d-pi" style="display: inline;"><br /></a></p>
<p>Direct-S3 アプローチで利用する Signed URL 取得のエンドポイントを日本から呼び出す場合、Upload 用、Download 用ともに、次のクエリーパラメータを指定することをお薦めしています。</p>
<p style="padding-left: 40px;"><a href="https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fforge.autodesk.com%2Fen%2Fdocs%2Fdata%2Fv2%2Freference%2Fhttp%2Fbuckets-%3AbucketKey-objects-%3AobjectKey-signeds3upload-GET%2F&amp;data=05%7C01%7Ctoshiaki.isezaki%40autodesk.com%7C516eb8877980433ecf8a08da599bf09e%7C67bff79e7f914433a8e5c9252d2ddc1d%7C0%7C0%7C637920823562339064%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=UR06hW5dzFQtmvw7a4wsYbTypOOwmuJF%2BF0RwNqOXqc%3D&amp;reserved=0" rel="noopener" target="_blank">GET buckets/:bucketKey/objects/:objectKey/signeds3upload</a>：<strong>“useAcceleration=true” </strong></p>
<p style="padding-left: 40px;"><a href="https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fforge.autodesk.com%2Fen%2Fdocs%2Fdata%2Fv2%2Freference%2Fhttp%2Fbuckets-%3AbucketKey-objects-%3AobjectKey-signeds3download-GET%2F&amp;data=05%7C01%7Ctoshiaki.isezaki%40autodesk.com%7C516eb8877980433ecf8a08da599bf09e%7C67bff79e7f914433a8e5c9252d2ddc1d%7C0%7C0%7C637920823562339064%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=CSATIdj3hvnsuH6Bd9%2BTm3QUXtFc86DSsCYdJUIZKBg%3D&amp;reserved=0" rel="noopener" target="_blank">GET buckets/:bucketKey/objects/:objectKey/signeds3download</a>：<strong>“useCdn=true”</strong></p>
<p>これらパラメータ指定がない場合、S3 Transfer Acceleration と CloudFront CDN を使った署名付き URL がリクエストされないため、日本からのパフォーマンスが低下してしまいます。従来のアプローチでは、これらのリクエストは米国西部にある Apigee のエッジ エンドポイントに到達するまでのみ公衆インターネットを通過するのみとなりますが、Direct-S3 アプローチでは、転送がアジア・パシフィック から米国東部まで公衆インターネットを経由して行われてしまうため、従来よりもパフォーマンスが低下してしまう可能性がります。</p>
<p>Transfer Acceleration と CloudFront CDN を利用した署名付き URL をリクエストした場合には、転送は日本の CloudFront エッジエンドポイントに到達するまでしか公衆インターネットを経由せず、それ以降はより高速な AWS バックボーンを利用することになるため、従来よりもパフォーマンスの向上を望めます。</p>
<p style="text-align: center;"><span style="font-size: 8pt;">&lt;下図はイメージです&gt;</span><br /><a class="asset-img-link" href="https://adndevblog.typepad.com/.a/6a0167607c2431970b02a30d45dcc3200b-pi" style="display: inline;"><img alt="Parameters" border="0" class="asset  asset-image at-xid-6a0167607c2431970b02a30d45dcc3200b image-full img-responsive" src="/assets/image_942512.jpg" title="Parameters" /></a></p>
<p>なお、ドキュメント上の tutorial では、<a href="https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fforge.autodesk.com%2Fen%2Fdocs%2Fdata%2Fv2%2Ftutorials%2Fdownload-file%2F&amp;data=05%7C01%7Ctoshiaki.isezaki%40autodesk.com%7C516eb8877980433ecf8a08da599bf09e%7C67bff79e7f914433a8e5c9252d2ddc1d%7C0%7C0%7C637920823562495615%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=blAcrSoDrAvV0saYe6mv8qRcUXBAW9fmf0D7kShtHkA%3D&amp;reserved=0">Download a File | Data Management API | Autodesk Forge</a> と <a href="https://nam11.safelinks.protection.outlook.com/?url=https%3A%2F%2Fforge.autodesk.com%2Fen%2Fdocs%2Fdata%2Fv2%2Ftutorials%2Fupload-file%2F&amp;data=05%7C01%7Ctoshiaki.isezaki%40autodesk.com%7C516eb8877980433ecf8a08da599bf09e%7C67bff79e7f914433a8e5c9252d2ddc1d%7C0%7C0%7C637920823562495615%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&amp;sdata=pgzRqBz1Ih%2B8M0dHVoMI3tpTOrrxzA9%2FJRrE9FtR93c%3D&amp;reserved=0">Upload a File | Data Management API | Autodesk Forge</a> で Direct-S3 アプローチに対応した内容に改修済となっています（ただし、前述のパラメータ未使用です）。</p>
<p>By Toshiaki Isezaki</p>
