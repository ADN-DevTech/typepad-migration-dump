<!DOCTYPE html>
<head>
  <!-- head-common-bootstrap-individual -->
     <meta charset="utf-8">
     <meta name="generator" content="http://www.typepad.com/" />
     <meta name="keywords" content="maxscript value, custom value, 3dsmax value, maxscript custom value" /><meta name="description" content="Building a custom value type for MAXScript 3ds MAX is a is a professional 3D computer graphics program that can be used to create 3D animations, models, games, and images. The power that it can do comes not only from the robust UI (User Interface) tools and ease of building..." />
     <link rel="canonical" href="https://getcoreinterface.typepad.com/blog/2023/01/custom-valuetype-maxscript.html" />
     <meta name="viewport" content="width=device-width, initial-scale=1.0" />

<meta property="og:title" content="MAXScript Custom Value Types from 3ds MAX SDK" />
<meta property="og:site_name" content="GetCOREInterface" />
<meta property="og:type" content="blog" />
<meta property="og:url" content="https://getcoreinterface.typepad.com/blog/2023/01/custom-valuetype-maxscript.html" />
<meta property="og:description" content="Building a custom value type for MAXScript 3ds MAX is a is a professional 3D computer graphics program that can be used to create 3D animations, models, games, and images. The power that it can do comes not only from the robust UI (User Interface) tools and ease of building..." />
<meta property="fb:admins" content="" />
<meta property="fb:app_id" content="55753818692" />


<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="">
<meta name="twitter:creator" content="">
<meta name="twitter:title" content="MAXScript Custom Value Types from 3ds MAX SDK">
<meta name="twitter:description" content="Building a custom value type for MAXScript 3ds MAX is a is a professional 3D computer graphics program that can be used to create 3D animations, models, games, and images. The power that it can do comes not only from the robust UI (User Interface) tools and ease of building...">


     <!-- Custom fonts for this template -->

    <!-- Bootstrap core CSS -->
    <link href="/.shared/themes/common/bootstrap/css/bootstrap.min.css" rel="stylesheet" />

    <!-- Bootstrap bridge -->
    <link href="/.shared/themes/common/bootstrap/css/bootstrap-bridge.css" rel="stylesheet" />

    <!-- Custom styles for this template -->
    <link rel="stylesheet" href="https://getcoreinterface.typepad.com/blog/styles.css?v=6" type="text/css" media="screen" />
    <style>.navbar-header, .nav { display:block !important; }</style>

        <link rel="stylesheet" href="https://static.typepad.com/.shared/themes/common/print.css" type="text/css" media="print" />
        <link rel="alternate" type="application/atom+xml" title="Posts on 'GetCOREInterface' (Atom)" href="https://getcoreinterface.typepad.com/blog/atom.xml" />
        <link rel="alternate" type="application/rss+xml" title="Posts on 'GetCOREInterface' (RSS 1.0)" href="https://getcoreinterface.typepad.com/blog/index.rdf" />
        <link rel="alternate" type="application/rss+xml" title="Posts on 'GetCOREInterface' (RSS 2.0)" href="https://getcoreinterface.typepad.com/blog/rss.xml" />

    <script src="//code.jquery.com/jquery.js"></script>

        <script type="text/javascript">
                var TPApp = {};
                TPApp.app_uri = "https://www.typepad.com/";
        </script>
<!-- why does this load from prod? -->
        <script type="text/javascript" src="https://static.typepad.com/.shared/js/yui/yahoo-dom-event.js,/js/app/thumbnail-gallery-min.js,/js/app/flyouts-min.js"></script>

<!--- head google analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-225723-36', 'auto', {'name': 'Typepad'}, {'allowLinker': true} );  // Separate tracker for Typepad.
ga('Typepad.require', 'linker');
ga('Typepad.linker:autoLink', ['none']);
ga('Typepad.set', 'dimension1', '6a019104a31725970c019104a321e0970c');
ga('Typepad.set', 'dimension2', 'Individual');
ga('Typepad.send', 'pageview');
</script>



    <script type="text/javascript" src="//tags.tiqcdn.com/utag/autodesk/typepad/prod/utag.js"></script>


        <link rel="alternate" type="application/atom+xml" title="Comments on 'MAXScript Custom Value Types from 3ds MAX SDK' (Atom)" href="https://getcoreinterface.typepad.com/blog/2023/01/custom-valuetype-maxscript/comments/atom.xml" />
        <link rel="alternate" type="application/rss+xml" title="Comments on 'MAXScript Custom Value Types from 3ds MAX SDK' (RSS 2.0)" href="https://getcoreinterface.typepad.com/blog/2023/01/custom-valuetype-maxscript/comments/rss.xml" />
        <title>MAXScript Custom Value Types from 3ds MAX SDK - GetCOREInterface</title>
        <link rel="start" href="https://getcoreinterface.typepad.com/blog/" title="Home" />
        <link rel="prev" href="https://getcoreinterface.typepad.com/blog/2022/04/3ds-max-2023-released.html?no_prefetch=1" title="3ds Max 2023 Released!" />
        <link rel="next" href="https://getcoreinterface.typepad.com/blog/2023/02/learning-3ds-max-sdk-my-journey.html?no_prefetch=1" title="Learning 3ds Max SDK - My Journey" />

    <script src="//code.jquery.com/jquery-1.11.2.min.js"></script>
</head>



<body class="layout-two-column-right post">
	
	<div id="container" class="container">
		<div id="container-inner" class="pkg">
			
                <div class="row">
     


<a id="home"></a>
   

              <div id="banner" class="jumbotron">
                <h1><a href="https://getcoreinterface.typepad.com/blog/" accesskey="1">GetCOREInterface</a></h1>
                <h2>3ds Max customization, automation, plug-in development, and related ramblings!</h2>
              </div>

     
     
      <div id="autocollapse" class="navbar navbar-default navbar-fixed-top">

<div class="navbar-inner">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="icon-bar"></span>
          </button>
         <a class="navbar-brand" href="https://getcoreinterface.typepad.com/blog/">home</a>
        </div>

        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
<li><a href="https://getcoreinterface.typepad.com/blog/archives.html">archives</a></li>
<li><a href="https://getcoreinterface.typepad.com/blog/kevin-vandecar.html">profile</a></li>
<li><a href="https://getcoreinterface.typepad.com/blog/atom.xml">subscribe</a></li>
<li><a href="https://twitter.com/kevinvandecar">twitter</a></li>
<li><a href="http://area.autodesk.com/">area</a></li>
<li><a href="http://area.autodesk.com/forum/autodesk-3ds-max/programming">forum</a></li>
<li><a href="http://www.autodesk.com/me-sdk-docs">api docs</a></li>

          </ul><!-- end main navbar -->
        </div><!--/.nav-collapse-->
</div><!--/.navbar-inner-->

      </div><!--/.navbar-->

     



			<div id="pagebody">


				<div id="pagebody-inner" class="pkg">
                                        <div id="alpha" class="col-xs-12 col-sm-8 col-md-8 col-lg-8">
						<div id="alpha-inner" class="pkg">
							<!-- the plain version removes the extra jquery -->
<!-- content nav -->
<p class="content-nav">
	<a class="content-nav-prev" href="https://getcoreinterface.typepad.com/blog/2022/04/3ds-max-2023-released.html">&laquo; 3ds Max 2023 Released!</a> |
	<a class="content-nav-main" href="https://getcoreinterface.typepad.com/blog/">Main</a>
	| <a class="content-nav-next" href="https://getcoreinterface.typepad.com/blog/2023/02/learning-3ds-max-sdk-my-journey.html">Learning 3ds Max SDK - My Journey &raquo;</a>
</p>
<script type="text/javascript">
   $(function(){
       var query = window.location.search.substring(1);
       if( query == "pintix=1" ) {
          var e=document.createElement('script');e.setAttribute('type','text/javascript');e.setAttribute('charset','UTF-8');e.setAttribute('src','https://static.typepad.com/.shared//js/pinmarklet.js?r='+Math.random()*99999999);document.body.appendChild(e);
       }
   });
</script>
<!-- entry -->

	<h2 class="date-header">01/30/2023</h2>


<div class="entry-category-c entry-category-maxscript entry-category-tiptrick entry-category-webcast entry-author-allan_k_koech entry-type-post entry" id="entry-6a019104a31725970c02af14aeecdd200b">
   <div class="entry-inner">
			<h3 class="entry-header">MAXScript Custom Value Types from 3ds MAX SDK</h3>
	



	<div class="entry-content">
		<div class="entry-body">
			<div>
<p><img alt="3ds Max Design Window" src="https://raw.githubusercontent.com/allankkoech/mne-blogs/master/img/20230120_1.jpg" /></p>
</div>
<div>
<h1 id="building-a-custom-value-type-for-maxscript">Building a custom value type for MAXScript</h1>
</div>
<div>
<p><strong>3ds MAX</strong> is a is a professional 3D computer graphics program that can be used to create 3D animations, models, games, and images. The power that it can do comes not only from the robust UI (User Interface) tools and ease of building plugins but also from the inbuilt scripting capability using Autodesk MAXScript. It is no doubt the power that MAXScript adds to 3ds Max. It is a great scripting method for automation, animation, object creation and manipulation. Lately, it has become the core of initiating 3ds Max Design Automation in the Autodesk Platform Services (formerly Forge).</p>
</div>
<div>
<h2 id="object-manipulation-using-maxscript">Object Manipulation using MAXScript</h2>
</div>
<div>
<p>To manipulate objects in scene (create, modify, animate, etc.), the returned object on the Maxscript side must give you access to the underlying exposed properties. Let us create a simple box object and look at the exposed properties that the object has.</p>
</div>
<div>
<ul>
<ul>
<li>
<p>Open 3ds MAX software and launch the Maxscript listener window (sample shown in the image below). To launch the listener window, check the steps outlined here <a href="https://knowledge.autodesk.com/support/3ds-max/learn-explore/caas/CloudHelp/cloudhelp/2015/ENU/3DSMax/files/GUID-C8019A8A-207F-48A0-985E-18D47FAD8F36-htm.html">https://knowledge.autodesk.com/support/3ds-max/learn-explore/caas/CloudHelp/cloudhelp/2015/ENU/3DSMax/files/GUID-C8019A8A-207F-48A0-985E-18D47FAD8F36-htm.html</a>.<br /><br /></p>
<p><img alt="3ds Max Design Window" src="https://raw.githubusercontent.com/allankkoech/mne-blogs/master/img/20230120_2.png" /></p>
</li>
</ul>
</ul>
<p>&#0160;</p>
<ul>
<ul>
<li>
<p>Let us create and add a box object to the scene. Add the command <code>box1 = box()</code>.</p>
<p><img alt="3ds Max Design Window" src="https://raw.githubusercontent.com/allankkoech/mne-blogs/master/img/20230120_3.png" /></p>
<p>&#0160;</p>
<p>The command above creates a primitive type of box object with the name Box001 at x,y,z (0,0,0) as shown below.</p>
<p><img alt="3ds Max Design Window" src="https://raw.githubusercontent.com/allankkoech/mne-blogs/master/img/20230120_4.png" /></p>
</li>
</ul>
</ul>
<p>&#0160;</p>
<ul>
<ul>
<li>
<p>Let us begin by viewing all the exposed properties of the box object. We use the command <code>getPropNames &lt;object_name&gt;</code> i.e., <code>getPropNames box1</code>. This returns a thorough list of properties <strong># (<em>#typeinCreationMethod, #typeInPos, #typeInLength, #typeInWidth, #typeInHeight, #length, #width, #height, #widthsegs, #lengthsegs, #heightsegs, #mapcoords, #realWorldMapSize</em>)</strong></p>
</li>
</ul>
</ul>
<p>&#0160;</p>
<ul>
<ul>
<li>
<p>We can therefore manipulate the created scene object by changing the values of the associated properties.</p>
<pre><code class="lang-python">  box1<span class="hljs-selector-class">.length</span> = <span class="hljs-number">45</span>
  box1<span class="hljs-selector-class">.width</span> = <span class="hljs-number">100</span>
  box1<span class="hljs-selector-class">.height</span> = <span class="hljs-number">300</span>
</code></pre>
<p><img alt="3ds Max Design Window" src="https://raw.githubusercontent.com/allankkoech/mne-blogs/master/img/20230120_5.png" /></p>
</li>
</ul>
</ul>
<p>&#0160;</p>
<ul>
<li>
<p>Resultant object on scene is as shown below (notice changes in size as compared to the initial box object)</p>
<img alt="3ds Max Design Window" src="https://raw.githubusercontent.com/allankkoech/mne-blogs/master/img/20230120_6.png" /></li>
</ul>
</div>
<div>
<blockquote>
<p>As noted, each object type on the 3ds MAX does pose some properties that can be manipulated from the MAXScript side. A similar approach can be used to view properties for other objects like <strong>Sphere</strong>, <strong>Cylinder</strong>, <strong>Cone</strong>, etc.</p>
</blockquote>
</div>
<div>
<p>&#0160;</p>
</div>
<div>
<h1 id="making-custom-properties">Making Custom Properties</h1>
</div>
<div>
<p>Building your own custom objects may require you to set up your own custom properties exposed to the MAXScript. This is important as many a times we use primitive objects to build complex objects that we may need to access and manipulate from the MAXScript. As such, any data exposed to MAXScript from the C++ side inherits from the Value type. You can read more about how Value type work in MAXScript here <a href="https://help.autodesk.com/view/MAXDEV/2023/ENU/?guid=GUID-911865D9-A5F9-4686-B01A-243308F41C55">https://help.autodesk.com/view/MAXDEV/2023/ENU/?guid=GUID-911865D9-A5F9-4686-B01A-243308F41C55</a>.</p>
</div>
<div>
<h2 id="creating-a-custom-value-type">Creating a Custom Value Type</h2>
</div>
<div>
<ul>
<ul>
<li>
<p>In your project, add a new class to your project, let us call it <code>CustomValue</code>, inheriting the <code>Value</code> type as shown below.</p>
<img alt="3ds Max Design Window" src="https://raw.githubusercontent.com/allankkoech/mne-blogs/master/img/20230120_7.png" /></li>
</ul>
</ul>
<p>&#0160;</p>
<ul>
<li>
<p>With that set, add the following snippets to your <code>.h</code> file</p>
<pre><code>
        #include &lt;maxscript/maxscript.h&gt;
        #include &lt;maxscript/foundation/numbers.h&gt;
        #include &lt;maxscript/foundation/3dmath.h&gt;
    
        #include &quot;resource.h&quot;

        #ifdef ScripterExport
        #undef ScripterExport
        #endif
        #define ScripterExport __declspec( dllexport )

        <span class="hljs-keyword">class</span> CustomValue : <span class="hljs-keyword">public</span> Value
        {
        <span class="hljs-keyword">public</span>:
            ENABLE_STACK_ALLOCATE(CustomValue);

            <span class="hljs-function"><span class="hljs-keyword">void</span>        <span class="hljs-title">collect</span><span class="hljs-params">()</span> </span>{ <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>; }
            <span class="hljs-function"><span class="hljs-keyword">void</span>        <span class="hljs-title">sprin1</span><span class="hljs-params">(CharStream* s)</span></span>;
            <span class="hljs-function">Value* <span class="hljs-title">get_property</span><span class="hljs-params">(Value** arg_list, <span class="hljs-keyword">int</span> count)</span></span>;
            <span class="hljs-function">Value* <span class="hljs-title">set_property</span><span class="hljs-params">(Value** arg_list, <span class="hljs-keyword">int</span> count)</span></span>;

            <span class="hljs-comment">// Generic commands for copying/deleting/showing properties/etc.</span>
            def_generic(<span class="hljs-keyword">delete</span>, <span class="hljs-string">&quot;delete&quot;</span>);
            def_generic(copy, <span class="hljs-string">&quot;copy&quot;</span>);
            def_generic(show_props, <span class="hljs-string">&quot;showProperties&quot;</span>);
            def_generic(get_props, <span class="hljs-string">&quot;getPropNames&quot;</span>);
        };

        
        </code></pre>
<ul>
<li>What do these functions do?
<ul>
<li><code>void sprin1(CharStream* s)</code> – returns a string representation of the object. When instantiating the object from MAXScript, a string is returned showing the default or set values.</li>
<li><code>Value* get_property(Value** arg_list, int count)</code> – Used to get property values into the MAXScript side. When a property is accessed from the MAXScript i.e., during computation, this function is called automatically, and it returns the current set value of the property.</li>
<li><code>Value* set_property(Value** arg_list, int count)</code> – Similar to get_property, but in this case use to pass a new value from the MAXScript to the c++. Basically, used to update property values. It is also called automatically when assigning a value to a property. I.e., <em>box1.pos = [0.5,3.4,5.6]</em></li>
<li><code>def_generic(get_props, &quot;getPropNames&quot;)</code> – Defines a generic property called <code>getPropNames</code> used in Maxscript to return all property names that can be accessed from MAXScript and maps it to an internal function in our class called <code>get_props</code>.</li>
</ul>
</li>
</ul>
<p>&#0160;</p>
<p>With all declarations done, let&#39;s now implement the functionality before adding new property types to our class.</p>
<pre><code class="lang-c++">    <span class="hljs-keyword">Value</span>* CustomValue::get_property(<span class="hljs-keyword">Value</span>** arg_list, <span class="hljs-built_in">int</span> <span class="hljs-built_in">count</span>)
    {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">Value</span>::get_property(arg_list, <span class="hljs-built_in">count</span>);
    }

    <span class="hljs-keyword">Value</span>* CustomValue::set_property(<span class="hljs-keyword">Value</span>** arg_list, <span class="hljs-built_in">int</span> <span class="hljs-built_in">count</span>)
    {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">Value</span>::set_property(arg_list, <span class="hljs-built_in">count</span>);
    }

    <span class="hljs-keyword">Value</span>* CustomValue::delete_vf(<span class="hljs-keyword">Value</span>** arg_list, <span class="hljs-built_in">int</span> <span class="hljs-built_in">count</span>)
    {
        <span class="hljs-keyword">return</span> &amp;ok;
    }


    <span class="hljs-keyword">Value</span>* CustomValue::copy_vf(<span class="hljs-keyword">Value</span>** arg_list, <span class="hljs-built_in">int</span> <span class="hljs-built_in">count</span>)
    {
        <span class="hljs-keyword">return</span> this;
    }

    void
    CustomValue::sprin1(CharStream* s)
    {
        // String reprentation of the <span class="hljs-keyword">data</span> ie Point3Vales
    }

    <span class="hljs-keyword">Value</span>* CustomValue::get_props_vf(<span class="hljs-keyword">Value</span>** arg_list, <span class="hljs-built_in">int</span> <span class="hljs-built_in">count</span>)
    {
        // getPropNames &lt;max_object&gt; [#dynamicOnly] -- returns array of prop names of wrapped obj

        MAXScript_TLS* _tls = (MAXScript_TLS*)TlsGetValue(thread_locals_index);
        one_typed_value_local_tls(Array * result);
        vl.result = new Array(<span class="hljs-number">0</span>);
        return_value_tls(vl.result);
    }

    <span class="hljs-keyword">Value</span>* CustomValue::show_props_vf(<span class="hljs-keyword">Value</span>** arg_list, <span class="hljs-built_in">int</span> <span class="hljs-built_in">count</span>)
    {
        // showProperties &lt;max_object&gt; [_T(<span class="hljs-string">&quot;prop_pat&quot;</span>)] [to:&lt;<span class="hljs-keyword">file</span>&gt;]   - applies to ref0 <span class="hljs-keyword">in</span> the wrapper

        <span class="hljs-keyword">return</span> &amp;false_value;
    }
</code></pre>
<p>&#0160;</p>
<p>Let us add new properties. First, a property is defined as follows.</p>
<ul>
<li><code>def_property(&lt;property name&gt;)</code> – Added to the class</li>
<li><code>Value* CustomValue::get_&lt;property name&gt;(Value** arg_list, int count)</code> – getter function for the property</li>
<li><code>Value* CustomValue::set_&lt;property name&gt;(Value** arg_list, int count)</code> – setter function for the property</li>
</ul>
<p>&#0160;</p>
<p>Let us create a couple of properties that can be manipulated from Max side. We define it as follows.</p>
<ul>
<li><code>Point3 m_pos</code> – A Point3 object that we intend to expose to MAXScript</li>
<li><code>def_property(pos)</code> – A property called pos that we will return the m_pos above</li>
<li><code>def_property(x)</code> – The x-coordinate of the Point3 m_pos created</li>
<li><code>def_property(y)</code> – The y-coordinate of the Point3 m_pos created</li>
<li><code>def_property(z)</code> – The z-coordinate of the Point3 m_pos created</li>
</ul>
<p>&#0160;</p>
<p>Consequently, lets create the setter and getter functions for each of the properties above i.e.,</p>
<pre><code class="lang-c++"><span class="hljs-keyword">Value</span>* CustomValue::get_pos(<span class="hljs-keyword">Value</span>** arg_list, <span class="hljs-built_in">int</span> <span class="hljs-built_in">count</span>)
{
    <span class="hljs-keyword">return</span> new Point3Value(m_pos);
}

<span class="hljs-keyword">Value</span>* CustomValue::set_pos(<span class="hljs-keyword">Value</span>** arg_list, <span class="hljs-built_in">int</span> <span class="hljs-built_in">count</span>)
{
    m_pos = arg_list[<span class="hljs-number">0</span>]-&gt;to_point3();
    <span class="hljs-keyword">return</span> arg_list[<span class="hljs-number">0</span>];
}
</code></pre>
<p>For the <strong><em>x,y,z</em></strong> properties, it is like the implementation above. Check the full code link attached for the implementation. Implement the <code>get_props_vf</code> function by adding the four properties to the result array.</p>
<h3 id="last-touches-">Last touches:</h3>
<ul>
<li>Added the 4 properties to the <code>get_props_vf()</code> function in the result array</li>
<li>Add a default constructor for the CustomValue and instantiate the <em>m_pos</em> variable to a Point3 value</li>
<li>Bonus, implement the <code>show_props_vf()</code> function in the <code>CustomValue.cpp</code></li>
</ul>
<p><br /><br /><br /></p>
<h1 id="bonus-tip-">Bonus Tip!</h1>
<h3 id="building-and-running-the-snippet-above">Building and Running the Snippet above</h3>
<hr />
<blockquote>
<p>This assumes you have already installed Visual Studio, 3ds MAX and 3ds MAX SDK. Check on how to setup the 3ds Max SDK and plugin wizard if you do not have that already. This is covered in the 3ds MAX documentation here <a href="http://help.autodesk.com/view/MAXDEV/2023/ENU/?guid=installing_the_plug-in_wizard_ap">http://help.autodesk.com/view/MAXDEV/2023/ENU/?guid=installing_the_plug-in_wizard_ap</a></p>
</blockquote>
<hr />
<p><br />To enable us to build and run our created class, we will be using a StaticInteface in a Global Utility interface (GUT) plugin type in 3ds MAX SDK. Let us first create a global utility object (GUT) using the Plugin Wizard. The wizard will create a barebone project with all required functions for us to implement them.</p>
<p>&#0160;</p>
<p><img alt="3ds Max Design Window" src="https://raw.githubusercontent.com/allankkoech/mne-blogs/master/img/20230120_8.png" /></p>
<p>&#0160;</p>
<p>Next, we will add a static interface to expose a static object to the 3ds MAX side. This is the instance we will be using when getting and manipulating properties from the MAXScript. In Visual Studio, add a new class, let us call it ADNStaticInterface and add the following snippets.</p>
<pre><code class="lang-c++"><span class="hljs-keyword">class</span> ADNStaticInterface : <span class="hljs-keyword">public</span> FPStaticInterface 
{

<span class="hljs-keyword">public</span>:

    <span class="hljs-comment">// The follow exposes our functions to Max</span>
    <span class="hljs-keyword">enum</span> FN_IDS {
        fn_run1
    };
    <span class="hljs-function">BEGIN_FUNCTION_MAP                
        <span class="hljs-title">FN_0</span><span class="hljs-params">(fn_run1, TYPE_VALUE, run1)</span></span>;
    END_FUNCTION_MAP

    <span class="hljs-comment">// Implement the functions exposed above</span>
    <span class="hljs-function">Value* <span class="hljs-title">run1</span><span class="hljs-params">()</span></span>;

    <span class="hljs-comment">// General purpose exposure</span>
    <span class="hljs-function"><span class="hljs-keyword">static</span> ADNStaticInterface* <span class="hljs-title">GetInstance</span><span class="hljs-params">()</span> </span>{ <span class="hljs-keyword">return</span> &amp;_theInstance; }

<span class="hljs-keyword">private</span>:
    DECLARE_DESCRIPTOR(ADNStaticInterface);

    <span class="hljs-comment">// The single instance of this class</span>
    <span class="hljs-keyword">static</span> ADNStaticInterface _theInstance;

    <span class="hljs-comment">// Point3CustomValue *m_customValue;</span>
    CustomValue* m_customValue;
};
</code></pre>
<p>We first begin by exposing our function to MAX; first an Enum of function ids <code>(fn_run1)</code></p>
<ul>
<li><code>Value* run1()</code> - This defines a function that will be called from Maxscript and returns a Value type. The return value object will allow manipulation of the properties.</li>
<li><code>static ADNStaticInterface* GetInstance()</code> – Returns a static access object</li>
</ul>
<p>&#0160;</p>
<p>Let us implement the declared functions. Beginning with the</p>
<pre><code class="lang-c++">
ADNStaticInterface ADNStaticInterface::_theInstance
(
    IADN_STATIC_INTERFACE, _T(<span class="hljs-string">&quot;ADN&quot;</span>), 0, NULL, FP_CORE,
    ADNStaticInterface::fn_run1, _T(<span class="hljs-string">&quot;run1&quot;</span>), 0, TYPE_VALUE, 0, 0,

    p_end
);
</code></pre>
<p>&#0160;</p>
<p>The function declares an ADN (Autodesk Developer Network) object that can be used from the MAX side to call the functions in the C++ side.</p>
<pre><code class="lang-c++">Value* ADNStaticInterface::run1()
{
    Point3Value* nValue = <span class="hljs-keyword">new</span> Point3Value(<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>);

    <span class="hljs-keyword">return</span> nValue;
}
</code></pre>
<p>&#0160;</p>
<p>The run1 function returns an object to the MAXScript side. We have just set up a Point3Value to be returned to the MAXScript. The Point3Value is a Point3 type which inherits from the Value class to enable exposing the values to MAXScript.</p>
<p>Let us build and run the code to test if all works so far. Run the project within visual studio, with 3ds MAX launched, open the MAXScript listener window and run the command <code>apt = adn.run1()</code>, you should be getting an output like below.</p>
<p>&#0160;</p>
<p><img alt="3ds Max Design Window" src="https://raw.githubusercontent.com/allankkoech/mne-blogs/master/img/20230120_9.png" /></p>
<p>&#0160;</p>
<p>If that works so far, let us now proceed to building our own custom value type. Remember all values exposed to Maxscript must be of the Value type (inherits from the value type).</p>
<p>&#0160;</p>
<p>Running the custom value to the Static Interface Attach the new CustomValue to the <code>ADNStaticInterface</code> class and return it in the <code>run1()</code> method.</p>
<ul>
<li>Include the custom value header to the <code>ADNStaticInterface.h</code></li>
<li>Add a private member object of the <code>CustomValue</code> type i.e., <code>CustomValue* m_value</code></li>
<li>In the <code>run1()</code> function, instantiate the CustomValue and return it from the function.</li>
</ul>
<p>&#0160;</p>
<p>Run the program and manipulate the properties as shown below.</p>
<p><img alt="3ds Max Design Window" src="https://raw.githubusercontent.com/allankkoech/mne-blogs/master/img/20230120_10.png" /></p>
<p>&#0160;</p>
<p>Check out the full project code attached or from the git link below. </p>
<p>&#0160;</p>
<p><a href="https://github.com/allankkoech/maxscript-custom-value-type-3dsmax/tree/master">Source Code on Github</a></p>
<p>&#0160;</p>
<p><br /><br /></p>
<hr />
<p>I hope that was quite descriptive way of creating your own custom value type for MAXScript. I would love to hear if you find better ways of doing it.</p>
<p>Any questions? Feel free to reach out. Cheers!</p>
</li>
</ul>
</div>
		</div>
		

                        <!-- SIGNATURE -->
                        

		
	</div>

	<div class="entry-footer">
			<p class="entry-footer-info">
				<span class="post-footers">Posted by <a rel="author" href="https://profile.typepad.com/allankoech">Allan K. Koech</a> at 02:05 AM in <a href="https://getcoreinterface.typepad.com/blog/c/">C++</a>, <a href="https://getcoreinterface.typepad.com/blog/maxscript/">MAXScript</a>, <a href="https://getcoreinterface.typepad.com/blog/tiptrick/">Tip/Trick</a>, <a href="https://getcoreinterface.typepad.com/blog/webcast/">webcast</a> </span> <span class="separator">|</span> <a class="permalink" href="https://getcoreinterface.typepad.com/blog/2023/01/custom-valuetype-maxscript.html">Permalink</a>
			</p>
		
		<!-- technorati tags -->


		<!-- post footer links -->
	<p class="entry-footer-share entry-footer-share-buttons">
		<span class="entry-footer-links-twitter">
     <a href="https://twitter.com/share?url=https%3A%2F%2Fgetcoreinterface.typepad.com%2Fblog%2F2023%2F01%2Fcustom-valuetype-maxscript.html&text=MAXScript%20Custom%20Value%20Types%20from%203ds%20MAX%20SDK" target="_blank"><img src="/.shared/images/circle-twitter.png" alt="Twitter" /></a>
</span>
	</p>


	</div>
   </div>
</div>



        
        
        <a id="comments"></a>
	<div class="comments" id="all-comments">
		<h3 class="comments-header">Comments</h3>
					<div class="comments-info">
				<p><a href="https://getcoreinterface.typepad.com/blog/2023/01/custom-valuetype-maxscript/comments/atom.xml"><img src="https://static.typepad.com/.shared/images/feed.png" alt="Feed" width="10" height="10" /></a> You can follow this conversation by subscribing to the <a href="https://getcoreinterface.typepad.com/blog/2023/01/custom-valuetype-maxscript/comments/atom.xml">comment feed</a> for this post.</p>
			</div>
		
		<div class="comments-content" id="comments-content">
                <!-- comment list -->

		</div>
        
	</div>
<script type="text/javascript">var c943723d42e77e9214eb884a1d898ea="</form>";</script>
<script type="text/javascript">var ffe51c373e0873b7778b6324a0b5533 = '<form id="comment-form" action="';</script>
<script type="text/javascript">var c943723d42e77e9214eb884a1d898za = '" method="post"><input type="hidden" name="entry_xid" id="comment-entry-xid" value="6a019104a31725970c02af14aeecdd200b" \/><input type="hidden" name="token" value="1756835343-6caa638bc5b77f308d5e482ccb7af216c8ab6c4c:9GagbFiQoshQD05Y" \/>';</script>
<script type="text/javascript">var OOcd55d4dc47109d7b462b01c7dd4dab = "aHR0cHM6Ly9nZXRjb3JlaW50ZXJmYWNlLnR5cGVwYWQuY29tLy5zZXJ2aWNlcy9jb21tZW50cw";</script>
<script type="text/javascript">var bad4dd7c10b264b7d90174cd4d55dc00 = atob(OOcd55d4dc47109d7b462b01c7dd4dab);</script>

<!-- comment-form-atp -->


<p class="comments-closed font-entrybody">
	The comments to this entry are closed.
</p>





    
    




						</div>
					</div>
                                        <div id="beta" class="well col-xs-12 col-sm-4 col-md-4 col-lg-4">
						<div id="beta-inner" class="pkg">
							
<!-- sidebar -->


	<div class="module-archives module">
		<h2 class="module-header"><a href="https://getcoreinterface.typepad.com/blog/archives.html">Archives</a></h2>
		<div class="module-content">
												<ul class="module-list">
				
				<li class="module-list-item"><a href="https://getcoreinterface.typepad.com/blog/2025/05/index.html">May 2025</a></li>
				
							
				<li class="module-list-item"><a href="https://getcoreinterface.typepad.com/blog/2024/01/index.html">January 2024</a></li>
				
							
				<li class="module-list-item"><a href="https://getcoreinterface.typepad.com/blog/2023/06/index.html">June 2023</a></li>
				
							
				<li class="module-list-item"><a href="https://getcoreinterface.typepad.com/blog/2023/04/index.html">April 2023</a></li>
				
							
				<li class="module-list-item"><a href="https://getcoreinterface.typepad.com/blog/2023/02/index.html">February 2023</a></li>
				
							
				<li class="module-list-item"><a href="https://getcoreinterface.typepad.com/blog/2023/01/index.html">January 2023</a></li>
				
							
				<li class="module-list-item"><a href="https://getcoreinterface.typepad.com/blog/2022/04/index.html">April 2022</a></li>
				
							
				<li class="module-list-item"><a href="https://getcoreinterface.typepad.com/blog/2021/05/index.html">May 2021</a></li>
				
							
				<li class="module-list-item"><a href="https://getcoreinterface.typepad.com/blog/2021/04/index.html">April 2021</a></li>
				
							
				<li class="module-list-item"><a href="https://getcoreinterface.typepad.com/blog/2020/05/index.html">May 2020</a></li>
									</ul>
									<p class="module-more"><a href="https://getcoreinterface.typepad.com/blog/archives.html">More...</a></p>
				
				
			
		</div>
	</div>

<!-- list_inlcude.tt  -->
<div id="about" class="module-typelist module">
<h2 class="module-header">About</h2>
	<div class="typelist-plain module-content">
		<ul class="module-list">
							<li class="module-list-item"><div class="typelist-note"><table> <tr> 
	<td> 
	<a href="https://getcoreinterface.typepad.com/blog/kevin-vandecar.html"> <img src="https://getcoreinterface.typepad.com/blog/KDV_Fall_Color_100.jpg"></a> <a href="https://getcoreinterface.typepad.com/blog/kevin-vandecar.html">Kevin Vandecar</a> <br> <br> 
	<a href="https://getcoreinterface.typepad.com/blog/denis-grigor.html"> <img src="https://getcoreinterface.typepad.com/blog/denis_grigor.jpg"></a> 
	<a href="https://getcoreinterface.typepad.com/blog/denis-grigor.html">Denis Grigor</a> <br> <br> 
	<a href="https://getcoreinterface.typepad.com/blog/allan-koech.html"> <img src="https://getcoreinterface.typepad.com/blog/allan-koech.jpg"></a> 
	<a href="https://getcoreinterface.typepad.com/blog/allan-koech.html">Allan Koech</a> 

	</td> </tr> </table> 
	
	<br> <a href="http://www.autodesk.com/joinadn" title="Information on the Autodesk Developer Network"> <img src="https://getcoreinterface.typepad.com/blog/join_adn.png" border="0" /> </a> <link rel="icon" href="/favicon.ico" type="image/x-icon" /> <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" /> <link rel="icon" type="image/gif" href="/favicon.gif" /> <meta name="application-name" content="GetCOREInterface" /> <meta name="msapplication-tooltip" content="Open GetCOREInterface blog" /> <meta name="msapplication-starturl" content="http://getcoreinterface.typepad.com" /> <meta name="msapplication-window" content="width=1024;height=768" /> <meta name="msapplication-navbutton-color" content="#000000" /> <meta name="msapplication-task" content="name=Search TtIf;action-uri=http://www.google.com/search?btnG=%C2%BB&domains=getcoreinterface.typepad.com&sitesearch=getcoreinterface.typepad.com;icon-uri=http://google.com/favicon.ico" /></div></li>
			
		</ul><!-- last /ul -->
	</div>
</div>
<!-- end list_include.tt -->

<!-- list_inlcude.tt  -->
<div id="google_search" class="module-typelist module">
<h2 class="module-header">Google Search</h2>
	<div class="typelist-plain module-content">
		<ul class="module-list">
							<li class="module-list-item"><div class="typelist-note"><script>
  (function() {
    var cx = '001717393972716514223:-ybiyil2pts';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search></div></li>
			
		</ul><!-- last /ul -->
	</div>
</div>
<!-- end list_include.tt -->

<!-- list_inlcude.tt  -->
<div id="translate" class="module-typelist module">
<h2 class="module-header">Translate</h2>
	<div class="typelist-plain module-content">
		<ul class="module-list">
							<li class="module-list-item"><div class="typelist-note"><div id='MicrosoftTranslatorWidget' class='Dark' style='color:white;background-color:#555555'>
</div>
<script type='text/javascript'>setTimeout(function(){{var s=document.createElement('script');s.type='text/javascript';s.charset='UTF-8';s.src=((location && location.href && location.href.indexOf('https') == 0)?'https://ssl.microsofttranslator.com':'http://www.microsofttranslator.com')+'/ajax/v3/WidgetV3.ashx?siteData=ueOIGRSKkd965FeEGM5JtQ**&ctf=True&ui=true&settings=Manual&from=en';var p=document.getElementsByTagName('head')[0]||document.documentElement;p.insertBefore(s,p.firstChild); }},0);</script>
</div></li>
			
		</ul><!-- last /ul -->
	</div>
</div>
<!-- end list_include.tt -->

<div class="module-calendar module">
	<h2 class="module-header">May 2025</h2>
	<div class="module-content table-responsive">
		<table class="table" summary="Monthly calendar with links to each day's posts">
                        <tr>
                                                                 <th>Sun</th>
                                                                 <th>Mon</th>
                                                                 <th>Tue</th>
                                                                 <th>Wed</th>
                                                                 <th>Thu</th>
                                                                 <th>Fri</th>
                                                                 <th>Sat</th>
                                
                        </tr>
                                                   <tr>
                                        <td>&nbsp;</td>
                                
                                                   
                                        <td>&nbsp;</td>
                                
                                                   
                                        <td>&nbsp;</td>
                                
                                                   
                                        <td>&nbsp;</td>
                                
                                                   
                                        <td>1</td>
                                
                                                   
                                        <td>2</td>
                                
                                                   
                                        <td>3</td>
                                </tr>
                                                   <tr>
                                        <td>4</td>
                                
                                                   
                                        <td>5</td>
                                
                                                   
                                        <td>6</td>
                                
                                                   
                                        <td>7</td>
                                
                                                   
                                        <td>8</td>
                                
                                                   
                                        <td>9</td>
                                
                                                   
                                        <td>10</td>
                                </tr>
                                                   <tr>
                                        <td>11</td>
                                
                                                   
                                        <td>12</td>
                                
                                                   
                                        <td>13</td>
                                
                                                   
                                        <td>14</td>
                                
                                                   
                                        <td>15</td>
                                
                                                   
                                        <td>16</td>
                                
                                                   
                                        <td>17</td>
                                </tr>
                                                   <tr>
                                        <td>18</td>
                                
                                                   
                                        <td>19</td>
                                
                                                   
                                        <td>20</td>
                                
                                                   
                                        <td>21</td>
                                
                                                   
                                        <td>22</td>
                                
                                                   
                                        <td>23</td>
                                
                                                   
                                        <td>24</td>
                                </tr>
                                                   <tr>
                                        <td>25</td>
                                
                                                   
                                        <td>26</td>
                                
                                                   
                                        <td>27</td>
                                
                                                   
                                        <td><a href="https://getcoreinterface.typepad.com/blog/2025/05/whats-new-in-3ds-max-2026.html">28</a></td>
                                
                                                   
                                        <td>29</td>
                                
                                                   
                                        <td><a href="https://getcoreinterface.typepad.com/blog/2025/05/upgrading-3ds-max-net-projects-from-net-framework-to-net-8.html">30</a></td>
                                
                                                   
                                        <td>31</td>
                                </tr>
                        
		</table>
	</div>
</div>
<!-- list_inlcude.tt  -->
<div id="rss_feed" class="module-typelist module">
<h2 class="module-header">RSS Feed</h2>
	<div class="typelist-plain module-content">
		<ul class="module-list">
							<li class="module-list-item"><div class="typelist-note"><a href="http://feeds.feedburner.com/autodesk/GetCoreInterface"><img src="https://getcoreinterface.typepad.com/feed.png" border="0" align="absmiddle">
&nbsp;Subscribe</a></div></li>
			
		</ul><!-- last /ul -->
	</div>
</div>
<!-- end list_include.tt -->

<div class="module-search module">
    <h2 class="module-header">Search</h2>
    <div class="module-content">
        <form id="search-blog" method="get" action="https://getcoreinterface.typepad.com/.services/blog/6a019104a31725970c019104a321e0970c/search" class="form-search form-inline" role="search">
            
<div class="form-group"><input type="search" name="filter.q" results="5" value="" class="form-control" placeholder="Search" /></div><button type="submit" value="Search" class="btn btn-default">Submit</button>

        </form>
    </div>
</div>
<!-- END Blog Search Module -->
	<div class="module-archives module">
		<h2 class="module-header">Recent Posts</h2>
		<div class="module-content">
			<ul class="module-list">
				
									<li class="module-list-item"><a href="https://getcoreinterface.typepad.com/blog/2025/05/upgrading-3ds-max-net-projects-from-net-framework-to-net-8.html">Upgrading 3ds Max .NET projects from .NET Framework to .NET 8</a></li>
					
				
									<li class="module-list-item"><a href="https://getcoreinterface.typepad.com/blog/2025/05/whats-new-in-3ds-max-2026.html">What's new in 3ds Max 2026?</a></li>
					
				
									<li class="module-list-item"><a href="https://getcoreinterface.typepad.com/blog/2025/05/porting-plugins-from-3ds-max-2024-to-3ds-max-2025.html">Porting Plugins from 3ds Max 2024 to 3ds Max 2025</a></li>
					
				
									<li class="module-list-item"><a href="https://getcoreinterface.typepad.com/blog/2024/01/saving-qwidget-docking-states-per-3ds-max-scene.html">Saving QWidget Docking States per 3ds Max Scene</a></li>
					
				
									<li class="module-list-item"><a href="https://getcoreinterface.typepad.com/blog/2023/06/porting-maxplus-to-pymxs-what-you-need-to-know-1.html">Porting MaxPlus to pymxs - What you need to know</a></li>
					
				
									<li class="module-list-item"><a href="https://getcoreinterface.typepad.com/blog/2023/04/3ds-max-2024-released.html">3ds Max 2024 Released!</a></li>
					
				
									<li class="module-list-item"><a href="https://getcoreinterface.typepad.com/blog/2023/02/learning-3ds-max-sdk-my-journey.html">Learning 3ds Max SDK - My Journey</a></li>
					
				
									<li class="module-list-item"><a href="https://getcoreinterface.typepad.com/blog/2023/01/custom-valuetype-maxscript.html">MAXScript Custom Value Types from 3ds MAX SDK</a></li>
					
				
									<li class="module-list-item"><a href="https://getcoreinterface.typepad.com/blog/2022/04/3ds-max-2023-released.html">3ds Max 2023 Released!</a></li>
					
				
									<li class="module-list-item"><a href="https://getcoreinterface.typepad.com/blog/2021/05/tips-for-troubleshooting-visual-studio-output-and-getting-qt-to-work-with-3ds-max-sdk.html">Tips for troubleshooting Visual Studio output and getting Qt to work with 3ds Max SDK</a></li>
					
				
			</ul>
		</div>
	</div>
<div class="module-categories module">
	<h2 class="module-header"><a href="https://getcoreinterface.typepad.com/blog/archives.html">Categories</a></h2>
	<div class="module-content">
                   <ul class="module-list">


                        <li class="module-list-item"><a href="https://getcoreinterface.typepad.com/blog/net-api/">.NET API <span class="category-count">(15)</span></a></li>



                        <li class="module-list-item"><a href="https://getcoreinterface.typepad.com/blog/announcement/">Announcement <span class="category-count">(24)</span></a></li>



                        <li class="module-list-item"><a href="https://getcoreinterface.typepad.com/blog/c/">C++ <span class="category-count">(21)</span></a></li>



                        <li class="module-list-item"><a href="https://getcoreinterface.typepad.com/blog/cloud-service/">Cloud Service <span class="category-count">(4)</span></a></li>



                        <li class="module-list-item"><a href="https://getcoreinterface.typepad.com/blog/cuiactioncommandadapter/">CuiActionCommandAdapter <span class="category-count">(4)</span></a></li>



                        <li class="module-list-item"><a href="https://getcoreinterface.typepad.com/blog/debug/">debug <span class="category-count">(4)</span></a></li>



                        <li class="module-list-item"><a href="https://getcoreinterface.typepad.com/blog/design-automation/">Design Automation <span class="category-count">(2)</span></a></li>



                        <li class="module-list-item"><a href="https://getcoreinterface.typepad.com/blog/devdocs/">DevDocs <span class="category-count">(3)</span></a></li>



                        <li class="module-list-item"><a href="https://getcoreinterface.typepad.com/blog/event/">Event <span class="category-count">(10)</span></a></li>



                        <li class="module-list-item"><a href="https://getcoreinterface.typepad.com/blog/forge/">Forge <span class="category-count">(7)</span></a></li>



                        <li class="module-list-item"><a href="https://getcoreinterface.typepad.com/blog/job/">job <span class="category-count">(2)</span></a></li>



                        <li class="module-list-item"><a href="https://getcoreinterface.typepad.com/blog/maxscript/">MAXScript <span class="category-count">(11)</span></a></li>



                        <li class="module-list-item"><a href="https://getcoreinterface.typepad.com/blog/open-position/">open position <span class="category-count">(1)</span></a></li>



                        <li class="module-list-item"><a href="https://getcoreinterface.typepad.com/blog/python/">Python <span class="category-count">(8)</span></a></li>



                        <li class="module-list-item"><a href="https://getcoreinterface.typepad.com/blog/qt/">qt <span class="category-count">(7)</span></a></li>



                        <li class="module-list-item"><a href="https://getcoreinterface.typepad.com/blog/samples-1/">Samples <span class="category-count">(3)</span></a></li>



                        <li class="module-list-item"><a href="https://getcoreinterface.typepad.com/blog/tiptrick/">Tip/Trick <span class="category-count">(10)</span></a></li>



                        <li class="module-list-item"><a href="https://getcoreinterface.typepad.com/blog/training/">Training <span class="category-count">(4)</span></a></li>



                        <li class="module-list-item"><a href="https://getcoreinterface.typepad.com/blog/webcast/">webcast <span class="category-count">(3)</span></a></li>



                        <li class="module-list-item"><a href="https://getcoreinterface.typepad.com/blog/weblogs/">Weblogs <span class="category-count">(1)</span></a></li>



                        <li class="module-list-item"><a href="https://getcoreinterface.typepad.com/blog/wpf/">WPF <span class="category-count">(2)</span></a></li>
</span>
		</ul>

<a style="font-size:85%;display:none;" class="cat-more" href="https://getcoreinterface.typepad.com/blog/archives.html">See More</a>
	</div>
</div>





						</div>
					</div>
				</div>
			</div>
</div> <!-- row -->
			


<!-- container-footer -->
<div id="footer">
<div class="row well"><div class="col-md-12">
	<div id="footer-inner">
		<ul class="footer-list pkg list-inline" >
			<li class="last-footer-list-item footer-list-item"><a href="https://getcoreinterface.typepad.com/blog/">GetCOREInterface</a></li>
		</ul>
	</div>
</div></div>
</div>

		</div>
	</div>
	








    <!-- Bootstrap core JavaScript
    ================================================== -->
    <script src="/.shared/themes/common/bootstrap/js/bootstrap.min.js"></script>

<script type="text/javascript">
     function autocollapse() {
        var navbar = jQuery('#autocollapse'); navbar.removeClass('collapsed');
            if(navbar.innerHeight() > 50) {
               navbar.addClass('collapsed');
               $('.navbar button').css("visibility","visible");
             }
     }
autocollapse();

$('.navbar-nav,.navbar-header').fadeIn('slow');
jQuery(window).on('resize', autocollapse);
</script>





<script type="text/javascript">
function resizebanner() {
     var $div = $('#banner');
     bg = $div.css('background-image');
       if (bg) {
         var src = bg.replace(/(^url\()|(\)$|[\"\'])/g, '');
           $img = $('<img>').attr('src', src).on('load', function() {
              var img = new Image;
              img.src = src;
              var imgW = img.width;
              var imgH = img.height;             
              var newW = $('#banner').width();
              var newH = imgH / imgW * newW;
       $('#banner').height(newH);
       $('#banner').css('visibility', 'visible');
      });//end when loaded
  }//end if bg
}//end 
    (function($) {
       $(document).on('ready', resizebanner);
       $(window).on('resize', resizebanner);
    })(jQuery);
</script>



<script type="text/javascript">
<!--
var extra_happy = Math.floor(1000000000 * Math.random());
document.write('<img src="https://www.typepad.com/t/stats?blog_id=112876564355520268&amp;user_id=&amp;page=' + escape(location.href) + '&amp;referrer=' + escape(document.referrer) + '&amp;i=' + extra_happy + '" width="1" height="1" alt="" style="position: absolute; top: 0; left: 0;" />');
// -->
</script>




<!-- Begin disqus Tag -->

<!-- End disqus Tag -->
</body>
</html>

<!-- ph=1 -->
