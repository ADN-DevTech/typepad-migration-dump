---
layout: "post"
title: "New API changes for Maya 2017 updates 2"
date: "2016-12-06 14:53:00"
author: "Zhong Wu"
categories:
  - "Autodesk"
  - "C++"
  - "Maya"
  - "Plug-in"
  - "Rendering"
  - "Shader"
  - "Zhong Wu"
original_url: "https://around-the-corner.typepad.com/adn/2016/12/new-api-changes-for-maya-2017-updates-2.html "
typepad_basename: "new-api-changes-for-maya-2017-updates-2"
typepad_status: "Publish"
---

<p>Some of you may already know about this, but I think I still need to emphasize it again here. In the past, we used to have Service Packs and Extensions after the Maya main release. But starting from Maya 2017, we will not provide Service Packs or Extensions any more, instead, will use Maya Updates to maintain and update the software regularly, providing new features, and quicker fixes to customer issues. </p>  <p>For our plugin developers, one important thing you should be aware of is that the Maya API binary compatibility will not be broken in any 2017 updates, however, the API may be extended to enable new features. </p>  <p>So far, Maya 2017 released 2 updates, if you want to know the features/improvement that have been included in these 2 updates, please check the following page: </p>  <ul>   <li><a href="http://help.autodesk.com/view/MAYAUL/2017/ENU/?guid=GUID-0617A132-1B57-474F-A656-6E71A002CA28">What’s New in Maya 2017 Update 1</a> </li>    <li><a href="http://help.autodesk.com/view/MAYAUL/2017/ENU/?guid=GUID-3B5C8FF8-5EC4-4981-8B83-4535C73D3A1C">What’s New in Maya 2017 Update 2</a> </li> </ul>  <p>If you want to know where to download and how to install these updates, please refer my previous blog of “<a href="http://around-the-corner.typepad.com/adn/2016/12/recent-new-releases-nov-2016-1-1.html">Recent new releases (Nov. 2016)</a>”. </p>  <p>OK, now let’s focus on the API changes in Maya 2017 update 2, here are the details: </p>  <ul>   <li><b><b>Shading </b></b>      <br />      <p>Let’s talk about the new added method <b>MShaderInstance::writeEffectSourceToFile()</b>, the method is easy to understand, it’s used to write the final effect source to a file so you can perform validation on custom shader fragments on all device APIs. It’s used for debugging to see how fragments are turned into the final effect for the current drawing API. Note that the effect will not be written if the effect is not generated from shader fragments or any of the shader fragments is marked as hidden.</p>   </li>    <li><b><b>Lighting</b></b>       <br />      <p>Another improvement is about “<b>Lighting</b>” support, and I want to talk more and highlight it here. Actually, the “<b>Lighting</b>” feature is continuously improved since it was first supported from Maya 2016 Extension 2. Let’s see the history of evolvement: </p>      <p><b><b>Maya 2016 Extension 2: </b></b></p>      <p>Developer can create a plug-in shape which is classified generally as a light, to be recognized as a lighting contributor, the classfication string “light” is required, and the only possible sub-classifications are those available for internal Maya lights, they include “ambientLight”, “pointLight”, “directionalLight”, “spotlight” and “volumeLight”, the possible classification for your light shape should be one of the following: </p>      <ul>       <li>&quot;light:drawdb/light/ambientLight&quot;. </li>        <li>&quot;light:drawdb/light/pointLight&quot;. </li>        <li>&quot;light:drawdb/light/directionalLight&quot;. </li>        <li>&quot;light:drawdb/light/spotlight&quot;. </li>        <li>&quot;light:drawdb/light/volumeLight&quot;. </li>     </ul>      <p>The classification allows for the usage of the internal light and UI (geometry drawing) VP2 evaluators to be used. There is no explicit VP2 override class used as the internal VP2 geometry evaluator will handle drawing. </p>      <p>Also, be noted that if you use the “<b>light</b>” classification, you must include these light attributes: intensity, color, emitDiffuse, andemitSpecular, in order for the light to behave like a Maya light. </p>      <p>For the details, you can check the new added sample “apiDirectionalLightShape”, it demonstrated how to add a plug-in light, you can also refer the <a href="http://help.autodesk.com/view/MAYAUL/2017/ENU/?guid=__files_GUID_1DBFC5FE_0A84_43C8_8F45_4875CEFC1F11_htm">User Doc </a>to see how it works with the new Light Editor. </p>      <p><b><b>Maya 2017:</b></b> </p>      <p>The “Lighting” feature was improved, developer now can combine a custom draw override with internal Viewport 2.0 lighting support. For dag objects that wish to contribute lighting as well as have custom drawing, it is possible to have two “drawdb” classifications: one that starts with “light” and one that starts with “geometry”. The classification for the node should be something like <b><b>&quot;light:drawdb/light/directionalLight:drawdb/geometry/light/directionalLightCustom&quot;.</b></b> </p>      <p>Then, in order for the override of a plug-in node to represent the drawing of a light, the “<b>drawdb/geometry/light</b>” classification string should be used when registering the override; for example, a classification string such as “<b>drawdb/geometry/light/</b><b><b>directionalLightCustom</b></b>” could be used for above sample node. My colleague Vijaya also posted a <b><a href="http://around-the-corner.typepad.com/adn/2016/10/light-draw-override-in-viewport-20.html"><b>blog</b><b> post</b> </a></b>which talking some about this. </p>      <p>Btw, only classifications for draw and geometry overrides can be registered along with “<b>drawdb/light</b>”. Overrides such as “<b>drawdb/subscene</b>”, for example, are not allowed. </p>      <p>Also, the devkit sample “<b><b>apiDirectionalLightShape</b></b>” is also improved to have a customized VP 2.0 override named “<b><b>apiDirectionalLightShape_GeometryOverride</b></b>” demonstrate the usage, it create a different drawing as the blue arrow that is shown in the following picture. You can check that sample for more details. </p>     <a href="http://around-the-corner.typepad.com/.a/6a0163057a21c8970d01b7c8b8b9f9970b-pi"><img title="light" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; float: none; padding-top: 0px; padding-left: 0px; margin-left: auto; display: block; padding-right: 0px; border-top-width: 0px; margin-right: auto" border="0" alt="light" src="/assets/image_27b1e8.jpg" width="359" height="217" /></a>&#160; <p><b><b>Maya 2017 Update 2:</b></b> </p>      <p>There are 2 improvement for “Lighting” feature. </p>      <p>The 1st one is the “Exposure” attribute for a light node. Besides the intensity, color, emitDiffuse, andemitSpecular attributes that must be included for a light node, the “Exposure” attribute is also parsed for internal light evaluation. For demonstration, the devkit sample “<b>apiDirectionalLightShape</b>” is updated to include this new attribute for all these light nodes. </p>      <p>The 2nd improvement is about the new classification of “<b>drawdb/light/image</b>”. Now developer can use this new classification to register a plug-in node so that it behaves like an internal IBL (Image Based Lighting) light. I do suggest you to talk a look at this <a href="http://help.autodesk.com/view/MAYAUL/2017/ENU/?guid=__files_GUID_1197A381_38B5_4276_BA3A_72A86269D37D_htm"><b><b>introduction doc</b></b> </a>about this new light type if you are interested. Also, the “<b>apiDirectionalLightShape</b>” sample is updated to include the new type of “<b>apiImageLightShape</b>”, if you get the new devkit for Maya 2017 update 2 which is located at<u> <a href="https://apps.autodesk.com/MAYA/en/Detail/Index?id=8656206734503135164&amp;os=Win64&amp;appLang=en">Autodesk Maya App Store</a></u>, you can check the implementation, it should be pretty straightforward. </p>   </li> </ul>
