comments:
- author: Leo
  email: leipogs23@yahoo.com
  ip: 119.92.127.194
  url: ''
  date: '2013-01-30 01:29:01'
  body: 'I used a similar approach saving a file with password.

    But opening it using:


    (vla-open activedoc fileName :vlax-false "MyPass")


    returns an error:

    ; error: Automation Error. Error Decrypting Data


    Any idea?


    Thanks in advance'
- author: Augusto Goncalves
  email: ''
  ip: 200.57.88.172
  url: http://profile.typepad.com/6p0168e7e7c9dd970c
  date: '2013-01-30 03:30:20'
  body: 'Hi Leo,


    I tried with the code below and worked fine. Are you sure the password is correct?


    (setq filename "c:/temp/password.dwg")

    (setq password "MyPass")

    (setq docs (vla-get-documents (vlax-get-acad-object)))

    (vla-open docs filename :vlax-false password)'
- author: Leo
  email: leipogs23@yahoo.com
  ip: 122.52.96.242
  url: ''
  date: '2013-01-30 18:34:16'
  body: "(defun c:lock ()\n\t(setq secparam  \n\t(vla-getinterfaceobject (vlax-get-acad-object)\
    \ \n\t(strcat \"autocad.securityparams.19\"))) \n\n\t(vla-put-Action secparam\
    \ 1)\n\t(vla-put-Algorithm secparam 26625)\n\t(vla-put-KeyLength secparam 40)\n\
    \t(vla-put-password secparam \"MyPass\")\n\t(vla-put-ProviderName secparam  \n\
    \t\"Microsoft Base Cryptographic Provider v1.0\")\n\t(vla-put-ProviderType secparam\
    \ 1\n\n\t(setq activedoc (vla-get-ActiveDocument (vlax-get-Acad-Object))) \n\t\
    (setq fileName \"c:\\\\temp\\\\passwordFile.dwg\") \n\t(setq version 60\n\t(vlax-invoke-method\
    \ activedoc 'SaveAs fileName version secparam)\n\t(alert \"You successfully locked\
    \ this drawing.\")\n(princ)\n)\n(defun c:un_lock ()\n\t(setq filename \"c:/temp/passwordFile.dwg\"\
    )\n\t(setq password \"MyPass\")\n\t(setq docs (vla-get-documents (vlax-get-acad-object)))\n\
    \t(vla-open docs filename :vlax-false password)\n(princ)\n)\n(princ)\n\nSir,\n\
    \nThis is what I have so far.\nI changed \"c:/temp/password.dwg\" to \"c:/temp/passwordFile.dwg\"\
    \n\nlock - should lock the drawing (OK)\nun_lock - should open the drawing without\
    \ password popup (Not OK, still popup the password, if cancel then error)\n\n\
    I also tried different values of \"dwgcheck\" variable but still not OK\n\nThank\
    \ you very much for the time sir."
- author: Leo
  email: leipogs23@yahoo.com
  ip: 119.92.127.194
  url: ''
  date: '2013-02-12 18:15:15'
  body: 'Got it to work only for insert.


    (vla-InsertBlock obj pnt filName 1 1 1 0 "MyPass")



    Thank you sir,'
- author: nath
  email: n.nathi@hotmail.com
  ip: 27.145.120.242
  url: ''
  date: '2016-10-04 23:53:17'
  body: "it doesn't work.\n;errors: Automation Error. Invalid argument\n\nso i replace\
    \ the first line as below to work with another version.\n\n(setq secparam (vla-getinterfaceobject\
    \ (vlax-get-acad-object) (strcat \n\"autocad.securityparams.\" (rtos (fix (atof\
    \ (getvar \"ACADVER\"))) 2 0))))\n\nthen got error\n; error: Automation Error.\
    \ Error saving the document\n\nand i tried to change version to 61, it saves as\
    \ DXF without error.\n\nPlease help.\nthanks."
- author: Zakaria
  email: zakaria.kazi@ymail.com
  ip: 86.98.154.216
  url: ''
  date: '2016-11-16 02:04:55'
  body: 'Dear Nath,


    In AutoCAD 2016 and up, this feature is not supported.

    -----'
