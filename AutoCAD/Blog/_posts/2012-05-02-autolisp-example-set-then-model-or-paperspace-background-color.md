---
layout: "post"
title: "AutoLISP Example - set the model or paperspace background color"
date: "2012-05-02 18:53:18"
author: "Wayne Brill"
categories:
  - "AutoCAD"
  - "LISP"
  - "Wayne Brill"
original_url: "https://adndevblog.typepad.com/autocad/2012/05/autolisp-example-set-then-model-or-paperspace-background-color.html "
typepad_basename: "autolisp-example-set-then-model-or-paperspace-background-color"
typepad_status: "Publish"
---

<p>Here is a function that shows how to change the background colors using the ActiveX interface from VisualLISP.</p>  <p>By <a href="http://adndevblog.typepad.com/autocad/wayne-brill.html" target="_self">Wayne Brill</a></p>  <p>(defun SetBkColor ()    <br />&#160; (setq acad (vlax-get-acad-object)     <br />&#160;&#160;&#160; pref (vla-get-Preferences acad)     <br />&#160;&#160;&#160; disp (vla-get-Display pref)     <br />&#160;&#160;&#160; newColr (vlax-make-variant 255 19)     <br />&#160; );setq</p>  <p>&#160; (if (= (getvar &quot;tilemode&quot;) 1)    <br />&#160;&#160; ;;change the modelspace background color     <br />&#160;&#160;&#160; (progn     <br />&#160;&#160;&#160;&#160;&#160; (setq oldColr (vla-get-GraphicsWinModelBackgrndColor disp)     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ;;convert unsupported variant type 19 to vlax-vbLong     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; oldColrLong (vlax-variant-change-type     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; (vla-get-GraphicsWinModelBackgrndColor disp)     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; vlax-vbLong)     <br />&#160;&#160;&#160;&#160;&#160; );setq</p>  <p>&#160;&#160;&#160;&#160;&#160; (vla-put-GraphicsWinModelBackgrndColor disp newColr)    <br />&#160;&#160;&#160;&#160;&#160; (alert (strcat &quot;Restore previous background color: &quot;     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (itoa (vlax-variant-value oldColrLong))))     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ;;restore previous model background color     <br />&#160;&#160;&#160;&#160;&#160; (vla-put-GraphicsWinModelBackgrndColor disp oldColr)     <br />&#160;&#160; );progn</p>  <p>&#160;&#160;&#160; ;;change the paperspace (layout) background color    <br />&#160;&#160; (progn     <br />&#160;&#160;&#160;&#160; (setq oldColr (vla-get-GraphicsWinLayoutBackgrndColor disp)     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ;;convert unsupported variant type 19 to vlax-vbLong     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; oldColrLong (vlax-variant-change-type     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; (vla-get-GraphicsWinLayoutBackgrndColor disp)     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; vlax-vbLong)     <br />&#160;&#160;&#160;&#160; );setq     <br />&#160;&#160;&#160;&#160; (vla-put-GraphicsWinLayoutBackgrndColor disp newColr)     <br />&#160;&#160;&#160;&#160; (alert (strcat &quot;Restore previous background color: &quot;     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (itoa (vlax-variant-value oldColrLong))))     <br />&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160; ;;restore previous paper space background color     <br />&#160;&#160;&#160; (vla-put-GraphicsWinLayoutbackgrndColor disp oldColr)     <br />&#160;&#160; );progn     <br />);if     <br />) </p>
