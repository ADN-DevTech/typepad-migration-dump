---
layout: "post"
title: "Plant SDK: How can I obtain the current drawing's ID?"
date: "2012-12-26 01:58:14"
author: "Marat Mirgaleev"
categories:
  - ".NET"
  - "2011"
  - "2012"
  - "Marat Mirgaleev"
  - "Plant3D"
  - "PnID"
original_url: "https://adndevblog.typepad.com/autocad/2012/12/plant-sdk-how-can-i-obtain-the-current-drawings-id.html "
typepad_basename: "plant-sdk-how-can-i-obtain-the-current-drawings-id"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/marat-mirgaleev.html" target="_self">Marat Mirgaleev</a></p>  <p><b>Issue</b></p>  <p><em>I can easily find the filename of the current drawing, but not its ID. Can you help me, please?</em></p>  <p><a name="section2"></a></p>  <p><b>Solution</b></p>  <p>You can find the current PnPProjectDrawing object in the list of the current project's drawings, then get the Id property of this PnPProjectDrawing:</p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt"></div>  <div style="font-family: Courier New; font-size: 8pt; color: black; background: white;"> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; [CommandMethod(</span><span style="color: #a31515; line-height: 140%;">&quot;FiID&quot;</span><span style="line-height: 140%;">)]</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">public</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">static</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">void</span><span style="line-height: 140%;"> FindTheDwgId()</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; {</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; &nbsp; Editor ed =Application.DocumentManager.MdiActiveDocument.Editor;</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">int</span><span style="line-height: 140%;"> foundId = -1;</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; &nbsp; Project prj =PnPProjectUtils.GetProjectPartForCurrentDocument();</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; &nbsp; System.Collections.Generic.</span><span style="color: #2b91af; line-height: 140%;">List</span><span style="line-height: 140%;">&lt;PnPProjectDrawing&gt; dwgList = </span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; prj.GetPnPDrawingFiles();</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">foreach</span><span style="line-height: 140%;"> (PnPProjectDrawing dwg </span><span style="color: blue; line-height: 140%;">in</span><span style="line-height: 140%;"> dwgList)</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; &nbsp; {&nbsp; &nbsp; &nbsp; &nbsp; </span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; &nbsp; &nbsp; ed.WriteMessage(</span><span style="color: blue; line-height: 140%;">string</span><span style="line-height: 140%;">.Format(</span><span style="color: #a31515; line-height: 140%;">&quot;\n--Filename: {0}, Id: {1}&quot;</span><span style="line-height: 140%;">, </span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; dwg.AbsoluteFileName, dwg.Id));</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; &nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;">( </span><span style="color: #2b91af; line-height: 140%;">String</span><span style="line-height: 140%;">.Equals( Application.DocumentManager.</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MdiActiveDocument.Database.Filename,</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dwg.ResolvedFilePath, </span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span style="color: #2b91af; line-height: 140%;">StringComparison</span><span style="line-height: 140%;">.InvariantCultureIgnoreCase))</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; &nbsp; &nbsp; {</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foundId = dwg.Id;</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">break</span><span style="line-height: 140%;">;</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; &nbsp; &nbsp; }</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; &nbsp; }</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; &nbsp; ed.WriteMessage(</span><span style="color: blue; line-height: 140%;">string</span><span style="line-height: 140%;">.Format(</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span style="color: #a31515; line-height: 140%;">&quot;\nThe Id of the current drawing is: {0}&quot;</span><span style="line-height: 140%;">, foundId));</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; } </span><span style="color: green; line-height: 140%;">// FindTheDwgId()</span></p> <p style="margin: 0px;">&nbsp;</p> </div>
