---
layout: "post"
title: "How to get the Symbol Style currently used for an Asset in AutoCAD Plant3d P&amp;ID"
date: "2012-05-08 05:47:39"
author: "Fenton Webb"
categories: []
original_url: "https://adndevblog.typepad.com/autocad/2012/05/how-to-get-the-symbol-style-currently-used-for-an-asset-in-autocad-plant3d-pid.html "
typepad_basename: "how-to-get-the-symbol-style-currently-used-for-an-asset-in-autocad-plant3d-pid"
typepad_status: "Publish"
---

<p>by <a title="Fenton Webb, DevTech, Autodesk" href="http://adndevblog.typepad.com/autocad/fenton-webb.html">Fenton Webb</a></p>  <p>I saw this <a href="http://forums.autodesk.com/t5/AutoCAD-P-ID/Symbol-style-used-graphical-symbol-net-interface/td-p/3438489">post</a> on the newsgroups and I thought I should document it here for our subscribers to see…</p>  <p>Thanks to <a href="http://forums.autodesk.com/t5/user/viewprofilepage/user-id/401749">Jorge Lopez</a> and a very keen forums contributor programmer <a href="http://forums.autodesk.com/t5/user/viewprofilepage/user-id/728204">Anthony Perks</a> for their efforts with this post.</p>  <p>Here is the code which displays an Asset’s style name…</p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">// display a selected Asset's style name, by Jorge Lopez, 8/May/2012</font></font></span></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">[</font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">CommandMethod</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;LISTSTYLE&quot;</font></span><font color="#000000">, </font><span style="color: "><font color="#2b91af">CommandFlags</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Modal</font></span><font color="#000000">)]</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">public</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#0000ff">static</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">ListStyle</font></span><font color="#000000">()</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">{</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">Editor</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">oEditor</font></span><font color="#000000"> = </font><span style="color: "><font color="#2b91af">AcadApp</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">DocumentManager</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">MdiActiveDocument</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Editor</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">PromptEntityOptions</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">oPromptOptions</font></span><font color="#000000"> = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">PromptEntityOptions</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;Select an object&quot;</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">PromptEntityResult</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">oPromptResult</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">oEditor</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">GetEntity</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">oPromptOptions</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">oPromptResult</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Status</font></span><font color="#000000"> != </font><span style="color: "><font color="#2b91af">PromptStatus</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">OK</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160; {</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160; }</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">Database</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">oDB</font></span><font color="#000000"> = </font><span style="color: "><font color="#2b91af">AcadApp</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">DocumentManager</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">MdiActiveDocument</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Database</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">TransactionManager</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">oTxMgr</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">oDB</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">TransactionManager</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">using</font></span><font color="#000000"> (</font><span style="color: "><font color="#2b91af">Transaction</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">oTx</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">oTxMgr</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">StartTransaction</font></span><font color="#000000">())</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160; {</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">DBObject</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">obj</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">oTx</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">GetObject</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">oPromptResult</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">ObjectId</font></span><font color="#000000">, </font><span style="color: "><font color="#2b91af">OpenMode</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">ForRead</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">Asset</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">oAsset</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">obj</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">as</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">Asset</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">/* Get the style's object id */</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">ObjectId</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">styleId</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">oAsset</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">StyleId</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (!</font><span style="color: "><font color="#010001">styleId</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">IsNull</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">/* Display the style's name */</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">Style</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">oStyle</font></span><font color="#000000"> = (</font><span style="color: "><font color="#2b91af">Style</font></span><font color="#000000">)</font><span style="color: "><font color="#010001">oTx</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">GetObject</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">styleId</font></span><font color="#000000">, </font><span style="color: "><font color="#2b91af">OpenMode</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">ForRead</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">string</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">strMsg</font></span><font color="#000000"> = </font><span style="color: "><font color="#a31515">&quot;\n&quot;</font></span><font color="#000000"> + </font><span style="color: "><font color="#010001">oStyle</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Name</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">oEditor</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">WriteMessage</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">strMsg</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">/* If it is an asset style then display the block name */</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">AssetStyle</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">oAssetStyle</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">oStyle</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">as</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">AssetStyle</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">oAssetStyle</font></span><font color="#000000"> != </font><span style="color: "><font color="#0000ff">null</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; {</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">ObjectId</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">btrId</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">oAssetStyle</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">BlockTableRecord</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">BlockTableRecord</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">oBTR</font></span><font color="#000000"> = (</font><span style="color: "><font color="#2b91af">BlockTableRecord</font></span><font color="#000000">)</font><span style="color: "><font color="#010001">oTx</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">GetObject</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">btrId</font></span><font color="#000000">, </font><span style="color: "><font color="#2b91af">OpenMode</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">ForRead</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">strMsg</font></span><font color="#000000"> = </font><span style="color: "><font color="#a31515">&quot;\n&quot;</font></span><font color="#000000"> + </font><span style="color: "><font color="#010001">oBTR</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Name</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">oEditor</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">WriteMessage</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">strMsg</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; }</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">oTx</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Commit</font></span><font color="#000000">();</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160; }</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">}</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p> </div>
