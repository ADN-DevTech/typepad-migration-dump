---
layout: "post"
title: "MEASURE command using SendCommand in VB.NET"
date: "2013-01-31 17:06:09"
author: "Fenton Webb"
categories:
  - ".NET"
  - "2010"
  - "2011"
  - "2012"
  - "2013"
  - "ActiveX"
  - "AutoCAD"
  - "Fenton Webb"
original_url: "https://adndevblog.typepad.com/autocad/2013/01/measure-command-using-sendcommand-in-vbnet.html "
typepad_basename: "measure-command-using-sendcommand-in-vbnet"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/fenton-webb.html">Fenton Webb</a></p>  <p><b>Issue</b></p>  <p>Is there an example showing how to use the MEASURE command with the ActiveX SendCommand method from AutoCAD VB.NET?</p>  <p><a name="section2"></a></p>  <p><b>Solution</b></p>  <p>Below is a VB.NET example. Add the following references to the VB.NET Class Library Project:</p>  <ul>   <li><strong>acmgd.dll </strong></li>    <li><strong>Autodesk.AutoCAD.Interop.Common.dll </strong></li>    <li><strong>Autodesk.AutoCAD.Interop.dll</strong><strong>&#160;</strong> </li> </ul>  <p>NOTE: acdbmgd.dll is not required for this example, as it does not use any .NET database entities.</p>  <p>Another NOTE: be aware that whenever your reference COM interop assemblies, you are instantly tying yourself to the processor type, therefore you will need to consider x86 and x64 build types â€“ Any CPU is not advisable.</p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">Imports</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#010001">Autodesk</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">AutoCAD</font></span><font color="#000000">.</font></font><span style="color: "><font style="font-size: 8pt" color="#010001">Runtime</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">Imports</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#010001">Autodesk</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">AutoCAD</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Interop</font></span><font color="#000000">&#160;&#160; </font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">Imports</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#010001">Autodesk</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">AutoCAD</font></span><font color="#000000">.</font></font><span style="color: "><font style="font-size: 8pt" color="#010001">ApplicationServices</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">Imports</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#010001">Autodesk</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">AutoCAD</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Interop</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Common</font></span></font></font><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&lt;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">CommandMethod</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;MYMEASURE&quot;</font></span><font color="#000000">, </font><span style="color: "><font color="#a31515">&quot;MYMEASURE&quot;</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">Autodesk</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">AutoCAD</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Runtime</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">CommandFlags</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Transparent</font></span><font color="#000000">)&gt; _</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">Public</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#0000ff">Sub</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">MYMEASURE</font></span><font color="#000000">()</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Dim</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">app</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">AcadApplication</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">Autodesk</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">AutoCAD</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">ApplicationServices</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Application</font></span><font color="#000000">.</font></font><span style="color: "><font style="font-size: 8pt" color="#010001">AcadApplication</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Dim</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">obj1</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">obj2</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">Object</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">Try</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">'Use ActiveX GetEntity function, as we only want to select a single entity</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">app</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">ActiveDocument</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Utility</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">GetEntity</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">obj1</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">obj2</font></span><font color="#000000">, </font><span style="color: "><font color="#a31515">&quot;select a polyline which you want to measure&quot;</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">'Cast Object to AcadObject</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Dim</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">tmpObj</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">AcadObject</font></span><font color="#000000"> = </font><span style="color: "><font color="#0000ff">CType</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">obj1</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">AcadObject</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Dim</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">strObjName</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">String</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">strObjName</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">tmpObj</font></span><font color="#000000">.</font></font><span style="color: "><font style="font-size: 8pt" color="#010001">ObjectName</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">'&#160;&#160; Check its a polyline</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">If</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">strObjName</font></span><font color="#000000"> = </font><span style="color: "><font color="#a31515">&quot;AcDbPolyline&quot;</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">Then</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Dim</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">str1</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">String</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">'Handle of polyline is used to identify it to MEADSURE command</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">str1</font></span><font color="#000000"> = </font><span style="color: "><font color="#a31515">&quot;(handent &quot;&quot;&quot;</font></span><font color="#000000"> + </font><span style="color: "><font color="#010001">tmpObj</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Handle</font></span><font color="#000000"> + </font><span style="color: "><font color="#a31515">&quot;&quot;&quot;&quot;</font></span><font color="#000000"> + </font></font><span style="color: "><font style="font-size: 8pt" color="#a31515">&quot;)&quot;</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Dim</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">str</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">String</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">'Insert instances of 'myblock' at 500 unit spacing along polyline</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">'(replace myblock with name of your block)</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">' the polyline needs to be longer than 500</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">str</font></span><font color="#000000"> = </font></font><span style="color: "><font style="font-size: 8pt" color="#a31515">&quot;_.measure &quot;</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">str</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">str</font></span><font color="#000000"> &amp; </font><span style="color: "><font color="#010001">str1</font></span><font color="#000000"> &amp; </font><span style="color: "><font color="#010001">vbCr</font></span><font color="#000000"> &amp; </font><span style="color: "><font color="#a31515">&quot;_block&quot;</font></span><font color="#000000"> &amp; </font><span style="color: "><font color="#010001">vbCr</font></span><font color="#000000"> &amp; </font><span style="color: "><font color="#a31515">&quot;myblock&quot;</font></span><font color="#000000"> &amp; </font><span style="color: "><font color="#010001">vbCr</font></span><font color="#000000"> &amp; </font><span style="color: "><font color="#a31515">&quot;_Yes&quot;</font></span><font color="#000000"> &amp; </font><span style="color: "><font color="#010001">vbCr</font></span><font color="#000000"> &amp; </font><span style="color: "><font color="#a31515">&quot;500&quot;</font></span><font color="#000000"> &amp; </font></font><span style="color: "><font style="font-size: 8pt" color="#010001">vbCr</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">app</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">ActiveDocument</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">SendCommand</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">str</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">If</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Catch</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">ex</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#010001">Exception</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">' Print the exception on the command line</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Dim</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">ed</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#010001">Editor</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">ed</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">Autodesk</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">AutoCAD</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">ApplicationServices</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Application</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">DocumentManager</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">MdiActiveDocument</font></span><font color="#000000">.</font></font><span style="color: "><font style="font-size: 8pt" color="#010001">Editor</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">ed</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">WriteMessage</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">ex</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">ToString</font></span><font color="#000000">())</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">Try</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">End</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">Sub</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p> </div>
