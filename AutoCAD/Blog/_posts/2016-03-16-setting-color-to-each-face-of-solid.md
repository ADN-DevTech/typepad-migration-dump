---
layout: "post"
title: "Setting Color to Each Face of Solid"
date: "2016-03-16 17:52:00"
author: "Madhukar Moogala"
categories:
  - "2015"
  - "2016"
  - "AutoCAD"
  - "Madhukar Moogala"
  - "ObjectARX"
original_url: "https://adndevblog.typepad.com/autocad/2016/03/setting-color-to-each-face-of-solid.html "
typepad_basename: "setting-color-to-each-face-of-solid"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/Madhukar-Moogala.html" target="_self">Madhukar Moogala</a></p> <p>The below is self explanatory, we â€˜ll look at it how we can traverse to each face and paint with different colours.</p> <div style="font-size: 9pt; font-family: courier new; background: white; color: black"> <p style="margin: 0px"><span style="color: blue; line-height: 140%">void</span><span style="line-height: 140%"> TestBrep(</span><span style="color: blue; line-height: 140%">void</span><span style="line-height: 140%">)</span></p> <p style="margin: 0px"><span style="line-height: 140%">{</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #2b91af; line-height: 140%">Adesk</span><span style="line-height: 140%">::</span><span style="color: #2b91af; line-height: 140%">Int32</span><span style="line-height: 140%"> len;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #2b91af; line-height: 140%">ads_name</span><span style="line-height: 140%">&nbsp; ssname0;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: blue; line-height: 140%">struct</span><span style="line-height: 140%"> </span><span style="color: #2b91af; line-height: 140%">resbuf</span><span style="line-height: 140%"> *buffer;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; buffer = acutBuildList(-4, </span><span style="color: #6f008a; line-height: 140%">_T</span><span style="line-height: 140%">(</span><span style="color: #a31515; line-height: 140%">"&lt;AND"</span><span style="line-height: 140%">), </span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #6f008a; line-height: 140%">RTDXF0</span><span style="line-height: 140%">, </span><span style="color: #6f008a; line-height: 140%">_T</span><span style="line-height: 140%">(</span><span style="color: #a31515; line-height: 140%">"3DSOLID"</span><span style="line-height: 140%">),</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -4, </span><span style="color: #6f008a; line-height: 140%">_T</span><span style="line-height: 140%">(</span><span style="color: #a31515; line-height: 140%">"AND&gt;"</span><span style="line-height: 140%">), </span><span style="color: #6f008a; line-height: 140%">RTNONE</span><span style="line-height: 140%">);</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; acutPrintf(</span><span style="color: #6f008a; line-height: 140%">_T</span><span style="line-height: 140%">(</span><span style="color: #a31515; line-height: 140%">"\nSelect a box:"</span><span style="line-height: 140%">));</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; acedSSGet(</span><span style="color: #6f008a; line-height: 140%">NULL</span><span style="line-height: 140%">, </span><span style="color: #6f008a; line-height: 140%">NULL</span><span style="line-height: 140%">, </span><span style="color: #6f008a; line-height: 140%">NULL</span><span style="line-height: 140%">, buffer, ssname0);</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; acutRelRb(buffer);</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: blue; line-height: 140%">if</span><span style="line-height: 140%"> (</span><span style="color: #6f008a; line-height: 140%">RTNORM</span><span style="line-height: 140%"> == acedSSLength(ssname0, &amp;len))</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; {</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #2b91af; line-height: 140%">ads_name</span><span style="line-height: 140%">&nbsp; ent;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #2b91af; line-height: 140%">AcDbObjectId</span><span style="line-height: 140%"> entId;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: blue; line-height: 140%">for</span><span style="line-height: 140%">(</span><span style="color: blue; line-height: 140%">long</span><span style="line-height: 140%"> k = 0; k &lt; len; k++)</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; acedSSName(ssname0, k, ent);</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; acdbGetObjectId(entId, ent);</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; settingDifferentColorToEachFace(entId);</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; acedSSFree(ssname0);</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; }</span></p> <p style="margin: 0px"><span style="line-height: 140%">}</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="color: blue; line-height: 140%">void</span><span style="line-height: 140%"> settingDifferentColorToEachFace(</span><span style="color: #2b91af; line-height: 140%">AcDbObjectId</span><span style="line-height: 140%"> </span><span style="color: gray; line-height: 140%">solidId</span><span style="line-height: 140%">)</span></p> <p style="margin: 0px"><span style="line-height: 140%">{</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #2b91af; line-height: 140%">AcCmColor</span><span style="line-height: 140%"> specialColor;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #2b91af; line-height: 140%">AcDb3dSolid</span><span style="line-height: 140%">* pSolid;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: blue; line-height: 140%">if</span><span style="line-height: 140%"> (</span><span style="color: #2b91af; line-height: 140%">Acad</span><span style="line-height: 140%">::</span><span style="color: #2f4f4f; line-height: 140%">eOk</span><span style="line-height: 140%"> == acdbOpenObject(pSolid, </span><span style="color: gray; line-height: 140%">solidId</span><span style="line-height: 140%">, </span><span style="color: #2b91af; line-height: 140%">AcDb</span><span style="line-height: 140%">::</span><span style="color: #2f4f4f; line-height: 140%">kForRead</span><span style="line-height: 140%">))</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; {</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #2b91af; line-height: 140%">AcDbFullSubentPath</span><span style="line-height: 140%"> path(</span><span style="color: gray; line-height: 140%">solidId</span><span style="line-height: 140%">, </span><span style="color: #2b91af; line-height: 140%">AcDbSubentId</span><span style="line-height: 140%">());</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #2b91af; line-height: 140%">AcBrBrep</span><span style="line-height: 140%"> brep;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #2b91af; line-height: 140%">AcBr</span><span style="line-height: 140%">::</span><span style="color: #2b91af; line-height: 140%">ErrorStatus</span><span style="line-height: 140%"> bs = brep.setSubentPath(path);</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue; line-height: 140%">if</span><span style="line-height: 140%"> (bs != </span><span style="color: #2b91af; line-height: 140%">AcBr</span><span style="line-height: 140%">::</span><span style="color: #2f4f4f; line-height: 140%">eOk</span><span style="line-height: 140%">)</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue; line-height: 140%">return</span><span style="line-height: 140%">;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp; </span><span style="color: green; line-height: 140%">//Initialize the BrepFace traverser</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #2b91af; line-height: 140%">AcBrBrepFaceTraverser</span><span style="line-height: 140%"> bft;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bs = bft.setBrep(brep);</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue; line-height: 140%">if</span><span style="line-height: 140%"> (bs != </span><span style="color: #2b91af; line-height: 140%">AcBr</span><span style="line-height: 140%">::</span><span style="color: #2f4f4f; line-height: 140%">eOk</span><span style="line-height: 140%">)</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue; line-height: 140%">return</span><span style="line-height: 140%">;</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #2b91af; line-height: 140%">AcArray</span><span style="line-height: 140%">&lt;</span><span style="color: #2b91af; line-height: 140%">AcDbSubentId</span><span style="line-height: 140%">&gt; arrSubentId;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: green; line-height: 140%">// Traverse all faces</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue; line-height: 140%">for</span><span style="line-height: 140%"> (;!bft.done();bft.next())</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #2b91af; line-height: 140%">AcBrFace</span><span style="line-height: 140%"> face;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bs = bft.getFace(face);&nbsp;&nbsp;&nbsp;&nbsp; </span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue; line-height: 140%">if</span><span style="line-height: 140%"> (bs != </span><span style="color: #2b91af; line-height: 140%">Acad</span><span style="line-height: 140%">::</span><span style="color: #2f4f4f; line-height: 140%">eOk</span><span style="line-height: 140%">)</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; acutPrintf(L</span><span style="color: #a31515; line-height: 140%">"\ngetFace failed"</span><span style="line-height: 140%">);</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue; line-height: 140%">break</span><span style="line-height: 140%">;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #2b91af; line-height: 140%">AcDbFullSubentPath</span><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; Path(kNullSubent);</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #2b91af; line-height: 140%">AcDbSubentId</span><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; subentId;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #2b91af; line-height: 140%">AcBr</span><span style="line-height: 140%">::</span><span style="color: #2b91af; line-height: 140%">ErrorStatus</span><span style="line-height: 140%"> bss = face.getSubentPath(Path);</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; subentId = Path.subentId();</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; arrSubentId.append(subentId);</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pSolid-&gt;upgradeOpen();</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: blue; line-height: 140%">for</span><span style="line-height: 140%"> (</span><span style="color: blue; line-height: 140%">int</span><span style="line-height: 140%"> i = 0; i &lt; arrSubentId.length(); i++)</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; specialColor.setColorIndex(i);</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pSolid-&gt;setSubentColor(arrSubentId[i],specialColor);</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pSolid-&gt;downgradeOpen();</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; }</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; pSolid-&gt;close();</span></p> <p style="margin: 0px"><span style="line-height: 140%">}</span></p> <p style="margin: 0px"><span style="line-height: 140%"></span>&nbsp;</p></div> <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b7c8259343970b-pi"><img title="Box_Colors" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="Box_Colors" src="/assets/image_275935.jpg" width="244" height="218"></a></p>
