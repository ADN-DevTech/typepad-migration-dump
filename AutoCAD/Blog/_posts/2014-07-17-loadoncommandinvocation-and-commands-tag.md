---
layout: "post"
title: "LoadOnCommandInvocation and Commands tag"
date: "2014-07-17 12:55:39"
author: "Adam Nagy"
categories:
  - "Adam Nagy"
  - "AutoCAD"
original_url: "https://adndevblog.typepad.com/autocad/2014/07/loadoncommandinvocation-and-commands-tag.html "
typepad_basename: "loadoncommandinvocation-and-commands-tag"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/adam-nagy.html">Adam Nagy</a></p>
<p>When you do not want to get your module loaded as soon as <strong>AutoCAD</strong> starts up, since this may slow down that process, you can wait till the user actually wants to use your command.</p>
<p>In that case instead of <strong>LoadOnAutoCADStartup=&quot;True&quot;</strong>&#0160;you can use <strong>LoadOnCommandInvocation=&quot;True&quot;</strong>. However, this requires that you specify the commands that <strong>AutoCAD</strong> should recognize even without your AddIn being loaded. You can do that by creating a<strong> Commands</strong> section in the<strong>&#0160;PackageContents.xml</strong>&#0160;of your autoloader bundle. All the commands listed here must also be registered on the command stack inside <strong>AutoCAD</strong> with the exact same parameters.&#0160;</p>
<p>E.g. if this is how you register your command in .NET:</p>
<pre>[CommandMethod(&quot;MyGroup&quot;, &quot;MyCommand&quot;, CommandFlags.Modal)]</pre>
<p>Then this is what the <strong>Commands</strong> section should look like:</p>
<pre>&lt;Commands GroupName=&quot;MyGroup&quot;&gt;<br />&lt;Command Global=&quot;MyCommand&quot; Local=&quot;MyCommand&quot;/&gt;<br />&lt;/Commands&gt;</pre>
<p>You register commands on the command stack inside <strong>AutoCAD</strong> differently depending on the programming language. E.g. in <strong>C++/ARX</strong> it would be&#0160;<strong>acedRegCmds-&gt;addCommand()</strong>, or a macro like&#0160;<strong>ACED_ARXCOMMAND_ENTRY_AUTO</strong>,&#0160;while in <strong>.NET</strong> you would use the&#0160;<strong>CommandMethod()</strong> attribute. After this <strong>AutoCAD</strong> will know what function to call when one of your commands is executed.</p>
<p>Note: if you use the single parameter version of <strong>CommandMethod(&quot;MyCommand&quot;)</strong> then the name of the command group will be generated by <strong>AutoCAD</strong> - not sure what that will be exactly. So it&#39;s better to stick with the version that lets you specify the command group name as well - like in the above example - if you want to use them in the bundle&#39;s <strong>Commands</strong> section.&#0160;</p>
<p>As mentioned in <a href="http://adndevblog.typepad.com/autocad/2012/04/autoloaderf1-help-integration.html" target="_self">this</a> blog post, it&#39;s&#0160;not strictly necessary to include the <strong>Commands</strong> element if you donâ€™t set your plug-in to <strong>LoadOnCommandInvocation=&quot;True&quot;</strong>, but it is required if you want the <strong>F1</strong> help integration.</p>
<p>Here is a link to detailed info about the Autoloader bundle format:&#0160;<a href="http://adndevblog.typepad.com/autocad/2013/01/autodesk-autoloader-white-paper.html" target="_self" title="">http://adndevblog.typepad.com/autocad/2013/01/autodesk-autoloader-white-paper.html</a></p>
<p>&#0160;</p>
