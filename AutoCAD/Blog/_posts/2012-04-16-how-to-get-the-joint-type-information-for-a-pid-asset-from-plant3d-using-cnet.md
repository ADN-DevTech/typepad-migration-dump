---
layout: "post"
title: "How to get the &lsquo;Joint Type&rsquo; information for a P&amp;ID Asset from Plant3d using C#.NET"
date: "2012-04-16 15:43:16"
author: "Fenton Webb"
categories:
  - "Fenton Webb"
original_url: "https://adndevblog.typepad.com/autocad/2012/04/how-to-get-the-joint-type-information-for-a-pid-asset-from-plant3d-using-cnet.html "
typepad_basename: "how-to-get-the-joint-type-information-for-a-pid-asset-from-plant3d-using-cnet"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/fenton-webb.html" target="_self">Fenton Webb</a></p>
<p>Recently an interesting question came in about obtaining the ‘<strong>Joint Type</strong>’ information from a P&amp;ID Asset from Plant3d. Basically, the concept of a Joint Type between P&amp;ID and Plant3d is quite different. The Joint Type is a property of the style that affects placement behavior. For P&amp;ID, it only specifies if the asset should be inline, endline, break an sline, etc. These concepts don’t translate to Plant 3D very well. However, in P&amp;ID there is a per object property that does translate over albeit not directly. This property is the <strong>EndConnections</strong> property found in the <strong>DataManager-&gt;P&amp;ID-&gt;Engineering Items-&gt;Inline Assets-&gt;Hand Valves</strong>. So, from the API, once we have a <strong>PnPDatabase</strong>, you can get a row for an Inline Asset, get the <strong>EndConnections</strong> column in the row, then when we have that, we match the inline asset on the Plant3d side with a matching Tag. If the Tag properties match, then is the same logical inline asset. Once we have that match, then we check to see how it's connected.</p>
<p>Now for the code…</p>
<div style="background: white;">
<p style="margin: 0px;"><span><span style="font-family: Consolas;"><span style="color: #008000;">// determining the Join Type for Assets</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>[</span></span><span><span><span style="color: #2b91af;">CommandMethod</span></span><span style="color: #000000;">(</span><span><span style="color: #a31515;">"GetJointType"</span></span><span style="color: #000000;">)]</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;"><span>public</span></span></span><span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">void</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">GetJointType</span></span><span style="color: #000000;">()</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">{</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp; </span></span><span><span style="color: #008000;">// get the AutoCAD Editor object so we can print to the command line</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp; </span></span><span><span><span style="color: #2b91af;">Editor</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">ed</span></span><span style="color: #000000;"> = </span><span><span style="color: #2b91af;">AcadApp</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">DocumentManager</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">MdiActiveDocument</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Editor</span></span><span style="color: #000000;">;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&nbsp;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp; </span></span><span><span style="color: #008000;">// get the current project object</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp; </span></span><span><span><span style="color: #2b91af;">PlantProject</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">currentProj</span></span><span style="color: #000000;"> = </span><span><span style="color: #2b91af;">PlantApplication</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">CurrentProject</span></span><span style="color: #000000;">;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&nbsp;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp; </span></span><span><span style="color: #008000;">// get the PnID project part</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp; </span></span><span><span><span style="color: #2b91af;">PnIdProject</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">PnIdProj</span></span><span style="color: #000000;"> = (</span><span><span style="color: #2b91af;">PnIdProject</span></span><span style="color: #000000;">)</span><span><span style="color: #010001;">currentProj</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">ProjectParts</span></span><span style="color: #000000;">[</span><span><span style="color: #a31515;">"PnID"</span></span><span style="color: #000000;">];</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp; </span></span><span><span style="color: #008000;">// get the datalinks manager</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp; </span></span><span><span><span style="color: #2b91af;">DataLinksManager</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">datalinksManager</span></span><span style="color: #000000;"> = </span><span><span style="color: #010001;">PnIdProj</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">DataLinksManager</span></span><span style="color: #000000;">;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp; </span></span><span><span style="color: #008000;">// get the PnpDatabase</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp; </span></span><span><span><span style="color: #2b91af;">PnPDatabase</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">pnpDatabase</span></span><span style="color: #000000;"> = </span><span><span style="color: #010001;">datalinksManager</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">GetPnPDatabase</span></span><span style="color: #000000;">();</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&nbsp;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp; </span></span><span><span style="color: #008000;">// get the Piping project part</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp; </span></span><span><span><span style="color: #2b91af;">PipingProject</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">pipingProj</span></span><span style="color: #000000;"> = (</span><span><span style="color: #2b91af;">PipingProject</span></span><span style="color: #000000;">)</span><span><span style="color: #010001;">currentProj</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">ProjectParts</span></span><span style="color: #000000;">[</span><span><span style="color: #a31515;">"Piping"</span></span><span style="color: #000000;">];</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp; </span></span><span><span style="color: #008000;">// get the datalinks manager</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp; </span></span><span><span><span style="color: #2b91af;">DataLinksManager</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">pipingDatalinksManager</span></span><span style="color: #000000;"> = </span><span><span style="color: #010001;">pipingProj</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">DataLinksManager</span></span><span style="color: #000000;">;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp; </span></span><span><span style="color: #008000;">// get the PnpDatabase</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp; </span></span><span><span><span style="color: #2b91af;">PnPDatabase</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">pipingPnpDatabase</span></span><span style="color: #000000;"> = </span><span><span style="color: #010001;">pipingDatalinksManager</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">GetPnPDatabase</span></span><span style="color: #000000;">();</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp; </span></span><span><span style="color: #008000;">// now from the piping.pcf, get the PipeRunComponent from PnpBase-&gt;EngineeringItems</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp; </span></span><span><span><span style="color: #0000ff;">var</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">pipeRunComps</span></span><span style="color: #000000;"> = </span><span><span style="color: #010001;">pipingPnpDatabase</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Tables</span></span><span style="color: #000000;">[</span><span><span style="color: #a31515;">"PipeRunComponent"</span></span><span style="color: #000000;">];</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&nbsp;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp; </span></span><span><span style="color: #008000;">// get the handvalves from PnpBase-&gt;EngineeringItems-&gt;InLineAssets</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp; </span></span><span><span><span style="color: #0000ff;">var</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">pnid_table</span></span><span style="color: #000000;"> = </span><span><span style="color: #010001;">pnpDatabase</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Tables</span></span><span style="color: #000000;">[</span><span><span style="color: #a31515;">"HandValves"</span></span><span style="color: #000000;">];</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp; </span></span><span><span><span style="color: #2b91af;">PnPRow</span></span><span style="color: #000000;">[] </span><span><span style="color: #010001;">pnid_handvalves</span></span><span style="color: #000000;"> = </span><span><span style="color: #010001;">pnid_table</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Select</span></span><span style="color: #000000;">();</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp; </span></span><span><span style="color: #008000;">// loop through each hand value type and examine the EndConnections</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp; </span></span><span><span><span style="color: #0000ff;">foreach</span></span><span style="color: #000000;"> (</span><span><span style="color: #2b91af;">PnPRow</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">pnid_valve</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">in</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">pnid_handvalves</span></span><span style="color: #000000;">)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&nbsp; {</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp; </span></span><span><span style="color: #008000;">// extract the EndConnections type string, remember that this may not match up with the "JointType" later on</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp; </span></span><span><span><span style="color: #0000ff;">var</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">strEndConnections</span></span><span style="color: #000000;"> = </span><span><span style="color: #010001;">pnid_valve</span></span><span style="color: #000000;">[</span><span><span style="color: #a31515;">"EndConnections"</span></span><span style="color: #000000;">] </span><span><span style="color: #0000ff;">as</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">string</span></span><span style="color: #000000;">;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp; </span></span><span><span style="color: #008000;">// and the tag string</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp; </span></span><span><span><span style="color: #0000ff;">var</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">strTag</span></span><span style="color: #000000;"> = </span><span><span style="color: #010001;">pnid_valve</span></span><span style="color: #000000;">[</span><span><span style="color: #a31515;">"Tag"</span></span><span style="color: #000000;">] </span><span><span style="color: #0000ff;">as</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">string</span></span><span style="color: #000000;">;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp; </span></span><span><span style="color: #008000;">// make sure we have a tag</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp; </span></span><span><span><span style="color: #0000ff;">if</span></span><span style="color: #000000;"> (</span><span><span style="color: #2b91af;">String</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">IsNullOrEmpty</span></span><span style="color: #000000;">(</span><span><span style="color: #010001;">strTag</span></span><span style="color: #000000;">) == </span><span><span style="color: #0000ff;">true</span></span><span style="color: #000000;"> || </span><span><span style="color: #010001;">strTag</span></span><span style="color: #000000;"> == </span><span><span style="color: #a31515;">"?-?"</span></span><span style="color: #000000;">)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&nbsp;&nbsp;&nbsp; {</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span><span><span style="color: #010001;">ed</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">WriteMessage</span></span><span style="color: #000000;">(</span><span><span style="color: #a31515;">"\nSkipping EndConnections-&gt;"</span></span><span style="color: #000000;"> + </span><span><span style="color: #010001;">strEndConnections</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">ToString</span></span><span style="color: #000000;">() + </span><span><span style="color: #a31515;">" because the Tag value is not set"</span></span><span style="color: #000000;">);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span><span><span style="color: #0000ff;">continue</span></span><span style="color: #000000;">;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&nbsp;&nbsp;&nbsp; }</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&nbsp;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp; </span></span><span><span style="color: #008000;">// and select all of the tags that match the HandValves row</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp; </span></span><span><span><span style="color: #0000ff;">var</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">pipingRows</span></span><span style="color: #000000;"> = </span><span><span style="color: #010001;">pipeRunComps</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Select</span></span><span style="color: #000000;">(</span><span><span style="color: #a31515;">"Tag='"</span></span><span style="color: #000000;"> + </span><span><span style="color: #010001;">strTag</span></span><span style="color: #000000;"> + </span><span><span style="color: #a31515;">"'"</span></span><span style="color: #000000;">);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp; </span></span><span><span style="color: #008000;">// check that we have some</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp; </span></span><span><span><span style="color: #0000ff;">if</span></span><span style="color: #000000;"> (</span><span><span style="color: #010001;">pipingRows</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Length</span></span><span style="color: #000000;"> == 0)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&nbsp;&nbsp;&nbsp; {</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span><span><span style="color: #010001;">ed</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">WriteMessage</span></span><span style="color: #000000;">(</span><span><span style="color: #a31515;">"\nFailed to find Tag "</span></span><span style="color: #000000;"> + </span><span><span style="color: #010001;">strTag</span></span><span style="color: #000000;"> + </span><span><span style="color: #a31515;">" in the Piping.dcf. The tags must be labeled the same in order to match up."</span></span><span style="color: #000000;">);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span><span><span style="color: #0000ff;">continue</span></span><span style="color: #000000;">;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&nbsp;&nbsp;&nbsp; }</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&nbsp;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp; </span></span><span><span><span style="color: #010001;">ed</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">WriteMessage</span></span><span style="color: #000000;">(</span><span><span style="color: #a31515;">"\nFound "</span></span><span style="color: #000000;"> + </span><span><span style="color: #010001;">pipingRows</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Length</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">ToString</span></span><span style="color: #000000;">() + </span><span><span style="color: #a31515;">" matching tags called "</span></span><span style="color: #000000;"> + </span><span><span style="color: #010001;">strTag</span></span><span style="color: #000000;">);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&nbsp;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp; </span></span><span><span style="color: #008000;">// loop the matching tags, for Part1</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp; </span></span><span><span><span style="color: #0000ff;">foreach</span></span><span style="color: #000000;"> (</span><span><span style="color: #2b91af;">PnPRow</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">piping_row</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">in</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">pipingRows</span></span><span style="color: #000000;">)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&nbsp;&nbsp;&nbsp; {</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span><span><span style="color: #0000ff;">int</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">id</span></span><span style="color: #000000;"> = </span><span><span style="color: #010001;">piping_row</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">RowId</span></span><span style="color: #000000;">;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span><span style="color: #008000;">// get the connection types from P3dPartConnection</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span><span><span style="color: #2b91af;">PnPRelationshipType</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">relType</span></span><span style="color: #000000;"> = </span><span><span style="color: #010001;">pipingPnpDatabase</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">RelationshipTypes</span></span><span style="color: #000000;">[</span><span><span style="color: #a31515;">"P3dPartConnection"</span></span><span style="color: #000000;">];</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span><span style="color: #008000;">// find the JointTypes for the tag</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span><span><span style="color: #010001;">findAndPrintJointTypes</span></span><span style="color: #000000;">(</span><span><span style="color: #a31515;">"Part1"</span></span><span style="color: #000000;">, </span><span><span style="color: #a31515;">"Part2"</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">strTag</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">id</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">relType</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">strEndConnections</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">pipingPnpDatabase</span></span><span style="color: #000000;">);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span><span style="color: #008000;">// and reverse because they may be connected in a different order</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span><span><span style="color: #010001;">findAndPrintJointTypes</span></span><span style="color: #000000;">(</span><span><span style="color: #a31515;">"Part2"</span></span><span style="color: #000000;">, </span><span><span style="color: #a31515;">"Part1"</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">strTag</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">id</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">relType</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">strEndConnections</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">pipingPnpDatabase</span></span><span style="color: #000000;">);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&nbsp;&nbsp;&nbsp; }</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&nbsp; }</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">}</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&nbsp;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;"><span>void</span></span></span><span><span style="color: #000000;"> </span><span><span style="color: #010001;">findAndPrintJointTypes</span></span><span style="color: #000000;">(</span><span><span style="color: #0000ff;">string</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">part1</span></span><span style="color: #000000;">, </span><span><span style="color: #0000ff;">string</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">part2</span></span><span style="color: #000000;">, </span><span><span style="color: #0000ff;">string</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">strTag</span></span><span style="color: #000000;">, </span><span><span style="color: #0000ff;">int</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">id</span></span><span style="color: #000000;">, </span><span><span style="color: #2b91af;">PnPRelationshipType</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">relType</span></span><span style="color: #000000;">, </span><span><span style="color: #0000ff;">string</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">endConnection</span></span><span style="color: #000000;">, </span><span><span style="color: #2b91af;">PnPDatabase</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">pnpDatabase</span></span><span style="color: #000000;">)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">{</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp; </span></span><span><span style="color: #008000;">// get the AutoCAD Editor object so we can print to the command line</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp; </span></span><span><span><span style="color: #2b91af;">Editor</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">ed</span></span><span style="color: #000000;"> = </span><span><span style="color: #2b91af;">AcadApp</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">DocumentManager</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">MdiActiveDocument</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Editor</span></span><span style="color: #000000;">;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp; </span></span><span><span style="color: #008000;">// now find the 'Part1" relationships from the table</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp; </span></span><span><span><span style="color: #0000ff;">var</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">rels1</span></span><span style="color: #000000;"> = </span><span><span style="color: #010001;">relType</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">GetRelationships</span></span><span style="color: #000000;">(</span><span><span style="color: #0000ff;">new</span></span><span style="color: #000000;"> </span><span><span style="color: #2b91af;">KeyValuePair</span></span><span style="color: #000000;">&lt;</span><span><span style="color: #0000ff;">string</span></span><span style="color: #000000;">, </span><span><span style="color: #0000ff;">int</span></span><span style="color: #000000;">&gt;(</span><span><span style="color: #010001;">part1</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">id</span></span><span style="color: #000000;">));</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp; </span></span><span><span style="color: #008000;">// loop all of them</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp; </span></span><span><span><span style="color: #0000ff;">foreach</span></span><span style="color: #000000;"> (</span><span><span style="color: #0000ff;">var</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">rel</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">in</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">rels1</span></span><span style="color: #000000;">)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&nbsp; {</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp; </span></span><span><span style="color: #008000;">// find the Part2 relation</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp; </span></span><span><span><span style="color: #0000ff;">int</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">relatedId</span></span><span style="color: #000000;"> = </span><span><span style="color: #010001;">rel</span></span><span style="color: #000000;">[</span><span><span style="color: #010001;">part2</span></span><span style="color: #000000;">];</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp; </span></span><span><span><span style="color: #0000ff;">var</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">relatedRow</span></span><span style="color: #000000;"> = </span><span><span style="color: #010001;">pnpDatabase</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">GetRow</span></span><span style="color: #000000;">(</span><span><span style="color: #010001;">relatedId</span></span><span style="color: #000000;">);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp; </span></span><span><span style="color: #008000;">// extract the JointType</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp; </span></span><span><span><span style="color: #0000ff;">var</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">jointType</span></span><span style="color: #000000;"> = </span><span><span style="color: #010001;">relatedRow</span></span><span style="color: #000000;">[</span><span><span style="color: #a31515;">"JointType"</span></span><span style="color: #000000;">];</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&nbsp;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp; </span></span><span><span style="color: #008000;">// now if we have a match</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp; </span></span><span><span><span style="color: #0000ff;">if</span></span><span style="color: #000000;"> (</span><span><span style="color: #010001;">jointType</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">ToString</span></span><span style="color: #000000;">() == </span><span><span style="color: #010001;">endConnection</span></span><span style="color: #000000;">)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&nbsp;&nbsp;&nbsp; {</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span><span><span style="color: #010001;">ed</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">WriteMessage</span></span><span style="color: #000000;">(</span><span><span style="color: #a31515;">"\nFound JointType "</span></span><span style="color: #000000;"> + </span><span><span style="color: #010001;">jointType</span></span><span style="color: #000000;"> + </span><span><span style="color: #a31515;">" from PnId in Piping for Tag "</span></span><span style="color: #000000;"> + </span><span><span style="color: #010001;">strTag</span></span><span style="color: #000000;">);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&nbsp;&nbsp;&nbsp; }</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&nbsp; }</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">}</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&nbsp;</span></span></p>
</div>
