---
layout: "post"
title: "How to determine an entity's layout, using Visual LISP"
date: "2013-01-16 17:41:54"
author: "Gopinath Taget"
categories:
  - "2010"
  - "2011"
  - "2012"
  - "2013"
  - "ActiveX"
  - "AutoCAD"
  - "Gopinath Taget"
  - "LISP"
original_url: "https://adndevblog.typepad.com/autocad/2013/01/how-to-determine-an-entitys-layout-using-visual-lisp.html "
typepad_basename: "how-to-determine-an-entitys-layout-using-visual-lisp"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/gopinath-taget.html">Gopinath Taget</a></p>  <p>Any entity you select has an owner.&#160; If it is a sub-entity of a block reference, the block reference is the owner.&#160; If it is not a sub-entity, then either Paper Space or Model Space would be the owner.&#160; From the owner's Object ID we can get the object, its Layout property, and finally the Layout's name property, to identify the layout.&#160; The Visual LISP example below shows how to get this property.</p>  <p>&#160;</p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white" class="MsoNormal"><font face="Courier New"><font size="1"><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#0080c0">(</font></span></b><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#0000ff">defun</font></span></b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#000000"> c:GetLayout </font></span><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#0080c0">(</font></span></b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#000000"> </font></span><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#0000ff">/</font></span></b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#000000"> oApp oDoc obj lOwnerID</font></span></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white" class="MsoNormal"><font size="1"><font face="Courier New"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#000000"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>ownerObj bIsLayout sLoName</font></span><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#0080c0">)</font></span></b></font><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white" class="MsoNormal"><font size="1"><font face="Courier New"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><font color="#000000">&#160;&#160; </font></span></span><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#0080c0">(</font></span></b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#000000">vl-load-com</font></span><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#0080c0">)</font></span></b></font><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white" class="MsoNormal"><font size="1"><font face="Courier New"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><font color="#000000">&#160;&#160; </font></span></span><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#0080c0">(</font></span></b><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#0000ff">setq</font></span></b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#000000"> oApp<span style="mso-spacerun: yes">&#160;&#160;&#160; </span></font></span><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#0080c0">(</font></span></b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#000000">vlax-get-acad-object</font></span><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#0080c0">)</font></span></b></font><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white" class="MsoNormal"><font size="1"><font face="Courier New"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#000000"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>oDoc<span style="mso-spacerun: yes">&#160;&#160;&#160; </span></font></span><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#0080c0">(</font></span></b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#000000">vla-get-activedocument oApp</font></span><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#0080c0">)</font></span></b></font><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white" class="MsoNormal"><font size="1"><font face="Courier New"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#000000"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>obj<span style="mso-spacerun: yes">&#160;&#160;&#160; </span></font></span><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#0080c0">(</font></span></b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#000000">vlax-ename-&gt;vla-object </font></span><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#0080c0">(</font></span></b><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#0000ff">car</font></span></b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#000000"> </font></span><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#0080c0">(</font></span></b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#000000">entsel</font></span><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#0080c0">)))</font></span></b></font><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white" class="MsoNormal"><font size="1"><font face="Courier New"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#000000"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>lOwnerID<span style="mso-spacerun: yes">&#160; </span></font></span><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#0080c0">(</font></span></b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#000000">vla-get-ownerid obj</font></span><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#0080c0">)</font></span></b></font><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white" class="MsoNormal"><font size="1"><font face="Courier New"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#000000"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>ownerObj<span style="mso-spacerun: yes">&#160; </span></font></span><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#0080c0">(</font></span></b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#000000">vla-objectidtoobject oDoc lOwnerID</font></span><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#0080c0">)</font></span></b></font><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white" class="MsoNormal"><font size="1"><font face="Courier New"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#000000"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>bIsLayout </font></span><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#0080c0">(</font></span></b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#000000">vlax-get-property ownerObj </font></span><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#808080">&quot;IsLayout&quot;</font></span><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#0080c0">)</font></span></b></font><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white" class="MsoNormal"><font size="1"><font face="Courier New"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><font color="#000000">&#160;&#160; </font></span></span><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#0080c0">)</font></span></b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#000000"> </font></span><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#008000">;setq</font></span></font><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white" class="MsoNormal"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Courier New"><font color="#000000" size="1">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white" class="MsoNormal"><font size="1"><font face="Courier New"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><font color="#000000">&#160;&#160; </font></span></span><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#0080c0">(</font></span></b><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#0000ff">if</font></span></b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#000000"> </font></span><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#0080c0">(</font></span></b><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#0000ff">=</font></span></b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#000000"> bIsLayout </font></span><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#000080">:vlax-true</font></span></b><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#0080c0">)</font></span></b></font><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white" class="MsoNormal"><font size="1"><font face="Courier New"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span></span><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#0080c0">(</font></span></b><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#0000ff">progn</font></span></b></font><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white" class="MsoNormal"><font size="1"><font face="Courier New"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span></span><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#0080c0">(</font></span></b><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#0000ff">setq</font></span></b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#000000"> sLoName </font></span><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#0080c0">(</font></span></b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#000000">vla-get-name </font></span><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#0080c0">(</font></span></b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#000000">vla-get-layout ownerObj</font></span><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#0080c0">)))</font></span></b></font><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white" class="MsoNormal"><font size="1"><font face="Courier New"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span></span><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#0080c0">(</font></span></b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#000000">alert </font></span><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#0080c0">(</font></span></b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#000000">strcat </font></span><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#808080">&quot;Layout Name is &quot;</font></span><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#000000"> sLoName</font></span><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#0080c0">))</font></span></b></font><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white" class="MsoNormal"><font size="1"><font face="Courier New"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span></span><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#0080c0">)</font></span></b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#000000"> </font></span><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#008000">;progn</font></span></font><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white" class="MsoNormal"><font size="1"><font face="Courier New"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><font color="#000000">&#160;&#160; </font></span></span><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#0080c0">)</font></span></b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#000000"> </font></span><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#008000">;if</font></span></font><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white" class="MsoNormal"><font size="1"><font face="Courier New"><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><span style="mso-spacerun: yes"><font color="#000000">&#160;&#160; </font></span></span><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#0080c0">(</font></span></b><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#0000ff">princ</font></span></b><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font color="#0080c0">)</font></span></b></font><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; background: white" class="MsoNormal"><b><span style="font-family: ; mso-fareast-font-family: &#39;Times New Roman&#39;"><font face="Courier New"><font color="#0080c0" size="1">)</font></font></span></b></p>
