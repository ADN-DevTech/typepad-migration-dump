---
layout: "post"
title: "A rich source of AutoCAD .NET sample code"
date: "2012-08-14 15:05:37"
author: "Madhukar Moogala"
categories:
  - ".NET"
  - "AutoCAD"
  - "Stephen Preston"
original_url: "https://adndevblog.typepad.com/autocad/2012/08/a-rich-source-of-autocad-net-sample-code.html "
typepad_basename: "a-rich-source-of-autocad-net-sample-code"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/stephen-preston.html">Stephen Preston</a></p>  <p>One of the top requests whenever we survey programmers on their needs is “more sample code”. And I agree this is important – its what I want too when I’m learning an API. One oft overlooked source of sample code is AutoCAD itself. We don’t obfuscate our .NET code, and so the AutoCAD components written in .NET (mostly the UI components) provide good usage and (hopefully <img style="border-bottom-style: none; border-right-style: none; border-top-style: none; border-left-style: none" class="wlEmoticon wlEmoticon-smile" alt="Smile" src="/assets/image_464638.jpg" />) also best practice examples of how to use the various APIs we expose. This is one of the advantages of ‘eating your own dog food’ – another advantage is obviously that it provides additional ‘on the job’ testing for the APIs. To access this sample code, you just need a .NET decompiler, like <a href="http://www.reflector.net/" target="_blank">RedGate Reflector</a>. Simply open the DLL you think might be a .NET assembly and let Reflector do its thing. In this example, I’ve opened the AutoCAD 2012 AcLayer.dll assembly:</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01774421e1a6970d-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="SNAGHTML2aebcf03" border="0" alt="SNAGHTML2aebcf03" src="/assets/image_4705.jpg" width="244" height="183" /></a></p>  <p>Expanding the assembly allows you to drill down into the namespaces and classes it contains:</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01774421e1ad970d-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="SNAGHTML2aed18bf" border="0" alt="SNAGHTML2aed18bf" src="/assets/image_787701.jpg" width="225" height="244" /></a></p>  <p>In this case, I’m looking at the AutoCAD Commands defined by the assembly:</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0176173b7441970c-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="SNAGHTML2aee3b5c" border="0" alt="SNAGHTML2aee3b5c" src="/assets/image_453165.jpg" width="244" height="127" /></a></p>        <p>I can drill down into the implementation of each command:</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01676946d4f2970b-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="SNAGHTML2aefb664" border="0" alt="SNAGHTML2aefb664" src="/assets/image_301070.jpg" width="244" height="125" /></a></p>  <p>I can even view the code in different .NET languages. The above image is C#, now I’ve changed to VB.NET:</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0176173b744f970c-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="SNAGHTML2af149cd" border="0" alt="SNAGHTML2af149cd" src="/assets/image_26830.jpg" width="244" height="125" /></a></p>  <p>The MSIL doesn’t include comments, of course, so you’re on your own working out exactly what the code is doing.&#160; As an additional aid, Kean has already demonstrated on his blog&#160; <a href="http://through-the-interface.typepad.com/through_the_interface/2010/02/debugging-into-autocads-net-api-layer-using-reflector-part-1.html" target="_blank">how to use Reflector Pro to debug into the AutoCAD .NET API layer</a>.</p>
