---
layout: "post"
title: "Creating a Mixed Mode RealDWG Application"
date: "2013-03-07 17:58:01"
author: "Fenton Webb"
categories:
  - ".NET"
  - "2010"
  - "2011"
  - "2012"
  - "2013"
  - "Fenton Webb"
  - "ObjectARX"
  - "RealDWG"
original_url: "https://adndevblog.typepad.com/autocad/2013/03/creating-a-mixed-mode-realdwg-application.html "
typepad_basename: "creating-a-mixed-mode-realdwg-application"
typepad_status: "Publish"
---

<p>by <a href="http://adndevblog.typepad.com/autocad/fenton-webb.html">Fenton Webb</a></p>  <p>If you are a seasoned RealDWG developer, you will have probably noticed that the .NET version of the RealDWG SDK’s HostApplicationServices object does not implement all of the virtual functions that are exposed by its unmanaged ObjectDBX counterpart, AcDbHostApplicationServices.</p>  <p>For the most part, this is a good idea because it simplifies your RealDWG application immensely. </p>  <p>The problem is that sometimes, just sometimes, you really need the full power of the SDK. If you do need that power from .NET then you are going to need to implement a Mixed Mode RealDWG app – one that implements both an underlying unmanaged AcDbHostApplicationServices derived class and a managed HostApplicationServices class that feeds off of it. </p>  <p>So in this example, I simply want to override AcDbHostApplicationServices::fatalError() with my own implementation. This is because the default implementation simply calls Exit( 0 ) which in my case is bad because I want to process many DWG files without failure. If I did not override this function, my RealDWG app would simply exit out and not finish.</p>  <p>Here’s the RealDWG .NET code I want to use… Ok, it’s not scanning lots of DWG files but you get the idea… Remember, I want an exception to be thrown when RealDWG encounters a corrupted DWG file rather than calling Exit( 0 )…</p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">Imports</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#010001">Autodesk</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">AutoCAD</font></span><font color="#000000">.</font></font><span style="color: "><font style="font-size: 8pt" color="#010001">DatabaseServices</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">Imports</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#010001">System</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Windows</font></span><font color="#000000">.</font></font><span style="color: "><font style="font-size: 8pt" color="#010001">Forms</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">' by Fenton Webb, DevTech, Autodesk 30/04/2010</font></font></span></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">Public</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#0000ff">Class</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#2b91af">SimpleSampleDBXEngine</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Shared</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">Sub</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">Main</font></span><font color="#000000">()</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">' init the undelying CLI C++ HostApplication</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Using</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">app</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">AdskDBXEngine</font></span><font color="#000000"> = </font><span style="color: "><font color="#0000ff">New</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#2b91af">AdskDBXEngine</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">For</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">i</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">Integer</font></span><font color="#000000"> = 0 </font><span style="color: "><font color="#0000ff">To</font></span><font color="#000000"> 100</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">Try</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">' new the database making sure to dispose it once we are finished, using/end using</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Using</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">db</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">New</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">Database</font></span><font color="#000000">(</font><span style="color: "><font color="#0000ff">False</font></span><font color="#000000">, </font><span style="color: "><font color="#0000ff">True</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">' read some drawing tile</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">db</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">ReadDwgFile</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;d:\wutemp\fatal.dwg&quot;</font></span><font color="#000000">, </font><span style="color: "><font color="#2b91af">FileOpenMode</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">OpenForReadAndAllShare</font></span><font color="#000000">, </font><span style="color: "><font color="#0000ff">False</font></span><font color="#000000">, </font><span style="color: "><font color="#0000ff">Nothing</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">' set the working database via our DbxExtender</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">DevTech</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">DbxExtender</font></span><font color="#000000">.</font><span style="color: "><font color="#2b91af">Utils</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">SetWorkingDatabase</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">db</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">Using</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Catch</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">ex</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#2b91af">Exception</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">MessageBox</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Show</font></span><font color="#000000">(</font><span style="color: "><font color="#2b91af">ex</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Message</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">Try</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">Next</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">Using</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">Sub</font></span></font><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">End</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">Class</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p>I’m going to implement my own unmanaged AcDbHostApplicationServices, but I still need to create .NET HostApplicationServices class which my .NET code can use… it’s implemented but not Initialize()’d – basically it’s a dummy HostApplicationServices object…</p>    <div style="font-family: ; background: white; color: ">     <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">Imports</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#010001">Autodesk</font></span><font color="#000000">.</font></font><span style="color: "><font style="font-size: 8pt" color="#010001">AutoCAD</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">Imports</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#010001">Autodesk</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">AutoCAD</font></span><font color="#000000">.</font></font><span style="color: "><font style="font-size: 8pt" color="#010001">Runtime</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">Imports</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#010001">Autodesk</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">AutoCAD</font></span><font color="#000000">.</font></font><span style="color: "><font style="font-size: 8pt" color="#010001">DatabaseServices</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">Imports</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#010001">Autodesk</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">AutoCAD</font></span><font color="#000000">.</font></font><span style="color: "><font style="font-size: 8pt" color="#010001">Geometry</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>      <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">' by Fenton Webb, DevTech, Autodesk 30/04/2010</font></font></span></p>      <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">'this host app should never be called. It will be replaced by DevTech.DbxExtender.Utils.Initialize()</font></font></span></p>      <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">Public</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#0000ff">Class</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#2b91af">DummyHost</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Inherits</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#2b91af">HostApplicationServices</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">Overrides</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">Function</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">FindFile</font></span><font color="#000000">(</font><span style="color: "><font color="#0000ff">ByVal</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">fileName</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">String</font></span><font color="#000000">, </font><span style="color: "><font color="#0000ff">ByVal</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">database</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">Autodesk</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">AutoCAD</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">DatabaseServices</font></span><font color="#000000">.</font><span style="color: "><font color="#2b91af">Database</font></span><font color="#000000">, </font><span style="color: "><font color="#0000ff">ByVal</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">hint</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">Autodesk</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">AutoCAD</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">DatabaseServices</font></span><font color="#000000">.</font><span style="color: "><font color="#2b91af">FindFileHint</font></span><font color="#000000">) </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">String</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">FindFile</font></span><font color="#000000"> = </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">Nothing</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">Function</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">End</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">Class</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>      <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">Public</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#0000ff">Class</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#2b91af">AdskDBXEngine</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Implements</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#2b91af">IDisposable</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">Sub</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">New</font></span><font color="#000000">()</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">' create a new database </font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">Try</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Dim</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">host</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">New</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#2b91af">DummyHost</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">RuntimeSystem</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Initialize</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">host</font></span><font color="#000000">, 1033)</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">GC</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">KeepAlive</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">host</font></span><font color="#000000">)</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">DevTech</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">DbxExtender</font></span><font color="#000000">.</font><span style="color: "><font color="#2b91af">Utils</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Initialize</font></span><font color="#000000">()</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Catch</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">ex</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#2b91af">Exception</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Throw</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">New</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">Exception</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;Error creating new database&quot;</font></span><font color="#000000">)</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">Try</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">Sub</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">Sub</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">Dispose</font></span><font color="#000000">() </font><span style="color: "><font color="#0000ff">Implements</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">IDisposable</font></span><font color="#000000">.</font></font><span style="color: "><font style="font-size: 8pt" color="#010001">Dispose</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">DevTech</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">DbxExtender</font></span><font color="#000000">.</font><span style="color: "><font color="#2b91af">Utils</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Terminate</font></span><font color="#000000">()</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">Sub</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">End</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">Class</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>      <p>Now into an unmanaged C++ DBX module… Here’s my C++ implementation of my custom AcDbHostApplicationServices object…</p>      <div style="font-family: ; background: white; color: ">       <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">//////////////////////////////////////////////////////////////////////////</font></font></span></p>        <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">// by Fenton Webb, DevTech, Autodesk 30/04/2010</font></font></span></p>        <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">//-----------------------------------------------------------------------------</font></font></span></p>        <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">//----- HostApplicationServices.cpp</font></font></span></p>        <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">//-----------------------------------------------------------------------------</font></font></span></p>        <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">#include</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#a31515">&quot;StdAfx.h&quot;</font></span></font></p>        <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">#include</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#a31515">&quot;HostApplicationServices.h&quot;</font></span></font></p>        <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">#include</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#a31515">&quot;Wininet.h&quot;</font></span></font></p>        <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">#include</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#a31515">&quot;Shlwapi.h&quot;</font></span></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>        <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">//////////////////////////////////////////////////////////////////////////</font></font></span></p>        <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">#pragma</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">unmanaged</font></span></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>        <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">//////////////////////////////////////////////////////////////////////////////</font></font></span></p>        <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#010001"><font style="font-size: 8pt">HostApplication</font></font></span><font style="font-size: 8pt"><font color="#000000">::</font><span style="color: "><font color="#010001">HostApplication</font></span><font color="#000000">()&#160;&#160;&#160; </font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">{</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">}</font></font></p>        <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">//////////////////////////////////////////////////////////////////////////////</font></font></span></p>        <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#010001"><font style="font-size: 8pt">HostApplication</font></font></span><font style="font-size: 8pt"><font color="#000000">::~</font><span style="color: "><font color="#010001">HostApplication</font></span><font color="#000000">()</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">{</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">CString</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">local</font></span><font color="#000000">,</font><span style="color: "><font color="#010001">url</font></span><font color="#000000">;</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">for</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">POSITION</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">pos</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">m_localToUrl</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">GetStartPosition</font></span><font color="#000000">();</font><span style="color: "><font color="#010001">pos</font></span><font color="#000000">!=</font><span style="color: "><font color="#010001">NULL</font></span><font color="#000000">;)</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000"> {</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">m_localToUrl</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">GetNextAssoc</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">pos</font></span><font color="#000000">,</font><span style="color: "><font color="#010001">local</font></span><font color="#000000">,</font><span style="color: "><font color="#010001">url</font></span><font color="#000000">);</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">DeleteUrlCacheEntry</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">url</font></span><font color="#000000">);</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000"> }</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">}</font></font></p>        <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">//////////////////////////////////////////////////////////////////////////////</font></font></span></p>        <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">// Return the Install directory for customizable files</font></font></span></p>        <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#010001"><font style="font-size: 8pt">Acad</font></font></span><font style="font-size: 8pt"><font color="#000000">::</font><span style="color: "><font color="#010001">ErrorStatus</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">HostApplication</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">getRoamableRootFolder</font></span><font color="#000000">(</font><span style="color: "><font color="#0000ff">const</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">ACHAR</font></span><font color="#000000">*&amp; </font><span style="color: "><font color="#010001">folder</font></span><font color="#000000">)</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">{</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">Acad</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">ErrorStatus</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">ret</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">Acad</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">eOk</font></span><font color="#000000">;</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">static</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">ACHAR</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">buf</font></span><font color="#000000">[</font><span style="color: "><font color="#010001">MAX_PATH</font></span><font color="#000000">] = </font><span style="color: "><font color="#010001">_T</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;\0&quot;</font></span><font color="#000000">); </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">//MDI SAFE</font></span></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">buf</font></span><font color="#000000">[0]==0)</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">GetModuleFileName</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">NULL</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">buf</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">MAX_PATH</font></span><font color="#000000">) != 0)</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">ret</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">Acad</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">eRegistryAccessError</font></span><font color="#000000">;</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">folder</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">buf</font></span><font color="#000000">;</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">ret</font></span><font color="#000000">;</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">}</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>        <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">//////////////////////////////////////////////////////////////////////////////</font></font></span></p>        <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">// Return the Install directory for customizable files</font></font></span></p>        <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#010001"><font style="font-size: 8pt">Acad</font></font></span><font style="font-size: 8pt"><font color="#000000">::</font><span style="color: "><font color="#010001">ErrorStatus</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">HostApplication</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">getLocalRootFolder</font></span><font color="#000000">(</font><span style="color: "><font color="#0000ff">const</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">ACHAR</font></span><font color="#000000">*&amp; </font><span style="color: "><font color="#010001">folder</font></span><font color="#000000">)</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">{</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">Acad</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">ErrorStatus</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">ret</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">Acad</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">eOk</font></span><font color="#000000">;</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">static</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">ACHAR</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">buf</font></span><font color="#000000">[</font><span style="color: "><font color="#010001">MAX_PATH</font></span><font color="#000000">] = </font><span style="color: "><font color="#010001">_T</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;\0&quot;</font></span><font color="#000000">); </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">//MDI SAFE</font></span></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">buf</font></span><font color="#000000">[0]==0)</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">GetModuleFileName</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">NULL</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">buf</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">MAX_PATH</font></span><font color="#000000">) != 0)</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">ret</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">Acad</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">eRegistryAccessError</font></span><font color="#000000">;</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">folder</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">buf</font></span><font color="#000000">;</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">ret</font></span><font color="#000000">;</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">}</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>        <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">//////////////////////////////////////////////////////////////////////////////</font></font></span></p>        <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#010001"><font style="font-size: 8pt">Acad</font></font></span><font style="font-size: 8pt"><font color="#000000">::</font><span style="color: "><font color="#010001">ErrorStatus</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">HostApplication</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">findFile</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">ACHAR</font></span><font color="#000000">* </font><span style="color: "><font color="#010001">pcFullPathOut</font></span><font color="#000000">, </font><span style="color: "><font color="#0000ff">int</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">nBufferLength</font></span><font color="#000000">,</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">const</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">ACHAR</font></span><font color="#000000">* </font><span style="color: "><font color="#010001">pcFilename</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">AcDbDatabase</font></span><font color="#000000">* </font><span style="color: "><font color="#010001">pDb</font></span><font color="#000000">, </font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">AcDbHostApplicationServices</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">FindFileHint</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">hint</font></span><font color="#000000">)</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">{</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">ACHAR</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">pExtension</font></span><font color="#000000">[5];</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">switch</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">hint</font></span><font color="#000000">)</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160; {</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">case</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">kCompiledShapeFile</font></span><font color="#000000">:</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">_tcscpy</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">pExtension</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">_T</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;.shx&quot;</font></span><font color="#000000">));</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">break</font></span><font color="#000000">;</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">case</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">kTrueTypeFontFile</font></span><font color="#000000">:</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">_tcscpy</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">pExtension</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">_T</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;.ttf&quot;</font></span><font color="#000000">));</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">break</font></span><font color="#000000">;</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">case</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">kPatternFile</font></span><font color="#000000">:</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">_tcscpy</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">pExtension</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">_T</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;.pat&quot;</font></span><font color="#000000">));</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">break</font></span><font color="#000000">;</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">case</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">kARXApplication</font></span><font color="#000000">:</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">_tcscpy</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">pExtension</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">_T</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;.dbx&quot;</font></span><font color="#000000">));</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">break</font></span><font color="#000000">;</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">case</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">kFontMapFile</font></span><font color="#000000">:</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">_tcscpy</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">pExtension</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">_T</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;.fmp&quot;</font></span><font color="#000000">));</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">break</font></span><font color="#000000">;</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">case</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">kXRefDrawing</font></span><font color="#000000">:</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">_tcscpy</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">pExtension</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">_T</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;.dwg&quot;</font></span><font color="#000000">));</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">break</font></span><font color="#000000">;</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">case</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">kFontFile</font></span><font color="#000000">:&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// Fall through.&#160; These could have</font></span></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">case</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">kEmbeddedImageFile</font></span><font color="#000000">:&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// various extensions</font></span></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">default</font></span><font color="#000000">:</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">pExtension</font></span><font color="#000000">[0] = </font><span style="color: "><font color="#010001">_T</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">'\0'</font></span><font color="#000000">);</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">break</font></span><font color="#000000">;</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160; }</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">ACHAR</font></span><font color="#000000">* </font><span style="color: "><font color="#010001">filePart</font></span><font color="#000000">;</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">DWORD</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">result</font></span><font color="#000000">;</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">ACHAR</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">path</font></span><font color="#000000">[</font><span style="color: "><font color="#010001">MAX_PATH</font></span><font color="#000000">];</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">GetModuleFileName</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">NULL</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">path</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">MAX_PATH</font></span><font color="#000000">);</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">PathRemoveFileSpec</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">path</font></span><font color="#000000">);</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">_tcscat</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">path</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">_T</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;\\AutoCADImages&quot;</font></span><font color="#000000">));</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">result</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">SearchPath</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">path</font></span><font color="#000000">, </font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">pcFilename</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">pExtension</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">nBufferLength</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">pcFullPathOut</font></span><font color="#000000">, &amp;</font><span style="color: "><font color="#010001">filePart</font></span><font color="#000000">);</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">result</font></span><font color="#000000"> &amp;&amp; </font><span style="color: "><font color="#010001">result</font></span><font color="#000000"> &lt; (</font><span style="color: "><font color="#010001">DWORD</font></span><font color="#000000">)</font><span style="color: "><font color="#010001">nBufferLength</font></span><font color="#000000">)</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">Acad</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">eOk</font></span><font color="#000000">;</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">else</font></span></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">Acad</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">eFileNotFound</font></span><font color="#000000">;</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">}</font></font></p>        <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">//////////////////////////////////////////////////////////////////////////////</font></font></span></p>        <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#010001"><font style="font-size: 8pt">Adesk</font></font></span><font style="font-size: 8pt"><font color="#000000">::</font><span style="color: "><font color="#010001">Boolean</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">HostApplication</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">isURL</font></span><font color="#000000">(</font><span style="color: "><font color="#0000ff">const</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">ACHAR</font></span><font color="#000000">* </font><span style="color: "><font color="#010001">pszURL</font></span><font color="#000000">) </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">const</font></span></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">{</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">PathIsURL</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">pszURL</font></span><font color="#000000">);</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">}</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>        <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">//////////////////////////////////////////////////////////////////////////////</font></font></span></p>        <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#010001"><font style="font-size: 8pt">Adesk</font></font></span><font style="font-size: 8pt"><font color="#000000">::</font><span style="color: "><font color="#010001">Boolean</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">HostApplication</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">isRemoteFile</font></span><font color="#000000">(</font><span style="color: "><font color="#0000ff">const</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">ACHAR</font></span><font color="#000000">* </font><span style="color: "><font color="#010001">pszLocalFile</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">ACHAR</font></span><font color="#000000">* </font><span style="color: "><font color="#010001">pszURL</font></span><font color="#000000">) </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">const</font></span></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">{</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">CString</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">value</font></span><font color="#000000">;</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">m_localToUrl</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Lookup</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">pszLocalFile</font></span><font color="#000000">,</font><span style="color: "><font color="#010001">value</font></span><font color="#000000">))</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000"> {</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">_tcscpy</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">pszURL</font></span><font color="#000000">,</font><span style="color: "><font color="#010001">value</font></span><font color="#000000">);</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">TRUE</font></span><font color="#000000">;</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000"> }</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">FALSE</font></span><font color="#000000">;</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">}</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>        <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">//////////////////////////////////////////////////////////////////////////////</font></font></span></p>        <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#010001"><font style="font-size: 8pt">Acad</font></font></span><font style="font-size: 8pt"><font color="#000000">::</font><span style="color: "><font color="#010001">ErrorStatus</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">HostApplication</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">getRemoteFile</font></span><font color="#000000">(</font><span style="color: "><font color="#0000ff">const</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">ACHAR</font></span><font color="#000000">* </font><span style="color: "><font color="#010001">pszURL</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">ACHAR</font></span><font color="#000000">* </font><span style="color: "><font color="#010001">pszLocalFile</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">Adesk</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">Boolean</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">bIgnoreCache</font></span><font color="#000000">) </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">const</font></span></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">{</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">DWORD</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">err</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">ERROR_FILE_NOT_FOUND</font></span><font color="#000000">;</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (!</font><span style="color: "><font color="#010001">bIgnoreCache</font></span><font color="#000000">)</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000"> {</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">DWORD</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">size</font></span><font color="#000000"> = 0;</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">GetUrlCacheEntryInfo</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">pszURL</font></span><font color="#000000">,</font><span style="color: "><font color="#010001">NULL</font></span><font color="#000000">,&amp;</font><span style="color: "><font color="#010001">size</font></span><font color="#000000">))</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">Acad</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">eInetFileGenericError</font></span><font color="#000000">; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">//this shouldn't succeed</font></span></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">err</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">GetLastError</font></span><font color="#000000">();</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">err</font></span><font color="#000000"> == </font><span style="color: "><font color="#010001">ERROR_INSUFFICIENT_BUFFER</font></span><font color="#000000">)</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160; {</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">INTERNET_CACHE_ENTRY_INFO</font></span><font color="#000000">* </font><span style="color: "><font color="#010001">pCacheEntry</font></span><font color="#000000"> = (</font><span style="color: "><font color="#010001">INTERNET_CACHE_ENTRY_INFO</font></span><font color="#000000">*)</font><span style="color: "><font color="#010001">malloc</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">size</font></span><font color="#000000">);</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">GetUrlCacheEntryInfo</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">pszURL</font></span><font color="#000000">,</font><span style="color: "><font color="#010001">pCacheEntry</font></span><font color="#000000">,&amp;</font><span style="color: "><font color="#010001">size</font></span><font color="#000000">))</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160; {</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">_tcscpy</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">pszLocalFile</font></span><font color="#000000">,</font><span style="color: "><font color="#010001">pCacheEntry</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#010001">lpszLocalFileName</font></span><font color="#000000">);</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">m_localToUrl</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">SetAt</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">pszLocalFile</font></span><font color="#000000">,</font><span style="color: "><font color="#010001">pszURL</font></span><font color="#000000">);</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">free</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">pCacheEntry</font></span><font color="#000000">);</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">Acad</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">eInetOk</font></span><font color="#000000">;</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160; }</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">err</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">GetLastError</font></span><font color="#000000">();</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160; }</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000"> }</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">err</font></span><font color="#000000"> == </font><span style="color: "><font color="#010001">ERROR_FILE_NOT_FOUND</font></span><font color="#000000">)</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000"> {</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">SUCCEEDED</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">URLDownloadToCacheFile</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">NULL</font></span><font color="#000000">,</font><span style="color: "><font color="#010001">pszURL</font></span><font color="#000000">,</font><span style="color: "><font color="#010001">pszLocalFile</font></span><font color="#000000">,</font><span style="color: "><font color="#010001">_MAX_PATH</font></span><font color="#000000">,0,</font><span style="color: "><font color="#010001">NULL</font></span><font color="#000000">)))</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160; {</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">m_localToUrl</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">SetAt</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">pszLocalFile</font></span><font color="#000000">,</font><span style="color: "><font color="#010001">pszURL</font></span><font color="#000000">);</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">Acad</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">eInetOk</font></span><font color="#000000">;</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160; }</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000"> }</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">Acad</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">eInetFileGenericError</font></span><font color="#000000">;</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">}</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>        <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">//////////////////////////////////////////////////////////////////////////////</font></font></span></p>        <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#010001"><font style="font-size: 8pt">ACHAR</font></font></span><font style="font-size: 8pt"><font color="#000000"> * </font><span style="color: "><font color="#010001">HostApplication</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">getAlternateFontName</font></span><font color="#000000">() </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">const</font></span></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">{</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">_T</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;txt.shx&quot;</font></span><font color="#000000">); </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">//findFile will be called again with this name</font></span></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">}</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>        <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">//////////////////////////////////////////////////////////////////////////////</font></font></span></p>        <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">void</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#010001">HostApplication</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">fatalError</font></span><font color="#000000">(</font><span style="color: "><font color="#0000ff">const</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">ACHAR</font></span><font color="#000000"> *</font><span style="color: "><font color="#010001">format</font></span><font color="#000000">, ...)</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">{</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">throw</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">Acad</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">eFileInternalErr</font></span><font color="#000000">;</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">}</font></font><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>        <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">// Called when an unhandled exception occurs in an arx command or message.</font></font></span></p>        <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">// The EXCEPTION_POINTERS pointer is obtained from the win32 api:</font></font></span></p>        <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">// GetExceptionInformation().</font></font></span></p>        <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">//</font></font></span></p>        <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">//////////////////////////////////////////////////////////////////////////////</font></font></span></p>        <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">void</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#010001">HostApplication</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">reportUnhandledArxException</font></span><font color="#000000">(</font><span style="color: "><font color="#0000ff">const</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">_EXCEPTION_POINTERS</font></span><font color="#000000"> *</font><span style="color: "><font color="#010001">pExcPtrs</font></span><font color="#000000">,</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">const</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">ACHAR</font></span><font color="#000000"> *</font><span style="color: "><font color="#010001">pAppName</font></span><font color="#000000">)</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">{</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// might want to send your minidump file back to your company for processing</font></span></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">}</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>        <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">// The equivalent of ads_usrbrk()</font></font></span></p>        <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">//////////////////////////////////////////////////////////////////////////////</font></font></span></p>        <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#010001"><font style="font-size: 8pt">Adesk</font></font></span><font style="font-size: 8pt"><font color="#000000">::</font><span style="color: "><font color="#010001">Boolean</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">HostApplication</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">userBreak</font></span><font color="#000000">(</font><span style="color: "><font color="#0000ff">bool</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">updCtrlsWhenEnteringIdle</font></span><font color="#000000">) </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">const</font></span></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">{</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">throw</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">Acad</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">eUserBreak</font></span><font color="#000000">;</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">}</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>        <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">//////////////////////////////////////////////////////////////////////////////</font></font></span></p>     </div>   </div> </div>  <p>Now my Mixed Mode acrxEntryPoint()…</p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">//////////////////////////////////////////////////////////////////////////</font></font></span></p>    <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">// by Fenton Webb, DevTech, Autodesk 30/04/2010</font></font></span></p>    <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">//-----------------------------------------------------------------------------</font></font></span></p>    <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">//----- acrxEntryPoint.cpp</font></font></span></p>    <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">//-----------------------------------------------------------------------------</font></font></span></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">#include</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#a31515">&quot;StdAfx.h&quot;</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">#include</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#a31515">&quot;resource.h&quot;</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">//-----------------------------------------------------------------------------</font></font></span></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">#define</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#010001">szRDS</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">_RXST</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;asdk&quot;</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">//-----------------------------------------------------------------------------</font></font></span></p>    <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">//----- ObjectARX EntryPoint</font></font></span></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">class</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#010001">CDBXExtensionDotNetWrapperApp</font></span><font color="#000000"> : </font><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">AcRxDbxApp</font></span><font color="#000000"> {</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">public</font></font></span><font style="font-size: 8pt" color="#000000">:</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">CDBXExtensionDotNetWrapperApp</font></span><font color="#000000"> () : </font><span style="color: "><font color="#010001">AcRxDbxApp</font></span><font color="#000000"> () {}</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">virtual</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">AcRx</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">AppRetCode</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">On_kInitAppMsg</font></span><font color="#000000"> (</font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000"> *</font><span style="color: "><font color="#010001">pkt</font></span><font color="#000000">) {</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// TODO: Load dependencies here</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// You *must* call On_kInitAppMsg here</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">AcRx</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">AppRetCode</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">retCode</font></span><font color="#000000"> =</font><span style="color: "><font color="#010001">AcRxDbxApp</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">On_kInitAppMsg</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">pkt</font></span><font color="#000000">) ;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">retCode</font></span><font color="#000000">) ;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000"> }</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">virtual</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">AcRx</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">AppRetCode</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">On_kUnloadAppMsg</font></span><font color="#000000"> (</font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000"> *</font><span style="color: "><font color="#010001">pkt</font></span><font color="#000000">) {</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// TODO: Add your code here</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// You *must* call On_kUnloadAppMsg here</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">AcRx</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">AppRetCode</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">retCode</font></span><font color="#000000"> =</font><span style="color: "><font color="#010001">AcRxDbxApp</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">On_kUnloadAppMsg</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">pkt</font></span><font color="#000000">) ;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">retCode</font></span><font color="#000000">) ;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000"> }</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">virtual</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">RegisterServerComponents</font></span><font color="#000000"> () {</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000"> }</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">} ;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">#pragma</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">unmanaged</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">#include</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#a31515">&quot;HostApplicationServices.h&quot;</font></span></font></p>    <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">//////////////////////////////////////////////////////////////////////////</font></font></span></p>    <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">// native C++ unmanaged set working database handler</font></font></span></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#010001"><font style="font-size: 8pt">Acad</font></font></span><font style="font-size: 8pt"><font color="#000000">::</font><span style="color: "><font color="#010001">ErrorStatus</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">native_setWorkingDatabase</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">AcDbDatabase</font></span><font color="#000000">* </font><span style="color: "><font color="#010001">dwg</font></span><font color="#000000">) </font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">{</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">Acad</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">ErrorStatus</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">es</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">Acad</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">eOk</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// if ok</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">dwg</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000"> {</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">acdbHostApplicationServices</font></span><font color="#000000">()-&gt;</font><span style="color: "><font color="#010001">setWorkingDatabase</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">dwg</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000"> }</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">es</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">}</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">//////////////////////////////////////////////////////////////////////////</font></font></span></p>    <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">// native C++ setdhost app</font></font></span></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#010001"><font style="font-size: 8pt">Acad</font></font></span><font style="font-size: 8pt"><font color="#000000">::</font><span style="color: "><font color="#010001">ErrorStatus</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">native_acdbSetHostApplicationServices</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">AcDbHostApplicationServices</font></span><font color="#000000">* </font><span style="color: "><font color="#010001">pHost</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">{</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">acdbSetHostApplicationServices</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">pHost</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">}</font></font></p>    <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">//-----------------------------------------------------------------------------</font></font></span></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#010001"><font style="font-size: 8pt">IMPLEMENT_ARX_ENTRYPOINT</font></font></span><font style="font-size: 8pt"><font color="#000000">(</font><span style="color: "><font color="#010001">CDBXExtensionDotNetWrapperApp</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">Almost there… Now for my Mixed Mode Utils header…</p>    <p style="margin: 0px">&#160;</p>    <div style="font-family: ; background: white; color: ">     <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>      <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">//////////////////////////////////////////////////////////////////////////</font></font></span></p>      <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">// mgDbx.h - by Fenton Webb, DevTech, Autodesk 14/01/2005</font></font></span></p>      <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">//////////////////////////////////////////////////////////////////////////</font></font></span></p>      <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>      <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">#pragma</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">once</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>      <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#0000ff">namespace</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">System</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#0000ff">namespace</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">Autodesk</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">AutoCAD</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">DatabaseServices</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>      <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">namespace</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#010001">DevTech</font></span><font color="#000000"> </font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">{</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">namespace</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#010001">DbxExtender</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000"> {</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">ref</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">class</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">Utils</font></span><font color="#000000"> </font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160; {</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000">:</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">static</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">Initialize</font></span><font color="#000000">();</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">static</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">Terminate</font></span><font color="#000000">();</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">static</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">long</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">SetWorkingDatabase</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">Database</font></span><font color="#000000"> ^</font><span style="color: "><font color="#010001">dwg</font></span><font color="#000000">);</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160; };</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000"> }</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">}</font></font></p>   </div> </div>  <p style="margin: 0px">&#160;</p>  <p style="margin: 0px">Finally, my Mixed Mode utils implementation code…</p>  <p style="margin: 0px">&#160;</p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">// This is the main DLL file.</font></font></span></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">#include</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#a31515">&quot;stdafx.h&quot;</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">#include</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#a31515">&quot;mgDbx.h&quot;</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">//////////////////////////////////////////////////////////////////////////</font></font></span></p>    <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">// by Fenton Webb, DevTech, Autodesk 30/04/2010</font></font></span></p>    <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">//////////////////////////////////////////////////////////////////////////</font></font></span></p>    <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">// switch to using the unmanaged ODBX SDK, we must link with rcexelib.obj to avoid security problems</font></font></span></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">#pragma</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">unmanaged</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">#include</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#a31515">&quot;HostApplicationServices.h&quot;</font></span></font></p>    <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">//////////////////////////////////////////////////////////////////////////</font></font></span></p>    <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">// native C++ unmanaged hatch handler</font></font></span></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">extern</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#010001">Acad</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">ErrorStatus</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">native_setWorkingDatabase</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">AcDbDatabase</font></span><font color="#000000">* </font><span style="color: "><font color="#010001">pDb</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">// native C++ unmanaged set host app</font></font></span></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#010001"><font style="font-size: 8pt">Acad</font></font></span><font style="font-size: 8pt"><font color="#000000">::</font><span style="color: "><font color="#010001">ErrorStatus</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">native_acdbSetHostApplicationServices</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">AcDbHostApplicationServices</font></span><font color="#000000">* </font><span style="color: "><font color="#010001">pHost</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">// switch back, no need really</font></font></span></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">#pragma</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">managed</font></span></font></p>    <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">//////////////////////////////////////////////////////////////////////////</font></font></span></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">#pragma</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">managed</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#0000ff">namespace</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">Autodesk</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">AutoCAD</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">DatabaseServices</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#0000ff">namespace</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">Autodesk</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">AutoCAD</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">Runtime</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">//////////////////////////////////////////////////////////////////////////</font></font></span></p>    <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">// initialise the host application</font></font></span></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#010001"><font style="font-size: 8pt">AcDbHostApplicationServices</font></font></span><font style="font-size: 8pt"><font color="#000000">* </font><span style="color: "><font color="#010001">gpHostApp</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">NULL</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">void</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#010001">DevTech</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">DbxExtender</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">Utils</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">Initialize</font></span><font color="#000000">()</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">{</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">ASSERT</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">gpHostApp</font></span><font color="#000000"> == </font><span style="color: "><font color="#010001">NULL</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">ASSERT</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">acdbHostApplicationServices</font></span><font color="#000000">()!=</font><span style="color: "><font color="#010001">NULL</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">//replace the host app with our own</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">gpHostApp</font></span><font color="#000000"> = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">HostApplication</font></span><font color="#000000">();</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">native_acdbSetHostApplicationServices</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">gpHostApp</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">}</font></font></p>    <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">//////////////////////////////////////////////////////////////////////////</font></font></span></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">void</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#010001">DevTech</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">DbxExtender</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">Utils</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">Terminate</font></span><font color="#000000">()</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">{</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">ASSERT</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">gpHostApp</font></span><font color="#000000"> != </font><span style="color: "><font color="#010001">NULL</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">delete</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">gpHostApp</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">}</font></font></p>    <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">//////////////////////////////////////////////////////////////////////////</font></font></span></p>    <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">// set Workingdatabase Util</font></font></span></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">long</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#010001">DevTech</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">DbxExtender</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">Utils</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">SetWorkingDatabase</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">Database</font></span><font color="#000000"> ^</font><span style="color: "><font color="#010001">managedDwg</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">{</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">Acad</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">ErrorStatus</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">es</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">Acad</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">eNullPtr</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// get the unmanaged pointer</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">AcDbDatabase</font></span><font color="#000000"> *</font><span style="color: "><font color="#010001">dwg</font></span><font color="#000000"> = </font><span style="color: "><font color="#0000ff">static_cast</font></span><font color="#000000">&lt;</font><span style="color: "><font color="#010001">AcDbDatabase</font></span><font color="#000000">*&gt;(</font><span style="color: "><font color="#010001">managedDwg</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#010001">UnmanagedObject</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">ToPointer</font></span><font color="#000000">());</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// if ok</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">dwg</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000"> {</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// call the native unmanaged DxfOut</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">es</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">native_setWorkingDatabase</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">dwg</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000"> }</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> (</font><span style="color: "><font color="#0000ff">long</font></span><font color="#000000">)</font><span style="color: "><font color="#010001">es</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">}</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px">You should know that at the time of writing, this all needs o be done, but we should have this updated in the next few releases.</p> </div>
