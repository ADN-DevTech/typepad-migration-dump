---
layout: "post"
title: "How to mimic the AutoCAD insert command in ARX without acedCommand call"
date: "2013-01-07 17:38:09"
author: "Gopinath Taget"
categories:
  - "2010"
  - "2011"
  - "2012"
  - "2013"
  - "AutoCAD"
  - "Gopinath Taget"
  - "ObjectARX"
original_url: "https://adndevblog.typepad.com/autocad/2013/01/how-to-mimic-the-autocad-insert-command-in-arx-without-acedcommand-call.html "
typepad_basename: "how-to-mimic-the-autocad-insert-command-in-arx-without-acedcommand-call"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/gopinath-taget.html">Gopinath Taget</a></p>  <p>This operation needs to be divided into two different steps. The first step is to have an AcDbBlockTableRecord, which contains the block definition. You could either create, edit an existing one, or import it from another drawing file. The following example shows how to import a block definition from an external drawing file:</p>  <div style="font-family: ; background: white">   <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">AcDbDatabase *pDwg =</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#0000ff">new</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> AcDbDatabase (Adesk::kFalse) ;</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; pDwg-&gt;readDwgFile (_T(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#a31515">&quot;c:\\drawing1.dwg&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">)) ;</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#008000">//----- Put it into a block table record of the current database</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160; AcDbObjectId id ;</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160; Acad::ErrorStatus es = acdbHostApplicationServices()-&gt;</font></font></span></p>    <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; workingDatabase()-&gt;insert(id, _T(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#a31515">&quot;drawing1&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">), pDwg, Adesk::kFalse) ;</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#0000ff">if</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> ( es != Acad::eOk )</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; acutPrintf (_T(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#a31515">&quot;\nError inserting a block.&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">)) ;</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#0000ff">delete</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> pDwg ;</font></span></font></p> </div>  <p>As soon as you have a block table record in place you can add an AcDbBlockReference with it. The block reference is the INSERT'ed block table record instance that is displayed in the model or paper space. The below example shows how to create a block reference with attributes from a block table record. You can call it following above code like this:</p>  <div style="font-family: ; background: white">   <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000">AcGePoint3d point3D(0,0,0);</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000">addBlockWithAttributes(id,point3D);</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font color="#000000" face="Consolas"></font></span></p>    <p style="margin: 0px">Here is the code for addBlockWithAttributes:</p>    <p style="margin: 0px"><span style="line-height: 11pt"><font color="#000000" face="Consolas"></font></span></p>    <div style="font-family: ; background: white">     <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#008000">// NOTE: You will have to update the code to properly set the </font></font></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#008000">// attribute values. The code below sets the value of each </font></font></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#008000">// attribute to &quot;XXX&quot;.</font></font></span></p>      <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#0000ff"><font style="font-size: 8pt">static</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt"><font color="#0000ff">void</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> addBlockWithAttributes (AcDbObjectId blockId, </font></span></font></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000"> AcGePoint3d basePoint) {</font></font></span></p>      <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#008000">//----- Step 1: Allocate a block reference object</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt"> AcDbBlockReference *pBlkRef =</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#0000ff">new</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> AcDbBlockReference ;</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#008000">//----- Step 2: Set up the block reference to the newly</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#008000">//----- created block definition</font></span></font></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000"> pBlkRef-&gt;setBlockTableRecord (blockId) ;</font></font></span></p>      <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#008000">//---- Give it the current UCS normal.</font></span></font></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000"> pBlkRef-&gt;setPosition (basePoint) ;</font></font></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000"> pBlkRef-&gt;setRotation (0.0) ;</font></font></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000"> pBlkRef-&gt;setNormal (AcGeVector3d (0.0, 0.0, 1.0)) ;</font></font></span></p>      <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#008000">//----- Step 3: Open current database's Model Space</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#008000">//----- blockTableRecord</font></span></font></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000"> AcDbBlockTable *pBlockTable ;</font></font></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000"> acdbHostApplicationServices()-&gt;workingDatabase()-&gt;</font></font></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160; getBlockTable (pBlockTable, AcDb::kForRead) ;</font></font></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000"> AcDbBlockTableRecord *pBlockTableRecord ;</font></font></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000"> pBlockTable-&gt;getAt (ACDB_MODEL_SPACE, pBlockTableRecord,</font></font></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160; AcDb::kForWrite) ;</font></font></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000"> pBlockTable-&gt;close () ;</font></font></span></p>      <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#008000">//----- Append the block reference to the model space</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#008000">//----- block table record</font></span></font></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000"> AcDbObjectId newEntId ;</font></font></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000"> pBlockTableRecord-&gt;appendAcDbEntity (newEntId, pBlkRef) ;</font></font></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000"> pBlockTableRecord-&gt;close () ;</font></font></span></p>      <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#008000">//----- Step 4: Open the block definition for read</font></span></font></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000"> AcDbBlockTableRecord *pBlockDef ;</font></font></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000"> acdbOpenObject (pBlockDef, blockId, AcDb::kForRead) ;</font></font></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000"> AcDbBlockTableRecordIterator *pIterator ;</font></font></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000"> pBlockDef-&gt;newIterator (pIterator) ;</font></font></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000"> AcDbEntity *pEnt ;</font></font></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000"> AcDbAttributeDefinition *pAttdef ;</font></font></span></p>      <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#0000ff">for</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> ( pIterator-&gt;start () ; !pIterator-&gt;done() ; </font></span></font></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160; pIterator-&gt;step () ) {</font></font></span></p>      <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#008000">//----- Get the next entity</font></span></font></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160; pIterator-&gt;getEntity (pEnt, AcDb::kForRead) ;</font></font></span></p>      <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#008000">//----- Make sure the entity is an attribute definition</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#008000">//----- and not a constant</font></span></font></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160; pAttdef =AcDbAttributeDefinition::cast (pEnt) ;</font></font></span></p>      <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#0000ff">if</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> ( pAttdef != NULL &amp;&amp; !pAttdef-&gt;isConstant () ) {</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#008000">//----- We have a non-constant attribute definition</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#008000">//----- so build an attribute entity</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; AcDbAttribute *pAtt =</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#0000ff">new</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> AcDbAttribute ;</font></span></font></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160; pAtt-&gt;setPropertiesFrom (pAttdef) ;</font></font></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160; pAtt-&gt;setInvisible (pAttdef-&gt;isInvisible ()) ;</font></font></span></p>      <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#008000">//----- Translate attribute by block reference.</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#008000">//----- To be really correct, entire block</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#008000">//----- reference transform should be applied here.</font></span></font></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160; basePoint =pAttdef-&gt;position () ;</font></font></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160; basePoint +=pBlkRef-&gt;position ().asVector () ;</font></font></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160; pAtt-&gt;setPosition (basePoint) ;</font></font></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160; pAtt-&gt;setHeight (pAttdef-&gt;height ()) ;</font></font></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160; pAtt-&gt;setRotation (pAttdef-&gt;rotation ()) ;</font></font></span></p>      <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; pAtt-&gt;setTag (_T(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#a31515">&quot;Tag&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">)) ;</font></span></font></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160; pAtt-&gt;setFieldLength (25) ;</font></font></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160; TCHAR *pStr =pAttdef-&gt;tag () ;</font></font></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160; pAtt-&gt;setTag (pStr) ;</font></font></span></p>      <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#0000ff">delete</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> pStr ;</font></span></font></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160; pAtt-&gt;setFieldLength (pAttdef-&gt;fieldLength ()) ;</font></font></span></p>      <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#008000">//----- Database Column value should be displayed</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#008000">//----- INSERT would prompt for this...</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; pAtt-&gt;setTextString (_T(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#a31515">&quot;XXX&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">)) ;</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#008000">//----- Set Alignments</font></span></font></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160; pAtt-&gt;setHorizontalMode( pAttdef-&gt;horizontalMode ()) ;</font></font></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160; pAtt-&gt;setVerticalMode (pAttdef-&gt;verticalMode ()) ;</font></font></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160; pAtt-&gt;setAlignmentPoint (</font></font></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; pAttdef-&gt;alignmentPoint ()</font></font></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; + pBlkRef-&gt;position ().asVector ()</font></font></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; ) ;</font></font></span></p>      <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#008000">//----- Insert the attribute in the DWG</font></span></font></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160; AcDbObjectId attId ;</font></font></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160; pBlkRef-&gt;appendAttribute (attId, pAtt) ;</font></font></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160; pAtt-&gt;close () ;</font></font></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160; }&#160;&#160;&#160;&#160; </font></font></span></p>      <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; pEnt-&gt;close () ; </font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#008000">//----- Use pEnt... pAttdef might be NULL</font></span></font></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000"> }</font></font></span></p>      <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#0000ff">delete</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> pIterator ;</font></span></font></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000"> pBlockDef-&gt;close () ;</font></font></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000"> pBlkRef-&gt;close () ;</font></font></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000">}</font></font></span></p>   </div> </div>
