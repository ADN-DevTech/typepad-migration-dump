---
layout: "post"
title: "Fenton&rsquo;s Recommended HostApplicationServices implementation for RealDWG .NET"
date: "2012-05-23 13:51:00"
author: "Fenton Webb"
categories:
  - ".NET"
  - "2011"
  - "RealDWG"
original_url: "https://adndevblog.typepad.com/autocad/2012/05/fentons-recommended-hostapplicationservices-implementation-for-realdwg-net.html "
typepad_basename: "fentons-recommended-hostapplicationservices-implementation-for-realdwg-net"
typepad_status: "Publish"
---

<p>by <a href="http://adndevblog.typepad.com/autocad/fenton-webb.html">Fenton Webb</a></p>  <p>Not sure how many of you know about Autodesk RealDWG so I thought I’d write a quick note on what it is and also include a starter HostApplicationServices implementation for those who want to get started with it.</p>  <p>Autodesk RealDWG can be first be explained via the marketing portal <a href="http://www.autodesk.com/realdwg">www.autodesk.com/realdwg</a></p>  <p>Talking shop now, the toolkit basically contains the ObjectARX SDK but without any AutoCAD specific APIs. No plotting, no Ribbon, no SheetSet, etc etc, just the API functions for reading and writing DWG files.</p>  <p>Some answers to common questions:</p>  <ol>   <li>Yes, it does read all DWG file versions – all the way back to V2 point something. </li>    <li>No you don’t need enablers installed to read the drawing. All DWG files can be read without object enablers being installed, that said, those objects that require object enablers won’t be readable. </li>    <li>Yes you can cut out components you don’t need, this is documented in the Redistribution Requirements section of the readdbx.chm file. </li>    <li>You must create an installer for any RealDWG application you create, that is also described Redistribution Requirements section of the readdbx.chm file. </li> </ol>  <p>Now the reason I’m posting a “Recommended HostApplicationServices” implementation is because I have found a lot of a problems people have had with RealDWG boiled down to their implementation of HostApplicationServices, mainly their HostApplicationServices::FindFile().</p>  <p>The HostApplicationServices class, as you can see below, defines what happens when certain types of “special things” happen in a DWG, like how to download an XRef from an FTP site for instance. These “special things” have no default implementation in RealDWG because RealDWG is a raw toolkit which is designed to be implemented as you see fit. It may come as a surprise to you guys, but actually RealDWG knows nothing about AutoCAD, it is AutoCAD that implements the RealDWG HostApplicationServices class in an AutoCAD way; so if you want RealDWG to resolve XRefs in the same way that AutoCAD does you have to specifically code your RealDWG app to do so…</p>  <p>I should mention that the C++ version of HostApplicationServices (AcDbHostApplicationServices) is even more detailed in its implementation which can be seen as a good thing (more control) or a bad thing (more complexity), your choice.</p>  <p>Anyway, here’s the code (originally used for a 2011 RealDWG App I wrote)…</p>  <div style="background: white">   <div style="font-family: ; background: white; color: ">     <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">class</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#2b91af">RealDwgHostServices</font></span><font color="#000000"> : </font></font><span style="color: "><font color="#010001" style="font-size: 8pt">HostApplicationServices</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">{</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">static</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">bool</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">_initialized</font></span><font color="#000000"> = </font><span style="color: "><font color="#0000ff">false</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">&#0160; #region</font></font></span><font color="#000000" style="font-size: 8pt"> Imports</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160; [</font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">DllImport</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;acdb18.dll&quot;</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">CallingConvention</font></span><font color="#000000"> = </font><span style="color: "><font color="#2b91af">CallingConvention</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Cdecl</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">EntryPoint</font></span><font color="#000000"> = </font><span style="color: "><font color="#a31515">&quot;acdbSetDefaultAcGiContext&quot;</font></span><font color="#000000">)]</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">static</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">extern</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">IntPtr</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">acdbSetDefaultAcGiContext</font></span><font color="#000000">(</font><span style="color: "><font color="#2b91af">IntPtr</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">context</font></span><font color="#000000">);</font></font></font></p>      <p style="margin: 0px"><span style="color: "><font face="Consolas"><font color="#0000ff" style="font-size: 8pt">&#0160; #endregion</font></font></span></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">RealDwgHostServices</font></span><font color="#000000">()</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160; {</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><span style="color: "><font color="#008000" style="font-size: 8pt">// if not already initialized (we can only call init once)</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (!</font><span style="color: "><font color="#010001">_initialized</font></span><font color="#000000">)</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;&#0160;&#0160; {</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">RuntimeSystem</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Initialize</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">realDWGHost</font></span><font color="#000000">, 1033);</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><span style="color: "><font color="#008000" style="font-size: 8pt">// ensure the internal AcGiContext is setup, Text objects can be affected by this</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">acdbSetDefaultAcGiContext</font></span><font color="#000000">(</font><span style="color: "><font color="#2b91af">IntPtr</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Zero</font></span><font color="#000000">); </font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">_initialized</font></span><font color="#000000"> = </font><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;&#0160;&#0160; }</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160; }</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">override</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">string</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">RegistryProductRootKey</font></span><font color="#000000"> </font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160; { </font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><span style="color: "><font color="#008000" style="font-size: 8pt">// you need to specify your own...</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><span style="color: "><font color="#008000" style="font-size: 8pt">// search for ODBXHOSTAPPREGROOT in readdbx.chm for details</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">get</font></span><font color="#000000"> { </font><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> </font><span style="color: "><font color="#a31515">@&quot;ObjectDBX\R18.1&quot;</font></span><font color="#000000">; } </font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160; }</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">override</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">string</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">CompanyName</font></span><font color="#000000"> </font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160; { </font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">get</font></span><font color="#000000"> { </font><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> </font><span style="color: "><font color="#a31515">@&quot;FentonCAD&quot;</font></span><font color="#000000">; } </font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160; }</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">override</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">string</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">Product</font></span><font color="#000000"> </font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160; { </font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">get</font></span><font color="#000000"> { </font><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> </font><span style="color: "><font color="#a31515">@&quot;DWGMoneyMaker&quot;</font></span><font color="#000000">; } </font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160; }</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">override</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">string</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">FindFile</font></span><font color="#000000">(</font><span style="color: "><font color="#0000ff">string</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">fileName</font></span><font color="#000000">, </font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">Database</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">database</font></span><font color="#000000">, </font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">FindFileHint</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">hint</font></span><font color="#000000">)</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160; {</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">fileName</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Contains</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;.&quot;</font></span><font color="#000000">) == </font><span style="color: "><font color="#0000ff">false</font></span><font color="#000000">)</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;&#0160;&#0160; {</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">string</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">extension</font></span><font color="#000000"> = </font><span style="color: "><font color="#a31515">&quot;&quot;</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">switch</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">hint</font></span><font color="#000000">)</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; {</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">case</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">FindFileHint</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Default</font></span><font color="#000000">:</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">break</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">case</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">FindFileHint</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">FontFile</font></span><font color="#000000">:</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">break</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">case</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">FindFileHint</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">CompiledShapeFile</font></span><font color="#000000">:</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">extension</font></span><font color="#000000"> = </font><span style="color: "><font color="#a31515">&quot;.shx&quot;</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">break</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">case</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">FindFileHint</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">TrueTypeFontFile</font></span><font color="#000000">:</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">extension</font></span><font color="#000000"> = </font><span style="color: "><font color="#a31515">&quot;.ttf&quot;</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">break</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">case</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">FindFileHint</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">EmbeddedImageFile</font></span><font color="#000000">:</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">break</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">case</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">FindFileHint</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">XRefDrawing</font></span><font color="#000000">:</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">extension</font></span><font color="#000000"> = </font><span style="color: "><font color="#a31515">&quot;.dwg&quot;</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">break</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">case</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">FindFileHint</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">PatternFile</font></span><font color="#000000">:</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">break</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">case</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">FindFileHint</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">ArxApplication</font></span><font color="#000000">:</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">extension</font></span><font color="#000000"> = </font><span style="color: "><font color="#a31515">&quot;.dbx&quot;</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">break</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">case</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">FindFileHint</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">FontMapFile</font></span><font color="#000000">:</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">extension</font></span><font color="#000000"> = </font><span style="color: "><font color="#a31515">&quot;.fmp&quot;</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">break</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">case</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">FindFileHint</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">UnderlayFile</font></span><font color="#000000">:</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">break</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">default</font></span><font color="#000000">:</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">break</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; }</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">extension</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Length</font></span><font color="#000000"> == 0)</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; {</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">MessageBox</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Show</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;Need to handle this.&quot;</font></span><font color="#000000">);</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; }</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">fileName</font></span><font color="#000000"> += </font><span style="color: "><font color="#010001">extension</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;&#0160;&#0160; }</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">SearchPath</font></span><font color="#000000">(</font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">FileInfo</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">fileName</font></span><font color="#000000">));</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160; }</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">private</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">string</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">SearchPath</font></span><font color="#000000">(</font><span style="color: "><font color="#2b91af">FileInfo</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">fileName</font></span><font color="#000000">)</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160; {</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">fileName</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Exists</font></span><font color="#000000"> == </font><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">)</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">fileName</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">FullName</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><span style="color: "><font color="#008000" style="font-size: 8pt">// get our RealDWG application folder to check there</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">DirectoryInfo</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">appFolder</font></span><font color="#000000"> =</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">DirectoryInfo</font></span><font color="#000000">(</font><span style="color: "><font color="#2b91af">Path</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">GetDirectoryName</font></span><font color="#000000">(</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">System</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Reflection</font></span><font color="#000000">.</font><span style="color: "><font color="#2b91af">Assembly</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">GetExecutingAssembly</font></span><font color="#000000">().</font><span style="color: "><font color="#010001">Location</font></span><font color="#000000">));</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">fileName</font></span><font color="#000000"> = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">FileInfo</font></span><font color="#000000">(</font><span style="color: "><font color="#2b91af">Path</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Combine</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">appFolder</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">FullName</font></span><font color="#000000">, </font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">fileName</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Name</font></span><font color="#000000">));</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">fileName</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Exists</font></span><font color="#000000"> == </font><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">)</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;&#0160;&#0160; {</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">fileName</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">FullName</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;&#0160;&#0160; }</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><span style="color: "><font color="#008000" style="font-size: 8pt">// check the Autodesk shared</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">DirectoryInfo</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">adeskSharedFolder</font></span><font color="#000000"> =</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">DirectoryInfo</font></span><font color="#000000">(</font><span style="color: "><font color="#2b91af">Path</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Combine</font></span><font color="#000000">(</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">Environment</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">GetEnvironmentVariable</font></span><font color="#000000">(</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#a31515">&quot;ProgramFiles&quot;</font></span><font color="#000000">), </font><span style="color: "><font color="#a31515">@&quot;Common Files\Autodesk Shared&quot;</font></span><font color="#000000">));</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">fileName</font></span><font color="#000000"> = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">FileInfo</font></span><font color="#000000">(</font><span style="color: "><font color="#2b91af">Path</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Combine</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">adeskSharedFolder</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">FullName</font></span><font color="#000000">, </font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">fileName</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Name</font></span><font color="#000000">));</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">fileName</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Exists</font></span><font color="#000000"> == </font><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">)</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;&#0160;&#0160; {</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">fileName</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">FullName</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;&#0160;&#0160; }</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><span style="color: "><font color="#008000" style="font-size: 8pt">// check our fonts folder</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">DirectoryInfo</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">fontsFolder</font></span><font color="#000000"> = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">DirectoryInfo</font></span><font color="#000000">(</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">Path</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Combine</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">appFolder</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">FullName</font></span><font color="#000000">, </font><span style="color: "><font color="#a31515">&quot;Fonts&quot;</font></span><font color="#000000">));</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">fileName</font></span><font color="#000000"> = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">FileInfo</font></span><font color="#000000">(</font><span style="color: "><font color="#2b91af">Path</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Combine</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">fontsFolder</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">FullName</font></span><font color="#000000">, </font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">fileName</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Name</font></span><font color="#000000">));</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">fileName</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Exists</font></span><font color="#000000"> == </font><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">)</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;&#0160;&#0160; {</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">fileName</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">FullName</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;&#0160;&#0160; }</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><span style="color: "><font color="#008000" style="font-size: 8pt">// check the system fonts folder</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">DirectoryInfo</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">systemFontsFolder</font></span><font color="#000000"> =</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">DirectoryInfo</font></span><font color="#000000">(</font><span style="color: "><font color="#2b91af">Path</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Combine</font></span><font color="#000000">(</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">Environment</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">GetEnvironmentVariable</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;SystemRoot&quot;</font></span><font color="#000000">), </font><span style="color: "><font color="#a31515">&quot;Fonts&quot;</font></span><font color="#000000">));</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">fileName</font></span><font color="#000000"> = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">FileInfo</font></span><font color="#000000">(</font><span style="color: "><font color="#2b91af">Path</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Combine</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">systemFontsFolder</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">FullName</font></span><font color="#000000">, </font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">fileName</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Name</font></span><font color="#000000">));</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">fileName</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Exists</font></span><font color="#000000"> == </font><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">)</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;&#0160;&#0160; {</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">fileName</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">FullName</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;&#0160;&#0160; }</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><span style="color: "><font color="#008000" style="font-size: 8pt">// search the ACAD Support path system var, in case it&#39;s setup</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">string</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">acadEnv</font></span><font color="#000000"> = </font><span style="color: "><font color="#2b91af">Environment</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">GetEnvironmentVariable</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;ACAD&quot;</font></span><font color="#000000">);</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><span style="color: "><font color="#008000" style="font-size: 8pt">// if valid</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#2b91af">String</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">IsNullOrEmpty</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">acadEnv</font></span><font color="#000000">) == </font><span style="color: "><font color="#0000ff">false</font></span><font color="#000000">)</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;&#0160;&#0160; {</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">fileName</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">ScanEnvPath</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">acadEnv</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">fileName</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Name</font></span><font color="#000000">);</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">fileName</font></span><font color="#000000"> != </font><span style="color: "><font color="#0000ff">null</font></span><font color="#000000"> &amp;&amp; </font><span style="color: "><font color="#010001">fileName</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Exists</font></span><font color="#000000"> == </font><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">)</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; {</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">fileName</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">FullName</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; }</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;&#0160;&#0160; }</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><span style="color: "><font color="#008000" style="font-size: 8pt">// try searching the DOS PATH </font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">string</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">pathEnv</font></span><font color="#000000"> = </font><span style="color: "><font color="#2b91af">Environment</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">GetEnvironmentVariable</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;PATH&quot;</font></span><font color="#000000">);</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><span style="color: "><font color="#008000" style="font-size: 8pt">// if valid</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#2b91af">String</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">IsNullOrEmpty</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">pathEnv</font></span><font color="#000000">) == </font><span style="color: "><font color="#0000ff">false</font></span><font color="#000000">)</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;&#0160;&#0160; {</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">fileName</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">ScanEnvPath</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">pathEnv</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">fileName</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Name</font></span><font color="#000000">);</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">fileName</font></span><font color="#000000"> != </font><span style="color: "><font color="#0000ff">null</font></span><font color="#000000"> &amp;&amp; </font><span style="color: "><font color="#010001">fileName</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Exists</font></span><font color="#000000"> == </font><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">)</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; {</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">fileName</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">FullName</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; }</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;&#0160;&#0160; }</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> </font><span style="color: "><font color="#a31515">&quot;&quot;</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160; }</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">private</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">FileInfo</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">ScanEnvPath</font></span><font color="#000000">(</font><span style="color: "><font color="#0000ff">string</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">envVariableValue</font></span><font color="#000000">, </font><span style="color: "><font color="#0000ff">string</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">fileName</font></span><font color="#000000">)</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160; {</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><span style="color: "><font color="#008000" style="font-size: 8pt">// extract each path and loop them</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">string</font></span><font color="#000000">[] </font><span style="color: "><font color="#010001">paths</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">envVariableValue</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Split</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&#39;;&#39;</font></span><font color="#000000">);</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">foreach</font></span><font color="#000000"> (</font><span style="color: "><font color="#0000ff">string</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">path</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">in</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">paths</font></span><font color="#000000">)</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;&#0160;&#0160; {</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><span style="color: "><font color="#0000ff" style="font-size: 8pt">try</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; {</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">DirectoryInfo</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">dirInfo</font></span><font color="#000000"> = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">DirectoryInfo</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">path</font></span><font color="#000000">);</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><span style="color: "><font color="#008000" style="font-size: 8pt">// if it exists</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">dirInfo</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Exists</font></span><font color="#000000"> == </font><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">)</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">FileInfo</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">newFileName</font></span><font color="#000000"> = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">FileInfo</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">dirInfo</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">FullName</font></span><font color="#000000"> + </font><span style="color: "><font color="#010001">fileName</font></span><font color="#000000">);</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">newFileName</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Exists</font></span><font color="#000000"> == </font><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">)</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">newFileName</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; }</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><span style="color: "><font color="#0000ff" style="font-size: 8pt">catch</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; {</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; }</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;&#0160;&#0160; }</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">null</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160; }</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;</font></font></p>      <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">&#0160; #region</font></font></span><font color="#000000" style="font-size: 8pt"> GetRemoteFile for Urls inside a dwg file</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160; [</font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">StructLayout</font></span><font color="#000000">(</font><span style="color: "><font color="#2b91af">LayoutKind</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Sequential</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">CharSet</font></span><font color="#000000"> = </font><span style="color: "><font color="#2b91af">CharSet</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Auto</font></span><font color="#000000">)]</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">private</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">struct</font></span><font color="#000000"> </font></font><span style="color: "><font color="#2b91af" style="font-size: 8pt">internet_cache_entry_info</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160; {</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">int</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">dwstructsize</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">IntPtr</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">lpszsourceurlname</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">IntPtr</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">lpszlocalfilename</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">int</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">cacheentrytype</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">int</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">dwusecount</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">int</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">dwhitrate</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">int</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">dwsizelow</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">int</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">dwsizehigh</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">System</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Runtime</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">InteropServices</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">ComTypes</font></span><font color="#000000">.</font><span style="color: "><font color="#2b91af">FILETIME</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">lastmodifiedtime</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">System</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Runtime</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">InteropServices</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">ComTypes</font></span><font color="#000000">.</font><span style="color: "><font color="#2b91af">FILETIME</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">expiretime</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">System</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Runtime</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">InteropServices</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">ComTypes</font></span><font color="#000000">.</font><span style="color: "><font color="#2b91af">FILETIME</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">lastaccesstime</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">System</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Runtime</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">InteropServices</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">ComTypes</font></span><font color="#000000">.</font><span style="color: "><font color="#2b91af">FILETIME</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">lastsynctime</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">IntPtr</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">lpheaderinfo</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">int</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">dwheaderinfosize</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">IntPtr</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">lpszfileextension</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">int</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">dwexemptdelta</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160; }</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">private</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">static</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">List</font></span><font color="#000000">&lt;</font><span style="color: "><font color="#010001">internet_cache_entry_info</font></span><font color="#000000">&gt; </font><span style="color: "><font color="#010001">_remoteFiles</font></span><font color="#000000"> = </font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">List</font></span><font color="#000000">&lt;</font><span style="color: "><font color="#010001">internet_cache_entry_info</font></span><font color="#000000">&gt;();</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160; [</font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">DllImport</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;wininet.dll&quot;</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">SetLastError</font></span><font color="#000000"> = </font><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">CharSet</font></span><font color="#000000"> = </font><span style="color: "><font color="#2b91af">CharSet</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Auto</font></span><font color="#000000">)]</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">private</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">static</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">extern</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">IntPtr</font></span><font color="#000000"> </font></font><span style="color: "><font color="#010001" style="font-size: 8pt">RetrieveUrlCacheEntryStream</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; ([</font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">MarshalAs</font></span><font color="#000000">(</font><span style="color: "><font color="#2b91af">UnmanagedType</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">LPTStr</font></span><font color="#000000">)]&#0160;&#0160; </font><span style="color: "><font color="#0000ff">string</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">lpszUrlName</font></span><font color="#000000">,</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">IntPtr</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">lpcacheentryinfo</font></span><font color="#000000">,</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">ref</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">uint</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">lpcbCacheEntryInfo</font></span><font color="#000000">,</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; [</font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">MarshalAs</font></span><font color="#000000">(</font><span style="color: "><font color="#2b91af">UnmanagedType</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Bool</font></span><font color="#000000">)] </font><span style="color: "><font color="#0000ff">bool</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">fRandomRead</font></span><font color="#000000">,</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">uint</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">dwReserved</font></span><font color="#000000">);</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160; [</font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">DllImport</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;wininet.dll&quot;</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">CharSet</font></span><font color="#000000"> = </font><span style="color: "><font color="#2b91af">CharSet</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Auto</font></span><font color="#000000">)]</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">private</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">static</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">extern</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">IntPtr</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">ReadUrlCacheEntryStream</font></span><font color="#000000">(</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">IntPtr</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">hUrlCacheStream</font></span><font color="#000000">, </font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">UInt32</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">dwLocation</font></span><font color="#000000">, </font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">IntPtr</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">lpBuffer</font></span><font color="#000000">, </font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">out</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">UInt32</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">lpdwLen</font></span><font color="#000000">, </font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">UInt32</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">dwReserved</font></span><font color="#000000">);</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160; [</font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">DllImport</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;wininet.dll&quot;</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">CharSet</font></span><font color="#000000"> = </font><span style="color: "><font color="#2b91af">CharSet</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Auto</font></span><font color="#000000">)]</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">private</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">static</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">extern</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">IntPtr</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">FindFirstUrlCacheEntry</font></span><font color="#000000">(</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; [</font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">MarshalAs</font></span><font color="#000000">(</font><span style="color: "><font color="#2b91af">UnmanagedType</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">LPTStr</font></span><font color="#000000">)]</font><span style="color: "><font color="#0000ff">string</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">urlsearchpattern</font></span><font color="#000000">, </font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">IntPtr</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">lpfirstcacheentryinfo</font></span><font color="#000000">, </font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">ref</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">int</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">lpdwfirstcacheentryinfobuffersize</font></span><font color="#000000">);</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160; [</font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">DllImport</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;wininet.dll&quot;</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">SetLastError</font></span><font color="#000000"> = </font><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">CharSet</font></span><font color="#000000"> = </font><span style="color: "><font color="#2b91af">CharSet</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Auto</font></span><font color="#000000">)]</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">private</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">static</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">extern</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">bool</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">GetUrlCacheEntryInfo</font></span><font color="#000000">(</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; [</font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">MarshalAs</font></span><font color="#000000">(</font><span style="color: "><font color="#2b91af">UnmanagedType</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">LPTStr</font></span><font color="#000000">)] </font><span style="color: "><font color="#0000ff">string</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">lpszurlname</font></span><font color="#000000">, </font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">IntPtr</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">lpcacheentryinfo</font></span><font color="#000000">, </font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">ref</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">int</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">lpdwcacheentryinfobuffersize</font></span><font color="#000000">);</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">override</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">string</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">GetRemoteFile</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">Uri</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">url</font></span><font color="#000000">, </font><span style="color: "><font color="#0000ff">bool</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">ignoreCache</font></span><font color="#000000">)</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160; {</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">int</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">nneeded</font></span><font color="#000000"> = 0, </font><span style="color: "><font color="#010001">nbufsize</font></span><font color="#000000"> = 0;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">IntPtr</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">buf</font></span><font color="#000000"> = </font><span style="color: "><font color="#2b91af">IntPtr</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Zero</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">FindFirstUrlCacheEntry</font></span><font color="#000000">(</font><span style="color: "><font color="#0000ff">null</font></span><font color="#000000">, </font><span style="color: "><font color="#2b91af">IntPtr</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Zero</font></span><font color="#000000">, </font><span style="color: "><font color="#0000ff">ref</font></span><font color="#000000">&#0160;&#0160; </font><span style="color: "><font color="#010001">nneeded</font></span><font color="#000000">);</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">nbufsize</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">nneeded</font></span><font color="#000000">; </font><span style="color: "><font color="#010001">buf</font></span><font color="#000000"> = </font><span style="color: "><font color="#2b91af">Marshal</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">AllocHGlobal</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">nbufsize</font></span><font color="#000000">);</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">internet_cache_entry_info</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">cacheitem</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">GetUrlCacheEntryInfo</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">url</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">AbsoluteUri</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">buf</font></span><font color="#000000">, </font><span style="color: "><font color="#0000ff">ref</font></span><font color="#000000">&#0160; </font><span style="color: "><font color="#010001">nneeded</font></span><font color="#000000">);</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">cacheitem</font></span><font color="#000000"> = (</font><span style="color: "><font color="#010001">internet_cache_entry_info</font></span><font color="#000000">)</font><span style="color: "><font color="#2b91af">Marshal</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">PtrToStructure</font></span><font color="#000000">(</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">buf</font></span><font color="#000000">, </font><span style="color: "><font color="#0000ff">typeof</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">internet_cache_entry_info</font></span><font color="#000000">));</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">string</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">res</font></span><font color="#000000"> = </font><span style="color: "><font color="#2b91af">Marshal</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">PtrToStringUni</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">cacheitem</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">lpszlocalfilename</font></span><font color="#000000">);</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">bool</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">found</font></span><font color="#000000"> = </font><span style="color: "><font color="#0000ff">false</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><span style="color: "><font color="#008000" style="font-size: 8pt">// now add it to the list of remote files, but make sure there are no duplicates</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">for</font></span><font color="#000000"> (</font><span style="color: "><font color="#0000ff">int</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">i</font></span><font color="#000000"> = 0; </font><span style="color: "><font color="#010001">i</font></span><font color="#000000"> &lt; </font><span style="color: "><font color="#010001">_remoteFiles</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Count</font></span><font color="#000000">; ++</font><span style="color: "><font color="#010001">i</font></span><font color="#000000">)</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;&#0160;&#0160; {</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#0000ff">string</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Compare</font></span><font color="#000000">(</font><span style="color: "><font color="#2b91af">Marshal</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">PtrToStringUni</font></span><font color="#000000">(</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">_remoteFiles</font></span><font color="#000000">[</font><span style="color: "><font color="#010001">i</font></span><font color="#000000">].</font><span style="color: "><font color="#010001">lpszsourceurlname</font></span><font color="#000000">), </font><span style="color: "><font color="#010001">url</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">AbsoluteUri</font></span><font color="#000000">, </font><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">) == 0)</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; {</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">_remoteFiles</font></span><font color="#000000">[</font><span style="color: "><font color="#010001">i</font></span><font color="#000000">] = </font><span style="color: "><font color="#010001">cacheitem</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">found</font></span><font color="#000000"> = </font><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">break</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; }</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;&#0160;&#0160; }</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><span style="color: "><font color="#008000" style="font-size: 8pt">// if we didn&#39;t find a duplicate, then add it</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (!</font><span style="color: "><font color="#010001">found</font></span><font color="#000000">)</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">_remoteFiles</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Add</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">cacheitem</font></span><font color="#000000">);</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><span style="color: "><font color="#008000" style="font-size: 8pt">// Marshal.PtrToStringAnsi&#0160;&#0160; </font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">res</font></span><font color="#000000">);</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160; }</font></font></p>      <p style="margin: 0px"><span style="color: "><font face="Consolas"><font color="#0000ff" style="font-size: 8pt">&#0160; #endregion</font></font></span></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">override</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">bool</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">IsUrl</font></span><font color="#000000">(</font><span style="color: "><font color="#0000ff">string</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">filePath</font></span><font color="#000000">)</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160; {</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">Uri</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">IsWellFormedUriString</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">filePath</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">UriKind</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">RelativeOrAbsolute</font></span><font color="#000000">);</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160; }</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">override</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">Uri</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">GetUrl</font></span><font color="#000000">(</font><span style="color: "><font color="#0000ff">string</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">localFile</font></span><font color="#000000">)</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160; {</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">foreach</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">internet_cache_entry_info</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">info</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">in</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">_remoteFiles</font></span><font color="#000000">)</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;&#0160;&#0160; {</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#0000ff">string</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Compare</font></span><font color="#000000">(</font><span style="color: "><font color="#2b91af">Marshal</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">PtrToStringUni</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">info</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">lpszlocalfilename</font></span><font color="#000000">), </font><span style="color: "><font color="#010001">localFile</font></span><font color="#000000">, </font><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">) == 0)</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">Uri</font></span><font color="#000000">(</font><span style="color: "><font color="#2b91af">Marshal</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">PtrToStringUni</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">info</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">lpszsourceurlname</font></span><font color="#000000">));</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;&#0160;&#0160; }</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">Uri</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;&quot;</font></span><font color="#000000">);</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160; }</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">override</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">string</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">GetPassword</font></span><font color="#000000">(</font><span style="color: "><font color="#0000ff">string</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">dwgName</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">PasswordOptions</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">options</font></span><font color="#000000">)</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160; {</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">PasswordForm</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">form</font></span><font color="#000000"> = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">PasswordForm</font></span><font color="#000000">();</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">form</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">drawingPath</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Text</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">dwgName</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">form</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">ShowDialog</font></span><font color="#000000">();</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#0160;&#0160;&#0160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">form</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">textBox1</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Text</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160; }</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">}</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000" style="font-size: 8pt">&#0160;</font></font></p>   </div>    <p style="margin: 0px"><span style="font-family: consolas"><span style="color: #000000">&#0160;</span></span></p> </div>
