---
layout: "post"
title: "Custom code snippet on Visual Studio"
date: "2015-05-07 16:51:09"
author: "Augusto Goncalves"
categories:
  - "Augusto Goncalves"
  - "AutoCAD"
original_url: "https://adndevblog.typepad.com/autocad/2015/05/custom-code-snippet-on-visual-studio.html "
typepad_basename: "custom-code-snippet-on-visual-studio"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/augusto-goncalves.html">Augusto Goncalves</a></p>
<p>Today’s post is focused on productivity, an aspect that is sometimes left behind due our intense work load…And I believe that small improvements can make a huge difference on our daily work.</p>
<p>Now the idea is to save us some time typing a new command for AutoCAD, that includes, for instance, database, editor and transaction. Sure you can adjust the code.</p>
<p>How make this work? Simple:</p>
<ol>
<li>Create a .snippet file using any text editor (Notepad can do the trick).</li>
<li>Copy &amp; paste the XML content below</li>
<li>Save at <strong>[My Documents]\Visual Studio 2012\Code Snippets\Visual C#\My Code Snippets\</strong> folder, or other version that you have.</li>
<li>At your Visual Studio code, type <strong>AcadCmd</strong> and press TAB, the code should appear, press TAB again to move between command name and method name, both marked in yellow.</li>
</ol>
<p>Like it? You may adjust to other commands or other pieces that you use repeatedly. Here is the .snippet for <span class="asset  asset-generic at-xid-6a0167607c2431970b01b7c787145a970b img-responsive"><a href="http://adndevblog.typepad.com/files/autocaddbcommand_cs.snippet">download</a>.</span></p>
<pre style="font-size: 13px; font-family: consolas; background: white; color: black;"><span style="color: blue;">&lt;?</span><span style="color: #a31515;">xml</span><span style="color: blue;">&#0160;</span><span style="color: red;">version</span><span style="color: blue;">=</span>&quot;<span style="color: blue;">1.0</span>&quot;<span style="color: blue;">&#0160;</span><span style="color: red;">encoding</span><span style="color: blue;">=</span>&quot;<span style="color: blue;">utf-8</span>&quot;<span style="color: blue;"> ?&gt;</span><br /><span style="color: blue;">&lt;</span><span style="color: #a31515;">CodeSnippets</span><span style="color: blue;">&#0160;</span><span style="color: red;">xmlns</span><span style="color: blue;">=</span>&quot;<span style="color: blue;">http://schemas.microsoft.com/VisualStudio/2008/CodeSnippet</span>&quot;<span style="color: blue;">&gt;</span><br /><span style="color: blue;">&#0160; &lt;</span><span style="color: #a31515;">CodeSnippet</span><span style="color: blue;">&#0160;</span><span style="color: red;">Format</span><span style="color: blue;">=</span>&quot;<span style="color: blue;">1.0.0</span>&quot;<span style="color: blue;">&gt;</span><br /><span style="color: blue;">&#0160;&#0160;&#0160; &lt;</span><span style="color: #a31515;">Header</span><span style="color: blue;">&gt;</span><br /><span style="color: blue;">&#0160;&#0160;&#0160;&#0160;&#0160; &lt;</span><span style="color: #a31515;">Title</span><span style="color: blue;">&gt;</span>AutoCAD Command<span style="color: blue;">&lt;/</span><span style="color: #a31515;">Title</span><span style="color: blue;">&gt;</span><br /><span style="color: blue;">&#0160;&#0160;&#0160;&#0160;&#0160; &lt;</span><span style="color: #a31515;">Shortcut</span><span style="color: blue;">&gt;</span>AcadCmd<span style="color: blue;">&lt;/</span><span style="color: #a31515;">Shortcut</span><span style="color: blue;">&gt;</span><br /><span style="color: blue;">&#0160;&#0160;&#0160;&#0160;&#0160; &lt;</span><span style="color: #a31515;">Description</span><span style="color: blue;">&gt;</span>Code snippet for AutoCAD command method with transaction<span style="color: blue;">&lt;/</span><span style="color: #a31515;">Description</span><span style="color: blue;">&gt;</span><br /><span style="color: blue;">&#0160;&#0160;&#0160;&#0160;&#0160; &lt;</span><span style="color: #a31515;">SnippetTypes</span><span style="color: blue;">&gt;</span><br /><span style="color: blue;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &lt;</span><span style="color: #a31515;">SnippetType</span><span style="color: blue;">&gt;</span>Expansion<span style="color: blue;">&lt;/</span><span style="color: #a31515;">SnippetType</span><span style="color: blue;">&gt;</span><br /><span style="color: blue;">&#0160;&#0160;&#0160;&#0160;&#0160; &lt;/</span><span style="color: #a31515;">SnippetTypes</span><span style="color: blue;">&gt;</span><br /><span style="color: blue;">&#0160;&#0160;&#0160; &lt;/</span><span style="color: #a31515;">Header</span><span style="color: blue;">&gt;</span><br /><span style="color: blue;">&#0160;&#0160;&#0160; &lt;</span><span style="color: #a31515;">Snippet</span><span style="color: blue;">&gt;</span><br /><span style="color: blue;">&#0160;&#0160;&#0160;&#0160;&#0160; &lt;</span><span style="color: #a31515;">Declarations</span><span style="color: blue;">&gt;</span><br /><span style="color: blue;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &lt;</span><span style="color: #a31515;">Literal</span><span style="color: blue;">&gt;</span><br /><span style="color: blue;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &lt;</span><span style="color: #a31515;">ID</span><span style="color: blue;">&gt;</span>COMMAND_NAME<span style="color: blue;">&lt;/</span><span style="color: #a31515;">ID</span><span style="color: blue;">&gt;</span><br /><span style="color: blue;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &lt;</span><span style="color: #a31515;">ToolTip</span><span style="color: blue;">&gt;</span>Replace with the command name<span style="color: blue;">&lt;/</span><span style="color: #a31515;">ToolTip</span><span style="color: blue;">&gt;</span><br /><span style="color: blue;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &lt;</span><span style="color: #a31515;">Default</span><span style="color: blue;">&gt;</span>myCommandName<span style="color: blue;">&lt;/</span><span style="color: #a31515;">Default</span><span style="color: blue;">&gt;</span><br /><span style="color: blue;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &lt;/</span><span style="color: #a31515;">Literal</span><span style="color: blue;">&gt;</span><br /><span style="color: blue;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &lt;</span><span style="color: #a31515;">Object</span><span style="color: blue;">&gt;</span><br /><span style="color: blue;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &lt;</span><span style="color: #a31515;">ID</span><span style="color: blue;">&gt;</span>METHOD_NAME<span style="color: blue;">&lt;/</span><span style="color: #a31515;">ID</span><span style="color: blue;">&gt;</span><br /><span style="color: blue;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &lt;</span><span style="color: #a31515;">ToolTip</span><span style="color: blue;">&gt;</span>Replace with the method name<span style="color: blue;">&lt;/</span><span style="color: #a31515;">ToolTip</span><span style="color: blue;">&gt;</span><br /><span style="color: blue;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &lt;</span><span style="color: #a31515;">Default</span><span style="color: blue;">&gt;</span>myMethodName<span style="color: blue;">&lt;/</span><span style="color: #a31515;">Default</span><span style="color: blue;">&gt;</span><br /><span style="color: blue;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &lt;/</span><span style="color: #a31515;">Object</span><span style="color: blue;">&gt;</span><br /><span style="color: blue;">&#0160;&#0160;&#0160;&#0160;&#0160; &lt;/</span><span style="color: #a31515;">Declarations</span><span style="color: blue;">&gt;</span><br /><span style="color: blue;">&#0160;&#0160;&#0160;&#0160;&#0160; &lt;</span><span style="color: #a31515;">Code</span><span style="color: blue;">&#0160;</span><span style="color: red;">Language</span><span style="color: blue;">=</span>&quot;<span style="color: blue;">CSharp</span>&quot;<span style="color: blue;">&gt;</span><br /><span style="color: blue;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &lt;![CDATA[</span><br /><span style="color: gray;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; [CommandMethod(&quot;$COMMAND_NAME$&quot;)]</span><br /><span style="color: gray;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; public static void $METHOD_NAME$()</span><br /><span style="color: gray;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span><br /><span style="color: gray;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Database db = Application.DocumentManager.MdiActiveDocument.Database;</span><br /><span style="color: gray;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Editor ed = Application.DocumentManager.MdiActiveDocument.Editor;</span><br /><span style="color: gray;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; using (Transaction trans = db.TransactionManager.StartTransaction())</span><br /><span style="color: gray;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; { </span><br /> <br /><span style="color: gray;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span><br /><span style="color: gray;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span><br /><span style="color: gray;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: blue;">]]&gt;</span><br /><span style="color: blue;">&#0160;&#0160;&#0160;&#0160;&#0160; &lt;/</span><span style="color: #a31515;">Code</span><span style="color: blue;">&gt;</span><br /><span style="color: blue;">&#0160;&#0160;&#0160; &lt;/</span><span style="color: #a31515;">Snippet</span><span style="color: blue;">&gt;</span><br /><span style="color: blue;">&#0160; &lt;/</span><span style="color: #a31515;">CodeSnippet</span><span style="color: blue;">&gt;</span><br /><span style="color: blue;">&lt;/</span><span style="color: #a31515;">CodeSnippets</span><span style="color: blue;">&gt;</span></pre>
