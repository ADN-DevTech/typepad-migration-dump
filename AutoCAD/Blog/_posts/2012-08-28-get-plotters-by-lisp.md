---
layout: "post"
title: "Get plotters by LISP"
date: "2012-08-28 03:15:54"
author: "Xiaodong Liang"
categories:
  - "AutoCAD"
  - "LISP"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/autocad/2012/08/get-plotters-by-lisp.html "
typepad_basename: "get-plotters-by-lisp"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>  <p>In order to retrieve the list of configured plotters, you need   <br />to use the ActiveX Interface, which exposes a list of configured plotters. The best way to do this is to use the ActiveLayout Object's etPlotDeviceNames Property.</p>  <p>The following AutoLISP code demonstrates this:</p>  <p><span style="line-height: 120%; font-family: &#39;courier new&#39;, courier; font-size: 8pt"><span style="color: #ff0000">(</span><span style="color: #0000ff">defun</span> C:GetPlotters <span style="color: #ff0000">(</span><span style="color: #0000ff">/</span> acadObject acadDocument activeLayoutObject plotter      <br />PlotterNames<span style="color: #ff0000">)</span>      <br />&#160;<span style="color: #ff0000">(</span><span style="color: #0000ff">vl-load-com</span><span style="color: #ff0000">)</span>      <br />&#160;<span style="color: #ff0000">(</span><span style="color: #0000ff">setq</span> acadObject <span style="color: #ff0000">(</span><span style="color: #0000ff">vlax-get-Acad-object</span><span style="color: #ff0000">)</span><span style="color: #ff0000">)</span>      <br />&#160;<span style="color: #ff0000">(</span><span style="color: #0000ff">setq</span> acadDocument <span style="color: #ff0000">(</span><span style="color: #0000ff">vla-get-ActiveDocument</span> acadObject<span style="color: #ff0000">)</span><span style="color: #ff0000">)</span>      <br />&#160;<span style="color: #ff0000">(</span><span style="color: #0000ff">setq</span> activeLayoutObject <span style="color: #ff0000">(</span><span style="color: #0000ff">vla-Get-ActiveLayout</span> acadDocument<span style="color: #ff0000">)</span><span style="color: #ff0000">)</span>      <br />&#160;<span style="color: #ff0000">(</span><span style="color: #0000ff">vla-RefreshPlotDeviceInfo</span> activeLayoutObject<span style="color: #ff0000">)</span>      <br />&#160;<span style="color: #ff0000">(</span><span style="color: #0000ff">setq</span> PlotterNames <span style="color: #ff0000">(</span><span style="color: #0000ff">vla-GetPlotDeviceNames</span> activeLayoutObject<span style="color: #ff0000">)</span><span style="color: #ff0000">)</span>      <br />&#160;<span style="color: #ff0000">(</span><span style="color: #0000ff">vl-princ-to-string</span>&#160;<span style="color: #ff0000">(</span><span style="color: #0000ff">setq</span> plotters <span style="color: #ff0000">(</span><span style="color: #0000ff">vlax-safearray-</span>&gt;list <span style="color: #ff0000">(</span><span style="color: #0000ff">vlax-variant-value</span>      <br />PlotterNames<span style="color: #ff0000">)</span><span style="color: #ff0000">)</span><span style="color: #ff0000">)</span><span style="color: #ff0000">)</span>      <br />&#160;<span style="color: #ff0000">(</span><span style="color: #0000ff">setq</span> i <span style="color: #008000">0</span><span style="color: #ff0000">)</span>      <br />&#160;<span style="color: #ff0000">(</span>mapcar '<span style="color: #ff0000">(</span>lambda <span style="color: #ff0000">(</span>x<span style="color: #ff0000">)</span>&#160;<span style="color: #ff0000">(</span><span style="color: #0000ff">princ</span>&#160;<span style="color: #ff0000">(</span><span style="color: #0000ff">strcat</span>&#160;<span style="color: #ff00ff">&quot;\nPlotter No: &quot;</span>&#160;<span style="color: #ff0000">(</span><span style="color: #0000ff">itoa</span> i<span style="color: #ff0000">)</span>&#160;<span style="color: #ff00ff">&quot; - Device: &quot;</span>      <br />x<span style="color: #ff0000">)</span><span style="color: #ff0000">)</span>&#160;<span style="color: #ff0000">(</span><span style="color: #0000ff">setq</span> i <span style="color: #ff0000">(</span><span style="color: #0000ff">1+</span> i<span style="color: #ff0000">)</span><span style="color: #ff0000">)</span><span style="color: #ff0000">)</span> plotters<span style="color: #ff0000">)</span>      <br />&#160;<span style="color: #ff0000">(</span><span style="color: #0000ff">princ</span><span style="color: #ff0000">)</span>      <br /><span style="color: #ff0000">)</span></span></p>
