---
layout: "post"
title: "Ensuring that two custom entities are copied together"
date: "2012-05-28 10:58:08"
author: "Adam Nagy"
categories:
  - "Adam Nagy"
  - "AutoCAD"
  - "ObjectARX"
original_url: "https://adndevblog.typepad.com/autocad/2012/05/ensuring-that-two-custom-entities-are-copied-together.html "
typepad_basename: "ensuring-that-two-custom-entities-are-copied-together"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/adam-nagy.html" target="_self">Adam Nagy</a></p>  <p>I have two custom entities: mywall and mydoor, and I would like to make sure that if mywall is copied then mydoor is copied with it when using CTRL+C/CTRL+V.</p>  <p><a name="section2"></a></p>  <p><b>Solution</b></p>  <p>In this case you just need to add an AcDbHardPointerId member to mywall entity, which would reference mydoor:</p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%; color: blue">class</span><span style="line-height: 140%"> DLLIMPEXP MyWall : </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> AcDbEntity </span></p>    <p style="margin: 0px"><span style="line-height: 140%">{</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%">: AcDbHardPointerId m_doorId;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: green">//...</span></p> </div>  <p>You also need to make sure that this id is filed properly both in dwgOutFields and dwgInFields of MyWall.</p>  <div style="font-family: Courier New; font-size: 8pt; color: black; background: white;"> <p style="margin: 0px;"><span style="line-height: 140%;">Acad::ErrorStatus MyWall::dwgOutFields(AcDbDwgFiler *pFiler) </span><span style="color: blue; line-height: 140%;">const</span><span style="line-height: 140%;"> </span></p> <p style="margin: 0px;"><span style="line-height: 140%;">{</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; assertReadEnabled();</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; Acad::ErrorStatus es = AcDbEntity::dwgOutFields(pFiler);</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (es != Acad::eOk)</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">return</span><span style="line-height: 140%;"> (es);</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> ((es =pFiler-&gt;writeUInt32(MyWall::kCurrentVersionNumber)) </span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; != Acad::eOk)</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">return</span><span style="line-height: 140%;"> (es);</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; pFiler-&gt;writeHardPointerId(m_doorId); </span><span style="color: green; line-height: 140%;">// HERE</span></p> <p style="margin: 0px;">&nbsp;</p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: blue; line-height: 140%;">return</span><span style="line-height: 140%;"> (pFiler-&gt;filerStatus());</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">}</span></p> <p style="margin: 0px;">&nbsp;</p> <p style="margin: 0px;"><span style="line-height: 140%;">Acad::ErrorStatus MyWall::dwgInFields(AcDbDwgFiler *pFiler) </span></p> <p style="margin: 0px;"><span style="line-height: 140%;">{</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; assertWriteEnabled();</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; Acad::ErrorStatus es =AcDbEntity::dwgInFields(pFiler);</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (es != Acad::eOk)</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">return</span><span style="line-height: 140%;"> (es);</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; Adesk::UInt32 version = 0;</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> ((es =pFiler-&gt;readUInt32 (&amp;version)) != Acad::eOk)</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">return</span><span style="line-height: 140%;"> (es) ;</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (version &gt; MyWall::kCurrentVersionNumber)</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">return</span><span style="line-height: 140%;"> (Acad::eMakeMeProxy);</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; pFiler-&gt;readHardPointerId(&amp;m_doorId); </span><span style="color: green; line-height: 140%;">// HERE</span></p> <p style="margin: 0px;">&nbsp;</p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: blue; line-height: 140%;">return</span><span style="line-height: 140%;"> (pFiler-&gt;filerStatus());</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">}</span></p> </div>
