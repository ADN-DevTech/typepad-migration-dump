---
layout: "post"
title: "Properties/OPM Window does not work in my OEM product"
date: "2013-02-01 11:41:26"
author: "Fenton Webb"
categories:
  - "2010"
  - "2011"
  - "2012"
  - "2013"
  - "AutoCAD OEM"
  - "Fenton Webb"
original_url: "https://adndevblog.typepad.com/autocad/2013/02/propertiesopm-window-does-not-work-in-my-oem-product.html "
typepad_basename: "propertiesopm-window-does-not-work-in-my-oem-product"
typepad_status: "Publish"
---

<p>by <a href="http://adndevblog.typepad.com/autocad/fenton-webb.html">Fenton Webb</a></p>  <p><b>Issue</b></p>  <p>When I bring up the properties window in my OEM product, it doesn't display the correct information. Why?</p>  <p><a name="section2"></a></p>  <p><b>Solution</b></p>  <p>The most common causes for this are (A) missing type libraries, and (B) incorrect registry information.</p>  <p>If your product doesn't include any type libraries, the properties window will   <br />correctly display the drawing's properties, but will be blank when an entity is    <br />selected. Or it may continue to display the drawing's information when    <br />selecting other entities.</p>  <p>In this case, you should go back to the OEM Make Wizard and the Automation page.   <br />Press the &quot;Generate GUIDs...&quot; button to create new IDs for your product. Now    <br />go to the Build page and build your product again. You can either rebuild the    <br />entire product or you can just rebuild the resources, but make sure that the    <br />&quot;Build typeLibs&quot; option is checked. Once you've created your type libraries,    <br />you should follow the steps in Chapter 5 of the OEM Developer's Guide, in the    <br />section &quot;Testing VBA in your Product.&quot;</p>  <p>If you've generated the GUIDs and created the type libraries for your product   <br />and the properties window is not functioning properly, it's almost certainly a    <br />problem with the registry information. Here are some tips that might help you    <br />track down the problem.</p>  <p>1. Be sure to follow the steps laid out in Chapt. 5 &quot;Testing VBA in your   <br />product&quot; exactly and in order. The order is very important.</p>  <p>2. Step 1 mentions generating CLSIDs (you can't do this until you have built   <br />the project at least once). Then you go back to the automation page and click    <br />the Generate GUIDs button. Then go back to the build page and check &quot;Rebuild    <br />your resources&quot; and &quot;Build typeLibs&quot;. Any time you click Generate GUIDs button    <br />you must rebuild your resources and typeLibs (as well as go through the process    <br />for editing the REG file and registering your CLSIDs). It's an all or nothing    <br />process. Stopping or starting in the middle will definitely cause problems.</p>  <p>3. The first time you launch your product, OEM will automatically create the   <br />registry entries listed in step three all the way up to ...&lt;Install ID&gt;\. It is    <br />a good idea to launch it once so that you don't accidentally make a mistake when    <br />creating the path. In this case just double-check that those registry keys are    <br />there. Another good check is to make sure the &lt;prog&gt;vba.arx app loads with the    <br />ARX command in your stamped product. If these keys are not correct it will give    <br />you an error message. This only has to be done once per product.</p>  <p>4. It should be noted that the heading in the book that says &quot;To register   <br />CLSIDs for your AutoCAD OEM product&quot;, begins with step 1, but you need to have    <br />done everything under &quot;To test VBA in your AutoCAD OEM product&quot; (the previous    <br />heading). </p>  <p>5. In step 1 (for CLSID's) it gives you the syntax for the oemguidremap   <br />command. It may be helpful to create a batch file in the project directory and    <br />put in the complete paths for the files. e.g. (prog name = Test)</p>  <p>oemguidremap c:\aoem2009\oem\Test\Testres2.dll c:\aoem2009\acadaut.reg    <br />c:\aoem2009\projects\Test\Test.reg </p>  <p>Notice that the output reg file goes into the project directory so that it is   <br />not deleted if you do a rebuild all on the project. </p>  <p>6. Be extremely careful about step 2. The steps were laid out specifically to   <br />try to minimize the errors. Especially do not globally replace &quot;AutoCAD&quot; or    <br />&quot;ACAD&quot; with anything. Follow the steps exactly. It may be a good idea to go to    <br />the &quot;Product Information&quot; page of the wizard and copy and paste &quot;Product name&quot;    <br />so that you don't make a typo. It also helps to refer to this because it is    <br />easy to confuse the product name with the program name.</p>  <p>7. Be careful about using notepad for find and replace. It has a tendency to   <br />truncate long strings. Especially if you have a long product path.</p>  <p>8. When doing the find and replace for &lt;acad path&gt; do not include the trailing   <br />backslash. (i.e. the path should be: &quot;R:\coreACAD\ntexe\debug&quot;) Obviously this    <br />goes for the replacement string as well. (i.e. your path should look something    <br />like: &quot;c:\AOEM2009\oem\Test&quot;)</p>  <p>9. As a general rule, it works much better if you don't have any spaces in the   <br />product name. But the documentation explains when you can and cannot have    <br />spaces.</p>  <p>10. There are only two instances of acad.tlb and one instance of acad.exe. So   <br />you don't need to globally replace acad with &lt;prog name&gt;. </p>  <p>11. As a sanity check, I usually go to the automation page of the make wizard,   <br />click on a CLSID like the one for IDS_AoemLine, highlight it and copy it to the    <br />clipboard. Then I go to the reg file, perform a find and then paste in the    <br />CLSID for the search string. The find should come up with the CLSID for    <br />&quot;&lt;product name&gt; Line&quot;. If it doesn't, your reg file was not been created    <br />properly. </p>  <p>12. Don't forget to double-click on the reg file to post the changes to the   <br />registry! This should give you a message that it succeeded. When you do get    <br />the CLSIDs registered correctly, keep the reg file. It will be a good reference    <br />when creating the install program.</p>
