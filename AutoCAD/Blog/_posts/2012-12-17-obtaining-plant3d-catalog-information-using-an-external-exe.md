---
layout: "post"
title: "Obtaining Plant3d Catalog information using an external EXE"
date: "2012-12-17 09:40:41"
author: "Fenton Webb"
categories:
  - ".NET"
  - "2013"
  - "Fenton Webb"
  - "Plant3D"
original_url: "https://adndevblog.typepad.com/autocad/2012/12/obtaining-plant3d-catalog-information-using-an-external-exe.html "
typepad_basename: "obtaining-plant3d-catalog-information-using-an-external-exe"
typepad_status: "Publish"
---

<p>by <a href="http://adndevblog.typepad.com/autocad/fenton-webb.html">Fenton Webb</a></p>  <p>The Plant3d API is actually accessible from your own exe. If you create a simple .NET exe, reference these DLL references…</p>  <ul>   <li>PnIDMgd.dll</li>    <li>PnP3dPartsRepository.dll</li>    <li>PnPCommonMgd.dll</li>    <li>PnPDataObjects.dll</li>    <li>PnPSQLiteEngine.dll</li> </ul>  <p>And add this code to your Main()</p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">class</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#2b91af">Program</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">{</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">static</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">Main</font></span><font color="#000000">(</font><span style="color: "><font color="#0000ff">string</font></span><font color="#000000">[] </font><span style="color: "><font color="#010001">args</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160; {</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// open the catalog</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">PipePartCatalog</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">repository</font></span><font color="#000000"> = </font><span style="color: "><font color="#2b91af">PipePartCatalog</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">OpenCatalog</font></span><font color="#000000">(</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#a31515">&quot;C:\\AutoCAD Plant 3D 2013 Content\\CPak ASME\\ASME Pipes and Fittings Catalog.pcat&quot;</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// return all parts that meet this search criteria condition </font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// &quot;EndType='PL' AND CompatibleStandard = 'ASME B36.19'&quot;</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">PartQueryResults</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">result</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">repository</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">SelectParts</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;PIPE&quot;</font></span><font color="#000000">, </font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#a31515">&quot;EndType='PL' AND CompatibleStandard = 'ASME B36.19'&quot;</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">Part</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">part</font></span><font color="#000000"> = </font><span style="color: "><font color="#0000ff">null</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// now list them out</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">while</font></span><font color="#000000"> ((</font><span style="color: "><font color="#010001">part</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">result</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">NextPart</font></span><font color="#000000">()) != </font><span style="color: "><font color="#0000ff">null</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">Console</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">WriteLine</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;Diameter = &quot;</font></span><font color="#000000"> + </font><span style="color: "><font color="#010001">part</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">NominalDiameter</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// wait for acceptance from user</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">Console</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">ReadKey</font></span><font color="#000000">();</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160; } </font></font></p>    <p style="margin: 0px"><font color="#000000" face="Consolas">}</font></p> </div>  <p>Then if you run the program from DOS, you get…</p>  <p>&#160;</p>  <p>Diameter = 0.125in   <br />Diameter = 0.25in    <br />Diameter = 0.375in    <br />Diameter = 0.5in    <br />Diameter = 0.75in    <br />Diameter = 1in    <br />Diameter = 1.25in    <br />Diameter = 1.5in    <br />Diameter = 2in    <br />Diameter = 2.5in    <br />Diameter = 3in    <br />Diameter = 3.5in    <br />Diameter = 4in    <br />Diameter = 5in    <br />Diameter = 6in    <br />Diameter = 8in    <br />Diameter = 10in    <br />Diameter = 12in    <br />Diameter = 14in    <br />Diameter = 16in    <br />Diameter = 18in    <br />Diameter = 20in    <br />Diameter = 22in    <br />Diameter = 24in    <br />Diameter = 26in    <br />Diameter = 28in    <br />Diameter = 30in    <br />Diameter = 32in    <br />Diameter = 34in    <br />Diameter = 36in    <br />Diameter = 38in    <br />Diameter = 40in    <br />Diameter = 42in    <br />Diameter = 44in    <br />Diameter = 46in    <br />Diameter = 48in    <br />Diameter = 50in    <br />Diameter = 52in    <br />Diameter = 54in    <br />Diameter = 56in    <br />Diameter = 58in    <br />Diameter = 60in</p>
