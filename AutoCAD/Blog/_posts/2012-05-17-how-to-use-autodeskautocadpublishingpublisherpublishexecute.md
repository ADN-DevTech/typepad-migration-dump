---
layout: "post"
title: "How to use Autodesk.AutoCAD. Publishing.Publisher.PublishExecute?"
date: "2012-05-17 13:56:44"
author: "Philippe Leefsma"
categories:
  - ".NET"
  - "AutoCAD"
  - "Philippe Leefsma"
original_url: "https://adndevblog.typepad.com/autocad/2012/05/how-to-use-autodeskautocadpublishingpublisherpublishexecute.html "
typepad_basename: "how-to-use-autodeskautocadpublishingpublisherpublishexecute"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/philippe-leefsma.html" target="_self">Philippe Leefsma</a>&nbsp; <p>The following C# sample shows you how to publish to DWF all layouts in a drawing. It illustrates the use of Autodesk.AutoCAD.Publishing.Publisher.PublishExecute API.<pre></pre>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; color: "><font face="Consolas"><font style="font-size: 9.5pt" color="#008000">//////////////////////////////////////////////////////////////////////////</font></font></span><span style="font-family: "></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; color: "><font face="Consolas"><font style="font-size: 9.5pt" color="#008000">//Use: This command will publish all the layouts in the current </font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; color: "><font face="Consolas"><font style="font-size: 9.5pt" color="#008000">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; drawing </font></font></span><span style="font-family: ; color: "><font face="Consolas"><font style="font-size: 9.5pt" color="#008000">to a multi sheet dwf. </font></font></span><span style="font-family: "></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; color: "><font face="Consolas"><font style="font-size: 9.5pt" color="#008000">//////////////////////////////////////////////////////////////////////////</font></font></span><span style="font-family: "></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><font style="font-size: 9.5pt">[</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">CommandMethod</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">"PublishAllLayouts"</font></span><font color="#000000">)]</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><font style="font-size: 9.5pt">static</font></font></span><span style="font-family: "><font style="font-size: 9.5pt"><font color="#000000"> </font><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000"> PublishAllLayouts()</font></font></span></font></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-ansi-language: fr" lang="FR"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">{</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-ansi-language: fr" lang="FR"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">Document</font></span><font color="#000000"> doc = </font><span style="color: "><font color="#2b91af">Application</font></span><font color="#000000">.DocumentManager.MdiActiveDocument;</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; mso-ansi-language: fr" lang="FR"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></font></span></span><font style="font-size: 9.5pt"><span style="font-family: ; color: "><font color="#2b91af">Database</font></span></font><span style="font-family: "><font style="font-size: 9.5pt" color="#000000"> db = doc.Database;</font></span></font></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">Editor</font></span><font color="#000000"> ed = doc.Editor;</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></font></span><span style="color: "><font style="font-size: 9.5pt" color="#008000">//put the plot in foreground</font></span></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">short</font></span><font color="#000000"> bgPlot = </font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt"><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (</font><span style="color: "><font color="#0000ff">short</font></span><font color="#000000">)</font><span style="color: "><font color="#2b91af">Application</font></span><font color="#000000">.GetSystemVariable(</font><span style="color: "><font color="#a31515">"BACKGROUNDPLOT"</font></span><font color="#000000">);</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font color="#000000" face="Consolas"></font></span>&nbsp;</p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">Application</font></span><font color="#000000">.SetSystemVariable(</font><span style="color: "><font color="#a31515">"BACKGROUNDPLOT"</font></span><font color="#000000">, 0);</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></font></span><span style="color: "><font style="font-size: 9.5pt" color="#008000">//get the layout ObjectId List</font></span></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">System.Collections.Generic.</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">List</font></span><font color="#000000">&lt;</font><span style="color: "><font color="#2b91af">ObjectId</font></span><font color="#000000">&gt; layoutIds = </font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">GetLayoutIds(db);</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">string</font></span><font color="#000000"> dwgFileName = </font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt"><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (</font><span style="color: "><font color="#0000ff">string</font></span><font color="#000000">)</font><span style="color: "><font color="#2b91af">Application</font></span><font color="#000000">.GetSystemVariable(</font><span style="color: "><font color="#a31515">"DWGNAME"</font></span><font color="#000000">);</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font color="#000000" face="Consolas"></font></span>&nbsp;</p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">string</font></span><font color="#000000"> dwgPath = Â¨</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt"><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (</font><span style="color: "><font color="#0000ff">string</font></span><font color="#000000">)</font><span style="color: "><font color="#2b91af">Application</font></span><font color="#000000">.GetSystemVariable(</font><span style="color: "><font color="#a31515">"DWGPREFIX"</font></span><font color="#000000">);</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">using</font></span><font color="#000000"> (</font><span style="color: "><font color="#2b91af">Transaction</font></span><font color="#000000"> Tx = db.TransactionManager.StartTransaction())</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">{</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">DsdEntryCollection</font></span><font color="#000000"> collection = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">DsdEntryCollection</font></span><font color="#000000">();</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">foreach</font></span><font color="#000000"> (</font><span style="color: "><font color="#2b91af">ObjectId</font></span><font color="#000000"> layoutId </font><span style="color: "><font color="#0000ff">in</font></span><font color="#000000"> layoutIds)</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">{</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp; </font></span><font style="font-size: 9.5pt"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">Layout</font></span><font color="#000000"> layout = Tx.GetObject(layoutId, </font><span style="color: "><font color="#2b91af">OpenMode</font></span><font color="#000000">.ForRead) </font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">as</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">Layout</font></span><font color="#000000">;</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">DsdEntry</font></span><font color="#000000"> entry = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">DsdEntry</font></span><font color="#000000">();</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><span style="mso-spacerun: yes"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">entry.DwgName = dwgPath + dwgFileName;</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">entry.Layout = layout.LayoutName;</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>entry.Title = </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#a31515">"Layout_"</font></span><font color="#000000"> + layout.LayoutName;</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">entry.NpsSourceDwg = entry.DwgName;</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">entry.Nps = </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#a31515">"Setup1"</font></span><font color="#000000">;</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">collection.Add(entry);</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">dwgFileName = dwgFileName.Substring(</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><font color="#000000"><span style="font-family: ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family: "><font style="font-size: 9.5pt">0, dwgFileName.Length - 4);</font></span></font></font></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp; </font></span><font style="font-size: 9.5pt"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">DsdData</font></span><font color="#000000"> dsdData = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">DsdData</font></span><font color="#000000">();</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">dsdData.SheetType = </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">SheetType</font></span><font color="#000000">.MultiDwf; </font></font><span style="color: "><font style="font-size: 9.5pt" color="#008000">//SheetType.MultiPdf</font></span></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">dsdData.ProjectPath = dwgPath;</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">dsdData.DestinationName = </font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">dsdData.ProjectPath + dwgFileName + </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#a31515">".dwf"</font></span><font color="#000000">;</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (System.IO.</font><span style="color: "><font color="#2b91af">File</font></span><font color="#000000">.Exists(dsdData.DestinationName))</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">System.IO.</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">File</font></span><font color="#000000">.Delete(dsdData.DestinationName);</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">dsdData.SetDsdEntryCollection(collection);</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">string</font></span><font color="#000000"> dsdFile = dsdData.ProjectPath + dwgFileName + </font><span style="color: "><font color="#a31515">".dsd"</font></span><font color="#000000">;</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><span style="color: "><font style="font-size: 9.5pt" color="#008000">//Workaround to avoid promp for dwf file name</font></span></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><span style="color: "><font style="font-size: 9.5pt" color="#008000">//set PromptForDwfName=FALSE in dsdData using </font></span></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="color: "><font style="font-size: 9.5pt" color="#008000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //StreamReader/StreamWriter</font></span></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><span style="mso-spacerun: yes"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">dsdData.WriteDsd(dsdFile);</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">System.IO.</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">StreamReader</font></span><font color="#000000"> sr = </font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt"><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> System.IO.</font><span style="color: "><font color="#2b91af">StreamReader</font></span><font color="#000000">(dsdFile);</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font color="#000000" face="Consolas"></font></span>&nbsp;</p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">string</font></span><font color="#000000"> str = sr.ReadToEnd();</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">sr.Close();</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">str = str.Replace(</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><font style="font-size: 9.5pt"><span style="color: "><font color="#a31515">"PromptForDwfName=TRUE"</font></span><font color="#000000">, </font><span style="color: "><font color="#a31515">"PromptForDwfName=FALSE"</font></span><font color="#000000">);</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font color="#000000" face="Consolas"></font></span>&nbsp;</p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">System.IO.</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">StreamWriter</font></span><font color="#000000"> sw = </font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt"><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> System.IO.</font><span style="color: "><font color="#2b91af">StreamWriter</font></span><font color="#000000">(dsdFile);</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font color="#000000" face="Consolas"></font></span>&nbsp;</p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">sw.Write(str);</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">sw.Close();</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">dsdData.ReadDsd(dsdFile);</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">System.IO.</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">File</font></span><font color="#000000">.Delete(dsdFile);</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">PlotConfig</font></span><font color="#000000"> plotConfig = Autodesk.AutoCAD.PlottingServices.</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">PlotConfigManager</font></span><font color="#000000">.SetCurrentConfig(</font><span style="color: "><font color="#a31515">"DWF6 ePlot.pc3"</font></span><font color="#000000">);</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><span style="color: "><font style="font-size: 9.5pt" color="#008000">//PlotConfig pc = Autodesk.AutoCAD.PlottingServices.</font></span></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><span style="color: "><font style="font-size: 9.5pt" color="#008000">//<span style="mso-spacerun: yes">&nbsp; </span>PlotConfigManager.SetCurrentConfig("DWG To PDF.pc3");</font></span></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">Autodesk.AutoCAD.Publishing.</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">Publisher</font></span><font color="#000000"> publisher =</font></font></font></span><span style="font-family: "><font face="Consolas"><font color="#000000"><font style="font-size: 9.5pt">&nbsp; </font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Autodesk.AutoCAD.ApplicationServices.</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Application</font></span><font color="#000000">.Publisher;</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "></span><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">publisher.AboutToBeginPublishing += </font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> Autodesk.AutoCAD.Publishing.</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">AboutToBeginPublishingEventHandler</font></span><font color="#000000">(</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">Publisher_AboutToBeginPublishing);</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">publisher.PublishExecute(dsdData, plotConfig);</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">Tx.Commit();</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></font></span><span style="color: "><font style="font-size: 9.5pt" color="#008000">//reset the background plot value</font></span></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;</font></span><font style="font-size: 9.5pt"><span style="mso-spacerun: yes">&nbsp;&nbsp; </span></font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">Application</font></span><font color="#000000">.SetSystemVariable(</font><span style="color: "><font color="#a31515">"BACKGROUNDPLOT"</font></span><font color="#000000">, bgPlot);</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">}</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><font style="font-size: 9.5pt">private</font></font></span><span style="font-family: "><font style="font-size: 9.5pt"><font color="#000000"> </font><span style="color: "><font color="#0000ff">static</font></span><font color="#000000"> System.Collections.Generic.</font><span style="color: "><font color="#2b91af">List</font></span><font color="#000000">&lt;</font><span style="color: "><font color="#2b91af">ObjectId</font></span><font color="#000000">&gt; </font></font></span></font></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">GetLayoutIds(</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">Database</font></span><font color="#000000"> db)</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">{</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">System.Collections.Generic.</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">List</font></span><font color="#000000">&lt;</font><span style="color: "><font color="#2b91af">ObjectId</font></span><font color="#000000">&gt; layoutIds = </font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> System.Collections.Generic.</font><span style="color: "><font color="#2b91af">List</font></span><font color="#000000">&lt;</font><span style="color: "><font color="#2b91af">ObjectId</font></span><font color="#000000">&gt;();</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">using</font></span><font color="#000000"> (</font><span style="color: "><font color="#2b91af">Transaction</font></span><font color="#000000"> Tx = db.TransactionManager.StartTransaction())</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">{</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">DBDictionary</font></span><font color="#000000"> layoutDic = Tx.GetObject(</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">db.LayoutDictionaryId, </font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">OpenMode</font></span><font color="#000000">.ForRead, </font><span style="color: "><font color="#0000ff">false</font></span><font color="#000000">) </font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">as</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">DBDictionary</font></span><font color="#000000">;</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">foreach</font></span><font color="#000000"> (</font><span style="color: "><font color="#2b91af">DBDictionaryEntry</font></span><font color="#000000"> entry </font><span style="color: "><font color="#0000ff">in</font></span><font color="#000000"> layoutDic)</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">{</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">layoutIds.Add(entry.Value);</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> layoutIds;</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">}</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><font style="font-size: 9.5pt">static</font></font></span><span style="font-family: "><font style="font-size: 9.5pt"><font color="#000000"> </font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000"> Publisher_AboutToBeginPublishing(</font></font></span></font></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">object</font></span><font color="#000000"> sender, </font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">Autodesk.AutoCAD.Publishing.</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">AboutToBeginPublishingEventArgs</font></span><font color="#000000"> e)</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-ansi-language: fr" lang="FR"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">{</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-ansi-language: fr" lang="FR"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">Application</font></span><font color="#000000">.DocumentManager.MdiActiveDocument.Editor.WriteMessage(</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; mso-ansi-language: fr" lang="FR"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span></span><font style="font-size: 9.5pt"><span style="font-family: ; color: "><font color="#a31515">"\nAboutToBeginPublishing!!"</font></span></font><span style="font-family: "><font style="font-size: 9.5pt" color="#000000">);</font></span></font></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">}</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font color="#000000" face="Consolas"></font></span>&nbsp;</p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font color="#000000" face="Consolas"></font></span>&nbsp;</p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal">
<p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font style="font-size: 11pt" color="#000000"></font></font></p>The following sample uses a similar approach but illustrates how to use "PublishExecute" API to batch plot layouts from several different drawings without need to worry about synchronization issues linked to opening/closing the files: 
<pre><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000"></font></font></span></pre>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; color: "><font face="Consolas"><font style="font-size: 9.5pt" color="#008000">//////////////////////////////////////////////////////////////////////////</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; color: "><font face="Consolas"><font style="font-size: 9.5pt" color="#008000">//Use: Will batch publish to single dwf every layout of </font></font></span><span style="font-family: "></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; color: "><font face="Consolas"><font style="font-size: 9.5pt" color="#008000">//<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>each document provided as input</font></font></span><span style="font-family: "></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; color: "><font face="Consolas"><font style="font-size: 9.5pt" color="#008000">//<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>Make sure each of your drawing contains a page setup </font></font></span><span style="font-family: "></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; color: "><font face="Consolas"><font style="font-size: 9.5pt" color="#008000">//<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>named Setup1 before running.</font></font></span><span style="font-family: "></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; color: "><font face="Consolas"><font color="#008000"><font style="font-size: 9.5pt">//</font><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span></font></font></span><span style="font-family: "></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; color: "><font face="Consolas"><font style="font-size: 9.5pt" color="#008000">//////////////////////////////////////////////////////////////////////////</font></font></span><span style="font-family: "></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><font style="font-size: 9.5pt">[</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">CommandMethod</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">"BatchPublishCmd"</font></span><font color="#000000">, </font><span style="color: "><font color="#2b91af">CommandFlags</font></span><font color="#000000">.Session)]</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><font style="font-size: 9.5pt">static</font></font></span><span style="font-family: "><font style="font-size: 9.5pt"><font color="#000000"> </font><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000"> BatchPublishCmd()</font></font></span></font></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">{</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">short</font></span><font color="#000000"> bgPlot = </font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt"><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (</font><span style="color: "><font color="#0000ff">short</font></span><font color="#000000">)</font><span style="color: "><font color="#2b91af">Application</font></span><font color="#000000">.GetSystemVariable(</font><span style="color: "><font color="#a31515">"BACKGROUNDPLOT"</font></span><font color="#000000">);</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font color="#000000" face="Consolas"></font></span>&nbsp;</p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">Application</font></span><font color="#000000">.SetSystemVariable(</font><span style="color: "><font color="#a31515">"BACKGROUNDPLOT"</font></span><font color="#000000">, 0);</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">System.Collections.Generic.</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">List</font></span><font color="#000000">&lt;</font><span style="color: "><font color="#0000ff">string</font></span><font color="#000000">&gt; docsToPlot = </font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> System.Collections.Generic.</font><span style="color: "><font color="#2b91af">List</font></span><font color="#000000">&lt;</font><span style="color: "><font color="#0000ff">string</font></span><font color="#000000">&gt;();</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">docsToPlot.Add(</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#a31515">"C:\\Temp\\Drawing1.dwg"</font></span><font color="#000000">);</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">docsToPlot.Add(</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#a31515">"C:\\Temp\\Drawing2.dwg"</font></span><font color="#000000">);</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">docsToPlot.Add(</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#a31515">"C:\\Temp\\Drawing3.dwg"</font></span><font color="#000000">);</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">BatchPublish(docsToPlot);</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">}</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><font style="font-size: 9.5pt">static</font></font></span><span style="font-family: "><font style="font-size: 9.5pt"><font color="#000000"> </font><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000"> BatchPublish(</font></font></span></font></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">System.Collections.Generic.</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">List</font></span><font color="#000000">&lt;</font><span style="color: "><font color="#0000ff">string</font></span><font color="#000000">&gt; docsToPlot)</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-ansi-language: fr" lang="FR"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">{</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-ansi-language: fr" lang="FR"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt"><span style="mso-spacerun: yes">&nbsp;</span></font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">DsdEntryCollection</font></span><font color="#000000"> collection = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">DsdEntryCollection</font></span><font color="#000000">();</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-ansi-language: fr" lang="FR"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-ansi-language: fr" lang="FR"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">Document</font></span><font color="#000000"> doc = </font><span style="color: "><font color="#2b91af">Application</font></span><font color="#000000">.DocumentManager.MdiActiveDocument;</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-ansi-language: fr" lang="FR"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; mso-ansi-language: fr" lang="FR"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></font></span></span><font style="font-size: 9.5pt"><span style="font-family: ; color: "><font color="#0000ff">foreach</font></span></font><span style="font-family: "><font style="font-size: 9.5pt"><font color="#000000"> (</font><span style="color: "><font color="#0000ff">string</font></span><font color="#000000"> filename </font><span style="color: "><font color="#0000ff">in</font></span><font color="#000000"> docsToPlot)</font></font></span></font></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">{</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">using</font></span><font color="#000000"> (</font><span style="color: "><font color="#2b91af">DocumentLock</font></span><font color="#000000"> doclock = doc.LockDocument())</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">{</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt"><span style="mso-spacerun: yes">&nbsp;</span></font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">Database</font></span><font color="#000000"> db = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">Database</font></span><font color="#000000">(</font><span style="color: "><font color="#0000ff">false</font></span><font color="#000000">, </font><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">);</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font color="#000000" face="Consolas"></font></span>&nbsp;</p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">db.ReadDwgFile(</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; filename, System.IO.</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">FileShare</font></span><font color="#000000">.Read, </font><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">, </font><span style="color: "><font color="#a31515">""</font></span><font color="#000000">);</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">System.IO.</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">FileInfo</font></span><font color="#000000"> fi = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> System.IO.</font><span style="color: "><font color="#2b91af">FileInfo</font></span><font color="#000000">(filename);</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">string</font></span><font color="#000000"> docName = </font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt"><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fi.Name.Substring(0, fi.Name.Length - 4);</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">using</font></span><font color="#000000"> (</font><span style="color: "><font color="#2b91af">Transaction</font></span><font color="#000000"> Tx = </font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">db.TransactionManager.StartTransaction())</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">{</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">foreach</font></span><font color="#000000"> (</font><span style="color: "><font color="#2b91af">ObjectId</font></span><font color="#000000"> layoutId </font><span style="color: "><font color="#0000ff">in</font></span><font color="#000000"> getLayoutIds(db))</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">{</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt"><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">Layout</font></span><font color="#000000"> layout = Tx.GetObject(</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">layoutId, </font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">OpenMode</font></span><font color="#000000">.ForRead) </font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">as</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">Layout</font></span><font color="#000000">;</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">DsdEntry</font></span><font color="#000000"> entry = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">DsdEntry</font></span><font color="#000000">();</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">entry.DwgName = filename;</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">entry.Layout = layout.LayoutName;</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">entry.Title = docName + </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#a31515">"_"</font></span><font color="#000000"> + layout.LayoutName;</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">entry.NpsSourceDwg = entry.DwgName;</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">entry.Nps = </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#a31515">"Setup1"</font></span><font color="#000000">;</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">collection.Add(entry);</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font color="#000000" face="Consolas"></font></span>&nbsp;</p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">Tx.Commit();</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">DsdData</font></span><font color="#000000"> dsdData = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">DsdData</font></span><font color="#000000">();</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">dsdData.SheetType = </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">SheetType</font></span><font color="#000000">.SingleDwf;</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">dsdData.ProjectPath = </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#a31515">"C:\\Temp"</font></span><font color="#000000">;</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></font></span><span style="color: "><font style="font-size: 9.5pt" color="#008000">//Not used for "SheetType.SingleDwf"</font></span></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></font></span><span style="color: "><font style="font-size: 9.5pt" color="#008000">//dsdData.DestinationName = dsdData.ProjectPath + "\\output.dwf";</font></span></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">dsdData.SetDsdEntryCollection(collection);</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">string</font></span><font color="#000000"> dsdFile = dsdData.ProjectPath + </font><span style="color: "><font color="#a31515">"\\dsdData.dsd"</font></span><font color="#000000">;</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></font></span><span style="color: "><font style="font-size: 9.5pt" color="#008000">//Workaround to avoid promp for dwf file name</font></span></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></font></span><span style="color: "><font style="font-size: 9.5pt" color="#008000">//set PromptForDwfName=FALSE in dsdData </font></span></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></font></span><span style="color: "><font style="font-size: 9.5pt" color="#008000">//using StreamReader/StreamWriter</font></span></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (System.IO.</font><span style="color: "><font color="#2b91af">File</font></span><font color="#000000">.Exists(dsdFile))</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">System.IO.</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">File</font></span><font color="#000000">.Delete(dsdFile);</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">dsdData.WriteDsd(dsdFile);</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">System.IO.</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">StreamReader</font></span><font color="#000000"> sr = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> System.IO.</font><span style="color: "><font color="#2b91af">StreamReader</font></span><font color="#000000">(dsdFile);</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">string</font></span><font color="#000000"> str = sr.ReadToEnd();</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">sr.Close();</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">str = str.Replace(</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><font style="font-size: 9.5pt"><span style="color: "><font color="#a31515">"PromptForDwfName=TRUE"</font></span><font color="#000000">, </font><span style="color: "><font color="#a31515">"PromptForDwfName=FALSE"</font></span><font color="#000000">);</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "></span>&nbsp;</p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">System.IO.</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">StreamWriter</font></span><font color="#000000"> sw = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> System.IO.</font><span style="color: "><font color="#2b91af">StreamWriter</font></span><font color="#000000">(dsdFile);</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">sw.Write(str);</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">sw.Close();</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">dsdData.ReadDsd(dsdFile);</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">System.IO.</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">File</font></span><font color="#000000">.Delete(dsdFile);</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">PlotConfig</font></span><font color="#000000"> plotConfig = </font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">Autodesk.AutoCAD.PlottingServices.</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">PlotConfigManager</font></span><font color="#000000">.SetCurrentConfig(</font><span style="color: "><font color="#a31515">"DWF6 ePlot.pc3"</font></span><font color="#000000">);</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">Autodesk.AutoCAD.Publishing.</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">Publisher</font></span><font color="#000000"> publisher = </font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">Autodesk.AutoCAD.ApplicationServices.</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">Application</font></span><font color="#000000">.Publisher;</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">publisher.PublishExecute(dsdData, plotConfig);</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">}</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><font style="font-size: 9.5pt">private</font></font></span><span style="font-family: "><font style="font-size: 9.5pt"><font color="#000000"> </font><span style="color: "><font color="#0000ff">static</font></span><font color="#000000"> System.Collections.Generic.</font><span style="color: "><font color="#2b91af">List</font></span><font color="#000000">&lt;</font><span style="color: "><font color="#2b91af">ObjectId</font></span><font color="#000000">&gt; </font></font></span></font></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">getLayoutIds(</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">Database</font></span><font color="#000000"> db)</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">{</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">System.Collections.Generic.</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">List</font></span><font color="#000000">&lt;</font><span style="color: "><font color="#2b91af">ObjectId</font></span><font color="#000000">&gt; layoutIds = </font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> System.Collections.Generic.</font><span style="color: "><font color="#2b91af">List</font></span><font color="#000000">&lt;</font><span style="color: "><font color="#2b91af">ObjectId</font></span><font color="#000000">&gt;();</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">using</font></span><font color="#000000"> (</font><span style="color: "><font color="#2b91af">Transaction</font></span><font color="#000000"> Tx = db.TransactionManager.StartTransaction())</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">{</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">DBDictionary</font></span><font color="#000000"> layoutDic = Tx.GetObject(</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">db.LayoutDictionaryId, </font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">OpenMode</font></span><font color="#000000">.ForRead, </font><span style="color: "><font color="#0000ff">false</font></span><font color="#000000">) </font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">as</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">DBDictionary</font></span><font color="#000000">;</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">foreach</font></span><font color="#000000"> (</font><span style="color: "><font color="#2b91af">DBDictionaryEntry</font></span><font color="#000000"> entry </font><span style="color: "><font color="#0000ff">in</font></span><font color="#000000"> layoutDic)</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">{</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">layoutIds.Add(entry.Value);</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&nbsp;</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&nbsp;&nbsp;&nbsp; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> layoutIds;</font></font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">}</font></font></span></p>
<p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font style="font-size: 11pt" color="#000000">&nbsp;</font></font></p>
