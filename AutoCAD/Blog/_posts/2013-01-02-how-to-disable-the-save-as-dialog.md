---
layout: "post"
title: "How to disable the &ldquo;Save As&rdquo; dialog"
date: "2013-01-02 16:52:01"
author: "Gopinath Taget"
categories:
  - "2010"
  - "2011"
  - "2012"
  - "2013"
  - "AutoCAD"
  - "Gopinath Taget"
  - "ObjectARX"
original_url: "https://adndevblog.typepad.com/autocad/2013/01/how-to-disable-the-save-as-dialog.html "
typepad_basename: "how-to-disable-the-save-as-dialog"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/gopinath-taget.html">Gopinath Taget</a></p>
<p>You should be able to bypass AutoCAD&#39;s prompt to save drawings by using a couple of different techniques. You can catch the AutoCAD close notification within a beginQuit() Editor Reactor notification handler, and set the DBMOD AutoCAD variable to 0 for each open drawing. When a document is closed however, the Save Drawing warning dialog has to be caught just prior to being displayed, at which point we can again set the DBMOD variable(s), cancel the dialog, and re-issue the command which was originally called to finally close the document. This second technique requires setting a Windows CBT (Computer Based Training) hook, which is relatively simple.</p>
<p>Under normal circumstances, the DBMOD variable (which is non-zero when its database requires saving) is READ-ONLY, and cannot be modified, however there is an undocumented (and unsupported) API you can use to change its value called &#39;acdbSetDbmod()&#39;, which is in acdbXX.lib (Where XX is the version number of the library. The current version is 19). Use this API with extreme caution, as it can lead to data loss if improperly used. With this app loaded, you will never get the opportunity to save any drawings if you close them, or exit AutoCAD, so again, extreme care is needed when using it.</p>
<p>One variation of these techniques could be implemented which would allow you to automatically save the drawing instead, (with the current name) and still bypass the save-as dialog. I will include comments within the code below to   <br />demonstrate this.</p>
<p>Here is an example of the code required to disable the Save-As Dialog (error checking removed for brevity):</p>
<div style="background: white;">
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #008000;">// global hook</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">HHOOK MyHook;</span></span></span></p>
</div>
<div style="background: white;">
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #008000;">// Here we load the reactor, and set our windows CBT hook...</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">void</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> InitApplication() </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">{&#0160;&#0160;&#0160; </span></span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;"> ADSEdReactor *pEdReactor = </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">new</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> ADSEdReactor();&#0160;&#0160;&#0160; </span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;"> acedEditor-&gt;addReactor(pEdReactor);&#0160;&#0160;&#0160; </span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;"> MyHook=::SetWindowsHookEx(WH_CBT,</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160; (HOOKPROC)FileHook,(HINSTANCE)NULL, </span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160; ::GetCurrentThreadId());</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">}</span></span></span></p>
</div>
<p>The code within the beginQuit() notification handler would just be:</p>
<div style="background: white;">
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">void</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;"> ADSEdReactor::beginQuit(</span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">void</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">)</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">{</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;"> AcEditorReactor3::beginQuit () ;</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;"> AcApDocumentIterator *pIt;</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;"> pIt=acDocManager-&gt;newAcApDocumentIterator();</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">while</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">(!pIt-&gt;done())</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;"> {</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">// For each open document...</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160; AcApDocument* pDoc=pIt-&gt;document();</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160; acDocManager-&gt;setCurDocument(pDoc);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">struct</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> resbuf res;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; acedGetVar(L</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;DBMOD&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">,&amp;res);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">if</span></span><span style="line-height: 11pt;"><span style="color: #000000;">(res.resval.rint) </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">// If changes have been made...</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160; {</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160; acDocManager-&gt;lockDocument(pDoc); </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">// Lock</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">// If you want to save...</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">//SaveDb(pDoc);// call the save function option.</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">//If you want to discard...</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160; acdbSetDbmod(pDoc-&gt;database(),0); </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">// clear changes flag</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160; acDocManager-&gt;unlockDocument(pDoc);</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">//unlock</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160; }</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160; pIt-&gt;step();</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;"> }</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">delete</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> pIt;</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">}</span></span></span></p>
</div>
<p>Here is the CBT hook callback...</p>
<div style="background: white;">
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">LRESULT CALLBACK FileHook(</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">int</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> nCode, WPARAM wParam, </span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;"> LPARAM lParam)</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">{</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">if</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">(nCode==HCBT_CREATEWND)</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;"> {</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160; CBT_CREATEWND* pCbt=(CBT_CREATEWND*)lParam;</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160; CREATESTRUCT* pCS=(CREATESTRUCT*)(pCbt-&gt;lpcs);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">try</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">// exception handling required...</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160; {</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">if</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">(pCS-&gt;lpszName &amp;&amp; </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; !wcscmp(pCS-&gt;lpszName, L</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;AutoCAD&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">) &amp;&amp; </span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160; pCS-&gt;dwExStyle==65793)</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160; {</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160; AcApDocument *pDoc=acDocManager-&gt;curDocument();</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">// If you Want to Save...</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">//acDocManager-&gt;lockDocument(pDoc);// lock</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">//SaveDb(pDoc); // call to save option</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">//acDocManager-&gt;unlockDocument(pDoc); // unlock</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">// If you want to discard...</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; acdbSetDbmod(pDoc-&gt;database(),0); </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">// clear changes flag</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">// Re-send the command which invoked the save-as</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">//dialog...</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">struct</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> resbuf res;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; acedGetVar(L</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;CMDNAMES&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">,&amp;res);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">if</span></span><span style="line-height: 11pt;"><span style="color: #000000;">(!wcscmp(res.resval.rstring, L</span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;NEW&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">) || </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160; !wcscmp(res.resval.rstring, L</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;OPEN&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">))</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160; {</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160; acDocManager-&gt;sendStringToExecute(pDoc, </span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; res.resval.rstring);</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160; }</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">else</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160; {</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160; acDocManager-&gt;sendStringToExecute(pDoc,</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160; L</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;.CLOSE &quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">);</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160; }</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">return</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> TRUE;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160; }</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">// if</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; }</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">// try</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">catch</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">(...)</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160; {</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160; }</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;"> }</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">// if</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">return</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> (::CallNextHookEx(MyHook,nCode,wParam,lParam));</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">}</span></span></span></p>
</div>
<p>Here is the option to save the drawing...</p>
<div style="background: white;">
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">void</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> SaveDb(AcApDocument* pDoc)</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">{&#0160;&#0160;&#0160; </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">const</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> ACHAR*pChar=pDoc-&gt;fileName(); </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">// Get the current filename&#0160;&#0160;&#0160; </span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;"> AcDbDatabase *pDb=pDoc-&gt;database();&#0160;&#0160;&#0160; </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;"> pDb-&gt;saveAs(pChar);</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">// call to save...&#0160;&#0160;&#0160; </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;"> acdbSetDbmod(pDb,0);</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">// make sure it will close...</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">}</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">void</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> UnloadApplication()</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">{&#0160;&#0160;&#0160; </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;"> ::UnhookWindowsHookEx(MyHook); </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">// always remove your hooks...</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">}</span></span></span></p>
</div>
<p>While this ARX is loaded, you should be able avoid the save-as dialog, and you should always be able to close AutoCAD. You can still save your drawing explicitly with the save command, but if you ever close a drawing, or exit AutoCAD, your changes will not be saved to the current project drawing.</p>
