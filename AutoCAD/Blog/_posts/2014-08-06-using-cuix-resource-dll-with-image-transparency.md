---
layout: "post"
title: "Using CUIx resource dll with image transparency"
date: "2014-08-06 09:15:29"
author: "Philippe Leefsma"
categories:
  - ".NET"
  - "AutoCAD"
  - "Philippe Leefsma"
original_url: "https://adndevblog.typepad.com/autocad/2014/08/using-cuix-resource-dll-with-image-transparency.html "
typepad_basename: "using-cuix-resource-dll-with-image-transparency"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/philippe-leefsma.html" target="_self">Philippe Leefsma</a></p>  <p>This post and associated code samples is a courtesy from one of our ADN member: Michael Csikos. Thanks Michael!</p>  <p>This illustrates how to use .ico files in a resource-only dll for your cuix files. By default the cuix file accepts resource dlls with .bmp files, however .bmp do not support transparency, which can make your button icons look much nicer in AutoCAD UI.</p>  <p>Unfortunately this approach isn’t documented anywhere in the AutoCAD programming help, so Michael was digging out this workaround: by manually editing the resource file (.rc) of your resource-only dll project, you can have the cuix support .ico files. Once you added a new ico resource through the Visual Studio editor, modify the “ICO” property of the resource to “RCDATA” as illustrated in the sample below: </p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font face="Consolas"><font style="font-size: 9.5pt" color="#008000">//////////////////////////////////////////////////////////////////</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font face="Consolas"><font style="font-size: 9.5pt" color="#008000">// Icon with lowest ID value placed first to ensure application </font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font face="Consolas"><font style="font-size: 9.5pt" color="#008000">// icon remains consistent on all systems.</font></font></span><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#000000"><font style="font-size: 9.5pt">IDI_TRIANGLE16<span style="mso-spacerun: yes">&#160;&#160;&#160;&#160; </span>RCDATA<span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span></font></font></span><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font style="font-size: 9.5pt" color="#a31515">&quot;.\\resources\\icon1.ico&quot;</font></span></font><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#000000"><font style="font-size: 9.5pt">IDI_TRIANGLE32<span style="mso-spacerun: yes">&#160;&#160;&#160;&#160; </span>RCDATA<span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span></font></font></span><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font style="font-size: 9.5pt" color="#a31515">&quot;.\\resources\\icon2.ico&quot;</font></span></font><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#0000ff"><font style="font-size: 9.5pt">#endif</font></font></span><font style="font-size: 9.5pt"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><span style="mso-spacerun: yes"><font color="#000000">&#160;&#160;&#160; </font></span></span></font><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font style="font-size: 9.5pt" color="#008000">// English (Australia) resources</font></span></font><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font face="Consolas"><font style="font-size: 9.5pt" color="#008000">//////////////////////////////////////////////////////////////////</font></font></span></p>  <p>You can then compile your dll and place it in the same folder than the cuix file using the resource. The same approach doesn’t work for .png unfortunately.</p>  <p>On top of that Michael also provided a C# sample that illustrates how to programmatically generate a cuix file using those resources. Generating the cuix file from the code is a very efficient approach, as it allows to quickly and easily modify and re-generate the cuix files as needed.</p>  <p>The sample creates extension methods (see CustomizationExtensions.cs) which makes it a lot easier to add new tabs, panels, rows and buttons.</p>  <p>An extract of his code looks like below:</p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#0000ff"><font style="font-size: 9.5pt">var</font></font></span><font style="font-size: 9.5pt"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#000000"> debugFolder<span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>= </font></span></font></font></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><font style="font-size: 9.5pt"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"></span><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#2b91af">&#160;&#160;&#160; Path</font></span><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#000000">.GetDirectoryName(</font></span></font></font></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><font style="font-size: 9.5pt"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#2b91af">Assembly</font></span></font><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font style="font-size: 9.5pt" color="#000000">.GetExecutingAssembly().Location);</font></span></font></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><font color="#ffffff" face="Consolas"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white">-</span></font></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#0000ff"><font style="font-size: 9.5pt">var</font></font></span><font style="font-size: 9.5pt"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#000000"> cs&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; = </font></span><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#0000ff">new</font></span><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#000000"> </font></span><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#2b91af">CustomizationSection</font></span></font><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font style="font-size: 9.5pt" color="#000000">();</font></span></font></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#0000ff"><font style="font-size: 9.5pt">var</font></font></span><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font style="font-size: 9.5pt" color="#000000"> menuGroup<span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>= cs.MenuGroup;</font></span></font></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#0000ff"><font style="font-size: 9.5pt">var</font></font></span><font style="font-size: 9.5pt"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#000000"> tab<span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>= </font></span></font></font><font face="Consolas"><font style="font-size: 9.5pt"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#000000">cs.AddNewTab(</font></span><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#a31515">&quot;CuiTestTab&quot;</font></span></font><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font style="font-size: 9.5pt" color="#000000">);</font></span></font></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#0000ff"><font style="font-size: 9.5pt">var</font></font></span><font style="font-size: 9.5pt"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#000000"> panel<span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>= tab.AddNewPanel(</font></span><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#a31515">&quot;Panel&quot;</font></span></font><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font style="font-size: 9.5pt" color="#000000">);</font></span></font></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#0000ff"><font style="font-size: 9.5pt">var</font></font></span><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font style="font-size: 9.5pt" color="#000000"> row<span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>= panel.AddNewRibbonRow();</font></span></font></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#000000"><font style="font-size: 9.5pt">menuGroup.Name<span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>= </font></font></span><font style="font-size: 9.5pt"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#a31515">&quot;CuiTest&quot;</font></span></font><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font style="font-size: 9.5pt" color="#000000">;</font></span></font></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">row.AddNewButton(</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span></span><font style="font-size: 9.5pt"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#a31515">&quot;BMP&quot;</font></span></font><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font style="font-size: 9.5pt" color="#000000">,</font></span></font></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span></span><font style="font-size: 9.5pt"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#a31515">&quot;BMP&quot;</font></span></font><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font style="font-size: 9.5pt" color="#000000">,</font></span></font></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span></span><font style="font-size: 9.5pt"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#a31515">&quot;SayBMP&quot;</font></span></font><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font style="font-size: 9.5pt" color="#000000">,</font></span></font></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span></span><font style="font-size: 9.5pt"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#a31515">&quot;BMP loaded from the resource DLL&quot;</font></span></font><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font style="font-size: 9.5pt" color="#000000">,</font></span></font></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span></span><font style="font-size: 9.5pt"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#a31515">&quot;IDB_CIRCLE16&quot;</font></span></font><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font style="font-size: 9.5pt" color="#000000">,</font></span></font></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span></span><font style="font-size: 9.5pt"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#a31515">&quot;IDB_CIRCLE32&quot;</font></span></font><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font style="font-size: 9.5pt" color="#000000">,</font></span></font></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span></span><font style="font-size: 9.5pt"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#2b91af">RibbonButtonStyle</font></span></font><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font style="font-size: 9.5pt" color="#000000">.LargeWithText);</font></span></font></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">row.AddNewButton(</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span></span><font style="font-size: 9.5pt"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#a31515">&quot;ICO&quot;</font></span></font><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font style="font-size: 9.5pt" color="#000000">,</font></span></font></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span></span><font style="font-size: 9.5pt"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#a31515">&quot;ICO&quot;</font></span></font><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font style="font-size: 9.5pt" color="#000000">,</font></span></font></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span></span><font style="font-size: 9.5pt"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#a31515">&quot;SayICO&quot;</font></span></font><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font style="font-size: 9.5pt" color="#000000">,</font></span></font></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span></span><font style="font-size: 9.5pt"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#a31515">&quot;ICO loaded from the resource DLL&quot;</font></span></font><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font style="font-size: 9.5pt" color="#000000">,</font></span></font></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span></span><font style="font-size: 9.5pt"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#a31515">&quot;IDI_TRIANGLE16&quot;</font></span></font><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font style="font-size: 9.5pt" color="#000000">,</font></span></font></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span></span><font style="font-size: 9.5pt"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#a31515">&quot;IDI_TRIANGLE32&quot;</font></span></font><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font style="font-size: 9.5pt" color="#000000">,</font></span></font></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span></span><font style="font-size: 9.5pt"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#2b91af">RibbonButtonStyle</font></span></font><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font style="font-size: 9.5pt" color="#000000">.LargeWithText);</font></span></font></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font face="Consolas"><font style="font-size: 9.5pt" color="#008000"></font></font></span><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#008000" face="Consolas"></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#0000ff"><font style="font-size: 9.5pt">var</font></font></span><font style="font-size: 9.5pt"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#000000"> fileName = </font></span><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#2b91af">Path</font></span><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#000000">.Combine(debugFolder, </font></span><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#a31515">&quot;CuiTest.cuix&quot;</font></span></font><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font style="font-size: 9.5pt" color="#000000">);</font></span></font></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#2b91af"><font style="font-size: 9.5pt">File</font></font></span><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font style="font-size: 9.5pt" color="#000000">.Delete(fileName);</font></span></font></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">cs.SaveAs(fileName);</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal"><span style="font-family: ; background-image: none; background-repeat: repeat; background-attachment: scroll; background-position: 0% 0%; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-highlight: white"><font color="#ffffff" face="Consolas">-</font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal"><font color="#ffffff">-</font></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal">And here is a picture of the stunning result!</p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal">&#160;</p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal"><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01a73dfc8a4d970d-pi"><img title="Screen Shot 2014-08-06 at 5.49.51 PM" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="Screen Shot 2014-08-06 at 5.49.51 PM" src="/assets/image_447424.jpg" width="244" height="174" /></a></p>  <p>See attachment for the whole project: </p>  <div id="scid:fb3a1972-4489-4e52-abe7-25a00bb07fdf:e131e7a0-4ee0-49db-adfb-d584f088e49a" class="wlWriterEditableSmartContent" style="float: none; padding-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px"><p> <a href="http://adndevblog.typepad.com/cui-resonly-ico-7.zip" target="_blank">cui resonly ico.zip</a></p></div>
