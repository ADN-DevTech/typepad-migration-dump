---
layout: "post"
title: "Obtain the Visual Style/Shademode of a Viewport using ObjectARX"
date: "2013-01-30 13:54:04"
author: "Fenton Webb"
categories:
  - "2010"
  - "2011"
  - "2012"
  - "2013"
  - "AutoCAD"
  - "Fenton Webb"
  - "ObjectARX"
original_url: "https://adndevblog.typepad.com/autocad/2013/01/obtain-the-visual-styleshademode-of-a-viewport-using-objectarx.html "
typepad_basename: "obtain-the-visual-styleshademode-of-a-viewport-using-objectarx"
typepad_status: "Publish"
---

<div style="font-family: ; background: white; color: ">   <p style="margin: 0px">By <a href="http://adndevblog.typepad.com/autocad/fenton-webb.html"><font color="#0066cc">Fenton Webb</font></a></p>    <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000"></font></font></span>&#160;</p>    <p style="margin: 0px">Here’s a code snippet I use to get the Visual Style of a Viewport, mostly in my viewportDraw() callback… You have to obtain the Viewport object ID first, then use this code…</p>    <p style="margin: 0px">&#160;</p>    <div style="font-family: ; background: white; color: ">     <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">// paper space checks</font></font></span></p>      <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#010001"><font style="font-size: 8pt">AcDbObjectPointer</font></font></span><font style="font-size: 8pt"><font color="#000000">&lt;</font><span style="color: "><font color="#010001">AcDbViewport</font></span><font color="#000000">&gt; </font><span style="color: "><font color="#010001">viewportType</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">vpObjId</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">AcDb</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">kForRead</font></span><font color="#000000">);</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">if</font></font></span><font style="font-size: 8pt"><font color="#000000"> (</font><span style="color: "><font color="#010001">viewportType</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">openStatus</font></span><font color="#000000">() == </font><span style="color: "><font color="#010001">Acad</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">eOk</font></span><font color="#000000">)</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">{</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">TCHAR</font></span><font color="#000000"> *</font><span style="color: "><font color="#010001">visualStyleName</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">NULL</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">AcDbDictUtil</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">getVisualStyleName</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">visualStyleName</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">viewportType</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#010001">visualStyle</font></span><font color="#000000">());</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">acutPrintf</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">_T</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;\nVisual Style = %s&quot;</font></span><font color="#000000">), </font><span style="color: "><font color="#010001">visualStyleName</font></span><font color="#000000">);</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// free up the string</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">acutDelString</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">visualStyleName</font></span><font color="#000000">);</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">}</font></font></p>      <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#0000ff">else</font></font></span></p>      <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">{</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// model space</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">AcDbObjectPointer</font></span><font color="#000000">&lt;</font><span style="color: "><font color="#010001">AcDbViewportTableRecord</font></span><font color="#000000">&gt; </font><span style="color: "><font color="#010001">viewport</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">vpObjId</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">AcDb</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">kForRead</font></span><font color="#000000">);</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">viewport</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">openStatus</font></span><font color="#000000">() == </font><span style="color: "><font color="#010001">Acad</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">eOk</font></span><font color="#000000">)</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000"> {</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">TCHAR</font></span><font color="#000000"> *</font><span style="color: "><font color="#010001">visualStyleName</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">NULL</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">AcDbDictUtil</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">getVisualStyleName</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">visualStyleName</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">viewport</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#010001">visualStyle</font></span><font color="#000000">());</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">acutPrintf</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">_T</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;\nVisual Style = %s&quot;</font></span><font color="#000000">), </font><span style="color: "><font color="#010001">visualStyleName</font></span><font color="#000000">);</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// free up the string</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">acutDelString</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">visualStyleName</font></span><font color="#000000">);</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000"> }</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">else</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">acutPrintf</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">_T</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;\nVisual Style = 2dWireframe&quot;</font></span><font color="#000000">));</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">}</font></font></p>   </div>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000"></font></font></p> </div>
