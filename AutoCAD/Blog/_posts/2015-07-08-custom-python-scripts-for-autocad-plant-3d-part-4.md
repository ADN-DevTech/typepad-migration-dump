---
layout: "post"
title: "Custom Python Scripts for AutoCAD Plant 3D &ndash; Part 4"
date: "2015-07-08 07:59:55"
author: "Augusto Goncalves"
categories:
  - "Plant3D"
original_url: "https://adndevblog.typepad.com/autocad/2015/07/custom-python-scripts-for-autocad-plant-3d-part-4.html "
typepad_basename: "custom-python-scripts-for-autocad-plant-3d-part-4"
typepad_status: "Publish"
---

<p>By <a href="http://www.autodesk.com/expert-elite/featured-members/david-wolfe">David Wolfe</a> (Contributor) </p>  <p>Get start with <a href="http://adndevblog.typepad.com/autocad/2015/06/custom-python-scripts-for-autocad-plant-3d-part-1.html">Part 1</a>, <a href="http://adndevblog.typepad.com/autocad/2015/06/custom-python-scripts-for-autocad-plant-3d-part-2.html">Part 2</a> and <a href="http://adndevblog.typepad.com/autocad/2015/06/custom-python-scripts-for-autocad-plant-3d-part-3.html">Part 3</a> of this series.</p>  <p><strong>Packaging and Deploying Custom Scripts</strong></p>  <p>This article will demonstrate how to package and deploy your custom scripts. This process will follow these steps:</p>  <ul>   <li>Create images</li>    <li>Build a catalog</li>    <li>Build an installer (or zip)</li> </ul>  <p>In addition, your users will have to follow some installation steps.</p>  <ul>   <li>Extract to content folder (C:\AutoCAD Plant 3D 2016 Content\CPak Common\CustomScripts)</li> </ul>  <p><strong>Creating Images</strong></p>  <p>In order for users to have a relatively seamless experience, you should provide images that match the existing scripts as closely as possible.&#160; Along with using similar parameter names, good images can boost the user experience by making the images blend with the OOTB content.</p>  <p>You should create 4 images:</p>  <ul>   <li>32x32</li>    <li>64x64</li>    <li>240x240</li>    <li>640x 640 (Dimensions)</li> </ul>  <p>By default your AutoCAD environment may look like this:</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d134aa2b970c-pi"><img title="img01" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="img01" src="/assets/image_721285.jpg" width="244" height="211" /></a> </p>  <p>If it does, you should turn UCSICON off, and then use F7 to turn the grid off. </p>  <p>Use the PLANTSNAPSHOT command to create images at 32,64, 200 px square.&#160; Unfortunately, these images won’t exactly match the OOTB content, as the graphic engine has changed. Your images will be stored in the CustomScripts folder, and should have a file name that matches the script file name with the size appended. Shown below is our script (EXPJOINT1.py) with matching image files EXPJOINT1_32.png, EXPJOINT1_64.png, EXPJOINT1_200.png.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b7c7ab3ab6970b-pi"><img title="img02" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="img02" src="/assets/image_779753.jpg" width="474" height="274" /></a> </p>  <p>The program will automatically load them and use them as appropriate.</p>  <p></p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b7c7ab3ac0970b-pi"><img title="img03" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="img03" src="/assets/image_803097.jpg" width="477" height="323" /></a> </p>  <p>In order to provide dimension feedback, you also need to provide a 640x640 image. You can use a program like <a href="http://www.jingproject.com/">Jing</a>, or SnagIt to create a screen clipping that is the correct dimensions.</p>  <p>To setup the dimension image, you’ll need to set your viewport to Hidden, create the dimensions, and override their text values and size.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b7c7ab3aca970b-pi"><img title="img05" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="img05" src="/assets/image_704441.jpg" width="472" height="230" /></a> </p>  <p>You should turn your background white, by modifying your AutoCAD options. </p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01bb084f4db5970d-pi"><img title="img06" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="img06" src="/assets/image_901917.jpg" width="478" height="388" /></a> </p>  <p>Once the images are in place and you have run PLANTREGISTERCUSTOMSCRIPTS on your most recent version, you are ready to package the files.</p>  <p><strong>Deploying the Scripts</strong></p>  <p>Once you have everything ready, you can build your installer. One full-featured free installer is <a href="http://www.jrsoftware.org/isdl.php">Inno Setup</a>. When building your installer, you should handle the following:</p>  <ul>   <li>Multiple versions of Plant</li>    <li>Custom Content Paths</li>    <li>Previously loaded content</li> </ul>  <p><strong>Multiple versions of Plant</strong></p>  <p>The api for creating scripts hasn’t changed significantly since Plant was first released. Technically, you could deploy scripts for all version 2011 and higher.&#160; However, Autodesk maintains support for the last 3 releases, so that may be a factor for your consideration as well.</p>  <p><strong>Custom Content Paths</strong></p>  <p>While C:\AutoCAD Plant 3D 2016 Content is the default content location, some users may have custom paths set. You can find these paths by checking the registry key for its default value.</p>  <p>HKEY_LOCAL_MACHINE\SOFTWARE\Autodesk\AutoCAD\R20.1\ACAD-F017\Variables\PLANTCONTENTFOLDER</p>  <p>The value R20.1 here is for 2016, and F017 is for Plant. See <a href="http://adndevblog.typepad.com/autocad/2013/08/registry-values-for-productid-and-localeid-for-autocad.html">this page</a> for more information on version identifiers.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b7c7ab3ad9970b-pi"><img title="img07" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="img07" src="/assets/image_896545.jpg" width="488" height="108" /></a> </p>  <p>You will need to check this registry value for any version of Plant that you want to install your scripts for.</p>  <p><strong>Previous Content</strong></p>  <p>Most users do not use CustomScripts, so unless they do, you will be able to put files at the CustomScripts folder location without worry. However, if a user does have custom scripts present, they will need to run PLANTREGISTERCUSTOMSCRIPTS after installation in order for your new scripts to be recognized along with existing scripts.</p>  <p>In addition, you should use file names that are not likely to be used by other developers. Every plant developer will have to use the same folder, so prepending your script names with a company abbreviation is a good idea (i.e. ABC_EXPJOINT1.py).</p>  <p><strong>Resources</strong></p>  <p>The scripts are available from an installer here:   <br /><a href="http://www.pdoteam.com/download/sample-script-installer/">http://www.pdoteam.com/download/sample-script-installer/</a>    <br />The installer script is available here:    <br /><a href="http://www.pdoteam.com/download/custom-script-installer/">http://www.pdoteam.com/download/custom-script-installer/</a></p>
