---
layout: "post"
title: "Iterating and Retrieving System Variable Information"
date: "2015-02-19 23:59:00"
author: "Madhukar Moogala"
categories:
  - "2015"
  - "AutoCAD"
  - "Madhukar Moogala"
  - "ObjectARX"
original_url: "https://adndevblog.typepad.com/autocad/2015/02/iterating-and-retrieving-system-variable-information.html "
typepad_basename: "iterating-and-retrieving-system-variable-information"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/Madhukar-Moogala.html" target="_self">Madhukar Moogala</a></p>  <p>A new API <strong>AcEdSysVarIterator</strong> is introduced in ACAD 2015, and I’m writing now when we are about to release AutoCAD 2016 [a moment of self embarrassment <img class="wlEmoticon wlEmoticon-sadsmile" style="border-top-style: none; border-left-style: none; border-bottom-style: none; border-right-style: none" alt="Sad smile" src="/assets/image_146982.jpg" />].</p>  <p>This class “AcEdSysVarIterator” provides a way to iterate over all of the public system variables and get their names, data type, range (if applicable), read-only status, and how they are stored. </p>  <p>A caveat being System variables that have their secret flag set or that have a &quot;*&quot; as the first character in their name are skipped by this iterator. Currently we can get entire information from “SYSVDLG” including anonymous variables, this API may come handy for those who want to automate at client application.</p>  <p>Various other information is available on documentation.</p>  <div style="font-size: 9pt; font-family: consolas; background: white; color: black">   <p style="margin: 0px"><span style="color: blue">void</span> SysVarInfo()</p>    <p style="margin: 0px">{</p>    <p style="margin: 0px"><span style="color: green">/*Iterating through all system variables*/</span></p>    <p style="margin: 0px"><span style="color: #2b91af">AcEdSysVarIterator</span>* pIterator = <span style="color: blue">new</span> <span style="color: #2b91af">AcEdSysVarIterator</span>();</p>    <p style="margin: 0px"><span style="color: blue">while</span> (pIterator-&gt;done() != <span style="color: blue">true</span>)</p>    <p style="margin: 0px">{</p>    <p style="margin: 0px"><span style="color: blue">const</span> <span style="color: #2b91af">AcRxVariable</span>* rxvar = pIterator-&gt;getSysVar();</p>    <p style="margin: 0px">acutPrintf(<span style="color: #6f008a">_T</span>(<span style="color: #a31515">&quot;\n********Sysvar Informataion*************&quot;</span>));</p>    <p style="margin: 0px"><span style="color: blue">const</span> <span style="color: #2b91af">AcString</span> name = rxvar-&gt;name();</p>    <p style="margin: 0px">acutPrintf(<span style="color: #6f008a">_T</span>(<span style="color: #a31515">&quot;\nName of Sysvar : %s&quot;</span>),</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; name.kACharPtr());</p>    <p style="margin: 0px"><span style="color: blue">short</span> pt = rxvar-&gt;primaryType();</p>    <p style="margin: 0px">acutPrintf(<span style="color: #6f008a">_T</span>(<span style="color: #a31515">&quot;\nPrimary Type : %d&quot;</span>),pt);</p>    <p style="margin: 0px"><span style="color: #2b91af">AcRxVariable</span>::<span style="color: #2b91af">SecondaryType</span> secondaryType = rxvar-&gt;secondaryType();</p>    <p style="margin: 0px">acutPrintf(<span style="color: #6f008a">_T</span>(<span style="color: #a31515">&quot;\nSecondary Type : %s&quot;</span>),</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; getSecondaryType(secondaryType).kACharPtr());</p>    <p style="margin: 0px"><span style="color: blue">short</span> tf = rxvar-&gt;typeFlags();</p>    <p style="margin: 0px">acutPrintf(<span style="color: #6f008a">_T</span>(<span style="color: #a31515">&quot;\nFlags : %d&quot;</span>),tf);</p>    <p style="margin: 0px"><span style="color: #2b91af">AcRxVariable</span>::<span style="color: #2b91af">StorageType</span> storageType = rxvar-&gt;storageType();</p>    <p style="margin: 0px">acutPrintf(<span style="color: #6f008a">_T</span>(<span style="color: #a31515">&quot;\nStorage Type : %s&quot;</span>),</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; getStorageType(storageType).kACharPtr());</p>    <p style="margin: 0px"><span style="color: blue">const</span> <span style="color: #2b91af">AcRxVariable</span>::<span style="color: #2b91af">Range</span>* range = rxvar-&gt;range();</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">int</span> lowerBound=-1,upperBound=-1;</p>    <p style="margin: 0px"><span style="color: blue">if</span>(range != <span style="color: blue">nullptr</span>)</p>    <p style="margin: 0px">{</p>    <p style="margin: 0px">lowerBound = range-&gt;lowerBound;</p>    <p style="margin: 0px">upperBound = range-&gt;upperBound;</p>    <p style="margin: 0px">}</p>    <p style="margin: 0px">acutPrintf(<span style="color: #6f008a">_T</span>(<span style="color: #a31515">&quot;\nRange of SysVar : %d&#160; to %d&quot;</span>),</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; lowerBound,upperBound);</p>    <p style="margin: 0px"><span style="color: blue">bool</span> isRO = rxvar-&gt;isReadOnly();</p>    <p style="margin: 0px"><span style="color: #2b91af">AcString</span> readwrite = </p>    <p style="margin: 0px">isRO ? <span style="color: #6f008a">_T</span>(<span style="color: #a31515">&quot;Read Only&quot;</span>) : <span style="color: #6f008a">_T</span>(<span style="color: #a31515">&quot;Read and Write&quot;</span>);</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">acutPrintf(<span style="color: #6f008a">_T</span>(<span style="color: #a31515">&quot;\nSystem Variable is : %s&quot;</span>),readwrite.kACharPtr());</p>    <p style="margin: 0px">acutPrintf(<span style="color: #6f008a">_T</span>(<span style="color: #a31515">&quot;\n-----------------------&quot;</span>));</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">pIterator-&gt;step();</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">}</p>    <p style="margin: 0px"><span style="color: green">/*resets to First sysvar*/</span></p>    <p style="margin: 0px">pIterator-&gt;reset();</p>    <p style="margin: 0px"><span style="color: blue">delete</span> pIterator;</p>    <p style="margin: 0px">}</p> </div>  <div style="font-size: 9pt; font-family: consolas; background: white; color: black">   <p style="margin: 0px"><span style="color: green">/*Helper Functions*/</span></p>    <p style="margin: 0px"><span style="color: blue">const</span> <span style="color: #2b91af">AcString</span> getStorageType(<span style="color: #2b91af">AcRxVariable</span>::<span style="color: #2b91af">StorageType</span> <span style="color: gray">storageType</span>)</p>    <p style="margin: 0px">{</p>    <p style="margin: 0px"><span style="color: #2b91af">AcString</span> storageInfo = <span style="color: #a31515">&quot;&quot;</span>;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">switch</span>(<span style="color: gray">storageType</span>)</p>    <p style="margin: 0px">{</p>    <p style="margin: 0px"><span style="color: blue">case</span> 0:</p>    <p style="margin: 0px">storageInfo =</p>    <p style="margin: 0px"><span style="color: #6f008a">_T</span>(<span style="color: #a31515">&quot;Application wide, does not persist&quot;</span>);</p>    <p style="margin: 0px"><span style="color: blue">break</span>;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">case</span> 1:</p>    <p style="margin: 0px">storageInfo =</p>    <p style="margin: 0px"><span style="color: #6f008a">_T</span>(<span style="color: #a31515">&quot;Application wide, persists per user&quot;</span>);</p>    <p style="margin: 0px"><span style="color: blue">break</span>;</p>    <p style="margin: 0px"><span style="color: blue">case</span> 2:</p>    <p style="margin: 0px">storageInfo = </p>    <p style="margin: 0px"><span style="color: #6f008a">_T</span>(<span style="color: #a31515">&quot;Application wide, persists per AutoCAD profile&quot;</span>);</p>    <p style="margin: 0px"><span style="color: blue">break</span>;</p>    <p style="margin: 0px"><span style="color: blue">case</span> 3:</p>    <p style="margin: 0px">storageInfo = </p>    <p style="margin: 0px"><span style="color: #6f008a">_T</span>(<span style="color: #a31515">&quot;document wide, persists in drawing&quot;</span>);</p>    <p style="margin: 0px"><span style="color: blue">break</span>;</p>    <p style="margin: 0px"><span style="color: blue">case</span> 4:</p>    <p style="margin: 0px">storageInfo = </p>    <p style="margin: 0px"><span style="color: #6f008a">_T</span>(<span style="color: #a31515">&quot;viewport (AcDbViewport and AcDbViewportTableRecord) wide, persists in drawing.&quot;</span>);</p>    <p style="margin: 0px"><span style="color: blue">break</span>;</p>    <p style="margin: 0px"><span style="color: blue">default</span>:</p>    <p style="margin: 0px"><span style="color: blue">break</span>;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">}</p>    <p style="margin: 0px"><span style="color: blue">return</span> storageInfo;</p>    <p style="margin: 0px">}</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">const</span> <span style="color: #2b91af">AcString</span> getSecondaryType(<span style="color: #2b91af">AcRxVariable</span>::<span style="color: #2b91af">SecondaryType</span> <span style="color: gray">secondaryType</span>)</p>    <p style="margin: 0px">{</p>    <p style="margin: 0px"><span style="color: #2b91af">AcString</span> secondaryInfo = <span style="color: #6f008a">_T</span>(<span style="color: #a31515">&quot;&quot;</span>);</p>    <p style="margin: 0px"><span style="color: blue">switch</span>(<span style="color: gray">secondaryType</span>)</p>    <p style="margin: 0px">{</p>    <p style="margin: 0px"><span style="color: blue">case</span> 0: </p>    <p style="margin: 0px">secondaryInfo =</p>    <p style="margin: 0px"><span style="color: #6f008a">_T</span>(<span style="color: #a31515">&quot;No secondary data type is specified&quot;</span>);</p>    <p style="margin: 0px"><span style="color: blue">break</span>;</p>    <p style="margin: 0px"><span style="color: blue">case</span> 1: </p>    <p style="margin: 0px">secondaryInfo =</p>    <p style="margin: 0px"><span style="color: #6f008a">_T</span>(<span style="color: #a31515">&quot;The variable is a boolean. Only valid when primaryDataType==RTSHORT&quot;</span>);</p>    <p style="margin: 0px"><span style="color: blue">break</span>;</p>    <p style="margin: 0px"><span style="color: blue">case</span> 2: </p>    <p style="margin: 0px">secondaryInfo =</p>    <p style="margin: 0px"><span style="color: #6f008a">_T</span>(<span style="color: #a31515">&quot;The variable is a RealDWG symbol name. Only valid when primaryDataType==RTSTR&quot;</span>);</p>    <p style="margin: 0px"><span style="color: blue">break</span>;</p>    <p style="margin: 0px"><span style="color: blue">case</span> 3: </p>    <p style="margin: 0px">secondaryInfo =</p>    <p style="margin: 0px"><span style="color: #6f008a">_T</span>(<span style="color: #a31515">&quot;The variable represents area value. Only valid when primaryDataType==RTREAL&quot;</span>);</p>    <p style="margin: 0px"><span style="color: blue">case</span> 4: </p>    <p style="margin: 0px">secondaryInfo =</p>    <p style="margin: 0px"><span style="color: #6f008a">_T</span>(<span style="color: #a31515">&quot;The variable represents distance value. Only valid when primaryDataType==RTREAL&quot;</span>);</p>    <p style="margin: 0px"><span style="color: blue">break</span>;</p>    <p style="margin: 0px"><span style="color: blue">case</span> 5: </p>    <p style="margin: 0px">secondaryInfo =</p>    <p style="margin: 0px"><span style="color: #6f008a">_T</span>(<span style="color: #a31515">&quot;The variable represents an angle value. Only valid when primaryDataType==RTREAL&quot;</span>);</p>    <p style="margin: 0px"><span style="color: blue">break</span>;</p>    <p style="margin: 0px"><span style="color: blue">case</span> 6: </p>    <p style="margin: 0px"><span style="color: blue">if</span>(<span style="color: gray">secondaryType</span> == <span style="color: #2b91af">AcRxVariable</span>::<span style="color: #2f4f4f">kSecondaryTypeUnitlessReal</span>)</p>    <p style="margin: 0px">secondaryInfo =</p>    <p style="margin: 0px"><span style="color: #6f008a">_T</span>(<span style="color: #a31515">&quot;The variable represents a unitless real value. Only valid when primaryDataType==RTREAL&quot;</span>);</p>    <p style="margin: 0px"><span style="color: blue">else</span></p>    <p style="margin: 0px">secondaryInfo =</p>    <p style="margin: 0px"><span style="color: #6f008a">_T</span>(<span style="color: #a31515">&quot;Marks the last item in the enumeration&quot;</span>);</p>    <p style="margin: 0px"><span style="color: blue">break</span>;</p>    <p style="margin: 0px"><span style="color: blue">default</span>:</p>    <p style="margin: 0px"><span style="color: blue">break</span>;</p>    <p style="margin: 0px">}</p>    <p style="margin: 0px"><span style="color: blue">return</span> secondaryInfo;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">}</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><font size="2" face="Arial">System variable information is retrieved on command line:</font></p>    <p style="margin: 0px"><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b7c750be87970b-pi"><img title="SysvarInfo" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="SysvarInfo" src="/assets/image_611052.jpg" width="244" height="169" /></a></p> </div>
