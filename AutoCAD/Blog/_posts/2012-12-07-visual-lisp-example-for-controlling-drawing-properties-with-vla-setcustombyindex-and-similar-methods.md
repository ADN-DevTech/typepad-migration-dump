---
layout: "post"
title: "Visual LISP example for Controlling Drawing Properties with vla-SetCustomByIndex and similar methods"
date: "2012-12-07 06:36:46"
author: "Philippe Leefsma"
categories:
  - "AutoCAD"
  - "LISP"
  - "Philippe Leefsma"
original_url: "https://adndevblog.typepad.com/autocad/2012/12/visual-lisp-example-for-controlling-drawing-properties-with-vla-setcustombyindex-and-similar-methods.html "
typepad_basename: "visual-lisp-example-for-controlling-drawing-properties-with-vla-setcustombyindex-and-similar-methods"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/philippe-leefsma.html" target="_self">Philippe Leefsma</a></p>  <p><b>Q:</b></p>  <p>I need a Visual Lisp example for SetCustomByIndex, SetCustomByKey, GetCustomByIndex and GetCustomByKey.</p>  <p><a name="section2"></a></p>  <p><b>A:</b></p>  <p>Here is an example that adds a custom drawing property. It then changes and gets the values:</p>  <p><span style="line-height: 120%; font-family: &#39;courier new&#39;, courier; font-size: 8pt"><span style="color: #ff0000">(</span><span style="color: #0000ff">defun</span> c:dProps2 <span style="color: #ff0000">(</span><span style="color: #0000ff">/</span> dProps dProp<span style="color: #ff0000">)</span>      <br />&#160;&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">vl-load-com</span><span style="color: #ff0000">)</span>      <br />&#160;&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">setq</span> acadObject <span style="color: #ff0000">(</span><span style="color: #0000ff">vlax-get-acad-object</span><span style="color: #ff0000">)</span><span style="color: #ff0000">)</span>      <br />&#160;&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">setq</span> acadDocument <span style="color: #ff0000">(</span><span style="color: #0000ff">vla-get-ActiveDocument</span> acadObject<span style="color: #ff0000">)</span><span style="color: #ff0000">)</span>      <br />&#160;&#160; <span style="background-color: #e6e6e6; color: #800080">;;Get the SummaryInfo       <br /></span>&#160;&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">setq</span> dProps <span style="color: #ff0000">(</span><span style="color: #0000ff">vlax-get-Property</span> acadDocument 'SummaryInfo<span style="color: #ff0000">)</span><span style="color: #ff0000">)</span>      <br />&#160;&#160; <span style="background-color: #e6e6e6; color: #800080">; comment this vla-addCustomInfo if the entries already exist in       <br /></span>&#160;&#160; <span style="background-color: #e6e6e6; color: #800080">; the drawing properties, <span style="color: #ff0000">(</span>which they will after running this one time<span style="color: #ff0000">)</span>        <br /></span>&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">vla-AddCustomInfo</span> dProps <span style="color: #ff00ff">&quot;wbKey&quot;</span>&#160;<span style="color: #ff00ff">&quot;wbValue&quot;</span><span style="color: #ff0000">)</span>      <br />&#160;&#160; <br />&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">vla-SetCustomByIndex</span> dProps <span style="color: #008000">0</span>&#160;<span style="color: #ff00ff">&quot;wbKey&quot;</span>&#160;<span style="color: #ff00ff">&quot;wbValue2&quot;</span><span style="color: #ff0000">)</span>      <br />&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">vla-setCustomByKey</span> dProps <span style="color: #ff00ff">&quot;wbKey&quot;</span>&#160;<span style="color: #ff00ff">&quot;wbValue3&quot;</span><span style="color: #ff0000">)</span>      <br />&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">vla-getCustomByKey</span> dProps <span style="color: #ff00ff">&quot;wbKey&quot;</span> 'myValue<span style="color: #ff0000">)</span>      <br />&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">vla-getCustomByIndex</span> dProps <span style="color: #008000">0</span> 'myValue1 'myValue2<span style="color: #ff0000">)</span>      <br />&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">princ</span>&#160;<span style="color: #ff0000">(</span><span style="color: #0000ff">strcat</span>&#160;<span style="color: #ff00ff">&quot;wbKey value = &quot;</span> myValue <span style="color: #ff00ff">&quot;\n&quot;</span><span style="color: #ff0000">)</span><span style="color: #ff0000">)</span>      <br />&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">princ</span>&#160;<span style="color: #ff0000">(</span><span style="color: #0000ff">strcat</span>&#160;<span style="color: #ff00ff">&quot;Name = &quot;</span> myValue1 <span style="color: #ff00ff">&quot;\n&quot;</span><span style="color: #ff0000">)</span><span style="color: #ff0000">)</span>      <br />&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">princ</span>&#160;<span style="color: #ff0000">(</span><span style="color: #0000ff">strcat</span>&#160;<span style="color: #ff00ff">&quot;Value = &quot;</span> myValue2 <span style="color: #ff00ff">&quot;\n&quot;</span><span style="color: #ff0000">)</span><span style="color: #ff0000">)</span>      <br />&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">princ</span><span style="color: #ff0000">)</span>&#160; <br /><span style="color: #ff0000">)</span>      <br /></span></p>
