---
layout: "post"
title: "Getting the Midpoint of each Polyline Segment using ObjectARX"
date: "2013-01-07 15:25:26"
author: "Fenton Webb"
categories:
  - "2010"
  - "2011"
  - "2012"
  - "2013"
  - "AutoCAD"
  - "Fenton Webb"
  - "ObjectARX"
original_url: "https://adndevblog.typepad.com/autocad/2013/01/getting-the-midpoint-of-each-polyline-segment-using-objectarx.html "
typepad_basename: "getting-the-midpoint-of-each-polyline-segment-using-objectarx"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/fenton-webb.html">Fenton Webb</a></p>  <p>An AcDbPolyline is derived from AcDbCurve, a curve uses Parameter values to define its geometry. For a Polyline, the Parameter start value is 0 and the end parameter is the total number of vertices â€“1. Those parameter values can be utilized to quickly and easily work out mid points, like this:</p>  <div style="font-family: ; background: white; color: ">   <div style="font-family: ; background: white; color: ">     <div style="font-family: ; background: white; color: ">       <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#010001"><font style="font-size: 8pt">Acad</font></font></span><font style="font-size: 8pt"><font color="#000000">::</font><span style="color: "><font color="#010001">ErrorStatus</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">getMidPointOnEachSegOfCrv</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">AcDbCurve</font></span><font color="#000000"> *</font><span style="color: "><font color="#010001">pCurve</font></span><font color="#000000">)</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">{</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000">(!</font><span style="color: "><font color="#010001">pCurve</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#010001">isKindOf</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">AcDbCurve</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">desc</font></span><font color="#000000">()))</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160; {</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">acutPrintf</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">L</font></span><span style="color: "><font color="#a31515">&quot;\nSelected entity is not a CURVE derived object&quot;</font></span><font color="#000000">);</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">Acad</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">eInvalidInput</font></span><font color="#000000">;</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160; }</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">Acad</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">ErrorStatus</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">es</font></span><font color="#000000">;</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">double</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">startParam</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">endParam</font></span><font color="#000000">;</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// get the start param, usually it starts at 0 or 1</font></span></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">es</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">pCurve</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#010001">getStartParam</font></span><font color="#000000">( </font><span style="color: "><font color="#010001">startParam</font></span><font color="#000000"> );</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">acutPrintf</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">L</font></span><span style="color: "><font color="#a31515">&quot;\nstartParam is %fl&quot;</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">startParam</font></span><font color="#000000">);</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// get the end param, for a polyline it's the total number of</font></span></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// vertex's -1</font></span></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">es</font></span><font color="#000000"> =&#160; </font><span style="color: "><font color="#010001">pCurve</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#010001">getEndParam</font></span><font color="#000000">( </font><span style="color: "><font color="#010001">endParam</font></span><font color="#000000"> );</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">acutPrintf</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">L</font></span><span style="color: "><font color="#a31515">&quot;\nendParam is %fl&quot;</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">endParam</font></span><font color="#000000">);</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// now loop the parameters, adding 1.0 each iteration</font></span></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">for</font></span><font color="#000000">(</font><span style="color: "><font color="#0000ff">double</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">i</font></span><font color="#000000">=</font><span style="color: "><font color="#010001">startParam</font></span><font color="#000000">; </font><span style="color: "><font color="#010001">i</font></span><font color="#000000">&lt;=</font><span style="color: "><font color="#010001">endParam</font></span><font color="#000000">; ++</font><span style="color: "><font color="#010001">i</font></span><font color="#000000">)</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160; {</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">AcGePoint3d</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">pt</font></span><font color="#000000">;</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">es</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">pCurve</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#010001">getPointAtParam</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">i</font></span><font color="#000000">+.5, </font><span style="color: "><font color="#010001">pt</font></span><font color="#000000">);</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">es</font></span><font color="#000000"> == </font><span style="color: "><font color="#010001">Acad</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">eOk</font></span><font color="#000000">)</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">acutPrintf</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">L</font></span><span style="color: "><font color="#a31515">&quot;\n%f,%f,%f&quot;</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">pt</font></span><font color="#000000">[0], </font><span style="color: "><font color="#010001">pt</font></span><font color="#000000">[1], </font><span style="color: "><font color="#010001">pt</font></span><font color="#000000">[2]);</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160; }</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">Acad</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">eOk</font></span><font color="#000000">;</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">}</font></font></p>     </div>   </div> </div>
