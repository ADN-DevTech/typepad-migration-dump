---
layout: "post"
title: "Autoloader &ndash; The StartupCommand parameter"
date: "2012-04-19 15:22:59"
author: "Madhukar Moogala"
categories:
  - "2013"
  - "AutoCAD"
  - "Stephen Preston"
original_url: "https://adndevblog.typepad.com/autocad/2012/04/autoloader-the-startupcommand-parameter.html "
typepad_basename: "autoloader-the-startupcommand-parameter"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/stephen-preston.html" target="_self">Stephen Preston</a></p>  <p>Autoloader was added in AutoCAD 2012 to simplify the deployment of AutoCAD plug-ins, and is extensively used by apps in the <a href="http://apps.exchange.autodesk.com" target="_blank">Autodesk Exchange Store</a>. (You’ll find several articles about the general Autoloader features <a href="https://www.google.com/search?q=autoloader&amp;domains=through-the-interface.typepad.com&amp;sitesearch=through-the-interface.typepad.com" target="_blank">on Kean’s blog</a>).</p>  <p>We introduced <a href="http://through-the-interface.typepad.com/through_the_interface/2012/03/more-api-features-in-autocad-2013.html" target="_blank">a few enhancements to Autoloader in AutoCAD 2013</a>. One of which was the StartupCommand parameter. Use this if you have a plug-in that loads on AutoCAD startup and you want it to run a command as soon as its loaded. The benefit of using a StartupCommand is that the entire AutoCAD UI should be loaded when the command runs - which isn’t always the case when you run initialization code by implementing IExtensionApplication.Initialize in your plug-in.</p>  <p>Here is a Components section from an Autoloader PackageContents.xml that causes a command called RunMeFirst to be invoked at startup for AutoCAD 2013 or any AutoCAD 2013 vertical:</p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160; &lt;</span><span style="line-height: 140%; color: #a31515">Components</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">RuntimeRequirements</span><span style="line-height: 140%; color: blue"> </span><span style="line-height: 140%; color: red">OS</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">Win64|Win32</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue"> </span><span style="line-height: 140%; color: red">Platform</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">AutoCAD*</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue"> </span><span style="line-height: 140%; color: red">SeriesMin</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">R19.0</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue"> </span><span style="line-height: 140%; color: red">SeriesMax</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">R19.0</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue"> /&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">ComponentEntry</span><span style="line-height: 140%; color: blue"> </span><span style="line-height: 140%; color: red">AppName</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">ADN_StartupCommandTest</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue"> </span><span style="line-height: 140%; color: red">ModuleName</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">.\Contents\SimpleTest.dll</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">Commands</span><span style="line-height: 140%; color: blue"> </span><span style="line-height: 140%; color: red">GroupName</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">ADN_StartupCommandTest</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;</span><span style="line-height: 140%; color: #a31515">Command</span><span style="line-height: 140%; color: blue"> </span><span style="line-height: 140%; color: red">Local</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">RunMeFirst</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue"> </span><span style="line-height: 140%; color: red">Global</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">RunMeFirst</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue"> </span><span style="line-height: 140%; color: red">StartupCommand</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">True</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue"> /&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160;&#160;&#160; &lt;/</span><span style="line-height: 140%; color: #a31515">Commands</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;&#160;&#160; &lt;/</span><span style="line-height: 140%; color: #a31515">ComponentEntry</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160; &lt;/</span><span style="line-height: 140%; color: #a31515">Components</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px">&#160;</p> </div>  <p>To try this, download the sample bundle <a href="http://adndevblog.typepad.com/autocad/Downloads/ADN%20StartupCommandTest.bundle.zip" target="_blank">from here</a> and unzip it into your %appdata%\Autodesk\ApplicationPlugins folder. The next time you launch AutoCAD 2013, it will run the command – which simply prints “Hello World” to the command line. (Note that the sample DLL is built for AutoCAD 2013, and the PackageContents.xml restricts loading to AutoCAD 2013 only – this is because StartupCommand was only introduced in the 2013 release).</p>
