---
layout: "post"
title: "Obtaining the Class type from an ObjectId (not having to open for read)"
date: "2012-08-13 16:56:44"
author: "Fenton Webb"
categories:
  - ".NET"
  - "2010"
  - "2011"
  - "2012"
  - "2013"
  - "AutoCAD"
  - "Fenton Webb"
original_url: "https://adndevblog.typepad.com/autocad/2012/08/obtaining-the-class-type-from-an-objectid-not-having-to-open-for-read.html "
typepad_basename: "obtaining-the-class-type-from-an-objectid-not-having-to-open-for-read"
typepad_status: "Publish"
---

<p>by <a href="http://adndevblog.typepad.com/autocad/fenton-webb.html">Fenton Webb</a></p>  <p>I’m sure you have all seen code like this before, where you open an entity in the DWG database to find out its type…</p>  <p style="line-height: normal; margin: 0px"><font face="Courier New"><span><font color="#2b91af"><font style="font-size: 8pt">Database</font></font></span><font color="#000000"><font style="font-size: 8pt"> db = </font></font></font></p>  <p style="line-height: normal; margin: 0px"><font face="Courier New"><font color="#000000"></font><span><font color="#2b91af"><font style="font-size: 8pt">Application</font></font></span><font color="#000000"><font style="font-size: 8pt">.DocumentManager.MdiActiveDocument.Database;</font></font></font></p>  <p style="line-height: normal; margin: 0px"><font face="Courier New"><font color="#000000"></font><span><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><font style="font-size: 8pt"><font color="#000000"> (</font><span><font color="#2b91af">Transaction</font></span></font><font color="#000000"><font style="font-size: 8pt"> trans = </font></font></font><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">db.TransactionManager.StartTransaction())</font></font></font></p>  <p style="line-height: normal; margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">{</font></font></font></p>  <p style="line-height: normal; margin: 0px"><font face="Courier New"><font color="#000000"></font><span><font color="#008000"><font style="font-size: 8pt">&#160; // open the entities</font></font></span></font></p>  <p style="line-height: normal; margin: 0px"><font face="Courier New"><font color="#000000"></font><span><font color="#2b91af"><font style="font-size: 8pt">&#160; Entity</font></font></span><font style="font-size: 8pt"><font color="#000000"> ent1 = (</font><span><font color="#2b91af">Entity</font></span><font color="#000000">)trans.GetObject(id1, </font><span><font color="#2b91af">OpenMode</font></span></font><font color="#000000"><font style="font-size: 8pt">.ForRead);</font></font></font></p>  <p style="line-height: normal; margin: 0px"><font face="Courier New"><font color="#000000"></font><span><font color="#2b91af"><font style="font-size: 8pt">&#160; Entity</font></font></span><font style="font-size: 8pt"><font color="#000000"> ent2 = (</font><span><font color="#2b91af">Entity</font></span><font color="#000000">)trans.GetObject(id2, </font><span><font color="#2b91af">OpenMode</font></span></font><font color="#000000"><font style="font-size: 8pt">.ForRead);</font></font></font></p> <font color="#000000" face="Courier New">   <p style="line-height: normal; margin: 0px"><font face="Courier New"><font color="#000000"></font><span><font color="#008000"><font style="font-size: 8pt">&#160; // find their type</font></font></span></font></p>    <p style="line-height: normal; margin: 0px"><font color="#008000" face="Courier New"><span>&#160; </span></font></p>   <font face="Courier New"><span><font color="#2b91af"><font style="font-size: 8pt">Type</font></font></span><font color="#000000"><font style="font-size: 8pt"> entType1 = ent1.GetType();</font></font></font></font>  <p style="line-height: normal; margin: 0px"><font face="Courier New"><font color="#000000"></font><span><font color="#2b91af"><font style="font-size: 8pt">&#160; Type</font></font></span><font color="#000000"><font style="font-size: 8pt"> entType2 = ent2.GetType();</font></font></font></p>  <p style="line-height: normal; margin: 0px"><font face="Courier New"><font color="#000000"></font></font></p>  <p style="line-height: normal; margin: 0px"><font face="Courier New"><font color="#000000"></font><span><font color="#008000"><font style="font-size: 8pt">&#160; // the two entities should be the same type</font></font></span></font></p>  <p style="line-height: normal; margin: 0px"><font face="Courier New"><font color="#000000"></font><span><font color="#0000ff"><font style="font-size: 8pt">&#160; if</font></font></span><font style="font-size: 8pt"><font color="#000000"> (!entType1.Equals(entType2)) </font></font></font></p>  <p style="line-height: normal; margin: 0px"><font face="Courier New"><font style="font-size: 8pt"><font color="#000000">&#160;&#160;&#160; </font><span><font color="#0000ff">return</font></span></font><font color="#000000"><font style="font-size: 8pt">;</font></font></font></p>  <p style="line-height: normal; margin: 0px"><font color="#000000" face="Courier New">&#160; <font color="#008000">// …</font></font></p>  <p>There’s a much more efficient way to obtain the class name/entity type… That’s using <strong>ObjectId.ObjectClass</strong> property. </p>  <p>Using this property saves you opening an object for read, thus saving valuable CPU cycles.</p>  <p>e.g.</p> <font face="Courier New"><span><font color="#2b91af"><font style="font-size: 8pt">         <p style="line-height: normal; margin: 0px"><font face="Courier New"><font color="#000000"></font><span><font color="#008000"><font style="font-size: 8pt">// the two entities should be the same type</font></font></span></font></p>          <p style="line-height: normal; margin: 0px"><font face="Courier New"><font color="#000000"></font><span><font color="#0000ff"><font style="font-size: 8pt">if</font></font></span><font style="font-size: 8pt"><font color="#000000"> (id1.ObjectClass.Name != id2.ObjectClass.Name)) </font></font></font></p>          <p style="line-height: normal; margin: 0px"><font face="Courier New"><font style="font-size: 8pt"><font color="#000000">&#160; </font><span><font color="#0000ff">return</font></span></font><font color="#000000"><font style="font-size: 8pt">;</font></font></font></p>          <p style="line-height: normal; margin: 0px"><font color="#000000"></font></p>       </font></font></span></font>  <p style="line-height: normal; margin: 0px"><font face="Courier New"><span><font color="#2b91af"><font style="font-size: 8pt">Database</font></font></span><font color="#000000"><font style="font-size: 8pt"> db = </font></font></font></p>  <p style="line-height: normal; margin: 0px"><font face="Courier New"><font color="#000000"></font><span><font color="#2b91af"><font style="font-size: 8pt">Application</font></font></span><font color="#000000"><font style="font-size: 8pt">.DocumentManager.MdiActiveDocument.Database;</font></font></font></p>  <p style="line-height: normal; margin: 0px"><font face="Courier New"><font color="#000000"></font><span><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><font style="font-size: 8pt"><font color="#000000"> (</font><span><font color="#2b91af">Transaction</font></span></font><font color="#000000"><font style="font-size: 8pt"> trans = </font></font></font><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">db.TransactionManager.StartTransaction())</font></font></font></p>  <p style="line-height: normal; margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">{</font></font></font></p>  <p style="line-height: normal; margin: 0px"><font face="Courier New"><font color="#000000"></font><span><font color="#008000"><font style="font-size: 8pt">// open the entities</font></font></span></font></p>  <p style="line-height: normal; margin: 0px"><font face="Courier New"><font color="#000000"></font><span><font color="#2b91af"><font style="font-size: 8pt">Entity</font></font></span><font style="font-size: 8pt"><font color="#000000"> ent1 = (</font><span><font color="#2b91af">Entity</font></span><font color="#000000">)trans.GetObject(id1, </font><span><font color="#2b91af">OpenMode</font></span></font><font color="#000000"><font style="font-size: 8pt">.ForRead);</font></font></font></p>  <p style="line-height: normal; margin: 0px"><font face="Courier New"><font color="#000000"></font><span><font color="#2b91af"><font style="font-size: 8pt">Entity</font></font></span><font style="font-size: 8pt"><font color="#000000"> ent2 = (</font><span><font color="#2b91af">Entity</font></span><font color="#000000">)trans.GetObject(id2, </font><span><font color="#2b91af">OpenMode</font></span></font><font color="#000000"><font style="font-size: 8pt">.ForRead);</font></font></font></p>  <p style="line-height: normal; margin: 0px"><font color="#000000" face="Courier New"><font color="#008000">// …</font></font></p>  <p style="line-height: normal; margin: 0px"><font color="#008000" face="Courier New"></font></p>
