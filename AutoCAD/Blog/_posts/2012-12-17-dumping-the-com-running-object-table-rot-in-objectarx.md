---
layout: "post"
title: "Dumping the COM Running Object Table (ROT) in ObjectARX"
date: "2012-12-17 16:03:33"
author: "Fenton Webb"
categories:
  - "2010"
  - "2011"
  - "2012"
  - "2013"
  - "ActiveX"
  - "AutoCAD"
  - "Fenton Webb"
  - "ObjectARX"
original_url: "https://adndevblog.typepad.com/autocad/2012/12/dumping-the-com-running-object-table-rot-in-objectarx.html "
typepad_basename: "dumping-the-com-running-object-table-rot-in-objectarx"
typepad_status: "Publish"
---

<p>by <a href="http://adndevblog.typepad.com/autocad/fenton-webb.html">Fenton Webb</a></p>  <p><b>Issue</b></p>  <p>How can I inspect the running Automation servers on my computer? I'd like to retrieve Automation objects with GetObject in Visual Basic.</p>  <p><a name="section2"></a></p>  <p><b>Solution</b></p>  <p>The following code is a simple console application that dumps the contents of the Running Object Table. Use the AdskPlainCOMDocSamp in the ObjectARX SDK to test itâ€¦</p>  <p>&#160;</p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">#include</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#a31515">&lt;comdef.h&gt;</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">#include</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#a31515">&lt;objbase.h&gt;</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">#include</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#a31515">&lt;iostream&gt;</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#0000ff">namespace</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">std</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#010001"><font style="font-size: 8pt">_COM_SMARTPTR_TYPEDEF</font></font></span><font style="font-size: 8pt"><font color="#000000">(</font><span style="color: "><font color="#010001">IRunningObjectTable</font></span><font color="#000000">, </font><span style="color: "><font color="#0000ff">__uuidof</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">IRunningObjectTable</font></span><font color="#000000">));</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#010001"><font style="font-size: 8pt">_COM_SMARTPTR_TYPEDEF</font></font></span><font style="font-size: 8pt"><font color="#000000">(</font><span style="color: "><font color="#010001">IEnumMoniker</font></span><font color="#000000">, </font><span style="color: "><font color="#0000ff">__uuidof</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">IEnumMoniker</font></span><font color="#000000">));</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#010001"><font style="font-size: 8pt">_COM_SMARTPTR_TYPEDEF</font></font></span><font style="font-size: 8pt"><font color="#000000">(</font><span style="color: "><font color="#010001">IMoniker</font></span><font color="#000000">, </font><span style="color: "><font color="#0000ff">__uuidof</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">IMoniker</font></span><font color="#000000">));</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#010001"><font style="font-size: 8pt">_COM_SMARTPTR_TYPEDEF</font></font></span><font style="font-size: 8pt"><font color="#000000">(</font><span style="color: "><font color="#010001">IBindCtx</font></span><font color="#000000">, </font><span style="color: "><font color="#0000ff">__uuidof</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">IBindCtx</font></span><font color="#000000">));</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">class</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#010001">SimpleException</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">{</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">const</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">WCHAR</font></span><font color="#000000">* </font><span style="color: "><font color="#010001">m_strDisc</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">HRESULT</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">m_hr</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">public</font></font></span><font style="font-size: 8pt" color="#000000">:</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">SimpleException</font></span><font color="#000000">(</font><span style="color: "><font color="#0000ff">const</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">WCHAR</font></span><font color="#000000">* </font><span style="color: "><font color="#010001">strDisc</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">NULL</font></span><font color="#000000">,</font><span style="color: "><font color="#010001">HRESULT</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">hr</font></span><font color="#000000">=</font><span style="color: "><font color="#010001">S_OK</font></span><font color="#000000">):</font><span style="color: "><font color="#010001">m_strDisc</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">strDisc</font></span><font color="#000000">),</font><span style="color: "><font color="#010001">m_hr</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">hr</font></span><font color="#000000">) {}</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">wostream</font></span><font color="#000000">&amp; </font><span style="color: "><font color="#010001">reportIt</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">wostream</font></span><font color="#000000">&amp; </font><span style="color: "><font color="#010001">out</font></span><font color="#000000">)</font><span style="color: "><font color="#0000ff">const</font></span><font color="#000000"> {</font><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">out</font></span><font color="#000000"> &lt;&lt; </font><span style="color: "><font color="#010001">m_strDisc</font></span><font color="#000000"> &lt;&lt; </font><span style="color: "><font color="#010001">L</font></span><span style="color: "><font color="#a31515">&quot; HRESULT=&quot;</font></span><font color="#000000"> &lt;&lt; </font><span style="color: "><font color="#010001">m_hr</font></span><font color="#000000">;}</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">};</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">#define</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#010001">RETRIEVE_AT_ONCE</font></span><font color="#000000"> 10</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">void</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#010001">main</font></span><font color="#000000">()</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">{</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">CoInitialize</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">NULL</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">try</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160; {</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">IRunningObjectTablePtr</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">pROT</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">HRESULT</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">hr</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">FAILED</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">hr</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">GetRunningObjectTable</font></span><font color="#000000">(0,&amp;</font><span style="color: "><font color="#010001">pROT</font></span><font color="#000000">)))</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">throw</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">SimpleException</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">L</font></span><span style="color: "><font color="#a31515">&quot;GetRunningObjectTable&quot;</font></span><font color="#000000">,</font><span style="color: "><font color="#010001">hr</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">IEnumMonikerPtr</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">pEnum</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">FAILED</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">hr</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">pROT</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#010001">EnumRunning</font></span><font color="#000000">(&amp;</font><span style="color: "><font color="#010001">pEnum</font></span><font color="#000000">)))</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">throw</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">SimpleException</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">L</font></span><span style="color: "><font color="#a31515">&quot;EnumRunning on IRunningObjectTable&quot;</font></span><font color="#000000">,</font><span style="color: "><font color="#010001">hr</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">IMoniker</font></span><font color="#000000">* </font><span style="color: "><font color="#010001">elems</font></span><font color="#000000">[</font><span style="color: "><font color="#010001">RETRIEVE_AT_ONCE</font></span><font color="#000000">];</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">LPOLESTR</font></span><font color="#000000">&#160; </font><span style="color: "><font color="#010001">pbstrName</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">unsigned</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">long</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">fetched</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">IBindCtxPtr</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">pBndCtx</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">FAILED</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">hr</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">CreateBindCtx</font></span><font color="#000000">(0,&amp;</font><span style="color: "><font color="#010001">pBndCtx</font></span><font color="#000000">)))</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">throw</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">SimpleException</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">L</font></span><span style="color: "><font color="#a31515">&quot;CreateBindCtx&quot;</font></span><font color="#000000">,</font><span style="color: "><font color="#010001">hr</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">while</font></span><font color="#000000"> (</font><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">FAILED</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">hr</font></span><font color="#000000">=</font><span style="color: "><font color="#010001">pEnum</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#010001">Next</font></span><font color="#000000">( </font><span style="color: "><font color="#010001">RETRIEVE_AT_ONCE</font></span><font color="#000000">,</font><span style="color: "><font color="#010001">elems</font></span><font color="#000000">,&amp;</font><span style="color: "><font color="#010001">fetched</font></span><font color="#000000">)))</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">throw</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">SimpleException</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">L</font></span><span style="color: "><font color="#a31515">&quot;Next on IEnumMoniker&quot;</font></span><font color="#000000">,</font><span style="color: "><font color="#010001">hr</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">for</font></span><font color="#000000"> (</font><span style="color: "><font color="#0000ff">unsigned</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">long</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">i</font></span><font color="#000000">=0;</font><span style="color: "><font color="#010001">i</font></span><font color="#000000">&lt;</font><span style="color: "><font color="#010001">fetched</font></span><font color="#000000">;</font><span style="color: "><font color="#010001">i</font></span><font color="#000000">++){</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">FAILED</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">hr</font></span><font color="#000000">=</font><span style="color: "><font color="#010001">elems</font></span><font color="#000000">[</font><span style="color: "><font color="#010001">i</font></span><font color="#000000">]-&gt;</font><span style="color: "><font color="#010001">GetDisplayName</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">pBndCtx</font></span><font color="#000000">,</font><span style="color: "><font color="#010001">NULL</font></span><font color="#000000">,&amp;</font><span style="color: "><font color="#010001">pbstrName</font></span><font color="#000000">))){</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">wcout</font></span><font color="#000000"> &lt;&lt; </font><span style="color: "><font color="#010001">L</font></span><span style="color: "><font color="#a31515">&quot;GetDisplayName failed. hr=&quot;</font></span><font color="#000000"> &lt;&lt; </font><span style="color: "><font color="#010001">hr</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">elems</font></span><font color="#000000">[</font><span style="color: "><font color="#010001">i</font></span><font color="#000000">]-&gt;</font><span style="color: "><font color="#010001">Release</font></span><font color="#000000">();</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">continue</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">elems</font></span><font color="#000000">[</font><span style="color: "><font color="#010001">i</font></span><font color="#000000">]-&gt;</font><span style="color: "><font color="#010001">Release</font></span><font color="#000000">();</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">wcout</font></span><font color="#000000"> &lt;&lt; </font><span style="color: "><font color="#010001">L</font></span><span style="color: "><font color="#a31515">&quot;Name = &quot;</font></span><font color="#000000"> &lt;&lt; </font><span style="color: "><font color="#010001">pbstrName</font></span><font color="#000000"> &lt;&lt; </font><span style="color: "><font color="#010001">endl</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">CoTaskMemFree</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">pbstrName</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; }</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">fetched</font></span><font color="#000000"> &lt; </font><span style="color: "><font color="#010001">RETRIEVE_AT_ONCE</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">break</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160; }</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">catch</font></span><font color="#000000"> (</font><span style="color: "><font color="#0000ff">const</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">SimpleException</font></span><font color="#000000">&amp; </font><span style="color: "><font color="#010001">exc</font></span><font color="#000000">){</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">wcout</font></span><font color="#000000"> &lt;&lt; </font><span style="color: "><font color="#010001">L</font></span><span style="color: "><font color="#a31515">&quot;Error in function: &quot;</font></span><font color="#000000">; </font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">exc</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">reportIt</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">wcout</font></span><font color="#000000">); </font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">wcout</font></span><font color="#000000"> &lt;&lt; </font><span style="color: "><font color="#010001">endl</font></span><font color="#000000"> &lt;&lt; </font><span style="color: "><font color="#010001">L</font></span><span style="color: "><font color="#a31515">&quot;Aborting.&quot;</font></span><font color="#000000"> &lt;&lt; </font><span style="color: "><font color="#010001">endl</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160; }</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">CoUninitialize</font></span><font color="#000000">();</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">}</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p> </div>
