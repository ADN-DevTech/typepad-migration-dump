---
layout: "post"
title: "Non-COM property with list of possible values"
date: "2012-04-26 11:44:25"
author: "Adam Nagy"
categories:
  - "2013"
  - "Adam Nagy"
  - "AutoCAD"
  - "ObjectARX"
original_url: "https://adndevblog.typepad.com/autocad/2012/04/non-com-property-with-list-of-possible-values.html "
typepad_basename: "non-com-property-with-list-of-possible-values"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/adam-nagy.html" target="_self">Adam Nagy</a></p>  <p>In the Property palette you can find properties which only accept values that are listed for the property. If you want to create such a property then you could do that by creating a new enum type and use that to create a new AcRxValueType that implements IAcRxEnumeration </p>  <p><b>Header file</b></p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%; color: green">/////////////////////////////////////////////////////////////////////</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">// MyEnumType ///////////////////////////////////////////////////////</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">/////////////////////////////////////////////////////////////////////</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">typedef</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">enum</span><span style="line-height: 140%"> {} MyEnum;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">template</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: blue">typename</span><span style="line-height: 140%"> ValueType&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">class</span><span style="line-height: 140%"> MyValueTypeTemplate : </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> AcRxValueType</span></p>    <p style="margin: 0px"><span style="line-height: 140%">{</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%">:</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; MyValueTypeTemplate(</span><span style="line-height: 140%; color: blue">const</span><span style="line-height: 140%"> ACHAR* name, </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">const</span><span style="line-height: 140%"> IAcRxEnumeration&amp; pEnum, </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; AcRxMemberCollectionConstructorPtr memberConstruct, </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%">* userData = NULL):</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; AcRxValueType(name,pEnum, </span><span style="line-height: 140%; color: blue">sizeof</span><span style="line-height: 140%">(ValueType), </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; memberConstruct, userData) {}</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">virtual</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">int</span><span style="line-height: 140%"> subToString(</span><span style="line-height: 140%; color: blue">const</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%">* instance, ACHAR* buffer, </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; size_t sizeInACHARs, AcRxValueType::StringFormat format) </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">const</span><span style="line-height: 140%"> ADESK_OVERRIDE;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">virtual</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">bool</span><span style="line-height: 140%"> subEqualTo(</span><span style="line-height: 140%; color: blue">const</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%">* a, </span><span style="line-height: 140%; color: blue">const</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%">* b) </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">const</span><span style="line-height: 140%"> ADESK_OVERRIDE;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">};</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">template</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: blue">typename</span><span style="line-height: 140%"> ValueType&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">class</span><span style="line-height: 140%"> MyEnumTypeTemplate : </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> MyValueTypeTemplate&lt;ValueType&gt;, </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> IAcRxEnumeration</span></p>    <p style="margin: 0px"><span style="line-height: 140%">{</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; AcArray&lt;</span><span style="line-height: 140%; color: blue">const</span><span style="line-height: 140%"> AcRxEnumTag*&gt; m_tags;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%">:</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; MyEnumTypeTemplate(</span><span style="line-height: 140%; color: blue">const</span><span style="line-height: 140%"> ACHAR* name, </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; AcRxMemberCollectionConstructorPtr memberConstruct, </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%">* userData = NULL): </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; MyValueTypeTemplate&lt;ValueType&gt;(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; name,*</span><span style="line-height: 140%; color: blue">this</span><span style="line-height: 140%">, memberConstruct, userData) {}</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; ~MyEnumTypeTemplate()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">for</span><span style="line-height: 140%"> (</span><span style="line-height: 140%; color: blue">int</span><span style="line-height: 140%"> i=m_tags.length()-1;i&gt;=0;i--)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; AcRxMember::deleteMember(m_tags[i]);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">virtual</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">int</span><span style="line-height: 140%"> count() </span><span style="line-height: 140%; color: blue">const</span><span style="line-height: 140%"> ADESK_OVERRIDE</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> m_tags.length();</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">virtual</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">const</span><span style="line-height: 140%"> AcRxEnumTag&amp; getAt(</span><span style="line-height: 140%; color: blue">int</span><span style="line-height: 140%"> i) </span><span style="line-height: 140%; color: blue">const</span><span style="line-height: 140%"> ADESK_OVERRIDE</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> *m_tags[i];</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> append(AcRxEnumTag&amp; tag)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; m_tags.append(&amp;tag);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> acdbImpSetOwnerForEnumTag(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">const</span><span style="line-height: 140%"> AcRxClass*, AcRxEnumTag*);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; acdbImpSetOwnerForEnumTag(</span><span style="line-height: 140%; color: blue">this</span><span style="line-height: 140%">, &amp;tag);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">};</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">/////////////////////////////////////////////////////////////////////</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">// MyListProperty ///////////////////////////////////////////////////</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">/////////////////////////////////////////////////////////////////////</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">class</span><span style="line-height: 140%"> MyListProperty : </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> AcRxProperty&#160; </span></p>    <p style="margin: 0px"><span style="line-height: 140%">{</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%">:</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">static</span><span style="line-height: 140%"> AcRxObject * makeMyListProperty();</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">static</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">const</span><span style="line-height: 140%"> ACHAR * kCategoryName;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">static</span><span style="line-height: 140%"> AcRxCategory * category;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; MyListProperty();</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">virtual</span><span style="line-height: 140%"> ~MyListProperty();</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">virtual</span><span style="line-height: 140%"> Acad::ErrorStatus subGetValue(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">const</span><span style="line-height: 140%"> AcRxObject* pO, AcRxValue&amp; value) </span><span style="line-height: 140%; color: blue">const</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">virtual</span><span style="line-height: 140%"> Acad::ErrorStatus subSetValue(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; AcRxObject* pO, </span><span style="line-height: 140%; color: blue">const</span><span style="line-height: 140%"> AcRxValue&amp; value) </span><span style="line-height: 140%; color: blue">const</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">};</span></p>    <p style="margin: 0px">&#160;</p> </div>  <p><b>C++ file</b></p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%; color: green">/////////////////////////////////////////////////////////////////////</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">// MyEnumType ///////////////////////////////////////////////////////</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">/////////////////////////////////////////////////////////////////////</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> makeMyEnumTypeTemplateProperties(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">class</span><span style="line-height: 140%"> AcRxMemberCollectionBuilder &amp; collectionBuilder, </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%">*);</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">template</span><span style="line-height: 140%">&lt;&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">int</span><span style="line-height: 140%"> MyEnumTypeTemplate&lt;MyEnum&gt;::subToString(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">const</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> *instance, ACHAR *buffer, size_t sizeInACHARs, </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; AcRxValueType::StringFormat format) </span><span style="line-height: 140%; color: blue">const</span></p>    <p style="margin: 0px"><span style="line-height: 140%">{</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">const</span><span style="line-height: 140%"> ACHAR* formatString = L</span><span style="line-height: 140%; color: #a31515">&quot;%d&quot;</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; MyEnum &amp; value = *(MyEnum*)instance;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (buffer==NULL)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> _scwprintf(formatString,value);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> swprintf_s(buffer,sizeInACHARs,formatString,value);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">}</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">template</span><span style="line-height: 140%">&lt;&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">bool</span><span style="line-height: 140%"> MyEnumTypeTemplate&lt;MyEnum&gt;::subEqualTo(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">const</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> *a, </span><span style="line-height: 140%; color: blue">const</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%">* b) </span><span style="line-height: 140%; color: blue">const</span></p>    <p style="margin: 0px"><span style="line-height: 140%">{</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; MyEnum &amp; v1 = *(MyEnum*)a;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; MyEnum &amp; v2 = *(MyEnum*)b;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> v1==v2;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">}</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">template</span><span style="line-height: 140%">&lt;&gt; </span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">struct</span><span style="line-height: 140%"> AcRxValueType::Desc&lt; MyEnum &gt; </span></p>    <p style="margin: 0px"><span style="line-height: 140%">{</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">__declspec</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: blue">dllexport</span><span style="line-height: 140%">) </span><span style="line-height: 140%; color: blue">static</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">const</span><span style="line-height: 140%"> AcRxValueType&amp; value() </span><span style="line-height: 140%; color: blue">throw</span><span style="line-height: 140%">();</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">static</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> del();</span></p>    <p style="margin: 0px"><span style="line-height: 140%">};</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">MyEnumTypeTemplate&lt;MyEnum&gt;* s_pMyEnumTypeTemplate = NULL;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">const</span><span style="line-height: 140%"> AcRxValueType&amp; AcRxValueType::Desc&lt; MyEnum &gt;::value() </span><span style="line-height: 140%; color: blue">throw</span><span style="line-height: 140%">()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">{</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (s_pMyEnumTypeTemplate==NULL)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; s_pMyEnumTypeTemplate = </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> MyEnumTypeTemplate&lt;MyEnum&gt;(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; L</span><span style="line-height: 140%; color: #a31515">&quot;MyEnumProperties&quot;</span><span style="line-height: 140%">,&amp;makeMyEnumTypeTemplateProperties);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; AcRxEnumTag* pTag;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; pTag = </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%">&#160; AcRxEnumTag&#160; (L</span><span style="line-height: 140%; color: #a31515">&quot;One&quot;</span><span style="line-height: 140%">, (</span><span style="line-height: 140%; color: blue">int</span><span style="line-height: 140%">)0);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; s_pMyEnumTypeTemplate-&gt;append(*pTag);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; pTag = </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%">&#160; AcRxEnumTag&#160; (L</span><span style="line-height: 140%; color: #a31515">&quot;Two&quot;</span><span style="line-height: 140%">, (</span><span style="line-height: 140%; color: blue">int</span><span style="line-height: 140%">)1);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; s_pMyEnumTypeTemplate-&gt;append(*pTag);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; pTag = </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%">&#160; AcRxEnumTag&#160; (L</span><span style="line-height: 140%; color: #a31515">&quot;Three&quot;</span><span style="line-height: 140%">, (</span><span style="line-height: 140%; color: blue">int</span><span style="line-height: 140%">)2);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; s_pMyEnumTypeTemplate-&gt;append(*pTag);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; pTag = </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%">&#160; AcRxEnumTag&#160; (L</span><span style="line-height: 140%; color: #a31515">&quot;Four&quot;</span><span style="line-height: 140%">, (</span><span style="line-height: 140%; color: blue">int</span><span style="line-height: 140%">)3);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; s_pMyEnumTypeTemplate-&gt;append(*pTag);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> *s_pMyEnumTypeTemplate;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">};</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">// This should be called when the value type is not needed anymore</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">// Best call it when the module gets unloaded (On_kUnloadAppMsg)</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> AcRxValueType::Desc&lt; MyEnum &gt;::del()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">{</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (s_pMyEnumTypeTemplate)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">const</span><span style="line-height: 140%"> ACHAR * name = s_pMyEnumTypeTemplate-&gt;name();</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (acrxSysRegistry())</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; acrxClassDictionary-&gt;remove(s_pMyEnumTypeTemplate-&gt;name());</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; s_pMyEnumTypeTemplate = NULL;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">};</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> makeMyEnumTypeTemplateProperties(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">class</span><span style="line-height: 140%"> AcRxMemberCollectionBuilder &amp; collectionBuilder, </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%">*)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">{</span></p>    <p style="margin: 0px"><span style="line-height: 140%">}</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">/////////////////////////////////////////////////////////////////////</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">// MyListProperty ///////////////////////////////////////////////////</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">/////////////////////////////////////////////////////////////////////</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">const</span><span style="line-height: 140%"> ACHAR * MyListProperty::kCategoryName = _T(</span><span style="line-height: 140%; color: #a31515">&quot;My Category&quot;</span><span style="line-height: 140%">); </span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">AcRxCategory * MyListProperty::category = NULL;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">MyListProperty::MyListProperty() : </span></p>    <p style="margin: 0px"><span style="line-height: 140%">AcRxProperty(_T(</span><span style="line-height: 140%; color: #a31515">&quot;My List Property&quot;</span><span style="line-height: 140%">), </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; AcRxValueType::Desc&lt; MyEnum &gt;::value())</span></p>    <p style="margin: 0px"><span style="line-height: 140%">{</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (category == NULL)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; AcRxCategory * parent =&#160; AcRxCategory::rootCategory();</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; category = parent-&gt;findDescendant(kCategoryName); </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (category == NULL)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; category = </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> AcRxCategory(kCategoryName, parent); </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: green">// OPM = Object Property Manager / Property Palette</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: green">// Add the Placement attribute to set under which category in </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: green">// the OPM the property will be shown </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; attributes().add(</span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> AcRxUiPlacementAttribute(kCategoryName, 0));</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: green">// Add this attribute so that AutoCAD will automatically create </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: green">// the COM wrapper for this property, i.e. it will be visible </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: green">// in OPM</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; attributes().add(</span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> AcRxGenerateDynamicPropertiesAttribute());</span></p>    <p style="margin: 0px"></p>    <p style="margin: 0px"><span style="line-height: 140%"></span></p>   <span style="line-height: 140%">}</span>     <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">MyListProperty::~MyListProperty()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">{</span></p>    <p style="margin: 0px"><span style="line-height: 140%">}</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">/// </span><span style="line-height: 140%; color: gray">&lt;summary&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">/// This is called by the system to get the property value for </span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">/// a specific object</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">/// </span><span style="line-height: 140%; color: gray">&lt;/summary&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">Acad::ErrorStatus MyListProperty::subGetValue(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">const</span><span style="line-height: 140%"> AcRxObject* pO, AcRxValue&amp; value) </span><span style="line-height: 140%; color: blue">const</span></p>    <p style="margin: 0px"><span style="line-height: 140%">{</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; AcDbEntity * ent = AcDbEntity::cast(pO);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (ent == NULL)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> Acad::eNotThatKindOfClass; </span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: green">// Get the value from the custom entity</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: green">// or wherever we stored the value</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; AEN1MyCircle * pMyCircle = AEN1MyCircle::cast(pO);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; value = AcRxValue(</span><span style="line-height: 140%; color: blue">static_cast</span><span style="line-height: 140%">&lt;MyEnum&gt;(pMyCircle-&gt;m_myEnum));&#160; </span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> Acad::eOk; </span></p>    <p style="margin: 0px"><span style="line-height: 140%">}</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">/// </span><span style="line-height: 140%; color: gray">&lt;summary&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">/// This is called by the system to retrieve the property value for </span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">/// a specific object</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">/// </span><span style="line-height: 140%; color: gray">&lt;/summary&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">Acad::ErrorStatus MyListProperty::subSetValue(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; AcRxObject* pO, </span><span style="line-height: 140%; color: blue">const</span><span style="line-height: 140%"> AcRxValue&amp; value) </span><span style="line-height: 140%; color: blue">const</span></p>    <p style="margin: 0px"><span style="line-height: 140%">{</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; AcDbEntity * ent = AcDbEntity::cast(pO);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (ent == NULL)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> Acad::eNotThatKindOfClass;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">const</span><span style="line-height: 140%"> MyEnum * val = rxvalue_cast&lt;MyEnum&gt;(&amp;value);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (val == NULL)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> Acad::eInvalidInput; </span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: green">// Set the property of the custom entity</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: green">// or store it wherever we want to</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; AEN1MyCircle * pMyCircle = AEN1MyCircle::cast(pO);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; pMyCircle-&gt;m_myEnum = *val;&#160; </span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> Acad::eOk; </span></p>    <p style="margin: 0px"><span style="line-height: 140%">}</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">/// </span><span style="line-height: 140%; color: gray">&lt;summary&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">/// This is called to create an instance of our class</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">/// </span><span style="line-height: 140%; color: gray">&lt;/summary&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">AcRxObject * MyListProperty::makeMyListProperty() </span></p>    <p style="margin: 0px"><span style="line-height: 140%">{ </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> MyListProperty(); </span></p>    <p style="margin: 0px"><span style="line-height: 140%">}</span></p>    <p style="margin: 0px"></p> </div>
