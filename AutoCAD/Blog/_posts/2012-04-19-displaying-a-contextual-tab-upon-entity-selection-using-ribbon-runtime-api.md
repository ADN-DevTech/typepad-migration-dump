---
layout: "post"
title: "Displaying a contextual tab upon entity selection using Ribbon runtime API"
date: "2012-04-19 00:34:30"
author: "Philippe Leefsma"
categories:
  - ".NET"
  - "AutoCAD"
  - "Philippe Leefsma"
original_url: "https://adndevblog.typepad.com/autocad/2012/04/displaying-a-contextual-tab-upon-entity-selection-using-ribbon-runtime-api.html "
typepad_basename: "displaying-a-contextual-tab-upon-entity-selection-using-ribbon-runtime-api"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/philippe-leefsma.html" target="_self">Philippe Leefsma</a></p>  <p>&#0160;</p>  <p>The AutoCAD API provides a way to display a specific contextual tab upon entity selection, but the approach involves creating a custom xaml file and .Net assembly, place them in AutoCAD install directory and finally modify the CUI file to make it aware of the new tab selector rule we created. The technical details of that functionality are described in one of our DevNote article available only for ADN members at the moment.</p>  <p>The approach I am exposing here is more flexible and straightforward to put in place as it only relies on the Ribbon runtime API: it sets up a couple of event handlers and will display dynamically a contextual tab upon an entity selection, with ability to perform advanced logic whether or not to display you tab.</p>  <p>Note: Running “CtxTabUponSelect” command multiple times in the same document will have the effect of setting multiple event handlers for “ImpliedSelectionChanged”. Though the effect won’t be noticed from the user interface, you may want to take some precautions not to listen twice to an event when you use that in production code.</p>  <p>&#0160;</p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; color: "><font face="Consolas"><font color="#008000" style="font-size: 9.5pt">//////////////////////////////////////////////////////////////////////////////////////////////////////////////</font></font></span><span style="font-family: "></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; color: "><font face="Consolas"><font color="#008000" style="font-size: 9.5pt">// Use: Displays a contextual tab upon entity selection, </font></font></span><span style="font-family: "></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; color: "><font face="Consolas"><font color="#008000" style="font-size: 9.5pt">//<span style="mso-spacerun: yes">&#0160;&#0160;&#0160;&#0160;&#0160; </span>using Ribbon runtime API.</font></font></span><span style="font-family: "></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; color: "><font face="Consolas"><font color="#008000" style="font-size: 9.5pt">//</font></font></span><span style="font-family: "></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; color: "><font face="Consolas"><font color="#008000" style="font-size: 9.5pt">// Author: Philippe Leefsma, April 2012</font></font></span><span style="font-family: "></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; color: "><font face="Consolas"><font color="#008000" style="font-size: 9.5pt">//////////////////////////////////////////////////////////////////////////////////////////////////////////////</font></font></span><span style="font-family: "></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><font style="font-size: 9.5pt">Autodesk.Windows.</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">RibbonTab</font></span><font color="#000000"> _ctxTab = </font><span style="color: "><font color="#0000ff">null</font></span><font color="#000000">;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><font style="font-size: 9.5pt">[</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">CommandMethod</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;CtxTabUponSelect&quot;</font></span><font color="#000000">)]</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><font style="font-size: 9.5pt">public</font></font></span><span style="font-family: "><font style="font-size: 9.5pt"><font color="#000000"> </font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000"> CtxTabUponSelect()</font></font></span></font></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span lang="FR" style="font-family: ; mso-ansi-language: fr"><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">{</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span lang="FR" style="font-family: ; mso-ansi-language: fr"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">Document</font></span><font color="#000000"> doc = </font><span style="color: "><font color="#2b91af">Application</font></span><font color="#000000">.DocumentManager.MdiActiveDocument;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span lang="FR" style="font-family: ; mso-ansi-language: fr"><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span lang="FR" style="font-family: ; mso-ansi-language: fr"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></font></span></span><span style="font-family: ; color: "><font color="#008000" style="font-size: 9.5pt">//Set up event for selection changed</font></span></font><span style="font-family: "></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">doc.ImpliedSelectionChanged += </font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">EventHandler</font></span><font color="#000000">(doc_ImpliedSelectionChanged);</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">}</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><font style="font-size: 9.5pt">void</font></font></span><span style="font-family: "><font style="font-size: 9.5pt"><font color="#000000"> doc_ImpliedSelectionChanged(</font><span style="color: "><font color="#0000ff">object</font></span><font color="#000000"> sender, </font><span style="color: "><font color="#2b91af">EventArgs</font></span><font color="#000000"> e)</font></font></span></font></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span lang="FR" style="font-family: ; mso-ansi-language: fr"><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">{</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span lang="FR" style="font-family: ; mso-ansi-language: fr"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">Document</font></span><font color="#000000"> doc = </font><span style="color: "><font color="#2b91af">Application</font></span><font color="#000000">.DocumentManager.MdiActiveDocument;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span lang="FR" style="font-family: ; mso-ansi-language: fr"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></font></span></span><font style="font-size: 9.5pt"><span style="font-family: ; color: "><font color="#2b91af">PromptSelectionResult</font></span></font><span style="font-family: "><font color="#000000" style="font-size: 9.5pt"> psr = doc.Editor.SelectImplied();</font></span></font></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></font></span><span style="color: "><font color="#008000" style="font-size: 9.5pt">//if no entities are selected, we hide our context tab </font></span></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (psr.Value == </font><span style="color: "><font color="#0000ff">null</font></span><font color="#000000">)</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">{</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">HideTab();</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000">;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></font></span><span style="color: "><font color="#008000" style="font-size: 9.5pt">//In this example we only display the tab if only circles are </font></span></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></font></span><span style="color: "><font color="#008000" style="font-size: 9.5pt">// selected. You may want to change this condition of course.</font></span></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">foreach</font></span><font color="#000000"> (</font><span style="color: "><font color="#2b91af">SelectedObject</font></span><font color="#000000"> selObj </font><span style="color: "><font color="#0000ff">in</font></span><font color="#000000"> psr.Value)</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">{</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (selObj.ObjectId.ObjectClass.DxfName.ToLower() </font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt"><font color="#000000">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; != </font><span style="color: "><font color="#a31515">&quot;circle&quot;</font></span><font color="#000000">)</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">{</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">HideTab();</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000">;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></font></span><span style="color: "><font color="#008000" style="font-size: 9.5pt">//We will use the Application.Idle event to safely display our tab</font></span></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (_ctxTab == </font><span style="color: "><font color="#0000ff">null</font></span><font color="#000000"> || !_ctxTab.IsVisible)</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">{</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160; </font></span><font style="font-size: 9.5pt"><span style="mso-spacerun: yes">&#0160;&#0160;&#0160;&#0160;&#0160; </span>Autodesk.AutoCAD.ApplicationServices.</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">Application</font></span><font color="#000000">.Idle += </font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">EventHandler</font></span><font color="#000000">(OnIdle);</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">}</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><font style="font-size: 9.5pt">void</font></font></span><span style="font-family: "><font style="font-size: 9.5pt"><font color="#000000"> OnIdle(</font><span style="color: "><font color="#0000ff">object</font></span><font color="#000000"> sender, </font><span style="color: "><font color="#2b91af">EventArgs</font></span><font color="#000000"> e)</font></font></span></font></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">{</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></font></span><span style="color: "><font color="#008000" style="font-size: 9.5pt">//Make sure ribbon manager is available</font></span></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (Autodesk.Windows.</font><span style="color: "><font color="#2b91af">ComponentManager</font></span><font color="#000000">.Ribbon != </font><span style="color: "><font color="#0000ff">null</font></span><font color="#000000">)</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;</font></span><font style="font-size: 9.5pt"><span style="mso-spacerun: yes">&#0160;&#0160; </span>{</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><span style="color: "><font color="#008000" style="font-size: 9.5pt">//Create tab if it doesn&#39;t exist</font></span></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (_ctxTab == </font><span style="color: "><font color="#0000ff">null</font></span><font color="#000000">)</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">CreateCtxTab();</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><span style="color: "><font color="#008000" style="font-size: 9.5pt">//Otherwise make it visible</font></span></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000">(!_ctxTab.IsVisible)</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">{</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">Autodesk.Windows.</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">RibbonControl</font></span><font color="#000000"> ribbonCtrl = </font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">Autodesk.Windows.</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">ComponentManager</font></span><font color="#000000">.Ribbon;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">ribbonCtrl.ShowContextualTab(_ctxTab, </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">false</font></span><font color="#000000">, </font><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">);</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">_ctxTab.IsActive = </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000">(!_ctxTab.IsActive)</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">_ctxTab.IsActive = </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">}</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; color: "><font face="Consolas"><font color="#008000" style="font-size: 9.5pt">//Tab creation method</font></font></span><span style="font-family: "></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><font style="font-size: 9.5pt">void</font></font></span><span style="font-family: "><font color="#000000" style="font-size: 9.5pt"> CreateCtxTab()</font></span></font></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">{</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">Autodesk.Windows.</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">RibbonControl</font></span><font color="#000000"> ribbonCtrl = </font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">Autodesk.Windows.</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">ComponentManager</font></span><font color="#000000">.Ribbon;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">_ctxTab = </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">RibbonTab</font></span><font color="#000000">();</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">_ctxTab.Name = </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#a31515">&quot;MyTab&quot;</font></span><font color="#000000">;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">_ctxTab.Id = </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#a31515">&quot;MY_CTX_TAB_ID&quot;</font></span><font color="#000000">;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">_ctxTab.IsVisible = </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">_ctxTab.Title = _ctxTab.Name;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">_ctxTab.IsContextualTab = </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">ribbonCtrl.Tabs.Add(_ctxTab);</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">}</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><font style="font-size: 9.5pt">void</font></font></span><span style="font-family: "><font color="#000000" style="font-size: 9.5pt"> HideTab()</font></span></font></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">{</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">Autodesk.AutoCAD.ApplicationServices.</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">Application</font></span><font color="#000000">.Idle </font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">-= </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">EventHandler</font></span><font color="#000000">(OnIdle);</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (_ctxTab != </font><span style="color: "><font color="#0000ff">null</font></span><font color="#000000">)</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">{</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">Autodesk.Windows.</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">RibbonControl</font></span><font color="#000000"> ribbonCtrl = </font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">Autodesk.Windows.</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">ComponentManager</font></span><font color="#000000">.Ribbon;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">ribbonCtrl.HideContextualTab(_ctxTab);</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">_ctxTab.IsVisible = </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">false</font></span><font color="#000000">;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">_ctxTab = </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">null</font></span><font color="#000000">;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt"></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">}</font></font></span></p>
