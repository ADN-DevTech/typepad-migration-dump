---
layout: "post"
title: "Opening a Project programmatically in Plant3d using .NET"
date: "2012-09-17 15:27:51"
author: "Fenton Webb"
categories:
  - ".NET"
  - "2012"
  - "2013"
  - "Fenton Webb"
  - "Plant3D"
original_url: "https://adndevblog.typepad.com/autocad/2012/09/opening-a-project-programmatically-in-plant3d-using-net.html "
typepad_basename: "opening-a-project-programmatically-in-plant3d-using-net"
typepad_status: "Publish"
---

<div style="font-family: ; background: white; color: ">by <a href="http://adndevblog.typepad.com/autocad/fenton-webb.html">Fenton Webb</a></div>  <p>Currently, for Plant3d 2012 and 2013 it’s not possible to use the PlantProject.LoadProject() function. The problem is that the Project Manager does not update.</p>  <p>The solution is to use the command line “-OPENPROJECT”, here’s how:</p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><font face="Consolas"><span style="color: "><font style="font-size: 8pt" color="#008000">// open Plant3d project.xml by Fenton Webb, DevTech, 17/9/12</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">[</font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">CommandMethod</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;OpenMyProject&quot;</font></span><font color="#000000">)]</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">public</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">OpenMyProject</font></span><font color="#000000">()</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">{</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// select project.xml</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">System</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Windows</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Forms</font></span><font color="#000000">.</font><span style="color: "><font color="#2b91af">OpenFileDialog</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">dlg</font></span><font color="#000000"> = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">System</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Windows</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Forms</font></span><font color="#000000">.</font><span style="color: "><font color="#2b91af">OpenFileDialog</font></span><font color="#000000">();</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">DirectoryInfo</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">defaultPathDI</font></span><font color="#000000"> = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">DirectoryInfo</font></span><font color="#000000">(</font><span style="color: "><font color="#2b91af">Environment</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">GetFolderPath</font></span><font color="#000000">(</font><span style="color: "><font color="#2b91af">Environment</font></span><font color="#000000">.</font><span style="color: "><font color="#2b91af">SpecialFolder</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">MyDocuments</font></span><font color="#000000">));</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">dlg</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">InitialDirectory</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">defaultPathDI</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">FullName</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">dlg</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">FileName</font></span><font color="#000000"> = </font><span style="color: "><font color="#a31515">&quot;project.xml&quot;</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">dlg</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Multiselect</font></span><font color="#000000"> = </font><span style="color: "><font color="#0000ff">false</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">System</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Windows</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Forms</font></span><font color="#000000">.</font><span style="color: "><font color="#2b91af">DialogResult</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">dlgResult</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">dlg</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">ShowDialog</font></span><font color="#000000">();</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// if ok</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">dlgResult</font></span><font color="#000000"> == </font><span style="color: "><font color="#010001">System</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Windows</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Forms</font></span><font color="#000000">.</font><span style="color: "><font color="#2b91af">DialogResult</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">OK</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000"> {</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">AcadApp</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">DocumentManager</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">MdiActiveDocument</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">SendStringToExecute</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;-_.OPENPROJECT \&quot;&quot;</font></span><font color="#000000"> + </font><span style="color: "><font color="#010001">dlg</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">FileName</font></span><font color="#000000"> + </font><span style="color: "><font color="#a31515">&quot;\&quot;\n&quot;</font></span><font color="#000000">, </font><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">, </font><span style="color: "><font color="#0000ff">false</font></span><font color="#000000">, </font><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">);&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000"> }</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">}</font></font></p>    <p style="margin: 0px"><font color="#000000" face="Consolas"></font></p>    <p>If the LoadProject() was working you would use it like this…</p>    <div style="font-family: ; background: white; color: ">     <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">[</font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">CommandMethod</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;loadMyProject&quot;</font></span><font color="#000000">)]</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">public</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">loadProject</font></span><font color="#000000">()</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">{</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// select project.xml</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">System</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Windows</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Forms</font></span><font color="#000000">.</font><span style="color: "><font color="#2b91af">OpenFileDialog</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">dlg</font></span><font color="#000000"> = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">System</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Windows</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Forms</font></span><font color="#000000">.</font><span style="color: "><font color="#2b91af">OpenFileDialog</font></span><font color="#000000">();</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">DirectoryInfo</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">defaultPathDI</font></span><font color="#000000"> = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">DirectoryInfo</font></span><font color="#000000">(</font><span style="color: "><font color="#2b91af">Environment</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">GetFolderPath</font></span><font color="#000000">(</font><span style="color: "><font color="#2b91af">Environment</font></span><font color="#000000">.</font><span style="color: "><font color="#2b91af">SpecialFolder</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">MyDocuments</font></span><font color="#000000">));</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">dlg</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">InitialDirectory</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">defaultPathDI</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">FullName</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">dlg</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">FileName</font></span><font color="#000000"> = </font><span style="color: "><font color="#a31515">&quot;project.xml&quot;</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">dlg</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Multiselect</font></span><font color="#000000"> = </font><span style="color: "><font color="#0000ff">false</font></span><font color="#000000">;</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">System</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Windows</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Forms</font></span><font color="#000000">.</font><span style="color: "><font color="#2b91af">DialogResult</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">dlgResult</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">dlg</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">ShowDialog</font></span><font color="#000000">();</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// if ok</font></span></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">dlgResult</font></span><font color="#000000"> == </font><span style="color: "><font color="#010001">System</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Windows</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Forms</font></span><font color="#000000">.</font><span style="color: "><font color="#2b91af">DialogResult</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">OK</font></span><font color="#000000">)</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000"> {</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">PlantProject</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">pp</font></span><font color="#000000"> = </font><span style="color: "><font color="#2b91af">PlantProject</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">LoadProject</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">dlg</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">FileName</font></span><font color="#000000">, </font><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">, </font><span style="color: "><font color="#a31515">&quot;&quot;</font></span><font color="#000000">, </font><span style="color: "><font color="#a31515">&quot;&quot;</font></span><font color="#000000">);</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">PlantApplication</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">SetCurrentProject</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">pp</font></span><font color="#000000">, </font><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">);</font></font></font></p>      <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000"> }</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">}</font></font></p>      <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>   </div> </div>
