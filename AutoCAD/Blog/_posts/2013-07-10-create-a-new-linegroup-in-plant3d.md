---
layout: "post"
title: "Create a new LineGroup in Plant3d"
date: "2013-07-10 08:19:36"
author: "Fenton Webb"
categories:
  - "2012"
  - "2013"
  - "2014"
  - "Fenton Webb"
  - "Plant3D"
original_url: "https://adndevblog.typepad.com/autocad/2013/07/create-a-new-linegroup-in-plant3d.html "
typepad_basename: "create-a-new-linegroup-in-plant3d"
typepad_status: "Publish"
---

<p>by <a href="http://adndevblog.typepad.com/autocad/fenton-webb.html">Fenton Webb</a></p>  <p>When creating a new LineGroup, the PipingObjectAdder should already create line groups or take an existing one. However, hereâ€™s some code which shows how to do it manually:</p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal"><font face="Consolas"><font style="font-size: 9.5pt"><span style="font-family: ; color: "><font color="#0000ff">int</font></span><span style="font-family: ; color: "><font color="#000000"> CreateUnassignedLineGroup(</font></span><span style="font-family: ; color: "><font color="#2b91af">PipingProject</font></span></font><span style="font-family: ; color: "><font style="font-size: 9.5pt" color="#000000"> prjpart)</font></span></font><span style="font-family: ; color: "></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal"><span style="font-family: ; color: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">{</font></font></span><span style="font-family: ; color: "></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal"><font face="Consolas"><span style="font-family: ; color: "><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><span style="font-family: ; color: "><font style="font-size: 9.5pt" color="#008000">// Create a new line group in project database</font></span></font><span style="font-family: ; color: "></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal"><font face="Consolas"><span style="font-family: ; color: "><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><span style="font-family: ; color: "><font style="font-size: 9.5pt" color="#008000">//</font></span></font><span style="font-family: ; color: "></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal"><font face="Consolas"><span style="font-family: ; color: "><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="font-family: ; color: "><font color="#2b91af">DataLinksManager</font></span></font><span style="font-family: ; color: "><font style="font-size: 9.5pt" color="#000000"> dlm = prjpart.DataLinksManager;</font></span></font><span style="font-family: ; color: "></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal"><font face="Consolas"><span style="font-family: ; color: "><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="font-family: ; color: "><font color="#2b91af">PnPDatabase</font></span></font><span style="font-family: ; color: "><font style="font-size: 9.5pt" color="#000000"> db = dlm.GetPnPDatabase();</font></span></font><span style="font-family: ; color: "></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal"><span style="font-family: ; color: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span><span style="font-family: ; color: "></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal"><font face="Consolas"><span style="font-family: ; color: "><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="font-family: ; color: "><font color="#2b91af">PnPTable</font></span><span style="font-family: ; color: "><font color="#000000"> tbl = db.Tables[</font></span><span style="font-family: ; color: "><font color="#a31515">&quot;P3dLineGroup&quot;</font></span></font><span style="font-family: ; color: "><font style="font-size: 9.5pt" color="#000000">];</font></span></font><span style="font-family: ; color: "></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal"><span style="font-family: ; color: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="font-family: ; color: "></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal"><font face="Consolas"><span style="font-family: ; color: "><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="font-family: ; color: "><font color="#2b91af">PnPRow</font></span></font><span style="font-family: ; color: "><font style="font-size: 9.5pt" color="#000000"> row = tbl.NewRow();</font></span></font><span style="font-family: ; color: "></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal"><span style="font-family: ; color: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;&#160;&#160; tbl.Rows.Add(row);</font></font></span><span style="font-family: ; color: "></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal"><span style="font-family: ; color: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span><span style="font-family: ; color: "></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal"><font face="Consolas"><span style="font-family: ; color: "><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="font-family: ; color: "><font color="#0000ff">return</font></span></font><span style="font-family: ; color: "><font style="font-size: 9.5pt" color="#000000"> row.RowId;</font></span></font><span style="font-family: ; color: "></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal"><span style="font-family: ; color: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">}</font></font></span><span style="font-family: ; color: "></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal"><span style="font-family: ; color: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span><span style="font-family: ; color: "></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal"><font face="Consolas"><font style="font-size: 9.5pt"><span style="font-family: ; color: "><font color="#0000ff">void</font></span><span style="font-family: ; color: "><font color="#000000"> AssignToLineGroup(</font></span><span style="font-family: ; color: "><font color="#2b91af">PipingProject</font></span><span style="font-family: ; color: "><font color="#000000"> prjpart, </font></span><span style="font-family: ; color: "><font color="#2b91af">ObjectId</font></span><span style="font-family: ; color: "><font color="#000000"> partId, </font></span><span style="font-family: ; color: "><font color="#0000ff">int</font></span><span style="font-family: ; color: "><font color="#000000"> cacheId, </font></span><span style="font-family: ; color: "><font color="#0000ff">int</font></span></font><span style="font-family: ; color: "><font style="font-size: 9.5pt" color="#000000"> groupId)</font></span></font><span style="font-family: ; color: "></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal"><span style="font-family: ; color: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">{</font></font></span><span style="font-family: ; color: "></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal"><font face="Consolas"><span style="font-family: ; color: "><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><span style="font-family: ; color: "><font style="font-size: 9.5pt" color="#008000">// Assign an entity's row to line group</font></span></font><span style="font-family: ; color: "></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal"><font face="Consolas"><span style="font-family: ; color: "><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><span style="font-family: ; color: "><font style="font-size: 9.5pt" color="#008000">//</font></span></font><span style="font-family: ; color: "></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal"><font face="Consolas"><span style="font-family: ; color: "><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="font-family: ; color: "><font color="#2b91af">DataLinksManager</font></span></font><span style="font-family: ; color: "><font style="font-size: 9.5pt" color="#000000"> dlm = prjpart.DataLinksManager;</font></span></font><span style="font-family: ; color: "></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal"><font face="Consolas"><span style="font-family: ; color: "><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="font-family: ; color: "><font color="#2b91af">PnPDatabase</font></span></font><span style="font-family: ; color: "><font style="font-size: 9.5pt" color="#000000"> db = dlm.GetPnPDatabase();</font></span></font><span style="font-family: ; color: "></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal"><span style="font-family: ; color: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span><span style="font-family: ; color: "></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal"><font face="Consolas"><span style="font-family: ; color: "><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><span style="font-family: ; color: "><font style="font-size: 9.5pt" color="#008000">// Relate objects to line group</font></span></font><span style="font-family: ; color: "></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal"><font face="Consolas"><span style="font-family: ; color: "><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><span style="font-family: ; color: "><font style="font-size: 9.5pt" color="#008000">//</font></span></font><span style="font-family: ; color: "></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal"><font face="Consolas"><span style="font-family: ; color: "><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; dlm.Relate(</font></font></span><font style="font-size: 9.5pt"><span style="font-family: ; color: "><font color="#a31515">&quot;P3dLineGroupPartRelationship&quot;</font></span></font><span style="font-family: ; color: "><font style="font-size: 9.5pt" color="#000000">,</font></span></font><span style="font-family: ; color: "></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal"><font face="Consolas"><span style="font-family: ; color: "><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="font-family: ; color: "><font color="#a31515">&quot;LineGroup&quot;</font></span></font><span style="font-family: ; color: "><font style="font-size: 9.5pt" color="#000000">, groupId,</font></span></font><span style="font-family: ; color: "></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal"><font face="Consolas"><span style="font-family: ; color: "><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="font-family: ; color: "><font color="#a31515">&quot;Part&quot;</font></span></font><span style="font-family: ; color: "><font style="font-size: 9.5pt" color="#000000">, cacheId);</font></span></font><span style="font-family: ; color: "></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal"><span style="font-family: ; color: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span><span style="font-family: ; color: "></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal"><font face="Consolas"><span style="font-family: ; color: "><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><span style="font-family: ; color: "><font style="font-size: 9.5pt" color="#008000">// Also relate drawing to line group</font></span></font><span style="font-family: ; color: "></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal"><font face="Consolas"><span style="font-family: ; color: "><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><span style="font-family: ; color: "><font style="font-size: 9.5pt" color="#008000">//</font></span></font><span style="font-family: ; color: "></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal"><font face="Consolas"><span style="font-family: ; color: "><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="font-family: ; color: "><font color="#2b91af">Database</font></span></font><span style="font-family: ; color: "><font style="font-size: 9.5pt" color="#000000"> acdb = partId.Database;</font></span></font><span style="font-family: ; color: "></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal"><font face="Consolas"><span style="font-family: ; color: "><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="font-family: ; color: "><font color="#0000ff">int</font></span></font><span style="font-family: ; color: "><font style="font-size: 9.5pt" color="#000000"> dwgId = dlm.GetDrawingId(acdb);</font></span></font><span style="font-family: ; color: "></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal"><font face="Consolas"><span style="font-family: ; color: "><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="font-family: ; color: "><font color="#0000ff">if</font></span></font><span style="font-family: ; color: "><font style="font-size: 9.5pt" color="#000000"> (dwgId != -1)</font></span></font><span style="font-family: ; color: "></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal"><span style="font-family: ; color: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;&#160;&#160; {</font></font></span><span style="font-family: ; color: "></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal"><font face="Consolas"><span style="font-family: ; color: "><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; dlm.Relate(</font></font></span><font style="font-size: 9.5pt"><span style="font-family: ; color: "><font color="#a31515">&quot;P3dDrawingLineGroupRelationship&quot;</font></span></font><span style="font-family: ; color: "><font style="font-size: 9.5pt" color="#000000">,</font></span></font><span style="font-family: ; color: "></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal"><font face="Consolas"><span style="font-family: ; color: "><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="font-family: ; color: "><font color="#a31515">&quot;Drawing&quot;</font></span></font><span style="font-family: ; color: "><font style="font-size: 9.5pt" color="#000000">, dwgId,</font></span></font><span style="font-family: ; color: "></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal"><font face="Consolas"><span style="font-family: ; color: "><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="font-family: ; color: "><font color="#a31515">&quot;LineGroup&quot;</font></span></font><span style="font-family: ; color: "><font style="font-size: 9.5pt" color="#000000">, groupId);</font></span></font><span style="font-family: ; color: "></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal"><span style="font-family: ; color: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;&#160;&#160; }</font></font></span><span style="font-family: ; color: "></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal"><span style="font-family: ; color: "><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">}</font></font></span><span style="font-family: ; color: "></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal"><span style="color: "><font face="Calibri"><font style="font-size: 10.5pt" color="#000000">&#160;</font></font></span></p>
