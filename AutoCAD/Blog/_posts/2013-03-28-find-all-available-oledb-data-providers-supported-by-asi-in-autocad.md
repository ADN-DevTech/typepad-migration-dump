---
layout: "post"
title: "Find all available OLEDB data providers supported by ASI in AutoCAD"
date: "2013-03-28 23:16:00"
author: "Xiaodong Liang"
categories:
  - "AutoCAD"
  - "LISP"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/autocad/2013/03/find-all-available-oledb-data-providers-supported-by-asi-in-autocad.html "
typepad_basename: "find-all-available-oledb-data-providers-supported-by-asi-in-autocad"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>
<p><strong>Issue      <br /></strong>How can I discover what tables are available AutoLISP?</p>
<p><a name="section2"></a></p>
<p><strong>Solution</strong></p>
<p>There are two ASILISP functions that help here. Both return cursors to system tables so you can step through the records to find what you need. For example, this code will return all the available providers:</p>
<p><span style="line-height: 120%; font-family: &#39;courier new&#39;, courier; font-size: 8pt;">     <br /><span style="color: #ff0000;">(</span><span style="color: #0000ff;">defun</span> c:getprov <span style="color: #ff0000;">(</span>&#0160;<span style="color: #0000ff;">/</span> fasi_kword fasi_curs fasi_row<span style="color: #ff0000;">)</span>      <br />&#0160; <span style="background-color: #e6e6e6; color: #800080;">;;; Note that ASILISP *must* be loaded first.       <br /></span>&#0160; <span style="color: #ff0000;">(</span>verify_arxapp_loaded <span style="color: #ff00ff;">&quot;asilisp&quot;</span><span style="color: #ff0000;">)</span>&#0160; <br /><span style="color: #ff0000;">(</span><span style="color: #0000ff;">setq</span> fasi_curs <span style="color: #ff0000;">(</span>asi_providers<span style="color: #ff0000;">)</span><span style="color: #ff0000;">)</span>      <br /><span style="color: #ff0000;">(</span><span style="color: #0000ff;">if</span>&#0160;<span style="color: #ff0000;">(</span>asi_open fasi_curs<span style="color: #ff0000;">)</span>      <br />&#0160;&#0160; <span style="color: #ff0000;">(</span>prompt <span style="color: #ff00ff;">&quot;\nasi_open successful.&quot;</span><span style="color: #ff0000;">)</span>      <br />&#0160;&#0160; <span style="color: #ff0000;">(</span>prompt <span style="color: #ff00ff;">&quot;\nasi_open failed!&quot;</span><span style="color: #ff0000;">)</span>      <br /><span style="color: #ff0000;">)</span>      <br /><span style="color: #ff0000;">(</span><span style="color: #0000ff;">print</span> fasi_curs<span style="color: #ff0000;">)</span>      <br /><span style="color: #ff0000;">(</span><span style="color: #0000ff;">while</span>&#0160;<span style="color: #ff0000;">(</span><span style="color: #0000ff;">/</span>= fasi_kword <span style="color: #ff00ff;">&quot;eXit&quot;</span><span style="color: #ff0000;">)</span>      <br />&#0160;<span style="color: #ff0000;">(</span>initget <span style="color: #008000;">1</span>&#0160;<span style="color: #ff00ff;">&quot;First Last Next Prior eXit&quot;</span><span style="color: #ff0000;">)</span>      <br />&#0160;<span style="color: #ff0000;">(</span><span style="color: #0000ff;">setq</span> fasi_kword <span style="color: #ff0000;">(</span>getkword <span style="color: #ff00ff;">&quot;\nDisplay Row: <span style="color: #ff0000;">(</span>First Last Next Prior eXit<span style="color: #ff0000;">)</span>&quot;</span><span style="color: #ff0000;">)</span><span style="color: #ff0000;">)</span>      <br />&#0160;<span style="color: #ff0000;">(</span><span style="color: #0000ff;">if</span>&#0160;<span style="color: #ff0000;">(</span><span style="color: #0000ff;">/</span>= fasi_kword <span style="color: #ff00ff;">&quot;eXit&quot;</span><span style="color: #ff0000;">)</span>      <br />&#0160;&#0160;&#0160;&#0160; <span style="color: #ff0000;">(</span><span style="color: #0000ff;">progn</span>&#0160;<span style="color: #ff0000;">(</span><span style="color: #0000ff;">setq</span> fasi_row <span style="color: #ff0000;">(</span>asi_fetch fasi_curs fasi_kword<span style="color: #ff0000;">)</span><span style="color: #ff0000;">)</span>      <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #ff0000;">(</span><span style="color: #0000ff;">if</span> fasi_row <span style="color: #ff0000;">(</span><span style="color: #0000ff;">print</span> fasi_row<span style="color: #ff0000;">)</span>      <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #ff0000;">(</span>prompt <span style="color: #ff00ff;">&quot;\nNothing to fetch or asi_fetch failed.&quot;</span><span style="color: #ff0000;">)</span>      <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #ff0000;">)</span>      <br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #ff0000;">)</span>      <br />&#0160;<span style="color: #ff0000;">)</span>      <br /><span style="color: #ff0000;">)</span>      <br /><span style="color: #ff0000;">(</span><span style="color: #0000ff;">if</span>&#0160;<span style="color: #ff0000;">(</span>asi_close fasi_curs<span style="color: #ff0000;">)</span>      <br />&#0160;&#0160; <span style="color: #ff0000;">(</span>prompt <span style="color: #ff00ff;">&quot;\nasi_close successful.&quot;</span><span style="color: #ff0000;">)</span>      <br />&#0160;&#0160; <span style="color: #ff0000;">(</span>prompt <span style="color: #ff00ff;">&quot;\nasi_close failed!&quot;</span><span style="color: #ff0000;">)</span>      <br /><span style="color: #ff0000;">)</span>      <br /><span style="color: #ff0000;">(</span><span style="color: #0000ff;">princ</span><span style="color: #ff0000;">)</span>      <br /><span style="color: #ff0000;">)</span></span></p>
<p>Typical results after stepping through the table (using the &#39;next&#39; option above) might be:</p>
<p> (&quot;SQLOLEDB&quot;   <br /> &quot;{0C7FF16C-38E3-11d0-97AB-00C04FC2AD98}&quot;     <br />&quot;Microsoft OLE DB Provider for SQL Server&quot; 1.0 0.0     <br />&quot;{0C7FF16C-38E3-11d0-97AB-00C04FC2AD98}&quot;)    <br />&#0160; <br />(&quot;MSDataShape&quot;     <br />&quot;{3449A1C8-C56C-11D0-AD72-00C04FC29863}&quot;     <br />&quot;MSDataShape&quot; 1.0 0.0     <br />&quot;{3449A1C8-C56C-11D0-AD72-00C04FC29863}&quot;) </p>
<p>(&quot;SQLNCLI11&quot;   <br /> &quot;{397C2819-8272-4532-AD3A-FB5E43BEAA39}&quot;     <br />&quot;SQL Server Native Client 11.0&quot; 1.0 0.0     <br />&quot;{397C2819-8272-4532-AD3A-FB5E43BEAA39}&quot;) </p>
<p>(&quot;SQLNCLI Enumerator&quot;    <br />&quot;{4898AD37-FE05-42df-92F9-E857DDFEE730}&quot;    <br /> &quot;SQL Native Client Enumerator&quot; 2.0 0.0    <br /> &quot;{4898AD37-FE05-42df-92F9-E857DDFEE730}&quot;) </p>
<p>… …. etc</p>
