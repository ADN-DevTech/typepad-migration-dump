---
layout: "post"
title: "Using GetRelatedRowIds method"
date: "2012-10-03 13:02:14"
author: "Augusto Goncalves"
categories:
  - "2013"
  - "Augusto Goncalves"
  - "PnID"
original_url: "https://adndevblog.typepad.com/autocad/2012/10/using-getrelatedrowids-method.html "
typepad_basename: "using-getrelatedrowids-method"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>The P&amp;ID API do not have a direct method to access all related entities of a given SLINE or Asset, but the Data Links Manager have a method, GetRelatedRowIds, that can give this information when we pass the appropriate parameters. The following code sample get all related entities (actually a array of PnPRowId) for a given entity.</p>  <div style="font-family: ; background: white">   <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&lt;</font></font><font style="font-size: 10pt"><span><font color="#2b91af">CommandMethod</font></span><font color="#000000">(</font><span><font color="#a31515">&quot;listRelatedEntities&quot;</font></span><font color="#000000">)&gt; _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 10pt">Public</font></font></span><font style="font-size: 10pt"><font color="#000000"> </font><span><font color="#0000ff">Shared</font></span><font color="#000000"> </font><span><font color="#0000ff">Sub</font></span><font color="#000000"> CmdListRelatedEntities()</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> ed </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">Editor</font></span><font color="#000000"> = </font><span><font color="#2b91af">_ </font></span></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt"><span><font color="#2b91af">&#160;&#160;&#160; Application</font></span><font color="#000000">.DocumentManager.MdiActiveDocument.Editor</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><span><font style="font-size: 10pt" color="#008000">' select a SLINE ou Asset</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> selEntOp </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#0000ff">New</font></span><font color="#000000"> </font><span><font color="#2b91af">PromptEntityOptions</font></span><font color="#000000">( _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#a31515">&quot;Select a SLINE or Asset: &quot;</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><span><font style="font-size: 10pt" color="#008000">' *** before AddAllowedClass</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; selEntOp.SetRejectMessage(</font></font><font style="font-size: 10pt"><span><font color="#a31515">&quot;Only SLINE or Asset&quot;</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; selEntOp.AddAllowedClass(</font></font><font style="font-size: 10pt"><span><font color="#0000ff">GetType</font></span><font color="#000000">(</font><span><font color="#2b91af">LineSegment</font></span><font color="#000000">), </font><span><font color="#0000ff">True</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; selEntOp.AddAllowedClass(</font></font><font style="font-size: 10pt"><span><font color="#0000ff">GetType</font></span><font color="#000000">(</font><span><font color="#2b91af">Asset</font></span><font color="#000000">), </font><span><font color="#0000ff">True</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> selEntRes </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">PromptEntityResult</font></span><font color="#000000"> =&#160; _ </font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;&#160;&#160; ed.GetEntity(selEntOp)</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">If</font></span><font color="#000000"> (selEntRes.Status &lt;&gt; </font><span><font color="#2b91af">PromptStatus</font></span><font color="#000000">.OK) </font><span><font color="#0000ff">Then</font></span><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#0000ff">Exit Sub</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> entId </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">ObjectId</font></span><font color="#000000"> = selEntRes.ObjectId</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><span><font style="font-size: 10pt" color="#008000">' access Data Links Manager</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> proj </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">PlantProject</font></span><font color="#000000"> = </font><span><font color="#2b91af">PlantApplication</font></span><font color="#000000">.CurrentProject</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> projPnId </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">PnIdProject</font></span><font color="#000000"> = _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; proj.ProjectParts.Item(</font></font><font style="font-size: 10pt"><span><font color="#a31515">&quot;PnID&quot;</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> dataLinkMgr </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">DataLinksManager</font></span><font color="#000000"> = _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;&#160;&#160; projPnId.DataLinksManager</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><span><font style="font-size: 10pt" color="#008000">' get related entities</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> nRowId </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#0000ff">Integer</font></span><font color="#000000"> = dataLinkMgr.FindAcPpRowId(entId)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><span><font style="font-size: 10pt" color="#008000">' at start</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> startIds </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">PnPRowIdArray</font></span><font color="#000000"> = _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;&#160;&#160; dataLinkMgr.GetRelatedRowIds( _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#a31515">&quot;LineStartAsset&quot;</font></span><font color="#000000">, </font><span><font color="#a31515">&quot;Line&quot;</font></span><font color="#000000">, nRowId, </font><span><font color="#a31515">&quot;Asset&quot;</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><span><font style="font-size: 10pt" color="#008000">' at end</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> endIds </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">PnPRowIdArray</font></span><font color="#000000"> = _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;&#160;&#160; dataLinkMgr.GetRelatedRowIds( _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#a31515">&quot;LineEndAsset&quot;</font></span><font color="#000000">, </font><span><font color="#a31515">&quot;Line&quot;</font></span><font color="#000000">, nRowId, </font><span><font color="#a31515">&quot;Asset&quot;</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><span><font style="font-size: 10pt" color="#008000">' flow entities</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> flowIds </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">PnPRowIdArray</font></span><font color="#000000"> = _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;&#160;&#160; dataLinkMgr.GetRelatedRowIds( _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#a31515">&quot;LineFlowArrow&quot;</font></span><font color="#000000">, </font><span><font color="#a31515">&quot;Line&quot;</font></span><font color="#000000">, nRowId, </font><span><font color="#a31515">&quot;Arrow&quot;</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><span><font style="font-size: 10pt" color="#008000">' and finally inline ents</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> inlineIds </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">PnPRowIdArray</font></span><font color="#000000"> = _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;&#160;&#160; dataLinkMgr.GetRelatedRowIds( _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#a31515">&quot;LineInlineAsset&quot;</font></span><font color="#000000">, </font><span><font color="#a31515">&quot;Line&quot;</font></span><font color="#000000">, nRowId, </font><span><font color="#a31515">&quot;Asset&quot;</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;</font></font><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 10pt">End</font></font></span><font style="font-size: 10pt"><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#0000ff">Sub</font></span></font></p> </div>
