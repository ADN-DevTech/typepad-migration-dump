---
layout: "post"
title: "Cannot instantiate AutoCAD 2010 from an external .NET application after installing Update 1"
date: "2012-05-28 04:52:39"
author: "Adam Nagy"
categories:
  - ".NET"
  - "Adam Nagy"
  - "AutoCAD"
original_url: "https://adndevblog.typepad.com/autocad/2012/05/cannot-instantiate-autocad-2010-from-an-external-net-application-after-installing-update-1.html "
typepad_basename: "cannot-instantiate-autocad-2010-from-an-external-net-application-after-installing-update-1"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/adam-nagy.html" target="_self">Adam Nagy</a></p>
<p>I'm creating an AutoCAD instance from my external .NET application. It worked fine until I installed Update 1 for AutoCAD 2010. Since then I started to get the following error saying "Creating an instance of the COM component with CLSID {6D7AE628-FF41-4CD3-91DD-34825BB1A251} from the IClassFactory failed due to the following error: 80010001"</p>

<a class="asset-img-link"  style="display: inline;" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0168ebdf4a11970c-pi"><img class="asset  asset-image at-xid-6a0167607c2431970b0168ebdf4a11970c" alt="Com_exception" title="Com_exception" src="/assets/image_415116.jpg" border="0" /></a><br />
<p>What could be the problem?</p>
<p><a name="section2"></a></p>
<p><strong>Solution</strong></p>
<p>There was a fix in AutoCAD for a problem which was caused by WPF not letting through some calls under certain scenarios, which now makes it necessary for you to implement IMessageFilter in your external .NET application. In VB6 it is supposed to be done in the background, but .NET does not do it for you. Here is your modified code:</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">Imports</span><span style="line-height: 140%;"> Autodesk.AutoCAD.Interop</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">Imports</span><span style="line-height: 140%;"> Autodesk.AutoCAD.Interop.Common</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">Imports</span><span style="line-height: 140%;"> System.Runtime.InteropServices</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">' SEE http://msdn.microsoft.com/en-us/library/ms693740(VS.85).aspx </span></p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">' for details</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&lt;</span><span style="color: #2b91af; line-height: 140%;">ComImport</span><span style="line-height: 140%;">(), _</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">InterfaceType</span><span style="line-height: 140%;">(</span><span style="color: #2b91af; line-height: 140%;">ComInterfaceType</span><span style="line-height: 140%;">.InterfaceIsIUnknown), _</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">Guid</span><span style="line-height: 140%;">(</span><span style="color: #a31515; line-height: 140%;">"00000016-0000-0000-C000-000000000046"</span><span style="line-height: 140%;">)&gt; _</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">Public</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Interface</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">IMessageFilter</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &lt;</span><span style="color: #2b91af; line-height: 140%;">PreserveSig</span><span style="line-height: 140%;">()&gt; _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: blue; line-height: 140%;">Function</span><span style="line-height: 140%;"> HandleInComingCall( _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">ByVal</span><span style="line-height: 140%;"> dwCallType </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Integer</span><span style="line-height: 140%;">, _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">ByVal</span><span style="line-height: 140%;"> hTaskCaller </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">IntPtr</span><span style="line-height: 140%;">, _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">ByVal</span><span style="line-height: 140%;"> dwTickCount </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Integer</span><span style="line-height: 140%;">, _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">ByVal</span><span style="line-height: 140%;"> lpInterfaceInfo </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">IntPtr</span><span style="line-height: 140%;">) </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Integer</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &lt;</span><span style="color: #2b91af; line-height: 140%;">PreserveSig</span><span style="line-height: 140%;">()&gt; _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: blue; line-height: 140%;">Function</span><span style="line-height: 140%;"> RetryRejectedCall( _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">ByVal</span><span style="line-height: 140%;"> hTaskCallee </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">IntPtr</span><span style="line-height: 140%;">, _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">ByVal</span><span style="line-height: 140%;"> dwTickCount </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Integer</span><span style="line-height: 140%;">, _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">ByVal</span><span style="line-height: 140%;"> dwRejectType </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Integer</span><span style="line-height: 140%;">) </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Integer</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &lt;</span><span style="color: #2b91af; line-height: 140%;">PreserveSig</span><span style="line-height: 140%;">()&gt; _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: blue; line-height: 140%;">Function</span><span style="line-height: 140%;"> MessagePending( _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">ByVal</span><span style="line-height: 140%;"> hTaskCallee </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">IntPtr</span><span style="line-height: 140%;">, _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">ByVal</span><span style="line-height: 140%;"> dwTickCount </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Integer</span><span style="line-height: 140%;">, _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">ByVal</span><span style="line-height: 140%;"> dwPendingType </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Integer</span><span style="line-height: 140%;">) </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Integer</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Interface</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">Public</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Class</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Form1</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: blue; line-height: 140%;">Implements</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">IMessageFilter</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &lt;</span><span style="color: #2b91af; line-height: 140%;">DllImport</span><span style="line-height: 140%;">(</span><span style="color: #a31515; line-height: 140%;">"ole32.dll"</span><span style="line-height: 140%;">)&gt; _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: blue; line-height: 140%;">Shared</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Function</span><span style="line-height: 140%;"> CoRegisterMessageFilter( _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">ByVal</span><span style="line-height: 140%;"> lpMessageFilter </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">IMessageFilter</span><span style="line-height: 140%;">, _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">ByRef</span><span style="line-height: 140%;"> lplpMessageFilter </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">IMessageFilter</span><span style="line-height: 140%;">) </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Integer</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Function</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: blue; line-height: 140%;">Public</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Sub</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">New</span><span style="line-height: 140%;">()</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: green; line-height: 140%;">' This call is required by the Windows Form Designer.</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; InitializeComponent()</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: green; line-height: 140%;">' Add any initialization after the InitializeComponent() call.</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> oldFilter </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">IMessageFilter</span><span style="line-height: 140%;"> = </span><span style="color: blue; line-height: 140%;">Nothing</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> ret </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Integer</span><span style="line-height: 140%;"> = CoRegisterMessageFilter(</span><span style="color: blue; line-height: 140%;">Me</span><span style="line-height: 140%;">, oldFilter)</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Sub</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">#Region</span><span style="line-height: 140%;"> </span><span style="color: #a31515; line-height: 140%;">"IMessageFilter Members"</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: blue; line-height: 140%;">Function</span><span style="line-height: 140%;"> HandleInComingCall( _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">ByVal</span><span style="line-height: 140%;"> dwCallType </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Integer</span><span style="line-height: 140%;">, _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">ByVal</span><span style="line-height: 140%;"> hTaskCaller </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">IntPtr</span><span style="line-height: 140%;">, _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">ByVal</span><span style="line-height: 140%;"> dwTickCount </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Integer</span><span style="line-height: 140%;">, _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">ByVal</span><span style="line-height: 140%;"> lpInterfaceInfo </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">IntPtr</span><span style="line-height: 140%;">) </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Integer</span><span style="line-height: 140%;"> _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: blue; line-height: 140%;">Implements</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">IMessageFilter</span><span style="line-height: 140%;">.HandleInComingCall</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">Return</span><span style="line-height: 140%;"> 0</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Function</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: blue; line-height: 140%;">Function</span><span style="line-height: 140%;"> RetryRejectedCall( _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">ByVal</span><span style="line-height: 140%;"> hTaskCallee </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">IntPtr</span><span style="line-height: 140%;">, _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">ByVal</span><span style="line-height: 140%;"> dwTickCount </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Integer</span><span style="line-height: 140%;">, _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">ByVal</span><span style="line-height: 140%;"> dwRejectType </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Integer</span><span style="line-height: 140%;">) </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Integer</span><span style="line-height: 140%;"> _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: blue; line-height: 140%;">Implements</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">IMessageFilter</span><span style="line-height: 140%;">.RetryRejectedCall</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: green; line-height: 140%;">' retry in a second.</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">Return</span><span style="line-height: 140%;"> 1000</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Function</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: blue; line-height: 140%;">Function</span><span style="line-height: 140%;"> MessagePending( _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">ByVal</span><span style="line-height: 140%;"> hTaskCallee </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">IntPtr</span><span style="line-height: 140%;">, _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">ByVal</span><span style="line-height: 140%;"> dwTickCount </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Integer</span><span style="line-height: 140%;">, _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">ByVal</span><span style="line-height: 140%;"> dwPendingType </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Integer</span><span style="line-height: 140%;">) </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Integer</span><span style="line-height: 140%;"> _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: blue; line-height: 140%;">Implements</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">IMessageFilter</span><span style="line-height: 140%;">.MessagePending</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">Return</span><span style="line-height: 140%;"> 1</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Function</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">#End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Region</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: blue; line-height: 140%;">Private</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Sub</span><span style="line-height: 140%;"> Form1_FormClosed( _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">ByVal</span><span style="line-height: 140%;"> sender </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Object</span><span style="line-height: 140%;">, _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">ByVal</span><span style="line-height: 140%;"> e </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> System.Windows.Forms.</span><span style="color: #2b91af; line-height: 140%;">FormClosedEventArgs</span><span style="line-height: 140%;">) _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">Handles</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Me</span><span style="line-height: 140%;">.FormClosed</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: green; line-height: 140%;">'objAcad.Quit()</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Sub</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: blue; line-height: 140%;">Private</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Sub</span><span style="line-height: 140%;"> Form1_Load( _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">ByVal</span><span style="line-height: 140%;"> sender </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> System.</span><span style="color: #2b91af; line-height: 140%;">Object</span><span style="line-height: 140%;">, _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">ByVal</span><span style="line-height: 140%;"> e </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> System.</span><span style="color: #2b91af; line-height: 140%;">EventArgs</span><span style="line-height: 140%;">) </span><span style="color: blue; line-height: 140%;">Handles</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">MyBase</span><span style="line-height: 140%;">.Load</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Sub</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: blue; line-height: 140%;">Private</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Sub</span><span style="line-height: 140%;"> Button1_Click( _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">ByVal</span><span style="line-height: 140%;"> sender </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> System.</span><span style="color: #2b91af; line-height: 140%;">Object</span><span style="line-height: 140%;">, _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">ByVal</span><span style="line-height: 140%;"> e </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> System.</span><span style="color: #2b91af; line-height: 140%;">EventArgs</span><span style="line-height: 140%;">) </span><span style="color: blue; line-height: 140%;">Handles</span><span style="line-height: 140%;"> Button1.Click</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> acType </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Type</span><span style="line-height: 140%;"> = _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; &nbsp; </span><span style="color: #2b91af; line-height: 140%;">Type</span><span style="line-height: 140%;">.GetTypeFromProgID(</span><span style="color: #a31515; line-height: 140%;">"AutoCAD.Application.18"</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> objAcad </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> AcadApplication = _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; &nbsp; System.</span><span style="color: #2b91af; line-height: 140%;">Activator</span><span style="line-height: 140%;">.CreateInstance(acType)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; objAcad.Visible = </span><span style="color: blue; line-height: 140%;">True</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; objAcad.WindowState = AcWindowState.acMin</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> bQuiet </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Boolean</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; bQuiet = objAcad.GetAcadState.IsQuiescent</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">If</span><span style="line-height: 140%;"> bQuiet = </span><span style="color: blue; line-height: 140%;">True</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Then</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; &nbsp; objAcad.Visible = </span><span style="color: blue; line-height: 140%;">True</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; &nbsp; MsgBox(</span><span style="color: #a31515; line-height: 140%;">"Autocad is quiet"</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">Else</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; &nbsp; MsgBox(</span><span style="color: #a31515; line-height: 140%;">"Autocad is not quiet"</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">If</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">With</span><span style="line-height: 140%;"> objAcad</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; &nbsp; MsgBox(</span><span style="color: #a31515; line-height: 140%;">"Setting single document mode to false"</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; &nbsp; .Preferences.System.SingleDocumentMode = </span><span style="color: blue; line-height: 140%;">False</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; &nbsp; MsgBox(</span><span style="color: #a31515; line-height: 140%;">"Adding a new blank doc"</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; &nbsp; .Documents.Add()</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; &nbsp; MsgBox(</span><span style="color: #a31515; line-height: 140%;">"Adding another new blank doc"</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; &nbsp; .Documents.Add()</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; &nbsp; MsgBox(</span><span style="color: #a31515; line-height: 140%;">"Beginning loop that closed docs"</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">Do</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">While</span><span style="line-height: 140%;"> .Documents.Count &lt;&gt; 1</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; &nbsp; &nbsp; MsgBox(</span><span style="color: #a31515; line-height: 140%;">"Closing a document"</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; &nbsp; &nbsp; .Documents.Item(1).Close(</span><span style="color: blue; line-height: 140%;">False</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">Loop</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; &nbsp; MsgBox(</span><span style="color: #a31515; line-height: 140%;">"Finished closing docs"</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">With</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Sub</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: blue; line-height: 140%;">Protected</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Overrides</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Sub</span><span style="line-height: 140%;"> Finalize()</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">MyBase</span><span style="line-height: 140%;">.Finalize()</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Sub</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: blue; line-height: 140%;">Private</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Sub</span><span style="line-height: 140%;"> Button2_Click( _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">ByVal</span><span style="line-height: 140%;"> sender </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> System.</span><span style="color: #2b91af; line-height: 140%;">Object</span><span style="line-height: 140%;">, _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">ByVal</span><span style="line-height: 140%;"> e </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> System.</span><span style="color: #2b91af; line-height: 140%;">EventArgs</span><span style="line-height: 140%;">) </span><span style="color: blue; line-height: 140%;">Handles</span><span style="line-height: 140%;"> Button2.Click</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">Me</span><span style="line-height: 140%;">.Close()</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Sub</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Class</span></p>
<p style="margin: 0px;">&nbsp;</p>
</div>
