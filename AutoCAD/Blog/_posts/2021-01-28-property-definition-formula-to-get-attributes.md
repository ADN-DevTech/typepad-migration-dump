---
layout: "post"
title: "Property Definition Formula to Get Attributes"
date: "2021-01-28 01:41:02"
author: "Madhukar Moogala"
categories:
  - "AutoCAD"
  - "Madhukar Moogala"
original_url: "https://adndevblog.typepad.com/autocad/2021/01/property-definition-formula-to-get-attributes.html "
typepad_basename: "property-definition-formula-to-get-attributes"
typepad_status: "Publish"
---

<p>Some properties return array of IDispatch which cannot be used in vbscript of formula definition, for instance the attributes returned by BlockReference are of VarType 8201 which is indicates an array of IDispatch pointers.
</p><p>Using ConvertToVariantArray can convert it to array of variant so that the elements can be reached in vbscript, just like the way how it converts a point value (array of double).
</p><p>NOTE: AutoCAD.Application.24 – AutoCAD 2021
</p><p>AecX.AecBaseApplication.8.3 – AutoCAD Architecture 2021.
</p><p>To know versions of various AEC libraries installed AutoCAD Architecture.
</p><p>Take a note of ACADVER of your current installed AutoCAD.
</p><div><table style="border-collapse:collapse" border="0"><colgroup><col style="width:519px"/><col style="width:520px"/><col style="width:520px"/></colgroup><tbody valign="top"><tr style="background: #70ad47"><td style="padding-left: 18px; padding-right: 18px; border-top:  solid 0.5pt; border-left:  solid 0.5pt; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt"><p>AutoCAD Architecture</p></td><td style="padding-left: 18px; padding-right: 18px; border-top:  solid 0.5pt; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt"><p>ACADVER</p></td><td style="padding-left: 18px; padding-right: 18px; border-top:  solid 0.5pt; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt"><p>AEC Lib</p></td></tr><tr><td style="padding-left: 18px; padding-right: 18px; border-top:  none; border-left:  solid 0.5pt; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt"><p>2021</p></td><td style="padding-left: 18px; padding-right: 18px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt"><p>24.0</p></td><td style="padding-left: 18px; padding-right: 18px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt"><p>8.3</p></td></tr><tr><td style="padding-left: 18px; padding-right: 18px; border-top:  none; border-left:  solid 0.5pt; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt"><p>2020</p></td><td style="padding-left: 18px; padding-right: 18px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt"><p>23.1</p></td><td style="padding-left: 18px; padding-right: 18px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt"><p>8.2</p></td></tr><tr><td style="padding-left: 18px; padding-right: 18px; border-top:  none; border-left:  solid 0.5pt; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt"><p>2019</p></td><td style="padding-left: 18px; padding-right: 18px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt"><p>23.0</p></td><td style="padding-left: 18px; padding-right: 18px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt"><p>8.1</p></td></tr><tr><td style="padding-left: 18px; padding-right: 18px; border-top:  none; border-left:  solid 0.5pt; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt"><p>2018</p></td><td style="padding-left: 18px; padding-right: 18px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt"><p>22.0</p></td><td style="padding-left: 18px; padding-right: 18px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt"><p>8.0</p></td></tr><tr><td style="padding-left: 18px; padding-right: 18px; border-top:  none; border-left:  solid 0.5pt; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt"><p>2017</p></td><td style="padding-left: 18px; padding-right: 18px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt"><p>21.0</p></td><td style="padding-left: 18px; padding-right: 18px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt"><p>7.9</p></td></tr><tr><td style="padding-left: 18px; padding-right: 18px; border-top:  none; border-left:  solid 0.5pt; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt"><p>2016</p></td><td style="padding-left: 18px; padding-right: 18px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt"><p>20.1</p></td><td style="padding-left: 18px; padding-right: 18px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt"><p>7.8</p></td></tr><tr><td style="padding-left: 18px; padding-right: 18px; border-top:  none; border-left:  solid 0.5pt; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt"><p>2015</p></td><td style="padding-left: 18px; padding-right: 18px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt"><p>20.0</p></td><td style="padding-left: 18px; padding-right: 18px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt"><p>7.7</p></td></tr><tr><td style="padding-left: 18px; padding-right: 18px; border-top:  none; border-left:  solid 0.5pt; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt"><p>2014</p></td><td style="padding-left: 18px; padding-right: 18px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt"><p>19.1</p></td><td style="padding-left: 18px; padding-right: 18px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt"><p>7.5</p></td></tr><tr><td style="padding-left: 18px; padding-right: 18px; border-top:  none; border-left:  solid 0.5pt; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt"><p>2013</p></td><td style="padding-left: 18px; padding-right: 18px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt"><p>19.0</p></td><td style="padding-left: 18px; padding-right: 18px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt"><p>7.0</p></td></tr><tr><td style="padding-left: 18px; padding-right: 18px; border-top:  none; border-left:  solid 0.5pt; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt"><p>2012</p></td><td style="padding-left: 18px; padding-right: 18px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt"><p>18.2</p></td><td style="padding-left: 18px; padding-right: 18px; border-top:  none; border-left:  none; border-bottom:  solid 0.5pt; border-right:  solid 0.5pt"><p>6.7</p></td></tr></tbody></table></div><p>
 </p><p>RESULT="--"
</p><p>On Error Resume Next
</p><p>set acad = GetObject(, "AutoCAD.Application.24")
</p><p>set aec = acad.GetInterfaceObject("AecX.AecBaseApplication.8.3")
</p><p>aec.Init acad
</p><p>set utility = aec.ActiveDocument.Utility
</p><p>set obj = acad.ActiveDocument.ObjectIDToObject([ObjectID])
</p><p>attributes = utility.ConvertToVariantArray(obj.GetAttributes)
</p><p>set attribute = attributes(0)
</p><p>RESULT = attribute.TextString    
</p><p>
 </p><p>
 </p><p><img src="/assets/image_580759.jpg" alt=""/><span style="font-family:Verdana; font-size:8pt">
		</span></p><p>
 </p>
