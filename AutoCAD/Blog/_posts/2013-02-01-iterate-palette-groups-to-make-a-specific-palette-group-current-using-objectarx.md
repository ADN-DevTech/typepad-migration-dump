---
layout: "post"
title: "Iterate Palette Groups to make a specific Palette group current using ObjectARX"
date: "2013-02-01 11:12:42"
author: "Fenton Webb"
categories:
  - "2010"
  - "2011"
  - "2012"
  - "AutoCAD"
  - "Fenton Webb"
  - "UI"
original_url: "https://adndevblog.typepad.com/autocad/2013/02/iterate-palette-groups-to-make-a-specific-palette-group-current-using-objectarx.html "
typepad_basename: "iterate-palette-groups-to-make-a-specific-palette-group-current-using-objectarx"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/fenton-webb.html">Fenton Webb</a></p>  <p><b>Issue</b></p>  <p>Is there a way to programmatically set a palette group as the active palette group?</p>  <p><a name="section2"></a></p>  <p><b>Solution</b></p>  <p>The palette group returned by CAcTcUiToolPaletteSet::GetToolPaletteGroup() can be iterated. If the item is not a palette and the palette group has the name you want, you can make it the active palette group with SetActivePaletteGroup(). </p>  <p>This example gets all the pallet groups and displays the name of each palette group in a MessageBox. If the name of the palette group is &quot;wbPGroup&quot;, it is made into the current group.</p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">static</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">ASDKtestTpGroup</font></span><font color="#000000">(</font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">{</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">CAcTcUiToolPaletteSet</font></span><font color="#000000"> * </font><span style="color: "><font color="#010001">pTpset</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">AcTcUiGetToolPaletteWindow</font></span><font color="#000000">();</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">CAcTcUiToolPaletteGroup</font></span><font color="#000000"> * </font><span style="color: "><font color="#010001">pTpgroup</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">pTpset</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#010001">GetToolPaletteGroup</font></span><font color="#000000">(</font><span style="color: "><font color="#0000ff">false</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">CAcTcUiToolPaletteGroup</font></span><font color="#000000"> * </font><span style="color: "><font color="#010001">pTpSubGroup</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">CString</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">groupName</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">int</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">iCount</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">pTpgroup</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#010001">GetItemCount</font></span><font color="#000000">();</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">for</font></span><font color="#000000">(</font><span style="color: "><font color="#0000ff">int</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">i</font></span><font color="#000000"> = 0; </font><span style="color: "><font color="#010001">i</font></span><font color="#000000">&lt;</font><span style="color: "><font color="#010001">iCount</font></span><font color="#000000">; </font><span style="color: "><font color="#010001">i</font></span><font color="#000000">++)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160; {</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000">(!</font><span style="color: "><font color="#010001">pTpgroup</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#010001">IsItemPalette</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">i</font></span><font color="#000000">))</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">pTpgroup</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#010001">GetItem</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">i</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">pTpSubGroup</font></span><font color="#000000">); </font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">groupName</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">pTpSubGroup</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#010001">GetName</font></span><font color="#000000">();</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; ::</font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">MessageBox</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">NULL</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">groupName</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">_T</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;Summary Information&quot;</font></span><font color="#000000">), </font><span style="color: "><font color="#010001">MB_OK</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">groupName</font></span><font color="#000000"> == </font><span style="color: "><font color="#a31515">&quot;wbPGroup&quot;</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">pTpset</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#010001">SetActivePaletteGroup</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">pTpSubGroup</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160; }</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">}</font></font></p> </div>
