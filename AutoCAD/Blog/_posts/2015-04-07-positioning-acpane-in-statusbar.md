---
layout: "post"
title: "Positioning AcPane in StatusBar"
date: "2015-04-07 03:31:11"
author: "Madhukar Moogala"
categories:
  - "2015"
  - "AutoCAD"
  - "Madhukar Moogala"
  - "ObjectARX"
original_url: "https://adndevblog.typepad.com/autocad/2015/04/positioning-acpane-in-statusbar.html "
typepad_basename: "positioning-acpane-in-statusbar"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/Madhukar-Moogala.html" target="_self">Madhukar Moogala</a></p> Iâ€™ve recently received a query from an ADN partner about positioning AcPane, I will show sample code to achieve the same.    <p>Before getting in to the code, just want to inform you that with Acad 2015 support for showing text labels on the buttons in the status bar is not available.</p>  <p>Earlier we can switch between text labels and icons of status bar panes, now only icons.</p>  <p>I got an opportunity to migrate a very old sample on status bar which was shipped with ObjectARX SDK 2007&#160; to current AutoCAD 2014/15.</p>  <div style="font-size: 9pt; font-family: consolas; background: white; color: black">   <p style="margin: 0px"></p> </div>  <div style="font-size: 9pt; font-family: consolas; background: white; color: black">   <p style="margin: 0px"><span style="color: blue">void</span> testPane()</p>    <p style="margin: 0px">{</p>    <p style="margin: 0px"><span style="color: blue">int</span> result;</p>    <p style="margin: 0px"><span style="color: #2b91af">AcApDocument</span> *pDoc=<span style="color: #6f008a">acDocManager</span>-&gt;curDocument();</p>    <p style="margin: 0px"><span style="color: #2b91af">AcApStatusBar</span>* pStatus = acedGetApplicationStatusBar();&#160; </p>    <p style="margin: 0px"><span style="color: blue">if</span> (pStatus)&#160; </p>    <p style="margin: 0px">{&#160; </p>    <p style="margin: 0px"><span style="color: green">/*Get pane count*/</span></p>    <p style="margin: 0px"><span style="color: blue">int</span> iCnt = pStatus-&gt;GetPaneCount();</p>    <p style="margin: 0px"><span style="color: green">/*Get default pane to position our custom pane */</span></p>    <p style="margin: 0px"><span style="color: #2b91af">AcPane</span>* pdfltPane = </p>    <p style="margin: 0px">pStatus-&gt;GetDefaultPane(<span style="color: #2f4f4f">ACSBPANE_APP_ORTHO</span>);</p>    <p style="margin: 0px"><span style="color: blue">int</span> index = </p>    <p style="margin: 0px">pStatus-&gt;GetIndex(pdfltPane);</p>    <p style="margin: 0px"><span style="color: blue">int</span> iStyle=</p>    <p style="margin: 0px">pdfltPane-&gt;GetStyle();&#160; </p>    <p style="margin: 0px"><span style="color: #2b91af">CPaneItem</span>* pPaneItem = <span style="color: blue">new</span> <span style="color: #2b91af">CPaneItem</span>();</p>    <p style="margin: 0px">result=</p>    <p style="margin: 0px">pPaneItem-&gt;SetToolTipText(</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #6f008a">_T</span>(<span style="color: #a31515">&quot;Pane Icon Item Tooltip&quot;</span>));</p>    <p style="margin: 0px">pPaneItem-&gt;Enable(<span style="color: #6f008a">TRUE</span>);</p>    <p style="margin: 0px">result=pPaneItem-&gt;SetStyle(iStyle);</p>    <p style="margin: 0px">pPaneItem-&gt;SetVisible(<span style="color: #6f008a">TRUE</span>);</p>    <p style="margin: 0px"><span style="color: #2b91af">HICON</span> hIcon = </p>    <p style="margin: 0px">(<span style="color: #2b91af">HICON</span>)::<span style="color: #6f008a">LoadImage</span>(_hdllInstance,</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #6f008a">MAKEINTRESOURCE</span>(<span style="color: #6f008a">IDI_WORLD</span>),</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #6f008a">IMAGE_ICON</span>, 16, 16, 0);</p>    <p style="margin: 0px">result=pPaneItem-&gt;SetIcon(hIcon);&#160;&#160;&#160; </p>    <p style="margin: 0px">result = pStatus-&gt;Insert(index+1, pPaneItem);&#160; </p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">}&#160; </p>    <p style="margin: 0px">pStatus-&gt;Update();&#160; </p> </div>  <p>&#160;</p>  <p>SDK migrated <a href="https://github.com/MadhukarMoogala/MyBlogs/tree/master/StatusBar" target="_blank">sample</a></p>
