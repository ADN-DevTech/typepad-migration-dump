---
layout: "post"
title: "Get a group code value using the ActiveX API"
date: "2013-01-14 17:12:03"
author: "Gopinath Taget"
categories:
  - "2010"
  - "2011"
  - "2012"
  - "2013"
  - "ActiveX"
  - "AutoCAD"
  - "Gopinath Taget"
original_url: "https://adndevblog.typepad.com/autocad/2013/01/get-a-group-code-value-using-the-activex-api.html "
typepad_basename: "get-a-group-code-value-using-the-activex-api"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/gopinath-taget.html">Gopinath Taget</a></p>  <p>There is no straight-forward method to get the group code value in activex. You can use a lisp string along with a user variable to get the value. For instance if you want to find out if an XRef is attached or an Overlay, you can use Group Code 70 to determine this.</p>  <p>Here is the VB snippet for this:</p>  <p><font face="Courier New"><font size="1"><span style="line-height: 1; white-space: nowrap" class="sc3"><font color="#0000ff">Sub</font></span><font color="#000000"><span style="line-height: 1; white-space: nowrap" class="sc0"> </span><span style="line-height: 1; white-space: nowrap" class="sc7">GetXRefType</span><span style="line-height: 1; white-space: nowrap" class="sc6"><strong>()</strong></span><span style="line-height: 1; white-space: nowrap" class="sc0"> </span></font></font></font></p>  <p><font face="Courier New"><font size="1"><font color="#000000"><span style="line-height: 1; white-space: nowrap" class="sc0"></span></font><span style="line-height: 1; white-space: nowrap" class="sc1"><font color="#008000">'note there is no error handling included </font></span></font></font></p>  <p><font face="Courier New"><span style="line-height: 1; white-space: nowrap" class="sc1"></span><span style="line-height: 1; white-space: nowrap" class="sc0"></span><font size="1"><span style="line-height: 1; white-space: nowrap" class="sc3"><font color="#0000ff">Dim</font></span><font color="#000000"><span style="line-height: 1; white-space: nowrap" class="sc0"> </span><span style="line-height: 1; white-space: nowrap" class="sc7">ps_str</span><span style="line-height: 1; white-space: nowrap" class="sc0"> </span></font><span style="line-height: 1; white-space: nowrap" class="sc3"><font color="#0000ff">As</font></span><span style="line-height: 1; white-space: nowrap" class="sc0"><font color="#000000"> </font></span><span style="line-height: 1; white-space: nowrap" class="sc3"><font color="#0000ff">String</font></span><span style="line-height: 1; white-space: nowrap" class="sc0"><font color="#000000"> </font></span></font></font></p>  <p><font face="Courier New"><span style="line-height: 1; white-space: nowrap" class="sc0"></span><font size="1"><span style="line-height: 1; white-space: nowrap" class="sc3"><font color="#0000ff">Dim</font></span><font color="#000000"><span style="line-height: 1; white-space: nowrap" class="sc0"> </span><span style="line-height: 1; white-space: nowrap" class="sc7">po_blk</span><span style="line-height: 1; white-space: nowrap" class="sc0"> </span></font><span style="line-height: 1; white-space: nowrap" class="sc3"><font color="#0000ff">As</font></span><font color="#000000"><span style="line-height: 1; white-space: nowrap" class="sc0"> </span><span style="line-height: 1; white-space: nowrap" class="sc7">AcadBlock</span><span style="line-height: 1; white-space: nowrap" class="sc0"> </span></font></font></font></p>  <p><font face="Courier New"><font color="#000000"><span style="line-height: 1; white-space: nowrap" class="sc0"></span></font><font size="1"><span style="line-height: 1; white-space: nowrap" class="sc3"><font color="#0000ff">Dim</font></span><font color="#000000"><span style="line-height: 1; white-space: nowrap" class="sc0"> </span><span style="line-height: 1; white-space: nowrap" class="sc7">po_blkref</span><span style="line-height: 1; white-space: nowrap" class="sc0"> </span></font><span style="line-height: 1; white-space: nowrap" class="sc3"><font color="#0000ff">As</font></span><font color="#000000"><span style="line-height: 1; white-space: nowrap" class="sc0"> </span><span style="line-height: 1; white-space: nowrap" class="sc7">AcadEntity</span><span style="line-height: 1; white-space: nowrap" class="sc0"> </span></font></font></font></p>  <p><font face="Courier New"><font size="1"><font color="#000000"><span style="line-height: 1; white-space: nowrap" class="sc0"></span></font><span style="line-height: 1; white-space: nowrap" class="sc3"><font color="#0000ff">Dim</font></span><font color="#000000"><span style="line-height: 1; white-space: nowrap" class="sc0"> </span><span style="line-height: 1; white-space: nowrap" class="sc7">pi_dxf70</span><span style="line-height: 1; white-space: nowrap" class="sc0"> </span></font><span style="line-height: 1; white-space: nowrap" class="sc3"><font color="#0000ff">As</font></span><span style="line-height: 1; white-space: nowrap" class="sc0"><font color="#000000"> </font></span></font></font><font face="Courier New"><font size="1"><span style="line-height: 1; white-space: nowrap" class="sc3"><font color="#0000ff">Integer</font></span><span style="line-height: 1; white-space: nowrap" class="sc0"><font color="#000000"> </font></span></font></font></p>  <p><font face="Courier New"><font size="1"><span style="line-height: 1; white-space: nowrap" class="sc0"></span><span style="line-height: 1; white-space: nowrap" class="sc3"><font color="#0000ff">Dim</font></span><font color="#000000"><span style="line-height: 1; white-space: nowrap" class="sc0"> </span><span style="line-height: 1; white-space: nowrap" class="sc7">pv_1</span><span style="line-height: 1; white-space: nowrap" class="sc0"> </span></font><span style="line-height: 1; white-space: nowrap" class="sc3"><font color="#0000ff">As</font></span><span style="line-height: 1; white-space: nowrap" class="sc0"><font color="#000000"> </font></span><span style="line-height: 1; white-space: nowrap" class="sc3"><font color="#0000ff">Variant</font></span><font color="#000000"><span style="line-height: 1; white-space: nowrap" class="sc0"> </span><span style="line-height: 1; white-space: nowrap" class="sc7"></span></font></font></font></p>  <p><font face="Courier New"><font size="1"><font color="#000000"><span style="line-height: 1; white-space: nowrap" class="sc7">ThisDrawing.Utility.GetEntity</span><span style="line-height: 1; white-space: nowrap" class="sc0"> </span><span style="line-height: 1; white-space: nowrap" class="sc7">po_blkref</span><span style="line-height: 1; white-space: nowrap" class="sc6"><strong>,</strong></span><span style="line-height: 1; white-space: nowrap" class="sc0"> </span><span style="line-height: 1; white-space: nowrap" class="sc7">pv_1</span><span style="line-height: 1; white-space: nowrap" class="sc6"><strong>,</strong></span><span style="line-height: 1; white-space: nowrap" class="sc0"> </span></font><span style="line-height: 1; white-space: nowrap" class="sc4"><font color="#808080">&quot;Select an xref...&quot;</font></span><span style="line-height: 1; white-space: nowrap" class="sc0"><font color="#000000"> </font></span></font></font></p>  <p><font face="Courier New"><span style="line-height: 1; white-space: nowrap" class="sc0"></span><font size="1"><span style="line-height: 1; white-space: nowrap" class="sc3"><font color="#0000ff">Set</font></span><font color="#000000"><span style="line-height: 1; white-space: nowrap" class="sc0"> </span><span style="line-height: 1; white-space: nowrap" class="sc7">po_blk</span><span style="line-height: 1; white-space: nowrap" class="sc0"> </span><span style="line-height: 1; white-space: nowrap" class="sc6"><strong>=</strong></span><span style="line-height: 1; white-space: nowrap" class="sc0"> </span></font></font></font><font face="Courier New"><font size="1"><font color="#000000"><span style="line-height: 1; white-space: nowrap" class="sc7">ThisDrawing.Blocks</span><span style="line-height: 1; white-space: nowrap" class="sc6"><strong>(</strong></span><span style="line-height: 1; white-space: nowrap" class="sc7">po_blkref.Name</span><span style="line-height: 1; white-space: nowrap" class="sc6"><strong>)</strong></span><span style="line-height: 1; white-space: nowrap" class="sc0"> </span><span style="line-height: 1; white-space: nowrap" class="sc7">ps_str</span><span style="line-height: 1; white-space: nowrap" class="sc0"> </span><span style="line-height: 1; white-space: nowrap" class="sc6"><strong>=</strong></span><span style="line-height: 1; white-space: nowrap" class="sc0"> </span></font><span style="line-height: 1; white-space: nowrap" class="sc4"><font color="#808080">&quot;(SETVAR &quot;&quot;USERR1&quot;&quot; (cdr (assoc 70 (tblsearch &quot;&quot;BLOCK&quot;&quot; &quot;&quot;&quot;</font></span><font color="#000000"><span style="line-height: 1; white-space: nowrap" class="sc0"> </span><span style="line-height: 1; white-space: nowrap" class="sc6"><strong>&amp;</strong></span><span style="line-height: 1; white-space: nowrap" class="sc0"> </span><span style="line-height: 1; white-space: nowrap" class="sc7">po_blkref.Name</span><span style="line-height: 1; white-space: nowrap" class="sc0"> </span><span style="line-height: 1; white-space: nowrap" class="sc6"><strong>&amp;</strong></span><span style="line-height: 1; white-space: nowrap" class="sc0"> </span></font><span style="line-height: 1; white-space: nowrap" class="sc4"><font color="#808080">&quot;&quot;&quot;)))) &quot;</font></span><font color="#000000"><span style="line-height: 1; white-space: nowrap" class="sc0"> </span><span style="line-height: 1; white-space: nowrap" class="sc7"></span></font></font></font></p>  <p><font face="Courier New"><font color="#000000"><font size="1"><span style="line-height: 1; white-space: nowrap" class="sc7">ThisDrawing.SendCommand</span><span style="line-height: 1; white-space: nowrap" class="sc0"> </span><span style="line-height: 1; white-space: nowrap" class="sc7">ps_str</span><span style="line-height: 1; white-space: nowrap" class="sc0"> </span></font></font></font></p>  <p><font face="Courier New"><font size="1"><font color="#000000"><span style="line-height: 1; white-space: nowrap" class="sc7">pi_dxf70</span><span style="line-height: 1; white-space: nowrap" class="sc0"> </span><span style="line-height: 1; white-space: nowrap" class="sc6"><strong>=</strong></span><span style="line-height: 1; white-space: nowrap" class="sc0"> </span><span style="line-height: 1; white-space: nowrap" class="sc7">ThisDrawing.GetVariable</span><span style="line-height: 1; white-space: nowrap" class="sc6"><strong>(</strong></span></font><span style="line-height: 1; white-space: nowrap" class="sc4"><font color="#808080">&quot;USERR1&quot;</font></span><font color="#000000"><span style="line-height: 1; white-space: nowrap" class="sc6"><strong>)</strong></span><span style="line-height: 1; white-space: nowrap" class="sc0"> </span></font></font></font></p>  <p><font face="Courier New"><font color="#000000"><span style="line-height: 1; white-space: nowrap" class="sc0"></span></font><font size="1"><span style="line-height: 1; white-space: nowrap" class="sc3"><font color="#0000ff">If</font></span><font color="#000000"><span style="line-height: 1; white-space: nowrap" class="sc0"> </span><span style="line-height: 1; white-space: nowrap" class="sc7">pi_dxf70</span><span style="line-height: 1; white-space: nowrap" class="sc0"> </span><span style="line-height: 1; white-space: nowrap" class="sc6"><strong>=</strong></span><span style="line-height: 1; white-space: nowrap" class="sc0"> </span></font><span style="line-height: 1; white-space: nowrap" class="sc2"><font color="#ff0000"><strong>44</strong></font></span><span style="line-height: 1; white-space: nowrap" class="sc0"><font color="#000000"> </font></span><span style="line-height: 1; white-space: nowrap" class="sc3"><font color="#0000ff">Then</font></span><font color="#000000"><span style="line-height: 1; white-space: nowrap" class="sc0"> </span><span style="line-height: 1; white-space: nowrap" class="sc7">MsgBox</span><span style="line-height: 1; white-space: nowrap" class="sc0"> </span></font><span style="line-height: 1; white-space: nowrap" class="sc4"><font color="#808080">&quot;XREF &quot;</font></span><font color="#000000"><span style="line-height: 1; white-space: nowrap" class="sc0"> </span><span style="line-height: 1; white-space: nowrap" class="sc6"><strong>&amp;</strong></span><span style="line-height: 1; white-space: nowrap" class="sc0"> </span><span style="line-height: 1; white-space: nowrap" class="sc7">po_blk.Name</span><span style="line-height: 1; white-space: nowrap" class="sc0"> </span><span style="line-height: 1; white-space: nowrap" class="sc6"><strong>&amp; </strong></span></font><span style="line-height: 1; white-space: nowrap" class="sc4"><font color="#808080">&quot; is Overlaid.&quot;</font></span><span style="line-height: 1; white-space: nowrap" class="sc0"><font color="#000000"> </font></span></font></font></p>  <p><font face="Courier New"><span style="line-height: 1; white-space: nowrap" class="sc0"></span><font size="1"><span style="line-height: 1; white-space: nowrap" class="sc3"><font color="#0000ff">If</font></span><font color="#000000"><span style="line-height: 1; white-space: nowrap" class="sc0"> </span><span style="line-height: 1; white-space: nowrap" class="sc7">pi_dxf70</span><span style="line-height: 1; white-space: nowrap" class="sc0"> </span><span style="line-height: 1; white-space: nowrap" class="sc6"><strong>=</strong></span><span style="line-height: 1; white-space: nowrap" class="sc0"> </span></font><span style="line-height: 1; white-space: nowrap" class="sc2"><font color="#ff0000"><strong>36</strong></font></span><span style="line-height: 1; white-space: nowrap" class="sc0"><font color="#000000"> </font></span><span style="line-height: 1; white-space: nowrap" class="sc3"><font color="#0000ff">Then</font></span><font color="#000000"><span style="line-height: 1; white-space: nowrap" class="sc0"> </span><span style="line-height: 1; white-space: nowrap" class="sc7">MsgBox</span><span style="line-height: 1; white-space: nowrap" class="sc0"> </span></font><span style="line-height: 1; white-space: nowrap" class="sc4"><font color="#808080">&quot;XREF &quot;</font></span><font color="#000000"><span style="line-height: 1; white-space: nowrap" class="sc0"> </span><span style="line-height: 1; white-space: nowrap" class="sc6"><strong>&amp;</strong></span><span style="line-height: 1; white-space: nowrap" class="sc0"> </span><span style="line-height: 1; white-space: nowrap" class="sc7">po_blk.Name</span><span style="line-height: 1; white-space: nowrap" class="sc0"> </span><span style="line-height: 1; white-space: nowrap" class="sc6"><strong>&amp;</strong></span><span style="line-height: 1; white-space: nowrap" class="sc0"> </span></font><span style="line-height: 1; white-space: nowrap" class="sc4"><font color="#808080">&quot; is Attached.&quot;</font></span><span style="line-height: 1; white-space: nowrap" class="sc0"><font color="#000000"> </font></span></font></font></p>  <p><font face="Courier New"><span style="line-height: 1; white-space: nowrap" class="sc0"></span><font size="1"><span style="line-height: 1; white-space: nowrap" class="sc3"><font color="#0000ff">End</font></span><span style="line-height: 1; white-space: nowrap" class="sc0"><font color="#000000"> </font></span><span style="line-height: 1; white-space: nowrap" class="sc3"><font color="#0000ff">Sub</font></span></font></font></p>
