---
layout: "post"
title: "Using Lisp to set Annotation Scale for a Viewport"
date: "2012-05-25 16:52:54"
author: "Gopinath Taget"
categories:
  - ".NET"
  - "2010"
  - "2011"
  - "2012"
  - "2013"
  - "AutoCAD"
  - "Gopinath Taget"
original_url: "https://adndevblog.typepad.com/autocad/2012/05/using-lisp-to-set-annotation-scale-for-a-viewport.html "
typepad_basename: "using-lisp-to-set-annotation-scale-for-a-viewport"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/gopinath-taget.html">Gopinath Taget</a></p>
<p>There is no AutoLISP function or ActiveX method to set the Annotation scale for a viewport. It is not possible to do this by manipulating the XRecord named “ASDK_XREC_ANNOTATION_SCALE_INFO” of the Extension dictionary of the viewport either. The way the annotation scale is controlled is by a DXF code on the XRecord with a hard pointer to an AcDbScale object.&#0160; Because entmod is unsupported for objects in a dictionary there is not a way to change the scale for a viewport using AutoLISP.</p>
<p>A work around is to use ObjectARX or the .NET API to change the annotation scale of the viewport. The function to use is in ObjectARX is AcDbViewport::setAnnotationScale().&#0160; In .NET this is wrapped in the Viewport.AnnotationScale Property. You can create a function that can be called from your LISP code to set the scale. Here is a VB.NET example:</p>
<div style="background: white;">
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&lt;</span></span></span><span><span style="line-height: 11pt;"><span style="color: #2b91af;">LispFunction</span></span><span style="line-height: 11pt;"><span style="color: #000000;">(</span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;ChangeVPScale&quot;</span></span></span><span style="line-height: 11pt;"><span style="color: #000000;">)&gt; _</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span>Public</span></span></span><span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Shared</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Function</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> changeVPScale(</span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">ByVal</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> myLispArgs </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">ResultBuffer</span></span></span><span style="line-height: 11pt;"><span style="color: #000000;">) _</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">ResultBuffer</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;</span></span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160; </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> rbfResult </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">ResultBuffer</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> = </span></span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Nothing</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160; </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> db </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Database</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> =</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">&#0160; </span></span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span><span style="line-height: 11pt;"><span style="color: #2b91af;">&#0160;&#0160; HostApplicationServices</span></span></span><span style="line-height: 11pt;"><span style="color: #000000;">.WorkingDatabase</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160; </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> tm </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Transaction</span></span></span><span style="line-height: 11pt;"><span style="color: #000000;"> = </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160; db.TransactionManager.StartTransaction</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160; </span></span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Try</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> doc </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">as</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Document</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> = </span></span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160; Autodesk.AutoCAD.ApplicationServices.</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Application</span></span></span><span style="line-height: 11pt;"><span style="color: #000000;">.</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; DocumentManager.MdiActiveDocument</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> ed </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Editor</span></span></span><span style="line-height: 11pt;"><span style="color: #000000;"> = doc.Editor</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">If</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> myLispArgs </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Is</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Nothing</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Then</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="color: #008000;">&#39; Write a message on the AutoCAD command line</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160; ed.WriteMessage(</span></span></span><span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;No Arguments passed in&quot;</span></span></span><span style="line-height: 11pt;"><span style="color: #000000;"> &amp; vbLf)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">Return</span></span></span><span style="line-height: 11pt;"><span style="color: #000000;"> myLispArgs</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Else</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> myArgs </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">TypedValue</span></span></span><span style="line-height: 11pt;"><span style="color: #000000;">() = myLispArgs.AsArray()</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="color: #008000;">&#39; Ensure that an ObjectId was passed in</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">If</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> myArgs(0).TypeCode = </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">LispDataType</span></span><span style="line-height: 11pt;"><span style="color: #000000;">.ObjectId </span></span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Then</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="color: #008000;">&#39; Ensure that a Viewport was selected by the user&#0160;&#0160;&#0160; </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> dbObj </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">DBObject</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> objID </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">ObjectId</span></span></span><span style="line-height: 11pt;"><span style="color: #000000;"> = myArgs(0).Value</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; dbObj = tm.GetObject(objID, </span></span></span><span><span style="line-height: 11pt;"><span style="color: #2b91af;">OpenMode</span></span></span><span style="line-height: 11pt;"><span style="color: #000000;">.ForWrite)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">If</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">TypeOf</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> dbObj </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Is</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Viewport</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Then</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> viewPrt </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Viewport</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; viewPrt = </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">CType</span></span><span style="line-height: 11pt;"><span style="color: #000000;">(dbObj, </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Viewport</span></span></span><span style="line-height: 11pt;"><span style="color: #000000;">)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">If</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> myArgs(1).TypeCode = </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">LispDataType</span></span><span style="line-height: 11pt;"><span style="color: #000000;">.Text </span></span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Then</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> contextManager </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">ObjectContextManager</span></span></span><span style="line-height: 11pt;"><span style="color: #000000;"> = </span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; db.ObjectContextManager</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">If</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> contextManager &lt;&gt; </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Nothing</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Then</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="color: #008000;">&#39;now get the Annotation Scaling context </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="color: #008000;">&#39;collection (named </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #008000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39;ACDB_ANNOTATIONSCALES_COLLECTION)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> contextCollection </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">&#0160;</span></span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span><span style="line-height: 11pt;"><span style="color: #2b91af;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ObjectContextCollection</span></span></span><span style="line-height: 11pt;"><span style="color: #000000;"> = </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; contextManager.GetContextCollection</span></span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (</span></span></span><span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;ACDB_ANNOTATIONSCALES&quot;</span></span></span><span style="line-height: 11pt;"><span style="color: #000000;">)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="color: #008000;">&#39; </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">If</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> contextCollection &lt;&gt; </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Nothing</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Then</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> objCol </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">ObjectContext</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">For</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Each</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> objCol </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">In</span></span></span><span style="line-height: 11pt;"><span style="color: #000000;"> contextCollection</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">If</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> objCol.Name = myArgs(1).Value </span></span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Then</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ed.WriteMessage(objCol.Name.ToString())</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; viewPrt.AnnotationScale = objCol</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; tm.Commit()</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; rbfResult = </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">New</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">ResultBuffer</span></span></span><span style="line-height: 11pt;"><span style="color: #000000;">( _</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">New</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">TypedValue</span></span><span style="line-height: 11pt;"><span style="color: #000000;">(</span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">CInt</span></span></span><span style="line-height: 11pt;"><span style="color: #000000;">(5005), _</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;Changed the Annotation scale </span></span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span><span style="line-height: 11pt;"><span style="color: #a31515;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; of the ViewPort&quot;</span></span></span><span style="line-height: 11pt;"><span style="color: #000000;">))</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">Return</span></span></span><span style="line-height: 11pt;"><span style="color: #000000;"> rbfResult</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Exit For</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">If</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Next</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Else</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; tm.Abort()</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; rbfResult = </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">New</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">ResultBuffer</span></span></span><span style="line-height: 11pt;"><span style="color: #000000;">( _</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">New</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">TypedValue</span></span><span style="line-height: 11pt;"><span style="color: #000000;">(</span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">CInt</span></span><span style="line-height: 11pt;"><span style="color: #000000;">(5005), </span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;Problem getting </span></span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span><span style="line-height: 11pt;"><span style="color: #a31515;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; scale collection&quot;</span></span></span><span style="line-height: 11pt;"><span style="color: #000000;">))</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">Return</span></span></span><span style="line-height: 11pt;"><span style="color: #000000;"> rbfResult</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">If</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">If</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Else</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; rbfResult = </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">New</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">ResultBuffer</span></span></span><span style="line-height: 11pt;"><span style="color: #000000;">( _</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">New</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">TypedValue</span></span><span style="line-height: 11pt;"><span style="color: #000000;">(</span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">CInt</span></span><span style="line-height: 11pt;"><span style="color: #000000;">(5005), </span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;second </span></span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span><span style="line-height: 11pt;"><span style="color: #a31515;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; argument not text&quot;</span></span></span><span style="line-height: 11pt;"><span style="color: #000000;">))</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">Return</span></span></span><span style="line-height: 11pt;"><span style="color: #000000;"> rbfResult</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">If</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Else</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="color: #008000;">&#39; Return do not have a Viewport</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; rbfResult = </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">New</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">ResultBuffer</span></span></span><span style="line-height: 11pt;"><span style="color: #000000;">( _</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">New</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">TypedValue</span></span><span style="line-height: 11pt;"><span style="color: #000000;">(</span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">CInt</span></span></span><span style="line-height: 11pt;"><span style="color: #000000;">(5005), </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; color: #000000;"><span style="line-height: 11pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-family: Courier New;"><span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;Selected entity not ViewPort&quot;</span></span></span><span style="line-height: 11pt;"><span style="color: #000000;">))</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; tm.Abort()</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">Return</span></span></span><span style="line-height: 11pt;"><span style="color: #000000;"> rbfResult</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">If</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Else</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="color: #008000;">&#39; Return do not have a Viewport</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; rbfResult = </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">New</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">ResultBuffer</span></span></span><span style="line-height: 11pt;"><span style="color: #000000;">( _</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">New</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">TypedValue</span></span><span style="line-height: 11pt;"><span style="color: #000000;">(</span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">CInt</span></span><span style="line-height: 11pt;"><span style="color: #000000;">(</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">LispDataType</span></span></span><span style="line-height: 11pt;"><span style="color: #000000;">.Text), </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;Argument passed in not an ObjectId&quot;</span></span></span><span style="line-height: 11pt;"><span style="color: #000000;">))</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; tm.Abort()</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">Return</span></span></span><span style="line-height: 11pt;"><span style="color: #000000;"> rbfResult</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">If</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">If</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160; </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">Catch</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> ex </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> System.</span></span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Exception</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160;&#0160;&#0160; System.Diagnostics.</span></span></span><span><span style="line-height: 11pt;"><span style="color: #2b91af;">Debug</span></span></span><span style="line-height: 11pt;"><span style="color: #000000;">.Write(ex.ToString())</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160; </span></span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Finally</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;&#0160;&#0160; tm.Dispose()</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160; </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Try</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span>&#0160; </span></span></span><span><span style="line-height: 11pt;"><span style="color: #0000ff;">Return</span></span></span><span style="line-height: 11pt;"><span style="color: #000000;"> rbfResult</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span>End</span></span></span><span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Function</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; color: #0000ff;">&#0160;</span></p>
<p>And the LISP function:</p>
<p>&lt;code_Begin&gt; <br />(defun changescale ( / ename-ViewPort ) <br />&#0160; (setq ename-ViewPort(car (entsel &quot;\nPick a Viewport: &quot;))) <br />&#0160; (changevpscale ename-ViewPort &quot;1:2&quot;) <br />&#0160; (command &quot;REGENALL&quot;) <br />&#0160; )</p>
</div>
