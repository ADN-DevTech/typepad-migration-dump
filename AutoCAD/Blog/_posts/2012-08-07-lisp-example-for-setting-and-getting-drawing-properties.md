---
layout: "post"
title: "LISP example for setting and getting Drawing Properties"
date: "2012-08-07 07:42:21"
author: "Philippe Leefsma"
categories:
  - "AutoCAD"
  - "LISP"
  - "Philippe Leefsma"
original_url: "https://adndevblog.typepad.com/autocad/2012/08/lisp-example-for-setting-and-getting-drawing-properties.html "
typepad_basename: "lisp-example-for-setting-and-getting-drawing-properties"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/philippe-leefsma.html" target="_self">Philippe Leefsma</a></p>  <p><b>Q:</b></p>  <p>Is there a lisp example that shows how to access Drawing Properties?</p>  <p><a name="section2"></a></p>  <p><b>A:</b></p>  <p>Here is a Visual Lisp example that will update the Drawing Properties for the active drawing.</p>  <p>Note: Values which are changed in the user interface are not immediately reflected in the ActiveX properties. If the drawing is saved and then reopened, the values previously changed in the user interface are returned by the ActiveX properties.&#160; However, values which are set by the ActiveX methods are always immediately reflected in the user interface.</p>  <p>&#160;</p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font style="font-size: 11pt" color="#000000">(defun c:dProps (/ dProps dProp)</font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font style="font-size: 11pt" color="#000000">(vl-load-com)</font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font style="font-size: 11pt" color="#000000">(setq acadObject (vlax-get-acad-object))</font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font style="font-size: 11pt" color="#000000">(setq acadDocument (vla-get-ActiveDocument acadObject))</font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;</font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160; </font></span><font style="font-size: 11pt">;;Get the SummaryInfo</font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160; </font></span><font style="font-size: 11pt">(setq dProps (vlax-get-Property acadDocument 'SummaryInfo))</font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;</font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160; </font></span><font style="font-size: 11pt">;;Edit the SummaryInfo properties</font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160; </font></span><font style="font-size: 11pt">(vlax-put-Property dProps 'Title &quot;Test Title&quot;)</font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160; </font></span><font style="font-size: 11pt">(vlax-put-Property dProps 'Subject &quot;Test Subject&quot;)</font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160; </font></span><font style="font-size: 11pt">(vlax-put-Property dProps 'Author &quot;Test Author&quot;)</font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160; </font></span><font style="font-size: 11pt">(vlax-put-Property dProps 'Keywords &quot;One Two Three&quot;)</font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160; </font></span><font style="font-size: 11pt">(vlax-put-Property dProps 'Comments &quot;This is a comment&quot;)</font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160; </font></span><font style="font-size: 11pt">(vlax-put-Property dProps 'HyperlinkBase &quot;\\\\www.Autodesk.com&quot;)</font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160; </font></span><font style="font-size: 11pt">(vlax-put-Property dProps 'LastSavedBy &quot;Tester&quot;)</font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160; </font></span><font style="font-size: 11pt">(vlax-put-Property dProps 'RevisionNumber &quot;1&quot;)</font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160; </font></span><font style="font-size: 11pt">;;Add an entry to the &quot;Custom&quot; tab</font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160; </font></span><font style="font-size: 11pt">(vla-addcustominfo dProps &quot;test custom&quot; &quot;custom value&quot;)</font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;</font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160; </font></span><font style="font-size: 11pt">;;Access the updated properties and print them to the command window </font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160; </font></span><font style="font-size: 11pt">(setq dProp (vlax-get-Property dProps 'Title))</font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160; </font></span><font style="font-size: 11pt">(princ (strcat &quot;Title = &quot; dProp &quot;\n&quot;))</font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160; </font></span><font style="font-size: 11pt">(setq dProp (vlax-get-Property dProps 'Subject))</font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160; </font></span><font style="font-size: 11pt">(princ (strcat &quot;Subject = &quot; dProp &quot;\n&quot;))</font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160; </font></span><font style="font-size: 11pt">(setq dProp (vlax-get-Property dProps 'Author))</font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160; </font></span><font style="font-size: 11pt">(princ (strcat &quot;Author = &quot; dProp &quot;\n&quot;))</font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160; </font></span><font style="font-size: 11pt">(setq dProp (vlax-get-Property dProps 'Keywords))</font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160; </font></span><font style="font-size: 11pt">(princ (strcat &quot;Keywords = &quot; dProp &quot;\n&quot;))</font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160; </font></span><font style="font-size: 11pt">(setq dProp (vlax-get-Property dProps 'Comments))</font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160; </font></span><span style="mso-ansi-language: fr" lang="FR"><font style="font-size: 11pt">(princ (strcat &quot;Comments = &quot; dProp &quot;\n&quot;))</font></span></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><span style="mso-ansi-language: fr" lang="FR"><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160; </font></span></span><font style="font-size: 11pt">(setq dProp (vlax-get-Property dProps 'HyperlinkBase))</font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160; </font></span><font style="font-size: 11pt">(princ (strcat &quot;HyperlinkBase = &quot; dProp &quot;\n&quot;))</font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160; </font></span><font style="font-size: 11pt">(setq dProp (vlax-get-Property dProps 'LastSavedBy))</font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160; </font></span><font style="font-size: 11pt">(princ (strcat &quot;LastSavedBy = &quot; dProp &quot;\n&quot;))</font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160; </font></span><font style="font-size: 11pt">(setq dProp (vlax-get-Property dProps 'RevisionNumber))</font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160; </font></span><font style="font-size: 11pt">(princ (strcat &quot;RevisionNumber = &quot; dProp &quot;\n&quot;))</font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;&#160; </font></span><font style="font-size: 11pt">(princ)</font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font style="font-size: 11pt" color="#000000">)</font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font color="#000000" face="Calibri"></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font color="#000000" face="Calibri">&#160;</font></p>
