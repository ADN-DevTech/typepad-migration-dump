---
layout: "post"
title: "How to place Annotations for Plant3d P&amp;ID objects using C#.NET"
date: "2012-05-02 10:36:10"
author: "Fenton Webb"
categories:
  - ".NET"
  - "2011"
  - "2012"
  - "2013"
original_url: "https://adndevblog.typepad.com/autocad/2012/05/how-to-place-annotations-for-plant3d-pid-objects-using-cnet.html "
typepad_basename: "how-to-place-annotations-for-plant3d-pid-objects-using-cnet"
typepad_status: "Publish"
---

<p>by <a href="http://http://adndevblog.typepad.com/autocad/fenton-webb.html">Fenton Webb</a></p>  <p>Leading on from this post <a href="http://adndevblog.typepad.com/autocad/2012/05/how-to-list-all-of-the-annotation-style-names-in-plant3d-pid-using-cnet.html" target="_blank">How to list all of the Annotation Style names in Plant3d P&amp;ID using C#.NET</a> I thought I should try and use that code for something useful <img style="border-bottom-style: none; border-left-style: none; border-top-style: none; border-right-style: none" class="wlEmoticon wlEmoticon-smile" alt="Smile" src="/assets/image_897200.jpg" /> So I’ve basically implemented my own version of the PIDANNOTATE command…</p>  <p>&#160;</p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">// Programmatically create Annotation by Fenton Webb, DevTech, Autodesk 1/5/2012</font></font></span></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">[</font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">CommandMethod</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;MyCreateAnnotation&quot;</font></span><font color="#000000">)]</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">public</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">myCreateAnnotation</font></span><font color="#000000">()</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">{</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// get the AutoCAD Editor object </font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">Editor</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">ed</font></span><font color="#000000"> = </font><span style="color: "><font color="#2b91af">AcadApp</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">DocumentManager</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">MdiActiveDocument</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Editor</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// select the pnid object to annotate</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">PromptEntityResult</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">pnidObjectRes</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">ed</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">GetEntity</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;Pick Object to annotate : &quot;</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// if something selected</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">pnidObjectRes</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Status</font></span><font color="#000000"> == </font><span style="color: "><font color="#2b91af">PromptStatus</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">OK</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160; {</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">PromptResult</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">annoStyleRes</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">do</font></span><font color="#000000"> </font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// enter the required annotation style</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">PromptStringOptions</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">opts</font></span><font color="#000000"> = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">PromptStringOptions</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;Enter Annotation Style or ? to list&quot;</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">opts</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">AllowSpaces</font></span><font color="#000000"> = </font><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">annoStyleRes</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">ed</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">GetString</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">opts</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">annoStyleRes</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Status</font></span><font color="#000000"> == </font><span style="color: "><font color="#2b91af">PromptStatus</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">OK</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; {</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// check to see if a listing is required</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">annoStyleRes</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">StringResult</font></span><font color="#000000"> == </font><span style="color: "><font color="#a31515">&quot;?&quot;</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// list the entries in the Autodesk_PNP dict</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">using</font></span><font color="#000000"> (</font><span style="color: "><font color="#2b91af">DBDictionary</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">annoStylesDict</font></span><font color="#000000"> = </font><span style="color: "><font color="#2b91af">DictionaryUtils</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">GetAnnotationStylesDictionaryId</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">ed</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Document</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Database</font></span><font color="#000000">, 0).</font><span style="color: "><font color="#010001">Open</font></span><font color="#000000">(</font><span style="color: "><font color="#2b91af">OpenMode</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">ForRead</font></span><font color="#000000">) </font><span style="color: "><font color="#0000ff">as</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">DBDictionary</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">foreach</font></span><font color="#000000">(</font><span style="color: "><font color="#2b91af">DBDictionaryEntry</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">entry</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">in</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">annoStylesDict</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">ed</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">WriteMessage</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;\n&quot;</font></span><font color="#000000"> + </font><span style="color: "><font color="#010001">entry</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Key</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; }</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; } </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">while</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">annoStyleRes</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Status</font></span><font color="#000000"> == </font><span style="color: "><font color="#2b91af">PromptStatus</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">OK</font></span><font color="#000000"> &amp;&amp; </font><span style="color: "><font color="#010001">annoStyleRes</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">StringResult</font></span><font color="#000000"> == </font><span style="color: "><font color="#a31515">&quot;?&quot;</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// if we have what we think is a valid annotation style</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">annoStyleRes</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Status</font></span><font color="#000000"> == </font><span style="color: "><font color="#2b91af">PromptStatus</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">OK</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// select the point for the annotation </font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">PromptPointResult</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">pointRes</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">ed</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">GetPoint</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;Pick position of annotation&quot;</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// if ok</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">pointRes</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Status</font></span><font color="#000000"> == </font><span style="color: "><font color="#2b91af">PromptStatus</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">OK</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; {</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// get the style id from the name input</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">ObjectId</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">styleId</font></span><font color="#000000"> = </font><span style="color: "><font color="#2b91af">PnIDStyleUtils</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">GetStyleIdFromName</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">annoStyleRes</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">StringResult</font></span><font color="#000000">, </font><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// now create the annotation object</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">Annotation</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">anno</font></span><font color="#000000"> = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">Annotation</font></span><font color="#000000">();</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// and place it</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">anno</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Create</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">pointRes</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Value</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">styleId</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">pnidObjectRes</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">ObjectId</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; }</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160; }&#160;&#160;&#160;&#160; </font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">}</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p> </div>
