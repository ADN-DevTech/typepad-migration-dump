---
layout: "post"
title: "PnP3dObjectsMgd not found exception"
date: "2014-01-23 05:29:51"
author: "Augusto Goncalves"
categories:
  - ".NET"
  - "Augusto Goncalves"
  - "Plant3D"
  - "PnID"
original_url: "https://adndevblog.typepad.com/autocad/2014/01/pnp3dobjectsmgd-not-found-exception.html "
typepad_basename: "pnp3dobjectsmgd-not-found-exception"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>If you are developing to AutoCAD Plant 3D 2014 you may have faced the issue below: ‘<em>Could not load file or assembly PnP3dObjectsMgd (….)</em>’.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01a5114f3f06970c-pi"><img title="PnP3dObjectsMgd_not_found" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="PnP3dObjectsMgd_not_found" src="/assets/image_810730.jpg" width="379" height="162" /></a></p>  <p>A little background information: starting on 2014 release, some vertical products, like Plant 3D, are launched in plain AutoCAD with a startup modifier. This is know as configurable AutoCAD, see more details at this <a href="http://adndevblog.typepad.com/autocad/2013/06/new-2014-configurable-autocad-installation-structure.html" target="_blank">blog post</a>. That way, the AutoCAD folder will have a subfolder /PLNT3D/ with the Plant 3D specific DLL.</p>  <p>But there is a know issue where AutoCAD Plant 3D may not load some required DLLs when a plugin needs it, causing the error message mentioned.</p>  <p>A small trick to solve this exception is ‘help’ Plant 3D find the required DLLs. To do so, create a modify your custom class that implements <strong>IExtensionApplication</strong>. Inside the <strong>Initialize</strong> method, include:</p>  <pre style="font-family: ; background: white; color: ; line-height: normal"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 9.8pt">void</font></font></span><font style="font-size: 9.8pt"><font color="#000000">&#160;</font><span style="color: "><font color="#2b91af">IExtensionApplication</font></span></font></font><font face="Consolas"><font style="font-size: 9.8pt"><font color="#000000">.Initialize()<br />{<br />&#160;&#160;&#160; </font><span style="color: "><font color="#2b91af">AppDomain</font></span><font color="#000000">.CurrentDomain.AssemblyResolve <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; += CurrentDomain_AssemblyResolve;<br />}</font></font></font></pre>

<p>Now we can customize how and where the .NET engine will search for assemblies it could not find. We just want to include the /PLNT3D/. That can be done in several ways, here is a example:</p>

<pre style="font-family: ; background: white; color: ; line-height: normal"><span style="color: "><font color="#2b91af" face="Consolas"><font style="font-size: 9.8pt">Assembly</font></font></span><font style="font-size: 9.8pt"><font face="Consolas"><font color="#000000"> CurrentDomain_AssemblyResolve(<br />&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">object</font></span><font color="#000000"> sender, </font><span style="color: "><font color="#2b91af">ResolveEventArgs</font></span></font><font face="Consolas"><font color="#000000"> args)<br />{<br />&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">return</font></span></font><font face="Consolas"><font color="#000000"> TryResolvePlant3D(args);<br />}<br /> </font><br /><span style="color: "><font color="#0000ff">private</font></span><font color="#000000">&#160;</font><span style="color: "><font color="#2b91af">Assembly</font></span></font><font face="Consolas"><font color="#000000"> TryResolvePlant3D(<br />&#160;&#160;&#160; </font><span style="color: "><font color="#2b91af">ResolveEventArgs</font></span></font><font face="Consolas"><font color="#000000"> args)<br />{<br />&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">string</font></span></font><font face="Consolas"><font color="#000000"> name = GetAssemblyName(args);<br />&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">string</font></span><font color="#000000"> assemblyPath = System.IO.</font><span style="color: "><font color="#2b91af">Path</font></span></font><font face="Consolas"><font color="#000000">.<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Combine(PLNT3DFolder, name + </font><span style="color: "><font color="#a31515">&quot;.dll&quot;</font></span></font><font face="Consolas"><font color="#000000">);<br />&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (System.IO.</font><span style="color: "><font color="#2b91af">File</font></span></font><font face="Consolas"><font color="#000000">.Exists(assemblyPath))<br />&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#2b91af">Assembly</font></span></font><font face="Consolas"><font color="#000000"> assembly = <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#2b91af">Assembly</font></span></font><font face="Consolas"><font color="#000000">.LoadFrom(assemblyPath);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">if</font></span></font><font face="Consolas"><font color="#000000"> (assembly.FullName == args.Name)<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">return</font></span></font><font face="Consolas"><font color="#000000"> assembly;<br />&#160;&#160;&#160; }<br />&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">return</font></span><font color="#000000">&#160;</font><span style="color: "><font color="#0000ff">null</font></span></font><font face="Consolas"><font color="#000000">;<br />}<br /> </font><br /><span style="color: "><font color="#008000">// based on <a href="http://stackoverflow.com/questions/2729446/resolving-assemblies-the-fuzzy-way" target="_blank">this post</a></font></span><br /><span style="color: "><font color="#0000ff">private</font></span><font color="#000000">&#160;</font><span style="color: "><font color="#0000ff">string</font></span><font color="#000000"> GetAssemblyName(</font><span style="color: "><font color="#2b91af">ResolveEventArgs</font></span></font><font face="Consolas"><font color="#000000"> args)<br />{<br />&#160;&#160;&#160; </font><span style="color: "><font color="#2b91af">String</font></span></font><font face="Consolas"><font color="#000000"> name;<br />&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (args.Name.IndexOf(</font><span style="color: "><font color="#a31515">&quot;,&quot;</font></span></font><font face="Consolas"><font color="#000000">) &gt; -1)<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; name = args.Name.Substring(0, args.Name.IndexOf(</font><span style="color: "><font color="#a31515">&quot;,&quot;</font></span></font><font face="Consolas"><font color="#000000">));<br />&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">else</font></span><br /></font><font face="Consolas"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; name = args.Name;<br />&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">return</font></span></font><font face="Consolas"><font color="#000000"> name;<br />}<br /> </font><br /><span style="color: "><font color="#0000ff">private</font></span><font color="#000000">&#160;</font><span style="color: "><font color="#0000ff">string</font></span></font><font face="Consolas"><font color="#000000"> PLNT3DFolder<br />{<br />&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">get</font></span><br /></font><font face="Consolas"><font color="#000000">&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> System.IO.</font><span style="color: "><font color="#2b91af">Path</font></span></font><font face="Consolas"><font color="#000000">.Combine(<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#2b91af">AppDomain</font></span></font></font><font face="Consolas"><font style="font-size: 9.8pt"><font color="#000000">.CurrentDomain.BaseDirectory,<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#a31515">&quot;PLNT3D&quot;</font></span><font color="#000000">);<br />&#160;&#160;&#160; }<br />}</font></font></font></pre>
