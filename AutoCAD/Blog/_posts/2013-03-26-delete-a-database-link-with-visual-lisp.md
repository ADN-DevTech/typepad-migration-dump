---
layout: "post"
title: "delete a database link with visual LISP"
date: "2013-03-26 20:04:00"
author: "Xiaodong Liang"
categories:
  - "AutoCAD"
  - "LISP"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/autocad/2013/03/delete-a-database-link-with-visual-lisp.html "
typepad_basename: "delete-a-database-link-with-visual-lisp"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>
<p><strong>Issue      <br /></strong>How do I delete a database link from an entity using the CAO API and Visual LISP?</p>
<p><a name="section2"></a></p>
<p><strong>Solution      <br /></strong>The following is a short Visual LISP example that prompts the user to select an object. It then deletes any links that are associated with that object.</p>
<p><span style="line-height: 120%; font-family: &#39;courier new&#39;, courier; font-size: 8pt;"><span style="background-color: #e6e6e6; color: #800080;">;<span style="background-color: #e6e6e6; color: #800080;">;; This function deletes a link from a selected object         <br /></span></span>      <br /><span style="color: #ff0000;">(</span><span style="color: #0000ff;">defun</span> c:DLink <span style="color: #ff0000;">(</span><span style="color: #ff0000;">)</span>      <br /><span style="color: #ff0000;">(</span><span style="color: #0000ff;">vl-load-com</span><span style="color: #ff0000;">)</span>      <br />      <br />      <br /><span style="background-color: #e6e6e6; color: #800080;">;<span style="background-color: #e6e6e6; color: #800080;">;; Get the object and get the object ID&#0160;&#0160;&#0160;&#0160; <br /></span></span><span style="color: #ff0000;">(</span><span style="color: #0000ff;">setq</span> ent1 <span style="color: #ff0000;">(</span><span style="color: #0000ff;">car</span>&#0160;<span style="color: #ff0000;">(</span><span style="color: #0000ff;">entsel</span>&#0160;<span style="color: #ff00ff;">&quot;\nSelect entity to erase links&quot;</span><span style="color: #ff0000;">)</span><span style="color: #ff0000;">)</span><span style="color: #ff0000;">)</span>      <br /><span style="color: #ff0000;">(</span><span style="color: #0000ff;">setq</span> Obj <span style="color: #ff0000;">(</span><span style="color: #0000ff;">vlax-ename-</span>&gt;vla-object ent1<span style="color: #ff0000;">)</span><span style="color: #ff0000;">)</span>      <br /><span style="color: #ff0000;">(</span><span style="color: #0000ff;">setq</span> ob_ID <span style="color: #ff0000;">(</span><span style="color: #0000ff;">vla-get-objectid</span> Obj<span style="color: #ff0000;">)</span><span style="color: #ff0000;">)</span>      <br />      <br />      <br /><span style="background-color: #e6e6e6; color: #800080;">;<span style="background-color: #e6e6e6; color: #800080;">;; Instantiate the DBConnect object         <br /></span></span><span style="color: #ff0000;">(</span><span style="color: #0000ff;">setq</span> dbConnect <span style="color: #ff0000;">(</span><span style="color: #0000ff;">vlax-create-object</span>&#0160;<span style="color: #ff00ff;">&quot;CAO.DbConnect.16&quot;</span><span style="color: #ff0000;">)</span><span style="color: #ff0000;">)</span>      <br />      <br />      <br /><span style="background-color: #e6e6e6; color: #800080;">;<span style="background-color: #e6e6e6; color: #800080;">;; Get the linkTemplates&#0160;&#0160;&#0160;&#0160; <br /></span></span><span style="color: #ff0000;">(</span><span style="color: #0000ff;">setq</span> LTs <span style="color: #ff0000;">(</span><span style="color: #0000ff;">vlax-invoke-method</span> dbConnect <span style="color: #ff00ff;">&quot;GetLinkTemplates&quot;</span><span style="color: #ff0000;">)</span><span style="color: #ff0000;">)</span>      <br />      <br />      <br /><span style="background-color: #e6e6e6; color: #800080;">;<span style="background-color: #e6e6e6; color: #800080;">;; Get a linkTemplate named <span style="color: #ff00ff;">&quot;EmployeeLink1&quot;</span>, This linkTemplate          <br /></span></span><span style="background-color: #e6e6e6; color: #800080;">;<span style="background-color: #e6e6e6; color: #800080;">;; can be created from the Employee table in the DB sample that ships with         <br /></span></span><span style="background-color: #e6e6e6; color: #800080;">;<span style="background-color: #e6e6e6; color: #800080;">;; AutoCAD         <br /></span></span><span style="color: #ff0000;">(</span><span style="color: #0000ff;">setq</span> LT <span style="color: #ff0000;">(</span><span style="color: #0000ff;">vlax-invoke-method</span> LTs <span style="color: #ff00ff;">&quot;Item&quot;</span>&#0160;<span style="color: #ff00ff;">&quot;EmployeeLink1&quot;</span><span style="color: #ff0000;">)</span><span style="color: #ff0000;">)</span>      <br />      <br />      <br /><span style="background-color: #e6e6e6; color: #800080;">;<span style="background-color: #e6e6e6; color: #800080;">;; Get the links using The linkTemplate         <br /></span></span><span style="color: #ff0000;">(</span><span style="color: #0000ff;">setq</span> linkSel <span style="color: #ff0000;">(</span><span style="color: #0000ff;">vlax-invoke-method</span> dbConnect <span style="color: #ff00ff;">&quot;GetLinks&quot;</span> LT nil nil nil<span style="color: #ff0000;">)</span><span style="color: #ff0000;">)</span>      <br />      <br />      <br /><span style="background-color: #e6e6e6; color: #800080;">;<span style="background-color: #e6e6e6; color: #800080;">;; Iterate through the links and delete the link         <br /></span></span><span style="background-color: #e6e6e6; color: #800080;">;<span style="background-color: #e6e6e6; color: #800080;">;; if it has the same ObjectID as the link         <br /></span></span><span style="color: #ff0000;">(</span><span style="color: #0000ff;">vlax-for</span> thisLink linkSel      <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160; <span style="color: #ff0000;">(</span><span style="color: #0000ff;">setq</span> l_Obj_ID <span style="color: #ff0000;">(</span><span style="color: #0000ff;">vlax-get-property</span> thisLink <span style="color: #ff00ff;">&quot;ObjectID&quot;</span><span style="color: #ff0000;">)</span><span style="color: #ff0000;">)</span>      <br />      <br />      <br />&#0160;&#0160; <span style="color: #ff0000;">(</span><span style="color: #0000ff;">if</span>&#0160;<span style="color: #ff0000;">(</span>= l_Obj_ID ob_ID<span style="color: #ff0000;">)</span>      <br />&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; <span style="color: #ff0000;">(</span><span style="color: #0000ff;">vla-delete</span> thislink<span style="color: #ff0000;">)</span>      <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160; <span style="color: #ff0000;">)</span>      <br /><span style="color: #ff0000;">)</span>      <br />      <br />      <br /><span style="color: #ff0000;">)</span></span></p>
