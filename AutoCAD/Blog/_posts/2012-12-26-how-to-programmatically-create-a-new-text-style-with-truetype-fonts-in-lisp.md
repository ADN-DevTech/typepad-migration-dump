---
layout: "post"
title: "How to programmatically create a new text style (with truetype fonts) in lisp"
date: "2012-12-26 17:13:29"
author: "Gopinath Taget"
categories:
  - "2010"
  - "2011"
  - "2012"
  - "2013"
  - "AutoCAD"
  - "Gopinath Taget"
  - "LISP"
original_url: "https://adndevblog.typepad.com/autocad/2012/12/how-to-programmatically-create-a-new-text-style-with-truetype-fonts-in-lisp.html "
typepad_basename: "how-to-programmatically-create-a-new-text-style-with-truetype-fonts-in-lisp"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/gopinath-taget.html">Gopinath Taget</a></p>  <p>Using Visual LISP, how do you create a new style without using (command &quot;style&quot; new-style full-style-name &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot; &quot;&quot;) ?</p>  <p>There are two lisp approaches to create a new style, without using (command &quot;style&quot;...etc), but you will need the name of the actual .ttf file to do so. Before we get into the two approaches, one important point to note. It seems that with some fonts, mostly Swiss and Dutch, the font name is abbreviated in AutoCAD's STYLE dialog.&#160; Some of the common abbreviations used are:</p>  <p>Bd = Bold   <br />Blk = Black     <br />Cn = Condensed    <br />Ex = Extended    <br />It = Italic    <br />Out = Outline    <br />Rm = Roman    <br />Xbd = Extra Bold</p>  <p>For example:    <br />Swis721 BlkEx BT&#160; would be written as&#160; Swiss 721 Black Extended BT    <br />Swis721 BdCnOut BT&#160; would be written as&#160; Swiss 721 Bold Condensed Outline BT    <br />Dutch801 Rm BT&#160; would be written as&#160; Dutch 801 Roman BT    <br />Dutch801 Xbd BT&#160; would be written as&#160; Dutch 801 Extra Bold BT</p>  <p>Note: Using Windows Explorer, you can see the actual spelling of the font names, in the Fonts directory (ex: C:\Windows\Fonts).</p>  <p>Again, Windows' Fonts directory lists the font names and the related .ttf filename.&#160; For example: Swiss 721 Bold Condensed Outline BT is found in the file swisscbo.ttf.&#160; With this information, we can proceed to entmake a new text style.&#160; First, the old AutoLISP approach, using entmake: </p>  <p>;;Style: myNewStyle   <br /> ;;Font Name: Swiss 721 Bold Condensed Outline BT    <br /> ;;Fontfile: swisscbo.ttf    <br /> (if (not (tblsearch &quot;STYLE&quot; &quot;myNewStyle&quot;))    <br />&#160;&#160;&#160; (entmake '((0 . &quot;STYLE&quot;)    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (100 . &quot;AcDbSymbolTableRecord&quot;)    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (100 . &quot;AcDbTextStyleTableRecord&quot;)    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (2 . &quot;myNewStyle&quot;) ;style name     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (3 . &quot;swisscbo.ttf&quot;) ;font file     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (70 . 0)    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (40 . 0.0)    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (41 . 1.0)    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (50 . 0.0)    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (71 . 0)    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; )    <br />&#160;&#160;&#160; )    <br />&#160;&#160;&#160; (princ &quot;\n Style already defined&quot;)    <br /> )    <br /></p>  <p>&#160;</p>  <p>The Visual LISP (ActiveX) approach is as follows:</p>  <p>&#160;</p>  <p>;;Style: myNewStyle   <br /> ;;Font Name: Swiss 721 Bold Condensed Outline BT    <br /> ;;Fontfile: swisscbo.ttf    <br /> (vl-load-com)    <br /> (setq acadApp (vlax-get-Acad-object))    <br /> (setq acadDoc (vla-get-ActiveDocument acadApp))    <br /> (setq styles (vla-get-textstyles acadDoc))</p>  <p>&#160;</p>  <p> ;; Add the style named &quot;myNewStyle&quot;   <br /> (setq objStyle (vla-add styles &quot;myNewStyle&quot;))</p>  <p>   <br /> ;; Assign fontfile &quot;swisscbo.ttf&quot; to the style    <br /> (setq ff &quot;c:\\winnt\\fonts\\swisscbo.ttf&quot;) ;your path may be different    <br /> (vla-put-fontfile objStyle ff)</p>  <p>   <br /> ;; Optional: Make the new style Active    <br /> (vla-put-activetextstyle acadDoc objStyle)    <br /> (princ)</p>
