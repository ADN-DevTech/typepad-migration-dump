---
layout: "post"
title: "Viewport specific implementation of AutoCAD ISOLATEOBJECTS command with a Drawable Overrule in .Net"
date: "2012-12-06 17:18:13"
author: "Gopinath Taget"
categories:
  - ".NET"
  - "2010"
  - "2011"
  - "2012"
  - "2013"
  - "AutoCAD"
  - "Gopinath Taget"
original_url: "https://adndevblog.typepad.com/autocad/2012/12/viewport-specific-implementation-of-autocad-isolateobjects-command-with-a-drawable-overrule-in-net.html "
typepad_basename: "viewport-specific-implementation-of-autocad-isolateobjects-command-with-a-drawable-overrule-in-net"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/gopinath-taget.html">Gopinath Taget</a></p>
<p>Credit: This article was originally created by <a href="http://adndevblog.typepad.com/autocad/philippe-leefsma.html">Philippe Leefsma</a>.</p>
<p>Unfortunately there is no simple API to replicate the ISOLATEOBJECTS command. You will have to jump through some hoops.</p>
<p>One way to reach this goal is to use a drawable overrule that will control the visibility of the entities depending which viewport they are drawn in.</p>
<p>The following VB.Net sample illustrates the approach: each entityâ€™s visibility can be controlled on a per-viewport basis. The overrule can be switched ON and OFF with the &quot;ToggleIsolateOverrule&quot; command. Also the overrule can be persisted across sessions as the overrule data is stored in an xRecord of the extension dictionary of each entity. However, as the overrule must be attached to each specific entity type, it may be necessary to run command &quot;ReloadIsolateOverrule&quot; for a specific drawing in order to reactivate the overrule for the entity type it contains. </p>
<div style="background: white;">
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">Imports</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> System</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">Imports</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> Autodesk.AutoCAD.Runtime</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">Imports</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> Autodesk.AutoCAD.ApplicationServices</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">Imports</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> Autodesk.AutoCAD.DatabaseServices</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">Imports</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> Autodesk.AutoCAD.Geometry</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">Imports</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> Autodesk.AutoCAD.EditorInput</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">Imports</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> Autodesk.AutoCAD.GraphicsInterface</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #008000;">&#39;////////////////////////////////////////////////////////////////////////////////////////////////</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #008000;">&#39;// Use: Creates a draw overrule in order to isolate selected object(s) in the active viewport.</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #008000;">&#39;//&#0160;&#0160;&#0160;&#0160;&#0160; Written by Philippe Leefsma - DevTech, November 2010</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #008000;">&#39;//</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #008000;">&#39;////////////////////////////////////////////////////////////////////////////////////////////////</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">Public</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Class</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #2b91af;">CIsolateOverrule</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Inherits</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #2b91af;">DrawableOverrule</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Implements</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #2b91af;">IExtensionApplication</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Private</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Shared</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> _TheOverrule </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #2b91af;">CIsolateOverrule</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Private</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Shared</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> _dictName </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">String</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> = </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #a31515;">&quot;IsolateOverrulexDic&quot;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Private</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Shared</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> _viewportsNumKey </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">String</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> = </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #a31515;">&quot;IsolateOverrulexRec&quot;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">&#39;////////////////////////////////////////////////////////////////////////////////////////////////</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">&#39;// Use: IExtensionApplication Implementation</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">&#39;//&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">&#39;////////////////////////////////////////////////////////////////////////////////////////////////</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Sub</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> Initialize() </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Implements</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> Autodesk.AutoCAD.Runtime.</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">IExtensionApplication</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.Initialize</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">If</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> _TheOverrule </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Is</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Nothing</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Then</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; _TheOverrule = </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">New</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #2b91af;">CIsolateOverrule</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; _TheOverrule.SetExtensionDictionaryEntryFilter(_dictName)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">AddHandler</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Application</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.SystemVariableChanged, </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">AddressOf</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> SystemVariableChanged</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">If</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Sub</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Sub</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> Terminate() </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Implements</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> Autodesk.AutoCAD.Runtime.</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">IExtensionApplication</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.Terminate</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Sub</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">&#39;////////////////////////////////////////////////////////////////////////////////////////////////</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">&#39;// Use: SystemVariableChanged Handler Implementation</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">&#39;//&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">&#39;////////////////////////////////////////////////////////////////////////////////////////////////</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Private</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Shared</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Sub</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> SystemVariableChanged(</span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">ByVal</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> sender </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Object</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">,_</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">ByVal</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> e </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As </span></span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #0000ff;"><span style="line-height: 11pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">Autodesk.AutoCAD.</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ApplicationServices.</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">SystemVariableChangedEventArgs</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">If</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> (e.Name.ToUpper() = </span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;CVPORT&quot;</span></span><span style="line-height: 11pt;"><span style="color: #000000;">) </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Then</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> doc </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Document</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> = </span></span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Application</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.DocumentManager.MdiActiveDocument</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160; </span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> cvport </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Short</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> = </span></span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Application</span></span><span style="line-height: 11pt;"><span style="color: #000000;">.GetSystemVariable(</span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;CVPORT&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; doc.Editor.WriteMessage(vbCrLf + </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;Current Viewport is now: &quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> + </span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; cvport.ToString() + vbCrLf)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; doc.Editor.Regen()</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">If</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Sub</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">&#39;////////////////////////////////////////////////////////////////////////////////////////////////</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">&#39;// Use: Utilities Implementation</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">&#39;//&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">&#39;////////////////////////////////////////////////////////////////////////////////////////////////</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Private</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Shared</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Function</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> GetxDico(</span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">ByVal</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> entity </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Entity</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">, _</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">ByVal</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> Tx </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Transaction</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">, _</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Optional</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">ByVal</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> createIfNotExists </span></span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Boolean</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> = </span></span></span><span style="font-family: Consolas;"><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">True</span></span><span style="line-height: 11pt;"><span style="color: #000000;">) </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #2b91af;">DBDictionary</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">If</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> (entity.ExtensionDictionary = </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">ObjectId</span></span><span style="line-height: 11pt;"><span style="color: #000000;">.Null) </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Then</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">If</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Not</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> createIfNotExists </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Then</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Return</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Nothing</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">If</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; entity.UpgradeOpen()</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; entity.CreateExtensionDictionary()</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; entity.DowngradeOpen()</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">If</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> xDico </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">DBDictionary</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> = Tx.GetObject(</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; e</span></span></span><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">ntity.ExtensionDictionary, </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">OpenMode</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.ForWrite)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; xDico.TreatElementsAsHard = </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">False</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Return</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> xDico</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Function</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Private</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Shared</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Sub</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> AddOverruleData(</span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">ByVal</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> entity </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Entity</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">, _</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">ByVal</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> viewportNum </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Short</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">, _</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">ByVal</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> spaceId </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">ObjectId</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">, _</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">ByVal</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> Tx </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Transaction</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> xDico </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">DBDictionary</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> = GetxDico(entity, Tx)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> overruleDico </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #2b91af;">DBDictionary</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> xRec </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #2b91af;">Xrecord</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">If</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> (</span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Not</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> xDico.Contains(_dictName)) </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Then</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; overruleDico = </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">New</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">DBDictionary</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">()</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; overruleDico.TreatElementsAsHard = </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">True</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; xDico.SetAt(_dictName, overruleDico)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; xRec = </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">New</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Xrecord</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">()</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">&#39;Add a first {Viewport, Id} pair, </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; â€˜but first add a dummy pair {0, spaceId}</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">&#39;This will prevent a crash during </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; â€˜RemoveOverruleData if we remove the last</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">&#39;pair and the xRecord.Data is left empty...</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; xRec.Data = </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">New</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">ResultBuffer</span></span><span style="line-height: 11pt;"><span style="color: #000000;">(</span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">New</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">TypedValue</span></span><span style="line-height: 11pt;"><span style="color: #000000;">(</span></span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">DxfCode</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.Int32, 0), _</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">New</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">TypedValue</span></span><span style="line-height: 11pt;"><span style="color: #000000;">(</span></span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">DxfCode</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.SoftPointerId, </span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; spaceId), _</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">New</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">TypedValue</span></span><span style="line-height: 11pt;"><span style="color: #000000;">(</span></span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">DxfCode</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.Int32, </span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; viewportNum), _</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">New</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">TypedValue</span></span><span style="line-height: 11pt;"><span style="color: #000000;">(</span></span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">DxfCode</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.SoftPointerId, </span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; spaceId))</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; overruleDico.SetAt(_viewportsNumKey, xRec)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Tx.AddNewlyCreatedDBObject(overruleDico, </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">True</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Tx.AddNewlyCreatedDBObject(xRec, </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">True</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Else</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; overruleDico = Tx.GetObject(xDico.GetAt(_dictName), </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">OpenMode</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.ForRead)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; xRec = Tx.GetObject(overruleDico.GetAt(_viewportsNumKey), </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">OpenMode</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.ForWrite)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> data </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">New</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> System.Collections.Generic.</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">List</span></span><span style="line-height: 11pt;"><span style="color: #000000;">(</span></span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Of</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">TypedValue</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">)(</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; xRec.Data.AsArray())</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; data.Add(</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">New</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">TypedValue</span></span><span style="line-height: 11pt;"><span style="color: #000000;">(</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">DxfCode</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.Int32, viewportNum))</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; data.Add(</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">New</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">TypedValue</span></span><span style="line-height: 11pt;"><span style="color: #000000;">(</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">DxfCode</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.SoftPointerId, spaceId))</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; xRec.Data = </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">New</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">ResultBuffer</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">(data.ToArray())</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">If</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Sub</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Private</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Shared</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Sub</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> RemoveOverruleData(</span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">ByVal</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> entity </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Entity</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">, _</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">ByVal</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> viewportNum </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Short</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">, _</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">ByVal</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> spaceId </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">ObjectId</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">, _</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">ByVal</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> Tx </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Transaction</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">, _</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Optional</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">ByVal</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> removeDict </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> _</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Boolean</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> = </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">False</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> xDico </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">DBDictionary</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> = GetxDico(entity, Tx, </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">False</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">If</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> xDico = </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Nothing</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Then</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">&#39;Seems there is nothing to remove, just leave...</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Return</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">If</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">If</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Not</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> (xDico.Contains(_dictName)) </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Then</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">&#39;Seems there is nothing to remove, just leave...</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Return</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">If</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> overruleDico </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">DBDictionary</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> = Tx.GetObject(</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; xDico.GetAt(_dictName), </span></span></span><span style="font-family: Consolas;"><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">OpenMode</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.ForRead)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">If</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> removeDict </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Then</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; overruleDico.UpgradeOpen()</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; xDico.Remove(_dictName)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; overruleDico.Erase(</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">True</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Else</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> xRec </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Xrecord</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> = Tx.GetObject(</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; overruleDico.GetAt(_viewportsNumKey), </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; OpenMode</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.ForWrite)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> data </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">New</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> System.Collections.Generic.</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">List</span></span><span style="line-height: 11pt;"><span style="color: #000000;">(</span></span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Of</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">TypedValue</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">)(xRec.Data.AsArray())</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">For</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> idx </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Integer</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> = 0 </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">To</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> data.Count - 1 </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Step</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> 2</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">If</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> data.Item(idx).Value = </span></span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; viewportNum </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">And</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> data.Item(idx + 1).</span></span></span><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">Value = </span></span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; spaceId </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Then</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; xRec.UpgradeOpen()</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; data.RemoveAt(idx)</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; data.RemoveAt(idx)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; xRec.Data = </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">New</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">ResultBuffer</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">(data.ToArray())</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Return</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">If</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Next</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">If</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Sub</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Private</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Shared</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Function</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> IsOverruled(</span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">ByVal</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> entity </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Entity</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">, _</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">ByVal</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> Tx </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Transaction</span></span><span style="line-height: 11pt;"><span style="color: #000000;">) </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Boolean</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> xDico </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">DBDictionary</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> = GetxDico(entity, Tx, </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">False</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">If</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> xDico = </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Nothing</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Then</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Return</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">False</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">If</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Return</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> xDico.Contains(_dictName)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Function</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Private</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Shared</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Sub</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> RegenOverruledEntities()</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> doc </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Document</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> = </span></span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Application</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.DocumentManager.MdiActiveDocument</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> db </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Database</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> = doc.Database</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> ed </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Editor</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> = doc.Editor</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Using</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> Tx </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Transaction</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> = </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; db.TransactionManager.StartTransaction</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> bt </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">BlockTable</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> = Tx.GetObject(db.BlockTableId, </span></span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; OpenMode</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.ForRead)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> btr </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">BlockTableRecord</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> = Tx.GetObject(</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; bt(</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">BlockTableRecord</span></span><span style="line-height: 11pt;"><span style="color: #000000;">.ModelSpace), </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">OpenMode</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.ForRead)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">For</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Each</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> id </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">ObjectId</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">In</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> btr</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> entity </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Entity</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> = Tx.GetObject(id, </span></span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; OpenMode</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.ForRead)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">If</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> IsOverruled(entity, Tx) </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Then</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; entity.UpgradeOpen()</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; entity.RecordGraphicsModified(</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">True</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">If</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Next</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Tx.Commit()</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Using</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; doc.Editor.Regen()</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Sub</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Private</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Shared</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">ReadOnly</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Property</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> CurrentSpaceId() </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #2b91af;">ObjectId</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Get</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> db </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Database</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> = </span></span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; HostApplicationServices</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.WorkingDatabase</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">If</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> (db.TileMode) </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Then</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">&#39;If model space returns Database.CurrentSpaceId</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Return</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> db.CurrentSpaceId</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Else</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">&#39;If paper space returns current layout Id</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> layoutMng </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">LayoutManager</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> = </span></span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; LayoutManager</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.Current()</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Return</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> layoutMng.GetLayoutId(layoutMng.CurrentLayout)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">If</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Get</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Property</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Private</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Shared</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Sub</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> ReloadOverrule()</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> doc </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Document</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> = </span></span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Application</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.DocumentManager.MdiActiveDocument</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> db </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Database</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> = doc.Database</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> ed </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Editor</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> = doc.Editor</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Using</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> Tx </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Transaction</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> = </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; db.TransactionManager.StartTransaction</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> bt </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">BlockTable</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> = Tx.GetObject(</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; db.BlockTableId, </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">OpenMode</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.ForRead)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> btr </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">BlockTableRecord</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> = Tx.GetObject(</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; bt(</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">BlockTableRecord</span></span><span style="line-height: 11pt;"><span style="color: #000000;">.ModelSpace), </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">OpenMode</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.ForRead)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">For</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Each</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> id </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">ObjectId</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">In</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> btr</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Try</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> entity </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Entity</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> = Tx.GetObject(id, </span></span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; OpenMode</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.ForRead)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">If</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> (IsOverruled(entity, Tx)) </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Then</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; entity.UpgradeOpen()</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; entity.RecordGraphicsModified(</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">True</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">Overrule</span></span><span style="line-height: 11pt;"><span style="color: #000000;">.AddOverrule(</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">RXClass</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.GetClass(</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; entity.GetType()), </span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; _TheOverrule, </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">False</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">If</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Catch</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> ex </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> Autodesk.AutoCAD.Runtime.</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #2b91af;">Exception</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">If</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> ex.ErrorStatus &lt;&gt; </span></span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">ErrorStatus</span></span><span style="line-height: 11pt;"><span style="color: #000000;">.DuplicateKey </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Then</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ed.WriteMessage(</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; vbCrLf + </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;Exception occured when adding overrule: &quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> + </span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; vbCrLf + ex.Message)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Exit Sub</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">If</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Try</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Next</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> id</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Tx.Commit()</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Using</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Sub</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">&#39;////////////////////////////////////////////////////////////////////////////////////////////////</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">&#39;// Use: DrawableOverrule Implementation</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">&#39;//&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">&#39;////////////////////////////////////////////////////////////////////////////////////////////////</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Overrides</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Function</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> WorldDraw(</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">ByVal</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> drawable </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> Autodesk.AutoCAD.GraphicsInterface.</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Drawable</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">, _</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">ByVal</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> wd </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> Autodesk.AutoCAD.GraphicsInterface.</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">WorldDraw</span></span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #000000;">) </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Boolean</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Return</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">False</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Function</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Overrides</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Sub</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> ViewportDraw(</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">ByVal</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> drawable </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> Autodesk.AutoCAD.GraphicsInterface.</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Drawable</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">, _</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">ByVal</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> vd </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> Autodesk.AutoCAD.GraphicsInterface.</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">ViewportDraw</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> doc </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Document</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> =</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Application</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.DocumentManager.MdiActiveDocument</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">&#39;Read the Xrecord data section and check </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">&#39;if our overruled entity has to be hidden</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">&#39;in the currently drawn viewport. </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">&#39;Need to compare it to current space Id as well...</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Using</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> Tx </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Transaction</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> = </span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; doc.Database.TransactionManager.StartTransaction</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> xDico </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">DBDictionary</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> = GetxDico(drawable, Tx)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> overruleDico </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">DBDictionary</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> = </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Tx.GetObject(xDico.GetAt(_dictName), </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">OpenMode</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.ForRead)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> xRec </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Xrecord</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> = </span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Tx.GetObject(overruleDico.GetAt(_viewportsNumKey), </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">OpenMode</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.ForRead)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> iter </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">ResultBufferEnumerator</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> = </span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; xRec.Data.GetEnumerator()</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">While</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> iter.MoveNext</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">If</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> (vd.Viewport.AcadWindowId = </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; iter.Current.Value) </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Then</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">&#39;Check spaceId now&#0160; </span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; iter.MoveNext()</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">If</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> (CurrentSpaceId = iter.Current.Value) </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Then</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">&#39;Our guy needs to be hidden in that viewport</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">&#39;so get out of here and do nothing...</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Tx.Commit()</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Return</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">If</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Continue While</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">If</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">&#39;Skip spaceId data</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; iter.MoveNext()</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">While</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Tx.Commit()</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Using</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">&#39;If we got to this point, it means overruled </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">&#39;entity is not hidden in this specific viewport...</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> clone </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Entity</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> = drawable.Clone</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; vd.Geometry.Draw(clone)</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; clone.Dispose()</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Sub</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Overrides</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Function</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> SetAttributes(</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">ByVal</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> drawable </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> Autodesk.AutoCAD.GraphicsInterface.</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Drawable</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">, _</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">ByVal</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> traits </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> Autodesk.AutoCAD.GraphicsInterface.</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">DrawableTraits</span></span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #2b91af;"><span style="line-height: 11pt;">&#0160; </span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">) _</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">&#0160; As</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Integer</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">&#39;Returning &quot;DrawableAttributes.RegenDraw&quot; </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">&#39; here will force viewport regen, it also impacts perfs...</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> ret </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Integer</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> = </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">MyBase</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.SetAttributes(drawable, traits) _</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Or</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">DrawableAttributes</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.RegenDraw _</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Or</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">DrawableAttributes</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.IsAnEntity _</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Or</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">DrawableAttributes</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.IsCompoundObject</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Return</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> ret</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Function</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Overrides</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Function</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> ViewportDrawLogicalFlags(</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">ByVal</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> drawable </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> Autodesk.AutoCAD.GraphicsInterface.</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Drawable</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">, _</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">ByVal</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> vd </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> Autodesk.AutoCAD.GraphicsInterface.</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">ViewportDraw</span></span><span style="line-height: 11pt;"><span style="color: #000000;">) </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Integer</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> ret </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Integer</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> = </span></span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">MyBase</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.ViewportDrawLogicalFlags(drawable, vd)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Return</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> ret</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Function</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">&#39;////////////////////////////////////////////////////////////////////////////////////////////////</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">&#39;// Use: Commands </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">&#39;//&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">&#39;////////////////////////////////////////////////////////////////////////////////////////////////</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160; &lt;</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">CommandMethod</span></span><span style="line-height: 11pt;"><span style="color: #000000;">(</span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;IsolateOverrule&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">)&gt; _</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Shared</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Sub</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> IsolateOverrule()</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> doc </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Document</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> = </span></span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Application</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.DocumentManager.MdiActiveDocument</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> db </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Database</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> = doc.Database</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> ed </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Editor</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> = doc.Editor</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> pso </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">New</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">PromptSelectionOptions</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">()</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; pso.RejectObjectsFromNonCurrentSpace = </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">True</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; pso.MessageForAdding = vbCrLf + </span></span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #a31515;">&quot;Select entities to isolate: &quot;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> psr </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">PromptSelectionResult</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> = ed.GetSelection(pso)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">If</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> (psr.Status &lt;&gt; </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">PromptStatus</span></span><span style="line-height: 11pt;"><span style="color: #000000;">.OK) </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Then</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Return</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">If</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> cvport </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Short</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> = </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Application</span></span><span style="line-height: 11pt;"><span style="color: #000000;">.GetSystemVariable(</span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;CVPORT&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">&#39;Creates an ObjectIdCollection to </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#39;make it easier with use of &quot;contains&quot; method</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> selectedIds </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">New</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">ObjectIdCollection</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">(</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; psr.Value.GetObjectIds())</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Using</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> Tx </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Transaction</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> = </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; db.TransactionManager.StartTransaction</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> bt </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">BlockTable</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> = Tx.GetObject(db.BlockTableId, </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">OpenMode</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.ForRead)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> btr </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">BlockTableRecord</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> = Tx.GetObject(</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; bt(</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">BlockTableRecord</span></span><span style="line-height: 11pt;"><span style="color: #000000;">.ModelSpace), </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">OpenMode</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.ForRead)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">For</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Each</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> id </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">ObjectId</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">In</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> btr</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Try</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> entity </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Entity</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> = Tx.GetObject(id, </span></span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; OpenMode</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.ForRead)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">&#39;Only selected entities are not overruled</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">If</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> selectedIds.Contains(id) </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Then</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="color: #000000; font-family: Consolas;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; RemoveOverruleData(entity, cvport, </span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; CurrentSpaceId, Tx)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Else</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; AddOverruleData(entity, cvport, </span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; CurrentSpaceId, Tx)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">Overrule</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.AddOverrule(</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">RXClass</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.GetClass(entity.GetType()), </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; _TheOverrule, </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">False</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">If</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Catch</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> ex </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> Autodesk.AutoCAD.Runtime.</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #2b91af;">Exception</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">If</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> ex.ErrorStatus &lt;&gt; </span></span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">ErrorStatus</span></span><span style="line-height: 11pt;"><span style="color: #000000;">.DuplicateKey </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Then</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ed.WriteMessage(</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; vbCrLf + </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;Exception occured when adding overrule: &quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> + </span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; vbCrLf + ex.Message)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Exit Sub</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">If</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Try</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Next</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> id</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Tx.Commit()</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Using</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">CIsolateOverrule</span></span><span style="line-height: 11pt;"><span style="color: #000000;">.Overruling = </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">True</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; RegenOverruledEntities()</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Sub</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; &lt;</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">CommandMethod</span></span><span style="line-height: 11pt;"><span style="color: #000000;">(</span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;ToggleIsolateOverrule&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">)&gt; _</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Shared</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Sub</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> ToggleIsolateOverrule()</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> doc </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Document</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> = </span></span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Application</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.DocumentManager.MdiActiveDocument</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> db </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Database</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> = doc.Database</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> ed </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Editor</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> = doc.Editor</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">CIsolateOverrule</span></span><span style="line-height: 11pt;"><span style="color: #000000;">.Overruling = </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Not</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">CIsolateOverrule</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.Overruling</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">If</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> (</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">CIsolateOverrule</span></span><span style="line-height: 11pt;"><span style="color: #000000;">.Overruling) </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Then</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; doc.Editor.WriteMessage(vbLf + </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;IsolateOverrule is now ON&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> + </span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; vbCrLf)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Else</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; doc.Editor.WriteMessage(vbLf + </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;IsolateOverrule is now OFF&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> + </span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; vbCrLf)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">If</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; RegenOverruledEntities()</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Sub</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; &lt;</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">CommandMethod</span></span><span style="line-height: 11pt;"><span style="color: #000000;">(</span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;CleanIsolateOverrule&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">)&gt; _</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Shared</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Sub</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> CleanIsolateOverrule()</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> doc </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Document</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> = </span></span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Application</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.DocumentManager.MdiActiveDocument</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> db </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Database</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> = doc.Database</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> ed </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Editor</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> = doc.Editor</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Using</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> Tx </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Transaction</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> = </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; db.TransactionManager.StartTransaction</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> bt </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">BlockTable</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> = Tx.GetObject(</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; db.BlockTableId, </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">OpenMode</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.ForRead)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> btr </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">BlockTableRecord</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> = Tx.GetObject(</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; bt(</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">BlockTableRecord</span></span><span style="line-height: 11pt;"><span style="color: #000000;">.ModelSpace), </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">OpenMode</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.ForRead)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">For</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Each</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> id </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">ObjectId</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">In</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> btr</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> entity </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Entity</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> = Tx.GetObject(id, </span></span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; OpenMode</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.ForRead)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; RemoveOverruleData(entity, 0, </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">ObjectId</span></span><span style="line-height: 11pt;"><span style="color: #000000;">.Null, Tx, </span></span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; True</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Next</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Tx.Commit()</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Using</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; doc.Editor.Regen()</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Sub</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; &lt;</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">CommandMethod</span></span><span style="line-height: 11pt;"><span style="color: #000000;">(</span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;ReloadIsolateOverrule&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">)&gt; _</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Shared</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">Sub</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> ReloadIsolateOverrule()</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">Dim</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> doc </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">As</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Document</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> = </span></span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Application</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.DocumentManager.MdiActiveDocument</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ReloadOverrule()</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">CIsolateOverrule</span></span><span style="line-height: 11pt;"><span style="color: #000000;">.Overruling = </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">True</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; doc.Editor.Regen()</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">End</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Sub</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">End</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">Class</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
</div>
