---
layout: "post"
title: "Highlighting a polyline segment"
date: "2012-07-06 16:08:09"
author: "Madhukar Moogala"
categories:
  - ".NET"
  - "AutoCAD"
  - "Stephen Preston"
original_url: "https://adndevblog.typepad.com/autocad/2012/07/highlighting-a-polyline-segment.html "
typepad_basename: "highlighting-a-polyline-segment"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/stephen-preston.html">Stephen Preston</a></p>  <p>Finishing off my Friday afternoon by quickly migrating another DevNote. Its really quiet in the office today – a lot of people have taken time off around the July 4th public holiday. </p>  <p>This code demonstrates how to use a subentitypath to highlight a specific segment of a polyline. You can use the equivalent Unhighlight method to to unhighlight the segment (not shown). Make sure you read the ObjectARX Managed Reference Guide entry on this method before you use it in your code – there are a few details documented there that you need to be aware of.</p>  <div style="font-family: consolas; background: white; color: black; font-size: 14pt">   <p style="margin: 0px"><font size="2">[<span style="color: #2b91af">CommandMethod</span>(<span style="color: #a31515">&quot;HighlightPolySeg&quot;</span>)]</font></p>    <p style="margin: 0px"><font size="2"><span style="color: blue">public</span> <span style="color: blue">static</span> <span style="color: blue">void</span> HighlightPolySeg()</font></p>    <p style="margin: 0px"><font size="2">{</font></p>    <p style="margin: 0px"><font size="2">&#160; <span style="color: #2b91af">Document</span> doc = <span style="color: #2b91af">Application</span>.DocumentManager.MdiActiveDocument;</font></p>    <p style="margin: 0px"><font size="2">&#160; <span style="color: #2b91af">Database</span> db = doc.Database;</font></p>    <p style="margin: 0px"><font size="2">&#160; <span style="color: #2b91af">Editor</span> ed = doc.Editor;</font></p>    <p style="margin: 0px"><font size="2">&#160; <span style="color: green">//Ask user to select polyline</span></font></p>    <p style="margin: 0px"><font size="2">&#160; <span style="color: #2b91af">PromptEntityOptions</span> peo = <span style="color: blue">new</span> <span style="color: #2b91af">PromptEntityOptions</span>(<span style="color: #a31515">&quot;\nSelect a polyline: &quot;</span>);</font></p>    <p style="margin: 0px"><font size="2">&#160; peo.SetRejectMessage(<span style="color: #a31515">&quot;\nMust be a polyline...&quot;</span>);</font></p>    <p style="margin: 0px"><font size="2">&#160; peo.AddAllowedClass(<span style="color: blue">typeof</span>(<span style="color: #2b91af">Polyline</span>), <span style="color: blue">true</span>);</font></p>    <p style="margin: 0px"><font size="2">&#160; <span style="color: #2b91af">PromptEntityResult</span> per = ed.GetEntity(peo);</font></p>    <p style="margin: 0px"><font size="2">&#160; <span style="color: blue">if</span> (per.Status != <span style="color: #2b91af">PromptStatus</span>.OK) <span style="color: blue">return</span>;</font></p>    <p style="margin: 0px"><font size="2">&#160; <span style="color: blue">using</span> (<span style="color: #2b91af">Transaction</span> Tx = db.TransactionManager.StartTransaction())</font></p>    <p style="margin: 0px"><font size="2">&#160; {</font></p>    <p style="margin: 0px"><font size="2">&#160;&#160;&#160; <span style="color: #2b91af">Polyline</span> pline = </font></p>    <p style="margin: 0px"><font size="2">&#160;&#160;&#160;&#160;&#160;&#160;&#160; Tx.GetObject(per.ObjectId, <span style="color: #2b91af">OpenMode</span>.ForRead) <span style="color: blue">as</span> <span style="color: #2b91af">Polyline</span>;</font></p>    <p style="margin: 0px"><font size="2">&#160;&#160;&#160; <span style="color: blue">int</span> nbSegments = pline.NumberOfVertices;</font></p>    <p style="margin: 0px"><font size="2">&#160;&#160;&#160; <span style="color: blue">if</span> (!pline.Closed) --nbSegments;</font></p>    <p style="margin: 0px"><font size="2">&#160;&#160;&#160; <span style="color: green">//Ask user which segment to highlight</span></font></p>    <p style="margin: 0px"><font size="2">&#160;&#160;&#160; <span style="color: #2b91af">PromptIntegerOptions</span> pio = <span style="color: blue">new</span> <span style="color: #2b91af">PromptIntegerOptions</span>(</font></p>    <p style="margin: 0px"><font size="2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #a31515">&quot;\nEnter segment id [1-&quot;</span> + nbSegments.ToString() + <span style="color: #a31515">&quot;] :&quot;</span>);</font></p>    <p style="margin: 0px"><font size="2">&#160;&#160;&#160; pio.LowerLimit = 1;</font></p>    <p style="margin: 0px"><font size="2">&#160;&#160;&#160; pio.UpperLimit = nbSegments;</font></p>    <p style="margin: 0px"><font size="2">&#160;&#160;&#160; <span style="color: #2b91af">PromptIntegerResult</span> pir = ed.GetInteger(pio);</font></p>    <p style="margin: 0px"><font size="2">&#160;&#160;&#160; <span style="color: blue">if</span> (pir.Status != <span style="color: #2b91af">PromptStatus</span>.OK) <span style="color: blue">return</span>;</font></p>    <p style="margin: 0px"><font size="2">&#160;&#160;&#160; <span style="color: green">//Define subentpath for segment</span></font></p>    <p style="margin: 0px"><font size="2">&#160;&#160;&#160; <span style="color: #2b91af">FullSubentityPath</span> path = </font></p>    <p style="margin: 0px"><font size="2">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">new</span> <span style="color: #2b91af">FullSubentityPath</span>(<span style="color: blue">new</span> <span style="color: #2b91af">ObjectId</span>[] { pline.Id }, </font></p>    <p style="margin: 0px"><font size="2">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">new</span> <span style="color: #2b91af">SubentityId</span>(<span style="color: #2b91af">SubentityType</span>.Edge, <span style="color: blue">new</span> <span style="color: #2b91af">IntPtr</span>(pir.Value)));</font></p>    <p style="margin: 0px"><font size="2">&#160;&#160;&#160; <span style="color: green">//Highlight segment</span></font></p>    <p style="margin: 0px"><font size="2">&#160;&#160;&#160; pline.Highlight(path, <span style="color: blue">true</span>);</font></p>    <p style="margin: 0px"><font size="2">&#160; }</font></p>    <p style="margin: 0px"><font size="2">}</font></p> </div>
