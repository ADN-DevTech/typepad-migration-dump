---
layout: "post"
title: "Insert Cone Along The Axis of 3D Polyline"
date: "2016-05-11 00:44:00"
author: "Madhukar Moogala"
categories:
  - "2015"
  - "2016"
  - "AutoCAD"
  - "ObjectARX"
original_url: "https://adndevblog.typepad.com/autocad/2016/05/insert-cone-along-the-axis-of-3d-polyline.html "
typepad_basename: "insert-cone-along-the-axis-of-3d-polyline"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/Madhukar-Moogala.html" target="_self">Madhukar Moogala</a></p> <p>This problem illustrates how we can insert a solid frustum along the axis of each segment of AcDb3dPolyline, the cone always points in right direction irrespective of view changes.</p> <p>This may be useful in depicting flow direction in line diagrams of thermo-fluid dynamic analysis. </p> <p>The code creates a temporary UCS on each segment of 3dpoly to ensure cone aligns always in correct direction.</p>Command Code:  <div style="font-size: 10pt; font-family: consolas; background: #1e1e1e; color: #dcdcdc"> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #569cd6; line-height: 140%">void</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">testFlow</span><span style="color: #b4b4b4; line-height: 140%">()</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">{</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">bool</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">OK</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #569cd6; line-height: 140%">true</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: white; line-height: 140%">ads_name</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">entres</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: white; line-height: 140%">ads_point</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">ptres</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">while</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">OK</span><span style="color: #b4b4b4; line-height: 140%">)</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">{</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">if</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">acedEntSel</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">_T</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #d69d85; line-height: 140%">"Select 3d poly"</span><span style="color: #b4b4b4; line-height: 140%">),</span><span style="color: white; line-height: 140%">entres</span><span style="color: #b4b4b4; line-height: 140%">,</span><span style="color: white; line-height: 140%">ptres</span><span style="color: #b4b4b4; line-height: 140%">)</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">!=</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">RTNORM</span><span style="color: #b4b4b4; line-height: 140%">)</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">{</span><span style="line-height: 140%"> </span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: white; line-height: 140%">OK</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #569cd6; line-height: 140%">false</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">return</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">}</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #608b4e; line-height: 140%">/*Get List of vertex points*/</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: white; line-height: 140%">AcGePoint3dArray</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">listVertices</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: white; line-height: 140%">getListOfVerticesFromP3dLine</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">entres</span><span style="color: #b4b4b4; line-height: 140%">,</span><span style="color: white; line-height: 140%">listVertices</span><span style="color: #b4b4b4; line-height: 140%">);</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #608b4e; line-height: 140%">/*To avoid buffer overflow*/</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">for</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #569cd6; line-height: 140%">int</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">i</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="color: #b5cea8; line-height: 140%">0</span><span style="color: #b4b4b4; line-height: 140%">,</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">j</span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="color: #b5cea8; line-height: 140%">1</span><span style="color: #b4b4b4; line-height: 140%">;</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">i</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">&lt;</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">listVertices</span><span style="color: #b4b4b4; line-height: 140%">.</span><span style="color: white; line-height: 140%">length</span><span style="color: #b4b4b4; line-height: 140%">()-</span><span style="color: #b5cea8; line-height: 140%">1</span><span style="color: #b4b4b4; line-height: 140%">;</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">i</span><span style="color: #b4b4b4; line-height: 140%">++)</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">{</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: white; line-height: 140%">insert_arrow_Adsk</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">listVertices</span><span style="color: #b4b4b4; line-height: 140%">.</span><span style="color: white; line-height: 140%">at</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">i</span><span style="color: #b4b4b4; line-height: 140%">),</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">listVertices</span><span style="color: #b4b4b4; line-height: 140%">.</span><span style="color: white; line-height: 140%">at</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">j</span><span style="color: #b4b4b4; line-height: 140%">));</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: white; line-height: 140%">j</span><span style="color: #b4b4b4; line-height: 140%">++;</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">}</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: white; line-height: 140%">listVertices</span><span style="color: #b4b4b4; line-height: 140%">.</span><span style="color: white; line-height: 140%">removeAll</span><span style="color: #b4b4b4; line-height: 140%">();</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">}</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">}</span></p></div> <p>&nbsp;</p> <p>Utility Methods:</p> <div style="font-size: 10pt; font-family: consolas; background: #1e1e1e; color: #dcdcdc"> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #569cd6; line-height: 140%">void</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">createUCS</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #4ec9b0; line-height: 140%">AcGePoint3d</span><span style="line-height: 140%"> </span><span style="color: #7f7f7f; line-height: 140%">origin_point</span><span style="color: #b4b4b4; line-height: 140%">,</span><span style="color: #4ec9b0; line-height: 140%">AcGeVector3d</span><span style="line-height: 140%"> </span><span style="color: #7f7f7f; line-height: 140%">UCSXaxis</span><span style="color: #b4b4b4; line-height: 140%">,</span><span style="color: #4ec9b0; line-height: 140%">AcGeVector3d</span><span style="line-height: 140%"> </span><span style="color: #7f7f7f; line-height: 140%">UCSYaxis</span><span style="color: #b4b4b4; line-height: 140%">)</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">{</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #4ec9b0; line-height: 140%">Acad</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: #4ec9b0; line-height: 140%">ErrorStatus</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">es</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #4ec9b0; line-height: 140%">AcDbUCSTableRecord</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">*</span><span style="color: #c8c8c8; line-height: 140%">myUCS</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="color: #bd63c5; line-height: 140%">NULL</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #4ec9b0; line-height: 140%">AcDbObjectId</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">UCSId</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #4ec9b0; line-height: 140%">AcDbUCSTable</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">*</span><span style="color: #c8c8c8; line-height: 140%">pUCSTable</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">if</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">acdbHostApplicationServices</span><span style="color: #b4b4b4; line-height: 140%">()-&gt;</span><span style="color: #c8c8c8; line-height: 140%">workingDatabase</span><span style="color: #b4b4b4; line-height: 140%">()-&gt;</span><span style="color: #c8c8c8; line-height: 140%">getUCSTable</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">pUCSTable</span><span style="color: #b4b4b4; line-height: 140%">,</span><span style="color: #4ec9b0; line-height: 140%">AcDb</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: #b8d7a3; line-height: 140%">kForWrite</span><span style="color: #b4b4b4; line-height: 140%">)==</span><span style="color: #4ec9b0; line-height: 140%">Acad</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: #b8d7a3; line-height: 140%">eOk</span><span style="color: #b4b4b4; line-height: 140%">)</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">{</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">if</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">pUCSTable</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">getAt</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">L</span><span style="color: #d69d85; line-height: 140%">"myUCS"</span><span style="color: #b4b4b4; line-height: 140%">,</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">myUCS</span><span style="color: #b4b4b4; line-height: 140%">,</span><span style="line-height: 140%"> </span><span style="color: #4ec9b0; line-height: 140%">AcDb</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: #b8d7a3; line-height: 140%">kForWrite</span><span style="color: #b4b4b4; line-height: 140%">)</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">!=</span><span style="line-height: 140%"> </span><span style="color: #4ec9b0; line-height: 140%">Acad</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: #b8d7a3; line-height: 140%">eOk</span><span style="color: #b4b4b4; line-height: 140%">)</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">{</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">myUCS</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #569cd6; line-height: 140%">new</span><span style="line-height: 140%"> </span><span style="color: #4ec9b0; line-height: 140%">AcDbUCSTableRecord</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #608b4e; line-height: 140%">/*Define UCS*/</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">myUCS</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">setOrigin</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #7f7f7f; line-height: 140%">origin_point</span><span style="color: #b4b4b4; line-height: 140%">);</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">myUCS</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">setXAxis</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #7f7f7f; line-height: 140%">UCSXaxis</span><span style="color: #b4b4b4; line-height: 140%">);</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">myUCS</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">setYAxis</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #7f7f7f; line-height: 140%">UCSYaxis</span><span style="color: #b4b4b4; line-height: 140%">);</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">es</span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="color: #c8c8c8; line-height: 140%">myUCS</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">setName</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #bd63c5; line-height: 140%">_T</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #d69d85; line-height: 140%">"MyUCS"</span><span style="color: #b4b4b4; line-height: 140%">));</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">if</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">es</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">!=</span><span style="line-height: 140%"> </span><span style="color: #4ec9b0; line-height: 140%">Acad</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: #b8d7a3; line-height: 140%">eOk</span><span style="color: #b4b4b4; line-height: 140%">)</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">{</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">acutPrintf</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #bd63c5; line-height: 140%">_T</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #d69d85; line-height: 140%">"\nFailed to set name"</span><span style="color: #b4b4b4; line-height: 140%">));</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">return</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">}</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">es</span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="color: #c8c8c8; line-height: 140%">pUCSTable</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">add</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">UCSId</span><span style="color: #b4b4b4; line-height: 140%">,</span><span style="color: #c8c8c8; line-height: 140%">myUCS</span><span style="color: #b4b4b4; line-height: 140%">);</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">}</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #608b4e; line-height: 140%">/*Modify UCS*/</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">myUCS</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">setOrigin</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #7f7f7f; line-height: 140%">origin_point</span><span style="color: #b4b4b4; line-height: 140%">);</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">myUCS</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">setXAxis</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #7f7f7f; line-height: 140%">UCSXaxis</span><span style="color: #b4b4b4; line-height: 140%">);</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">myUCS</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">setYAxis</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #7f7f7f; line-height: 140%">UCSYaxis</span><span style="color: #b4b4b4; line-height: 140%">);</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #608b4e; line-height: 140%">/*Close*/</span><span style="line-height: 140%">&nbsp; </span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">es</span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">myUCS</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">close</span><span style="color: #b4b4b4; line-height: 140%">();</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">es</span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="color: #c8c8c8; line-height: 140%">pUCSTable</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">close</span><span style="color: #b4b4b4; line-height: 140%">();</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">}</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">else</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">{</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">acutPrintf</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #bd63c5; line-height: 140%">_T</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #d69d85; line-height: 140%">"\nFailed to get UCS table"</span><span style="color: #b4b4b4; line-height: 140%">));</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">return</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">}</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #608b4e; line-height: 140%">//To set the current UCS, I accessed the active AcDbViewportTableRecord</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #608b4e; line-height: 140%">// and used setUCS to set the UCS I created as current.</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #4ec9b0; line-height: 140%">AcDbViewportTable</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">*</span><span style="color: #c8c8c8; line-height: 140%">pVT</span><span style="color: #b4b4b4; line-height: 140%">;</span><span style="line-height: 140%">&nbsp; </span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">es</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">acedVports2VportTableRecords</span><span style="color: #b4b4b4; line-height: 140%">();</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">if</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">es</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">!=</span><span style="line-height: 140%"> </span><span style="color: #4ec9b0; line-height: 140%">Acad</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: #b8d7a3; line-height: 140%">eOk</span><span style="color: #b4b4b4; line-height: 140%">)</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">{</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">acutPrintf</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #bd63c5; line-height: 140%">_T</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #d69d85; line-height: 140%">"\nFailed to load vport info into vport table records"</span><span style="color: #b4b4b4; line-height: 140%">));</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">return</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">}</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">es</span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="color: #c8c8c8; line-height: 140%">acdbHostApplicationServices</span><span style="color: #b4b4b4; line-height: 140%">()-&gt;</span><span style="color: #c8c8c8; line-height: 140%">workingDatabase</span><span style="color: #b4b4b4; line-height: 140%">()-&gt;</span><span style="color: #c8c8c8; line-height: 140%">getViewportTable</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">pVT</span><span style="color: #b4b4b4; line-height: 140%">,</span><span style="color: #4ec9b0; line-height: 140%">AcDb</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: #b8d7a3; line-height: 140%">kForRead</span><span style="color: #b4b4b4; line-height: 140%">);</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">if</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">es</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">!=</span><span style="line-height: 140%"> </span><span style="color: #4ec9b0; line-height: 140%">Acad</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: #b8d7a3; line-height: 140%">eOk</span><span style="color: #b4b4b4; line-height: 140%">)</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">{</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">acutPrintf</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #bd63c5; line-height: 140%">_T</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #d69d85; line-height: 140%">"\nFailed to get vport table"</span><span style="color: #b4b4b4; line-height: 140%">));</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">pVT</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">close</span><span style="color: #b4b4b4; line-height: 140%">();</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">return</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">}</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #4ec9b0; line-height: 140%">AcDbViewportTableIterator</span><span style="color: #b4b4b4; line-height: 140%">*</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">pIter</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #bd63c5; line-height: 140%">NULL</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">es</span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="color: #c8c8c8; line-height: 140%">pVT</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">newIterator</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">pIter</span><span style="color: #b4b4b4; line-height: 140%">);</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">if</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">es</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">!=</span><span style="line-height: 140%"> </span><span style="color: #4ec9b0; line-height: 140%">Acad</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: #b8d7a3; line-height: 140%">eOk</span><span style="color: #b4b4b4; line-height: 140%">)</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">{</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">acutPrintf</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #bd63c5; line-height: 140%">_T</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #d69d85; line-height: 140%">"\nFailed to get vport table"</span><span style="color: #b4b4b4; line-height: 140%">));</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">pVT</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">close</span><span style="color: #b4b4b4; line-height: 140%">();</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">delete</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">pIter</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">return</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">}</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">for</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">pIter</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">start</span><span style="color: #b4b4b4; line-height: 140%">();!</span><span style="color: #c8c8c8; line-height: 140%">pIter</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">done</span><span style="color: #b4b4b4; line-height: 140%">();</span><span style="color: #c8c8c8; line-height: 140%">pIter</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">step</span><span style="color: #b4b4b4; line-height: 140%">())</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">{</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #4ec9b0; line-height: 140%">AcDbViewportTableRecord</span><span style="color: #b4b4b4; line-height: 140%">*</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">pRec</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">es</span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="color: #c8c8c8; line-height: 140%">pIter</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">getRecord</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">pRec</span><span style="color: #b4b4b4; line-height: 140%">,</span><span style="color: #4ec9b0; line-height: 140%">AcDb</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: #b8d7a3; line-height: 140%">kForWrite</span><span style="color: #b4b4b4; line-height: 140%">);</span><span style="line-height: 140%"> </span><span style="color: #608b4e; line-height: 140%">//it should be open for write mode</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">if</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">es</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">!=</span><span style="line-height: 140%"> </span><span style="color: #4ec9b0; line-height: 140%">Acad</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: #b8d7a3; line-height: 140%">eOk</span><span style="color: #b4b4b4; line-height: 140%">)</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">{</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">acutPrintf</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #bd63c5; line-height: 140%">_T</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #d69d85; line-height: 140%">"\nFailed to get vport table record"</span><span style="color: #b4b4b4; line-height: 140%">));</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">pVT</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">close</span><span style="color: #b4b4b4; line-height: 140%">();</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">pRec</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">close</span><span style="color: #b4b4b4; line-height: 140%">();</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">delete</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">pIter</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">return</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">}</span><span style="line-height: 140%">&nbsp; </span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #4ec9b0; line-height: 140%">ACHAR</span><span style="color: #b4b4b4; line-height: 140%">*</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">name</span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="color: #bd63c5; line-height: 140%">NULL</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">es</span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="color: #c8c8c8; line-height: 140%">pRec</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">getName</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">name</span><span style="color: #b4b4b4; line-height: 140%">);</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">if</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">es</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">!=</span><span style="line-height: 140%"> </span><span style="color: #4ec9b0; line-height: 140%">Acad</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: #b8d7a3; line-height: 140%">eOk</span><span style="color: #b4b4b4; line-height: 140%">)</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">{</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">acutPrintf</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #bd63c5; line-height: 140%">_T</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #d69d85; line-height: 140%">"\nFailed to get name from vport table"</span><span style="color: #b4b4b4; line-height: 140%">));</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">pVT</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">close</span><span style="color: #b4b4b4; line-height: 140%">();</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">pRec</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">close</span><span style="color: #b4b4b4; line-height: 140%">();</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">delete</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">pIter</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">return</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">}</span><span style="line-height: 140%">&nbsp; </span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">if</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">wcscmp</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">name</span><span style="color: #b4b4b4; line-height: 140%">,</span><span style="color: #bd63c5; line-height: 140%">_T</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #d69d85; line-height: 140%">"*Active"</span><span style="color: #b4b4b4; line-height: 140%">))==</span><span style="color: #b5cea8; line-height: 140%">0</span><span style="color: #b4b4b4; line-height: 140%">)</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">{</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">es</span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="color: #c8c8c8; line-height: 140%">pRec</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">setUcs</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">myUCS</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">objectId</span><span style="color: #b4b4b4; line-height: 140%">());</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">}</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">es</span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="color: #c8c8c8; line-height: 140%">pRec</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">close</span><span style="color: #b4b4b4; line-height: 140%">();</span><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">}</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">es</span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="color: #c8c8c8; line-height: 140%">acedVportTableRecords2Vports</span><span style="color: #b4b4b4; line-height: 140%">();</span><span style="line-height: 140%"> </span><span style="color: #608b4e; line-height: 140%">//force update</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">es</span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="color: #c8c8c8; line-height: 140%">pVT</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">close</span><span style="color: #b4b4b4; line-height: 140%">();</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">delete</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">pIter</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">return</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">;</span><span style="line-height: 140%">&nbsp; </span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">}</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #569cd6; line-height: 140%">void</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">insert_arrow_Adsk</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #4ec9b0; line-height: 140%">AcGePoint3d</span><span style="line-height: 140%"> </span><span style="color: #7f7f7f; line-height: 140%">startPt</span><span style="color: #b4b4b4; line-height: 140%">,</span><span style="line-height: 140%"> </span><span style="color: #4ec9b0; line-height: 140%">AcGePoint3d</span><span style="line-height: 140%"> </span><span style="color: #7f7f7f; line-height: 140%">trailPt</span><span style="color: #b4b4b4; line-height: 140%">)</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">{</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #4ec9b0; line-height: 140%">AcGePoint3d</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">midPt</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #4ec9b0; line-height: 140%">AcGePoint3d</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">((</span><span style="color: #7f7f7f; line-height: 140%">startPt</span><span style="color: #b4b4b4; line-height: 140%">.</span><span style="color: #dadada; line-height: 140%">x</span><span style="color: #b4b4b4; line-height: 140%">+</span><span style="line-height: 140%"> </span><span style="color: #7f7f7f; line-height: 140%">trailPt</span><span style="color: #b4b4b4; line-height: 140%">.</span><span style="color: #dadada; line-height: 140%">x</span><span style="color: #b4b4b4; line-height: 140%">)/</span><span style="color: #b5cea8; line-height: 140%">2</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">,(</span><span style="color: #7f7f7f; line-height: 140%">startPt</span><span style="color: #b4b4b4; line-height: 140%">.</span><span style="color: #dadada; line-height: 140%">y</span><span style="color: #b4b4b4; line-height: 140%">+</span><span style="line-height: 140%"> </span><span style="color: #7f7f7f; line-height: 140%">trailPt</span><span style="color: #b4b4b4; line-height: 140%">.</span><span style="color: #dadada; line-height: 140%">y</span><span style="color: #b4b4b4; line-height: 140%">)/</span><span style="color: #b5cea8; line-height: 140%">2</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">,(</span><span style="color: #7f7f7f; line-height: 140%">startPt</span><span style="color: #b4b4b4; line-height: 140%">.</span><span style="color: #dadada; line-height: 140%">z</span><span style="color: #b4b4b4; line-height: 140%">+</span><span style="line-height: 140%"> </span><span style="color: #7f7f7f; line-height: 140%">trailPt</span><span style="color: #b4b4b4; line-height: 140%">.</span><span style="color: #dadada; line-height: 140%">z</span><span style="color: #b4b4b4; line-height: 140%">)/</span><span style="color: #b5cea8; line-height: 140%">2</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">);</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #4ec9b0; line-height: 140%">AcGeVector3d</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">direction</span><span style="color: #b4b4b4; line-height: 140%">((</span><span style="color: #7f7f7f; line-height: 140%">trailPt</span><span style="color: #b4b4b4; line-height: 140%">.</span><span style="color: #dadada; line-height: 140%">x</span><span style="color: #b4b4b4; line-height: 140%">-</span><span style="color: #7f7f7f; line-height: 140%">startPt</span><span style="color: #b4b4b4; line-height: 140%">.</span><span style="color: #dadada; line-height: 140%">x</span><span style="color: #b4b4b4; line-height: 140%">),(</span><span style="color: #7f7f7f; line-height: 140%">trailPt</span><span style="color: #b4b4b4; line-height: 140%">.</span><span style="color: #dadada; line-height: 140%">y</span><span style="color: #b4b4b4; line-height: 140%">-</span><span style="color: #7f7f7f; line-height: 140%">startPt</span><span style="color: #b4b4b4; line-height: 140%">.</span><span style="color: #dadada; line-height: 140%">y</span><span style="color: #b4b4b4; line-height: 140%">),(</span><span style="color: #7f7f7f; line-height: 140%">trailPt</span><span style="color: #b4b4b4; line-height: 140%">.</span><span style="color: #dadada; line-height: 140%">z</span><span style="color: #b4b4b4; line-height: 140%">-</span><span style="color: #7f7f7f; line-height: 140%">startPt</span><span style="color: #b4b4b4; line-height: 140%">.</span><span style="color: #dadada; line-height: 140%">z</span><span style="color: #b4b4b4; line-height: 140%">));</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #4ec9b0; line-height: 140%">AcGePlane</span><span style="color: #b4b4b4; line-height: 140%">*</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">tempPlane</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #569cd6; line-height: 140%">new</span><span style="line-height: 140%"> </span><span style="color: #4ec9b0; line-height: 140%">AcGePlane</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">midPt</span><span style="color: #b4b4b4; line-height: 140%">,</span><span style="color: #c8c8c8; line-height: 140%">direction</span><span style="color: #b4b4b4; line-height: 140%">);</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #4ec9b0; line-height: 140%">AcGeVector3d</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">uaxis</span><span style="color: #b4b4b4; line-height: 140%">,</span><span style="color: #c8c8c8; line-height: 140%">vaxis</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #4ec9b0; line-height: 140%">AcGePoint3d</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">point</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">tempPlane</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">get</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">point</span><span style="color: #b4b4b4; line-height: 140%">,</span><span style="color: #c8c8c8; line-height: 140%">uaxis</span><span style="color: #b4b4b4; line-height: 140%">,</span><span style="color: #c8c8c8; line-height: 140%">vaxis</span><span style="color: #b4b4b4; line-height: 140%">);</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #608b4e; line-height: 140%">/*Create UCS\ set UCS as Current*/</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">createUCS</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">midPt</span><span style="color: #b4b4b4; line-height: 140%">,</span><span style="color: #c8c8c8; line-height: 140%">uaxis</span><span style="color: #b4b4b4; line-height: 140%">,</span><span style="color: #c8c8c8; line-height: 140%">vaxis</span><span style="color: #b4b4b4; line-height: 140%">);</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #4ec9b0; line-height: 140%">AcGeMatrix3d</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">mat</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">mat</span><span style="color: #b4b4b4; line-height: 140%">.</span><span style="color: #c8c8c8; line-height: 140%">setCoordSystem</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">midPt</span><span style="color: #b4b4b4; line-height: 140%">,</span><span style="color: #c8c8c8; line-height: 140%">uaxis</span><span style="color: #b4b4b4; line-height: 140%">,</span><span style="color: #c8c8c8; line-height: 140%">vaxis</span><span style="color: #b4b4b4; line-height: 140%">,</span><span style="color: #c8c8c8; line-height: 140%">direction</span><span style="color: #b4b4b4; line-height: 140%">);</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">acedSetCurrentUCS</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">mat</span><span style="color: #b4b4b4; line-height: 140%">);</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #608b4e; line-height: 140%">/*get Currennt UCS ,transform Cone to that UCS*/</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">acedGetCurrentUCS</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">mat</span><span style="color: #b4b4b4; line-height: 140%">);</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #608b4e; line-height: 140%">/*Create cone frustrum*/</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #4ec9b0; line-height: 140%">AcDb3dSolid</span><span style="color: #b4b4b4; line-height: 140%">*</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">pSolid</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #569cd6; line-height: 140%">new</span><span style="line-height: 140%"> </span><span style="color: #4ec9b0; line-height: 140%">AcDb3dSolid</span><span style="color: #b4b4b4; line-height: 140%">();</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">pSolid</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">setDatabaseDefaults</span><span style="color: #b4b4b4; line-height: 140%">();</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">pSolid</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">setColorIndex</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #b5cea8; line-height: 140%">3</span><span style="color: #b4b4b4; line-height: 140%">);</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #608b4e; line-height: 140%">/*hardcode*/</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">pSolid</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">createFrustum</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #b5cea8; line-height: 140%">30.0</span><span style="color: #b4b4b4; line-height: 140%">,</span><span style="color: #b5cea8; line-height: 140%">5.0</span><span style="color: #b4b4b4; line-height: 140%">,</span><span style="color: #b5cea8; line-height: 140%">5.0</span><span style="color: #b4b4b4; line-height: 140%">,</span><span style="color: #b5cea8; line-height: 140%">0.0</span><span style="color: #b4b4b4; line-height: 140%">);</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">pSolid</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">transformBy</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">mat</span><span style="color: #b4b4b4; line-height: 140%">);</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #4ec9b0; line-height: 140%">AcDbObjectId</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">oId</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #4ec9b0; line-height: 140%">AcDbObjectId</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: #c8c8c8; line-height: 140%">kNull</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #608b4e; line-height: 140%">/*Post entity to DB*/</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">postToDb</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">pSolid</span><span style="color: #b4b4b4; line-height: 140%">);</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">mat</span><span style="color: #b4b4b4; line-height: 140%">.</span><span style="color: #c8c8c8; line-height: 140%">setToIdentity</span><span style="color: #b4b4b4; line-height: 140%">();</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">acedSetCurrentUCS</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">mat</span><span style="color: #b4b4b4; line-height: 140%">);</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">}</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #569cd6; line-height: 140%">void</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">getListOfVerticesFromP3dLine</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="line-height: 140%"> </span><span style="color: #4ec9b0; line-height: 140%">ads_name</span><span style="line-height: 140%"> </span><span style="color: #7f7f7f; line-height: 140%">entres</span><span style="color: #b4b4b4; line-height: 140%">,</span><span style="line-height: 140%">&nbsp; </span><span style="color: #4ec9b0; line-height: 140%">AcGePoint3dArray</span><span style="color: #b4b4b4; line-height: 140%">&amp;</span><span style="line-height: 140%"> </span><span style="color: #7f7f7f; line-height: 140%">vArray</span><span style="color: #b4b4b4; line-height: 140%">)</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">{</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #4ec9b0; line-height: 140%">AcDbObjectId</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">oId</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #4ec9b0; line-height: 140%">AcDbObjectId</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: #c8c8c8; line-height: 140%">kNull</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">if</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">acdbGetObjectId</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">oId</span><span style="color: #b4b4b4; line-height: 140%">,</span><span style="color: #7f7f7f; line-height: 140%">entres</span><span style="color: #b4b4b4; line-height: 140%">)</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">!=</span><span style="line-height: 140%"> </span><span style="color: #4ec9b0; line-height: 140%">Acad</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: #b8d7a3; line-height: 140%">eOk</span><span style="color: #b4b4b4; line-height: 140%">)</span><span style="line-height: 140%"> </span><span style="color: #569cd6; line-height: 140%">return</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #4ec9b0; line-height: 140%">AcDbSmartObjectPointer</span><span style="color: #b4b4b4; line-height: 140%">&lt;</span><span style="color: #4ec9b0; line-height: 140%">AcDb3dPolyline</span><span style="color: #b4b4b4; line-height: 140%">&gt;</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">pEnt</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">oId</span><span style="color: #b4b4b4; line-height: 140%">,</span><span style="color: #4ec9b0; line-height: 140%">AcDb</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: #b8d7a3; line-height: 140%">kForWrite</span><span style="color: #b4b4b4; line-height: 140%">);</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">if</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">pEnt</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">!=</span><span style="line-height: 140%"> </span><span style="color: #569cd6; line-height: 140%">nullptr</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">&amp;&amp;</span><span style="line-height: 140%"> </span><span style="color: #bd63c5; line-height: 140%">eOkVerify</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">pEnt</span><span style="color: #b4b4b4; line-height: 140%">.</span><span style="color: #c8c8c8; line-height: 140%">openStatus</span><span style="color: #b4b4b4; line-height: 140%">()))</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">{</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #4ec9b0; line-height: 140%">AcDbObjectIterator</span><span style="color: #b4b4b4; line-height: 140%">*</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">pIter</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">pEnt</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">vertexIterator</span><span style="color: #b4b4b4; line-height: 140%">();</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #4ec9b0; line-height: 140%">AcGePoint3d</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">trailPt</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">,</span><span style="color: #c8c8c8; line-height: 140%">midPt</span><span style="color: #b4b4b4; line-height: 140%">,</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">startPt</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">for</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">pIter</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">start</span><span style="color: #b4b4b4; line-height: 140%">();</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">!</span><span style="color: #c8c8c8; line-height: 140%">pIter</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">done</span><span style="color: #b4b4b4; line-height: 140%">();</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">pIter</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">step</span><span style="color: #b4b4b4; line-height: 140%">())</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">{</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #4ec9b0; line-height: 140%">AcDbSmartObjectPointer</span><span style="color: #b4b4b4; line-height: 140%">&lt;</span><span style="color: #4ec9b0; line-height: 140%">AcDb3dPolylineVertex</span><span style="color: #b4b4b4; line-height: 140%">&gt;</span><span style="color: #c8c8c8; line-height: 140%">pVertex</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">pIter</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">objectId</span><span style="color: #b4b4b4; line-height: 140%">(),</span><span style="line-height: 140%"> </span><span style="color: #4ec9b0; line-height: 140%">AcDb</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: #b8d7a3; line-height: 140%">kForRead</span><span style="color: #b4b4b4; line-height: 140%">);</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">if</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #bd63c5; line-height: 140%">eOkVerify</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">pVertex</span><span style="color: #b4b4b4; line-height: 140%">.</span><span style="color: #c8c8c8; line-height: 140%">openStatus</span><span style="color: #b4b4b4; line-height: 140%">()))</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">{</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #7f7f7f; line-height: 140%">vArray</span><span style="color: #b4b4b4; line-height: 140%">.</span><span style="color: #c8c8c8; line-height: 140%">append</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">pVertex</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">position</span><span style="color: #b4b4b4; line-height: 140%">());</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">}</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">}</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">}</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">}</span></p></div> <p>&nbsp;</p> <p>Working GIF:</p> <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d1e252cb970c-pi"><img title="TFL" style="display: inline" alt="TFL" src="/assets/image_296500.jpg" width="738" height="397"></a></p>
