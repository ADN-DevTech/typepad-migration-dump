---
layout: "post"
title: "DataLinksManager3d.GetLineGroupInfo fails in AutoCAD Plant3D 2012/2013"
date: "2012-08-09 10:33:58"
author: "Fenton Webb"
categories:
  - ".NET"
  - "2010"
  - "2011"
  - "2012"
  - "2013"
  - "AutoCAD"
  - "Fenton Webb"
original_url: "https://adndevblog.typepad.com/autocad/2012/08/datalinksmanager3dgetlinegroupinfo-fails-in-autocad-plant3d-20122013.html "
typepad_basename: "datalinksmanager3dgetlinegroupinfo-fails-in-autocad-plant3d-20122013"
typepad_status: "Publish"
---

<p>by <a href="http://adndevblog.typepad.com/autocad/fenton-webb.html">Fenton Webb</a></p>  <p>It seems that I found a slight problem with the Plant3d API in terms of obtaining the PipeLineGroupData from the DataLinksManager3d.GetLineGroupInfo().</p>  <p>If you are running into this issue, then try this code belowâ€¦</p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">[</font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">CommandMethod</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;GetLineGroupInfo&quot;</font></span><font color="#000000">)]</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">public</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">GetLineGroupInfo</font></span><font color="#000000">()</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">{</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// get the AutoCAD Editor object so we can print to the command line</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">Editor</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">ed</font></span><font color="#000000"> = </font><span style="color: "><font color="#2b91af">AcadApp</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">DocumentManager</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">MdiActiveDocument</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Editor</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// select the object </font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">PromptEntityResult</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">res</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">ed</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">GetEntity</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;Pick Object obtain properties : &quot;</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// if something selected</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">res</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Status</font></span><font color="#000000"> == </font><span style="color: "><font color="#2b91af">PromptStatus</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">OK</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160; {</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// get the current project object</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">PlantProject</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">currentProj</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">Autodesk</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">ProcessPower</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">PlantInstance</font></span><font color="#000000">.</font><span style="color: "><font color="#2b91af">PlantApplication</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">CurrentProject</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// get the Piping project part</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">Autodesk</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">ProcessPower</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">P3dProjectParts</font></span><font color="#000000">.</font><span style="color: "><font color="#2b91af">PipingProject</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">pipeProj</font></span><font color="#000000"> = (</font><span style="color: "><font color="#010001">Autodesk</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">ProcessPower</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">P3dProjectParts</font></span><font color="#000000">.</font><span style="color: "><font color="#2b91af">PipingProject</font></span><font color="#000000">)</font><span style="color: "><font color="#010001">currentProj</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">ProjectParts</font></span><font color="#000000">[</font><span style="color: "><font color="#a31515">&quot;Piping&quot;</font></span><font color="#000000">];</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// get the data links manager</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">DataLinksManager</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">dlm</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">pipeProj</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">DataLinksManager</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// get the 3d data links manager</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">DataLinksManager3d</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">dlm3d</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">pipeProj</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">DataLinksManager3d</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// and then get the row id for the selected object</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">int</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">rowId</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">dlm</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">FindAcPpRowId</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">res</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">ObjectId</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">try</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">PipeLineGroupData</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">lginfo</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">dlm3d</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">GetLineGroupInfo</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">rowId</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">catch</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// there is a slignt issue in the Plant that prevents getting lginfo by </font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font style="font-size: 8pt" color="#008000">&#160;&#160;&#160;&#160;&#160; // part rowid. Sorry about that.</font></span></font><font face="Consolas"><span style="color: "><font style="font-size: 8pt" color="#008000"> We can achieve the same thing using the</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font style="font-size: 8pt" color="#008000">&#160;&#160;&#160;&#160;&#160; //&#160; following workaround (see below)</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// Parts are related to pipe line group via P3dLineGroupPartRelationship. </font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font style="font-size: 8pt" color="#008000">&#160;&#160;&#160; // So we need to traverse this </font></span></font><font face="Consolas"><span style="color: "><font style="font-size: 8pt" color="#008000">relationship to get line group row id</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">PnPRowIdArray</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">lgid</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">dlm</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">GetRelatedRowIds</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;P3dLineGroupPartRelationship&quot;</font></span><font color="#000000">, </font><span style="color: "><font color="#a31515">&quot;Part&quot;</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">rowId</font></span><font color="#000000">, </font><span style="color: "><font color="#a31515">&quot;LineGroup&quot;</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">lgid</font></span><font color="#000000"> == </font><span style="color: "><font color="#0000ff">null</font></span><font color="#000000"> || </font><span style="color: "><font color="#010001">lgid</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Count</font></span><font color="#000000"> == 0)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// line group was not found - for example, if Equipment is picked.</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// this is line group row in the data. (PnPRowIdArray is in fact list</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">int</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">lgRowId</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">lgid</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">First</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Value</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// using lgRowId you can get all line group properties using the following</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// last parameter doesn't matter</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">List</font></span><font color="#000000">&lt;</font><span style="color: "><font color="#2b91af">KeyValuePair</font></span><font color="#000000">&lt;</font><span style="color: "><font color="#0000ff">string</font></span><font color="#000000">, </font><span style="color: "><font color="#0000ff">string</font></span><font color="#000000">&gt;&gt; </font><span style="color: "><font color="#010001">vals</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">dlm</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">GetAllProperties</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">lgRowId</font></span><font color="#000000">, </font><span style="color: "><font color="#0000ff">false</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// or get the same thing from PnPDatabase via row</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">PnPRow</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">lgRow</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">dlm</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">GetPnPDatabase</font></span><font color="#000000">().</font><span style="color: "><font color="#010001">GetRow</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">lgRowId</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// the following code will only work if linegroup has a valid (not empty) </font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font style="font-size: 8pt" color="#008000">&#160;&#160;&#160; // tag. Expect an </font></span></font><font face="Consolas"><span style="color: "><font style="font-size: 8pt" color="#008000">exception here if LineGroup is not assigned a tag </font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">try</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">PipeLineGroupData</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">lginfoAtLast</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">dlm3d</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">GetLineGroupInfo</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">lgRowId</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">catch</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// get here if line group doesn't have assigned tag</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160; }</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">}</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p> </div>
