---
layout: "post"
title: "LispFunction examples for AutoLISP to .NET"
date: "2012-08-22 11:59:22"
author: "Augusto Goncalves"
categories:
  - ".NET"
  - "Augusto Goncalves"
  - "AutoCAD"
  - "LISP"
original_url: "https://adndevblog.typepad.com/autocad/2012/08/lispfunction-examples-for-autolisp-to-net.html "
typepad_basename: "lispfunction-examples-for-autolisp-to-net"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>It is possible to pass standard data types to and from .NET using a result buffer and the &lt;LispFunction&gt; directive. Below are two .NET methods that make selections, and return (1) one entity ID or (2) a set of entities IDs.</p>  <div style="font-family: ; background: white">   <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&lt;</font></font><font style="font-size: 8pt"><span><font color="#2b91af">LispFunction</font></span><font color="#000000">(</font><span><font color="#a31515">&quot;MyLispFunction1&quot;</font></span><font color="#000000">)&gt; _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">Public</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span><font color="#0000ff">Function</font></span><font color="#000000"> SelectOneEntity( _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">ByVal</font></span><font color="#000000"> myLispArgs </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">ResultBuffer</font></span><font color="#000000">) _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#2b91af">ResultBuffer</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> rbfResult </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#2b91af">ResultBuffer</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> ed </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">Editor</font></span><font color="#000000"> = </font><span><font color="#2b91af">Application</font></span><font color="#000000">.DocumentManager. _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; MdiActiveDocument.Editor</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' select one entity</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> prmptEntOpts </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#0000ff">New</font></span><font color="#000000"> </font><span><font color="#2b91af">PromptEntityOptions</font></span><font color="#000000">( _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#a31515">&quot;Select Entity&quot;</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> prmptEntRes </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#2b91af">PromptEntityResult</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; prmptEntRes = ed.GetEntity(prmptEntOpts)</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">If</font></span><font color="#000000"> prmptEntRes.Status &lt;&gt; </font><span><font color="#2b91af">PromptStatus</font></span><font color="#000000">.OK </font></font><span><font style="font-size: 8pt" color="#0000ff">Then</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; rbfResult = </font></font><font style="font-size: 8pt"><span><font color="#0000ff">New</font></span><font color="#000000"> </font><span><font color="#2b91af">ResultBuffer</font></span><font color="#000000">( _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">New</font></span><font color="#000000"> </font><span><font color="#2b91af">TypedValue</font></span><font color="#000000">(5019))</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Return</font></span><font color="#000000"> rbfResult</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">If</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' return the objectId selected</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> objId </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#2b91af">ObjectId</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; objId = prmptEntRes.ObjectId</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; rbfResult = </font></font><font style="font-size: 8pt"><span><font color="#0000ff">New</font></span><font color="#000000"> </font><span><font color="#2b91af">ResultBuffer</font></span><font color="#000000">( _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">New</font></span><font color="#000000"> </font><span><font color="#2b91af">TypedValue</font></span><font color="#000000">(5006, objId))</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Return</font></span><font color="#000000"> rbfResult</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">End</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">Function</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&lt;</font></font><font style="font-size: 8pt"><span><font color="#2b91af">LispFunction</font></span><font color="#000000">(</font><span><font color="#a31515">&quot;MyLispFunction2&quot;</font></span><font color="#000000">)&gt; _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">Public</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span><font color="#0000ff">Function</font></span><font color="#000000"> SelectSetOfEntities( _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">ByVal</font></span><font color="#000000"> myLispArgs </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">ResultBuffer</font></span><font color="#000000">) _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#2b91af">ResultBuffer</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> rbfResult </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#2b91af">ResultBuffer</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> ed </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">Editor</font></span><font color="#000000"> = </font><span><font color="#2b91af">Application</font></span><font color="#000000">.DocumentManager. _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; MdiActiveDocument.Editor</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' make a selection</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> prmptSelOpts </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#0000ff">New</font></span><font color="#000000"> </font><span><font color="#2b91af">PromptSelectionOptions</font></span><font color="#000000">()</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> prmptSelRes </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#2b91af">PromptSelectionResult</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; prmptSelRes = ed.GetSelection(prmptSelOpts)</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">If</font></span><font color="#000000"> prmptSelRes.Status &lt;&gt; </font><span><font color="#2b91af">PromptStatus</font></span><font color="#000000">.OK </font></font><span><font style="font-size: 8pt" color="#0000ff">Then</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; rbfResult = </font></font><font style="font-size: 8pt"><span><font color="#0000ff">New</font></span><font color="#000000"> </font><span><font color="#2b91af">ResultBuffer</font></span><font color="#000000">(</font><span><font color="#0000ff">New</font></span><font color="#000000"> </font><span><font color="#2b91af">TypedValue</font></span><font color="#000000">(5019))</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Return</font></span><font color="#000000"> rbfResult</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">If</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' return the selection set</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> selSet </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#2b91af">SelectionSet</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; selSet = prmptSelRes.Value</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; rbfResult = </font></font><font style="font-size: 8pt"><span><font color="#0000ff">New</font></span><font color="#000000"> </font><span><font color="#2b91af">ResultBuffer</font></span><font color="#000000">( _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">New</font></span><font color="#000000"> </font><span><font color="#2b91af">TypedValue</font></span><font color="#000000">(</font><span><font color="#0000ff">CInt</font></span><font color="#000000">(5007), selSet))</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Return</font></span><font color="#000000"> rbfResult</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">End</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">Function</font></span></font></p> </div>  <p>And now the LISP to call those methods, no change here.</p>  <p><span style="line-height: 120%; font-family: &#39;courier new&#39;, courier; font-size: 8pt"><span style="color: #ff0000">(</span><span style="color: #0000ff">defun</span> c:test1 <span style="color: #ff0000">(</span><span style="color: #ff0000">)</span>      <br />&#160;&#160;&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">setq</span> MyList <span style="color: #ff0000">(</span>MyLispFunction1<span style="color: #ff0000">)</span><span style="color: #ff0000">)</span>      <br />&#160; <span style="color: #ff0000">)</span>      <br />&#160; <br /><span style="color: #ff0000">(</span><span style="color: #0000ff">defun</span> c:test2 <span style="color: #ff0000">(</span><span style="color: #ff0000">)</span>      <br />&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">setq</span> MyList <span style="color: #ff0000">(</span>MyLispFunction2<span style="color: #ff0000">)</span><span style="color: #ff0000">)</span>      <br /><span style="color: #ff0000">)</span></span></p>
