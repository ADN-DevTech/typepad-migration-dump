---
layout: "post"
title: "How to extract the ISO Messages from the Piping Model in Plant3d using C#.NET"
date: "2012-04-16 17:09:34"
author: "Fenton Webb"
categories:
  - "Fenton Webb"
original_url: "https://adndevblog.typepad.com/autocad/2012/04/how-to-extract-the-iso-messages-from-the-piping-model-in-plant3d-using-cnet.html "
typepad_basename: "how-to-extract-the-iso-messages-from-the-piping-model-in-plant3d-using-cnet"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/fenton-webb.html" target="_self">Fenton Webb</a></p>
<p>Extracting the ISO Messages from the Plant3d Piping model is fairly straight forward to do. I think probably the best (easiest) way to do it is to use a SS Selection Filter to select only those objects that are DXF Code <span style="color: #a31515;"><span style="color: #000000;"><strong>ACPPDB3DISOSPHERESYMBOL</strong></span> </span><span style="color: #000000;">then extract the ISO Message from the Extension Dictionary entry </span><span style="color: #000000;"><strong>PnP3dMsg.</strong></span></p>
<p><span style="color: #000000;">Hereâ€™s the code</span></p>
<div style="background: white;">
<p style="margin: 0px;"><span><span style="font-family: Consolas;"><span style="color: #008000;">// list Iso Messages in model space, by Fenton Webb, DevTech, Autodesk, 16/4/2012</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>[</span></span><span><span><span style="color: #2b91af;">CommandMethod</span></span><span style="color: #000000;">(</span><span><span style="color: #a31515;">"listIsosMS"</span></span><span style="color: #000000;">, </span><span><span style="color: #2b91af;">CommandFlags</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">NoPaperSpace</span></span><span style="color: #000000;">)]</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;"><span>public</span></span></span><span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">void</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">listIsosMS</span></span><span style="color: #000000;">()</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">{</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp; </span></span><span><span style="color: #008000;">// get the AutoCAD Editor object </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp; </span></span><span><span><span style="color: #2b91af;">Editor</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">ed</span></span><span style="color: #000000;"> = </span><span><span style="color: #2b91af;">AcadApp</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">DocumentManager</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">MdiActiveDocument</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Editor</span></span><span style="color: #000000;">;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&nbsp;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp; </span></span><span><span style="color: #008000;">// create a ss get filter</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp; </span></span><span><span><span style="color: #2b91af;">TypedValue</span></span><span style="color: #000000;">[] </span><span><span style="color: #010001;">filter</span></span><span style="color: #000000;"> = </span><span><span style="color: #0000ff;">new</span></span><span style="color: #000000;"> </span><span><span style="color: #2b91af;">TypedValue</span></span><span style="color: #000000;">[] { </span><span><span style="color: #0000ff;">new</span></span><span style="color: #000000;"> </span><span><span style="color: #2b91af;">TypedValue</span></span><span style="color: #000000;">((</span><span><span style="color: #0000ff;">int</span></span><span style="color: #000000;">)</span><span><span style="color: #2b91af;">DxfCode</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Start</span></span><span style="color: #000000;">, </span><span><span style="color: #a31515;">"ACPPDB3DISOSPHERESYMBOL"</span></span><span style="color: #000000;">) };</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp; </span></span><span><span style="color: #008000;">// now select them from model space</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp; </span></span><span><span><span style="color: #2b91af;">SelectionFilter</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">sf</span></span><span style="color: #000000;"> = </span><span><span style="color: #0000ff;">new</span></span><span style="color: #000000;"> </span><span><span style="color: #2b91af;">SelectionFilter</span></span><span style="color: #000000;">(</span><span><span style="color: #010001;">filter</span></span><span style="color: #000000;">);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp; </span></span><span><span><span style="color: #2b91af;">PromptSelectionResult</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">psr</span></span><span style="color: #000000;"> = </span><span><span style="color: #010001;">ed</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">SelectAll</span></span><span style="color: #000000;">(</span><span><span style="color: #010001;">sf</span></span><span style="color: #000000;">);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp; </span></span><span><span style="color: #008000;">// if success</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp; </span></span><span><span><span style="color: #0000ff;">if</span></span><span style="color: #000000;"> (</span><span><span style="color: #010001;">psr</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Status</span></span><span style="color: #000000;"> == </span><span><span style="color: #2b91af;">PromptStatus</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">OK</span></span><span style="color: #000000;">)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&nbsp; {</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp; </span></span><span><span><span style="color: #010001;">ed</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">WriteMessage</span></span><span style="color: #000000;">(</span><span><span style="color: #a31515;">"\nFound {0} Iso Message entit{1}."</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">psr</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Value</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Count</span></span><span style="color: #000000;">, (</span><span><span style="color: #010001;">psr</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Value</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Count</span></span><span style="color: #000000;"> == 1 ? </span><span><span style="color: #a31515;">"y"</span></span><span style="color: #000000;"> : </span><span><span style="color: #a31515;">"ies"</span></span><span style="color: #000000;">));</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp; </span></span><span><span><span style="color: #0000ff;">foreach</span></span><span style="color: #000000;"> (</span><span><span style="color: #2b91af;">ObjectId</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">id</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">in</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">psr</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Value</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">GetObjectIds</span></span><span style="color: #000000;">())</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&nbsp;&nbsp;&nbsp; {</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span><span style="color: #008000;">// open the entity for read</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span><span><span style="color: #0000ff;">using</span></span><span style="color: #000000;"> (</span><span><span style="color: #2b91af;">Entity</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">ent</span></span><span style="color: #000000;"> = </span><span><span style="color: #010001;">id</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Open</span></span><span style="color: #000000;">(</span><span><span style="color: #2b91af;">OpenMode</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">ForRead</span></span><span style="color: #000000;">) </span><span><span style="color: #0000ff;">as</span></span><span style="color: #000000;"> </span><span><span style="color: #2b91af;">Entity</span></span><span style="color: #000000;">)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span><span style="color: #008000;">// see if the extensiuon dictionary is valid</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span><span><span style="color: #0000ff;">if</span></span><span style="color: #000000;"> (</span><span><span style="color: #010001;">ent</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">ExtensionDictionary</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">IsValid</span></span><span style="color: #000000;"> == </span><span><span style="color: #0000ff;">true</span></span><span style="color: #000000;">)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span><span style="color: #008000;">// open the extension dict</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span><span><span style="color: #0000ff;">using</span></span><span style="color: #000000;"> (</span><span><span style="color: #2b91af;">DBDictionary</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">extDict</span></span><span style="color: #000000;"> = </span><span><span style="color: #010001;">ent</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">ExtensionDictionary</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Open</span></span><span style="color: #000000;">(</span><span><span style="color: #2b91af;">OpenMode</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">ForRead</span></span><span style="color: #000000;">) </span><span><span style="color: #0000ff;">as</span></span><span style="color: #000000;"> </span><span><span style="color: #2b91af;">DBDictionary</span></span><span style="color: #000000;">)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span><span style="color: #008000;">// see if the PnP3dMsg is there</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span><span><span style="color: #0000ff;">if</span></span><span style="color: #000000;"> (</span><span><span style="color: #010001;">extDict</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Contains</span></span><span style="color: #000000;">(</span><span><span style="color: #a31515;">"PnP3dMsg"</span></span><span style="color: #000000;">) == </span><span><span style="color: #0000ff;">true</span></span><span style="color: #000000;">)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span><span style="color: #008000;">// get at the PnP3dMsg entry</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span><span><span style="color: #0000ff;">using</span></span><span style="color: #000000;"> (</span><span><span style="color: #2b91af;">Xrecord</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">xrec</span></span><span style="color: #000000;"> = </span><span><span style="color: #010001;">extDict</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">GetAt</span></span><span style="color: #000000;">(</span><span><span style="color: #a31515;">"PnP3dMsg"</span></span><span style="color: #000000;">).</span><span><span style="color: #010001;">Open</span></span><span style="color: #000000;">(</span><span><span style="color: #2b91af;">OpenMode</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">ForRead</span></span><span style="color: #000000;">) </span><span><span style="color: #0000ff;">as</span></span><span style="color: #000000;"> </span><span><span style="color: #2b91af;">Xrecord</span></span><span style="color: #000000;">)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span><span style="color: #008000;">// now find the text</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span><span><span style="color: #0000ff;">foreach</span></span><span style="color: #000000;"> (</span><span><span style="color: #2b91af;">TypedValue</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">val</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">in</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">xrec</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Data</span></span><span style="color: #000000;">)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span><span><span style="color: #0000ff;">if</span></span><span style="color: #000000;"> (</span><span><span style="color: #010001;">val</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">TypeCode</span></span><span style="color: #000000;"> == 1)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span><span><span style="color: #010001;">ed</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">WriteMessage</span></span><span style="color: #000000;">(</span><span><span style="color: #a31515;">"\nISO Message Text="</span></span><span style="color: #000000;"> + </span><span><span style="color: #010001;">val</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Value</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">ToString</span></span><span style="color: #000000;">());</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span><span><span style="color: #0000ff;">break</span></span><span style="color: #000000;">;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&nbsp;&nbsp;&nbsp; }</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&nbsp; }</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">}</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&nbsp;</span></span></p>
</div>
<p>However, in the ISOMetric drawings, those ISO messages are just raw AutoCAD Blocks. Therefore, you will need to search all BlockReferences for an Attribute name of 'XX', from the 'XX' attribute property you can extract the ISO message text.</p>
