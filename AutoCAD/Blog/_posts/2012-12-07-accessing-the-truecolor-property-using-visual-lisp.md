---
layout: "post"
title: "Accessing the TrueColor property using Visual LISP"
date: "2012-12-07 06:45:20"
author: "Philippe Leefsma"
categories:
  - "AutoCAD"
  - "LISP"
  - "Philippe Leefsma"
original_url: "https://adndevblog.typepad.com/autocad/2012/12/accessing-the-truecolor-property-using-visual-lisp.html "
typepad_basename: "accessing-the-truecolor-property-using-visual-lisp"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/philippe-leefsma.html" target="_self">Philippe Leefsma</a></p>  <p><b>Q:</b></p>  <p>How to access the TrueColor property of an entity in AutoCAD? Also, is there a way to set an object's color back to &quot;ByLayer&quot;?</p>  <p><a name="section2"></a></p>  <p><b>A:</b></p>  <p>First, it is necessary to access the object's TrueColor property, using vlax-get-property.&#160; The RGB (Red, Green and Blue) values of TrueColor are read-only, so you can not individually modify them.&#160; You must invoke the SetRGB method and set all three values at once.&#160; Then, using vlax-put-property, you can set the object's TrueColor property to reflect the new RGB values.&#160; You will notice that an object whose color is &quot;ByLayer&quot; returns RGB values of R=0, G=0, B=0.&#160; However, setting these values explicitly, with SetRGB, will not restore the color to &quot;ByLayer&quot;.&#160; To reset the color to &quot;ByLayer&quot;, it is necessary to set TrueColor's ColorIndex property to acBylayer.&#160; The example below creates a line, whose color is initially &quot;ByLayer&quot;.&#160; We then change it to blue, and finally back to ByLayer:</p>  <p><span style="line-height: 120%; font-family: &#39;courier new&#39;, courier; font-size: 8pt"><span style="color: #ff0000">(</span><span style="color: #0000ff">defun</span> c:TestTrueClr<span style="color: #ff0000">(</span><span style="color: #ff0000">)</span>      <br />&#160;&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">vl-load-com</span><span style="color: #ff0000">)</span>      <br />&#160;&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">setq</span> oApp <span style="color: #ff0000">(</span><span style="color: #0000ff">vlax-get-Acad-Object</span><span style="color: #ff0000">)</span>      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oDoc <span style="color: #ff0000">(</span><span style="color: #0000ff">vla-get-ActiveDocument</span> oApp<span style="color: #ff0000">)</span>      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oMSp <span style="color: #ff0000">(</span><span style="color: #0000ff">vla-get-ModelSpace</span> oDoc<span style="color: #ff0000">)</span>      <br />&#160;&#160; <span style="color: #ff0000">)</span>      <br />&#160;&#160; <span style="background-color: #e6e6e6; color: #800080">;; Add a Line       <br /></span>&#160;&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">setq</span> oLine <span style="color: #ff0000">(</span><span style="color: #0000ff">vla-AddLine</span> oMSp&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">vlax-</span>3d-point '<span style="color: #ff0000">(</span>1.0 1.0 0.0<span style="color: #ff0000">)</span><span style="color: #ff0000">)</span><span style="color: #ff0000">&#160; (</span><span style="color: #0000ff">vlax-</span>3d-point '<span style="color: #ff0000">(</span>10.0 10.0 0.0<span style="color: #ff0000">)</span><span style="color: #ff0000">)</span><span style="color: #ff0000">)</span><span style="color: #ff0000">)</span>      <br />&#160;&#160;&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">vla-update</span> oLine<span style="color: #ff0000">)</span>      <br />      <br />&#160;&#160; <span style="background-color: #e6e6e6; color: #800080">;; Get the current color values       <br /></span>&#160;&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">setq</span> oColor <span style="color: #ff0000">(</span><span style="color: #0000ff">vlax-get-property</span> oLine 'TrueColor<span style="color: #ff0000">)</span>      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; clrR <span style="color: #ff0000">(</span><span style="color: #0000ff">vlax-get-property</span> oColor 'Red<span style="color: #ff0000">)</span>      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; clrG <span style="color: #ff0000">(</span><span style="color: #0000ff">vlax-get-property</span> oColor 'Green<span style="color: #ff0000">)</span>      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; clrB <span style="color: #ff0000">(</span><span style="color: #0000ff">vlax-get-property</span> oColor 'Blue<span style="color: #ff0000">)</span>      <br />&#160;&#160; <span style="color: #ff0000">)</span>      <br />&#160;&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">alert</span>&#160;<span style="color: #ff0000">(</span><span style="color: #0000ff">strcat</span>&#160;<span style="color: #ff00ff">&quot;Old Color - Red: &quot;</span>&#160;<span style="color: #ff0000">(</span><span style="color: #0000ff">itoa</span> clrR<span style="color: #ff0000">)</span>&#160;<span style="color: #ff00ff">&quot; Green: &quot;</span>&#160;<span style="color: #ff0000">(</span><span style="color: #0000ff">itoa</span> clrG<span style="color: #ff0000">)</span>&#160;<span style="color: #ff00ff">&quot; Blue: &quot;</span>&#160;<span style="color: #ff0000">(</span><span style="color: #0000ff">itoa</span> clrB<span style="color: #ff0000">)</span><span style="color: #ff0000">)</span><span style="color: #ff0000">)</span>      <br />      <br />&#160;&#160; <span style="background-color: #e6e6e6; color: #800080">;; Set TrueColor to blue <span style="color: #ff0000">(</span>R=0, G=101, B=204<span style="color: #ff0000">)</span>        <br /></span>&#160;&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">vlax-invoke-method</span> oColor 'SetRGB <span style="color: #008000">0</span>&#160;<span style="color: #008000">101</span>&#160;<span style="color: #008000">204</span><span style="color: #ff0000">)</span>      <br />&#160;&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">vlax-put-property</span> oLine 'TrueColor oColor<span style="color: #ff0000">)</span>      <br />&#160;&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">vla-update</span> oLine<span style="color: #ff0000">)</span>      <br />      <br />&#160;&#160; <span style="background-color: #e6e6e6; color: #800080">;; Inspect the new color values       <br /></span>&#160;&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">setq</span> oColor <span style="color: #ff0000">(</span><span style="color: #0000ff">vlax-get-property</span> oLine 'TrueColor<span style="color: #ff0000">)</span>      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; clrR <span style="color: #ff0000">(</span><span style="color: #0000ff">vlax-get-property</span> oColor 'Red<span style="color: #ff0000">)</span>      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; clrG <span style="color: #ff0000">(</span><span style="color: #0000ff">vlax-get-property</span> oColor 'Green<span style="color: #ff0000">)</span>      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; clrB <span style="color: #ff0000">(</span><span style="color: #0000ff">vlax-get-property</span> oColor 'Blue<span style="color: #ff0000">)</span>      <br />&#160;&#160; <span style="color: #ff0000">)</span>      <br />&#160;&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">alert</span>&#160;<span style="color: #ff0000">(</span><span style="color: #0000ff">strcat</span>&#160;<span style="color: #ff00ff">&quot;New Color - Red: &quot;</span>&#160;<span style="color: #ff0000">(</span><span style="color: #0000ff">itoa</span> clrR<span style="color: #ff0000">)</span>&#160;<span style="color: #ff00ff">&quot; Green: &quot;</span>&#160;<span style="color: #ff0000">(</span><span style="color: #0000ff">itoa</span> clrG<span style="color: #ff0000">)</span>&#160;<span style="color: #ff00ff">&quot; Blue: &quot;</span>&#160;<span style="color: #ff0000">(</span><span style="color: #0000ff">itoa</span> clrB<span style="color: #ff0000">)</span><span style="color: #ff0000">)</span><span style="color: #ff0000">)</span>      <br />&#160;&#160; <br />&#160;&#160; <span style="background-color: #e6e6e6; color: #800080">;; Reset color to acBylayer       <br /></span>&#160;&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">vlax-put-property</span> oColor 'ColorIndex acByLayer<span style="color: #ff0000">)</span>      <br />&#160;&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">vlax-put-property</span> oLine 'TrueColor oColor<span style="color: #ff0000">)</span>      <br />&#160;&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">vla-update</span> oLine<span style="color: #ff0000">)</span>      <br />      <br />&#160;&#160; <span style="background-color: #e6e6e6; color: #800080">;; Inspect the color values       <br /></span>&#160;&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">setq</span> oColor <span style="color: #ff0000">(</span><span style="color: #0000ff">vlax-get-property</span> oLine 'TrueColor<span style="color: #ff0000">)</span>      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; clrR <span style="color: #ff0000">(</span><span style="color: #0000ff">vlax-get-property</span> oColor 'Red<span style="color: #ff0000">)</span>      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; clrG <span style="color: #ff0000">(</span><span style="color: #0000ff">vlax-get-property</span> oColor 'Green<span style="color: #ff0000">)</span>      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; clrB <span style="color: #ff0000">(</span><span style="color: #0000ff">vlax-get-property</span> oColor 'Blue<span style="color: #ff0000">)</span>      <br />&#160;&#160; <span style="color: #ff0000">)</span>      <br />&#160;&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">alert</span>&#160;<span style="color: #ff0000">(</span><span style="color: #0000ff">strcat</span>&#160;<span style="color: #ff00ff">&quot;New Color - Red: &quot;</span>&#160;<span style="color: #ff0000">(</span><span style="color: #0000ff">itoa</span> clrR<span style="color: #ff0000">)</span>&#160;<span style="color: #ff00ff">&quot; Green: &quot;</span>&#160;<span style="color: #ff0000">(</span><span style="color: #0000ff">itoa</span> clrG<span style="color: #ff0000">)</span>&#160;<span style="color: #ff00ff">&quot; Blue: &quot;</span>&#160;<span style="color: #ff0000">(</span><span style="color: #0000ff">itoa</span> clrB<span style="color: #ff0000">)</span><span style="color: #ff0000">)</span><span style="color: #ff0000">)</span>      <br /><span style="color: #ff0000">)</span>      <br />      <br /></span></p>
