---
layout: "post"
title: "Using AutoCAD WPF Data binding collection properties to export to Excel in VB.NET"
date: "2012-03-28 11:52:34"
author: "Fenton Webb"
categories:
  - ".NET"
  - "AutoCAD"
  - "Fenton Webb"
original_url: "https://adndevblog.typepad.com/autocad/2012/03/using-autocad-wpf-data-binding-collection-properties-to-export-to-excel-in-vbnet.html "
typepad_basename: "using-autocad-wpf-data-binding-collection-properties-to-export-to-excel-in-vbnet"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/fenton-webb.html" target="_self">Fenton Webb</a></p>
<p>I recently saw Kean’s blog posting on <a href="http://through-the-interface.typepad.com/through_the_interface/2012/03/getting-the-list-of-hatch-patterns-available-in-the-current-autocad-drawing-using-net.html"><strong>Getting the list of hatch patterns available in the current AutoCAD drawing using .NET</strong></a><strong>&#0160;</strong>and wondered if I should try to use the AutoCAD WPF data binding <span style="font-family: Consolas;">UIBindings.Collections</span> class to do something similar.</p>
<p>You may have already started using WPF inside of AutoCAD and in your travels hooked your WPF UI data binding into the <span style="font-family: Consolas;">Autodesk.AutoCAD.ApplicationServices.Application.UIBindings.Collections</span> namespace. If you haven’t, it’s definitely time to check it out. What it provides is a list of commonly used AutoCAD data type collections, primarily used by the AutoCAD Ribbon. These collections can be very easily bound to your own UI using WPF data binding making UI programming amazingly beautiful to create and work with, and super easy (once you have climbed over the fairly large learning curve <img alt="Smile" class="wlEmoticon wlEmoticon-smile" src="/assets/image_459289.jpg" style="border-style: none;" />)</p>
<p>&#0160;</p>
<p>Just as a WPF background task for you, here are my <a href="http://au.autodesk.com/?nd=material&amp;session_material_id=5571">Using Windows Presentation Foundation in AutoCAD</a> and the <a href="http://www.google.com/url?sa=t&amp;rct=j&amp;q=fenton%20webb%20using%20windows%20presentation%20foundation%20in%20autocad&amp;source=web&amp;cd=4&amp;ved=0CDUQFjAD&amp;url=http%3A%2F%2Fau.autodesk.com%2F%3Fnd%3Dmaterial%26session_material_id%3D5576&amp;ei=5kxzT4KKKI2tiQfItZzkDw&amp;usg=AFQjCNElXADeNajcN7dKjh2dcgeu9M4OEA">Part 2</a> from Autodesk University which talk about&#0160; WPF inside of AutoCAD and also binding your own UI to <span style="font-family: Consolas;">UIBindings.Collections</span>.</p>
<p>&#0160;</p>
<p>Anyway, I figured this <span style="font-family: Consolas;">UIBindings.Collections</span> layer could be utilized in the same way that Kean did for his Hatch patterns listing, but this time, for a little utility which exports to Microsoft Excel. I got the idea from a recent case submitted to our ADN DevHelp online system, in VB.NET though so as I’m a C kind of guy please excuse any VB.NET inefficiencies <img alt="Smile" class="wlEmoticon wlEmoticon-smile" src="/assets/image_459289.jpg" style="border-style: none;" /></p>
<p>Now I think you may find that it’s not quite as easy as you’d think to explore these name spaces by hand, a fairly deep understanding of the underlying interfaces is needed, so let me try and explain by looking at <span style="font-family: Consolas; color: #010001; font-size: x-small;"><span style="font-family: Consolas; color: #010001; font-size: x-small;"><span style="font-family: Consolas; color: #010001; font-size: x-small;">UIBindings</span></span></span><span style="font-family: Consolas; font-size: x-small;"><span style="font-family: Consolas; color: #000000; font-size: x-small;">.</span></span><span style="font-family: Consolas; color: #010001; font-size: x-small;"><span style="font-family: Consolas; color: #010001; font-size: x-small;"><span style="font-family: Consolas; color: #010001; font-size: x-small;">Collections</span></span></span><span style="font-family: Consolas; font-size: x-small;"><span style="font-family: Consolas; color: #000000; font-size: x-small;">.</span></span><span style="font-family: Consolas; color: #010001; font-size: x-small;"><span style="font-family: Consolas; color: #010001; font-size: x-small;"><span style="font-family: Consolas; color: #010001; font-size: x-small;">Layers</span></span></span>.</p>
<p>We’re going to try and loop all of the Layers in the current drawing in order to extract the Layer Name property from them, how can we do this. So, the <span style="font-family: Consolas; color: #010001; font-size: x-small;"><span style="font-family: Consolas; color: #010001; font-size: x-small;"><span style="font-family: Consolas; color: #010001; font-size: x-small;">Layers </span></span></span>property is of type <span style="font-family: Consolas;">Autodesk.AutoCAD.Windows.Data.DataItemCollection</span>. This contains an array of <span style="font-family: Consolas; color: #010001; font-size: x-small;"><span style="font-family: Consolas; color: #010001; font-size: x-small;"><span style="font-family: Consolas; color: #010001; font-size: x-small;">System</span></span></span><span style="font-family: Consolas; font-size: x-small;"><span style="font-family: Consolas; color: #000000; font-size: x-small;">.</span></span><span style="font-family: Consolas; color: #010001; font-size: x-small;"><span style="font-family: Consolas; color: #010001; font-size: x-small;"><span style="font-family: Consolas; color: #010001; font-size: x-small;">ComponentModel</span></span></span><span style="font-family: Consolas; font-size: x-small;"><span style="font-family: Consolas; color: #000000; font-size: x-small;">.</span></span><span style="font-family: Consolas; color: #2b91af; font-size: x-small;"><span style="font-family: Consolas; color: #2b91af; font-size: x-small;"><span style="font-family: Consolas; color: #2b91af; font-size: x-small;">ICustomTypeDescriptor. <span style="font-family: Arial; color: #232323;">Next is where exploring with IntelliSense may become a little tricky, what you need to do is from your <span style="font-family: Consolas; color: #2b91af;">ICustomTypeDescriptor <span style="font-family: Arial; color: #232323;">is, you need to get all the properties from it, find the property name that you want the value of, and then extract the value… </span></span></span></span></span></span></p>
<p><span style="font-family: Consolas; color: #2b91af; font-size: x-small;"><span style="font-family: Consolas; color: #2b91af; font-size: x-small;"><span style="font-family: Consolas; color: #2b91af; font-size: x-small;"><span style="font-family: Arial; color: #232323;"><span style="font-family: Consolas; color: #2b91af;"><span style="font-family: Arial; color: #232323;">Here’s how it’s done with code:</span></span></span></span></span></span></p>
<div style="background: white;">
<p style="margin: 0px;"><span style="font-family: Consolas;"><span><span style="color: #008000;">&#39; get all of the Layer Names in the current DWG</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;">For</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Each</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">desc</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">System</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">ComponentModel</span></span><span style="color: #000000;">.</span><span><span style="color: #2b91af;">ICustomTypeDescriptor</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">In</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">dataItemCollection</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span><span style="color: #008000;">&#0160; &#39; extract the layer table record property we want</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;">&#0160; Dim</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">propertyValue</span></span><span style="color: #000000;"> = </span><span><span style="color: #2b91af;">desc</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">GetProperties</span></span><span style="color: #000000;">()(</span><span><span style="color: #a31515;">&quot;Name&quot;</span></span><span style="color: #000000;">).</span><span><span style="color: #010001;">GetValue</span></span><span style="color: #000000;">(</span><span><span style="color: #010001;">desc</span></span><span style="color: #000000;">)</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas; color: #000000;">&#0160;</span></p>
</div>
<div style="background: white;">
<p><span style="font-family: Consolas; color: #2b91af; font-size: x-small;"><span style="font-family: Consolas; color: #2b91af; font-size: x-small;"><span style="font-family: Consolas; color: #2b91af; font-size: x-small;"><span style="font-family: Arial; color: #232323;"><span style="font-family: Consolas; color: #2b91af;"><span style="font-family: Arial; color: #232323;">As you can see, it’s super simple when you know how, and with just two lines of code – very cool! </span></span></span></span></span></span></p>
<p><span style="font-family: Consolas; color: #2b91af; font-size: x-small;"><span style="font-family: Consolas; color: #2b91af; font-size: x-small;"><span style="font-family: Consolas; color: #2b91af; font-size: x-small;"><span style="font-family: Arial; color: #232323;"><span style="font-family: Consolas; color: #2b91af;"><span style="font-family: Arial; color: #232323;">So onto the exporting of the data held in the UIBindings.Collections namespace to Excel. To connect my little AutoCAD VB.NET application to a currently running Excel application, or if one does not exist, to then start one up I use this code:</span></span></span></span></span></span></p>
<div style="background: white;">
<p style="margin: 0px;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;">Try</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;">&#0160; If</span></span><span style="color: #000000;"> </span><span><span style="color: #2b91af;">Process</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">GetProcessesByName</span></span><span style="color: #000000;">(</span><span><span style="color: #a31515;">&quot;Excel&quot;</span></span><span style="color: #000000;">).</span><span><span style="color: #010001;">Length</span></span><span style="color: #000000;"> &gt; 0 </span><span><span style="color: #0000ff;">Then</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span><span style="color: #010001;">&#0160;&#0160;&#0160; app</span></span><span style="color: #000000;"> = </span><span><span style="color: #0000ff;">CType</span></span><span style="color: #000000;">(</span><span><span style="color: #010001;">GetObject</span></span><span style="color: #000000;">(, </span><span><span style="color: #a31515;">&quot;Excel.Application&quot;</span></span><span style="color: #000000;">), </span><span><span style="color: #010001;">Excel</span></span><span style="color: #000000;">.</span><span><span style="color: #2b91af;">Application</span></span><span style="color: #000000;">)</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span><span style="color: #008000;">&#0160;&#0160;&#0160; &#39; Else createObject</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;">&#0160; Else</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span><span style="color: #010001;">&#0160;&#0160;&#0160; app</span></span><span style="color: #000000;"> = </span><span><span style="color: #0000ff;">New</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">Excel</span></span><span style="color: #000000;">.</span><span><span style="color: #2b91af;">Application</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;">&#0160; End</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">If</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span><span style="color: #2b91af;">&#0160; app</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Visible</span></span><span style="color: #000000;"> = </span><span><span style="color: #0000ff;">True</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span><span style="color: #010001;">&#0160; workbook</span></span><span style="color: #000000;"> = </span><span><span style="color: #010001;">app</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Workbooks</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Add</span></span><span style="color: #000000;">(1)</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span><span style="color: #010001;">&#0160; worksheet</span></span><span style="color: #000000;"> = </span><span><span style="color: #0000ff;">DirectCast</span></span><span style="color: #000000;">(</span><span><span style="color: #2b91af;">workbook</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Sheets</span></span><span style="color: #000000;">(1), </span><span><span style="color: #010001;">Excel</span></span><span style="color: #000000;">.</span><span><span style="color: #2b91af;">Worksheet</span></span><span style="color: #000000;">)</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;">&#0160; Catch</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">e</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #2b91af;">Exception</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span><span style="color: #2b91af;">&#0160;&#0160;&#0160; Console</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Write</span></span><span style="color: #000000;">(</span><span><span style="color: #a31515;">&quot;Error&quot;</span></span><span style="color: #000000;">)</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;">&#0160; Finally</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;">End</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Try</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas; color: #000000;">&#0160;</span></p>
</div>
</div>
<p>Actually, I have to confess, as always I managed to find some sample code online which really helped developing this App. I’ve used it in my project as an Excel Helper class, modifying it to suit my needs. As usual CodeProject and this <a href="http://www.codeproject.com/Articles/20228/Using-C-to-Create-an-Excel-Document">link on CodeProject.com</a> was a perfect template even though it was in C# (I simply converted it to VB.NET using this <a href="http://www.google.com/url?sa=t&amp;rct=j&amp;q=convert%20c%23%20to%20vb.net&amp;source=web&amp;cd=1&amp;ved=0CCEQFjAA&amp;url=http%3A%2F%2Fwww.developerfusion.com%2Ftools%2Fconvert%2Fcsharp-to-vb%2F&amp;ei=alZzT9zyJsiTiAfSvvXjDw&amp;usg=AFQjCNFM321pCrxs_o-P69sgwPbmfGp0Rw">tool</a>)</p>
<p>So now finally, to the completed project source code… First of all, here’s my ExcelHelper.vb source file which provides the Excel functionality</p>
<div style="background: white;">
<p style="margin: 0px;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;">Imports</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">Excel</span></span><span style="color: #000000;"> = </span><span><span style="color: #010001;">Microsoft</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Office</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Interop</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Excel</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;">Imports</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">Microsoft</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Office</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Interop</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas; color: #000000;">&#0160;</span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;">Public</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Class</span></span><span style="color: #000000;"> </span><span><span style="color: #2b91af;">ExcelHelper</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas; color: #000000;">&#0160;</span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160; </span><span><span style="color: #0000ff;">Class</span></span><span style="color: #000000;"> </span><span><span style="color: #2b91af;">CreateExcelDoc</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span><span><span style="color: #0000ff;">Private</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">app</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">Excel</span></span><span style="color: #000000;">.</span><span><span style="color: #2b91af;">Application</span></span><span style="color: #000000;"> = </span><span><span style="color: #0000ff;">Nothing</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span><span><span style="color: #0000ff;">Private</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">workbook</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">Excel</span></span><span style="color: #000000;">.</span><span><span style="color: #2b91af;">Workbook</span></span><span style="color: #000000;"> = </span><span><span style="color: #0000ff;">Nothing</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span><span><span style="color: #0000ff;">Private</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">worksheet</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">Excel</span></span><span style="color: #000000;">.</span><span><span style="color: #2b91af;">Worksheet</span></span><span style="color: #000000;"> = </span><span><span style="color: #0000ff;">Nothing</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span><span><span style="color: #0000ff;">Private</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">workSheet_range</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">Excel</span></span><span style="color: #000000;">.</span><span><span style="color: #2b91af;">Range</span></span><span style="color: #000000;"> = </span><span><span style="color: #0000ff;">Nothing</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span><span><span style="color: #0000ff;">Public</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Sub</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">New</span></span><span style="color: #000000;">()</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #010001;">createDoc</span></span><span style="color: #000000;">()</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span><span><span style="color: #0000ff;">End</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Sub</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span><span><span style="color: #0000ff;">Public</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Sub</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">createDoc</span></span><span style="color: #000000;">()</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #0000ff;">Try</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #0000ff;">If</span></span><span style="color: #000000;"> </span><span><span style="color: #2b91af;">Process</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">GetProcessesByName</span></span><span style="color: #000000;">(</span><span><span style="color: #a31515;">&quot;Excel&quot;</span></span><span style="color: #000000;">).</span><span><span style="color: #010001;">Length</span></span><span style="color: #000000;"> &gt; 0 </span><span><span style="color: #0000ff;">Then</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #010001;">app</span></span><span style="color: #000000;"> = </span><span><span style="color: #0000ff;">CType</span></span><span style="color: #000000;">(</span><span><span style="color: #010001;">GetObject</span></span><span style="color: #000000;">(, </span><span><span style="color: #a31515;">&quot;Excel.Application&quot;</span></span><span style="color: #000000;">), </span><span><span style="color: #010001;">Excel</span></span><span style="color: #000000;">.</span><span><span style="color: #2b91af;">Application</span></span><span style="color: #000000;">)</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #008000;">&#39; Else createObject</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #0000ff;">Else</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #010001;">app</span></span><span style="color: #000000;"> = </span><span><span style="color: #0000ff;">New</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">Excel</span></span><span style="color: #000000;">.</span><span><span style="color: #2b91af;">Application</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #0000ff;">End</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">If</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #2b91af;">app</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Visible</span></span><span style="color: #000000;"> = </span><span><span style="color: #0000ff;">True</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #010001;">workbook</span></span><span style="color: #000000;"> = </span><span><span style="color: #010001;">app</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Workbooks</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Add</span></span><span style="color: #000000;">(1)</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #010001;">worksheet</span></span><span style="color: #000000;"> = </span><span><span style="color: #0000ff;">DirectCast</span></span><span style="color: #000000;">(</span><span><span style="color: #2b91af;">workbook</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Sheets</span></span><span style="color: #000000;">(1), </span><span><span style="color: #010001;">Excel</span></span><span style="color: #000000;">.</span><span><span style="color: #2b91af;">Worksheet</span></span><span style="color: #000000;">)</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #0000ff;">Catch</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">e</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #2b91af;">Exception</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #2b91af;">Console</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Write</span></span><span style="color: #000000;">(</span><span><span style="color: #a31515;">&quot;Error&quot;</span></span><span style="color: #000000;">)</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #0000ff;">Finally</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #0000ff;">End</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Try</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span><span><span style="color: #0000ff;">End</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Sub</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas; color: #000000;">&#0160;</span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span><span><span style="color: #0000ff;">Public</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Sub</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">createHeaders</span></span><span style="color: #000000;">(</span><span><span style="color: #010001;">row</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Integer</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">col</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Integer</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">htext</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">String</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">cell1</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">String</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">cell2</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">String</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">mergeColumns</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Integer</span></span><span style="color: #000000;">, _</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #010001;">cellColor</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">System</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Drawing</span></span><span style="color: #000000;">.</span><span><span style="color: #2b91af;">Color</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">isBold</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Boolean</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">columnWidth</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Integer</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">fontSize</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Integer</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">fontColor</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">System</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Drawing</span></span><span style="color: #000000;">.</span><span><span style="color: #2b91af;">Color</span></span><span style="color: #000000;">)</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #2b91af;">worksheet</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Cells</span></span><span style="color: #000000;">(</span><span><span style="color: #010001;">row</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">col</span></span><span style="color: #000000;">) = </span><span><span style="color: #010001;">htext</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #010001;">workSheet_range</span></span><span style="color: #000000;"> = </span><span><span style="color: #2b91af;">worksheet</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Range</span></span><span style="color: #000000;">(</span><span><span style="color: #010001;">cell1</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">cell2</span></span><span style="color: #000000;">)</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #2b91af;">workSheet_range</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Merge</span></span><span style="color: #000000;">(</span><span><span style="color: #010001;">mergeColumns</span></span><span style="color: #000000;">)</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #010001;">workSheet_range</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Interior</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Color</span></span><span style="color: #000000;"> = </span><span><span style="color: #010001;">cellColor</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #010001;">workSheet_range</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Font</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Bold</span></span><span style="color: #000000;"> = </span><span><span style="color: #010001;">isBold</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #010001;">workSheet_range</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Font</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Size</span></span><span style="color: #000000;"> = </span><span><span style="color: #010001;">fontSize</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #2b91af;">workSheet_range</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">ColumnWidth</span></span><span style="color: #000000;"> = </span><span><span style="color: #010001;">columnWidth</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #010001;">workSheet_range</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Font</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Color</span></span><span style="color: #000000;"> = </span><span><span style="color: #010001;">fontColor</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span><span><span style="color: #0000ff;">End</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Sub</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas; color: #000000;">&#0160;</span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span><span><span style="color: #0000ff;">Public</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Sub</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">addData</span></span><span style="color: #000000;">(</span><span><span style="color: #010001;">row</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Integer</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">col</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Integer</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">data</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">String</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">cell1</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">String</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">cell2</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">String</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">format</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">String</span></span><span style="color: #000000;">)</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #2b91af;">worksheet</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Cells</span></span><span style="color: #000000;">(</span><span><span style="color: #010001;">row</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">col</span></span><span style="color: #000000;">) = </span><span><span style="color: #010001;">data</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #010001;">workSheet_range</span></span><span style="color: #000000;"> = </span><span><span style="color: #2b91af;">worksheet</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Range</span></span><span style="color: #000000;">(</span><span><span style="color: #010001;">cell1</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">cell2</span></span><span style="color: #000000;">)</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #010001;">workSheet_range</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Borders</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Color</span></span><span style="color: #000000;"> = </span><span><span style="color: #010001;">System</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Drawing</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Color</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Black</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">ToArgb</span></span><span style="color: #000000;">()</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #2b91af;">workSheet_range</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">NumberFormat</span></span><span style="color: #000000;"> = </span><span><span style="color: #010001;">format</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span><span><span style="color: #0000ff;">End</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Sub</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160; </span><span><span style="color: #0000ff;">End</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Class</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas; color: #000000;">&#0160;</span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;">End</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Class</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas; color: #000000;">&#0160;</span></p>
</div>
<p>and then, the AutoCAD code, which contains the command “ExcelExample”, that actually extracts the data from the UIBindings</p>
<div style="background: white;">
<p style="margin: 0px;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;">Imports</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">System</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;">Imports</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">Autodesk</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">AutoCAD</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Runtime</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;">Imports</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">Autodesk</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">AutoCAD</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">ApplicationServices</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;">Imports</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">Autodesk</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">AutoCAD</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">DatabaseServices</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;">Imports</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">Autodesk</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">AutoCAD</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Geometry</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;">Imports</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">Autodesk</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">AutoCAD</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">EditorInput</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas; color: #000000;">&#0160;</span></p>
<p style="margin: 0px;"><span><span style="font-family: Consolas; color: #008000;">&#39; This line is not mandatory, but improves loading performances</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&lt;</span><span><span style="color: #0000ff;">Assembly</span></span><span style="color: #000000;">: </span><span><span style="color: #2b91af;">CommandClass</span></span><span style="color: #000000;">(</span><span><span style="color: #0000ff;">GetType</span></span><span style="color: #000000;">(</span><span><span style="color: #010001;">ExcelSample</span></span><span style="color: #000000;">.</span><span><span style="color: #2b91af;">MyCommands</span></span><span style="color: #000000;">))&gt; </span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas; color: #000000;">&#0160;</span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;">Namespace</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">ExcelSample</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas; color: #000000;">&#0160;</span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160; </span><span><span style="color: #0000ff;">Public</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Class</span></span><span style="color: #000000;"> </span><span><span style="color: #2b91af;">MyCommands</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas; color: #000000;">&#0160;</span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span><span><span style="color: #008000;">&#39; command to show how to fill an excel work book with data from the currently active DWG inside of AutoCAD</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160; &lt;</span><span><span style="color: #2b91af;">CommandMethod</span></span><span style="color: #000000;">(</span><span><span style="color: #a31515;">&quot;FentonWebbDevTechAutodesk&quot;</span></span><span style="color: #000000;">, </span><span><span style="color: #a31515;">&quot;ExcelExample&quot;</span></span><span style="color: #000000;">, </span><span><span style="color: #a31515;">&quot;ExcelExample&quot;</span></span><span style="color: #000000;">, </span><span><span style="color: #2b91af;">CommandFlags</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Modal</span></span><span style="color: #000000;">)&gt; _</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span><span><span style="color: #0000ff;">Public</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Sub</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">MyCommand</span></span><span style="color: #000000;">()</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas; color: #000000;">&#0160;</span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #0000ff;">Dim</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">ed</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #2b91af;">Editor</span></span><span style="color: #000000;"> = </span><span><span style="color: #010001;">Application</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">DocumentManager</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">MdiActiveDocument</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Editor</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas; color: #000000;">&#0160;</span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #008000;">&#39; create or get existing Excel app</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #0000ff;">Dim</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">excelHelper</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #2b91af;">ExcelHelper</span></span><span style="color: #000000;">.</span><span><span style="color: #2b91af;">CreateExcelDoc</span></span><span style="color: #000000;"> = </span><span><span style="color: #0000ff;">New</span></span><span style="color: #000000;"> </span><span><span style="color: #2b91af;">ExcelHelper</span></span><span style="color: #000000;">.</span><span><span style="color: #2b91af;">CreateExcelDoc</span></span><span style="color: #000000;">()</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #008000;">&#39; create dwg file details header</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #2b91af;">excelHelper</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">createHeaders</span></span><span style="color: #000000;">(1, 1, </span><span><span style="color: #a31515;">&quot;Overview Data for AutoCAD Drawing: &quot;</span></span><span style="color: #000000;"> _</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; + </span><span><span style="color: #010001;">Application</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">DocumentManager</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">MdiActiveDocument</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Name</span></span><span style="color: #000000;">, </span><span><span style="color: #a31515;">&quot;A1&quot;</span></span><span style="color: #000000;">, </span><span><span style="color: #a31515;">&quot;Z1&quot;</span></span><span style="color: #000000;">, _</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; 2, </span><span><span style="color: #010001;">System</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Drawing</span></span><span style="color: #000000;">.</span><span><span style="color: #2b91af;">Color</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">LightBlue</span></span><span style="color: #000000;">, </span><span><span style="color: #0000ff;">True</span></span><span style="color: #000000;">, 80, 16, _</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #010001;">System</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Drawing</span></span><span style="color: #000000;">.</span><span><span style="color: #2b91af;">Color</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Black</span></span><span style="color: #000000;">)</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas; color: #000000;">&#0160;</span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #008000;">&#39; create the hatches header</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #2b91af;">excelHelper</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">createHeaders</span></span><span style="color: #000000;">(2, 1, </span><span><span style="color: #a31515;">&quot;Hatch Patterns&quot;</span></span><span style="color: #000000;">, </span><span><span style="color: #a31515;">&quot;A2&quot;</span></span><span style="color: #000000;">, </span><span><span style="color: #a31515;">&quot;A2&quot;</span></span><span style="color: #000000;">, _</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; 2, </span><span><span style="color: #010001;">System</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Drawing</span></span><span style="color: #000000;">.</span><span><span style="color: #2b91af;">Color</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">LightGray</span></span><span style="color: #000000;">, </span><span><span style="color: #0000ff;">True</span></span><span style="color: #000000;">, 40, 12, _</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #010001;">System</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Drawing</span></span><span style="color: #000000;">.</span><span><span style="color: #2b91af;">Color</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Black</span></span><span style="color: #000000;">)</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #008000;">&#39; export all of the Hatch patterns using Kean&#39;s way, cool</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #0000ff;">Dim</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">y</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Integer</span></span><span style="color: #000000;"> = 3</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #0000ff;">Dim</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">str</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">String</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #0000ff;">For</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Each</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">str</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">In</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">Autodesk</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">AutoCAD</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Windows</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Data</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">HatchPatterns</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Instance</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">AllPatterns</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #2b91af;">excelHelper</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">addData</span></span><span style="color: #000000;">(</span><span><span style="color: #010001;">y</span></span><span style="color: #000000;">, 1, </span><span><span style="color: #010001;">str</span></span><span style="color: #000000;">, </span><span><span style="color: #a31515;">&quot;A&quot;</span></span><span style="color: #000000;"> + </span><span><span style="color: #2b91af;">y</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">ToString</span></span><span style="color: #000000;">(), </span><span><span style="color: #a31515;">&quot;A&quot;</span></span><span style="color: #000000;"> + </span><span><span style="color: #2b91af;">y</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">ToString</span></span><span style="color: #000000;">(), </span><span><span style="color: #a31515;">&quot;&quot;</span></span><span style="color: #000000;">)</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #010001;">y</span></span><span style="color: #000000;"> = </span><span><span style="color: #010001;">y</span></span><span style="color: #000000;"> + 1</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #0000ff;">Next</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas; color: #000000;">&#0160;</span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #010001;">AddDataBoundEntry</span></span><span style="color: #000000;">(</span><span><span style="color: #010001;">excelHelper</span></span><span style="color: #000000;">, 2, 2, </span><span><span style="color: #a31515;">&quot;B&quot;</span></span><span style="color: #000000;">, </span><span><span style="color: #a31515;">&quot;Layers&quot;</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">Application</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">UIBindings</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Collections</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Layers</span></span><span style="color: #000000;">, </span><span><span style="color: #a31515;">&quot;Name&quot;</span></span><span style="color: #000000;">)</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #010001;">AddDataBoundEntry</span></span><span style="color: #000000;">(</span><span><span style="color: #010001;">excelHelper</span></span><span style="color: #000000;">, 2, 3, </span><span><span style="color: #a31515;">&quot;C&quot;</span></span><span style="color: #000000;">, </span><span><span style="color: #a31515;">&quot;Layer States&quot;</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">Application</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">UIBindings</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Collections</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">LayerStates</span></span><span style="color: #000000;">, </span><span><span style="color: #a31515;">&quot;Name&quot;</span></span><span style="color: #000000;">)</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #010001;">AddDataBoundEntry</span></span><span style="color: #000000;">(</span><span><span style="color: #010001;">excelHelper</span></span><span style="color: #000000;">, 2, 4, </span><span><span style="color: #a31515;">&quot;D&quot;</span></span><span style="color: #000000;">, </span><span><span style="color: #a31515;">&quot;Layer Filters&quot;</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">Application</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">UIBindings</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Collections</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">LayerFilters</span></span><span style="color: #000000;">, </span><span><span style="color: #a31515;">&quot;Name&quot;</span></span><span style="color: #000000;">)</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #010001;">AddDataBoundEntry</span></span><span style="color: #000000;">(</span><span><span style="color: #010001;">excelHelper</span></span><span style="color: #000000;">, 2, 5, </span><span><span style="color: #a31515;">&quot;E&quot;</span></span><span style="color: #000000;">, </span><span><span style="color: #a31515;">&quot;Line Types&quot;</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">Application</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">UIBindings</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Collections</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Linetypes</span></span><span style="color: #000000;">, </span><span><span style="color: #a31515;">&quot;Name&quot;</span></span><span style="color: #000000;">)</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #010001;">AddDataBoundEntry</span></span><span style="color: #000000;">(</span><span><span style="color: #010001;">excelHelper</span></span><span style="color: #000000;">, 2, 6, </span><span><span style="color: #a31515;">&quot;F&quot;</span></span><span style="color: #000000;">, </span><span><span style="color: #a31515;">&quot;MLeader Styles&quot;</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">Application</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">UIBindings</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Collections</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">MleaderStyles</span></span><span style="color: #000000;">, </span><span><span style="color: #a31515;">&quot;Name&quot;</span></span><span style="color: #000000;">)</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #010001;">AddDataBoundEntry</span></span><span style="color: #000000;">(</span><span><span style="color: #010001;">excelHelper</span></span><span style="color: #000000;">, 2, 7, </span><span><span style="color: #a31515;">&quot;G&quot;</span></span><span style="color: #000000;">, </span><span><span style="color: #a31515;">&quot;Dimension Styles&quot;</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">Application</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">UIBindings</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Collections</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">DimensionStyles</span></span><span style="color: #000000;">, </span><span><span style="color: #a31515;">&quot;Name&quot;</span></span><span style="color: #000000;">)</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #010001;">AddDataBoundEntry</span></span><span style="color: #000000;">(</span><span><span style="color: #010001;">excelHelper</span></span><span style="color: #000000;">, 2, 8, </span><span><span style="color: #a31515;">&quot;H&quot;</span></span><span style="color: #000000;">, </span><span><span style="color: #a31515;">&quot;Plot Styles&quot;</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">Application</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">UIBindings</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Collections</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">PlotStyles</span></span><span style="color: #000000;">, </span><span><span style="color: #a31515;">&quot;Name&quot;</span></span><span style="color: #000000;">)</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #010001;">AddDataBoundEntry</span></span><span style="color: #000000;">(</span><span><span style="color: #010001;">excelHelper</span></span><span style="color: #000000;">, 2, 9, </span><span><span style="color: #a31515;">&quot;I&quot;</span></span><span style="color: #000000;">, </span><span><span style="color: #a31515;">&quot;Visual Styles&quot;</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">Application</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">UIBindings</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Collections</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">VisualStyles</span></span><span style="color: #000000;">, </span><span><span style="color: #a31515;">&quot;Name&quot;</span></span><span style="color: #000000;">)</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #010001;">AddDataBoundEntry</span></span><span style="color: #000000;">(</span><span><span style="color: #010001;">excelHelper</span></span><span style="color: #000000;">, 2, 10, </span><span><span style="color: #a31515;">&quot;J&quot;</span></span><span style="color: #000000;">, </span><span><span style="color: #a31515;">&quot;Ucs Planes&quot;</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">Application</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">UIBindings</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Collections</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">UcsPlanes</span></span><span style="color: #000000;">, </span><span><span style="color: #a31515;">&quot;Name&quot;</span></span><span style="color: #000000;">)</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #010001;">AddDataBoundEntry</span></span><span style="color: #000000;">(</span><span><span style="color: #010001;">excelHelper</span></span><span style="color: #000000;">, 2, 11, </span><span><span style="color: #a31515;">&quot;K&quot;</span></span><span style="color: #000000;">, </span><span><span style="color: #a31515;">&quot;Text Styles&quot;</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">Application</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">UIBindings</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Collections</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">TextStyles</span></span><span style="color: #000000;">, </span><span><span style="color: #a31515;">&quot;Name&quot;</span></span><span style="color: #000000;">)</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #010001;">AddDataBoundEntry</span></span><span style="color: #000000;">(</span><span><span style="color: #010001;">excelHelper</span></span><span style="color: #000000;">, 2, 12, </span><span><span style="color: #a31515;">&quot;L&quot;</span></span><span style="color: #000000;">, </span><span><span style="color: #a31515;">&quot;Table Styles&quot;</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">Application</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">UIBindings</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Collections</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">TableStyles</span></span><span style="color: #000000;">, </span><span><span style="color: #a31515;">&quot;Name&quot;</span></span><span style="color: #000000;">)</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #010001;">AddDataBoundEntry</span></span><span style="color: #000000;">(</span><span><span style="color: #010001;">excelHelper</span></span><span style="color: #000000;">, 2, 13, </span><span><span style="color: #a31515;">&quot;M&quot;</span></span><span style="color: #000000;">, </span><span><span style="color: #a31515;">&quot;Render Presets&quot;</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">Application</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">UIBindings</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Collections</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">RenderPresets</span></span><span style="color: #000000;">, </span><span><span style="color: #a31515;">&quot;Name&quot;</span></span><span style="color: #000000;">)</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #010001;">AddDataBoundEntry</span></span><span style="color: #000000;">(</span><span><span style="color: #010001;">excelHelper</span></span><span style="color: #000000;">, 2, 14, </span><span><span style="color: #a31515;">&quot;N&quot;</span></span><span style="color: #000000;">, </span><span><span style="color: #a31515;">&quot;Named Views&quot;</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">Application</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">UIBindings</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Collections</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">NamedViews</span></span><span style="color: #000000;">, </span><span><span style="color: #a31515;">&quot;Name&quot;</span></span><span style="color: #000000;">)</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas; color: #000000;">&#0160;</span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span><span><span style="color: #0000ff;">End</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Sub</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas; color: #000000;">&#0160;</span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span><span><span style="color: #0000ff;">Private</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Sub</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">AddDataBoundEntry</span></span><span style="color: #000000;">( _</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #010001;">excelHelper</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #2b91af;">ExcelHelper</span></span><span style="color: #000000;">.</span><span><span style="color: #2b91af;">CreateExcelDoc</span></span><span style="color: #000000;">, _</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #010001;">row</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Integer</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">col</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Integer</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">colStr</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">String</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">headerName</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">String</span></span><span style="color: #000000;">, _</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #010001;">dataItemCollection</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">Autodesk</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">AutoCAD</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Windows</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Data</span></span><span style="color: #000000;">.</span><span><span style="color: #2b91af;">DataItemCollection</span></span><span style="color: #000000;">, _</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #010001;">propertyName</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">String</span></span><span style="color: #000000;">)</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas; color: #000000;">&#0160;</span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #008000;">&#39; create the Layers dump</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #2b91af;">excelHelper</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">createHeaders</span></span><span style="color: #000000;">(</span><span><span style="color: #010001;">row</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">col</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">headerName</span></span><span style="color: #000000;">, _</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #010001;">colStr</span></span><span style="color: #000000;"> + </span><span><span style="color: #2b91af;">row</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">ToString</span></span><span style="color: #000000;">(), </span><span><span style="color: #010001;">colStr</span></span><span style="color: #000000;"> + </span><span><span style="color: #2b91af;">row</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">ToString</span></span><span style="color: #000000;">(), _</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; 2, </span><span><span style="color: #010001;">System</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Drawing</span></span><span style="color: #000000;">.</span><span><span style="color: #2b91af;">Color</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">LightGray</span></span><span style="color: #000000;">, </span><span><span style="color: #0000ff;">True</span></span><span style="color: #000000;">, 40, 12, _</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #010001;">System</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Drawing</span></span><span style="color: #000000;">.</span><span><span style="color: #2b91af;">Color</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">Black</span></span><span style="color: #000000;">)</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #008000;">&#39; export all of the Hatch patterns</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #0000ff;">Dim</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">y</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Integer</span></span><span style="color: #000000;"> = 3</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #008000;">&#39; loop all of the entries</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #0000ff;">For</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Each</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">desc</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">As</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">System</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">ComponentModel</span></span><span style="color: #000000;">.</span><span><span style="color: #2b91af;">ICustomTypeDescriptor</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">In</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">dataItemCollection</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #008000;">&#39; extract the layer table record property we want</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #0000ff;">Dim</span></span><span style="color: #000000;"> </span><span><span style="color: #010001;">propertyValue</span></span><span style="color: #000000;"> = </span><span><span style="color: #2b91af;">desc</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">GetProperties</span></span><span style="color: #000000;">()(</span><span><span style="color: #010001;">propertyName</span></span><span style="color: #000000;">).</span><span><span style="color: #010001;">GetValue</span></span><span style="color: #000000;">(</span><span><span style="color: #010001;">desc</span></span><span style="color: #000000;">)</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #008000;">&#39; add it to the sheet</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #2b91af;">excelHelper</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">addData</span></span><span style="color: #000000;">(</span><span><span style="color: #010001;">y</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">col</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">propertyValue</span></span><span style="color: #000000;">, </span><span><span style="color: #010001;">colStr</span></span><span style="color: #000000;"> + </span><span><span style="color: #2b91af;">y</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">ToString</span></span><span style="color: #000000;">(), </span><span><span style="color: #010001;">colStr</span></span><span style="color: #000000;"> + </span><span><span style="color: #2b91af;">y</span></span><span style="color: #000000;">.</span><span><span style="color: #010001;">ToString</span></span><span style="color: #000000;">(), </span><span><span style="color: #a31515;">&quot;&quot;</span></span><span style="color: #000000;">)</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #010001;">y</span></span><span style="color: #000000;"> = </span><span><span style="color: #010001;">y</span></span><span style="color: #000000;"> + 1</span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #0000ff;">Next</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas; color: #000000;">&#0160;</span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span><span><span style="color: #0000ff;">End</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Sub</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas; color: #000000;">&#0160;</span></p>
<p style="margin: 0px;"><span style="font-family: Consolas; color: #000000;">&#0160;</span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span style="color: #000000;">&#0160; </span><span><span style="color: #0000ff;">End</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Class</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Consolas; color: #000000;">&#0160;</span></p>
<p style="margin: 0px;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;">End</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">Namespace</span></span></span></p>
</div>
<p>&#0160;</p>
<p>and finally, the output seen in Excel</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0168e959f47b970c-pi"><img alt="ExcelOutput" border="0" height="257" src="/assets/image_752468.jpg" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="ExcelOutput" width="437" /></a></p>
<p>&#0160;</p>
<p>Until the next time</p>
<p>Fenton</p>
