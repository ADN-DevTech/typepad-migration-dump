---
layout: "post"
title: "Setting the Wait Cursor type using ObjectARX and Win32"
date: "2012-06-08 16:13:09"
author: "Fenton Webb"
categories:
  - "2010"
  - "2011"
  - "2012"
  - "2013"
  - "AutoCAD"
  - "Fenton Webb"
  - "ObjectARX"
original_url: "https://adndevblog.typepad.com/autocad/2012/06/setting-the-wait-cursor-type-using-objectarx-and-win32.html "
typepad_basename: "setting-the-wait-cursor-type-using-objectarx-and-win32"
typepad_status: "Publish"
---

<p>by <a href="http://adndevblog.typepad.com/autocad/fenton-webb.html">Fenton Webb</a></p>  <p>Sometimes, you want to tell the user that your application is busy and what better way to do that then with an Hour Glass wait cursor… Obviously, you can create your own custom cursor and display it using the same technique…</p>  <p>Here’s how:</p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">//////////////////////////////////////////////////////////////////////////</font></font></span></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">static</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#010001">HHOOK</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">MyHook</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">static</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#010001">HCURSOR</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">hWaitCursor</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">//////////////////////////////////////////////////////////////////////////</font></font></span></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">static</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#010001">LRESULT</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">CALLBACK</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">MyMsgProc</font></span><font color="#000000"> (</font><span style="color: "><font color="#0000ff">int</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">nCode</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">WPARAM</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">wParam</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">LPARAM</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">lParam</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">//////////////////////////////////////////////////////////////////////////</font></font></span></p>    <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">// This is command 'WAITCURSOR, by Fenton Webb [14/10/2004], DevTech, Autodesk</font></font></span></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">void</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#010001">asdkWaitCursor</font></span><font color="#000000">()</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">{ </font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// load the Wait cursor </font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">hWaitCursor</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">LoadCursor</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">NULL</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">IDC_WAIT</font></span><font color="#000000">);&#160;&#160; </font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// and set it</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">HCURSOR</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">hCursor</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">SetCursor</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">hWaitCursor</font></span><font color="#000000">);&#160; </font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// now set a hook so we can constantly keep our cursor set</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">MyHook</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">SetWindowsHookEx</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">WH_CALLWNDPROCRET</font></span><font color="#000000">, (</font><span style="color: "><font color="#010001">HOOKPROC</font></span><font color="#000000">)</font><span style="color: "><font color="#010001">MyMsgProc</font></span><font color="#000000">, (</font><span style="color: "><font color="#010001">HINSTANCE</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt"><font color="#000000">&#160;</font><span style="color: "><font color="#010001">NULL</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">GetCurrentThreadId</font></span><font color="#000000"> ());&#160; </font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// now do the wait intensive task...</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">ACHAR</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">cResult</font></span><font color="#000000"> [256]; </font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">acedGetString</font></span><font color="#000000"> (0, </font><span style="color: "><font color="#010001">_T</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;\nPretending to wait : &quot;</font></span><font color="#000000">), </font><span style="color: "><font color="#010001">cResult</font></span><font color="#000000">);&#160; </font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// and finally clean up</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">UnhookWindowsHookEx</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">MyHook</font></span><font color="#000000">) ; </font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">SetCursor</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">hCursor</font></span><font color="#000000">) ;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">}</font></font></p>    <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">//////////////////////////////////////////////////////////////////////////</font></font></span></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#010001"><font style="font-size: 8pt">LRESULT</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#010001">CALLBACK</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">MyMsgProc</font></span><font color="#000000"> (</font><span style="color: "><font color="#0000ff">int</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">nCode</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">WPARAM</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">wParam</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">LPARAM</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">lParam</font></span><font color="#000000">) </font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">{ </font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// forward the other hook calls</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> ( </font><span style="color: "><font color="#010001">nCode</font></span><font color="#000000"> &lt; 0 )&#160; </font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">CallNextHookEx</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">MyHook</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">nCode</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">wParam</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">lParam</font></span><font color="#000000">));&#160; </font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">LRESULT</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">ret</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">CallNextHookEx</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">MyHook</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">nCode</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">wParam</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">lParam</font></span><font color="#000000">); </font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// keep updating our cursor type</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">SetCursor</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">hWaitCursor</font></span><font color="#000000">);&#160; </font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">ret</font></span><font color="#000000">) ;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">}</font></font></p> </div>
