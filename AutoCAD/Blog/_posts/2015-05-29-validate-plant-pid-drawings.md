---
layout: "post"
title: "Validate Plant P&amp;ID drawings"
date: "2015-05-29 05:15:06"
author: "Augusto Goncalves"
categories:
  - ".NET"
  - "Augusto Goncalves"
  - "Plant3D"
  - "PnID"
original_url: "https://adndevblog.typepad.com/autocad/2015/05/validate-plant-pid-drawings.html "
typepad_basename: "validate-plant-pid-drawings"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>Inside Plant P&amp;ID we can Validate, via ribbon Home&gt;Validate&gt;Run Validation or right-click on a drawing and select “Validate”. More <a href="http://knowledge.autodesk.com/support/autocad-plant-3d/learn-explore/caas/CloudHelp/cloudhelp/2016/ENU/Plant3D-UserGuide/files/GUID-5BCB33C1-67D1-4D34-9EA2-AE93D75440AD-htm.html">details here</a>.</p>  <p>Using APIs there is a ValidationSingleton object that has a ValidateDrawings or ValidareProject method. After run this, the Errors property will contain a list of validation errors. Actually there is one class for each type, so you’ll need to cast or, like in the sample below, simply get the error name.</p>  <p><strong>Important</strong>: this API method will *only* show the validation errors after you run it via built-in command.</p>  <pre style="font-size: 13px; font-family: consolas; background: white; color: black">[<span style="color: #2b91af">CommandMethod</span>(<span style="color: #a31515">&quot;validateDrawings&quot;</span>)]<br /><span style="color: blue">public</span>&#160;<span style="color: blue">static</span>&#160;<span style="color: blue">void</span> CmdValidateDrawings()<br />{<br />&#160; <span style="color: #2b91af">Editor</span> ed = <span style="color: #2b91af">Application</span>.DocumentManager.<br />&#160;&#160;&#160; MdiActiveDocument.Editor;<br /> <br />&#160; <span style="color: green">// Validation manager</span><br />&#160; <span style="color: #2b91af">AcPpValidationManager</span> vmgr = <span style="color: #2b91af">ValidationSingleton</span>.Manager;<br /> <br />&#160; <span style="color: green">// prepare a list of drawings</span><br />&#160; <span style="color: #2b91af">AcPpValidationAllOpenedDrawingManager</span> dsd =<br />&#160;&#160;&#160; <span style="color: blue">new</span>&#160;<span style="color: #2b91af">AcPpValidationAllOpenedDrawingManager</span>();<br />&#160; <span style="color: blue">foreach</span> (<span style="color: #2b91af">Document</span> doc <span style="color: blue">in</span>&#160;<span style="color: #2b91af">Application</span>.DocumentManager)<br />&#160; {<br />&#160;&#160;&#160; dsd.Add(doc.Database);<br />&#160; }<br /> <br />&#160; <span style="color: green">// clear the list of error </span><br />&#160; <span style="color: green">// (in case you're running several times)</span><br />&#160; vmgr.Errors.Clear();<br /> <br />&#160; <span style="color: green">// the actual validation occurs here</span><br />&#160; vmgr.ValidateProject(dsd);<br /> <br />&#160; <span style="color: green">// now check the list of errors</span><br />&#160; <span style="color: blue">if</span> (vmgr.Errors.Count &gt; 0)<br />&#160; {<br /><br />&#160;&#160;&#160; <span style="color: #2b91af">AcPpValidationErrorCollection</span> errorList = vmgr.Errors;<br />&#160;&#160;&#160; <span style="color: blue">foreach</span> (<span style="color: #2b91af">IAcPpValidationError</span> item1 <span style="color: blue">in</span> errorList)<br />&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160; <span style="color: green">// can be classes from namespace</span><br />&#160;&#160;&#160;&#160;&#160; <span style="color: green">// Autodesk.ProcessPower.PnIDDwgValidation&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><br /> <br /> <br />&#160;&#160;&#160;&#160;&#160; <span style="color: green">// for now, let's write the error class name</span><br />&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(<span style="color: #a31515">&quot;\n{0}&quot;</span>, <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; item1.GetType().Name.PascalCaseToText());<br />&#160;&#160;&#160; }<br />&#160; }<br />}</pre>

<pre style="font-size: 13px; font-family: consolas; background: white; color: black"><br /><span style="color: green">// nice sample Regular expression <a href="http://stackoverflow.com/questions/155303/net-how-can-you-split-a-caps-delimited-string-into-an-array">from here</a>.</span> <br /><span style="color: blue">public</span>&#160;<span style="color: blue">static</span>&#160;<span style="color: blue">string</span> PascalCaseToText(<span style="color: blue">this</span>&#160;<span style="color: blue">string</span> text)<br />{<br />&#160; <span style="color: blue">return</span> System.Text.RegularExpressions.<span style="color: #2b91af">Regex</span>.Replace(<br />&#160;&#160;&#160; text, <span style="color: #a31515">&quot;([a-z](?=[A-Z])|[A-Z](?=[A-Z][a-z]))&quot;</span>, <span style="color: #a31515">&quot;$1 &quot;</span>);<br />}</pre>
