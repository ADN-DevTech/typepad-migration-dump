---
layout: "post"
title: "Append fails with multiple defined s:startup functions"
date: "2012-12-19 00:16:32"
author: "Xiaodong Liang"
categories:
  - "AutoCAD"
  - "LISP"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/autocad/2012/12/append-fails-with-multiple-defined-sstartup-functions.html "
typepad_basename: "append-fails-with-multiple-defined-sstartup-functions"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/xiaodong-liang.html" target="_self">Xiaodong Liang</a>     <br /></p>  <p><b>Issue     <br /></b>I have followed the documentation in the Migration Assistance and the Customization Guide. My code also works in previous versions of AutoCAD. Why does the following code fail?</p>  <p><span style="line-height: 120%; font-family: &#39;courier new&#39;, courier; font-size: 8pt"><span style="color: #ff0000">(</span><span style="color: #0000ff">defun</span> MYSTARTUP <span style="color: #ff0000">(</span><span style="color: #ff0000">)</span>       <br />&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">if</span>&#160;<span style="color: #ff0000">(</span>not <span style="color: #ff0000">(</span><span style="color: #0000ff">equal</span>&#160;<span style="color: #ff0000">(</span>menugroup <span style="color: #ff00ff">&quot;MYGROUP&quot;</span><span style="color: #ff0000">)</span>&#160;<span style="color: #ff00ff">&quot;MYGROUP&quot;</span><span style="color: #ff0000">)</span><span style="color: #ff0000">)</span>&#160;<span style="color: #ff0000">(</span><span style="color: #0000ff">command</span>&#160;<span style="color: #ff00ff">&quot;MENULOAD&quot;</span>       <br /><span style="color: #ff00ff">&quot;MYMENU&quot;</span><span style="color: #ff0000">)</span>&#160;<span style="color: #ff0000">)</span>       <br /><span style="color: #ff0000">)</span>       <br /><span style="color: #ff0000">(</span><span style="color: #0000ff">setq</span> S::STARTUP <span style="color: #ff0000">(</span>append S::STARTUP MYSTARTUP<span style="color: #ff0000">)</span><span style="color: #ff0000">)</span></span></p> With this error:   <p><span style="line-height: 120%; font-family: &#39;courier new&#39;, courier; font-size: 8pt"><span style="background-color: #e6e6e6; color: #800080">; error: Invalid attempt to access a compiled function definition.&#160; You may&#160; <br /></span>want to define it using defun-q: #<subr  &NBSP;@01FB5C30&NBSP;S::STARTUP></span></p> <strong>Solution</strong>   <br />As the error indicates, you most likely have a S::STARTUP function already defined using defun in another file. If you have third party programs installed on your system, there can easily be more than one instance of the S:STARTUP function definitions. If this is the case, you will need to either find all instances of startup functions and ensure that they are defined with defun-q in order to use the append function with them, or you can use the AutoLISP code that follows: If you do not know how S::STARTUP is defun'd, then this additional code placed in your ACADDOC.LSP file (along with your MYSTARTUP function) will work for either type of S::STARTUP function, such as SUBR or LIST:   <p><span style="line-height: 120%; font-family: &#39;courier new&#39;, courier; font-size: 8pt"><span style="color: #ff0000">(</span><span style="color: #0000ff">defun</span> new-startup-func <span style="color: #ff0000">(</span>afoo-arg<span style="color: #ff0000">)</span>      <br />      <br />&#160;<span style="color: #ff0000">(</span>eval      <br />&#160;&#160; <span style="color: #ff0000">(</span>list 'defun 's::startup '<span style="color: #ff0000">(</span><span style="color: #ff0000">)</span>      <br /><span style="background-color: #e6e6e6; color: #800080">;<span style="background-color: #e6e6e6; color: #800080">; If S::STARTUP exists call S::STARTUP by SUBR ID         <br /></span></span>&#160;&#160;&#160;&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">if</span> s::startup&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160; <span style="color: #ff0000">(</span>list <span style="color: #ff0000">(</span>list 'quote s::startup<span style="color: #ff0000">)</span><span style="color: #ff0000">)</span>      <br />&#160;&#160;&#160;&#160; <span style="color: #ff0000">)</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br /><span style="background-color: #e6e6e6; color: #800080">;<span style="background-color: #e6e6e6; color: #800080">; if user SUBR, add it here to new S::STARTUP defun         <br /></span></span>&#160;&#160;&#160;&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">if</span> afoo-arg&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160; <span style="color: #ff0000">(</span>list <span style="color: #ff0000">(</span>list 'quote <span style="color: #ff0000">(</span>eval afoo-arg<span style="color: #ff0000">)</span><span style="color: #ff0000">)</span><span style="color: #ff0000">)</span>      <br />&#160;&#160;&#160;&#160; <span style="color: #ff0000">)</span>      <br />&#160;&#160; <span style="color: #ff0000">)</span>      <br />&#160;<span style="color: #ff0000">)</span>      <br /><span style="color: #ff0000">)</span>      <br />      <br /><span style="color: #ff0000">(</span>new-startup-func 'MYSTARTUP<span style="color: #ff0000">)</span></span></p>
