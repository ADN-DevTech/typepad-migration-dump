---
layout: "post"
title: "Recover API – New API in AutoCAD 2015"
date: "2014-03-26 01:27:28"
author: "Virupaksha Aithal"
categories:
  - ".NET"
  - "2015"
  - "AutoCAD"
  - "Virupaksha Aithal"
original_url: "https://adndevblog.typepad.com/autocad/2014/03/recover-api-new-api-in-autocad-2015-1.html "
typepad_basename: "recover-api-new-api-in-autocad-2015-1"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/Virupaksha-Aithal.html" target="_self">Virupaksha Aithal</a></p>
<p>A long time request by developer community is to recover the drawing files through API. That request has been addressed in AutoCAD 2015. Now, document collection class has a new API “AppContextRecoverDocument” which takes the name of the drawing file to recover. This API is present in ObjectARX and in .NET.&#0160;In ObjectARX use AcApDocManager::appContextRecoverDocument() API.</p>
<div style="border: #000080 0px solid; color: #000; font-family: &#39;Courier New&#39;, Courier, Monospace; font-size: 8pt;">
<div style="background-color: #ffffff; overflow: auto; padding: 2px 5px; white-space: nowrap;"><span style="background: #ffffff; color: #000000;">[</span><span style="background: #ffffff; color: #2b91af;">CommandMethod</span><span style="background: #ffffff; color: #000000;">(</span><span style="background: #ffffff; color: #a31515;">&quot;RecoverTest&quot;</span><span style="background: #ffffff; color: #000000;">, </span><span style="background: #ffffff; color: #2b91af;">CommandFlags</span><span style="background: #ffffff; color: #000000;">.Session)]</span><br /> <span style="background: #ffffff; color: #0000ff;">public</span><span style="background: #ffffff; color: #0000ff;">void</span><span style="background: #ffffff; color: #000000;"> RecoverTest() </span><span style="background: #ffffff; color: #008000;">// This method can have any name</span><br /> <span style="background: #ffffff; color: #000000;">{</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #2b91af;">Document</span><span style="background: #ffffff; color: #000000;"> doc = </span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #2b91af;">Application</span><span style="background: #ffffff; color: #000000;">.DocumentManager.MdiActiveDocument;</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #2b91af;">DocumentCollection</span><span style="background: #ffffff; color: #000000;"> docs = </span><span style="background: #ffffff; color: #2b91af;">Application</span><span style="background: #ffffff; color: #000000;">.DocumentManager;</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #2b91af;">Editor</span><span style="background: #ffffff; color: #000000;"> ed = doc.Editor;</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #2b91af;">OpenFileDialog</span><span style="background: #ffffff; color: #000000;"> file = </span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">new</span><span style="background: #ffffff; color: #2b91af;">OpenFileDialog</span><span style="background: #ffffff; color: #000000;">(</span><span style="background: #ffffff; color: #a31515;">&quot;Select file to recover&quot;</span><span style="background: #ffffff; color: #000000;">, </span><span style="background: #ffffff; color: #0000ff;">null</span><span style="background: #ffffff; color: #000000;">,</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #a31515;">&quot;dwg;dxf&quot;</span><span style="background: #ffffff; color: #000000;">, </span><span style="background: #ffffff; color: #a31515;">&quot;Recover&quot;</span><span style="background: #ffffff; color: #000000;">, </span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #2b91af;">OpenFileDialog</span><span style="background: #ffffff; color: #000000;">.</span><span style="background: #ffffff; color: #2b91af;">OpenFileDialogFlags</span><span style="background: #ffffff; color: #000000;">.DoNotTransferRemoteFiles);</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #008000;">//show the dialog and take the dwg input</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;System.Windows.Forms.</span><span style="background: #ffffff; color: #2b91af;">DialogResult</span><span style="background: #ffffff; color: #000000;"> dr =&#0160;&#0160;file.ShowDialog();</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">if</span><span style="background: #ffffff; color: #000000;"> (dr != System.Windows.Forms.</span><span style="background: #ffffff; color: #2b91af;">DialogResult</span><span style="background: #ffffff; color: #000000;">.OK)</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">return</span><span style="background: #ffffff; color: #000000;">;</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">try</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;{</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #008000;">//call&#0160;&#0160;AppContextRecoverDocument to revover the selected DWG.</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;docs.AppContextRecoverDocument(file.Filename);</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;}</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">catch</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;{</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;ed.WriteMessage(</span><span style="background: #ffffff; color: #a31515;">&quot;Unable to recover the drawing\n&quot;</span><span style="background: #ffffff; color: #000000;">);</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;}</span><br /> <span style="background: #ffffff; color: #000000;">}</span></div>
</div>
