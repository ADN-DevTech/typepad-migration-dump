---
layout: "post"
title: "Licensing applications: Infralution"
date: "2012-08-13 14:47:00"
author: "Augusto Goncalves"
categories:
  - ".NET"
  - "Augusto Goncalves"
  - "AutoCAD"
original_url: "https://adndevblog.typepad.com/autocad/2012/08/licensing-applications-infralution.html "
typepad_basename: "licensing-applications-infralution"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>This series of articles will show how to use tools available on the market to control licensing of plug-ins for Autodesk products. This is important to most commercial developers and if you are developing for the <a href="http://apps.exchange.autodesk.com/">Autodesk Exchange Store</a>, you noticed that no license system is provided, only a payment method. We’re not testing, validating or certifying the protection system and how hard it’s to (or not to) break it. </p>  <p>For this demonstration, we’ll use a .NET plug-in developed for AutoCAD, but the same idea can be applied to other .NET based APIs, like Revit and Inventor. Most of the code came from the samples available with the tool.</p>  <p>Now moving forward, this post will show the <a href="http://www.infralution.com/licensing.html">Infralution License System</a>, winning of the <a href="http://www.codeproject.com/script/Awards/Competition.aspx?cid=334">2009</a>, <a href="http://www.codeproject.com/PressReleases/2407/THE-CODE-PROJECT-ANNOUNCES-SECOND-ANNUAL-MEMBERS-C.aspx">2010</a> and <a href="http://www.codeproject.com/PressReleases/3935/The-Code-Project-Announces-Third-Annual-Members-Ch.aspx">2011</a> Members Choice of the <a href="http://www.codeproject.com/">Code Project</a> development resource site. This tool is available for trial during 30 days and the prices start at $170 US dollars.</p>  <p>Between the benefits: </p>  <ul>   <li>just a few lines of code added to any command on the plug-in, as will be shown on the sample; </li>    <li>single .NET reference required that will enable all license features; </li>    <li>supports obfuscation, although this feature is not included, but there is another tool <a href="http://www.infralution.com/netencryptor.html" target="_blank">.NET Encryptor</a> from the same provider. </li>    <li>interesting sales management feature; </li>    <li>support trial, mandatory feature for <a href="http://usa.autodesk.com/adsk/servlet/item?siteID=123112&amp;id=17183450">Autodesk Exchange Store</a>, where every plug-in must immediately work after downloaded; </li>    <li>authentication can be done online; </li> </ul>  <p>Of course, for AutoCAD environment, some cons: </p>  <ul>   <li>the solution is .NET based and therefore will only work for Windows platform; </li>    <li>no C++ or Lisp support; </li>    <li>requires reference to Windows Form, which can affect AutoCAD console; </li> </ul>  <p>To test the Infralution, download the installer from <a href="http://www.infralution.com/licensing.html">here</a>. Install it and launch it. Go to File menu, then New, then Product. Fill with your plug-in information, such as name, but note that the ‘Product Password’ field is disabled during trial, which must be a unique and hard to guess value. Then click on ‘Generate Validation Parameters’ to create the LICENSE_PARAMETERS variable value.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01761696cd93970c-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="new_product" border="0" alt="new_product" src="/assets/image_621205.jpg" width="462" height="487" /></a></p>  <p>This sample code is based on the sample available at <em><u>C:\Program Files (x86)\Infralution\Licensing System 5\Samples\VS2010\C#\LicensedApp</u></em> folder and have, at the beginning, the code required to check the license. The value of the variable LICENSE_PARAMETERS must be replaced with the one generated when the product was created on the ‘Infralution License Tracker’. </p>  <p>Remember to adjust the TrialDays property. If you plan to deploy at the Autodesk Exchange Store, it is required to have a few days of trial, but the number is your business decision. At the bottom, the <strong>L</strong>ICENSED<strong>T</strong>EST<strong>P</strong>LUGIN custom command will require the license.</p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><font style="font-size: 8pt" color="#000000"> System;</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><font style="font-size: 8pt" color="#000000"> System.Collections.Generic;</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><font style="font-size: 8pt" color="#000000"> System.Linq;</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><font style="font-size: 8pt" color="#000000"> System.Text;</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">// Infralution namespace</font></font></span></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><font style="font-size: 8pt" color="#000000"> Infralution.Licensing.Forms;</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">// AutoCAD namespaces</font></font></span></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><font style="font-size: 8pt" color="#000000"> Autodesk.AutoCAD.Runtime;</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><font style="font-size: 8pt" color="#000000"> Autodesk.AutoCAD.ApplicationServices;</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><font style="font-size: 8pt" color="#000000"> Autodesk.AutoCAD.EditorInput;</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">namespace</font></font></span><font style="font-size: 8pt" color="#000000"> AutoCAD_Infralution</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">{</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">public</font></span><font color="#000000"> </font><span><font color="#0000ff">class</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#2b91af">Commands</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; {</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160; #region</font></font></span><font style="font-size: 8pt" color="#000000"> License</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#808080">///</font></span><span><font color="#008000"> </font></span></font><span><font style="font-size: 8pt" color="#808080">&lt;summary&gt;</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#808080">///</font></span></font><span><font style="font-size: 8pt" color="#008000"> License paramters</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#808080">///</font></span></font><span><font style="font-size: 8pt" color="#008000"> Generated using the Infralution License</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#808080">///</font></span></font><span><font style="font-size: 8pt" color="#008000"> Tracker (after create a new product)</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#808080">///</font></span><span><font color="#008000"> </font></span></font><span><font style="font-size: 8pt" color="#808080">&lt;/summary&gt;</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">private</font></span><font color="#000000"> </font><span><font color="#0000ff">const</font></span><font color="#000000"> </font><span><font color="#0000ff">string</font></span><font color="#000000"> LICENSE_PARAMETERS =</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#a31515">@&quot;&lt;EncryptedLicenseParameters&gt;</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><span><font face="Courier New"><font style="font-size: 8pt" color="#a31515">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;ProductName&gt;AutoCAD_Infralution&lt;/ProductName&gt;</font></font></span></p>  <p style="margin: 0px; font-family: ; background: white"><span><font face="Courier New"><font style="font-size: 8pt" color="#a31515">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;RSAKeyValue&gt;</font></font></span></p>  <p style="margin: 0px; font-family: ; background: white"><span><font face="Courier New"><font style="font-size: 8pt" color="#a31515">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;Modulus&gt;&lt;/Modulus&gt;</font></font></span></p>  <p style="margin: 0px; font-family: ; background: white"><span><font face="Courier New"><font style="font-size: 8pt" color="#a31515">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;Exponent&gt;AQAB&lt;/Exponent&gt;</font></font></span></p>  <p style="margin: 0px; font-family: ; background: white"><span><font face="Courier New"><font style="font-size: 8pt" color="#a31515">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/RSAKeyValue&gt;</font></font></span></p>  <p style="margin: 0px; font-family: ; background: white"><span><font face="Courier New"><font style="font-size: 8pt" color="#a31515">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;DesignSignature&gt;&lt;/DesignSignature&gt;</font></font></span></p>  <p style="margin: 0px; font-family: ; background: white"><span><font face="Courier New"><font style="font-size: 8pt" color="#a31515">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;RuntimeSignature&gt;&lt;/RuntimeSignature&gt;</font></font></span></p>  <p style="margin: 0px; font-family: ; background: white"><span><font face="Courier New"><font style="font-size: 8pt" color="#a31515">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;KeyStrength&gt;7&lt;/KeyStrength&gt;</font></font></span></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><span><font color="#a31515"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/EncryptedLicenseParameters&gt;&quot;</font></font></span><font style="font-size: 8pt" color="#000000">;</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#808080">///</font></span><span><font color="#008000"> </font></span></font><span><font style="font-size: 8pt" color="#808080">&lt;summary&gt;</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#808080">///</font></span></font><span><font style="font-size: 8pt" color="#008000"> License file</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#808080">///</font></span><span><font color="#008000"> </font></span></font><span><font style="font-size: 8pt" color="#808080">&lt;/summary&gt;</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">private</font></span><font color="#000000"> </font><span><font color="#0000ff">static</font></span><font color="#000000"> </font><span><font color="#0000ff">string</font></span><font color="#000000"> _licenseFile =</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; GetPathForDLL(</font></font><font style="font-size: 8pt"><span><font color="#a31515">@&quot;MyLicensedProduct.lic&quot;</font></span><font color="#000000">);</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#808080">///</font></span><span><font color="#008000"> </font></span></font><span><font style="font-size: 8pt" color="#808080">&lt;summary&gt;</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#808080">///</font></span></font><span><font style="font-size: 8pt" color="#008000"> License provider</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#808080">///</font></span><span><font color="#008000"> </font></span></font><span><font style="font-size: 8pt" color="#808080">&lt;/summary&gt;</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">private</font></span><font color="#000000"> </font><span><font color="#0000ff">static</font></span><font color="#000000"> </font><span><font color="#2b91af">EncryptedLicenseProvider</font></span><font color="#000000"> </font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; _licenseProvider = </font></font><font style="font-size: 8pt"><span><font color="#0000ff">new</font></span><font color="#000000"> </font><span><font color="#2b91af">EncryptedLicenseProvider</font></span><font color="#000000">(</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; LICENSE_PARAMETERS, _licenseFile);</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#808080">///</font></span><span><font color="#008000"> </font></span></font><span><font style="font-size: 8pt" color="#808080">&lt;summary&gt;</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#808080">///</font></span></font><span><font style="font-size: 8pt" color="#008000"> Loaded license, if any</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#808080">///</font></span><span><font color="#008000"> </font></span></font><span><font style="font-size: 8pt" color="#808080">&lt;/summary&gt;</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">private</font></span><font color="#000000"> </font><span><font color="#0000ff">static</font></span><font color="#000000"> </font><span><font color="#2b91af">EncryptedLicense</font></span><font color="#000000"> _license;</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#808080">///</font></span><span><font color="#008000"> </font></span></font><span><font style="font-size: 8pt" color="#808080">&lt;summary&gt;</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#808080">///</font></span></font><span><font style="font-size: 8pt" color="#008000"> Helper function to get the path of the license file</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#808080">///</font></span><span><font color="#008000"> </font></span></font><span><font style="font-size: 8pt" color="#808080">&lt;/summary&gt;</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#808080">///</font></span><span><font color="#008000"> </font></span></font><span><font style="font-size: 8pt" color="#808080">&lt;param name=&quot;dllName&quot;&gt;&lt;/param&gt;</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#808080">///</font></span><span><font color="#008000"> </font></span></font><span><font style="font-size: 8pt" color="#808080">&lt;returns&gt;&lt;/returns&gt;</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">private</font></span><font color="#000000"> </font><span><font color="#0000ff">static</font></span><font color="#000000"> </font><span><font color="#0000ff">string</font></span><font color="#000000"> GetPathForDLL(</font><span><font color="#0000ff">string</font></span><font color="#000000"> dllName)</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">string</font></span><font color="#000000"> currentAssemblyLocation = </font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; System.Reflection.</font></font><font style="font-size: 8pt"><span><font color="#2b91af">Assembly</font></span><font color="#000000">.</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; GetExecutingAssembly().Location;</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">string</font></span><font color="#000000"> currentAssemblyPath = System.</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; IO.</font></font><font style="font-size: 8pt"><span><font color="#2b91af">Path</font></span><font color="#000000">.GetDirectoryName(</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; currentAssemblyLocation);</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">return</font></span><font color="#000000"> System.IO.</font><span><font color="#2b91af">Path</font></span><font color="#000000">.Combine(</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; currentAssemblyPath, dllName);</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">public</font></span><font color="#000000"> </font><span><font color="#0000ff">static</font></span><font color="#000000"> </font><span><font color="#0000ff">bool</font></span><font color="#000000"> Licensed</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#0000ff">get</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; {</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; _license = _licenseProvider.GetLicense();</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">while</font></span><font color="#000000"> (_license == </font><span><font color="#0000ff">null</font></span><font color="#000000">)</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// For this tests, I'm using the evaluation</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// version of the infralution there the</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// password cannot be changed</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">EvaluationMonitor</font></span><font color="#000000"> evaluationMonitor = </font><span><font color="#0000ff">new</font></span><font color="#000000"> </font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">RegistryEvaluationMonitor</font></span><font color="#000000">(</font><span><font color="#a31515">&quot;TEST&quot;</font></span><font color="#000000">);</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">EvaluationDialog</font></span><font color="#000000"> evaluationDialog = </font><span><font color="#0000ff">new</font></span><font color="#000000"> </font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">EvaluationDialog</font></span><font color="#000000">();</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// Fully functional for 5 days</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// It's required for the Exchange Store that</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// any application is fully function at download</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// time, even for a short trial period</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; evaluationDialog.TrialDays = 5;</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// Execution delayed after 5 days, but only</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// during 1 extra day</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; evaluationDialog.ExtendedTrialDays = 1;</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; evaluationDialog.ExtendedTrialDelay = </font></font><font style="font-size: 8pt"><span><font color="#0000ff">new</font></span><font color="#000000"> </font><span><font color="#2b91af">TimeSpan</font></span><font color="#000000">(10000);</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// Application name that will appear on the dialog</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// Using the same name used when creating the product</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// on the Infralution License Tracker</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; evaluationDialog.ProductName = </font></font><font style="font-size: 8pt"><span><font color="#a31515">&quot;AutoCAD_Infralution&quot;</font></span><font color="#000000">;</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// Show the license dialog</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">EvaluationDialogResult</font></span><font color="#000000"> dialogResult =</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; evaluationDialog.ShowDialog(evaluationMonitor);</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// Exit the app</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">if</font></span><font color="#000000"> (dialogResult == </font><span><font color="#2b91af">EvaluationDialogResult</font></span><font color="#000000">.Exit)</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">return</font></span><font color="#000000"> </font><span><font color="#0000ff">false</font></span><font color="#000000">;</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// Exit the loop </font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">if</font></span><font color="#000000"> (dialogResult == </font><span><font color="#2b91af">EvaluationDialogResult</font></span><font color="#000000">.Continue)</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">break</font></span><font color="#000000">; </font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// Install the license</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">if</font></span><font color="#000000"> (dialogResult == </font><span><font color="#2b91af">EvaluationDialogResult</font></span><font color="#000000">.InstallLicense)</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">EncryptedLicenseInstallForm</font></span><font color="#000000"> licenseForm = </font><span><font color="#0000ff">new</font></span><font color="#000000"> </font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">EncryptedLicenseInstallForm</font></span><font color="#000000">();</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; _license = licenseForm.ShowDialog(_licenseProvider,</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">null</font></span><font color="#000000">);</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">return</font></span><font color="#000000"> </font><span><font color="#0000ff">true</font></span><font color="#000000">;</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; }</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><span><font face="Courier New"><font style="font-size: 8pt" color="#0000ff">&#160;&#160;&#160; #endregion</font></font></span></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; [</font></font><font style="font-size: 8pt"><span><font color="#2b91af">CommandMethod</font></span><font color="#000000">(</font><span><font color="#a31515">&quot;licensedTestPlugin&quot;</font></span><font color="#000000">)]</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">public</font></span><font color="#000000"> </font><span><font color="#0000ff">static</font></span><font color="#000000"> </font><span><font color="#0000ff">void</font></span><font color="#000000"> CmdMyTestCommand()</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">if</font></span><font color="#000000"> (!Licensed) </font><span><font color="#0000ff">return</font></span><font color="#000000">;</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// If is licensed, show a message</font></span></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">Editor</font></span><font color="#000000"> ed = </font><span><font color="#2b91af">Application</font></span><font color="#000000">.DocumentManager.</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; MdiActiveDocument.Editor;</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</font></font><font style="font-size: 8pt"><span><font color="#a31515">&quot;\nI'm working now&quot;</font></span><font color="#000000">);</font></font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; }</font></font></p>  <p style="margin: 0px; font-family: ; background: white"><font face="Courier New"><font style="font-size: 8pt" color="#000000">}</font></font><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>  <p>After NETLOAD and run the command, it will show the License dialog, like below. Although it would be possible place this license dialog on start-up (i.e. during IExtensionApplication.Initialize execution), this is not recommended. Remember that your application is one of several applications the user can have installed, and show this during AutoCAD start-up/launch can stop the process, slowing the start-up process.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0177437cfed9970d-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="run_command" border="0" alt="run_command" src="/assets/image_744908.jpg" width="491" height="321" /></a></p>  <p>Now to generate the license, go back to Infralution License Tracker, create a New Customer.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0177437cff5d970d-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="new_customer" border="0" alt="new_customer" src="/assets/image_883556.jpg" width="496" height="256" /></a></p>  <p>Then finally at New Sale menu, select the product and the customer, and finally click on ‘Generate’ to create the license key. This key can be sent to the user to license the application. </p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01761696cf03970c-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="new_license" border="0" alt="new_license" src="/assets/image_656516.jpg" width="503" height="372" /></a></p>  <p>It is also possible to do some online activation. For that, it is required a online website running ASP.NET. Just like offline activation, when the user runs the command it will require a key, but the license framework will automatically go online and check it, avoiding duplicated activation.</p>  <p>Have used this solution before? Have used any other solution? Please share your experience, we can create an article on it. </p>  <p>Next article will discuss the Crypto tool.</p>
