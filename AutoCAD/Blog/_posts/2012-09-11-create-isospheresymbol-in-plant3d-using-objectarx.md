---
layout: "post"
title: "Create IsoSphereSymbol in Plant3d using ObjectARX"
date: "2012-09-11 11:29:21"
author: "Fenton Webb"
categories:
  - "2012"
  - "2013"
  - "Fenton Webb"
  - "ObjectARX"
  - "Plant3D"
original_url: "https://adndevblog.typepad.com/autocad/2012/09/create-isospheresymbol-in-plant3d-using-objectarx.html "
typepad_basename: "create-isospheresymbol-in-plant3d-using-objectarx"
typepad_status: "Publish"
---

<p>by <a href="http://adndevblog.typepad.com/autocad/fenton-webb.html">Fenton Webb</a></p>  <p>Iso symbols are not represented in the project database like other piping model objects. They are “markers” that are only used by the Isometrics feature and reside entirely within the DWG file. </p>  <p>Iso symbols are connected to existing fittings via a symbolic ports (not represented in project database) that must be added to the fitting AND to the Isometric symbol itself. No connector entity is involved with symbol connections. </p>  <p>Here is some pseudo code containing additional comments about what needs to be done:&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </p>  <div style="font-family: ; background: white; color: ">   <div style="font-family: ; background: white; color: ">     <div style="font-family: ; background: white; color: ">       <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">// ....</font></font></span></p>        <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">// ....</font></font></span></p>        <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">if</font></font></span><font style="font-size: 8pt"><font color="#000000">(</font><span style="color: "><font color="#020002">Endpoints</font></span><font color="#000000">.</font><span style="color: "><font color="#020002">size</font></span><font color="#000000">() &gt; 0) </font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">{</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#020002">AcPpDb3dIsoSphereSymbol</font></span><font color="#000000">* </font><span style="color: "><font color="#020002">isSymbol</font></span><font color="#000000"> = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#020002">AcPpDb3dIsoSphereSymbol</font></span><font color="#000000">();</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#020002">isSymbol</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#020002">setPosition</font></span><font color="#000000">(</font><span style="color: "><font color="#020002">Endpoints</font></span><font color="#000000">.</font><span style="color: "><font color="#020002">at</font></span><font color="#000000">(0).</font><span style="color: "><font color="#020002">getAcGePoint3d</font></span><font color="#000000">());&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#020002">AcDbObjectId</font></span><font color="#000000"> </font><span style="color: "><font color="#020002">curSpace</font></span><font color="#000000"> = </font><span style="color: "><font color="#020002">curDoc</font></span><font color="#000000">()-&gt;</font><span style="color: "><font color="#020002">database</font></span><font color="#000000">()-&gt;</font><span style="color: "><font color="#020002">currentSpaceId</font></span><font color="#000000">();</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#020002">AcDbBlockTableRecordPointer</font></span><font color="#000000"> </font><span style="color: "><font color="#020002">curSpace</font></span><font color="#000000">(</font><span style="color: "><font color="#020002">curSpace</font></span><font color="#000000">, </font><span style="color: "><font color="#020002">AcDb</font></span><font color="#000000">::</font><span style="color: "><font color="#020002">kForWrite</font></span><font color="#000000">);</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#020002">pBlockTable</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#020002">getAt</font></span><font color="#000000">(</font><span style="color: "><font color="#020002">ACDB_MODEL_SPACE</font></span><font color="#000000">, </font><span style="color: "><font color="#020002">pBlock</font></span><font color="#000000">, </font><span style="color: "><font color="#020002">AcDb</font></span><font color="#000000">::</font><span style="color: "><font color="#020002">kForWrite</font></span><font color="#000000">);&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// TODO:</font></span></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// set isSymbol properties</font></span></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// setBlockId(), setPosition(), setRadius(), setLayer()</font></span></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// add a new symbolic port to</font></span></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">//</font></span></font><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#020002">AcPp3dPort</font></span><font color="#000000"> </font><span style="color: "><font color="#020002">port</font></span><font color="#000000">;</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#020002">port</font></span><font color="#000000">.</font><span style="color: "><font color="#020002">setIsSymbolic</font></span><font color="#000000">(</font><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">);</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#020002">port</font></span><font color="#000000">.</font><span style="color: "><font color="#020002">setPosition</font></span><font color="#000000">(</font><span style="color: "><font color="#020002">isSymbol</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#020002">position</font></span><font color="#000000">());</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#020002">port</font></span><font color="#000000">.</font><span style="color: "><font color="#020002">setDirection</font></span><font color="#000000">(</font><span style="color: "><font color="#020002">AcGeVector3d</font></span><font color="#000000">(0,0,1)); </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// set direction correctly</font></span></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#020002">port</font></span><font color="#000000">.</font><span style="color: "><font color="#020002">setName</font></span><font color="#000000">(</font><span style="color: "><font color="#020002">L</font></span><span style="color: "><font color="#a31515">&quot;Symbolic&quot;</font></span><font color="#000000">);</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#020002">isSymbol</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#020002">addPort</font></span><font color="#000000">(</font><span style="color: "><font color="#020002">port</font></span><font color="#000000">);&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#020002">AcDbObjectId</font></span><font color="#000000"> </font><span style="color: "><font color="#020002">isSymbolBlockId</font></span><font color="#000000">;</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">int</font></span><font color="#000000"> </font><span style="color: "><font color="#020002">appendConnectorEntryError</font></span><font color="#000000"> = </font><span style="color: "><font color="#020002">pBlock</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#020002">appendAcDbEntity</font></span><font color="#000000">(</font><span style="color: "><font color="#020002">isSymbolBlockId</font></span><font color="#000000">, </font><span style="color: "><font color="#020002">isSymbol</font></span><font color="#000000">);</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// TODO:</font></span></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// open the fitting you want to connect to kForWrite; AcPpDb3dPart derived</font></span></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">//&#160; open fitting denoted by pPart below</font></span></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">//</font></span></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#020002">AcPp3dPort</font></span><font color="#000000"> </font><span style="color: "><font color="#020002">port1</font></span><font color="#000000">;</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#020002">port1</font></span><font color="#000000">.</font><span style="color: "><font color="#020002">setIsSymbolic</font></span><font color="#000000">(</font><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">);</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#020002">AcString</font></span><font color="#000000"> </font><span style="color: "><font color="#020002">symbolicPortName</font></span><font color="#000000"> = </font><span style="color: "><font color="#020002">pPart</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#020002">generateDynamicPortName</font></span><font color="#000000">(</font><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">);</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#020002">port1</font></span><font color="#000000">.</font><span style="color: "><font color="#020002">setName</font></span><font color="#000000">(</font><span style="color: "><font color="#020002">symbolicPortName</font></span><font color="#000000">.</font><span style="color: "><font color="#020002">kACharPtr</font></span><font color="#000000">());</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#020002">port1</font></span><font color="#000000">.</font><span style="color: "><font color="#020002">setPosition</font></span><font color="#000000">(</font><span style="color: "><font color="#020002">pSymbol</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#020002">position</font></span><font color="#000000">());</font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// set direction correctly</font></span></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#020002">port1</font></span><font color="#000000">.</font><span style="color: "><font color="#020002">setDirection</font></span><font color="#000000">(</font><span style="color: "><font color="#020002">AcGeVector3d</font></span><font color="#000000">(0,0,-1)); </font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// this is the fitting the iso symbol is going to be connected to</font></span></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#020002">pPart</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#020002">addPort</font></span><font color="#000000">(</font><span style="color: "><font color="#020002">port1</font></span><font color="#000000">);&#160;&#160;&#160;&#160; </font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#020002">isSymbol</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#020002">close</font></span><font color="#000000">(); </font></font></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// TODO: use AcPpDb3dConnectionManager to connect iso symbol to fitting</font></span></font></p>        <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>        <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// port to port1 connection on respective objects&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span></font></p>     </div>      <p style="margin: 0px"><font face="Consolas"><span style="color: "><font style="font-size: 8pt" color="#008000">&#160;</font></span></font></p>   </div> </div>
