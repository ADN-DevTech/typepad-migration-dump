---
layout: "post"
title: "Migration After Fiber is Removed in AutoCAD 2015"
date: "2014-04-17 06:03:29"
author: "Xiaodong Liang"
categories:
  - ".NET"
  - "ObjectARX"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/autocad/2014/04/migration-after-fiber-is-removed-in-autocad-2015.html "
typepad_basename: "migration-after-fiber-is-removed-in-autocad-2015"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>
<p>There’s not that much work needed to port your apps to AutoCAD 2015(Longbow), unless you are using acedCommand or acedCmd.</p>
<p>The following is extracted from our DevDays PPT. If you feel tedious on my repeating the PPT, I’d recommend with the article written by our Blog Master Kean Walmsley : <a href="http://through-the-interface.typepad.com/through_the_interface/2014/03/autocad-2015-calling-commands.html">AutoCAD 2015: calling commands</a>, or the <a href="http://www.youtube.com/watch?v=mEfdozjN62Y">video on the migration</a>, or the demo <a href="https://github.com/ADN-DevTech/AutoCAD-SendCommand">samples codes</a> which is availble at GitHub.</p>
<p><iframe allowfullscreen="" frameborder="0" height="281" src="http://www.youtube.com/embed/mEfdozjN62Y?feature=oembed" width="500"></iframe>&#0160;</p>
<p>For this release, we’ve re-architected AutoCAD to completely strip out the use of Fibers and Fiber switching. Fibers are an old technology used in Windows that Microsoft stopped supporting several years ago. AutoCAD made heavy use of fibers and they are what allowed users to switch easily between drawings without interrupting commands. You’ve probably all seen this in action in old versions of AutoCAD – start a LINE command in one drawing, switch to another and draw a CIRCLE, then switch back to the first drawing and the LINE command is still active.</p>
<p>But using fibers was causing a lot of problems for us that we were spending more and more effort working around. For example, the .NET Framework has never supported Fiber Switching, and this is why when you switched documents in AutoCAD when debugging a .NET application, you’d often find that Visual Studio would fail to stop at a breakpoint– or it did break, but couldn’t display your code. That was Visual Studio getting confused by AutoCAD switching Fibers. You won’t experience that problem in Longbow now that we’ve removed Fibers. It also allows us to expose more of the ObjectARX SDK to .NET – the most exciting of which is that we now have a .NET version of acedCommand ((command) in LISP). That wasn’t possible before due to the problems caused by Fibers.</p>
<p><strong>Migration in ObjectARX</strong></p>
<p>That means ObjectARX has more significant migration requirements. There are two migration areas of concern: the MDI API and use of acedCommand/acedCmd. Then you’ll have to make changes. How big a change depends on how you’re using it.</p>
<p>If you’re passing a complete set of command tokens to the AutoCAD commandline, then all you have to do is add an ‘S’ to the end of acedCommand or acedCmd. S stands for subroutine. This is when you’re sending an entire command, and not pausing for user input.</p>
<p>If you’re sending a PAUSE, or if you’re sending an incomplete set of command tokens (for example starting a line command and leaving it for the user to finish) then you have a lot more work to do. In this situation, you’ll be using acedCommandC – the coroutine version of the command – and you’ll now have to pass a pointer to a callback function as a command parameter. It’s a lot more complicated – so much so that you might even consider migrating your code that needs this to .NET instead.</p>
<p>Here’s an example of the most basic acedCommand usage – its also the most popular use case – where we’re invoking a complete command in a single call to acedCommand. All you have to do here is change acedCommand to acedCommandS.</p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #0000ff;"><span style="font-size: 9pt;">void</span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #000000;"> foo(</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #0000ff;">void</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-size: 9pt; color: #000000;">)</span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">{</span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #000000;"><span style="mso-tab-count: 1;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">acedCommandS(</span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #6f008a;">RTSTR</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-size: 9pt; color: #000000;">, </span></span></span></p>
<p style="line-height: 14pt; text-indent: 81pt; margin: 0cm 0cm 0pt; layout-grid-mode: char; mso-char-indent-count: 9.0;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #6f008a;"><span style="font-size: 9pt;">_T</span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #000000;">(</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #a31515;">&quot;_Line&quot;</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-size: 9pt; color: #000000;">), </span></span></span></p>
<p style="line-height: 14pt; text-indent: 81pt; margin: 0cm 0cm 0pt; layout-grid-mode: char; mso-char-indent-count: 9.0;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #6f008a;"><span style="font-size: 9pt;">RTSTR</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-size: 9pt; color: #000000;">, </span></span></span></p>
<p style="line-height: 14pt; text-indent: 81pt; margin: 0cm 0cm 0pt; layout-grid-mode: char; mso-char-indent-count: 9.0;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #6f008a;"><span style="font-size: 9pt;">_T</span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #000000;">(</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #a31515;">&quot;0,0&quot;</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-size: 9pt; color: #000000;">),</span></span></span></p>
<p style="line-height: 14pt; text-indent: 81pt; margin: 0cm 0cm 0pt; layout-grid-mode: char; mso-char-indent-count: 9.0;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;</span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #6f008a;">RTSTR</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-size: 9pt; color: #000000;">,</span></span></span></p>
<p style="line-height: 14pt; text-indent: 81pt; margin: 0cm 0cm 0pt; layout-grid-mode: char; mso-char-indent-count: 9.0;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;</span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #6f008a;">_T</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #000000;">(</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #a31515;">&quot;111,111&quot;</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-size: 9pt; color: #000000;">), </span></span></span></p>
<p style="line-height: 14pt; text-indent: 81pt; margin: 0cm 0cm 0pt; layout-grid-mode: char; mso-char-indent-count: 9.0;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #6f008a;"><span style="font-size: 9pt;">RTSTR</span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #000000;">, </span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #6f008a;">_T</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #000000;">(</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #a31515;">&quot;&quot;</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-size: 9pt; color: #000000;">),</span></span></span></p>
<p style="line-height: 14pt; text-indent: 81pt; margin: 0cm 0cm 0pt; layout-grid-mode: char; mso-char-indent-count: 9.0;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #6f008a;"><span style="font-size: 9pt;">RTNONE</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-size: 9pt; color: #000000;">); </span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #000000;"><span style="mso-tab-count: 1;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">acutPrintf(</span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #6f008a;">_T</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #000000;">(</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #a31515;">&quot;\n</span></span></span></span><span style="font-size: 9pt;"><span style="color: #a31515;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-family: &#39;Times New Roman&#39;;">Finished LINE command - </span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: 宋体; mso-font-kerning: 12.0pt; mso-fareast-theme-font: minor-fareast; mso-ascii-font-family: 宋体; mso-ascii-theme-font: minor-fareast; mso-hansi-font-family: 宋体; mso-hansi-theme-font: minor-fareast; mso-bidi-font-family: &#39;Times New Roman&#39;;"><span style="font-family: 宋体;"><span style="mso-spacerun: yes;">&#0160;</span>\</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: 宋体; mso-font-kerning: 12.0pt; mso-fareast-theme-font: minor-fareast;"> <br /><span style="mso-spacerun: yes;"><span style="color: #a31515; font-family: &#39;Times New Roman&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #a31515;">control returned to addin\n&quot;</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-size: 9pt; color: #000000;">));</span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">}</span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;">&#0160;</p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;">But a lot of people use acedCommand like this. Starting a command and then prompting for user input until the command ends. In this case we’re starting the LINE command and issuing PAUSEs to allow the user to keep drawing additional line segments. When we migrate this code for Longbow, we have to use acedCommandC, because acedCommandS doesn’t support partial command token stacks or PAUSEs.</p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;">&#0160;</p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;"><span style="color: #0000ff;"><span style="font-size: 9pt;">void</span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;"><span style="color: #000000;"> foo(</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;"><span style="color: #0000ff;">void</span></span><span style="color: #000000;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;">)</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;"><span style="font-size: 9pt; color: #000000;">{</span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #008000;"><span style="mso-tab-count: 1;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">//Invoke partial command and leave command active. </span></span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;"><span style="mso-tab-count: 1;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">acedCommand</span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: 宋体; mso-font-kerning: 12.0pt; mso-fareast-theme-font: minor-fareast; mso-bidi-font-size: 8.0pt;">C(</span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;"><span style="color: #6f008a;">RTSTR</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;"><span style="font-size: 9pt; color: #000000;">, </span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: 宋体; mso-font-kerning: 12.0pt; mso-fareast-theme-font: minor-fareast; mso-bidi-font-size: 8.0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;"><span style="color: #6f008a;">_T</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;"><span style="color: #000000;">(</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;"><span style="color: #a31515;">&quot;_Line&quot;</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;"><span style="font-size: 9pt; color: #000000;">),</span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: 宋体; mso-font-kerning: 12.0pt; mso-fareast-theme-font: minor-fareast; mso-bidi-font-size: 8.0pt;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;"><span style="mso-spacerun: yes;">&#0160;</span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;"><span style="color: #6f008a;">RTSTR</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;"><span style="font-size: 9pt; color: #000000;">,</span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: 宋体; mso-font-kerning: 12.0pt; mso-fareast-theme-font: minor-fareast; mso-bidi-font-size: 8.0pt;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;"><span style="mso-spacerun: yes;">&#0160;</span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;"><span style="color: #6f008a;">_T</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;"><span style="color: #000000;">(</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;"><span style="color: #a31515;">&quot;0,0&quot;</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;"><span style="font-size: 9pt; color: #000000;">),</span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: 宋体; mso-font-kerning: 12.0pt; mso-fareast-theme-font: minor-fareast; mso-bidi-font-size: 8.0pt;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;"><span style="mso-spacerun: yes;">&#0160;</span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;"><span style="mso-spacerun: yes;">&#0160;</span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;"><span style="color: #6f008a;">RTSTR</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;"><span style="font-size: 9pt; color: #000000;">, </span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: 宋体; mso-font-kerning: 12.0pt; mso-fareast-theme-font: minor-fareast; mso-bidi-font-size: 8.0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;"><span style="color: #6f008a;">_T</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;"><span style="color: #000000;">(</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;"><span style="color: #a31515;">&quot;111,111&quot;</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;"><span style="font-size: 9pt; color: #000000;">),</span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: 宋体; mso-font-kerning: 12.0pt; mso-fareast-theme-font: minor-fareast; mso-bidi-font-size: 8.0pt;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;"><span style="mso-spacerun: yes;">&#0160;</span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;"><span style="color: #6f008a;">RTNONE</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;"><span style="color: #000000;">);</span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;"> <br /><span style="mso-spacerun: yes;"><span style="color: #008000; font-family: &#39;Times New Roman&#39;;">&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;"><span style="color: #0000ff;">while</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;"><span style="font-size: 9pt; color: #000000;">(isLineActive())</span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;"><span style="color: #000000;"><span style="mso-tab-count: 2;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">acedCommandC(</span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;"><span style="color: #6f008a;">RTSTR</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;"><span style="font-size: 9pt; color: #000000;">, </span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: 宋体; mso-font-kerning: 12.0pt; mso-fareast-theme-font: minor-fareast; mso-bidi-font-size: 8.0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;"><span style="color: #6f008a;">PAUSE</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;"><span style="font-size: 9pt; color: #000000;">,</span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: 宋体; mso-font-kerning: 12.0pt; mso-fareast-theme-font: minor-fareast; mso-bidi-font-size: 8.0pt;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;"><span style="mso-spacerun: yes;">&#0160;</span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;"><span style="color: #6f008a;">RTNONE</span></span></span></span><span style="font-size: 9pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;"><span style="color: #000000;">); <br /><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160; </span>acutPrintf(</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;"><span style="color: #6f008a;">_T</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;"><span style="color: #000000;">(</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;"><span style="color: #a31515;">&quot;\nFinished LINE command - </span></span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: 宋体; mso-font-kerning: 12.0pt; mso-fareast-theme-font: minor-fareast; mso-ascii-font-family: 宋体; mso-ascii-theme-font: minor-fareast; mso-hansi-font-family: 宋体; mso-hansi-theme-font: minor-fareast; mso-bidi-font-family: &#39;Times New Roman&#39;; mso-bidi-font-size: 8.0pt;"><span style="font-family: 宋体;"><span style="font-size: 9pt;"><span style="color: #a31515;"><span style="mso-spacerun: yes;">&#0160;</span>\</span></span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #a31515;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: 宋体; mso-font-kerning: 12.0pt; mso-fareast-theme-font: minor-fareast; mso-bidi-font-size: 8.0pt;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;">control returned to addin\n&quot;</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;"><span style="font-size: 9pt; color: #000000;">));</span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt; mso-bidi-font-size: 8.0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">}</span></span></span></p>
<p>The migrated code will look something like this. We’ve defined a callback function, which we pass to acedCommandC. Now when AutoCAD is ready to pass control from the user back to you, it will do so by calling the callback function you provided. In this example, the callback function keeps passing itself as a callback until the command ends. If the user cancels the command you invoked using acedCommand, then AutoCAD will also cancel your command that called it. Otherwise, control is handed back to your code when the command invoked by acedCommand ends.</p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #0000ff;"><span style="font-size: 9pt;">void</span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #000000;"> foo(</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #0000ff;">void</span></span><span style="color: #000000;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;">)</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-size: 9pt; color: #000000;">{</span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #008000;"><span style="mso-tab-count: 1;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">//Invoke partial command and leave command active. </span></span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-tab-count: 1;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">acedCommandC(&amp;myCallbackFn, </span></span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: 宋体; mso-font-kerning: 12.0pt; mso-fareast-theme-font: minor-fareast;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #6f008a;">NULL</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #000000;">, </span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #6f008a;">RTSTR</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-size: 9pt; color: #000000;">, </span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: 宋体; mso-font-kerning: 12.0pt; mso-fareast-theme-font: minor-fareast;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #6f008a;">_T</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #000000;">(</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #a31515;">&quot;_Line&quot;</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-size: 9pt; color: #000000;">), </span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: 宋体; mso-font-kerning: 12.0pt; mso-fareast-theme-font: minor-fareast;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #6f008a;">RTSTR</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-size: 9pt; color: #000000;">,</span></span></span></p>
<p style="line-height: 14pt; text-indent: 21pt; margin: 0cm 0cm 0pt 63pt; layout-grid-mode: char;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;</span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #6f008a;">_T</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #000000;">(</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #a31515;">&quot;0,0&quot;</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-size: 9pt; color: #000000;">),</span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: 宋体; mso-font-kerning: 12.0pt; mso-fareast-theme-font: minor-fareast;"><span style="mso-spacerun: yes;"><span style="color: #6f008a;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;">&#0160;</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #6f008a;">RTSTR</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-size: 9pt; color: #000000;">, </span></span></span></p>
<p style="line-height: 14pt; text-indent: 21pt; margin: 0cm 0cm 0pt 63pt; layout-grid-mode: char;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #6f008a;"><span style="font-size: 9pt;">_T</span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #000000;">(</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #a31515;">&quot;111,111&quot;</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-size: 9pt; color: #000000;">), </span></span></span></p>
<p style="line-height: 14pt; text-indent: 21pt; margin: 0cm 0cm 0pt 63pt; layout-grid-mode: char;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #6f008a;"><span style="font-size: 9pt;">RTNONE</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-size: 9pt; color: #000000;">);</span></span></span></p>
<p style="line-height: 14pt; text-indent: 21pt; margin: 0cm 0cm 0pt 63pt; layout-grid-mode: char;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: 宋体; mso-fareast-theme-font: minor-fareast;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #008000;"><span style="mso-tab-count: 1;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">//Control is passed to myCallbackFn1 from AutoCAD</span></span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">}</span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"> <br /></span><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #008000;"><span style="font-size: 9pt;">//Your callback function</span></span><span style="font-size: 9pt;"> <br /></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #0000ff;">int</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #000000;"> myCallbackFn(</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #0000ff;">void</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #000000;"> * </span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #808080;">pData</span></span><span style="color: #000000;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;">)</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-size: 9pt; color: #000000;">{</span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="mso-tab-count: 1;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #0000ff;">int</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #000000;"> nReturn = </span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #6f008a;">RTNONE</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-size: 9pt; color: #000000;">;</span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="mso-tab-count: 1;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-size: 9pt; color: #008000;">//Keep command active until user ends it.</span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;"><span style="mso-tab-count: 1;">&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #0000ff;">if</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-size: 9pt; color: #000000;"> (isLineActive())</span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-tab-count: 2;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">nReturn = acedCommandC(&amp;myCallbackFn, </span></span></span></span></p>
<p style="line-height: 14pt; text-indent: 21pt; margin: 0cm 0cm 0pt 105pt; layout-grid-mode: char;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #6f008a;"><span style="font-size: 9pt;">NULL</span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #000000;">, </span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #6f008a;">RTSTR</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-size: 9pt; color: #000000;">, </span></span></span></p>
<p style="line-height: 14pt; text-indent: 21pt; margin: 0cm 0cm 0pt 105pt; layout-grid-mode: char;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #6f008a;"><span style="font-size: 9pt;">PAUSE</span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #000000;">, </span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #6f008a;">RTNONE</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-size: 9pt; color: #000000;">); </span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="mso-tab-count: 1;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #0000ff;">else</span></span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-tab-count: 1;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">{</span></span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="mso-tab-count: 1;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-size: 9pt; color: #008000;">//This is never reached if the user cancels the command –</span></span></span></p>
<p style="line-height: 14pt; text-indent: 16.8pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #008000;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: 宋体; mso-font-kerning: 12.0pt; mso-fareast-theme-font: minor-fareast;"><span style="font-size: 9pt;">//</span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"> that cancels your command as well.</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-size: 9pt; color: #008000;">It is reached if command is ended</span></span></span></p>
<p style="line-height: 14pt; text-indent: 16.8pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span style="color: #008000;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: 宋体; mso-font-kerning: 12.0pt; mso-fareast-theme-font: minor-fareast; mso-ascii-font-family: 宋体; mso-ascii-theme-font: minor-fareast; mso-hansi-font-family: 宋体; mso-hansi-theme-font: minor-fareast; mso-bidi-font-family: &#39;Times New Roman&#39;;"><span style="font-family: 宋体;"><span style="font-size: 9pt;">//</span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-family: &#39;Times New Roman&#39;;">(e.g. by hitting ENTER)</span></span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="mso-tab-count: 1;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;&#0160;&#0160;&#0160; </span></span></span></span></p>
<p style="line-height: 14pt; text-indent: 16.8pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: 宋体; mso-font-kerning: 12.0pt; mso-fareast-theme-font: minor-fareast;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;">acutPrintf(</span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #6f008a;">_T</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #000000;">(</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #a31515;">&quot;\nFinished LINE command - </span></span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: 宋体; mso-font-kerning: 12.0pt; mso-fareast-theme-font: minor-fareast; mso-ascii-font-family: 宋体; mso-ascii-theme-font: minor-fareast; mso-hansi-font-family: 宋体; mso-hansi-theme-font: minor-fareast; mso-bidi-font-family: &#39;Times New Roman&#39;;"><span style="font-family: 宋体;"><span style="font-size: 9pt;"><span style="color: #a31515;"><span style="mso-spacerun: yes;">&#0160;</span>\</span></span></span></span></p>
<p style="line-height: 14pt; text-indent: 16.8pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #a31515;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: 宋体; mso-font-kerning: 12.0pt; mso-fareast-theme-font: minor-fareast;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;">control returned to addin\n&quot;</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-size: 9pt; color: #000000;">));</span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-tab-count: 1;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">}</span></span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #0000ff;">return</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-size: 9pt; color: #000000;"> nReturn;</span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">}</span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;">&#0160;</p>
<p><strong>Migration in .NET</strong></p>
<p>I would say the most exciting new API in Longbow is the introduction of .NET versions of acedCommand ((command) in LISP). This hasn’t been possible before because of AutoCAD’s use of Fibers – and because the .NET Framework doesn’t support Fibers. So these new APIs – synchronous and asynchronous versions of acedCommand – are now possible for the first time.</p>
<p>acedCommand is probably the most powerful API in ObjectARX. It allows you to embed entire AutoCAD commands within your own commands; and even to invoke partial commands, and then programmatically respond to how the user interacts with those commands. This saves ObjectARX and LISP developers a huge amount of work where otherwise they’d have to reproduce all the native command behavior in their own code – and now .NET developers get the same benefit.</p>
<p>The synchronous version of Command is <span style="font-family: &#39;Times New Roman&#39;;"><strong style="text-justify: inter-ideograph; text-align: justify;"><span lang="EN-US" style="position: relative; text-justify: inter-ideograph; text-align: justify; top: -0.5pt; mso-fareast-font-family: 宋体; mso-font-kerning: 12.0pt; mso-fareast-theme-font: major-fareast; mso-text-raise: .5pt;"><span style="color: #c00000;"><span style="font-size: 9pt;">Editor.</span></span></span></strong><strong style="text-justify: inter-ideograph; text-align: justify;"><span lang="EN-US" style="position: relative; text-justify: inter-ideograph; text-align: justify; top: -0.5pt; mso-fareast-font-family: 宋体; mso-font-kerning: 12.0pt; mso-fareast-theme-font: major-fareast; mso-themecolor: text1; mso-text-raise: .5pt;"><span style="font-size: 9pt; color: #000000;">Command, </span></span></strong></span>the equivalent of the subroutine version of acedCommand. This is how you invoke a complete command from your code. As you can see, the code is very similar to the ObjectARX version – you pass a full set of command tokens to the AutoCAD commandline (the editor), AutoCAD completes the command and immediately returns control back to your code.</p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #008000;">//simple use of Editor.Command</span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #008000;">//most popular case - invoke a whole command with no user interaction</span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #000000;"><span style="font-size: 9pt;">[</span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #2b91af;">CommandMethod</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #000000;">(</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #a31515;">“MyCommand&quot;</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-size: 9pt; color: #000000;">)]</span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #0000ff;"><span style="font-size: 9pt;">public</span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #0000ff;">static</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #0000ff;">void</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-size: 9pt; color: #000000;"> MyMethod()</span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">{</span></span></span></p>
<p style="line-height: 14pt; text-indent: -45pt; margin: 0cm 0cm 0pt 45pt; layout-grid-mode: char; mso-char-indent-count: -5.0;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #2b91af;">Editor</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #000000;"> ed = </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: 宋体; mso-font-kerning: 12.0pt; mso-fareast-theme-font: minor-fareast;"> <br /></span></span><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #2b91af;">Application</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-size: 9pt; color: #000000;">.DocumentManager.MdiActiveDocument.Editor;</span></span></span></p>
<p style="line-height: 14pt; text-indent: 16.8pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #000000;"><span style="font-size: 9pt;">ed.Command(</span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #0000ff;">new</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #2b91af;">Object</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-size: 9pt; color: #000000;">[] { </span></span></span></p>
<p style="line-height: 14pt; text-indent: 48.25pt; margin: 0cm 0cm 0pt; layout-grid-mode: char; mso-char-indent-count: 5.36;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #a31515;"><span style="font-size: 9pt;">&quot;_.LINE&quot;</span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #000000;">, </span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #a31515;">&quot;0,0,0&quot;</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #000000;">, </span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #a31515;">&quot;10,10,0&quot;</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #000000;">, </span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #a31515;">&quot;&quot;</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-size: 9pt; color: #000000;"> });</span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">}</span></span></span></p>
<p>There is also the asynchronous version of Command <span style="font-family: &#39;Times New Roman&#39;;"><strong style="text-justify: inter-ideograph; text-align: justify;"><span lang="EN-US" style="position: relative; text-justify: inter-ideograph; text-align: justify; top: -0.5pt; mso-fareast-font-family: 宋体; mso-font-kerning: 12.0pt; mso-fareast-theme-font: major-fareast; mso-text-raise: .5pt;"><span style="color: #c00000;"><span style="font-size: 9pt;">Editor.</span></span></span></strong><strong style="text-justify: inter-ideograph; text-align: justify;"><span lang="EN-US" style="position: relative; text-justify: inter-ideograph; text-align: justify; top: -0.5pt; mso-fareast-font-family: 宋体; mso-font-kerning: 12.0pt; mso-fareast-theme-font: major-fareast; mso-themecolor: text1; mso-text-raise: .5pt;"><span style="font-size: 9pt; color: #000000;">CommandAsync. T</span></span></strong></span>his is the equivalent of the coroutine version of acedCommand. You’ll recall that acedCommandC required you to pass in a reference to a callback function. The .NET version is a little simpler. Because we’re using .NET Framework 4.5, we can make use of the async and await keywords to greatly simplify our asyncronous code. We mark our .NET commandmethod with the async keyword, and we can then use the await keyword inside that method. The await keyword tells AutoCAD where in your code to return control to after it has finished gathering user input. In this example, we’re simply starting the circle comamnd, using a PAUSE to let the user specify the circle center, and then specifying the circle radius in our code.</p>
<p align="justify" class="MsoNormal" style="text-justify: inter-ideograph; line-height: normal; margin: 0cm 0cm 0pt;">&#0160;</p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #008000;">//Invoke a partial command with user interaction</span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #000000;"><span style="font-size: 9pt;">[</span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #2b91af;">CommandMethod</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #000000;">(</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #a31515;">&quot;DotNetType2&quot;</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-size: 9pt; color: #000000;">)]</span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #0000ff;"><span style="font-size: 9pt;">public</span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #0000ff;">static</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #0000ff;">async</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #0000ff;">void</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-size: 9pt; color: #000000;"> DotNetType2()</span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">{</span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #2b91af;">Editor</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #000000;"> ed = </span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #2b91af;">Application</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-size: 9pt; color: #000000;">.DocumentManager.MdiActiveDocument.Editor;</span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-size: 9pt; color: #008000;">//create a circle of radius 2.0 at chosen location.</span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #0000ff;">await</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #000000;"> ed.CommandAsync(</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #a31515;">&quot;_.CIRCLE&quot;</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-size: 9pt; color: #000000;">);</span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-size: 9pt; color: #008000;">//wait for user input</span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #0000ff;">await</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #000000;"> ed.CommandAsync(</span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #2b91af;">Editor</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-size: 9pt; color: #000000;">.PauseToken);</span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-size: 9pt; color: #008000;">//provide radius input</span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="color: #0000ff;">await</span></span></span><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-size: 9pt; color: #000000;"> ed.CommandAsync(2.0);</span></span></span></p>
<p style="line-height: 14pt; margin: 0cm 0cm 0pt; layout-grid-mode: char;"><span lang="EN-US" style="line-height: 10pt; mso-fareast-font-family: calibri; mso-font-kerning: 12.0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">}</span></span></span></p>
