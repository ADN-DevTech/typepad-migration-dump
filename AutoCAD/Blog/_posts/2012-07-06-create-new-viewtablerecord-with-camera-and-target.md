---
layout: "post"
title: "Create new ViewTableRecord with camera and target"
date: "2012-07-06 07:22:52"
author: "Augusto Goncalves"
categories:
  - ".NET"
  - "Augusto Goncalves"
  - "AutoCAD"
original_url: "https://adndevblog.typepad.com/autocad/2012/07/create-new-viewtablerecord-with-camera-and-target.html "
typepad_basename: "create-new-viewtablerecord-with-camera-and-target"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>This C# example prompts for the target and camera positions. The camera position can be found by passing the direction vector of the ViewTableRecord to the add method of the Point3d target. </p>  <div style="font-family: ; background: white">   <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">[</font></font><font style="font-size: 8pt"><span><font color="#2b91af">CommandMethod</font></span><font color="#000000">(</font><span><font color="#a31515">&quot;sampleCameraView&quot;</font></span><font color="#000000">, </font><span><font color="#2b91af">CommandFlags</font></span><font color="#000000">.Transparent)]</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">public</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span><font color="#0000ff">static</font></span><font color="#000000"> </font><span><font color="#0000ff">void</font></span><font color="#000000"> CmdViewCamera()</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">{</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">Editor</font></span><font color="#000000"> ed = </font><span><font color="#2b91af">Application</font></span><font color="#000000">.DocumentManager.MdiActiveDocument.Editor;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// select the view target</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">PromptPointOptions</font></span><font color="#000000"> ppoView =</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">new</font></span><font color="#000000"> </font><span><font color="#2b91af">PromptPointOptions</font></span><font color="#000000">(</font><span><font color="#a31515">&quot;\nEnter view target: &quot;</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">PromptPointResult</font></span><font color="#000000"> pprView = ed.GetPoint(ppoView);</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">if</font></span><font color="#000000"> (pprView.Status != </font><span><font color="#2b91af">PromptStatus</font></span><font color="#000000">.OK) </font><span><font color="#0000ff">return</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">Point3d</font></span><font color="#000000"> viewPoint = pprView.Value;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// select the camera point</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">PromptPointOptions</font></span><font color="#000000"> ppoCamera = </font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">new</font></span><font color="#000000"> </font><span><font color="#2b91af">PromptPointOptions</font></span><font color="#000000">(</font><span><font color="#a31515">&quot;\nEnter point for camera: &quot;</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">PromptPointResult</font></span><font color="#000000"> pprCamera = ed.GetPoint(ppoCamera);</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">if</font></span><font color="#000000"> (pprView.Status != </font><span><font color="#2b91af">PromptStatus</font></span><font color="#000000">.OK) </font><span><font color="#0000ff">return</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">Point3d</font></span><font color="#000000"> cameraPoint = pprView.Value;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// create the </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">ViewTableRecord</font></span><font color="#000000"> viewTBR = </font><span><font color="#0000ff">new</font></span><font color="#000000"> </font><span><font color="#2b91af">ViewTableRecord</font></span><font color="#000000">();</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; viewTBR.Target = viewPoint;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; viewTBR.ViewDirection = </font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; viewPoint.GetVectorTo(cameraPoint);</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; viewTBR.Height = 50.0;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; viewTBR.CenterPoint = </font></font><font style="font-size: 8pt"><span><font color="#2b91af">Point2d</font></span><font color="#000000">.Origin;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// apply the new view</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; ed.SetCurrentView(viewTBR);</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">#if</font></font></span><font style="font-size: 8pt" color="#000000"> DEBUG</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// for debug...</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 15pt"><font color="#008000" face="Courier New"><font style="font-size: 8pt">&#160; // <a title="http://msdn.microsoft.com/en-us/library/4y6tbswk.aspx" href="http://msdn.microsoft.com/en-us/library/4y6tbswk.aspx">http://msdn.microsoft.com/en-us/library/4y6tbswk.aspx</a></font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">Point3d</font></span><font color="#000000"> cameraPoint3d = viewTBR.Target.Add(viewTBR.ViewDirection);</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; ed.WriteMessage(</font></font><font style="font-size: 8pt"><span><font color="#a31515">&quot;\nCamera X = {0:0.00}&quot;</font></span><font color="#000000">, cameraPoint3d.X);</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; ed.WriteMessage(</font></font><font style="font-size: 8pt"><span><font color="#a31515">&quot;\nCamera Z = {0:0.00}&quot;</font></span><font color="#000000">, cameraPoint3d.Y);</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; ed.WriteMessage(</font></font><font style="font-size: 8pt"><span><font color="#a31515">&quot;\nCamera Z = {0:0.00}&quot;</font></span><font color="#000000">, cameraPoint3d.Z);</font></font></font></p>    <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#0000ff">#endif</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">}</font></font></p> </div>
