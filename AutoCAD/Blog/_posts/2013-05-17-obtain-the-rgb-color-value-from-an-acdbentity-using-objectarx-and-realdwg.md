---
layout: "post"
title: "Obtain the RGB color value from an AcDbEntity using ObjectARX and RealDWG"
date: "2013-05-17 11:42:24"
author: "Fenton Webb"
categories:
  - "2010"
  - "2011"
  - "2012"
  - "2013"
  - "2014"
  - "AutoCAD"
  - "Fenton Webb"
  - "ObjectARX"
  - "RealDWG"
original_url: "https://adndevblog.typepad.com/autocad/2013/05/obtain-the-rgb-color-value-from-an-acdbentity-using-objectarx-and-realdwg.html "
typepad_basename: "obtain-the-rgb-color-value-from-an-acdbentity-using-objectarx-and-realdwg"
typepad_status: "Publish"
---

<p>by <a href="http://adndevblog.typepad.com/autocad/fenton-webb.html">Fenton Webb</a></p>  <p>Hereâ€™s how to obtain the RGB value from an already AcDb::kOpenForRead AcDbEntity.</p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">static</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#010001">COLORREF</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">GetRGBFromEntity</font></span><font color="#000000">( </font><span style="color: "><font color="#010001">AcDbEntity </font></span><font color="#000000">*</font><span style="color: "><font color="#010001">ent</font></span><font color="#000000"> )</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">{</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">COLORREF c</font></span><span style="color: "><font color="#010001">olorRef</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">RGB</font></span><font color="#000000">(255, 255, 255);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">AcCmColor</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">Color</font></span><font color="#000000"> = e</font><span style="color: "><font color="#010001">nt</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#010001">color</font></span><font color="#000000">();</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">AcCmEntityColor</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">ColorMethod</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">ColorMethod</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">Color</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">colorMethod</font></span><font color="#000000">();</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">switch</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">ColorMethod</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160; {</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">case</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">AcCmEntityColor</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">kByACI</font></span><font color="#000000">:</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">long</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">acirgb</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">r</font></span><font color="#000000">,</font><span style="color: "><font color="#010001">g</font></span><font color="#000000">,</font><span style="color: "><font color="#010001">b</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">acirgb</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">AcCmEntityColor</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">lookUpRGB</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">Color</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">colorIndex</font></span><font color="#000000">());</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">b</font></span><font color="#000000"> = ( </font><span style="color: "><font color="#010001">acirgb</font></span><font color="#000000"> &amp; 0xff00L ); </font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">g</font></span><font color="#000000"> = ( </font><span style="color: "><font color="#010001">acirgb</font></span><font color="#000000"> &amp; 0xff00L ) &gt;&gt; 8; </font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">r</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">acirgb</font></span><font color="#000000"> &gt;&gt; 16;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">c<span style="color: "><font color="#010001">olorRef</font></span></font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">RGB</font></span><font color="#000000">( </font><span style="color: "><font color="#010001">r</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">g</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">b</font></span><font color="#000000">);&#160; </font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">break</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160; }</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">c<span style="color: "><font color="#010001">olorRef</font></span></font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">}</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p> </div>
