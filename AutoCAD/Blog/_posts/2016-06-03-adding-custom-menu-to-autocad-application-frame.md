---
layout: "post"
title: "Adding Custom Menu to AutoCAD Application Frame"
date: "2016-06-03 00:15:00"
author: "Madhukar Moogala"
categories:
  - "2016"
  - "AutoCAD"
  - "Marat Mirgaleev"
  - "ObjectARX"
original_url: "https://adndevblog.typepad.com/autocad/2016/06/adding-custom-menu-to-autocad-application-frame.html "
typepad_basename: "adding-custom-menu-to-autocad-application-frame"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/Madhukar-Moogala.html" target="_self">Madhukar Moogala</a></p> <p>AutoCAD 2016 introduced a new class AdApplicationFrame which has exposed a bunch of API to access the application frame.</p> <p>In this blog post we will see how we can create and add our custom menu replacing the existing ‘MENUBAR’.</p> <p>With help of AdApplicationFrame instance we can do our major MFC kind of UI elements in our AutoCAD.</p> <p><strong>Adding Custom menu</strong>:</p> <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b7c86814ee970b-pi"><img title="Custommenu" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="Custommenu" src="/assets/image_902880.jpg" width="462" height="264"></a></p> <div style="font-size: 10pt; font-family: consolas; background: #1e1e1e; color: #dcdcdc"> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #569cd6; line-height: 140%">void</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">testAddCustomMenu</span><span style="color: #b4b4b4; line-height: 140%">()</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">{</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #4ec9b0; line-height: 140%">Acad</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: #4ec9b0; line-height: 140%">ErrorStatus</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">error</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #4ec9b0; line-height: 140%">Acad</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: #b8d7a3; line-height: 140%">eOk</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #4ec9b0; line-height: 140%">AdApplicationFrame</span><span style="color: #b4b4b4; line-height: 140%">*</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">pNewAppFrame</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">acedGetApplicationFrame</span><span style="color: #b4b4b4; line-height: 140%">();</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">pNewAppFrame</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">!=</span><span style="line-height: 140%"> </span><span style="color: #bd63c5; line-height: 140%">NULL</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">?</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">error</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #4ec9b0; line-height: 140%">Acad</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: #b8d7a3; line-height: 140%">eOk</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">:</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">error</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #4ec9b0; line-height: 140%">Acad</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: #b8d7a3; line-height: 140%">eNullPtr</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #4ec9b0; line-height: 140%">HMENU</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">hDefaultMenu</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #bd63c5; line-height: 140%">NULL</span><span style="color: #b4b4b4; line-height: 140%">;</span><span style="line-height: 140%">&nbsp; </span><span style="color: #608b4e; line-height: 140%">/*Needed to restore to Default ACAD Menu*/</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #4ec9b0; line-height: 140%">HMENU</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">hNewMenu</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #bd63c5; line-height: 140%">NULL</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #4ec9b0; line-height: 140%">CString</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">strDirName</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #4ec9b0; line-height: 140%">HMODULE</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">hm</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #bd63c5; line-height: 140%">NULL</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #608b4e; line-height: 140%">/*Switch Acad Resource to Our's*/</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #4ec9b0; line-height: 140%">CAcModuleResourceOverride</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">hResources</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">AcadFrameDLL</span><span style="color: #b4b4b4; line-height: 140%">.</span><span style="color: #c8c8c8; line-height: 140%">ModuleResourceInstance</span><span style="color: #b4b4b4; line-height: 140%">());</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #569cd6; line-height: 140%">if</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #bd63c5; line-height: 140%">eOkVerify</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">error</span><span style="color: #b4b4b4; line-height: 140%">))</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">{</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #608b4e; line-height: 140%">/*To retrieve pointer to Menubar*/</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #4ec9b0; line-height: 140%">AdMenuBar</span><span style="color: #b4b4b4; line-height: 140%">*</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">pMenuBar</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #bd63c5; line-height: 140%">NULL</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">pMenuBar</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">pNewAppFrame</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">GetMenuBar</span><span style="color: #b4b4b4; line-height: 140%">();</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">pMenuBar</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">!=</span><span style="line-height: 140%"> </span><span style="color: #bd63c5; line-height: 140%">NULL</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">?</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">error</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #4ec9b0; line-height: 140%">Acad</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: #b8d7a3; line-height: 140%">eOk</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">:</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">error</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #4ec9b0; line-height: 140%">Acad</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: #b8d7a3; line-height: 140%">eNullPtr</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #569cd6; line-height: 140%">if</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #bd63c5; line-height: 140%">eOkVerify</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">error</span><span style="color: #b4b4b4; line-height: 140%">))</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">{</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">hDefaultMenu</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">pMenuBar</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">GetMenuHandle</span><span style="color: #b4b4b4; line-height: 140%">();</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #569cd6; line-height: 140%">if</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">hDefaultMenu</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">!=</span><span style="line-height: 140%"> </span><span style="color: #b5cea8; line-height: 140%">0</span><span style="color: #b4b4b4; line-height: 140%">)</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">{</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">strDirName</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #bd63c5; line-height: 140%">_T</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #d69d85; line-height: 140%">"D:\\Temp\\AcadFrame\\x64\\Debug\\madAcadFrame.arx"</span><span style="color: #b4b4b4; line-height: 140%">);</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">hm</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #bd63c5; line-height: 140%">GetModuleHandle</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">strDirName</span><span style="color: #b4b4b4; line-height: 140%">);</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #569cd6; line-height: 140%">if</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">hm</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">!=</span><span style="line-height: 140%"> </span><span style="color: #bd63c5; line-height: 140%">NULL</span><span style="color: #b4b4b4; line-height: 140%">)</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">{</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #608b4e; line-height: 140%">// Set custom menu</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">hNewMenu</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #bd63c5; line-height: 140%">LoadMenu</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">hm</span><span style="color: #b4b4b4; line-height: 140%">,</span><span style="line-height: 140%"> </span><span style="color: #bd63c5; line-height: 140%">MAKEINTRESOURCE</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #bd63c5; line-height: 140%">IDR_MENU1</span><span style="color: #b4b4b4; line-height: 140%">));</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #569cd6; line-height: 140%">if</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">hNewMenu</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">!=</span><span style="line-height: 140%"> </span><span style="color: #bd63c5; line-height: 140%">NULL</span><span style="color: #b4b4b4; line-height: 140%">)</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">{</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #569cd6; line-height: 140%">bool</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">bOk</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">pMenuBar</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">SetMenuHandle</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">hNewMenu</span><span style="color: #b4b4b4; line-height: 140%">);</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #569cd6; line-height: 140%">if</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">bOk</span><span style="color: #b4b4b4; line-height: 140%">)</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">pMenuBar</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">UpdateMenu</span><span style="color: #b4b4b4; line-height: 140%">();</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #569cd6; line-height: 140%">else</span><span style="line-height: 140%"> </span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">error</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #4ec9b0; line-height: 140%">Acad</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: #4ec9b0; line-height: 140%">ErrorStatus</span><span style="color: #b4b4b4; line-height: 140%">)</span><span style="color: #4ec9b0; line-height: 140%">Acad</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: #b8d7a3; line-height: 140%">eFailed</span><span style="color: #b4b4b4; line-height: 140%">;</span><span style="line-height: 140%"> </span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">}</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #569cd6; line-height: 140%">else</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">{</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">error</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #4ec9b0; line-height: 140%">Acad</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: #b8d7a3; line-height: 140%">eNullHandle</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">}</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #608b4e; line-height: 140%">// To Revert back to default menu</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #608b4e; line-height: 140%">/* if (pMenuBar-&gt;SetMenuHandle(hDefaultMenu))</span></p> <p style="margin: 0px"><span style="color: #608b4e; line-height: 140%">&nbsp; pMenuBar-&gt;UpdateMenu();</span></p> <p style="margin: 0px"><span style="color: #608b4e; line-height: 140%">&nbsp; else</span></p> <p style="margin: 0px"><span style="color: #608b4e; line-height: 140%">&nbsp; error = (Acad::ErrorStatus)Acad::eFailed;*/</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">}</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #569cd6; line-height: 140%">else</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">error</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #4ec9b0; line-height: 140%">Acad</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: #b8d7a3; line-height: 140%">eNullHandle</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">}</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #569cd6; line-height: 140%">else</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">error</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #4ec9b0; line-height: 140%">Acad</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: #b8d7a3; line-height: 140%">eNullHandle</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">}</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #569cd6; line-height: 140%">else</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">error</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #4ec9b0; line-height: 140%">Acad</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: #b8d7a3; line-height: 140%">eUnrecoverableErrors</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #608b4e; line-height: 140%">/*We will enable MenuBar visibility*/</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #569cd6; line-height: 140%">if</span><span style="color: #b4b4b4; line-height: 140%">(!</span><span style="color: #c8c8c8; line-height: 140%">pNewAppFrame</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">IsMenuBarVisible</span><span style="color: #b4b4b4; line-height: 140%">())</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">pNewAppFrame</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">EnableMenuBar</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #569cd6; line-height: 140%">true</span><span style="color: #b4b4b4; line-height: 140%">);</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">}</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #569cd6; line-height: 140%">else</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">error</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #4ec9b0; line-height: 140%">Acad</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: #b8d7a3; line-height: 140%">eNullPtr</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #c8c8c8; line-height: 140%">acutPrintf</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #bd63c5; line-height: 140%">_T</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #d69d85; line-height: 140%">"\n%s"</span><span style="color: #b4b4b4; line-height: 140%">),</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">acadErrorStatusText</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">error</span><span style="color: #b4b4b4; line-height: 140%">));</span></p> <p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">}</span></p></div> <p>&nbsp;</p> <p>Getting User Credentials:</p> <p>If we user logged in to AutoCAD with A360, we can get user ID and user name using following API’s</p> <p>Earlier it was possible to get same information with CLI ONLINEUSERID and ONLINEUSERNAME</p> <div style="font-size: 10pt; font-family: consolas; background: #1e1e1e; color: #dcdcdc"> <p style="margin: 0px"><span style="color: #569cd6; line-height: 140%">void</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">getUserCredentials</span><span style="color: #b4b4b4; line-height: 140%">()</span></p> <p style="margin: 0px"><span style="color: #b4b4b4; line-height: 140%">{</span></p> <p style="margin: 0px"><span style="color: #4ec9b0; line-height: 140%">Acad</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: #4ec9b0; line-height: 140%">ErrorStatus</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">error</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #4ec9b0; line-height: 140%">Acad</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: #b8d7a3; line-height: 140%">eOk</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px"><span style="color: #4ec9b0; line-height: 140%">AdApplicationFrame</span><span style="color: #b4b4b4; line-height: 140%">*</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">pNewAppFrame</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">acedGetApplicationFrame</span><span style="color: #b4b4b4; line-height: 140%">();</span></p> <p style="margin: 0px"><span style="color: #c8c8c8; line-height: 140%">pNewAppFrame</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">!=</span><span style="line-height: 140%"> </span><span style="color: #bd63c5; line-height: 140%">NULL</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">?</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">error</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #4ec9b0; line-height: 140%">Acad</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: #b8d7a3; line-height: 140%">eOk</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">:</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">error</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #4ec9b0; line-height: 140%">Acad</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: #b8d7a3; line-height: 140%">eNullPtr</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px"><span style="color: #569cd6; line-height: 140%">if</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #bd63c5; line-height: 140%">eOkVerify</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">error</span><span style="color: #b4b4b4; line-height: 140%">))</span></p> <p style="margin: 0px"><span style="color: #b4b4b4; line-height: 140%">{</span></p> <p style="margin: 0px"><span style="color: #4ec9b0; line-height: 140%">CString</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">userId</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px"><span style="color: #4ec9b0; line-height: 140%">CString</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">userName</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="color: #569cd6; line-height: 140%">int</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">bOK</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">-</span><span style="color: #b5cea8; line-height: 140%">1</span><span style="color: #b4b4b4; line-height: 140%">;</span></p> <p style="margin: 0px"><span style="color: #608b4e; line-height: 140%">/*Check if user Logged in to A360*/</span></p> <p style="margin: 0px"><span style="color: #569cd6; line-height: 140%">if</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">pNewAppFrame</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">IsLoggedIn</span><span style="color: #b4b4b4; line-height: 140%">())</span></p> <p style="margin: 0px"><span style="color: #b4b4b4; line-height: 140%">{</span></p> <p style="margin: 0px"><span style="color: #608b4e; line-height: 140%">/*Same can be retrieved using ONLINEUSERID and ONLINEUSERNAME*/</span></p> <p style="margin: 0px"><span style="color: #c8c8c8; line-height: 140%">bOK</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">pNewAppFrame</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">GetLoginUserId</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">userId</span><span style="color: #b4b4b4; line-height: 140%">.</span><span style="color: #c8c8c8; line-height: 140%">GetBuffer</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #bd63c5; line-height: 140%">BUFSIZE</span><span style="color: #b4b4b4; line-height: 140%">),</span><span style="line-height: 140%"> </span><span style="color: #bd63c5; line-height: 140%">BUFSIZE</span><span style="color: #b4b4b4; line-height: 140%">);</span></p> <p style="margin: 0px"><span style="color: #c8c8c8; line-height: 140%">acutPrintf</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #bd63c5; line-height: 140%">_T</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #d69d85; line-height: 140%">"\n user id : [%s]"</span><span style="color: #b4b4b4; line-height: 140%">),</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">userId</span><span style="color: #b4b4b4; line-height: 140%">);</span></p> <p style="margin: 0px"><span style="color: #c8c8c8; line-height: 140%">userId</span><span style="color: #b4b4b4; line-height: 140%">.</span><span style="color: #c8c8c8; line-height: 140%">ReleaseBuffer</span><span style="color: #b4b4b4; line-height: 140%">();</span></p> <p style="margin: 0px"><span style="color: #c8c8c8; line-height: 140%">bOK</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">pNewAppFrame</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">GetLoginUserName</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #c8c8c8; line-height: 140%">userName</span><span style="color: #b4b4b4; line-height: 140%">.</span><span style="color: #c8c8c8; line-height: 140%">GetBuffer</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #bd63c5; line-height: 140%">BUFSIZE</span><span style="color: #b4b4b4; line-height: 140%">),</span><span style="line-height: 140%"> </span><span style="color: #bd63c5; line-height: 140%">BUFSIZE</span><span style="color: #b4b4b4; line-height: 140%">);</span></p> <p style="margin: 0px"><span style="color: #c8c8c8; line-height: 140%">acutPrintf</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #bd63c5; line-height: 140%">_T</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #d69d85; line-height: 140%">"\n user name : [%s]"</span><span style="color: #b4b4b4; line-height: 140%">),</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">userName</span><span style="color: #b4b4b4; line-height: 140%">);</span></p> <p style="margin: 0px"><span style="color: #c8c8c8; line-height: 140%">userName</span><span style="color: #b4b4b4; line-height: 140%">.</span><span style="color: #c8c8c8; line-height: 140%">ReleaseBuffer</span><span style="color: #b4b4b4; line-height: 140%">();</span></p> <p style="margin: 0px"><span style="color: #569cd6; line-height: 140%">int</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">server</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">pNewAppFrame</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: #c8c8c8; line-height: 140%">GetServer</span><span style="color: #b4b4b4; line-height: 140%">();</span></p> <p style="margin: 0px"><span style="color: #c8c8c8; line-height: 140%">acutPrintf</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #bd63c5; line-height: 140%">_T</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #d69d85; line-height: 140%">"\n Server Port : [%d]"</span><span style="color: #b4b4b4; line-height: 140%">),</span><span style="line-height: 140%"> </span><span style="color: #c8c8c8; line-height: 140%">server</span><span style="color: #b4b4b4; line-height: 140%">);</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="color: #b4b4b4; line-height: 140%">}</span></p> <p style="margin: 0px">&nbsp;</p> <p style="margin: 0px"><span style="color: #b4b4b4; line-height: 140%">}</span></p> <p style="margin: 0px"><span style="color: #b4b4b4; line-height: 140%">}</span></p></div>
