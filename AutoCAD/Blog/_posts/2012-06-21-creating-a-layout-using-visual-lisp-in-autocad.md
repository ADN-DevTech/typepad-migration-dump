---
layout: "post"
title: "Creating a Layout using Visual LISP in AutoCAD"
date: "2012-06-21 15:25:55"
author: "Fenton Webb"
categories:
  - "2010"
  - "2011"
  - "2012"
  - "2013"
  - "AutoCAD"
  - "Fenton Webb"
  - "LISP"
original_url: "https://adndevblog.typepad.com/autocad/2012/06/creating-a-layout-using-visual-lisp-in-autocad.html "
typepad_basename: "creating-a-layout-using-visual-lisp-in-autocad"
typepad_status: "Publish"
---

<p>by <a href="http://adndevblog.typepad.com/autocad/fenton-webb.html">Fenton Webb</a></p>  <p>Here’s a nice example that shows how to add a Layout using Visual LISP. It also shows how to set a Plot Style configuration and the Paper Size, and then make the new Layout active…</p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">(</font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">defun</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">c</font></span><font color="#000000">:</font><span style="color: "><font color="#010001">addMyLayout</font></span><font color="#000000"> ()</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; (</font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">vl</font></span><font color="#000000">-</font><span style="color: "><font color="#010001">load</font></span><font color="#000000">-</font><span style="color: "><font color="#010001">com</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; (</font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">setq</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">acadApp</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">vlax</font></span><font color="#000000">-</font><span style="color: "><font color="#010001">get</font></span><font color="#000000">-</font><span style="color: "><font color="#010001">Acad</font></span><font color="#000000">-</font><span style="color: "><font color="#0000ff">object</font></span><font color="#000000">))</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; (</font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">setq</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">acadDoc</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">vla</font></span><font color="#000000">-</font><span style="color: "><font color="#010001">get</font></span><font color="#000000">-</font><span style="color: "><font color="#010001">ActiveDocument</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">acadApp</font></span><font color="#000000">))</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; (</font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">setq</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">layouts</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">vla</font></span><font color="#000000">-</font><span style="color: "><font color="#010001">get</font></span><font color="#000000">-</font><span style="color: "><font color="#010001">Layouts</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">acadDoc</font></span><font color="#000000">))</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#9e7c7c"><font style="font-size: 8pt">&#160; ;; </font><font style="font-size: 8pt"><span style="color: ">Delete</span> <span style="color: ">the</span> <span style="color: ">layout</span> <span style="color: ">named</span> <span style="color: ">&quot;Test&quot;</span> <span style="color: ">if</span> <span style="color: ">it</span> </font><span style="color: "><font style="font-size: 8pt">exists</font></span></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; (</font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">vlax</font></span><font color="#000000">-</font><span style="color: "><font color="#0000ff">for</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">objLayout</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#010001">layouts</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; (</font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (= (</font><span style="color: "><font color="#010001">vla</font></span><font color="#000000">-</font><span style="color: "><font color="#010001">get</font></span><font color="#000000">-</font><span style="color: "><font color="#010001">name</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">objLayout</font></span><font color="#000000">) </font><span style="color: "><font color="#a31515">&quot;Test&quot;</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; (</font></font><span style="color: "><font style="font-size: 8pt" color="#010001">progn</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (</font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">princ</font></span><font color="#000000"> </font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (</font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">strcat</font></span><font color="#000000"> </font><span style="color: "><font color="#a31515">&quot;\nDeleted Layout named &quot;</font></span><font color="#000000"> </font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (</font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">vla</font></span><font color="#000000">-</font><span style="color: "><font color="#010001">get</font></span><font color="#000000">-</font><span style="color: "><font color="#010001">name</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">objLayout</font></span><font color="#000000">) </font><span style="color: "><font color="#a31515">&quot;...&quot;</font></span><font color="#000000"> </font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; )</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; )</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (</font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">vla</font></span><font color="#000000">-</font><span style="color: "><font color="#010001">delete</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">objLayout</font></span><font color="#000000">) ;</font><span style="color: "><font color="#010001">delete</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">the</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#010001">Layout</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (</font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">vlax</font></span><font color="#000000">-</font><span style="color: "><font color="#010001">release</font></span><font color="#000000">-</font><span style="color: "><font color="#0000ff">object</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">objLayout</font></span><font color="#000000">)</font><font color="#9e7c7c"> ; <span style="color: ">release</span> <span style="color: ">the</span> <span style="color: ">Layout</span> </font></font><span style="color: "><font style="font-size: 8pt" color="#9e7c7c">Object</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; );</font></font><span style="color: "><font style="font-size: 8pt" color="#010001">progn</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; )<font color="#9e7c7c">;</font></font></font><span style="color: "><font style="font-size: 8pt" color="#9e7c7c">if</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; ) <font color="#9e7c7c">;</font></font></font><font color="#9e7c7c"><font style="font-size: 8pt"><span style="color: ">vlax</span>-</font><span style="color: "><font style="font-size: 8pt">for</font></span></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; (</font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">setq</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">layoutObj</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">vla</font></span><font color="#000000">-</font><span style="color: "><font color="#010001">add</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">layouts</font></span><font color="#000000"> </font><span style="color: "><font color="#a31515">&quot;Test&quot;</font></span><font color="#000000">))</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;<font color="#9e7c7c"> ;; </font></font></font><font color="#9e7c7c"><font style="font-size: 8pt"><span style="color: ">Assign</span> <span style="color: ">Grayscale</span>.<span style="color: ">CTB</span> <span style="color: ">to</span> <span style="color: ">the</span> </font><span style="color: "><font style="font-size: 8pt">Layout</font></span></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; (</font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">vla</font></span><font color="#000000">-</font><span style="color: "><font color="#010001">put</font></span><font color="#000000">-</font><span style="color: "><font color="#010001">StyleSheet</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">layoutObj</font></span><font color="#000000"> </font><span style="color: "><font color="#a31515">&quot;Grayscale.ctb&quot;</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; <font color="#9e7c7c">;; </font></font></font><font style="font-size: 8pt"><font color="#9e7c7c"><span style="color: ">Assign</span> <span style="color: ">DWF</span> <span style="color: ">configuration</span> <span style="color: ">to</span> <span style="color: ">the</span> <span style="color: ">Layout</span></font><font color="#000000"> </font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; (</font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (= (</font><span style="color: "><font color="#010001">substr</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">vlax</font></span><font color="#000000">-</font><span style="color: "><font color="#010001">variant</font></span><font color="#000000">-</font><span style="color: "><font color="#010001">value</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">vla</font></span><font color="#000000">-</font><span style="color: "><font color="#010001">getvariable</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">acadDoc</font></span><font color="#000000"> </font><span style="color: "><font color="#a31515">&quot;ACADVER&quot;</font></span><font color="#000000">)) 1 2) </font><span style="color: "><font color="#a31515">&quot;15&quot;</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; (</font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">vla</font></span><font color="#000000">-</font><span style="color: "><font color="#010001">put</font></span><font color="#000000">-</font><span style="color: "><font color="#010001">configname</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">layoutObj</font></span><font color="#000000"> </font><span style="color: "><font color="#a31515">&quot;PublishToWeb DWF.pc3&quot;</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; (</font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">vla</font></span><font color="#000000">-</font><span style="color: "><font color="#010001">put</font></span><font color="#000000">-</font><span style="color: "><font color="#010001">configname</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">layoutObj</font></span><font color="#000000"> </font><span style="color: "><font color="#a31515">&quot;DWF6 ePlot.pc3&quot;</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; ) ;</font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">if</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;<font color="#9e7c7c"> ;; </font></font></font><font style="font-size: 8pt"><font color="#9e7c7c"><span style="color: ">Assign</span> <span style="color: ">Paper</span> <span style="color: ">Size</span> <span style="color: ">B</span> <span style="color: ">to</span> <span style="color: ">the</span> <span style="color: ">Layout</span></font><font color="#000000">&#160;&#160; </font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; (</font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">vla</font></span><font color="#000000">-</font><span style="color: "><font color="#010001">put</font></span><font color="#000000">-</font></font><span style="color: "><font style="font-size: 8pt" color="#010001">canonicalmedianame</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#010001">layoutObj</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#a31515">&quot;ANSI_expand_B_(11.00_x_17.00_Inches)&quot;</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160; )</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; <font color="#9e7c7c">;; </font></font></font><font color="#9e7c7c"><font style="font-size: 8pt"><span style="color: ">Make</span> <span style="color: ">the</span> <span style="color: ">new</span> <span style="color: ">Layout</span> </font><span style="color: "><font style="font-size: 8pt">Active</font></span></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; (</font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">vla</font></span><font color="#000000">-</font><span style="color: "><font color="#010001">put</font></span><font color="#000000">-</font><span style="color: "><font color="#010001">activelayout</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">acadDoc</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">layoutObj</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; <font color="#9e7c7c">;; </font></font></font><font color="#9e7c7c"><font style="font-size: 8pt"><span style="color: ">Example</span> <span style="color: ">getting</span> <span style="color: ">StyleSheet</span> <span style="color: ">and</span> <span style="color: ">Configname</span>, <span style="color: ">not</span> <span style="color: ">doing</span> </font><span style="color: "><font style="font-size: 8pt">anything</font></span></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#9e7c7c"><font style="font-size: 8pt">&#160; ;; </font><font style="font-size: 8pt"><span style="color: ">with</span> <span style="color: ">them</span> <span style="color: ">here</span> </font><span style="color: "><font style="font-size: 8pt">however</font></span></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; (</font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">setq</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">currPStyle</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">vla</font></span><font color="#000000">-</font><span style="color: "><font color="#010001">Get</font></span><font color="#000000">-</font><span style="color: "><font color="#010001">StyleSheet</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">layoutObj</font></span><font color="#000000">))</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; (</font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">setq</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">currConfig</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">vla</font></span><font color="#000000">-</font><span style="color: "><font color="#010001">Get</font></span><font color="#000000">-</font><span style="color: "><font color="#010001">configname</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">layoutObj</font></span><font color="#000000">))</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; (</font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">princ</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">)</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p> </div>
