---
layout: "post"
title: "Converting C# to Java â€“ An Experiment (Part 5)"
date: "2012-06-11 08:18:00"
author: "Madhukar Moogala"
categories:
  - "Mobile"
  - "Stephen Preston"
original_url: "https://adndevblog.typepad.com/autocad/2012/06/converting-c-to-java-an-experiment-part-5.html "
typepad_basename: "converting-c-to-java-an-experiment-part-5"
typepad_status: "Publish"
---

<p>By&#0160;<a href="http://adndevblog.typepad.com/autocad/stephen-preston.html">Stephen Preston</a></p>
<p>(Links to previous installments:&#0160;<a href="http://adndevblog.typepad.com/autocad/2012/05/converting-c-to-java-an-experiment-part-1.html" target="_self">Part 1</a>;&#0160;<a href="http://adndevblog.typepad.com/autocad/2012/05/converting-c-to-java-an-experiment-part-1-1.html" target="_self">Part 2</a>;&#0160;<a href="http://adndevblog.typepad.com/autocad/2012/05/converting-c-to-java-an-experiment-part-3.html" target="_self">Part 3</a>; <a href="http://adndevblog.typepad.com/autocad/2012/06/converting-c-to-java-an-experiment-part-4.html" target="_self">Part 4</a>).</p>
<p>Last time, we hooked up a simple Android UI to display a few hardcoded Items in a ListView. Today we&#39;ll add some functionality to allow us to add or edit items in the list. I&#39;ve decided to implement a footer to the ListView that will contain a button to add items. I&#39;ll also respond to someone clicking an item in the list to edit that item. Both those actions will launch a new screen - and that is the main focus of today&#39;s post:</p>
<p style="padding-left: 30px;">Switching control from one screen/layout to another using an <a href="http://developer.android.com/reference/android/content/Intent.html" target="_blank">Intent</a> (and then returning control back to the original screen).</p>
<p>First, let&#39;s create the XML for our new screen. Create a new Android XML file called &#39;edititem&#39; and copy this XML into it:</p>
<p><span style="color: #000000;">&lt;?xml&#0160;version=</span><span style="color: #2a00ff;">&quot;1.0&quot;&#0160;</span><span style="color: #000000;">encoding=</span><span style="color: #2a00ff;">&quot;utf-8&quot;</span><span style="color: #000000;">?&gt;</span><br /> <span style="color: #000000;">&lt;LinearLayout&#0160;xmlns:android=</span><span style="color: #2a00ff;">&quot;http://schemas.android.com/apk/res/android&quot;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">android:layout_width=</span><span style="color: #2a00ff;">&quot;match_parent&quot;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">android:layout_height=</span><span style="color: #2a00ff;">&quot;match_parent&quot;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">android:orientation=</span><span style="color: #2a00ff;">&quot;vertical&quot;&#0160;</span><span style="color: #000000;">&gt;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">&lt;EditText</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">android:id=</span><span style="color: #2a00ff;">&quot;@+id/EditItemText&quot;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">android:layout_width=</span><span style="color: #2a00ff;">&quot;match_parent&quot;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">android:layout_height=</span><span style="color: #2a00ff;">&quot;wrap_content&quot;&#0160;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">android:singleLine=</span><span style="color: #2a00ff;">&quot;true&quot;&#0160;</span><span style="color: #000000;">&gt;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">&lt;requestFocus&#0160;/&gt;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">&lt;/EditText&gt;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">&lt;LinearLayout</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">android:id=</span><span style="color: #2a00ff;">&quot;@+id/linearLayout1&quot;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">android:layout_width=</span><span style="color: #2a00ff;">&quot;match_parent&quot;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">android:layout_height=</span><span style="color: #2a00ff;">&quot;wrap_content&quot;&#0160;</span><span style="color: #000000;">&gt;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">&lt;Button</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">android:id=</span><span style="color: #2a00ff;">&quot;@+id/buttonEditCancel&quot;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">android:layout_width=</span><span style="color: #2a00ff;">&quot;fill_parent&quot;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">android:layout_height=</span><span style="color: #2a00ff;">&quot;wrap_content&quot;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">android:text=</span><span style="color: #2a00ff;">&quot;Cancel&quot;&#0160;</span><span style="color: #000000;">android:gravity=</span><span style="color: #2a00ff;">&quot;center&quot;&#0160;</span><span style="color: #000000;">android:layout_weight=</span><span style="color: #2a00ff;">&quot;1&quot;&#0160;</span><span style="color: #000000;">android:onClick=</span><span style="color: #2a00ff;">&quot;onCancelButtonClick&quot;</span><span style="color: #000000;">/&gt;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">&lt;Button</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">android:id=</span><span style="color: #2a00ff;">&quot;@+id/buttonEditOk&quot;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">android:layout_width=</span><span style="color: #2a00ff;">&quot;fill_parent&quot;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">android:layout_height=</span><span style="color: #2a00ff;">&quot;wrap_content&quot;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">android:text=</span><span style="color: #2a00ff;">&quot;Ok&quot;&#0160;</span><span style="color: #000000;">android:gravity=</span><span style="color: #2a00ff;">&quot;center&quot;&#0160;</span><span style="color: #000000;">android:layout_weight=</span><span style="color: #2a00ff;">&quot;1&quot;&#0160;</span><span style="color: #000000;">android:onClick=</span><span style="color: #2a00ff;">&quot;onOkButtonClick&quot;</span><span style="color: #000000;">/&gt;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">&lt;/LinearLayout&gt;</span><br /> <span style="color: #000000;">&lt;/LinearLayout&gt;</span></p>
<p><em>I&#39;m being a bit naughty here by using hardcoded strings instead of adding new string resources to the project &#39;strings.xml&#39; file. This is just for the convenience of documenting steps in this blog. You should reference resources for all text that appears in your Android app so you can easily localize it later.</em></p>
<p><em>For that matter, I&#39;m probably inadvertently ignoring other Java/Android best practices simply because I&#39;m learning this as I go along.</em></p>
<p>Now we want to create a new Activity class to display this layout. We&#39;ll call this ItemEditActivity:</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b016306432b13970d-pi" style="display: inline;"><img alt="Pt5ItemEditActivity" class="asset  asset-image at-xid-6a0167607c2431970b016306432b13970d" src="/assets/image_572131.jpg" style="display: block; margin-left: auto; margin-right: auto;" title="Pt5ItemEditActivity" /></a></p>
<p>Here is the code to put in ItemEditActivity.java:</p>
<p><span style="color: #7f0055;"><strong>package&#0160;</strong></span><span style="color: #000000;">Preston.Stephen.Prioritizer;</span><br /> <span style="color: #ffffff;">&#0160;</span><br /> <span style="color: #7f0055;"><strong>import&#0160;</strong></span><span style="color: #000000;">android.app.Activity;</span><br /> <span style="color: #7f0055;"><strong>import&#0160;</strong></span><span style="color: #000000;">android.content.Intent;</span><br /> <span style="color: #7f0055;"><strong>import&#0160;</strong></span><span style="color: #000000;">android.os.Bundle;</span><br /> <span style="color: #7f0055;"><strong>import&#0160;</strong></span><span style="color: #000000;">android.view.KeyEvent;</span><br /> <span style="color: #7f0055;"><strong>import&#0160;</strong></span><span style="color: #000000;">android.view.View;</span><br /> <span style="color: #7f0055;"><strong>import&#0160;</strong></span><span style="color: #000000;">android.view.inputmethod.EditorInfo;</span><br /> <span style="color: #7f0055;"><strong>import&#0160;</strong></span><span style="color: #000000;">android.widget.Button;</span><br /> <span style="color: #7f0055;"><strong>import&#0160;</strong></span><span style="color: #000000;">android.widget.EditText;</span><br /> <span style="color: #7f0055;"><strong>import&#0160;</strong></span><span style="color: #000000;">android.widget.TextView;</span><br /> <span style="color: #7f0055;"><strong>import&#0160;</strong></span><span style="color: #000000;">android.widget.TextView.OnEditorActionListener;</span><br /> <br /> <span style="color: #7f0055;"><strong>public&#0160;class&#0160;</strong></span><span style="color: #000000;">ItemEditActivity&#0160;</span><span style="color: #7f0055;"><strong>extends&#0160;</strong></span><span style="color: #000000;">Activity&#0160;</span><span style="color: #000000;">{</span><br /> <span style="color: #ffffff;">&#0160;&#0160;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;</span><span style="color: #7f0055;"><strong>private&#0160;</strong></span><span style="color: #7f0055;"><strong>int&#0160;</strong></span><span style="color: #000000;">m_row;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;</span><span style="color: #7f0055;"><strong>private&#0160;</strong></span><span style="color: #000000;">String&#0160;m_itemText;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;</span><span style="color: #3f5fbf;">/**&#0160;Called&#0160;when&#0160;the&#0160;activity&#0160;is&#0160;first&#0160;created.&#0160;*/</span><br /> <span style="color: #ffffff;">&#0160;&#0160;</span><span style="color: #646464;">@Override</span><br /> <span style="color: #ffffff;">&#0160;&#0160;</span><span style="color: #7f0055;"><strong>public&#0160;</strong></span><span style="color: #7f0055;"><strong>void&#0160;</strong></span><span style="color: #000000;">onCreate</span><span style="color: #000000;">(</span><span style="color: #000000;">Bundle&#0160;savedInstanceState</span><span style="color: #000000;">)&#0160;{</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #7f0055;"><strong>super</strong></span><span style="color: #000000;">.onCreate</span><span style="color: #000000;">(</span><span style="color: #000000;">savedInstanceState</span><span style="color: #000000;">)</span><span style="color: #000000;">;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">setContentView</span><span style="color: #000000;">(</span><span style="color: #000000;">R.layout.edititem</span><span style="color: #000000;">)</span><span style="color: #000000;">;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">EditText&#0160;editView&#0160;=&#0160;</span><span style="color: #000000;">(</span><span style="color: #000000;">EditText</span><span style="color: #000000;">)</span><span style="color: #000000;">findViewById</span><span style="color: #000000;">(</span><span style="color: #000000;">R.id.EditItemText</span><span style="color: #000000;">)</span><span style="color: #000000;">;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #3f7f5f;">//Retrieve&#0160;data&#0160;passed&#0160;to&#0160;this&#0160;Activity&#0160;from&#0160;the&#0160;calling&#0160;Activity.</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #3f7f5f;">//This&#0160;is&#0160;stored&#0160;in&#0160;the&#0160;Intent</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">Bundle&#0160;extras&#0160;=&#0160;getIntent</span><span style="color: #000000;">()</span><span style="color: #000000;">.getExtras</span><span style="color: #000000;">()</span><span style="color: #000000;">;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">m_itemText&#0160;=&#0160;extras.getString</span><span style="color: #000000;">(</span><span style="color: #000000;">CSMigrationTestActivity.INTENT_ITEM_TEXT</span><span style="color: #000000;">)</span><span style="color: #000000;">;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #3f7f5f;">//If&#0160;data&#0160;(the&#0160;Item&#0160;name)&#0160;was&#0160;passed,&#0160;put&#0160;this&#0160;in&#0160;the&#0160;editbox.</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #7f0055;"><strong>if&#0160;</strong></span><span style="color: #000000;">(</span><span style="color: #000000;">m_itemText&#0160;!=&#0160;</span><span style="color: #7f0055;"><strong>null</strong></span><span style="color: #000000;">)&#0160;{</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">editView.setText</span><span style="color: #000000;">(</span><span style="color: #000000;">m_itemText</span><span style="color: #000000;">)</span><span style="color: #000000;">;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">}</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #3f7f5f;">//We&#0160;also&#0160;pass&#0160;the&#0160;row&#0160;in&#0160;the&#0160;list&#0160;this&#0160;Item&#0160;was&#0160;stored&#0160;in,&#0160;so&#0160;the&#0160;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #3f7f5f;">//&#0160;calling&#0160;Activity&#0160;can&#0160;update&#0160;the&#0160;correct&#0160;Item&#0160;when&#0160;we&#0160;return</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">m_row&#0160;=&#0160;extras.getInt</span><span style="color: #000000;">(</span><span style="color: #000000;">CSMigrationTestActivity.INTENT_ITEM_ROW</span><span style="color: #000000;">)</span><span style="color: #000000;">;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #3f7f5f;">//This&#0160;code&#0160;is&#0160;to&#0160;make&#0160;the&#0160;Activity&#0160;interpret&#0160;Enter&#0160;being&#0160;pressed&#0160;as&#0160;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #3f7f5f;">//&#0160;clicking&#0160;ok&#0160;to&#0160;dismiss&#0160;the&#0160;screen</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">editView.setOnEditorActionListener</span><span style="color: #000000;">(</span><span style="color: #7f0055;"><strong>new&#0160;</strong></span><span style="color: #000000;">OnEditorActionListener</span><span style="color: #000000;">()&#0160;{</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #7f0055;"><strong>public&#0160;</strong></span><span style="color: #7f0055;"><strong>boolean&#0160;</strong></span><span style="color: #000000;">onEditorAction</span><span style="color: #000000;">(</span><span style="color: #000000;">TextView&#0160;v,&#0160;</span><span style="color: #7f0055;"><strong>int&#0160;</strong></span><span style="color: #000000;">actionId,&#0160;KeyEvent&#0160;event</span><span style="color: #000000;">)&#0160;{</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #7f0055;"><strong>if&#0160;</strong></span><span style="color: #000000;">(</span><span style="color: #000000;">actionId&#0160;==&#0160;EditorInfo.IME_ACTION_DONE</span><span style="color: #000000;">)&#0160;{</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">Button&#0160;okButton&#0160;=&#0160;</span><span style="color: #000000;">(</span><span style="color: #000000;">Button</span><span style="color: #000000;">)</span><span style="color: #000000;">findViewById</span><span style="color: #000000;">(</span><span style="color: #000000;">R.id.buttonEditOk</span><span style="color: #000000;">)</span><span style="color: #000000;">;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">okButton.performClick</span><span style="color: #000000;">()</span><span style="color: #000000;">;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #7f0055;"><strong>return&#0160;true</strong></span><span style="color: #000000;">;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">}&#0160;&#0160;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #7f0055;"><strong>return&#0160;false</strong></span><span style="color: #000000;">;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">}</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">})</span><span style="color: #000000;">;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;</span><span style="color: #000000;">}</span><br /> <br /> <span style="color: #ffffff;">&#0160;&#0160;</span><span style="color: #3f7f5f;">//Handler&#0160;function&#0160;for&#0160;Ok&#0160;button&#0160;click</span><br /> <span style="color: #ffffff;">&#0160;&#0160;</span><span style="color: #3f7f5f;">//Returns&#0160;updated&#0160;text&#0160;data.</span><br /> <span style="color: #ffffff;">&#0160;&#0160;</span><span style="color: #7f0055;"><strong>public&#0160;</strong></span><span style="color: #7f0055;"><strong>void&#0160;</strong></span><span style="color: #000000;">onOkButtonClick</span><span style="color: #000000;">(</span><span style="color: #000000;">View&#0160;v</span><span style="color: #000000;">)&#0160;{</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">EditText&#0160;editView&#0160;=&#0160;</span><span style="color: #000000;">(</span><span style="color: #000000;">EditText</span><span style="color: #000000;">)</span><span style="color: #000000;">findViewById</span><span style="color: #000000;">(</span><span style="color: #000000;">R.id.EditItemText</span><span style="color: #000000;">)</span><span style="color: #000000;">;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">String&#0160;txt&#0160;=&#0160;editView.getText</span><span style="color: #000000;">()</span><span style="color: #000000;">.toString</span><span style="color: #000000;">()</span><span style="color: #000000;">;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #7f0055;"><strong>if&#0160;</strong></span><span style="color: #000000;">(</span><span style="color: #000000;">!</span><span style="color: #000000;">(</span><span style="color: #000000;">m_itemText&#0160;==&#0160;txt</span><span style="color: #000000;">))&#0160;{</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">Intent&#0160;i&#0160;=&#0160;</span><span style="color: #7f0055;"><strong>new&#0160;</strong></span><span style="color: #000000;">Intent</span><span style="color: #000000;">()</span><span style="color: #000000;">;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">i.putExtra</span><span style="color: #000000;">(</span><span style="color: #000000;">CSMigrationTestActivity.INTENT_ITEM_TEXT,&#0160;txt</span><span style="color: #000000;">)</span><span style="color: #000000;">;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">i.putExtra</span><span style="color: #000000;">(</span><span style="color: #000000;">CSMigrationTestActivity.INTENT_ITEM_ROW,&#0160;m_row</span><span style="color: #000000;">)</span><span style="color: #000000;">;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">setResult</span><span style="color: #000000;">(</span><span style="color: #000000;">RESULT_OK,&#0160;i</span><span style="color: #000000;">)</span><span style="color: #000000;">;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">}</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #7f0055;"><strong>else&#0160;</strong></span><span style="color: #000000;">{</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">setResult</span><span style="color: #000000;">(</span><span style="color: #000000;">RESULT_CANCELED</span><span style="color: #000000;">)</span><span style="color: #000000;">;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">}</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">finish</span><span style="color: #000000;">()</span><span style="color: #000000;">;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">}</span><br /> <br /> <span style="color: #ffffff;">&#0160;&#0160;</span><span style="color: #3f7f5f;">//Handler&#0160;function&#0160;for&#0160;Cancel&#0160;button&#0160;click</span><br /> <span style="color: #ffffff;">&#0160;</span><span style="color: #7f0055;"><strong>public&#0160;</strong></span><span style="color: #7f0055;"><strong>void&#0160;</strong></span><span style="color: #000000;">onCancelButtonClick</span><span style="color: #000000;">(</span><span style="color: #000000;">View&#0160;v</span><span style="color: #000000;">)&#0160;{</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">setResult</span><span style="color: #000000;">(</span><span style="color: #000000;">RESULT_CANCELED</span><span style="color: #000000;">)</span><span style="color: #000000;">;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">finish</span><span style="color: #000000;">()</span><span style="color: #000000;">;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;</span><span style="color: #000000;">}</span><br /> <span style="color: #ffffff;">&#0160;&#0160;</span><br /> <span style="color: #000000;">}</span></p>
<p>Eclipse reports some errors in this code because there are some static items we have to add to CSMigrationTestActivity.</p>
<p>The above code demonstrates two ways to respond to events in Java/Android:</p>
<ul>
<li>The first way is to add a <a href="http://developer.android.com/guide/topics/ui/ui-events.html" target="_blank">Listener</a> function in your code. You can see this in the call to editView.SetOnEditorActionListener.&#0160;</li>
<li>The second way is to specify it in the layout XML. See the android:onClick attributes in the Button elements of edititem.xml. The function names written there match the function names in our Activity implementation (onOkButtonClick and onCancelButtonClick).&#0160;</li>
</ul>
<p><em>BTW I worked through the basic <a href="http://developer.android.com/resources/tutorials/notepad/index.html" target="_blank">Notepad tutorial on the Android Developer Center</a> to understand both Listeners and switching control to new Activities.</em></p>
<ul>
</ul>
<p>Now we&#39;ve created a new Activity, we have make sure the Android OS knows about it, so we add it to the app&#39;s manifest file. Double-click AndroidManifest.xml now:</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0163064348c5970d-pi" style="display: inline;"><img alt="Pt5Manifest1" class="asset  asset-image at-xid-6a0167607c2431970b0163064348c5970d" src="/assets/image_214202.jpg" style="display: block; margin-left: auto; margin-right: auto;" title="Pt5Manifest1" /></a><br />Then scroll down and click the Application link:</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b016306434e03970d-pi" style="display: inline;"><img alt="Pt5Manifest2" class="asset  asset-image at-xid-6a0167607c2431970b016306434e03970d" src="/assets/image_106618.jpg" style="display: block; margin-left: auto; margin-right: auto;" title="Pt5Manifest2" /></a></p>
<p>In the ApplicationNodes section, click the Add button, select Activity, and click Ok:</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0163064356be970d-pi" style="display: inline;"><img alt="Pt5Manifest3" class="asset  asset-image at-xid-6a0167607c2431970b0163064356be970d" src="/assets/image_182608.jpg" style="display: block; margin-left: auto; margin-right: auto;" title="Pt5Manifest3" /></a><br />Select the entry you just added to the list, click the Browse button by the Name editbox, select ItemEditActivity and click Ok. The other parameters are optional, but you can populate them if you like.</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01676736eb7d970b-pi" style="display: inline;"><img alt="Pt5Manifest4" class="asset  asset-image at-xid-6a0167607c2431970b01676736eb7d970b" src="/assets/image_885106.jpg" style="display: block; margin-left: auto; margin-right: auto;" title="Pt5Manifest4" /></a><br />Make sure you save the manifest when you&#39;re done.</p>
<p><em>Its easy to forget to update the manifest when you add a new Activity. If you find your app is crashing when you try to launch a new Activity, then the manifest is the first thing to check.</em></p>
<p>Next we want to add a button to our main view that will display this second view. Create another layout XML called footer.xml, and edit the XML to:</p>
<p><span style="color: #000000;">&lt;?xml&#0160;version=</span><span style="color: #2a00ff;">&quot;1.0&quot;&#0160;</span><span style="color: #000000;">encoding=</span><span style="color: #2a00ff;">&quot;utf-8&quot;</span><span style="color: #000000;">?&gt;</span><br /> <span style="color: #000000;">&lt;LinearLayout&#0160;xmlns:android=</span><span style="color: #2a00ff;">&quot;http://schemas.android.com/apk/res/android&quot;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">android:layout_width=</span><span style="color: #2a00ff;">&quot;match_parent&quot;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">android:layout_height=</span><span style="color: #2a00ff;">&quot;match_parent&quot;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">android:orientation=</span><span style="color: #2a00ff;">&quot;vertical&quot;&#0160;</span><span style="color: #000000;">&gt;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">&lt;Button</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">android:id=</span><span style="color: #2a00ff;">&quot;@+id/AddButton&quot;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">android:layout_width=</span><span style="color: #2a00ff;">&quot;fill_parent&quot;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">android:layout_height=</span><span style="color: #2a00ff;">&quot;wrap_content&quot;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">android:text=</span><span style="color: #2a00ff;">&quot;Add&#0160;Items&quot;&#0160;</span><span style="color: #000000;">android:layout_gravity=</span><span style="color: #2a00ff;">&quot;center&quot;&#0160;</span><span style="color: #000000;">android:gravity=</span><span style="color: #2a00ff;">&quot;center&quot;&#0160;</span><span style="color: #000000;">android:clickable=</span><span style="color: #2a00ff;">&quot;true&quot;&#0160;</span><span style="color: #000000;">android:soundEffectsEnabled=</span><span style="color: #2a00ff;">&quot;true&quot;</span><span style="color: #000000;">/&gt;</span><br /> <span style="color: #000000;">&lt;/LinearLayout&gt;</span></p>
<p>Open CSMigrationTestActivity.java and add the code highlighted in yellow in this full listing for the class:</p>
<p><span style="color: #7f0055;"><strong>package&#0160;</strong></span><span style="color: #000000;">Preston.Stephen.Prioritizer;</span><br /> <span style="color: #ffffff;">&#0160;</span><br /> <span style="color: #7f0055;"><strong>import&#0160;</strong></span><span style="color: #000000;">Preston.Stephen.Prioritizer.MyAdapter;</span><br /> <span style="color: #7f0055;"><strong>import&#0160;</strong></span><span style="color: #000000;">Preston.Stephen.Prioritizer.R;</span><br /> <span style="color: #7f0055;"><strong>import&#0160;</strong></span><span style="color: #000000;">Preston.Stephen.Prioritizer.ItemEditActivity;</span><br /> <span style="color: #7f0055;"><strong>import&#0160;</strong></span><span style="color: #000000;">android.app.Activity;</span><br /> <span style="color: #7f0055;"><strong>import&#0160;</strong></span><span style="color: #000000;">android.content.Intent;</span><br /> <span style="color: #7f0055;"><strong>import&#0160;</strong></span><span style="color: #000000;">android.os.Bundle;</span><br /> <span style="color: #7f0055;"><strong>import&#0160;</strong></span><span style="color: #000000;">android.view.LayoutInflater;</span><br /> <span style="color: #7f0055;"><strong>import&#0160;</strong></span><span style="color: #000000;">android.view.View;</span><br /> <span style="color: #7f0055;"><strong>import&#0160;</strong></span><span style="color: #000000;">android.view.View.OnClickListener;</span><br /> <span style="color: #7f0055;"><strong>import&#0160;</strong></span><span style="color: #000000;">android.widget.AdapterView;</span><br /> <span style="color: #7f0055;"><strong>import&#0160;</strong></span><span style="color: #000000;">android.widget.ListView;</span><br /> <span style="color: #7f0055;"><strong>import&#0160;</strong></span><span style="color: #000000;">android.widget.TextView;</span><br /> <span style="color: #7f0055;"><strong>import&#0160;</strong></span><span style="color: #000000;">android.widget.AdapterView.OnItemClickListener;</span><br /> <br /> <span style="color: #7f0055;"><strong>public&#0160;class&#0160;</strong></span><span style="color: #000000;">CSMigrationTestActivity&#0160;</span><span style="color: #7f0055;"><strong>extends&#0160;</strong></span><span style="color: #000000;">Activity&#0160;</span><span style="color: #000000;">{</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #3f5fbf;">/**&#0160;Called&#0160;when&#0160;the&#0160;activity&#0160;is&#0160;first&#0160;created.&#0160;*/</span><br /> <span style="color: #ffffff;">&#0160;&#0160;</span><br /> <span style="background-color: #ffff00;"><span style="color: #ffffff;">&#0160;&#0160;</span><span style="color: #3f7f5f;">//constants</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;</span><span style="color: #7f0055;"><strong>public&#0160;static&#0160;final&#0160;</strong></span><span style="color: #000000;">String&#0160;INTENT_ITEM_TEXT&#0160;=&#0160;</span><span style="color: #2a00ff;">&quot;_id&quot;</span><span style="color: #000000;">;&#0160;&#0160;</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;</span><span style="color: #7f0055;"><strong>public&#0160;static&#0160;final&#0160;</strong></span><span style="color: #000000;">String&#0160;INTENT_ITEM_ROW&#0160;=&#0160;</span><span style="color: #2a00ff;">&quot;_row&quot;</span><span style="color: #000000;">;&#0160;&#0160;</span></span><br /> <span style="color: #ffffff;">&#0160;&#0160;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;</span><span style="color: #3f7f5f;">//Member&#0160;variables</span><br /> <span style="color: #ffffff;">&#0160;&#0160;</span><span style="color: #7f0055;"><strong>private&#0160;</strong></span><span style="color: #000000;">ListView&#0160;m_listView;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;</span><span style="color: #7f0055;"><strong>private&#0160;</strong></span><span style="color: #000000;">MyAdapter&#0160;m_adapter;</span><br /> <span style="color: #ffffff; background-color: #ffff00;">&#0160;&#0160;</span><span style="background-color: #ffff00;"><span style="color: #7f0055;"><strong>private&#0160;</strong></span><span style="color: #000000;">View&#0160;m_footerView;</span></span><br /> <span style="color: #ffffff;">&#0160;&#0160;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #646464;">@Override</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #7f0055;"><strong>public&#0160;</strong></span><span style="color: #7f0055;"><strong>void&#0160;</strong></span><span style="color: #000000;">onCreate</span><span style="color: #000000;">(</span><span style="color: #000000;">Bundle&#0160;savedInstanceState</span><span style="color: #000000;">)&#0160;{</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #7f0055;"><strong>super</strong></span><span style="color: #000000;">.onCreate</span><span style="color: #000000;">(</span><span style="color: #000000;">savedInstanceState</span><span style="color: #000000;">)</span><span style="color: #000000;">;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">setContentView</span><span style="color: #000000;">(</span><span style="color: #000000;">R.layout.main</span><span style="color: #000000;">)</span><span style="color: #000000;">;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #3f7f5f;">//Store&#0160;ListView&#0160;for&#0160;this&#0160;activity&#0160;in&#0160;a&#0160;member&#0160;variable&#0160;for&#0160;convenience&#0160;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">m_listView&#0160;=&#0160;</span><span style="color: #000000;">(</span><span style="color: #000000;">ListView</span><span style="color: #000000;">)</span><span style="color: #7f0055;"><strong>this</strong></span><span style="color: #000000;">.findViewById</span><span style="color: #000000;">(</span><span style="color: #000000;">R.id.ItemList</span><span style="color: #000000;">)</span><span style="color: #000000;">;&#0160;</span><br /> <span style="color: #ffffff; background-color: #ffff00;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #3f7f5f; background-color: #ffff00;">//Inflate&#0160;footer&#0160;view&#0160;and&#0160;add&#0160;to&#0160;listview</span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">LayoutInflater&#0160;li&#0160;=&#0160;getLayoutInflater</span><span style="color: #000000;">()</span><span style="color: #000000;">;</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">m_footerView&#0160;=&#0160;</span><span style="color: #000000;">(</span><span style="color: #000000;">View</span><span style="color: #000000;">)</span><span style="color: #000000;">li.inflate</span><span style="color: #000000;">(</span><span style="color: #000000;">R.layout.footer,&#0160;</span><span style="color: #7f0055;"><strong>null</strong></span><span style="color: #000000;">)</span><span style="color: #000000;">;</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">m_listView.addFooterView</span><span style="color: #000000;">(</span><span style="color: #000000;">m_footerView</span><span style="color: #000000;">)</span><span style="color: #000000;">;</span></span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #3f7f5f;">//Create&#0160;our&#0160;Adapter&#0160;and&#0160;attach&#0160;it&#0160;to&#0160;our&#0160;ListView</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">m_adapter&#0160;=&#0160;</span><span style="color: #7f0055;"><strong>new&#0160;</strong></span><span style="color: #000000;">MyAdapter</span><span style="color: #000000;">(</span><span style="color: #7f0055;"><strong>this</strong></span><span style="color: #000000;">)</span><span style="color: #000000;">;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">m_listView.setAdapter</span><span style="color: #000000;">(</span><span style="color: #000000;">m_adapter</span><span style="color: #000000;">)</span><span style="color: #000000;">;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #3f7f5f;">//Add&#0160;some&#0160;items&#0160;to&#0160;the&#0160;list</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">m_adapter.add</span><span style="color: #000000;">(</span><span style="color: #2a00ff;">&quot;Fix&#0160;the&#0160;roof&quot;</span><span style="color: #000000;">)</span><span style="color: #000000;">;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">m_adapter.add</span><span style="color: #000000;">(</span><span style="color: #2a00ff;">&quot;Paint&#0160;the&#0160;spare&#0160;bedroom&quot;</span><span style="color: #000000;">)</span><span style="color: #000000;">;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">m_adapter.add</span><span style="color: #000000;">(</span><span style="color: #2a00ff;">&quot;Paint&#0160;the&#0160;house&#0160;exterior&quot;</span><span style="color: #000000;">)</span><span style="color: #000000;">;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">m_adapter.add</span><span style="color: #000000;">(</span><span style="color: #2a00ff;">&quot;Dig&#0160;up&#0160;the&#0160;lawn&quot;</span><span style="color: #000000;">)</span><span style="color: #000000;">;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">m_adapter.add</span><span style="color: #000000;">(</span><span style="color: #2a00ff;">&quot;Build&#0160;a&#0160;fence&quot;</span><span style="color: #000000;">)</span><span style="color: #000000;">;</span><br /> <span style="background-color: #ffff00;"><span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #3f7f5f;">//Setup&#0160;listeners&#0160;so&#0160;we&#0160;can&#0160;respond&#0160;to&#0160;user&#0160;clicking&#0160;on&#0160;screen</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">createListeners</span><span style="color: #000000;">()</span><span style="color: #000000;">;</span></span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">}</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><br /> <span style="background-color: #ffff00;"><span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #3f7f5f;">//Setup&#0160;listeners&#0160;so&#0160;we&#0160;can&#0160;respond&#0160;to&#0160;user&#0160;clicking&#0160;on&#0160;screen</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #7f0055;"><strong>private&#0160;</strong></span><span style="color: #7f0055;"><strong>void&#0160;</strong></span><span style="color: #000000;">createListeners</span><span style="color: #000000;">()&#0160;{</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #3f7f5f;">//Respond&#0160;to&#0160;user&#0160;clicking&#0160;on&#0160;item&#0160;in&#0160;list</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">m_listView.setOnItemClickListener</span><span style="color: #000000;">(</span><span style="color: #7f0055;"><strong>new&#0160;</strong></span><span style="color: #000000;">OnItemClickListener</span><span style="color: #000000;">()&#0160;{</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #7f0055;"><strong>public&#0160;</strong></span><span style="color: #7f0055;"><strong>void&#0160;</strong></span><span style="color: #000000;">onItemClick</span><span style="color: #000000;">(</span><span style="color: #000000;">AdapterView&lt;?&gt;&#0160;parent,&#0160;View&#0160;view,</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #7f0055;"><strong>int&#0160;</strong></span><span style="color: #000000;">position,&#0160;</span><span style="color: #7f0055;"><strong>long&#0160;</strong></span><span style="color: #000000;">id</span><span style="color: #000000;">)&#0160;{</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">editItem</span><span style="color: #000000;">(</span><span style="color: #000000;">position,&#0160;</span><span style="color: #000000;">((</span><span style="color: #000000;">TextView</span><span style="color: #000000;">)</span><span style="color: #000000;">view</span><span style="color: #000000;">)</span><span style="color: #000000;">.getText</span><span style="color: #000000;">()</span><span style="color: #000000;">.toString</span><span style="color: #000000;">())</span><span style="color: #000000;">;</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">}</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">})</span><span style="color: #000000;">;</span></span><br /><span style="color: #ffffff; background-color: #ffff00;"> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #3f7f5f;">//Respond&#0160;to&#0160;user&#0160;clicking&#0160;in&#0160;list&#0160;view&#0160;footer&#0160;to&#0160;add&#0160;a&#0160;new&#0160;item</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">m_footerView.findViewById</span><span style="color: #000000;">(</span><span style="color: #000000;">R.id.AddButton</span><span style="color: #000000;">)</span><span style="color: #000000;">.setOnClickListener</span><span style="color: #000000;">(</span><span style="color: #7f0055;"><strong>new&#0160;</strong></span><span style="color: #000000;">OnClickListener</span><span style="color: #000000;">()&#0160;{</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #646464;">@Override</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #7f0055;"><strong>public&#0160;</strong></span><span style="color: #7f0055;"><strong>void&#0160;</strong></span><span style="color: #000000;">onClick</span><span style="color: #000000;">(</span><span style="color: #000000;">View&#0160;v</span><span style="color: #000000;">)&#0160;{</span></span><br /><span style="color: #ffffff; background-color: #ffff00;"> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">editItem</span><span style="color: #000000;">(</span><span style="color: #000000;">m_adapter.getCount</span><span style="color: #000000;">()</span><span style="color: #000000;">,&#0160;</span><span style="color: #2a00ff;">&quot;&quot;</span><span style="color: #000000;">)</span><span style="color: #000000;">;</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">}</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">})</span><span style="color: #000000;">;</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">}</span></span><br /><span style="color: #ffffff; background-color: #ffff00;"> &#0160;&#0160;&#0160;&#0160;</span><br /><span style="color: #ffffff; background-color: #ffff00;"> &#0160;&#0160;&#0160;&#0160;</span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #3f7f5f;">//Starts&#0160;ItemEditActivity&#0160;to&#0160;retrieve&#0160;new&#0160;entry&#0160;for&#0160;list&#0160;or&#0160;edit&#0160;existing</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #3f7f5f;">//Data&#0160;is&#0160;passed&#0160;via&#0160;the&#0160;Intent&#0160;we&#0160;create</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #7f0055;"><strong>public&#0160;</strong></span><span style="color: #7f0055;"><strong>void&#0160;</strong></span><span style="color: #000000;">editItem</span><span style="color: #000000;">(</span><span style="color: #7f0055;"><strong>int&#0160;</strong></span><span style="color: #000000;">position,&#0160;String&#0160;itemText</span><span style="color: #000000;">)&#0160;{</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">Intent&#0160;editIntent&#0160;=&#0160;</span><span style="color: #7f0055;"><strong>new&#0160;</strong></span><span style="color: #000000;">Intent</span><span style="color: #000000;">(</span><span style="color: #000000;">this,&#0160;ItemEditActivity.</span><span style="color: #7f0055;"><strong>class</strong></span><span style="color: #000000;">)</span><span style="color: #000000;">;</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #3f7f5f;">//Add&#0160;data&#0160;to&#0160;Intent</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">editIntent.putExtra</span><span style="color: #000000;">(</span><span style="color: #000000;">INTENT_ITEM_TEXT,&#0160;itemText</span><span style="color: #000000;">)</span><span style="color: #000000;">;</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">editIntent.putExtra</span><span style="color: #000000;">(</span><span style="color: #000000;">INTENT_ITEM_ROW,&#0160;position</span><span style="color: #000000;">)</span><span style="color: #000000;">;</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #3f7f5f;">//Launch&#0160;our&#0160;edit&#0160;Activity</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">startActivityForResult</span><span style="color: #000000;">(</span><span style="color: #000000;">editIntent,&#0160;</span><span style="color: #990000;">0</span><span style="color: #000000;">)</span><span style="color: #000000;">;</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">}</span></span><br /><span style="color: #ffffff; background-color: #ffff00;"> &#0160;&#0160;&#0160;&#0160;</span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #3f7f5f;">//Called&#0160;when&#0160;ItemEditActivity&#0160;returns</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #646464;">@Override</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #7f0055;"><strong>protected&#0160;</strong></span><span style="color: #7f0055;"><strong>void&#0160;</strong></span><span style="color: #000000;">onActivityResult</span><span style="color: #000000;">(</span><span style="color: #7f0055;"><strong>int&#0160;</strong></span><span style="color: #000000;">requestCode,&#0160;</span><span style="color: #7f0055;"><strong>int&#0160;</strong></span><span style="color: #000000;">resultCode,&#0160;Intent&#0160;intent</span><span style="color: #000000;">)&#0160;{</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #7f0055;"><strong>super</strong></span><span style="color: #000000;">.onActivityResult</span><span style="color: #000000;">(</span><span style="color: #000000;">requestCode,&#0160;resultCode,&#0160;intent</span><span style="color: #000000;">)</span><span style="color: #000000;">;</span></span><br /> <br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #7f0055;"><strong>switch&#0160;</strong></span><span style="color: #000000;">(</span><span style="color: #000000;">requestCode</span><span style="color: #000000;">)&#0160;{</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #7f0055;"><strong>case&#0160;</strong></span><span style="color: #990000;">0</span><span style="color: #000000;">:</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">processEdit</span><span style="color: #000000;">(</span><span style="color: #000000;">resultCode,&#0160;intent</span><span style="color: #000000;">)</span><span style="color: #000000;">;</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #7f0055;"><strong>break</strong></span><span style="color: #000000;">;</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #7f0055;"><strong>case&#0160;</strong></span><span style="color: #990000;">1</span><span style="color: #000000;">:</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #3f7f5f;">//For&#0160;later</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #7f0055;"><strong>break</strong></span><span style="color: #000000;">;</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">}</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">}</span></span><br /><span style="color: #ffffff; background-color: #ffff00;"> &#0160;&#0160;&#0160;&#0160;</span><br /><span style="color: #ffffff; background-color: #ffff00;"> &#0160;&#0160;&#0160;&#0160;</span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #3f7f5f;">//Add&#0160;or&#0160;edit&#0160;a&#0160;new&#0160;item.</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #3f7f5f;">//TODO:&#0160;Re-architect&#0160;so&#0160;ItemEditActivity&#0160;checks&#0160;name&#0160;is&#0160;acceptable&#0160;before&#0160;</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #3f7f5f;">//&#0160;returning&#0160;control&#0160;to&#0160;this&#0160;activity.</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #7f0055;"><strong>private&#0160;</strong></span><span style="color: #7f0055;"><strong>void&#0160;</strong></span><span style="color: #000000;">processEdit</span><span style="color: #000000;">(</span><span style="color: #7f0055;"><strong>int&#0160;</strong></span><span style="color: #000000;">resultCode,&#0160;Intent&#0160;intent</span><span style="color: #000000;">)&#0160;{</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #7f0055;"><strong>if&#0160;</strong></span><span style="color: #000000;">(</span><span style="color: #000000;">resultCode&#0160;==&#0160;RESULT_OK</span><span style="color: #000000;">)&#0160;{</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">Bundle&#0160;b&#0160;=&#0160;intent.getExtras</span><span style="color: #000000;">()</span><span style="color: #000000;">;</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">String&#0160;str&#0160;=&#0160;b.getString</span><span style="color: #000000;">(</span><span style="color: #000000;">INTENT_ITEM_TEXT</span><span style="color: #000000;">)</span><span style="color: #000000;">;</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #7f0055;"><strong>int&#0160;</strong></span><span style="color: #000000;">row&#0160;=&#0160;b.getInt</span><span style="color: #000000;">(</span><span style="color: #000000;">INTENT_ITEM_ROW</span><span style="color: #000000;">)</span><span style="color: #000000;">;</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #7f0055;"><strong>if&#0160;</strong></span><span style="color: #000000;">(</span><span style="color: #000000;">row&#0160;==&#0160;m_adapter.getCount</span><span style="color: #000000;">())&#0160;{</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">m_adapter.add</span><span style="color: #000000;">(</span><span style="color: #000000;">str</span><span style="color: #000000;">)</span><span style="color: #000000;">;</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">}</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #7f0055;"><strong>else&#0160;</strong></span><span style="color: #000000;">{</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">m_adapter.renameAt</span><span style="color: #000000;">(</span><span style="color: #000000;">row,&#0160;str</span><span style="color: #000000;">)</span><span style="color: #000000;">;</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">}</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">}</span></span><br /><span style="background-color: #ffff00;"> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">}</span></span><br /> <span style="color: #000000;">}</span></p>
<p>We add our &#39;Add Items&#39; &#0160;button to the bottom of the view by using a LayoutInflater to create a new View from footer.xml and passing it to the ListView&#39;s addFooter function.</p>
<p>Our createListeners function adds a listener for the ListView being clicked, and for our &quot;Add Items&#39; button.</p>
<p>The other important new code here - and the main point of this article - is the code required to launch our ItemEditActivity when &#39;Add Items&#39; is clicked. We launch our new Activity with our call to startActivityForResult(), and that activity returns control to this Activity via onActivityResult().</p>
<p>Note that we pass a request code to the activity we&#39;re starting up, which it later returns to the calling activity. Because we only have one onActivityResult() function, this is how we know which activity is returning its results to us. When we add additional activities that perform other tasks to our app, we&#39;ll need to be able to tell which one is returning control to us.&#0160;</p>
<p>New Activities are launched (and data passed to them) using Intents. Our editItem function creates an Intent and uses it to launch the new Activity by passing that Intent to startActivityForResult(). In this case, we know which Activity we want to launch, but you can also use Intents to &#39;broadcast&#39; to other apps that your app needs a service performing for it. (<a href="http://developer.android.com/guide/topics/intents/intents-filters.html" target="_blank">Read more about it here</a>).</p>
<p>We also have to update our Item.Equals() function, because the if (String == String) logic in Java isn&#39;t correctly comparing the String contents:</p>
<p><span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #3f7f5f;">//&#0160;Items&#0160;considered&#0160;equal&#0160;if&#0160;their&#0160;text&#0160;is&#0160;equal</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #3f7f5f;">//Old&#0160;line</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #3f7f5f;">//if&#0160;(this.getItemText()&#0160;==&#0160;lhs.getItemText()))&#0160;{</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #3f7f5f;">//New&#0160;line</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #7f0055;"><strong>if&#0160;</strong></span><span style="color: #000000;">(</span><span style="color: #7f0055;"><strong>this</strong></span><span style="color: #000000;">.getItemText</span><span style="color: #000000;">()</span><span style="color: #000000;">.compareToIgnoreCase</span><span style="color: #000000;">(</span><span style="color: #000000;">lhs.getItemText</span><span style="color: #000000;">())&#0160;</span><span style="color: #000000;">==&#0160;</span><span style="color: #990000;">0</span><span style="color: #000000;">)&#0160;{</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #7f0055;"><strong>return&#0160;true</strong></span><span style="color: #000000;">;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">}</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #7f0055;"><strong>return&#0160;false</strong></span><span style="color: #000000;">;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">}</span></p>
<p>And we&#39;re adding functionality for the user to rename an Item, which we didn&#39;t have in our AutoCAD .NET plug-in, so we implement a setItemTextAt() function in PrioritizerCore:</p>
<p><span style="color: #ffffff;">&#0160;&#0160;</span><span style="color: #7f0055;"><strong>public&#0160;</strong></span><span style="color: #7f0055;"><strong>boolean&#0160;</strong></span><span style="color: #000000;">setItemTextAt</span><span style="color: #000000;">(</span><span style="color: #7f0055;"><strong>int&#0160;</strong></span><span style="color: #000000;">index,&#0160;String&#0160;newText</span><span style="color: #000000;">)&#0160;{</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #7f0055;"><strong>if&#0160;</strong></span><span style="color: #000000;">((</span><span style="color: #000000;">index&#0160;&lt;</span><span style="color: #990000;">0</span><span style="color: #000000;">)</span><span style="color: #000000;">||</span><span style="color: #000000;">(</span><span style="color: #000000;">index&#0160;&gt;=&#0160;m_ItemList.size</span><span style="color: #000000;">()))&#0160;{</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #7f0055;"><strong>return&#0160;false</strong></span><span style="color: #000000;">;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">}</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">Item&#0160;tmpItem&#0160;=&#0160;</span><span style="color: #7f0055;"><strong>new&#0160;</strong></span><span style="color: #000000;">Item</span><span style="color: #000000;">()</span><span style="color: #000000;">;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">tmpItem.setItemText</span><span style="color: #000000;">(</span><span style="color: #000000;">newText</span><span style="color: #000000;">)</span><span style="color: #000000;">;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #7f0055;"><strong>if&#0160;</strong></span><span style="color: #000000;">(</span><span style="color: #000000;">m_ItemList.contains</span><span style="color: #000000;">(</span><span style="color: #000000;">tmpItem</span><span style="color: #000000;">))</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #7f0055;"><strong>return&#0160;false</strong></span><span style="color: #000000;">;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #000000;">m_ItemList.get</span><span style="color: #000000;">(</span><span style="color: #000000;">index</span><span style="color: #000000;">)</span><span style="color: #000000;">.setItemText</span><span style="color: #000000;">(</span><span style="color: #000000;">newText</span><span style="color: #000000;">)</span><span style="color: #000000;">;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #7f0055;"><strong>return&#0160;true</strong></span><span style="color: #000000;">;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;</span><span style="color: #000000;">}</span></p>
<p>And we add a corresponding function in MyAdapter:</p>
<p><span style="color: #ffffff;">&#0160;&#0160;&#0160;</span><span style="color: #7f0055;"><strong>public&#0160;</strong></span><span style="color: #7f0055;"><strong>boolean&#0160;</strong></span><span style="color: #000000;">renameAt</span><span style="color: #000000;">(</span><span style="color: #7f0055;"><strong>int&#0160;</strong></span><span style="color: #000000;">index,&#0160;String&#0160;newText</span><span style="color: #000000;">)&#0160;{</span><br /> <span style="color: #ffffff;">&#0160;&#0160;&#0160;&#0160;</span><span style="color: #7f0055;"><strong>return&#0160;</strong></span><span style="color: #000000;">m_prioritizer.setItemTextAt</span><span style="color: #000000;">(</span><span style="color: #000000;">index,&#0160;newText</span><span style="color: #000000;">)</span><span style="color: #000000;">;</span><br /> <span style="color: #ffffff;">&#0160;&#0160;</span><span style="color: #000000;">}</span></p>
<p>That should be all we need to do for our app to work. However, its possible I missed highlighting the odd code change, <a href="http://adndevblog.typepad.com/autocad/Downloads/CSMigrationTest.zip" target="_self">so here is a download of the full project to date</a>.</p>
<p>Now its time to run the app. The list looks the same as last time except it has a button at the bottom that you can press to add a new item:</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01676738992e970b-pi" style="display: inline;"><img alt="Pt5app1" class="asset  asset-image at-xid-6a0167607c2431970b01676738992e970b" src="/assets/image_298714.jpg" style="display: block; margin-left: auto; margin-right: auto;" title="Pt5app1" /></a><br />Clicking on &#39;Add Item&#39; launches our new activity which prompts the user to enter a new Item. Clicking on an Item in the list launches the same activity, but populates it with the name of the Item:</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0163064516ee970d-pi" style="display: inline;"><img alt="Pt5app2" class="asset  asset-image at-xid-6a0167607c2431970b0163064516ee970d" src="/assets/image_970716.jpg" style="display: block; margin-left: auto; margin-right: auto;" title="Pt5app2" /></a><br />That&#39;s it for today. And that&#39;s pretty much all there is to programming a simple (text-based) Android app. In my final post on this subject, I&#39;ll be posting a completed (or at least more complete) version of this project and summarizing this series. Most of the rest of the work is just more of the same - adding buttons to perform other functions in the app(prioritization etc), and (maybe) fully implementing serialization so we can work with multiple lists, and so we can handle restoring an Activity if it gets destroyed by the OS. There&#39;s also an architectural flaw in the current implementation that I&#39;d like to fix, where the EditItemActivity can&#39;t check whether the edited/new Item name already exists.</p>
<p>I&#39;ve not written all of that yet, and I&#39;m off to Portland for the <a href="http://adndevblog.typepad.com/autocad/2012/04/devcamps.html" target="_self">Manufacturing DevCamp</a>&#0160;for the rest of this week - so it may be a while before that final post appears.</p>
