---
layout: "post"
title: "How to use AcDbRegion::getAreaProp()"
date: "2012-05-30 02:14:48"
author: "Xiaodong Liang"
categories:
  - "AutoCAD"
  - "ObjectARX"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/autocad/2012/05/how-to-use-acdbregiongetareaprop.html "
typepad_basename: "how-to-use-acdbregiongetareaprop"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>  <p>The first three parameters for the function are described as </p>  <p>- origin Returns origin of the region    <br />- xAxis Returns xAxis of the region     <br />- yAxis Returns yAxis of the region </p>  <p>But considering the const declaration for these parameters    <br /> virtual Acad::ErrorStatus getAreaProp(     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; const AcGePoint3d&amp; origin,     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; const AcGeVector3d&amp; xAxis,    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; const AcGeVector3d&amp; yAxis, ... ); </p>  <p>It's clear that these three parameters are not output parameters but input parameters. Using parameters that were not initialized properly results in the function returning Acad::eInvalidInput. </p>  <p>Here is a correct application of AcDbRegion::getAreaProp():</p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%; color: green">// note for code brevity, some error checking are omitted</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">//</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> getRegionAreaProp()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">{</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; ads_name eNam;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; ads_point pt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; AcDbObjectId eId;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (acedEntSel(L</span><span style="line-height: 140%; color: #a31515">&quot;\nSelect an region: &quot;</span><span style="line-height: 140%">, eNam, pt) != RTNORM)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; acutPrintf(L</span><span style="line-height: 140%; color: #a31515">&quot;\nNothing selected.&quot;</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; acdbGetObjectId(eId, eNam);</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; AcDbEntity* pEnt = NULL;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%">(acdbOpenAcDbEntity(pEnt, eId, AcDb::kForRead) != Acad::eOk)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; acutPrintf(L</span><span style="line-height: 140%; color: #a31515">&quot;\nError open entity.&quot;</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; AcDbRegion* pReg = AcDbRegion::cast(pEnt);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%">(!pReg)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; pEnt-&gt;close();</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }&#160;&#160;&#160; </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">double</span><span style="line-height: 140%"> perimeter, area, momInertia[2], </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; prodInertia, prinMoments[2],&#160;&#160;&#160; </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; radiiGyration[2];</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; AcGePoint2d centroid, extentsLow, extentsHigh;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; AcGeVector2d prinAxes[2];</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; AcGePoint3d origin;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; AcGeVector3d xAxis;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; AcGeVector3d yAxis;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// initialize the three arguments</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; AcGePlane plane;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; pReg-&gt;getPlane(plane);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; plane.getCoordSystem(origin, xAxis, yAxis);</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; Acad::ErrorStatus es = pReg-&gt;getAreaProp(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// these (3) are the input parameters</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; origin, xAxis, yAxis, </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; perimeter, </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; area, </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; centroid,</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; momInertia,</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; prodInertia,</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; prinMoments,</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; prinAxes,</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; radiiGyration,</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; extentsLow,</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; extentsHigh);</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; assert(es == Acad::eOk);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// you can determine what to do exactly with the results</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// here I just print a message</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; acutPrintf(L</span><span style="line-height: 140%; color: #a31515">&quot;\nSucceded in getting an region's area prop.&quot;</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; pReg-&gt;close();</span></p>    <p style="margin: 0px"><span style="line-height: 140%">}</span></p> </div>
