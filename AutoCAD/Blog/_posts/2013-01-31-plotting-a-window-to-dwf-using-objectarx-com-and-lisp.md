---
layout: "post"
title: "Plotting A Window To DWF using ObjectARX COM and LISP"
date: "2013-01-31 16:27:26"
author: "Fenton Webb"
categories:
  - "2010"
  - "2011"
  - "2012"
  - "2013"
  - "ActiveX"
  - "AutoCAD"
  - "Fenton Webb"
  - "LISP"
  - "ObjectARX"
original_url: "https://adndevblog.typepad.com/autocad/2013/01/plotting-a-window-to-dwf-using-objectarx-com-and-lisp.html "
typepad_basename: "plotting-a-window-to-dwf-using-objectarx-com-and-lisp"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/fenton-webb.html">Fenton Webb</a></p>  <p><b>Issue</b></p>  <p>I want to Window plot a drawing to DWF, I'm using COM to plot the DWF but how do I setup the Plot Settings so that it plots using a couple of Window coordinates?</p>  <p><a name="section2"></a></p>  <p><b>Solution</b></p>  <p>In ObjectARX you need to use the AcDbPlotSettingsValidator class to setup the Plot. Here is some code which shows you what to do. Note this is using the Window coordinates as the extents of the drawing. This is purely for test purposes - if you want to plot the extents then use setPlotType (pLayout, AcDbPlotSettings::kExtents). There is also a Visual LISP example following the ObjectARX code.</p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">#import</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#a31515">&quot;acax19ENU.tlb&quot;</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#010001">no_namespace</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">#include</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#a31515">&quot;acaplmgr.h&quot;</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">static</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">ASDKTS66871_PlotWindow_COM_testPlot</font></span><font color="#000000">(</font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">{</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// Use ActiveX interface to get the application object</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">IAcadApplicationPtr</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">pAcad</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">acedGetAcadWinApp</font></span><font color="#000000">()-&gt;</font><span style="color: "><font color="#010001">GetIDispatch</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">FALSE</font></span><font color="#000000">); </font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">//get the path to plotter configuration</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">_bstr_t</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">szPrinterPath</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">szPrinterPath</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">pAcad</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#010001">Preferences</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#010001">GetFiles</font></span><font color="#000000">()-&gt;</font><span style="color: "><font color="#010001">GetPrinterConfigPath</font></span><font color="#000000">() + </font><span style="color: "><font color="#010001">_bstr_t</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;\\DWF6 ePlot.pc3&quot;</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// get the current database</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">AcDbDatabase</font></span><font color="#000000"> *</font><span style="color: "><font color="#010001">curDocDB</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">acdbHostApplicationServices</font></span><font color="#000000">()-&gt;</font><span style="color: "><font color="#010001">workingDatabase</font></span><font color="#000000">(); </font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// get a pointer to the layout manager</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">AcApLayoutManager</font></span><font color="#000000"> *</font><span style="color: "><font color="#010001">pLayoutManager</font></span><font color="#000000"> = (</font><span style="color: "><font color="#010001">AcApLayoutManager</font></span><font color="#000000"> *)</font><span style="color: "><font color="#010001">acdbHostApplicationServices</font></span><font color="#000000">()-&gt;</font><span style="color: "><font color="#010001">layoutManager</font></span><font color="#000000">(); </font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">const</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">ACHAR</font></span><font color="#000000"> *</font><span style="color: "><font color="#010001">layoutName</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">pLayoutManager</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#010001">findActiveLayout</font></span><font color="#000000"> (</font><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// get the current layout</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">AcDbLayout</font></span><font color="#000000"> *</font><span style="color: "><font color="#010001">pLayout</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">pLayoutManager</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#010001">findLayoutNamed</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">layoutName</font></span><font color="#000000">, </font><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">);&#160; </font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// if we got it ok</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">pLayout</font></span><font color="#000000"> != </font><span style="color: "><font color="#010001">NULL</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160; {</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">Acad</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">ErrorStatus</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">es</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// get the plotsetttings class </font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">AcDbPlotSettingsValidator</font></span><font color="#000000"> *</font><span style="color: "><font color="#010001">pPlotSettingsValidator</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">acdbHostApplicationServices</font></span><font color="#000000">()-&gt;</font><span style="color: "><font color="#010001">plotSettingsValidator</font></span><font color="#000000">(); </font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// if we got it ok</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">pPlotSettingsValidator</font></span><font color="#000000"> != </font><span style="color: "><font color="#010001">NULL</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// Refresh the layout lists in order to use it</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">pPlotSettingsValidator</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#010001">refreshLists</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">pLayout</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// change the current layout plotter</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">es</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">pPlotSettingsValidator</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#010001">setPlotCfgName</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">pLayout</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">szPrinterPath</font></span><font color="#000000">);&#160;&#160; </font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// set the window to plot as the extents of the drawing</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">es</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">pPlotSettingsValidator</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#010001">setPlotWindowArea</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">pLayout</font></span><font color="#000000">, </font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">curDocDB</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#010001">extmin</font></span><font color="#000000"> ().</font><span style="color: "><font color="#010001">x</font></span><font color="#000000">,</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">curDocDB</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#010001">extmin</font></span><font color="#000000"> ().</font><span style="color: "><font color="#010001">y</font></span><font color="#000000">,</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">curDocDB</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#010001">extmax</font></span><font color="#000000"> ().</font><span style="color: "><font color="#010001">x</font></span><font color="#000000">,</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">curDocDB</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#010001">extmax</font></span><font color="#000000"> ().</font><span style="color: "><font color="#010001">y</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// set the orgin</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">es</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">pPlotSettingsValidator</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#010001">setPlotOrigin</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">pLayout</font></span><font color="#000000">, </font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">curDocDB</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#010001">extmin</font></span><font color="#000000"> ().</font><span style="color: "><font color="#010001">x</font></span><font color="#000000">,</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">curDocDB</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#010001">extmin</font></span><font color="#000000"> ().</font><span style="color: "><font color="#010001">y</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// set to plot centred</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">es</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">pPlotSettingsValidator</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#010001">setPlotCentered</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">pLayout</font></span><font color="#000000">, </font><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// setup the plot type to window</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">es</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">pPlotSettingsValidator</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#010001">setPlotType</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">pLayout</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">AcDbPlotSettings</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">kWindow</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// set the scale</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">es</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">pPlotSettingsValidator</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#010001">setStdScaleType</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">pLayout</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">AcDbPlotSettings</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">StdScaleType</font></span><font color="#000000">::</font><span style="color: "><font color="#010001">kScaleToFit</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// we have to close the layout here because the last parameter of </font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// findLayoutNamed is true, leave layout open</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">pLayout</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#010001">close</font></span><font color="#000000"> ();</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }&#160; </font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160; }</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// get the current document</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">IAcadDocumentPtr</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">pDoc</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">pAcad</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#010001">GetActiveDocument</font></span><font color="#000000">(); </font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// create a plot object </font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">IAcadPlotPtr</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">pPlot</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">pDoc</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#010001">GetPlot</font></span><font color="#000000">(); </font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// lets plot </font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">pPlot</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#010001">PlotToFile</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;c:\\test.dwf&quot;</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">szPrinterPath</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">} </font></font></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">Note: You do not necessarily need to use COM to plot. Instead you can use ObjectARX functions. A good sample ships with the ObjectARX 2009 SDK. ( ..\ObjectARX 2009\samples\editor\AsdkPlotAPI )</p> </div>  <p>Here is a Visual LISP example:</p>  <p><font size="1" face="Consolas">(defun c:testPlotWindow ( / acadObject acadDocument activeLayoutObject plt p1 point1     <br />&#160;&#160;&#160;&#160; pPt1 pPt1sa pt1 p2 point2 pPt2 pPt2sa pt2 )      <br />&#160; (vl-load-com)      <br />&#160; (setq acadObject (vlax-get-Acad-object))      <br />&#160; (setq acadDocument (vla-get-ActiveDocument acadObject))      <br />&#160; (setq activeLayoutObject (vla-Get-ActiveLayout acadDocument))</font></p>  <p><font size="1" face="Consolas">&#160; (setq plt (vla-get-plot acadDocument))</font></p>  <p><font size="1" face="Consolas">&#160; (vla-put-configname activeLayoutObject &quot;DWF6 ePlot.pc3&quot;)     <br />&#160; (vla-put-canonicalmedianame      <br />&#160;&#160;&#160; activeLayoutObject      <br />&#160;&#160;&#160; &quot;ISO_full_bleed_A3_(420.00_x_297.00_MM)&quot;      <br />&#160;&#160;&#160; )      <br />&#160; (vla-put-paperunits activeLayoutObject acMillimeters)      <br />&#160; (vla-put-plotrotation activeLayoutObject ac0degrees)      <br />&#160; ; How to control the Plot Style Table      <br />&#160; ; (vla-put-StyleSheet activeLayoutObject &quot;HP LaserJet 4MV.ctb&quot;)</font></p>  <p><font size="1" face="Consolas">&#160; (setq p1 (getpoint &quot;\nSelect Window Point No 1 (Lower Left): &quot;))     <br />&#160; (setq point1 (list (car p1) (cadr p1)))      <br />&#160; (setq pPt1 (vlax-make-safearray vlax-vbDouble '(0 . 1)))      <br />&#160; (setq pPt1sa (vlax-safearray-fill pPt1 point1))      <br />&#160; (setq pt1 (vlax-make-variant      <br />&#160;&#160;&#160;&#160;&#160;&#160; pPt1sa      <br />&#160;&#160;&#160;&#160;&#160;&#160; (logior vlax-vbarray vlax-vbDouble)      <br />&#160;&#160;&#160;&#160;&#160;&#160; )      <br /> )</font></p>  <p><font size="1" face="Consolas">&#160; (setq p2 (getpoint &quot;\nSelect Window Point No 2 (Upper Right): &quot;))     <br />&#160; (setq point2 (list (car p2) (cadr p2)))      <br />&#160; (setq pPt2 (vlax-make-safearray vlax-vbDouble '(0 . 1)))      <br />&#160; (setq pPt2sa (vlax-safearray-fill pPt2 point2))      <br />&#160; (setq pt2 (vlax-make-variant      <br />&#160;&#160;&#160;&#160;&#160;&#160; pPt2sa      <br />&#160;&#160;&#160;&#160;&#160;&#160; (logior vlax-vbarray vlax-vbDouble)      <br />&#160;&#160;&#160;&#160;&#160;&#160; )      <br /> )</font></p>  <p><font size="1" face="Consolas">&#160; (vla-SetWindowToPlot activeLayoutObject pt1 pt2)     <br />&#160; (vla-put-plottype activeLayoutObject acWindow)</font></p>  <p><font size="1" face="Consolas">&#160;&#160; (vla-plottofile plt &quot;c:\\test.dwf&quot; &quot;DWF6 ePlot.pc3&quot;)</font></p>  <p><font size="1" face="Consolas">&#160; )</font></p>
