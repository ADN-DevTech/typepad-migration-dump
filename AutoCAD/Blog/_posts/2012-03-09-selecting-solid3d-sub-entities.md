---
layout: "post"
title: "Selecting Solid3d sub-entities"
date: "2012-03-09 04:21:31"
author: "Philippe Leefsma"
categories:
  - ".NET"
  - "AutoCAD"
  - "Philippe Leefsma"
original_url: "https://adndevblog.typepad.com/autocad/2012/03/selecting-solid3d-sub-entities.html "
typepad_basename: "selecting-solid3d-sub-entities"
typepad_status: "Publish"
---

<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; color: "><font face="Consolas"><font color="#008000" style="font-size: 9.5pt"></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none">By <a href="http://adndevblog.typepad.com/autocad/philippe-leefsma.html" target="_self">Philippe Leefsma</a></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none">&#0160;</p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; color: "><font color="#000000" style="font-size: 9.5pt">The following command illustrates a way to prompt user for subentity selection on a solid3d. It allows to select a single subentity and checks if the selected subentity type matches the specified type.</font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; color: "><font color="#000000"></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; color: "><font color="#000000"></font></span></p>        <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; color: "><font color="#000000">After the subentity has been selected, it uses the Brep API and retrieve the Brep entity representing this subentity. Further methods of the Brep object can be invoked in order to analyze the properties of the subentity.</font></span></p>        <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; color: "><font color="#000000"></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; color: "><font color="#000000"></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; color: "><font color="#000000"></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; color: "><font face="Consolas"><font color="#008000" style="font-size: 9.5pt"></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; color: "><font face="Consolas"><font color="#008000" style="font-size: 9.5pt"></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; color: "><font face="Consolas"><font color="#008000" style="font-size: 9.5pt">//Command SubEntSelectBrep: Prompts user to select a single</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; color: "><font face="Consolas"><font color="#008000" style="font-size: 9.5pt">//solid sub-entity a</font></font></span><span style="font-family: ; color: "><font face="Consolas"><font color="#008000" style="font-size: 9.5pt">nd filters type of sub-entity selected.</font></font></span><span style="font-family: "></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; color: "><font face="Consolas"><font color="#008000" style="font-size: 9.5pt">//Philippe Leefsma, Developer Technical Services. March 2012.</font></font></span></p>        <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; color: "><font color="#008000" face="Consolas"></font></span><span style="font-family: "></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><font style="font-size: 9.5pt">[</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">CommandMethod</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;SubEntSelectBrep&quot;</font></span><font color="#000000">)]</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span lang="FR" style="font-family: ; color: ; mso-ansi-language: fr"><font color="#0000ff"><font style="font-size: 9.5pt">public</font></font></span><span lang="FR" style="font-family: ; mso-ansi-language: fr"><font style="font-size: 9.5pt"><font color="#000000"> </font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000"> SubEntSelectBrep()</font></font></span></font></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span lang="FR" style="font-family: ; mso-ansi-language: fr"><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">{</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span lang="FR" style="font-family: ; mso-ansi-language: fr"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">Document</font></span><font color="#000000"> doc = </font><span style="color: "><font color="#2b91af">Application</font></span><font color="#000000">.DocumentManager.MdiActiveDocument;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span lang="FR" style="font-family: ; mso-ansi-language: fr"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></font></span></span><font style="font-size: 9.5pt"><span style="font-family: ; color: "><font color="#2b91af">Database</font></span></font><span style="font-family: "><font color="#000000" style="font-size: 9.5pt"> db = doc.Database;</font></span></font></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">Editor</font></span><font color="#000000"> ed = doc.Editor;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">PromptKeywordOptions</font></span><font color="#000000"> pko = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">PromptKeywordOptions</font></span><font color="#000000">(</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#a31515">&quot;\nSpecify sub-entity selection type:&quot;</font></span><font color="#000000">);</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">pko.AllowNone = </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">false</font></span><font color="#000000">;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">pko.Keywords.Add(</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#a31515">&quot;Face&quot;</font></span><font color="#000000">);</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">pko.Keywords.Add(</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#a31515">&quot;Edge&quot;</font></span><font color="#000000">);</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">pko.Keywords.Add(</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#a31515">&quot;Vertex&quot;</font></span><font color="#000000">);</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">pko.Keywords.Default = </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#a31515">&quot;Face&quot;</font></span><font color="#000000">;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">PromptResult</font></span><font color="#000000"> pkr = ed.GetKeywords(pko);</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (pkr.Status != </font><span style="color: "><font color="#2b91af">PromptStatus</font></span><font color="#000000">.OK)</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000">;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">SubentityType</font></span><font color="#000000"> subentityType = </font><span style="color: "><font color="#2b91af">SubentityType</font></span><font color="#000000">.Null;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">switch</font></span><font color="#000000">(pkr.StringResult)</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">{</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">case</font></span><font color="#000000"> </font><span style="color: "><font color="#a31515">&quot;Face&quot;</font></span><font color="#000000">:</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">subentityType = </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">SubentityType</font></span><font color="#000000">.Face;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">break</font></span><font color="#000000">;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">case</font></span><font color="#000000"> </font><span style="color: "><font color="#a31515">&quot;Edge&quot;</font></span><font color="#000000">:</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">subentityType = </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">SubentityType</font></span><font color="#000000">.Edge;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">break</font></span><font color="#000000">;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt"><span style="mso-spacerun: yes">&#0160;</span></font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">case</font></span><font color="#000000"> </font><span style="color: "><font color="#a31515">&quot;Vertex&quot;</font></span><font color="#000000">:</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">subentityType = </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">SubentityType</font></span><font color="#000000">.Vertex;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">break</font></span><font color="#000000">;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">default</font></span><font color="#000000">:</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000">;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">PromptSelectionOptions</font></span><font color="#000000"> pso = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">PromptSelectionOptions</font></span><font color="#000000">();</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">pso.MessageForAdding = </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#a31515">&quot;\nSelect solid &quot;</font></span><font color="#000000"> + </font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt"><font color="#000000">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; pkr.StringResult + </font><span style="color: "><font color="#a31515">&quot;: &quot;</font></span><font color="#000000">;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">pso.SingleOnly = </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">pso.SinglePickInSpace = </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">pso.ForceSubSelections = </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><span style="mso-spacerun: yes"><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">PromptSelectionResult</font></span><font color="#000000"> psr = ed.GetSelection(pso);</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (psr.Status != </font><span style="color: "><font color="#2b91af">PromptStatus</font></span><font color="#000000">.OK)</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000">;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">SelectionSet</font></span><font color="#000000"> ss = psr.Value;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">SelectedObject</font></span><font color="#000000"> so = ss[0];</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (!so.ObjectId.ObjectClass.IsDerivedFrom(</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">RXClass</font></span><font color="#000000">.GetClass(</font><span style="color: "><font color="#0000ff">typeof</font></span><font color="#000000">(</font><span style="color: "><font color="#2b91af">Solid3d</font></span><font color="#000000">))))</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">{</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">ed.WriteMessage(</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#a31515">&quot;\nYou didn&#39;t select a solid, please try again...&quot;</font></span><font color="#000000">);</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt"><span style="mso-spacerun: yes">&#0160; </span></font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000">;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">using</font></span><font color="#000000"> (</font><span style="color: "><font color="#2b91af">Transaction</font></span><font color="#000000"> Tx = db.TransactionManager.StartTransaction())</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">{</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">Solid3d</font></span><font color="#000000"> solid = Tx.GetObject(so.ObjectId, </font><span style="color: "><font color="#2b91af">OpenMode</font></span><font color="#000000">.ForRead)</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">as</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">Solid3d</font></span><font color="#000000">;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">SelectedSubObject</font></span><font color="#000000">[] sso = so.GetSubentities();</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><span style="color: "><font color="#008000" style="font-size: 9.5pt">//Checks that selected type matches keyword selection</font></span></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (subentityType != sso[0].FullSubentityPath.SubentId.Type)</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">{</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">ed.WriteMessage(</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#a31515">&quot;\nInvalid Subentity Type: &quot;</font></span><font color="#000000"> +</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">sso[0].FullSubentityPath.SubentId.Type + </font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt"><span style="mso-spacerun: yes">&#0160;&#0160;&#0160; </span></font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#a31515">&quot;, please try again...&quot;</font></span><font color="#000000">);</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000">;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">SubentityId</font></span><font color="#000000"> subentityId = sso[0].FullSubentityPath.SubentId;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><span style="mso-spacerun: yes"><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><span style="color: "><font color="#008000" style="font-size: 9.5pt">//Creates subentity path to use with GetSubentity</font></span></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">FullSubentityPath</font></span><font color="#000000"> subEntityPath = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">FullSubentityPath</font></span><font color="#000000">(</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">ObjectId</font></span><font color="#000000">[] { solid.ObjectId },</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">subentityId);</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><span style="color: "><font color="#008000" style="font-size: 9.5pt">//Returns a non-database resident entity </font></span></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><span style="color: "><font color="#008000" style="font-size: 9.5pt">//that represents the subentity</font></span></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">using</font></span><font color="#000000"> (</font><span style="color: "><font color="#2b91af">Entity</font></span><font color="#000000"> entity = solid.GetSubentity(subEntityPath))</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt"><span style="mso-spacerun: yes">&#0160;</span>{</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">ed.WriteMessage(</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#a31515">&quot;\nSubentity Entity Type: &quot;</font></span><font color="#000000"> </font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">+ entity.ToString());</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><span style="color: "><font color="#008000" style="font-size: 9.5pt">//Creates entity path to generate Brep object from it</font></span></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">FullSubentityPath</font></span><font color="#000000"> entityPath = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">FullSubentityPath</font></span><font color="#000000">(</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">ObjectId</font></span><font color="#000000">[] { solid.ObjectId },</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">SubentityId</font></span><font color="#000000">(</font><span style="color: "><font color="#2b91af">SubentityType</font></span><font color="#000000">.Null, </font><span style="color: "><font color="#2b91af">IntPtr</font></span><font color="#000000">.Zero));</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">using</font></span><font color="#000000"> (</font><span style="color: "><font color="#2b91af">Brep</font></span><font color="#000000"> brep = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">Brep</font></span><font color="#000000">(entityPath))</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">{</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">switch</font></span><font color="#000000"> (subentityType)</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">{</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">case</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">SubentityType</font></span><font color="#000000">.Face:</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt"><span style="mso-spacerun: yes">&#0160; </span></font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">foreach</font></span><font color="#000000"> (</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">Autodesk.AutoCAD.BoundaryRepresentation.</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">Face</font></span><font color="#000000">&#0160; </font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt"><font color="#000000">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; face </font></font></font></span><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">in</font></span><font color="#000000"> brep.Faces)</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">{</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (subentityId == </font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt"><font color="#000000">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; face.SubentityPath.SubentId)</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">{</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">ed.WriteMessage(</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#a31515">&quot;\nSurface: &quot;</font></span><font color="#000000"> </font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">+ face.Surface.ToString());</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">break</font></span><font color="#000000">;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">break</font></span><font color="#000000">;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">case</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">SubentityType</font></span><font color="#000000">.Edge:</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">foreach</font></span><font color="#000000"> (</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">Autodesk.AutoCAD.BoundaryRepresentation.</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">Edge</font></span></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font color="#000000">edge </font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">in</font></span><font color="#000000"> brep.Edges)</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">{</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (subentityId == </font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt"><font color="#000000">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; edge.SubentityPath.SubentId)</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">{</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">ed.WriteMessage(</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#a31515">&quot;\nCurve: &quot;</font></span><font color="#000000"> + </font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">edge.Curve.ToString());</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">break</font></span><font color="#000000">;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">break</font></span><font color="#000000">;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">case</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">SubentityType</font></span><font color="#000000">.Vertex:</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">foreach</font></span><font color="#000000"> (</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "></span><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">Autodesk.AutoCAD.BoundaryRepresentation.</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">Vertex</font></span><font color="#000000"> </font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt"><font color="#000000">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; vertex </font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">in</font></span><font color="#000000"> brep.Vertices)</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">{</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (subentityId == </font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font style="font-size: 9.5pt"><font color="#000000">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; vertex.SubentityPath.SubentId)</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">{</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">ed.WriteMessage(</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#a31515">&quot;\nPoint: &quot;</font></span><font color="#000000"> + </font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">PointToStr(vertex.Point));</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">break</font></span><font color="#000000">;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160; </font></span><font style="font-size: 9.5pt"><span style="mso-spacerun: yes">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>}</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">break</font></span><font color="#000000">;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">default</font></span><font color="#000000">:</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">break</font></span><font color="#000000">;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><span style="mso-spacerun: yes"><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></font></span></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">Tx.Commit();</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">}</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">&#0160;</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; color: "><font face="Consolas"><font color="#008000" style="font-size: 9.5pt">//Small utility function</font></font></span><span style="font-family: "></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><font style="font-size: 9.5pt">private</font></font></span><span style="font-family: "><font style="font-size: 9.5pt"><font color="#000000"> </font><span style="color: "><font color="#0000ff">string</font></span><font color="#000000"> PointToStr(</font><span style="color: "><font color="#2b91af">Point3d</font></span><font color="#000000"> point)</font></font></span></font></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">{</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> </font><span style="color: "><font color="#a31515">&quot;[&quot;</font></span><font color="#000000"> +</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">point.X.ToString(</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#a31515">&quot;F2&quot;</font></span><font color="#000000">) + </font><span style="color: "><font color="#a31515">&quot;, &quot;</font></span><font color="#000000"> +</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">point.Y.ToString(</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#a31515">&quot;F2&quot;</font></span><font color="#000000">) + </font><span style="color: "><font color="#a31515">&quot;, &quot;</font></span><font color="#000000"> +</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">point.Z.ToString(</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#a31515">&quot;F2&quot;</font></span><font color="#000000">)</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span><font style="font-size: 9.5pt">+ </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#a31515">&quot;]&quot;</font></span><font color="#000000">;</font></font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font face="Consolas"><font color="#000000" style="font-size: 9.5pt">}</font></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font color="#000000" face="Consolas"></font></span></p>  <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: "><font color="#000000" face="Consolas"></font></span></p>        <p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none"><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0168e89a885d970c-pi"><img alt="pic" border="0" height="565" src="/assets/image_548655.jpg" style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="pic" width="508" /></a></p>  <p>&#0160;</p>  <p>Contributed by </p>  <p>Philippe Leefsma, Developer Consultant.</p>  <p>Autodesk Developer Network.</p>
