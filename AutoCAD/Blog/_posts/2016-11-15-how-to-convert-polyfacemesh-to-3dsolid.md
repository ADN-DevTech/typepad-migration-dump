---
layout: "post"
title: "How to Convert Polyfacemesh to 3dSolid"
date: "2016-11-15 21:00:00"
author: "Madhukar Moogala"
categories:
  - "2015"
  - "2016"
  - "AutoCAD"
  - "Madhukar Moogala"
  - "ObjectARX"
original_url: "https://adndevblog.typepad.com/autocad/2016/11/how-to-convert-polyfacemesh-to-3dsolid.html "
typepad_basename: "how-to-convert-polyfacemesh-to-3dsolid"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/Madhukar-Moogala.html" target="_self">Madhukar Moogala</a></p> <p>We have an inbuilt AutoCAD command CONVTOSOLID, but this command is very limited doesnâ€™t work effectively on</p> <p>Polyfacemesh &lt;<strong>AcDbPolyFaceMesh</strong>&gt; entities.</p> <p>We will create an in-memory subDMesh &lt;AcDbSubDMesh&gt; object from pfmesh [read as Polyfacemesh], first we will extract vertex and face information from pfmesh and use this information in constructing a subDMesh, convert this mesh object solid using convertToSolid API.</p> <p>Before we get in to this, if you must know commands and their meaning while working on Meshs.</p> <p>You can find full glossary at <a href="http://help.autodesk.com/view/ACD/2017/ENU/?guid=GUID-B3E92DDF-DE09-464C-BA7A-2C420B22285D">MeshPrimitives</a>, a quick reference for the reader is below:</p><pre><font size="2">DIVMESHBOXWIDTH: Sets the number of subdivisions for the width of a mesh box along the Y axis.
DIVMESHBOXHEIGHT : Sets the number of subdivisions for the height of a mesh box along the Z axis.
DIVMESHCONEAXIS : Sets the number of subdivisions around the perimeter of the mesh cone base.
DIVMESHCONEHEIGHT : Sets the number of subdivisions between the base and the point or top of the mesh cone.
DIVMESHCONEBASE : Sets the number of subdivisions between the perimeter and the center point of the mesh cone base.
DIVMESHCYLAXIS : Sets the number of subdivisions around the perimeter of the mesh cylinder base.
DIVMESHCYLHEIGHT : Sets the number of subdivisions between the base and the top of the mesh cylinder.
DIVMESHCYLBASE : Sets the number of radial subdivisions from the center of the mesh cylinder base to its perimeter.
DIVMESHPYRLENGTH : Sets the number of subdivisions along each dimension of a mesh pyramid base.
DIVMESHPYRHEIGHT : Sets the number of subdivisions between the base and the top of the mesh pyramid.
DIVMESHPYRBASE : Sets the number of radial subdivisions between the center of the mesh pyramid base and its perimeter.
DIVMESHSPHEREAXIS : Sets the number of radial subdivisions around the axis endpoint of the mesh sphere.
DIVMESHSPHEREHEIGHT : Sets the number of subdivisions between the two axis endpoints of the mesh sphere.
DIVMESHWEDGELENGTH : Sets the number of subdivisions for the length of a mesh wedge along the X axis.
DIVMESHWEDGEWIDTH : Sets the number of subdivisions for the width of the mesh wedge along the Y axis.
DIVMESHWEDGEHEIGHT : Sets the number of subdivisions for the height of the mesh wedge along the Z axis.
DIVMESHWEDGESLOPE : Sets the number of subdivisions in the slope that extends from the apex of the wedge to the edge of the base.
DIVMESHWEDGEBASE : Sets the number of subdivisions between the midpoint of the perimeter of triangular dimension of the mesh wedge.
DIVMESHTORUSSECTION : Sets the number of subdivisions in the profile that sweeps the path of a mesh torus.
DIVMESHTORUSPATH : Sets the number of subdivisions in the path that is swept by the profile of a mesh torus</font></pre>
<p>We have an API </p>
<p>AcDbSubDMesh::setSubDMesh which creates Mesh entity for a given vertex array and face array,&nbsp; first we will try to understand about vertex array and face array</p>
<p><strong>What is vertex array ?</strong></p>
<p>An array of vertex points that makes each face.</p>
<p><strong>What is Face array ?</strong></p>
<p>The face Array defines an array of faces, and each face is defined by a set of numbers. The first number specifies the number of vertices in the face, the following numbers are the indices of the vertices making up the face.&nbsp; <p>&nbsp; <p>Face array F[] = {N<sub>0</sub>,a<sub>0</sub>,...,a<sub>N<sub>0</sub></sub>,N<sub>1</sub>,b<sub>0</sub>,...,b<sub>N<sub>1</sub></sub>} Where N<sub>0</sub> is Number of vertices in that particular face and a<sub>0</sub>,...,a<sub>N<sub>0</sub></sub> are the corresponding vertex indices in the Vertex array </p>
<p>To illustrate : 
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d23a26fe970c-pi"><img title="VertexIndices" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="VertexIndices" src="/assets/image_330381.jpg" width="173" height="244"></a> 
<p>Face array F[] for the above faces would be - {3, 0, 1, 2,&nbsp;&nbsp;&nbsp;&nbsp; -3, 3, 4, 5,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3, 6, 7, 8};&nbsp; A negative before a Number of vertices &lt;for e.g.,<strong>-3</strong>&gt; indicates the face is lying inside or a hole.</p>
<p>Code:</p>
<div style="font-size: 12pt; font-family: consolas; background: #1e1e1e; color: #dcdcdc">
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #569cd6; line-height: 140%">void</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">test4</span><span style="color: #b4b4b4; line-height: 140%">()</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">{</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: white; line-height: 140%">AcDbObjectId</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">entId</span><span style="color: #b4b4b4; line-height: 140%">;</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: white; line-height: 140%">ads_name</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">ent_name</span><span style="color: #b4b4b4; line-height: 140%">;</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: white; line-height: 140%">AcGePoint3d</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">pickPnt</span><span style="color: #b4b4b4; line-height: 140%">;</span></p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #569cd6; line-height: 140%">if</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">acedEntSel</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">_T</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #d69d85; line-height: 140%">"\n Pick a PFACE\n"</span><span style="color: #b4b4b4; line-height: 140%">),</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">ent_name</span><span style="color: #b4b4b4; line-height: 140%">,</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: white; line-height: 140%">asDblArray</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">pickPnt</span><span style="color: #b4b4b4; line-height: 140%">))</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">!=</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">RTNORM</span><span style="color: #b4b4b4; line-height: 140%">)</span><span style="line-height: 140%"> </span><span style="color: #569cd6; line-height: 140%">return</span><span style="color: #b4b4b4; line-height: 140%">;</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #569cd6; line-height: 140%">if</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(!</span><span style="color: white; line-height: 140%">eOkVerify</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">acdbGetObjectId</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">entId</span><span style="color: #b4b4b4; line-height: 140%">,</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">ent_name</span><span style="color: #b4b4b4; line-height: 140%">)))</span><span style="line-height: 140%"> </span><span style="color: #569cd6; line-height: 140%">return</span><span style="color: #b4b4b4; line-height: 140%">;</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: white; line-height: 140%">AcDbSmartObjectPointer</span><span style="color: #b4b4b4; line-height: 140%">&lt;</span><span style="color: white; line-height: 140%">AcDbPolyFaceMesh</span><span style="color: #b4b4b4; line-height: 140%">&gt;</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">pFace</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">entId</span><span style="color: #b4b4b4; line-height: 140%">,</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">AcDb</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: white; line-height: 140%">kForWrite</span><span style="color: #b4b4b4; line-height: 140%">);</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #608b4e; line-height: 140%">// polyface mesh</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #569cd6; line-height: 140%">if</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(!</span><span style="color: white; line-height: 140%">eOkVerify</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">pFace</span><span style="color: #b4b4b4; line-height: 140%">.</span><span style="color: white; line-height: 140%">openStatus</span><span style="color: #b4b4b4; line-height: 140%">()))</span><span style="line-height: 140%"> </span><span style="color: #569cd6; line-height: 140%">return</span><span style="color: #b4b4b4; line-height: 140%">;</span></p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: white; line-height: 140%">AcGePoint3dArray</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">vertexArray</span><span style="color: #b4b4b4; line-height: 140%">;</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: white; line-height: 140%">AcArray</span><span style="color: #b4b4b4; line-height: 140%">&lt;</span><span style="color: white; line-height: 140%">Adesk</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: white; line-height: 140%">Int32</span><span style="color: #b4b4b4; line-height: 140%">&gt;</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">faceArray</span><span style="color: #b4b4b4; line-height: 140%">;</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: white; line-height: 140%">AcArray</span><span style="color: #b4b4b4; line-height: 140%">&lt;</span><span style="color: white; line-height: 140%">AcCmColor</span><span style="color: #b4b4b4; line-height: 140%">&gt;</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">colorArray</span><span style="color: #b4b4b4; line-height: 140%">;</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: white; line-height: 140%">AcArray</span><span style="color: #b4b4b4; line-height: 140%">&lt;</span><span style="color: white; line-height: 140%">AcDbObjectId</span><span style="color: #b4b4b4; line-height: 140%">&gt;</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">materialArray</span><span style="color: #b4b4b4; line-height: 140%">;</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: white; line-height: 140%">Acad</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: white; line-height: 140%">ErrorStatus</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">es</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">GetPolyFaceMeshData</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">pFace</span><span style="color: #b4b4b4; line-height: 140%">,</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">vertexArray</span><span style="color: #b4b4b4; line-height: 140%">,</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">faceArray</span><span style="color: #b4b4b4; line-height: 140%">);</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #569cd6; line-height: 140%">if</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">es</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">!=</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">eOk</span><span style="color: #b4b4b4; line-height: 140%">)</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">return</span><span style="color: #b4b4b4; line-height: 140%">;</span></p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #608b4e; line-height: 140%">/*Mesh Type ":</span></p>
<p style="margin: 0px"><span style="color: #608b4e; line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Specifies the type of mesh to be used in the conversion. (FACETERMESHTYPE system variable)</span></p>
<p style="margin: 0px"><span style="color: #608b4e; line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 : Smooth Mesh Optimized. Sets the shape of the mesh faces to adapt to the shape of the mesh object.</span></p>
<p style="margin: 0px"><span style="color: #608b4e; line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1 : Mostly Quads. Sets the shape of the mesh faces to be mostly quadrilateral.</span></p>
<p style="margin: 0px"><span style="color: #608b4e; line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2 : Triangles. Sets the shape of the mesh faces to be mostly triangular.*/</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #569cd6; line-height: 140%">int</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">faceterMeshType</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #b5cea8; line-height: 140%">0</span><span style="color: #b4b4b4; line-height: 140%">;</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #569cd6; line-height: 140%">int</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">nSmoothLevel</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #b5cea8; line-height: 140%">0</span><span style="color: #b4b4b4; line-height: 140%">;</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #569cd6; line-height: 140%">int</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">nMaxFaces</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #b5cea8; line-height: 140%">0</span><span style="color: #b4b4b4; line-height: 140%">;</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: white; line-height: 140%">resbuf</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">rb</span><span style="color: #b4b4b4; line-height: 140%">;</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #608b4e; line-height: 140%">/*</span></p>
<p style="margin: 0px"><span style="color: #608b4e; line-height: 140%">&nbsp; This variable sets the default level of smoothness that is applied to </span></p>
<p style="margin: 0px"><span style="color: #608b4e; line-height: 140%">&nbsp; mesh that is created as a result of conversion from another object with the MESHSMOOTH command.</span></p>
<p style="margin: 0px"><span style="color: #608b4e; line-height: 140%">&nbsp; The value cannot be greater than the value of SMOOTHMESHMAXLEV.</span></p>
<p style="margin: 0px"><span style="color: #608b4e; line-height: 140%">&nbsp; */</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #569cd6; line-height: 140%">if</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">acedGetVar</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">_T</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #d69d85; line-height: 140%">"FACETERSMOOTHLEV"</span><span style="color: #b4b4b4; line-height: 140%">),</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">&amp;</span><span style="color: white; line-height: 140%">rb</span><span style="color: #b4b4b4; line-height: 140%">)</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">==</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">RTNORM</span><span style="color: #b4b4b4; line-height: 140%">)</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">{</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: white; line-height: 140%">nSmoothLevel</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">rb</span><span style="color: #b4b4b4; line-height: 140%">.</span><span style="color: white; line-height: 140%">resval</span><span style="color: #b4b4b4; line-height: 140%">.</span><span style="color: white; line-height: 140%">rint</span><span style="color: #b4b4b4; line-height: 140%">;</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: white; line-height: 140%">nSmoothLevel</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">nSmoothLevel</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">&lt;</span><span style="line-height: 140%"> </span><span style="color: #b5cea8; line-height: 140%">0</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">?</span><span style="line-height: 140%"> </span><span style="color: #b5cea8; line-height: 140%">0</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">:</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">nSmoothLevel</span><span style="color: #b4b4b4; line-height: 140%">);</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">}</span><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #569cd6; line-height: 140%">if</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">acedGetVar</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">_T</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #d69d85; line-height: 140%">"FACETERMESHTYPE"</span><span style="color: #b4b4b4; line-height: 140%">),</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">&amp;</span><span style="color: white; line-height: 140%">rb</span><span style="color: #b4b4b4; line-height: 140%">)</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">==</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">RTNORM</span><span style="color: #b4b4b4; line-height: 140%">)</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">{</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: white; line-height: 140%">faceterMeshType</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">rb</span><span style="color: #b4b4b4; line-height: 140%">.</span><span style="color: white; line-height: 140%">resval</span><span style="color: #b4b4b4; line-height: 140%">.</span><span style="color: white; line-height: 140%">rint</span><span style="color: #b4b4b4; line-height: 140%">;</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">}</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #569cd6; line-height: 140%">int</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">newSubdLevel</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">faceterMeshType</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">==</span><span style="line-height: 140%"> </span><span style="color: #b5cea8; line-height: 140%">0</span><span style="color: #b4b4b4; line-height: 140%">)</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">?</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">nSmoothLevel</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">:</span><span style="line-height: 140%"> </span><span style="color: #b5cea8; line-height: 140%">0</span><span style="color: #b4b4b4; line-height: 140%">;</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #569cd6; line-height: 140%">int</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">oldSubdLevel</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">nSmoothLevel</span><span style="color: #b4b4b4; line-height: 140%">;</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #608b4e; line-height: 140%">// If oldSubdivLevel &gt; SmoothMeshMaxLev, we need to reset oldSubdivLevel</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #608b4e; line-height: 140%">// value to SmoothMeshMaxLev.</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #608b4e; line-height: 140%">// If newSubdivLevel &gt; SmoothMeshMaxLev, we need to reset newSubdivLevel</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #608b4e; line-height: 140%">// value to SmoothMeshMaxLev.</span></p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #608b4e; line-height: 140%">//The valid range is from 1 to 255. The recommended range is 1 - 5.</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #608b4e; line-height: 140%">//Use this limit to prevent creating extremely dense meshes that might affect program performance.</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #569cd6; line-height: 140%">if</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">acedGetVar</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">_T</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #d69d85; line-height: 140%">"SMOOTHMESHMAXLEV"</span><span style="color: #b4b4b4; line-height: 140%">),</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">&amp;</span><span style="color: white; line-height: 140%">rb</span><span style="color: #b4b4b4; line-height: 140%">)</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">==</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">RTNORM</span><span style="color: #b4b4b4; line-height: 140%">)</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">{</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">int</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">nMaxLevel</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">rb</span><span style="color: #b4b4b4; line-height: 140%">.</span><span style="color: white; line-height: 140%">resval</span><span style="color: #b4b4b4; line-height: 140%">.</span><span style="color: white; line-height: 140%">rint</span><span style="color: #b4b4b4; line-height: 140%">;</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">if</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">nMaxLevel</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">&gt;=</span><span style="line-height: 140%"> </span><span style="color: #b5cea8; line-height: 140%">0</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">&amp;&amp;</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">oldSubdLevel</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">&gt;</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">nMaxLevel</span><span style="color: #b4b4b4; line-height: 140%">)</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: white; line-height: 140%">oldSubdLevel</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">nMaxLevel</span><span style="color: #b4b4b4; line-height: 140%">;</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">if</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">nMaxLevel</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">&gt;=</span><span style="line-height: 140%"> </span><span style="color: #b5cea8; line-height: 140%">0</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">&amp;&amp;</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">newSubdLevel</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">&gt;</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">nMaxLevel</span><span style="color: #b4b4b4; line-height: 140%">)</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: white; line-height: 140%">newSubdLevel</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">nMaxLevel</span><span style="color: #b4b4b4; line-height: 140%">;</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">}</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #608b4e; line-height: 140%">/*We create an in-memory mesh and convert mesh to solid*/</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: white; line-height: 140%">AcDbSubDMesh</span><span style="color: #b4b4b4; line-height: 140%">*</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">pSubDMesh</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #569cd6; line-height: 140%">nullptr</span><span style="color: #b4b4b4; line-height: 140%">;</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #569cd6; line-height: 140%">if</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(!</span><span style="color: white; line-height: 140%">eOkVerify</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">CreateSubdMesh</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">vertexArray</span><span style="color: #b4b4b4; line-height: 140%">,</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">faceArray</span><span style="color: #b4b4b4; line-height: 140%">,</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">newSubdLevel</span><span style="color: #b4b4b4; line-height: 140%">,</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">pSubDMesh</span><span style="color: #b4b4b4; line-height: 140%">)))</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">return</span><span style="color: #b4b4b4; line-height: 140%">;</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: white; line-height: 140%">pSubDMesh</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: white; line-height: 140%">setPropertiesFrom</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">pFace</span><span style="color: #b4b4b4; line-height: 140%">);</span><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #608b4e; line-height: 140%">/*Create A solid and Convert SubDMesh to Solid*/</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: white; line-height: 140%">AcDb3dSolid</span><span style="color: #b4b4b4; line-height: 140%">*</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">pMeshSolid</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #569cd6; line-height: 140%">new</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">AcDb3dSolid</span><span style="color: #b4b4b4; line-height: 140%">();</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: white; line-height: 140%">AcDbObjectId</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">meshSolId</span><span style="color: #b4b4b4; line-height: 140%">;</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #608b4e; line-height: 140%">/*Now convert to Solid using CONVTOSOLID&nbsp; API*/</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #608b4e; line-height: 140%">/*We will restrict to polygonal solid, we set false for smoothness, so not to abuse CPU*/</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: white; line-height: 140%">pSubDMesh</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: white; line-height: 140%">convertToSolid</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #569cd6; line-height: 140%">false</span><span style="color: #b4b4b4; line-height: 140%">,</span><span style="line-height: 140%"> </span><span style="color: #569cd6; line-height: 140%">false</span><span style="color: #b4b4b4; line-height: 140%">,</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">pMeshSolid</span><span style="color: #b4b4b4; line-height: 140%">);</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: white; line-height: 140%">postToDatabase</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">NULL</span><span style="color: #b4b4b4; line-height: 140%">,</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">pMeshSolid</span><span style="color: #b4b4b4; line-height: 140%">,</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">meshSolId</span><span style="color: #b4b4b4; line-height: 140%">);</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #608b4e; line-height: 140%">/*Delete Pface */</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #569cd6; line-height: 140%">if</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">pFace</span><span style="color: #b4b4b4; line-height: 140%">)</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">{</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: white; line-height: 140%">pFace</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: white; line-height: 140%">erase</span><span style="color: #b4b4b4; line-height: 140%">();</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">}</span></p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">}</span></p></div>
<p>Helper Methods </p>
<div style="font-size: 12pt; font-family: consolas; background: #1e1e1e; color: #dcdcdc">
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #608b4e; line-height: 140%">/*Get the Mesh data, not accounted for Color and Material of Faces*/</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: white; line-height: 140%">Acad</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: white; line-height: 140%">ErrorStatus</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">GetPolyFaceMeshData</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">AcDbPolyFaceMesh</span><span style="color: #b4b4b4; line-height: 140%">*</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">pMesh</span><span style="color: #b4b4b4; line-height: 140%">,</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: white; line-height: 140%">AcGePoint3dArray</span><span style="color: #b4b4b4; line-height: 140%">&amp;</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">vertexArray</span><span style="color: #b4b4b4; line-height: 140%">,</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: white; line-height: 140%">AcArray</span><span style="color: #b4b4b4; line-height: 140%">&lt;</span><span style="color: white; line-height: 140%">Adesk</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: white; line-height: 140%">Int32</span><span style="color: #b4b4b4; line-height: 140%">&gt;&amp;</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">faceArray</span><span style="color: #b4b4b4; line-height: 140%">)</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">{</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">if</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">pMesh</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">==</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">NULL</span><span style="color: #b4b4b4; line-height: 140%">)</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">return</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">eNullObjectPointer</span><span style="color: #b4b4b4; line-height: 140%">;</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">const</span><span style="line-height: 140%"> </span><span style="color: #569cd6; line-height: 140%">bool</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">dbResident</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">pMesh</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: white; line-height: 140%">database</span><span style="color: #b4b4b4; line-height: 140%">()</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">!=</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">NULL</span><span style="color: #b4b4b4; line-height: 140%">);</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: white; line-height: 140%">AcDbObjectIterator</span><span style="color: #b4b4b4; line-height: 140%">*</span><span style="line-height: 140%">&nbsp; </span><span style="color: white; line-height: 140%">pIter</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">pMesh</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: white; line-height: 140%">vertexIterator</span><span style="color: #b4b4b4; line-height: 140%">();</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">if</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">pIter</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">==</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">NULL</span><span style="color: #b4b4b4; line-height: 140%">)</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">return</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">eNullObjectPointer</span><span style="color: #b4b4b4; line-height: 140%">;</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: white; line-height: 140%">Acad</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: white; line-height: 140%">ErrorStatus</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">es</span><span style="color: #b4b4b4; line-height: 140%">;</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: white; line-height: 140%">AcGePoint3d</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">pt</span><span style="color: #b4b4b4; line-height: 140%">;</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: white; line-height: 140%">AcDbVertex</span><span style="color: #b4b4b4; line-height: 140%">*</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">pVtxObj</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">NULL</span><span style="color: #b4b4b4; line-height: 140%">;</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: white; line-height: 140%">AcDbPolyFaceMeshVertex</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">*</span><span style="color: white; line-height: 140%">pVertex</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">NULL</span><span style="color: #b4b4b4; line-height: 140%">;</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: white; line-height: 140%">AcDbFaceRecord</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">*</span><span style="color: white; line-height: 140%">pFaceRec</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">NULL</span><span style="color: #b4b4b4; line-height: 140%">;</span><span style="line-height: 140%">&nbsp; </span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">int</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">nFaces</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">pMesh</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: white; line-height: 140%">numFaces</span><span style="color: #b4b4b4; line-height: 140%">();</span><span style="line-height: 140%">&nbsp; </span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">for</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(;</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">!</span><span style="color: white; line-height: 140%">pIter</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: white; line-height: 140%">done</span><span style="color: #b4b4b4; line-height: 140%">();</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">pIter</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: white; line-height: 140%">step</span><span style="color: #b4b4b4; line-height: 140%">())</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">{</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">if</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">acdbHostApplicationServices</span><span style="color: #b4b4b4; line-height: 140%">()-&gt;</span><span style="color: white; line-height: 140%">userBreak</span><span style="color: #b4b4b4; line-height: 140%">())</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">{</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">delete</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">pIter</span><span style="color: #b4b4b4; line-height: 140%">;</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">return</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">eUserBreak</span><span style="color: #b4b4b4; line-height: 140%">;</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">}</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">if</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">dbResident</span><span style="color: #b4b4b4; line-height: 140%">)</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">{</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: white; line-height: 140%">es</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">acdbOpenObject</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">pVtxObj</span><span style="color: #b4b4b4; line-height: 140%">,</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">pIter</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: white; line-height: 140%">objectId</span><span style="color: #b4b4b4; line-height: 140%">(),</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">AcDb</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: white; line-height: 140%">kForRead</span><span style="color: #b4b4b4; line-height: 140%">);</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">if</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">es</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">!=</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">Acad</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: white; line-height: 140%">eOk</span><span style="color: #b4b4b4; line-height: 140%">)</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">continue</span><span style="color: #b4b4b4; line-height: 140%">;</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">}</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">else</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">{</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: white; line-height: 140%">pVtxObj</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">AcDbVertex</span><span style="color: #b4b4b4; line-height: 140%">*)</span><span style="color: white; line-height: 140%">pIter</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: white; line-height: 140%">entity</span><span style="color: #b4b4b4; line-height: 140%">();</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">}</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #608b4e; line-height: 140%">// Build vertex list</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">if</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">((</span><span style="color: white; line-height: 140%">pVertex</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">AcDbPolyFaceMeshVertex</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: white; line-height: 140%">cast</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">pVtxObj</span><span style="color: #b4b4b4; line-height: 140%">))</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">!=</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">NULL</span><span style="color: #b4b4b4; line-height: 140%">)</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">{</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: white; line-height: 140%">pt</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">pVertex</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: white; line-height: 140%">position</span><span style="color: #b4b4b4; line-height: 140%">();</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: white; line-height: 140%">vertexArray</span><span style="color: #b4b4b4; line-height: 140%">.</span><span style="color: white; line-height: 140%">append</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">pt</span><span style="color: #b4b4b4; line-height: 140%">);</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">}</span><span style="color: #608b4e; line-height: 140%">// Build face list&nbsp;&nbsp;&nbsp; </span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">else</span><span style="line-height: 140%"> </span><span style="color: #569cd6; line-height: 140%">if</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">((</span><span style="color: white; line-height: 140%">pFaceRec</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">AcDbFaceRecord</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: white; line-height: 140%">cast</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">pVtxObj</span><span style="color: #b4b4b4; line-height: 140%">))</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">!=</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">NULL</span><span style="color: #b4b4b4; line-height: 140%">)</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">{</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">int</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">count</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #b5cea8; line-height: 140%">0</span><span style="color: #b4b4b4; line-height: 140%">;</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: white; line-height: 140%">Adesk</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: white; line-height: 140%">Int16</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">indices</span><span style="color: #b4b4b4; line-height: 140%">[</span><span style="color: #b5cea8; line-height: 140%">4</span><span style="color: #b4b4b4; line-height: 140%">],</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">newIndex</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="color: #b5cea8; line-height: 140%">0</span><span style="color: #b4b4b4; line-height: 140%">;</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">for</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #569cd6; line-height: 140%">int</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">i</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #b5cea8; line-height: 140%">0</span><span style="color: #b4b4b4; line-height: 140%">;</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">i</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">&lt;</span><span style="line-height: 140%"> </span><span style="color: #b5cea8; line-height: 140%">4</span><span style="color: #b4b4b4; line-height: 140%">;</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">i</span><span style="color: #b4b4b4; line-height: 140%">++)</span><span style="line-height: 140%"> </span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">{</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: white; line-height: 140%">pFaceRec</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: white; line-height: 140%">getVertexAt</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">i</span><span style="color: #b4b4b4; line-height: 140%">,</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">indices</span><span style="color: #b4b4b4; line-height: 140%">[</span><span style="color: white; line-height: 140%">i</span><span style="color: #b4b4b4; line-height: 140%">]);</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">if</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">indices</span><span style="color: #b4b4b4; line-height: 140%">[</span><span style="color: white; line-height: 140%">i</span><span style="color: #b4b4b4; line-height: 140%">]</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">==</span><span style="line-height: 140%"> </span><span style="color: #b5cea8; line-height: 140%">0</span><span style="color: #b4b4b4; line-height: 140%">)</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">break</span><span style="color: #b4b4b4; line-height: 140%">;</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: white; line-height: 140%">count</span><span style="color: #b4b4b4; line-height: 140%">++;</span></p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">}</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #608b4e; line-height: 140%">// Quick triangle test by checking if the first vertex</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #608b4e; line-height: 140%">// is the same as the last vertex</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">if</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">count</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">==</span><span style="line-height: 140%"> </span><span style="color: #b5cea8; line-height: 140%">4</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">&amp;&amp;</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">abs</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">indices</span><span style="color: #b4b4b4; line-height: 140%">[</span><span style="color: #b5cea8; line-height: 140%">0</span><span style="color: #b4b4b4; line-height: 140%">])</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">==</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">abs</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">indices</span><span style="color: #b4b4b4; line-height: 140%">[</span><span style="color: #b5cea8; line-height: 140%">3</span><span style="color: #b4b4b4; line-height: 140%">])))</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: white; line-height: 140%">count</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #b5cea8; line-height: 140%">3</span><span style="color: #b4b4b4; line-height: 140%">;</span></p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #608b4e; line-height: 140%">// Per face record can be a triangle or quad</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">if</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">count</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">&gt;</span><span style="line-height: 140%"> </span><span style="color: #b5cea8; line-height: 140%">2</span><span style="color: #b4b4b4; line-height: 140%">)</span><span style="line-height: 140%"> </span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">{</span><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: white; line-height: 140%">faceArray</span><span style="color: #b4b4b4; line-height: 140%">.</span><span style="color: white; line-height: 140%">append</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">count</span><span style="color: #b4b4b4; line-height: 140%">);</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">for</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: #569cd6; line-height: 140%">int</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">i</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #b5cea8; line-height: 140%">0</span><span style="color: #b4b4b4; line-height: 140%">;</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">i</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">&lt;</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">count</span><span style="color: #b4b4b4; line-height: 140%">;</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">i</span><span style="color: #b4b4b4; line-height: 140%">++)</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">{</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: white; line-height: 140%">newIndex</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">abs</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">indices</span><span style="color: #b4b4b4; line-height: 140%">[</span><span style="color: white; line-height: 140%">i</span><span style="color: #b4b4b4; line-height: 140%">])</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">-</span><span style="line-height: 140%"> </span><span style="color: #b5cea8; line-height: 140%">1</span><span style="color: #b4b4b4; line-height: 140%">;</span></p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: white; line-height: 140%">faceArray</span><span style="color: #b4b4b4; line-height: 140%">.</span><span style="color: white; line-height: 140%">append</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">newIndex</span><span style="color: #b4b4b4; line-height: 140%">);</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">}</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">}</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">}</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">if</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">dbResident</span><span style="color: #b4b4b4; line-height: 140%">)</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: white; line-height: 140%">pVtxObj</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: white; line-height: 140%">close</span><span style="color: #b4b4b4; line-height: 140%">();</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">}</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">delete</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">pIter</span><span style="color: #b4b4b4; line-height: 140%">;</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">return</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">eOk</span><span style="color: #b4b4b4; line-height: 140%">;</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">}</span></p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: white; line-height: 140%">Acad</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: white; line-height: 140%">ErrorStatus</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">CreateSubdMesh</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">AcGePoint3dArray</span><span style="color: #b4b4b4; line-height: 140%">&amp;</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">vertexArray</span><span style="color: #b4b4b4; line-height: 140%">,</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: white; line-height: 140%">AcArray</span><span style="color: #b4b4b4; line-height: 140%">&lt;</span><span style="color: white; line-height: 140%">Adesk</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: white; line-height: 140%">Int32</span><span style="color: #b4b4b4; line-height: 140%">&gt;&amp;</span><span style="line-height: 140%">&nbsp; </span><span style="color: white; line-height: 140%">faceArray</span><span style="color: #b4b4b4; line-height: 140%">,</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">int</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">nSubdivLevel</span><span style="color: #b4b4b4; line-height: 140%">,</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: white; line-height: 140%">AcDbSubDMesh</span><span style="color: #b4b4b4; line-height: 140%">*&amp;</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">poly</span><span style="color: #b4b4b4; line-height: 140%">)</span></p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">{</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">if</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">vertexArray</span><span style="color: #b4b4b4; line-height: 140%">.</span><span style="color: white; line-height: 140%">length</span><span style="color: #b4b4b4; line-height: 140%">()</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">&lt;=</span><span style="line-height: 140%"> </span><span style="color: #b5cea8; line-height: 140%">0</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">||</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">faceArray</span><span style="color: #b4b4b4; line-height: 140%">.</span><span style="color: white; line-height: 140%">length</span><span style="color: #b4b4b4; line-height: 140%">()</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">&lt;=</span><span style="line-height: 140%"> </span><span style="color: #b5cea8; line-height: 140%">0</span><span style="color: #b4b4b4; line-height: 140%">)</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">return</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">Acad</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: white; line-height: 140%">eCreateFailed</span><span style="color: #b4b4b4; line-height: 140%">;</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: white; line-height: 140%">poly</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: #569cd6; line-height: 140%">new</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">AcDbSubDMesh</span><span style="color: #b4b4b4; line-height: 140%">();</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: white; line-height: 140%">ASSERT</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">poly</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">!=</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">NULL</span><span style="color: #b4b4b4; line-height: 140%">);</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">if</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">poly</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">==</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">NULL</span><span style="color: #b4b4b4; line-height: 140%">)</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">return</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">Acad</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: white; line-height: 140%">eCreateFailed</span><span style="color: #b4b4b4; line-height: 140%">;</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: white; line-height: 140%">Acad</span><span style="color: #b4b4b4; line-height: 140%">::</span><span style="color: white; line-height: 140%">ErrorStatus</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">es</span><span style="line-height: 140%"> </span><span style="color: #b4b4b4; line-height: 140%">=</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">poly</span><span style="color: #b4b4b4; line-height: 140%">-&gt;</span><span style="color: white; line-height: 140%">setSubDMesh</span><span style="color: #b4b4b4; line-height: 140%">(</span><span style="color: white; line-height: 140%">vertexArray</span><span style="color: #b4b4b4; line-height: 140%">,</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">faceArray</span><span style="color: #b4b4b4; line-height: 140%">,</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">nSubdivLevel</span><span style="color: #b4b4b4; line-height: 140%">);</span></p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp;&nbsp;&nbsp; </span><span style="color: #569cd6; line-height: 140%">return</span><span style="line-height: 140%"> </span><span style="color: white; line-height: 140%">es</span><span style="color: #b4b4b4; line-height: 140%">;</span></p>
<p style="margin: 0px">&nbsp;</p>
<p style="margin: 0px"><span style="line-height: 140%">&nbsp; </span><span style="color: #b4b4b4; line-height: 140%">}</span></p></div><iframe height="400" src="https://screencast.autodesk.com/Embed/Timeline/61f529b5-f6f0-44c0-b1d6-4c1a254a1067" frameborder="0" width="640" webkitallowfullscreen allowfullscreen></iframe>
