---
layout: "post"
title: "Use system variables to get lower left and upper right coordinates of the model space viewport"
date: "2012-12-20 17:11:32"
author: "Gopinath Taget"
categories:
  - "2010"
  - "2011"
  - "2012"
  - "2013"
  - "ActiveX"
  - "AutoCAD"
  - "Gopinath Taget"
original_url: "https://adndevblog.typepad.com/autocad/2012/12/use-system-variables-to-get-lower-left-and-upper-right-coordinates-of-the-model-space-viewport.html "
typepad_basename: "use-system-variables-to-get-lower-left-and-upper-right-coordinates-of-the-model-space-viewport"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/gopinath-taget.html">Gopinath Taget</a></p> <p>You can use the system variables VIEWCTR, VIEWSIZE and SCREENSIZE to calculate the lower left and upper right coordinates of the current viewport in the ModelSpace . The VIEWCTR system variable has the view center coordinates reported in current UCS. So steps to follow to get the required coordinates are: <p>1) Get the VIEWCENTER in current UCS and transform the point to DCS (Display Coordinate System) <p>2) Get the VIEWSIZE, which is the height of the view. <p>3) Get the screen aspect ratio using SCREENSIZE system variable. Using the value returned by SCREENSIZE, get the screen width and screen height. SCREENSIZE returns a list of two reals, first one is the screen width and second one is screen height. <p>4) Calculate the width of the view using the formula: width = height * (screenwidth/screenheight) <p>5) Calculate the lower left corner as: <p>LL(x) = center(x) - (width / 2)<br>LL(y) = center(y) - (height / 2) <p>6) Calculate the Upper right corner as: <p>UR(x) = center(x) + (width / 2)<br>UR(y) = center(y) + (height / 2) <p>7) Transform the LL and UR coordinates from DCS to WCS. Note that this will return the points that lie in the DCS XY plane, reported in WCS. <p>The following code shows how to do this using the ActiveX API in VB/A.&nbsp; It also draws a line joining both the points. <div style="font-family: ; background: white"> <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#0000ff"><font style="font-size: 8pt">Private</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt"><font color="#0000ff">Sub</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> fViewExtents()</font></span></font></p> <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&nbsp; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#0000ff">Dim</font></span><span style="line-height: 11pt"><font color="#000000"> pdHeight </font></span><span style="line-height: 11pt"><font color="#0000ff">As</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#0000ff">Double</font></span></font></p> <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&nbsp; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#0000ff">Dim</font></span><span style="line-height: 11pt"><font color="#000000"> pdWidth </font></span><span style="line-height: 11pt"><font color="#0000ff">As</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#0000ff">Double</font></span></font></p> <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&nbsp; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#0000ff">Dim</font></span><span style="line-height: 11pt"><font color="#000000"> pvCtr </font></span><span style="line-height: 11pt"><font color="#0000ff">As</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt"><font color="#0000ff">Varian</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">t</font></span></font></p> <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&nbsp; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#0000ff">Dim</font></span><span style="line-height: 11pt"><font color="#000000"> pvScreenSize </font></span><span style="line-height: 11pt"><font color="#0000ff">As</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt"><font color="#0000ff">Varian</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">t</font></span></font></p> <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&nbsp; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#0000ff">Dim</font></span><span style="line-height: 11pt"><font color="#000000"> pdMin(2) </font></span><span style="line-height: 11pt"><font color="#0000ff">As</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#0000ff">Double</font></span></font></p> <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&nbsp; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#0000ff">Dim</font></span><span style="line-height: 11pt"><font color="#000000"> pdMax(2) </font></span><span style="line-height: 11pt"><font color="#0000ff">As</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#0000ff">Double</font></span></font></p> <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&nbsp;</font></font></p> <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&nbsp; </font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#008000">'Center Point of the View</font></span></font></p> <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&nbsp; pvCtr = ThisDrawing.GetVariable(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#a31515">"VIEWCTR"</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">)</font></span></font></p> <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&nbsp; pvCtr = ThisDrawing.Utility.TranslateCoordinates(</font></font></span></p> <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&nbsp;&nbsp;&nbsp; pvCtr, acUCS, acDisplayDCS, 0)</font></font></span></p> <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&nbsp;</font></font></p> <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&nbsp; </font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#008000">'Screen resolution</font></span></font></p> <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&nbsp; pvScreenSize = ThisDrawing.GetVariable(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#a31515">"SCREENSIZE"</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">)</font></span></font></p> <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&nbsp;</font></font></p> <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&nbsp; </font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#008000">'Screen Height</font></span></font></p> <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&nbsp; pdHeight = ThisDrawing.GetVariable(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#a31515">"VIEWSIZE"</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">)</font></span></font></p> <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&nbsp;</font></font></p> <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&nbsp; </font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#008000">'Screen Length</font></span></font></p> <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&nbsp; pdWidth = pdHeight * (pvScreenSize(0) / pvScreenSize(1))</font></font></span></p> <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&nbsp;</font></font></p> <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&nbsp; </font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#008000">'lower left</font></span></font></p> <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&nbsp; pdMin(0) = pvCtr(0) - (pdWidth / 2)</font></font></span></p> <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&nbsp; pdMin(1) = pvCtr(1) - (pdHeight / 2)</font></font></span></p> <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&nbsp;</font></font></p> <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&nbsp; </font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#008000">'upper right</font></span></font></p> <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&nbsp; pdMax(0) = pvCtr(0) + (pdWidth / 2)</font></font></span></p> <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&nbsp; pdMax(1) = pvCtr(1) + (pdHeight / 2)</font></font></span></p> <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&nbsp;</font></font></p> <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&nbsp; </font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#008000">'draw the line</font></span></font></p> <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&nbsp; ThisDrawing.ModelSpace.AddLine ThisDrawing.Utility.</font></font></span></p> <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&nbsp;&nbsp;&nbsp; TranslateCoordinates(pdMin, acDisplayDCS, acUCS, 0), _</font></font></span></p> <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&nbsp; ThisDrawing.Utility.TranslateCoordinates(</font></font></span></p> <p style="margin: 0px"><span style="line-height: 11pt"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&nbsp;&nbsp;&nbsp; pdMax, acDisplayDCS, acWorld, 0)</font></font></span></p> <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&nbsp;</font></font></p> <p style="margin: 0px"><font face="Consolas"><span style="line-height: 11pt"><font color="#0000ff"><font style="font-size: 8pt">End</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#000000"> </font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#0000ff">Sub</font></span></font></p></div><pre></pre>
