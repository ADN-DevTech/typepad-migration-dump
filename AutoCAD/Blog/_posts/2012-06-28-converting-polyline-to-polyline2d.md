---
layout: "post"
title: "Converting Polyline to Polyline2d"
date: "2012-06-28 11:34:59"
author: "Augusto Goncalves"
categories:
  - ".NET"
  - "Augusto Goncalves"
  - "AutoCAD"
original_url: "https://adndevblog.typepad.com/autocad/2012/06/converting-polyline-to-polyline2d.html "
typepad_basename: "converting-polyline-to-polyline2d"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/augusto-goncalves.html" target="_blank">Augusto Goncalves</a></p>  <p>There is a method called <strong>Polyline.ConvertTo</strong> that can convert a lightweight polyline into a polyline 2d object, but this method requires a special treatment. </p>  <p>First, it is required to use <strong>StartOpenCloseTransaction</strong> method to create a new transaction, instead regular <strong>StartTransaction</strong>. Second, remove the old polyline and append the newly created polyline 2d. </p>  <div style="font-family: ; background: white">   <p style="margin: 0px"><font face="Courier New"><span><font color="#2b91af"><font style="font-size: 8pt">ObjectId</font></font></span><font style="font-size: 8pt"><font color="#000000"> plineId = </font></font><span><font style="font-size: 8pt" color="#008000">// obtain here...</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#2b91af"><font style="font-size: 8pt">Database</font></font></span><font style="font-size: 8pt"><font color="#000000"> db = </font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt"><font color="#000000">&#160; </font><span><font color="#2b91af">Application</font></span><font color="#000000">.DocumentManager.MdiActiveDocument.Database;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><font style="font-size: 8pt"><font color="#000000"> (</font><span><font color="#2b91af">Transaction</font></span><font color="#000000"> t = </font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; db.TransactionManager.StartOpenCloseTransaction())</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">{</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">using</font></span><font color="#000000"> (</font><span><font color="#2b91af">Polyline</font></span><font color="#000000"> pline = (</font><span><font color="#2b91af">Polyline</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; t.GetObject(plineId, </font></font><font style="font-size: 8pt"><span><font color="#2b91af">OpenMode</font></span><font color="#000000">.ForWrite))</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; {</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; t.AddNewlyCreatedDBObject(pline, </font></font><font style="font-size: 8pt"><span><font color="#0000ff">false</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">Polyline2d</font></span><font color="#000000"> poly2 = pline.ConvertTo(</font><span><font color="#0000ff">true</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; t.AddNewlyCreatedDBObject(poly2, </font></font><font style="font-size: 8pt"><span><font color="#0000ff">true</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; t.Commit();</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; }</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">}</font></font></p> </div>
