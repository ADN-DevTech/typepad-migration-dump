---
layout: "post"
title: "Managed Debugging Assistant 'DisconnectedContext' error"
date: "2013-07-23 04:53:36"
author: "Marat Mirgaleev"
categories:
  - "AutoCAD"
  - "Marat Mirgaleev"
original_url: "https://adndevblog.typepad.com/autocad/2013/07/managed-debugging-assistant-disconnectedcontext-error.html "
typepad_basename: "managed-debugging-assistant-disconnectedcontext-error"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/marat-mirgaleev.html" target="_self">Marat Mirgaleev</a></p>  <p><strong>Issue</strong></p>  <p><em>I start an external application f<em>rom my custom command and wait until it finishes: </em></em></p>  <div style="font-family: consolas; background: white; color: black; font-size: 10pt">   <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> ExternalApp </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">New</span><span style="line-height: 140%"> System.Diagnostics.</span><span style="line-height: 140%; color: #2b91af">Process</span><span style="line-height: 140%">()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; ExternalApp.StartInfo.FileName = </span><span style="line-height: 140%; color: #a31515">&quot;myApp.exe&quot;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; ExternalApp.Start()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; ExternalApp.WaitForExit()</span></p> </div>  <p><em>The problem is that after 10-15 minutes a message appears:</em></p>  <p><font size="1" face="Courier New">Managed Debugging Assistant 'DisconnectedContext' has detected a problem in 'C:\Program Files\Autodesk\AutoCAD 2014\acad.exe'.</font></p>  <p><font size="1" face="Courier New">Additional Information: Context 0x163158 is disconnected. No proxy will be used to service the request on the COM component. This may cause corruption or data loss. To avoid this problem, please ensure that all contexts/apartments stay alive until the application is completely done with the RuntimeCallableWrappers that represent COM components that live inside them.</font></p>  <p><em>After that AutoCAD becomes unstable and may crash.</em></p>  <p><em>Could you let me know why this happens and how to solve it?</em></p>  <p><strong>Solution</strong></p>  <p>In the code snippet above the WaitForExit() call is holding up the main thread, so AutoCAD cannot dispatch messages. This is going to cause all sorts of problems (e.g. Windows will “think” that the app is hung and replace the main window with its own shadow copy).</p>  <p>You should come up with a solution that does not block the main thread or, the very least, you should run a message loop that dispatches messages.</p>  <p>If you would like to do some background processing in AutoCAD, this link may help: <a href="http://adndevblog.typepad.com/autocad/2012/06/use-thread-for-background-processing.html" target="_blank">Use Thread for background processing</a></p>
