---
layout: "post"
title: "How to create your own AutoCAD OEM Help CHM from the 2012/2013 HTML source"
date: "2012-08-27 17:16:04"
author: "Fenton Webb"
categories:
  - "2013"
  - "AutoCAD OEM"
  - "Fenton Webb"
original_url: "https://adndevblog.typepad.com/autocad/2012/08/how-to-create-your-own-autocad-oem-help-chm-from-the-2013-html-source.html "
typepad_basename: "how-to-create-your-own-autocad-oem-help-chm-from-the-2013-html-source"
typepad_status: "Publish"
---

<p>by <a href="http://adndevblog.typepad.com/autocad/fenton-webb.html"><font color="#0066cc">Fenton Webb</font></a></p>  <p>New in AutoCAD 2012 is the HTML help system (no more CHM). That said, contrary to what the OEM Developers Guide implies, in AutoCAD OEM, CHM’s are still required.</p>  <p>Here’s how to build your AutoCAD OEM 2012/2013 CHM from the supplied HTML source files.</p>  <p>You will first need to download and install <a href="http://www.microsoft.com/en-us/download/details.aspx?id=21138">Microsoft HTML Help</a>&#160;</p>  <p>I’m going to use my OEM2013 install, but it should be the same in OEM 2012 also.</p>  <p>Where I mention <strong>OEM2013</strong>, I mean C:\Program Files\Autodesk\OEM2013</p>  <p><strong><u>Step 1: Create default .hhp file</u></strong></p>  <p>Using a text editor, create a new&#160; .hhp file called MyOEMProduct.hhp and save it to the OEM2013\Help folder. The contents of this file should be as follows, edit the fields in the text file as you need:</p>  <p><font color="#666666">[OPTIONS]      <br />Auto TOC=9       <br />Compatibility=1.1 or later       <br />Compiled file=aoem.chm       <br />Default Window=TriPane       <br />Default topic=files\homepage.htm       <br />Display compile progress=Yes Error log file=log.log       <br />Full-text search=Yes       <br />Language=0x409 English (United States)</font></p>  <p><font color="#666666">[WINDOWS]      <br />TriPane=&quot;AutoCAD Whatever&quot;,,,,&quot;files\homepage.htm&quot;,,,,,0xe3520,255,0x304e,[0,0,800,600],,,,,,,0</font></p>  <p><font color="#666666">[FILES]      <br />index.html       <br /></font></p>  <p><strong><u>Step 2: Copy the context help .htm files to the OEM2013\Help folder</u></strong></p>  <p>Move or copy all the files from the OEM2013\Help\ConextHelp subfolder to the OEM2013\Help folder.</p>  <p><strong><u>Step 3: Repair the relative paths in the htm files</u></strong></p>  <p>Next, recursively replace all *.htm files which have the text </p>  <p><strong>.replace(‘../files</strong> </p>  <p>with </p>  <p><strong>.replace(‘./files</strong></p>  <p><strong><u>Step 4: Update the Java Script so it does nothing</u></strong></p>  <p>Edit <strong><em>common-processing.js </em></strong>so that the initFrame() just returns or comment out the entire function… </p>  <p>e.g.</p>  <p><font color="#666666">function initFrame(url,topicNumber,index,hash) </font></p>  <p><font color="#666666">{</font></p>  <p><font color="#666666">return; // just return and do nothing</font></p>  <p><font color="#666666"></font>    <br /><font color="#666666">&#160;&#160;&#160; if (top == self) {      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; var hashWithoutSharp;       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; if (hash !== undefined) {       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; hashWithoutSharp = hash.substring(1);       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; }       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; window.location.replace('../' + index + '?url=' + url + ',topicNumber=' + topicNumber + ((hashWithoutSharp) ? ',hash=' + hashWithoutSharp : ''));       <br />&#160;&#160;&#160; }       <br />}</font></p>  <p><strong><u>Step 5: Load your .hhc into HTML Help</u> </strong></p>  <p>Using HTML Help, load your MyOEMProduct.hhc into HTML Help. Be careful about permissions to the OEM2013\Help folder, if needed, change the owner of Program Files to be yourself (with full permissions) otherwise HTML Help may not be able to save.</p>  <p><strong><u>Step 6: Add all help files to the HTML Help Project</u></strong></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt"><span lang="EN-US" style="font-size: 12pt; font-family: &quot;Arial&quot;,&quot;sans-serif&quot;; color: #666666; mso-ansi-language: en-us"><font color="#000000">In DOS, create an hhp file by redirecting the file listing from DIR to a hhp file… e.g.</font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt"><span lang="EN-US" style="font-size: 12pt; font-family: &quot;Arial&quot;,&quot;sans-serif&quot;; color: #666666; mso-ansi-language: en-us"><font color="#000000"></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt"><span lang="EN-US" style="font-size: 12pt; font-family: &quot;Arial&quot;,&quot;sans-serif&quot;; color: #666666; mso-ansi-language: en-us">dir *.htm /B /S /R &gt;&gt; MyOEMProduct.hhp </span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt"><span lang="EN-US" style="font-size: 12pt; font-family: &quot;Arial&quot;,&quot;sans-serif&quot;; color: #666666; mso-ansi-language: en-us">dir style /B /S /R &gt;&gt; MyOEMProduct.hhp </span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt"><span lang="EN-US" style="font-size: 12pt; font-family: &quot;Arial&quot;,&quot;sans-serif&quot;; color: #666666; mso-ansi-language: en-us">dir scripts /B /S /R &gt;&gt; MyOEMProduct.hhp </span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt"><span lang="EN-US" style="font-size: 12pt; font-family: &quot;Arial&quot;,&quot;sans-serif&quot;; color: #666666; mso-ansi-language: en-us">dir images /B /S /R &gt;&gt; MyOEMProduct.hhp </span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt"><span lang="EN-US" style="font-size: 12pt; font-family: &quot;Arial&quot;,&quot;sans-serif&quot;; color: #666666; mso-ansi-language: en-us">dir html /B /S /R &gt;&gt; MyOEMProduct.hhp </span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt"><span lang="EN-US" style="font-size: 12pt; font-family: &quot;Arial&quot;,&quot;sans-serif&quot;; color: #666666; mso-ansi-language: en-us">dir files /B /S /R &gt;&gt; MyOEMProduct.hhp </span></p>  <p><strong><u>Step 7: Save the HTML Project and quit HTML Help.</u></strong></p>  <p><strong><u>Step 8: Edit style\acad.css to remove broken banners</u></strong></p>  <p>To get rid of the broken buttons in the banner, in style\acad.css make the following changes.</p>  <p>Change    <br />.headNavLinkShare {     <br />margin: 35px -18px 0 -18px;     <br />position:absolute;     <br />}</p>  <p>To    <br />.headNavLinkShare {     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; display: none;     <br />}</p>  <p>   <br />Change     <br />.headNavLinkAddToFav {     <br />margin: 35px -47px 0 -47px;     <br />position:absolute;     <br />}</p>  <p>To    <br />.headNavLinkAddToFav {     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; display: none;     <br />}</p>  <p>Change    <br />.headNavLinkHome {     <br />margin: 35px -76px 0 -76px;     <br />position:absolute;     <br />}</p>  <p>To    <br />.headNavLinkHome {     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; display: none;     <br />}     <br /></p>  <p><strong><u>Step 9: Create the Table of Contents (Optional)</u></strong></p>  <p>Normal AutoCAD does not have a Table Of Contents, but you can create your own if you want. Doing this will require substantial work to implement it correctly, so this is optional.</p>  <p>In HTML Help, simply click on the ‘Contents’ tab to create a TOC. </p>  <p><strong><u>Step 10: Build the CHM using HTML Help</u>&#160;</strong></p>  <p>Reload your MyOEMProduct.hhc into HTML Help and then hit the Generate button</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017c3181bd15970b-pi"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="/assets/image_460316.jpg" width="507" height="321" /></a></p>  <p><strong><u>Step 11: Sit back</u></strong></p>  <p>…watch as HTML Help generates the CHM file you! </p>  <p>If you have any high quality cigars to hand, you may want to use this time to select one from the box, clip the end off using your favourite cigar clipper, light up then place your alligator skin boots on the table in front of you to enjoy.</p>
