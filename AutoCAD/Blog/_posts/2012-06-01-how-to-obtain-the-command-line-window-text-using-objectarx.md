---
layout: "post"
title: "How to obtain the Command Line window Text using ObjectARX?"
date: "2012-06-01 17:04:02"
author: "Fenton Webb"
categories:
  - "2010"
  - "2011"
  - "2012"
  - "2013"
  - "AutoCAD"
  - "AutoCAD OEM"
  - "Fenton Webb"
  - "ObjectARX"
original_url: "https://adndevblog.typepad.com/autocad/2012/06/how-to-obtain-the-command-line-window-text-using-objectarx.html "
typepad_basename: "how-to-obtain-the-command-line-window-text-using-objectarx"
typepad_status: "Publish"
---

<p>by <a href="http://adndevblog.typepad.com/autocad/fenton-webb.html">Fenton Webb</a></p>  <p>The ObjectARX API includes a function acedGetAcadTextCmdLine() that gives you   <br />CWnd MFC access to the Command Line window. The Command Line window has various child CWnd windows (depending on the AutoCAD version you are running on) which we need to loop through to find the text, so just using normal Win32 we can very easily iterate through the child window list and extract the text. </p>  <p>Here’s how…</p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">// get the command line CWnd container</font></font></span></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#010001"><font style="font-size: 8pt">CWnd</font></font></span><font style="font-size: 8pt"><font color="#000000">* </font><span style="color: "><font color="#010001">pDock</font></span><font color="#000000"> = (</font><span style="color: "><font color="#010001">CWnd</font></span><font color="#000000">*)</font><span style="color: "><font color="#010001">acedGetAcadTextCmdLine</font></span><font color="#000000">();&#160;&#160;&#160; </font></font></font></p>    <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">// get the child window</font></font></span></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#010001"><font style="font-size: 8pt">CWnd</font></font></span><font style="font-size: 8pt"><font color="#000000">* </font><span style="color: "><font color="#010001">pChild</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">pDock</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#010001">GetWindow</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">GW_CHILD</font></span><font color="#000000">);&#160;&#160;&#160; </font></font></font></p>    <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">// loop while we have children</font></font></span></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">while</font></font></span><font style="font-size: 8pt"><font color="#000000"> (</font><span style="color: "><font color="#010001">pChild</font></span><font color="#000000">!=</font><span style="color: "><font color="#010001">NULL</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">{&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">CString</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">str</font></span><font color="#000000">;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// get the window text</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">pChild</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#010001">GetWindowText</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">str</font></span><font color="#000000">);&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// if we don't have any text</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">str</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">GetLength</font></span><font color="#000000">() &lt;= 0)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">pChild</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">pChild</font></span><font color="#000000">-&gt;</font><span style="color: "><font color="#010001">GetNextWindow</font></span><font color="#000000">();&#160;&#160;&#160; </font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">else</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160; {</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// display the text</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">MessageBox</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">NULL</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">str</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">break</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160; }</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">}&#160;&#160; </font></font></p> </div>
