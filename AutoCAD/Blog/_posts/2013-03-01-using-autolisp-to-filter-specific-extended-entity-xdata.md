---
layout: "post"
title: "Using AutoLISP to filter specific extended entity xdata"
date: "2013-03-01 02:05:00"
author: "Xiaodong Liang"
categories:
  - "2010"
  - "2011"
  - "2012"
  - "2013"
  - "AutoCAD"
  - "LISP"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/autocad/2013/03/using-autolisp-to-filter-specific-extended-entity-xdata.html "
typepad_basename: "using-autolisp-to-filter-specific-extended-entity-xdata"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>
<p><strong>Issue      <br /></strong>How do I create a selection set filter in AutoLISP for a specific xdata value ?</p>
<p><a name="section2"></a></p>
<p><strong>Solution</strong></p>
<p>A wiki help introduces in details on how to manipulate xdata by LISP:</p>
<p><a href="http://docs.autodesk.com/ACD/2011/ENU/filesALG/WS73099cc142f4875516d84be10ebc87a53f-7a08.htm">Extended Data – xdata</a></p>
<p>Following is a small code demo. It assumes some entities have been added the xdata named “TEST_APP”. The code wants to filter the entities with the xdata and the data contains one value whose type is 1070 and value is 44.</p>
<p><strong>     <br /></strong></p>
<p><span style="line-height: 120%; font-family: &#39;courier new&#39;, courier; font-size: 8pt;"><span style="color: #ff0000;">(</span><span style="color: #0000ff;">defun</span> GetSpecificXdata <span style="color: #ff0000;">(</span>appName XdataType XdataValue <span style="color: #0000ff;">/</span> ss1 ssr indx sl entLst      <br />theXdata i xl xdatav xdatal<span style="color: #ff0000;">)</span>      <br />&#0160;<span style="color: #ff0000;">(</span><span style="color: #0000ff;">setq</span> ss1 <span style="color: #ff0000;">(</span>ssget <span style="color: #ff00ff;">&quot;X&quot;</span>&#0160;<span style="color: #ff0000;">(</span>list <span style="color: #ff0000;">(</span>cons -      <br />3 <span style="color: #ff0000;">(</span>list <span style="color: #ff0000;">(</span>list appName<span style="color: #ff0000;">)</span><span style="color: #ff0000;">)</span><span style="color: #ff0000;">)</span><span style="color: #ff0000;">)</span><span style="color: #ff0000;">)</span><span style="color: #ff0000;">)</span>      <br />&#0160;<span style="color: #ff0000;">(</span><span style="color: #0000ff;">if</span> ss1      <br />&#0160;&#0160; <span style="color: #ff0000;">(</span><span style="color: #0000ff;">progn</span>      <br />&#0160;&#0160;&#0160;&#0160; <span style="color: #ff0000;">(</span><span style="color: #0000ff;">setq</span> ssr <span style="color: #ff0000;">(</span>ssadd<span style="color: #ff0000;">)</span><span style="color: #ff0000;">)</span>      <br />&#0160;&#0160;&#0160;&#0160; <span style="color: #ff0000;">(</span><span style="color: #0000ff;">setq</span> indx <span style="color: #008000;">0</span> sl <span style="color: #ff0000;">(</span>sslength ss1<span style="color: #ff0000;">)</span><span style="color: #ff0000;">)</span>      <br />&#0160;&#0160;&#0160;&#0160; <span style="color: #ff0000;">(</span><span style="color: #0000ff;">princ</span>&#0160;<span style="color: #ff0000;">(</span><span style="color: #0000ff;">strcat</span>&#0160;<span style="color: #ff00ff;">&quot;\nOriginal Xdata Selection Set Length: &quot;</span>&#0160;<span style="color: #ff0000;">(</span><span style="color: #0000ff;">itoa</span> sl<span style="color: #ff0000;">)</span><span style="color: #ff0000;">)</span><span style="color: #ff0000;">)</span>      <br />&#0160;&#0160;&#0160;&#0160; <span style="color: #ff0000;">(</span><span style="color: #0000ff;">while</span>&#0160;<span style="color: #ff0000;">(</span>&lt; indx sl<span style="color: #ff0000;">)</span>      <br />      <br />&#0160;&#0160;&#0160; <span style="color: #ff0000;">(</span><span style="color: #0000ff;">setq</span> entLst <span style="color: #ff0000;">(</span><span style="color: #0000ff;">entget</span>&#0160;<span style="color: #ff0000;">(</span>ssname ss1 indx<span style="color: #ff0000;">)</span>&#0160;<span style="color: #ff0000;">(</span>list appName<span style="color: #ff0000;">)</span><span style="color: #ff0000;">)</span><span style="color: #ff0000;">)</span>      <br />&#0160;&#0160;&#0160; <span style="color: #ff0000;">(</span><span style="color: #0000ff;">setq</span> theXdata <span style="color: #ff0000;">(</span><span style="color: #0000ff;">cdr</span>&#0160;<span style="color: #ff0000;">(</span><span style="color: #0000ff;">assoc</span> &#39;-3 entLst<span style="color: #ff0000;">)</span><span style="color: #ff0000;">)</span><span style="color: #ff0000;">)</span>      <br />&#0160;&#0160;&#0160; <span style="color: #ff0000;">(</span><span style="color: #0000ff;">setq</span>&#0160; i <span style="color: #008000;">0</span> xl <span style="color: #ff0000;">(</span>length <span style="color: #ff0000;">(</span><span style="color: #0000ff;">setq</span> xdatal <span style="color: #ff0000;">(</span><span style="color: #0000ff;">car</span> theXdata<span style="color: #ff0000;">)</span><span style="color: #ff0000;">)</span><span style="color: #ff0000;">)</span><span style="color: #ff0000;">)</span>      <br />&#0160;&#0160;&#0160; <span style="color: #ff0000;">(</span><span style="color: #0000ff;">while</span>&#0160;<span style="color: #ff0000;">(</span>&lt; i xl<span style="color: #ff0000;">)</span>      <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #ff0000;">(</span><span style="color: #0000ff;">if</span>&#0160;<span style="color: #ff0000;">(</span>= <span style="color: #ff0000;">(</span>type <span style="color: #ff0000;">(</span><span style="color: #0000ff;">setq</span> xdatav <span style="color: #ff0000;">(</span><span style="color: #0000ff;">car</span> xdatal<span style="color: #ff0000;">)</span><span style="color: #ff0000;">)</span><span style="color: #ff0000;">)</span> &#39;LIST<span style="color: #ff0000;">)</span>      <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #ff0000;">(</span><span style="color: #0000ff;">if</span>&#0160;<span style="color: #ff0000;">(</span>= <span style="color: #ff0000;">(</span><span style="color: #0000ff;">car</span> xdatav<span style="color: #ff0000;">)</span> XdataType<span style="color: #ff0000;">)</span>      <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #ff0000;">(</span><span style="color: #0000ff;">if</span>&#0160;<span style="color: #ff0000;">(</span>= <span style="color: #ff0000;">(</span><span style="color: #0000ff;">cdr</span> xdatav<span style="color: #ff0000;">)</span> XdataValue<span style="color: #ff0000;">)</span>      <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #ff0000;">(</span>ssadd <span style="color: #ff0000;">(</span>ssname ss1 indx<span style="color: #ff0000;">)</span> ssr<span style="color: #ff0000;">)</span>      <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #ff0000;">)</span>      <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #ff0000;">)</span>      <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #ff0000;">)</span>      <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #ff0000;">(</span><span style="color: #0000ff;">setq</span> i <span style="color: #ff0000;">(</span><span style="color: #0000ff;">1+</span> i<span style="color: #ff0000;">)</span> xdatal <span style="color: #ff0000;">(</span><span style="color: #0000ff;">cdr</span> xdatal<span style="color: #ff0000;">)</span>&#0160;<span style="color: #ff0000;">)</span>&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #ff0000;">)</span>      <br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #ff0000;">(</span><span style="color: #0000ff;">setq</span> indx <span style="color: #ff0000;">(</span><span style="color: #0000ff;">1+</span> indx<span style="color: #ff0000;">)</span><span style="color: #ff0000;">)</span>      <br />&#0160;&#0160;&#0160; <span style="color: #ff0000;">)</span>      <br />&#0160;&#0160; <span style="color: #ff0000;">)</span>      <br />&#0160;<span style="color: #ff0000;">)</span>      <br /> ssr      <br /><span style="color: #ff0000;">)</span>      <br />&#0160; <br /><span style="color: #ff0000;">(</span><span style="color: #0000ff;">defun</span> TestXdataSelection <span style="color: #ff0000;">(</span><span style="color: #0000ff;">/</span> ss2<span style="color: #ff0000;">)</span>      <br />&#0160;<span style="color: #ff0000;">(</span><span style="color: #0000ff;">setq</span> ss2 <span style="color: #ff0000;">(</span>GetSpecificXdata <span style="color: #ff00ff;">&quot;TEST_APP&quot;</span>&#0160;<span style="color: #008000;">1070</span>&#0160; <span style="color: #008000;">44</span><span style="color: #ff0000;">)</span><span style="color: #ff0000;">)</span>      <br />&#0160;<span style="color: #ff0000;">(</span><span style="color: #0000ff;">if</span> ss2      <br />&#0160;&#0160;&#0160;&#0160; <span style="color: #ff0000;">(</span><span style="color: #0000ff;">progn</span>      <br />&#0160;&#0160;&#0160; <span style="color: #ff0000;">(</span><span style="color: #0000ff;">princ</span>&#0160;<span style="color: #ff0000;">(</span><span style="color: #0000ff;">strcat</span>&#0160;<span style="color: #ff00ff;">&quot;\nSearched for Application: &quot;</span>&#0160;<span style="color: #ff00ff;">&quot;TEST_APP&quot;</span>&#0160;<span style="color: #ff00ff;">&quot;,       <br />XData Type: &quot;</span>&#0160;<span style="color: #ff0000;">(</span><span style="color: #0000ff;">itoa</span>&#0160;<span style="color: #008000;">1070</span><span style="color: #ff0000;">)</span>&#0160;<span style="color: #ff00ff;">&quot;, XData Value: &quot;</span>&#0160;<span style="color: #ff0000;">(</span><span style="color: #0000ff;">itoa</span>&#0160;<span style="color: #008000;">44</span><span style="color: #ff0000;">)</span><span style="color: #ff0000;">)</span><span style="color: #ff0000;">)</span>      <br />&#0160;&#0160;&#0160; <span style="color: #ff0000;">(</span><span style="color: #0000ff;">princ</span>&#0160;<span style="color: #ff0000;">(</span><span style="color: #0000ff;">strcat</span>&#0160;<span style="color: #ff00ff;">&quot;\nResultant Selection Set Length: &quot;</span>&#0160;<span style="color: #ff0000;">(</span><span style="color: #0000ff;">itoa</span>&#0160;<span style="color: #ff0000;">(</span>sslength      <br />ss2<span style="color: #ff0000;">)</span><span style="color: #ff0000;">)</span><span style="color: #ff0000;">)</span><span style="color: #ff0000;">)</span>      <br />&#0160;&#0160;&#0160;&#0160; <span style="color: #ff0000;">)</span>      <br />&#0160;<span style="color: #ff0000;">)</span>      <br />&#0160;<span style="color: #ff0000;">(</span><span style="color: #0000ff;">princ</span><span style="color: #ff0000;">)</span>      <br /><span style="color: #ff0000;">)</span>      <br />      <br /><span style="color: #ff0000;">(</span><span style="color: #0000ff;">princ</span>&#0160;<span style="color: #ff00ff;">&quot;\nTestXdataSelection loaded, type <span style="color: #ff0000;">(</span>TestXdataSelection<span style="color: #ff0000;">)</span> to run.&quot;</span><span style="color: #ff0000;">)</span>      <br /><span style="color: #ff0000;">(</span><span style="color: #0000ff;">princ</span><span style="color: #ff0000;">)</span></span></p>
