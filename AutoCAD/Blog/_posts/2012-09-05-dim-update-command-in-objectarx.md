---
layout: "post"
title: "DIM update command in ObjectARX"
date: "2012-09-05 10:05:19"
author: "Augusto Goncalves"
categories:
  - "Augusto Goncalves"
  - "AutoCAD"
  - "ObjectARX"
original_url: "https://adndevblog.typepad.com/autocad/2012/09/dim-update-command-in-objectarx.html "
typepad_basename: "dim-update-command-in-objectarx"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>If you change some dimension variables (for example DIMTXT) and if you want to apply the changes to a dimension entity, you first have to create a new temporary dimension style which contains the actual dimension variables. Then you can assign this temporary style to a dimension.</p>  <p>To build the temporary dimension style you have to use the function AcDbDatabase::getDimstyleData(). This function applies the current dimension variables to a dimension style. Then use AcDbDimension::setDimstyleData() to apply this style to a dimension.</p>  <p>The following codes shows how to get a dimension entity and to assign the current dimension settings to it:</p>  <div style="font-family: ; background: white">   <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">//</font></font></span></p>    <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">// Get dimension entity</font></font></span></p>    <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">//</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">ads_name ename;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">ads_point pt;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">if</font></font></span><font style="font-size: 8pt"><font color="#000000"> (RTNORM != ads_entsel(_T(</font><span><font color="#a31515">&quot;\nSelect dimension: &quot;</font></span><font color="#000000">), ename, pt))</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">return</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">AcDbObjectId objId;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">AcDbEntity *pEnt;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">acdbGetObjectId(objId, ename);</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">if</font></font></span><font style="font-size: 8pt" color="#000000"> (Acad::eOk != acdbOpenAcDbEntity(pEnt, objId, AcDb::kForRead)) {</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; ads_printf(_T(</font></font><font style="font-size: 8pt"><span><font color="#a31515">&quot;\nCannot open selected entity.&quot;</font></span><font color="#000000">));</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">return</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">}</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">if</font></font></span><font style="font-size: 8pt" color="#000000"> (!pEnt-&gt;isKindOf(AcDbDimension::desc())) {</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; ads_printf(_T(</font></font><font style="font-size: 8pt"><span><font color="#a31515">&quot;\nSelected entity is not a dimension.&quot;</font></span><font color="#000000">));</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; pEnt-&gt;close();</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">return</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">}</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">//</font></font></span></p>    <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">// Get current dimension var's and apply them to the dimension entity</font></font></span></p>    <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">//</font></font></span><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">AcDbDimension *pDim = (AcDbDimension*) pEnt;</font></font></p>    <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">// Create the temporary dimension style</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">AcDbDimStyleTableRecord *pDimStyle = </font></font><font style="font-size: 8pt"><span><font color="#0000ff">new</font></span><font color="#000000"> AcDbDimStyleTableRecord;</font></font></font></p>    <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">// Apply the current dim var's to the temp dim style</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">acdbCurDwg()-&gt;getDimstyleData(pDimStyle);</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">// Now assign this style to the selected dimension</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">pDim-&gt;upgradeOpen();</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">pDim-&gt;setDimstyleData(pDimStyle);</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">pDim-&gt;close();</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">// Don't forget to delete the temporary dimension style</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">delete</font></font></span><font style="font-size: 8pt" color="#000000"> pDimStyle;</font></font></p> </div>
