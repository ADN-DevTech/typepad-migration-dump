---
layout: "post"
title: "Checking if custom entity is selected inside a contextual tab selection rule"
date: "2012-05-28 08:32:22"
author: "Adam Nagy"
categories:
  - ".NET"
  - "Adam Nagy"
  - "AutoCAD"
original_url: "https://adndevblog.typepad.com/autocad/2012/05/checking-if-custom-entity-is-selected-inside-a-contextual-tab-selection-rule.html "
typepad_basename: "checking-if-custom-entity-is-selected-inside-a-contextual-tab-selection-rule"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/adam-nagy.html" target="_self">Adam Nagy</a></p>  <p>I'm using the solution from <a href="http://adndevblog.typepad.com/autocad/2012/05/using-custom-contextual-ribbon-tabs.html">DevBlog [Using custom contextual ribbon tabs]</a>, but it does not work for my custom entities. I pass in the name of my entity that is displayed in the Property Palette, but still, Selection.ContainsOnly(&quot;MyEntity&quot;) is always false.</p>  <p><a name="section2"></a></p>  <p><b>Solution</b></p>  <p>The selection rule is using the .NET type name of the selected entities. So if your entity does not have a .NET wrapper then the selection set will know it as the type name of the .NET wrapper of your custom entity's base class - i.e. if your entity is based on AcDbEntity then the selection set will know it as type &quot;Entity&quot;</p>  <p>So, if you want to check if only your custom entities are selected (and they do not have a .NET wrapper class), then create a utility assembly which iterates through the Selection set and checks each entity's RxClass.Name.</p>  <p>We could simply modify the sample code in DevBlog [Using custom contextual ribbon tabs] the following way to check if only my custom entities called &quot;MyLine&quot; are selected:</p>  <div style="font-family: Courier New; font-size: 8pt; color: black; background: white;"> <p style="margin: 0px;"><span style="color: blue; line-height: 140%;">public</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">static</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">bool</span><span style="line-height: 140%;"> ShowMyTab(</span><span style="color: blue; line-height: 140%;">object</span><span style="line-height: 140%;"> selObj)</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">{</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; Selection sel = (Selection)selObj;</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (sel.Count &lt; 1)</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">return</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">false</span><span style="line-height: 140%;">;</span></p> <p style="margin: 0px;">&nbsp;</p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: blue; line-height: 140%;">foreach</span><span style="line-height: 140%;"> (IDataItem item </span><span style="color: blue; line-height: 140%;">in</span><span style="line-height: 140%;"> sel)</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; {</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (item.ObjectId.ObjectClass.Name != </span><span style="color: #a31515; line-height: 140%;">&quot;MyLine&quot;</span><span style="line-height: 140%;">)</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">return</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">false</span><span style="line-height: 140%;">;</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; }</span></p> <p style="margin: 0px;">&nbsp;</p> <p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: blue; line-height: 140%;">return</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">true</span><span style="line-height: 140%;">;</span></p> <p style="margin: 0px;"><span style="line-height: 140%;">}</span></p> </div>
