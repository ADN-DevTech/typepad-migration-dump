---
layout: "post"
title: "Change Profile settings from .NET"
date: "2016-02-12 17:08:23"
author: "Adam Nagy"
categories:
  - ".NET"
  - "Adam Nagy"
  - "AutoCAD"
original_url: "https://adndevblog.typepad.com/autocad/2016/02/change-profile-settings-from-net.html "
typepad_basename: "change-profile-settings-from-net"
typepad_status: "Publish"
---

<p>By&#0160;<a href="http://adndevblog.typepad.com/autocad/adam-nagy.html">Adam Nagy</a></p>
<p>There are many settings&#0160;which&#0160;are stored in various parts of the registry folders that <strong>AutoCAD</strong> is using. Many of them you can also read and write&#0160;through <strong>getenv</strong>/<strong>setenv</strong> in <strong>LISP</strong> or <strong>acedGetEnv</strong>/<strong>acedSetEnv</strong> in <strong>ObjectARX</strong> - here is a .<strong>NET</strong> version:<br /> <a href="http://adndevblog.typepad.com/autocad/2012/06/a-simple-alternative-to-accessing-the-com-preferences-object-in-autocad.html">http://adndevblog.typepad.com/autocad/2012/06/a-simple-alternative-to-accessing-the-com-preferences-object-in-autocad.html</a></p>
<p>If it&#39;s not an environment variable then you can use <strong>Registry API</strong> to modify the value.<br /><strong>Note</strong>: if the value you are interested in is a <strong>string</strong> value then you could also use the&#0160;<span class="s1"><strong>UserConfigurationManager</strong> object for <strong>read</strong>/<strong>write</strong>:<br /><a href="http://through-the-interface.typepad.com/through_the_interface/2008/05/storing-custom.html">http://through-the-interface.typepad.com/through_the_interface/2008/05/storing-custom.html</a><br /></span></p>
<p>As an example, let&#39;s try to toggle the state of &quot;<strong>Enable Balloon Notification</strong>&quot; for plotting from .<strong>NET</strong>.</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b7c814e3cd970b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="DisplayPlotBubble" class="asset  asset-image at-xid-6a0167607c2431970b01b7c814e3cd970b img-responsive" src="/assets/image_524478.jpg" title="DisplayPlotBubble" /></a></p>
<p>If you want to find out where a given setting is stored in the <strong>Registry</strong> (if it is stored there) then you can use a tool like <a href="https://technet.microsoft.com/en-us/sysinternals/processmonitor.aspx">Process Monitor</a>&#0160;to see which property in the registry gets modified&#0160;when you change&#0160;the setting through the <strong>UI</strong>.&#0160;In case of the plot balloon this property was set:</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b7c814e3f5970b-popup" onclick="window.open( this.href, &#39;_blank&#39;, &#39;width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0&#39; ); return false" style="display: inline;"><img alt="DisplayPlotBubbleRegistry" class="asset  asset-image at-xid-6a0167607c2431970b01b7c814e3f5970b img-responsive" src="/assets/image_980576.jpg" title="DisplayPlotBubbleRegistry" /></a></p>
<p>So now we can change&#0160;it using a&#0160;code like this:</p>
<div style="color: #000; font-family: &#39;Courier New&#39;, Courier, Monospace; font-size: 10pt;">
<div style="background-color: #ffffff; overflow: auto; padding: 2px 5px; white-space: nowrap;"><span style="background: #ffffff; color: #0000ff;">using</span><span style="background: #ffffff; color: #000000;"> System;</span><br /> <br /> <span style="background: #ffffff; color: #0000ff;">using</span><span style="background: #ffffff; color: #000000;"> Autodesk.AutoCAD.Runtime;</span><br /> <span style="background: #ffffff; color: #0000ff;">using</span><span style="background: #ffffff; color: #000000;"> Autodesk.AutoCAD.ApplicationServices;</span><br /> <span style="background: #ffffff; color: #0000ff;">using</span><span style="background: #ffffff; color: #000000;"> Autodesk.AutoCAD.DatabaseServices;</span><br /> <br /> <span style="background: #ffffff; color: #0000ff;">using</span> <span style="background: #ffffff; color: #2b91af;">acApp</span><span style="background: #ffffff; color: #000000;"> = Autodesk.AutoCAD.ApplicationServices.</span><span style="background: #ffffff; color: #2b91af;">Application</span><span style="background: #ffffff; color: #000000;">;</span><br /> <span style="background: #ffffff; color: #0000ff;">using</span><span style="background: #ffffff; color: #000000;"> Win32 = Microsoft.Win32;</span><br /> <br /> <span style="background: #ffffff; color: #000000;">[</span><span style="background: #ffffff; color: #0000ff;">assembly</span><span style="background: #ffffff; color: #000000;">: </span><span style="background: #ffffff; color: #2b91af;">CommandClass</span><span style="background: #ffffff; color: #000000;">(</span><span style="background: #ffffff; color: #0000ff;">typeof</span><span style="background: #ffffff; color: #000000;">(SimpleDotNet.</span><span style="background: #ffffff; color: #2b91af;">Commands</span><span style="background: #ffffff; color: #000000;">))]</span><br /> <br /> <span style="background: #ffffff; color: #0000ff;">namespace</span><span style="background: #ffffff; color: #000000;"> SimpleDotNet</span><br /> <span style="background: #ffffff; color: #000000;">{</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">public</span> <span style="background: #ffffff; color: #0000ff;">class</span> <span style="background: #ffffff; color: #2b91af;">Commands</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;{</span><br /><span style="background: #ffffff; color: #000000;">&#0160; &#0160; [</span><span style="background: #ffffff; color: #2b91af;">CommandMethod</span><span style="background: #ffffff; color: #000000;">(</span><span style="background: #ffffff; color: #a31515;">&quot;ToggleDisplayPlotBubble&quot;</span><span style="background: #ffffff; color: #000000;">, </span><span style="background: #ffffff; color: #2b91af;">CommandFlags</span><span style="background: #ffffff; color: #000000;">.Session)]</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">public</span> <span style="background: #ffffff; color: #0000ff;">void</span><span style="background: #ffffff; color: #000000;"> ToggleDisplayPlotBubble()</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;{</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">const</span> <span style="background: #ffffff; color: #0000ff;">string</span><span style="background: #ffffff; color: #000000;"> sectionName = </span><span style="background: #ffffff; color: #a31515;">&quot;General&quot;</span><span style="background: #ffffff; color: #000000;">;</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">const</span> <span style="background: #ffffff; color: #0000ff;">string</span><span style="background: #ffffff; color: #000000;"> propertyName = </span><span style="background: #ffffff; color: #a31515;">&quot;DisplayPlotBubble&quot;</span><span style="background: #ffffff; color: #000000;">;</span><br /> <br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">string</span><span style="background: #ffffff; color: #000000;"> productKeyName = </span><span style="background: #ffffff; color: #2b91af;">HostApplicationServices</span><span style="background: #ffffff; color: #000000;">.Current.UserRegistryProductRootKey;</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">string</span><span style="background: #ffffff; color: #000000;"> profileName = </span><span style="background: #ffffff; color: #2b91af;">acApp</span><span style="background: #ffffff; color: #000000;">.GetSystemVariable(</span><span style="background: #ffffff; color: #a31515;">&quot;CPROFILE&quot;</span><span style="background: #ffffff; color: #000000;">).ToString();</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">using</span><span style="background: #ffffff; color: #000000;"> (</span><span style="background: #ffffff; color: #2b91af;">RegistryKey</span><span style="background: #ffffff; color: #000000;"> genKey = </span><span style="background: #ffffff; color: #2b91af;">Registry</span><span style="background: #ffffff; color: #000000;">.CurrentUser.OpenSubKey(</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">string</span><span style="background: #ffffff; color: #000000;">.Format(</span><span style="background: #ffffff; color: #a31515;">@&quot;{0}\Profiles\{1}\{2}&quot;</span><span style="background: #ffffff; color: #000000;">, productKeyName, profileName, sectionName), </span><span style="background: #ffffff; color: #0000ff;">true</span><span style="background: #ffffff; color: #000000;">))</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;{</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="background: #ffffff; color: #0000ff;">int</span><span style="background: #ffffff; color: #000000;"> displayOn = (</span><span style="background: #ffffff; color: #0000ff;">int</span><span style="background: #ffffff; color: #000000;">)genKey.GetValue(propertyName);</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;displayOn = (displayOn == 0) ? 1 : 0;</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;genKey.SetValue(propertyName, displayOn, Win32.</span><span style="background: #ffffff; color: #2b91af;">RegistryValueKind</span><span style="background: #ffffff; color: #000000;">.DWord);</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;}</span><br /> <span style="background: #ffffff; color: #000000;">&#0160;&#0160;&#0160;&#0160;}</span><br /><span style="background: #ffffff; color: #000000;">&#0160; }</span><br /> <span style="background: #ffffff; color: #000000;">}</span></div>
</div>
