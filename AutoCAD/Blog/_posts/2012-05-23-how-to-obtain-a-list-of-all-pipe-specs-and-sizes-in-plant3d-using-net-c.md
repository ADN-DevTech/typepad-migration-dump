---
layout: "post"
title: "How to obtain a list of all Pipe Specs and Sizes in Plant3d using .NET C#"
date: "2012-05-23 15:40:55"
author: "Fenton Webb"
categories: []
original_url: "https://adndevblog.typepad.com/autocad/2012/05/how-to-obtain-a-list-of-all-pipe-specs-and-sizes-in-plant3d-using-net-c.html "
typepad_basename: "how-to-obtain-a-list-of-all-pipe-specs-and-sizes-in-plant3d-using-net-c"
typepad_status: "Publish"
---

<p>by <a href="http://adndevblog.typepad.com/autocad/fenton-webb.html">Fenton Webb</a></p>  <p>If you are looking for an easy way to list all Pipe Specs available in Plant3d, then you may run into problem. That is, of course, until you find out that there is a special reference DLL that is not included in the posted SDK which contains everything you need… </p>  <p>That reference DLL is called <strong>PnP3dMain.dll.</strong></p>  <p>Once you add this reference included in your Visual Studio project (from the Program Files folder of your Plant3d with Copy Local=False) you will gain access to:</p>  <p><font face="Consolas"><font color="#010001">Autodesk</font><font size="2"><font color="#000000" size="2">.</font></font><font color="#010001" size="2"><font color="#010001" size="2"><font color="#010001" size="2">ProcessPower</font></font></font><font size="2"><font color="#000000" size="2">.</font></font><font color="#010001" size="2"><font color="#010001" size="2"><font color="#010001" size="2">P3dUI</font></font></font><font size="2"><font color="#000000" size="2">.</font></font><font color="#2b91af" size="2"><font color="#2b91af" size="2"><font color="#2b91af" size="2">UISettings</font></font></font></font></p>  <p>and everything becomes much easier to achieve, as you can see by the code below…</p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">// get all pipe spec names by Fenton Webb, DevTech, Autodesk 23/05/2012</font></font></span></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">[</font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">CommandMethod</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;GetPipeSpecs&quot;</font></span><font color="#000000">)]</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">public</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">GetPipeSpecs</font></span><font color="#000000">()</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">{</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// get the AutoCAD Editor object so we can print to the command line</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">Editor</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">ed</font></span><font color="#000000"> = </font><span style="color: "><font color="#2b91af">AcadApp</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">DocumentManager</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">MdiActiveDocument</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Editor</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// get the UISettings object (found in Pnp3dMain.dll)</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">Autodesk</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">ProcessPower</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">P3dUI</font></span><font color="#000000">.</font><span style="color: "><font color="#2b91af">UISettings</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">settings</font></span><font color="#000000"> = </font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">Autodesk</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">ProcessPower</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">P3dUI</font></span><font color="#000000">.</font><span style="color: "><font color="#2b91af">UISettings</font></span><font color="#000000">();</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">StringCollection</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">specs</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">settings</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">AllSpecs</font></span><font color="#000000">();</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">foreach</font></span><font color="#000000"> (</font><span style="color: "><font color="#0000ff">string</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">spec</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">in</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">specs</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160; {</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">ed</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">WriteMessage</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;\nSpec &quot;</font></span><font color="#000000"> + </font><span style="color: "><font color="#010001">spec</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160; }</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">}</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">// get sizes available from a spec </font></font></span></p>    <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">// by Fenton Webb, DevTech, Autodesk 23/05/2012</font></font></span></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">[</font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">CommandMethod</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;GetPipeSizes&quot;</font></span><font color="#000000">)]</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">public</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">GetPipeSizes</font></span><font color="#000000">()</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">{</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// get the AutoCAD Editor object so we can print to the command line</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">Editor</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">ed</font></span><font color="#000000"> = </font><span style="color: "><font color="#2b91af">AcadApp</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">DocumentManager</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">MdiActiveDocument</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Editor</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">PromptResult</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">res</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">ed</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">GetString</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;\nEnter Pipe Spec&quot;</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#010001">res</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Status</font></span><font color="#000000"> == </font><span style="color: "><font color="#2b91af">PromptStatus</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">OK</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160; {</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// get the UISettings object (found in Pnp3dMain.dll)</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">Autodesk</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">ProcessPower</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">P3dUI</font></span><font color="#000000">.</font><span style="color: "><font color="#2b91af">UISettings</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">settings</font></span><font color="#000000"> = </font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">Autodesk</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">ProcessPower</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">P3dUI</font></span><font color="#000000">.</font><span style="color: "><font color="#2b91af">UISettings</font></span><font color="#000000">();</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// now get all the sizes that are available for that spec</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">StringCollection</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">sizes</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">settings</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">GetAllSizesFromSpecName</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">res</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">StringResult</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">foreach</font></span><font color="#000000"> (</font><span style="color: "><font color="#0000ff">string</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">size</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">in</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">sizes</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#010001">ed</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">WriteMessage</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;\nSize &quot;</font></span><font color="#000000"> + </font><span style="color: "><font color="#010001">size</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160; }</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">}</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p> </div> <font color="#2b91af" size="2" face="Consolas"><font color="#2b91af" size="2" face="Consolas"><font color="#2b91af" size="2" face="Consolas">            </font></font></font>
