---
layout: "post"
title: "Detecting entities under cursor while selection is running"
date: "2014-02-12 03:14:06"
author: "Philippe Leefsma"
categories:
  - ".NET"
  - "AutoCAD"
  - "ObjectARX"
  - "Philippe Leefsma"
original_url: "https://adndevblog.typepad.com/autocad/2014/02/detecting-entities-under-cursor-while-selection-is-running.html "
typepad_basename: "detecting-entities-under-cursor-while-selection-is-running"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/philippe-leefsma.html" target="_self">Philippe Leefsma</a></p>  <p>The PointMonitor callback in .Net lets you access the entities that are under the cursor aperture as the user is hovering the mouse, however this feature gets disabled while running an Editor.GetEntity.</p>  <p>There is a workaround for that behavior that involves P/Invoking a bunch of ObjectARX methods, as we like to do. Below is a C# sample for that.</p>  <p>Nested entities can also be detected as exposed in this previous post:</p>  <p><a href="http://adndevblog.typepad.com/autocad/2012/04/retrieving-nested-entities-under-cursor-aperture-using-net-api.html">Retrieving nested entities under cursor aperture using .Net API</a></p>  <p>&#160;</p>    <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font color="#0000ff"><font style="font-size: 9.5pt">class</font></font></span><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font style="font-size: 9.5pt"><font color="#000000"> </font></font><span style="color: "><font style="font-size: 9.5pt" color="#2b91af">ArxImports</font></span></span></font></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">{</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">struct</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 9.5pt" color="#2b91af">ads_name</font></span></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">{</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">IntPtr</font></span><font color="#000000"> a;</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">IntPtr</font></span><font color="#000000"> b;</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">};</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">[</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">StructLayout</font></span><font color="#000000">(</font><span style="color: "><font color="#2b91af">LayoutKind</font></span><font color="#000000">.Sequential, Size = 32)]</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">struct</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">resbuf</font></span><font color="#000000"> { }</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">[</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">DllImport</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;accore.dll&quot;</font></span><font color="#000000">,</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">CallingConvention = </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">CallingConvention</font></span><font color="#000000">.Cdecl,</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">CharSet = </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">CharSet</font></span><font color="#000000">.Unicode,</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">ExactSpelling = </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">)]</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">static</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">extern</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">PromptStatus</font></span><font color="#000000"> acedSSGet(</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">string</font></span><font color="#000000"> str, </font><span style="color: "><font color="#2b91af">IntPtr</font></span><font color="#000000"> pt1, </font><span style="color: "><font color="#2b91af">IntPtr</font></span><font color="#000000"> pt2,</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">IntPtr</font></span><font color="#000000"> filter, </font><span style="color: "><font color="#0000ff">out</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">ads_name</font></span><font color="#000000"> ss);</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">[</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">DllImport</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;accore.dll&quot;</font></span><font color="#000000">,</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;</font></span><font style="font-size: 9.5pt"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160; </span>CallingConvention = </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">CallingConvention</font></span><font color="#000000">.Cdecl,</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">CharSet = </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">CharSet</font></span><font color="#000000">.Unicode,</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">ExactSpelling = </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">)]</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">static</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">extern</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">PromptStatus</font></span><font color="#000000"> acedSSFree(</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">ref</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">ads_name</font></span><font color="#000000"> ss);</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">[</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">DllImport</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;accore.dll&quot;</font></span><font color="#000000">,</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">CallingConvention = </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">CallingConvention</font></span><font color="#000000">.Cdecl,</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">CharSet = </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">CharSet</font></span><font color="#000000">.Unicode,</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">ExactSpelling = </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">)]</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">static</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">extern</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">PromptStatus</font></span><font color="#000000"> acedSSLength(</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">ref</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">ads_name</font></span><font color="#000000"> ss, </font><span style="color: "><font color="#0000ff">out</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">int</font></span><font color="#000000"> len);</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">[</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">DllImport</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;accore.dll&quot;</font></span><font color="#000000">, </font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">CallingConvention = </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">CallingConvention</font></span><font color="#000000">.Cdecl, </font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">CharSet = </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">CharSet</font></span><font color="#000000">.Unicode, </font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">ExactSpelling = </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">)]</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">static</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">extern</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">PromptStatus</font></span><font color="#000000"> acedSSName(</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">ref</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">ads_name</font></span><font color="#000000"> ss, </font><span style="color: "><font color="#0000ff">int</font></span><font color="#000000"> i, </font><span style="color: "><font color="#0000ff">out</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">ads_name</font></span><font color="#000000"> name);</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">[</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">DllImport</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;acdb19.dll&quot;</font></span><font color="#000000">, </font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">CallingConvention = </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">CallingConvention</font></span><font color="#000000">.Cdecl, </font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">CharSet = </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">CharSet</font></span><font color="#000000">.Unicode, </font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">ExactSpelling = </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">)]</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">static</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">extern</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">ErrorStatus</font></span><font color="#000000"> acdbGetObjectId(</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">out</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">ObjectId</font></span><font color="#000000"> id, </font><span style="color: "><font color="#0000ff">ref</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">ads_name</font></span><font color="#000000"> name);</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">}</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font color="#0000ff"><font style="font-size: 9.5pt">static</font></font></span><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font style="font-size: 9.5pt"><font color="#000000"> System.Collections.Generic.</font><span style="color: "><font color="#2b91af">List</font></span><font color="#000000">&lt;</font><span style="color: "><font color="#2b91af">ObjectId</font></span><font color="#000000">&gt; </font></font></span></font></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">FindAtPoint(</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">Point3d</font></span><font color="#000000"> worldPoint, </font><span style="color: "><font color="#0000ff">bool</font></span><font color="#000000"> selectAll = </font><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">)</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">{</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">System.Collections.Generic.</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">List</font></span><font color="#000000">&lt;</font><span style="color: "><font color="#2b91af">ObjectId</font></span><font color="#000000">&gt; ids = </font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> System.Collections.Generic.</font><span style="color: "><font color="#2b91af">List</font></span><font color="#000000">&lt;</font><span style="color: "><font color="#2b91af">ObjectId</font></span><font color="#000000">&gt;();</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span></span><font style="font-size: 9.5pt"><span lang="FR-CH" style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: fr-ch"><font color="#2b91af">Document</font></span></font><span lang="FR-CH" style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: fr-ch"><font style="font-size: 9.5pt"><font color="#000000"> doc = </font><span style="color: "><font color="#2b91af">Application</font></span><font color="#000000">.DocumentManager.MdiActiveDocument;</font></font></span></font></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span lang="FR-CH" style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: fr-ch"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span lang="FR-CH" style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: fr-ch"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span></span><font style="font-size: 9.5pt"><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font color="#2b91af">Matrix3d</font></span></font><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font style="font-size: 9.5pt" color="#000000"> wcs2ucs = </font></span></font></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font style="font-size: 9.5pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; doc.Editor.CurrentUserCoordinateSystem.Inverse();</font></span></font></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">Point3d</font></span><font color="#000000"> ucsPoint = worldPoint.TransformBy(wcs2ucs);</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><span style="mso-spacerun: yes"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">string</font></span><font color="#000000"> arg = selectAll ? </font><span style="color: "><font color="#a31515">&quot;:E&quot;</font></span><font color="#000000"> : </font><span style="color: "><font color="#0000ff">string</font></span><font color="#000000">.Empty;</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><span style="mso-spacerun: yes"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">IntPtr</font></span><font color="#000000"> ptrPoint = </font><span style="color: "><font color="#2b91af">Marshal</font></span><font color="#000000">.UnsafeAddrOfPinnedArrayElement(</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">worldPoint.ToArray(), 0);</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">ArxImports</font></span><font color="#000000">.</font><span style="color: "><font color="#2b91af">ads_name</font></span><font color="#000000"> sset;</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">PromptStatus</font></span><font color="#000000"> prGetResult = </font><span style="color: "><font color="#2b91af">ArxImports</font></span><font color="#000000">.acedSSGet(</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">arg, ptrPoint, </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">IntPtr</font></span><font color="#000000">.Zero, </font><span style="color: "><font color="#2b91af">IntPtr</font></span><font color="#000000">.Zero, </font><span style="color: "><font color="#0000ff">out</font></span><font color="#000000"> sset);</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">int</font></span><font color="#000000"> len;</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">ArxImports</font></span><font color="#000000">.acedSSLength(</font><span style="color: "><font color="#0000ff">ref</font></span><font color="#000000"> sset, </font><span style="color: "><font color="#0000ff">out</font></span><font color="#000000"> len);</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (len &lt;= 0)</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> ids;</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><span style="mso-spacerun: yes"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">for</font></span><font color="#000000"> (</font><span style="color: "><font color="#0000ff">int</font></span><font color="#000000"> i = 0; i &lt; len; ++i)</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">{</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">ArxImports</font></span><font color="#000000">.</font><span style="color: "><font color="#2b91af">ads_name</font></span><font color="#000000"> name;</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#2b91af">ArxImports</font></span><font color="#000000">.acedSSName(</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">ref</font></span><font color="#000000"> sset, i, </font><span style="color: "><font color="#0000ff">out</font></span><font color="#000000"> name) != </font><span style="color: "><font color="#2b91af">PromptStatus</font></span><font color="#000000">.OK)</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">continue</font></span><font color="#000000">;</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><span style="mso-spacerun: yes"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">ObjectId</font></span><font color="#000000"> id;</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#2b91af">ArxImports</font></span><font color="#000000">.acdbGetObjectId(</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">out</font></span><font color="#000000"> id, </font><span style="color: "><font color="#0000ff">ref</font></span><font color="#000000"> name) != </font><span style="color: "><font color="#2b91af">ErrorStatus</font></span><font color="#000000">.OK)</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">continue</font></span><font color="#000000">;</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">ids.Add(id);</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">ArxImports</font></span><font color="#000000">.acedSSFree(</font><span style="color: "><font color="#0000ff">ref</font></span><font color="#000000"> sset);</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> ids;</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">}</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal"><span style="mso-fareast-font-family: &quot;Times New Roman&quot;; mso-bidi-font-family: &quot;Times New Roman&quot;"><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font color="#2b91af"><font style="font-size: 9.5pt">Editor</font></font></span><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font style="font-size: 9.5pt" color="#000000"> AdnEditor;</font></span></font></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><font style="font-size: 9.5pt">[</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">CommandMethod</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;PointMonitorSelection&quot;</font></span><font color="#000000">)]</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font color="#0000ff"><font style="font-size: 9.5pt">public</font></font></span><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font style="font-size: 9.5pt"><font color="#000000"> </font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000"> PointMonitorSelection()</font></font></span></font></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span lang="FR-CH" style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: fr-ch"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">{</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span lang="FR-CH" style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: fr-ch"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">Document</font></span><font color="#000000"> doc = </font><span style="color: "><font color="#2b91af">Application</font></span><font color="#000000">.DocumentManager.MdiActiveDocument;</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span lang="FR-CH" style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: fr-ch"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span></span><font style="font-size: 9.5pt"><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font color="#2b91af">Database</font></span></font><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font style="font-size: 9.5pt" color="#000000"> db = doc.Database;</font></span></font></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">Editor</font></span><font color="#000000"> ed = doc.Editor;</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><span style="color: "><font style="font-size: 9.5pt" color="#0000ff">try</font></span></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">{</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">AdnEditor = doc.Editor;</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">AdnEditor.PointMonitor +=</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">FindUsingPointMonitor;</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><span style="mso-spacerun: yes"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">PromptEntityOptions</font></span><font color="#000000"> peo = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">PromptEntityOptions</font></span><font color="#000000">(</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#a31515">&quot;Select an entity...&quot;</font></span><font color="#000000">);</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">PromptEntityResult</font></span><font color="#000000"> per = ed.GetEntity(peo);</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (per.Status != </font><span style="color: "><font color="#2b91af">PromptStatus</font></span><font color="#000000">.OK)</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000">;</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">ObjectId</font></span><font color="#000000"> id = per.ObjectId;</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">ed.WriteMessage(</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#a31515">&quot;\n - Selected &quot;</font></span><font color="#000000"> +</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#a31515">&quot; Entity: &quot;</font></span><font color="#000000"> + id.ObjectClass.Name +</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#a31515">&quot; Id: &quot;</font></span><font color="#000000"> + id.ToString());</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">catch</font></span><font color="#000000">(System.</font><span style="color: "><font color="#2b91af">Exception</font></span><font color="#000000"> ex)</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">{</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">ed.WriteMessage(</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#a31515">&quot;\nException: &quot;</font></span><font color="#000000"> + ex.Message);</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><span style="color: "><font style="font-size: 9.5pt" color="#0000ff">finally</font></span></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">{</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">AdnEditor.PointMonitor -=</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">FindUsingPointMonitor;</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">}</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#0000ff">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font color="#0000ff"><font style="font-size: 9.5pt">void</font></font></span><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font style="font-size: 9.5pt"><font color="#000000"> FindUsingPointMonitor(</font><span style="color: "><font color="#0000ff">object</font></span><font color="#000000"> sender, </font><span style="color: "><font color="#2b91af">PointMonitorEventArgs</font></span><font color="#000000"> e)</font></font></span></font></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">{</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">Editor</font></span><font color="#000000"> ed = </font><span style="color: "><font color="#2b91af">Application</font></span><font color="#000000">.DocumentManager.MdiActiveDocument.Editor;</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><span style="color: "><font style="font-size: 9.5pt" color="#008000">// Not working when running editor selection</font></span></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><span style="color: "><font style="font-size: 9.5pt" color="#008000">//foreach (var subId in e.Context.GetPickedEntities())</font></span></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><span style="color: "><font style="font-size: 9.5pt" color="#008000">//{</font></span></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><span style="color: "><font style="font-size: 9.5pt" color="#008000">//<span style="mso-spacerun: yes">&#160;&#160;&#160; </span>foreach (var id in subId.GetObjectIds())</font></span></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><span style="color: "><font style="font-size: 9.5pt" color="#008000">//<span style="mso-spacerun: yes">&#160;&#160;&#160; </span>{</font></span></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><span style="color: "><font style="font-size: 9.5pt" color="#008000">//<span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>ed.WriteMessage(&quot;\n - &quot; +</font></span></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><span style="color: "><font style="font-size: 9.5pt" color="#008000">//<span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>&quot; Entity: &quot; + id.ObjectClass.Name +</font></span></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><span style="color: "><font style="font-size: 9.5pt" color="#008000">//<span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>&quot; Id: &quot; + id.ToString());</font></span></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><span style="color: "><font style="font-size: 9.5pt" color="#008000">//<span style="mso-spacerun: yes">&#160;&#160;&#160; </span>}</font></span></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><span style="color: "><font style="font-size: 9.5pt" color="#008000">//}</font></span></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">var</font></span><font color="#000000"> ids = FindAtPoint(e.Context.RawPoint);</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">foreach</font></span><font color="#000000"> (</font><span style="color: "><font color="#0000ff">var</font></span><font color="#000000"> id </font><span style="color: "><font color="#0000ff">in</font></span><font color="#000000"> ids)</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">{</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">ed.WriteMessage(</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#a31515">&quot;\n + &quot;</font></span><font color="#000000"> +</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#a31515">&quot; Entity: &quot;</font></span><font color="#000000"> + id.ObjectClass.Name +</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#a31515">&quot; Id: &quot;</font></span><font color="#000000"> + id.ToString());</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">}</font></font></span></p>
