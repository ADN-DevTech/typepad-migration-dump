---
layout: "post"
title: "How to find all fields in a drawing?"
date: "2014-07-04 03:39:59"
author: "Philippe Leefsma"
categories:
  - ".NET"
  - "AutoCAD"
  - "Philippe Leefsma"
original_url: "https://adndevblog.typepad.com/autocad/2014/07/how-to-find-all-fields-in-a-drawing.html "
typepad_basename: "how-to-find-all-fields-in-a-drawing"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/philippe-leefsma.html" target="_self">Philippe Leefsma</a></p>  <p>The Named Object Dictionary (NOD) in a database contains an “ACAD_FIELDLIST” entry if your drawing contains any field. This entry holds a record of type “AcDbFieldList” which is unfortunately an object type that isn’t exposed to the ARX or .Net API.</p>  <p>Each AcDbField object is typically accessible from an entity Extension Dictionary, for example if I you create a MText that contains a field, you can access that specific MText and look for the AcDbField in the ExtensionDictionary.</p>  <p>In order to access all fields directly, one way to get the job done is to grab all TypedValue (DxfCode – Value pairs) of our AcDbFieldList, iterate through them and grab the one that have dxf code = 330 and are of type AcDbField.</p>  <p>We need to rely on some good old P/Invoked arx methods, hence that code is version dependent, here is an example for R19:</p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font color="#0000ff"><font style="font-size: 9.5pt">class</font></font></span><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font style="font-size: 9.5pt"><font color="#000000"> </font></font><span style="color: "><font style="font-size: 9.5pt" color="#2b91af">ImportsR19</font></span></span></font></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">{</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">struct</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 9.5pt" color="#2b91af">ads_name</font></span></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">{</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">IntPtr</font></span><font color="#000000"> a;</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">IntPtr</font></span><font color="#000000"> b;</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">};</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">[</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">DllImport</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;acdb19.dll&quot;</font></span><font color="#000000">,</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">CallingConvention = </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">CallingConvention</font></span><font color="#000000">.Cdecl,</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">EntryPoint = </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#a31515">&quot;?acdbGetAdsName@@YA?AW4ErrorStatus@Acad@@AAY01JVAcDbObjectId@@@Z&quot;</font></span><font color="#000000">)]</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">static</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">extern</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">int</font></span><font color="#000000"> acdbGetAdsName32(</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">ref</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">ads_name</font></span><font color="#000000"> name, </font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#2b91af">ObjectId</font></span><font color="#000000"> objId);</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">[</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">DllImport</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;acdb19.dll&quot;</font></span><font color="#000000">,</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">CallingConvention = </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">CallingConvention</font></span><font color="#000000">.Cdecl,</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">EntryPoint = </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#a31515">&quot;?acdbGetAdsName@@YA?AW4ErrorStatus@Acad@@AEAY01_JVAcDbObjectId@@@Z&quot;</font></span><font color="#000000">)]</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">static</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">extern</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">int</font></span><font color="#000000"> acdbGetAdsName64(</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">ref</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">ads_name</font></span><font color="#000000"> name, </font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#2b91af">ObjectId</font></span><font color="#000000"> objId);</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">static</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">int</font></span><font color="#000000"> acdbGetAdsName(</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">ref</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">ads_name</font></span><font color="#000000"> name, </font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#2b91af">ObjectId</font></span><font color="#000000"> objId)</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">{</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (</font><span style="color: "><font color="#2b91af">Marshal</font></span><font color="#000000">.SizeOf(</font><span style="color: "><font color="#2b91af">IntPtr</font></span><font color="#000000">.Zero) &gt; 4)</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> acdbGetAdsName64(</font><span style="color: "><font color="#0000ff">ref</font></span><font color="#000000"> name, objId);</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> acdbGetAdsName32(</font><span style="color: "><font color="#0000ff">ref</font></span><font color="#000000"> name, objId);</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><font color="#000000"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></span></span><span lang="FR-CH" style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: fr-ch"><font style="font-size: 9.5pt">}</font></span></font></font></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span lang="FR-CH" style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: fr-ch"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span lang="FR-CH" style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: fr-ch"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">[</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">DllImport</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;accore.dll&quot;</font></span><font color="#000000">,</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span lang="FR-CH" style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: fr-ch"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">CharSet = </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">CharSet</font></span><font color="#000000">.Unicode,</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span lang="FR-CH" style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: fr-ch"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font style="font-size: 9.5pt"><font color="#000000">CallingConvention = </font><span style="color: "><font color="#2b91af">CallingConvention</font></span><font color="#000000">.Cdecl,</font></font></span></font></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">EntryPoint = </font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#a31515">&quot;acdbEntGet&quot;</font></span><font color="#000000">)]</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">static</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">extern</font></span><font color="#000000"> System.</font><span style="color: "><font color="#2b91af">IntPtr</font></span><font color="#000000"> acdbEntGet(</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">ref</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">ads_name</font></span><font color="#000000"> ename);</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">static</font></span><font color="#000000"> System.Collections.Generic.</font><span style="color: "><font color="#2b91af">List</font></span><font color="#000000">&lt;</font><span style="color: "><font color="#2b91af">TypedValue</font></span><font color="#000000">&gt;</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">acdbEntGetTypedValues(</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">ObjectId</font></span><font color="#000000"> id)</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">{</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">System.Collections.Generic.</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">List</font></span><font color="#000000">&lt;</font><span style="color: "><font color="#2b91af">TypedValue</font></span><font color="#000000">&gt; result =</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> System.Collections.Generic.</font><span style="color: "><font color="#2b91af">List</font></span><font color="#000000">&lt;</font><span style="color: "><font color="#2b91af">TypedValue</font></span><font color="#000000">&gt;();</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">ads_name</font></span><font color="#000000"> name = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">ads_name</font></span><font color="#000000">();</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">int</font></span><font color="#000000"> res = acdbGetAdsName(</font><span style="color: "><font color="#0000ff">ref</font></span><font color="#000000"> name, id);</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">ResultBuffer</font></span><font color="#000000"> rb = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">ResultBuffer</font></span><font color="#000000">();</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">Autodesk.AutoCAD.Runtime.</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">Interop</font></span><font color="#000000">.AttachUnmanagedObject(</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">rb,</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">acdbEntGet(</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">ref</font></span><font color="#000000"> name),</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">);</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">ResultBufferEnumerator</font></span><font color="#000000"> iter = rb.GetEnumerator();</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">while</font></span><font color="#000000"> (iter.MoveNext())</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">{</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">result.Add((</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">TypedValue</font></span><font color="#000000">)iter.Current);</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> result;</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">}</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><span style="mso-spacerun: yes"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><font style="font-size: 9.5pt">[</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">CommandMethod</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;FieldList&quot;</font></span><font color="#000000">)]</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font color="#0000ff"><font style="font-size: 9.5pt">public</font></font></span><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font style="font-size: 9.5pt"><font color="#000000"> </font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000"> FieldList()</font></font></span></font></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span lang="FR-CH" style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: fr-ch"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">{</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span lang="FR-CH" style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: fr-ch"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">Document</font></span><font color="#000000"> doc = </font><span style="color: "><font color="#2b91af">Application</font></span><font color="#000000">.DocumentManager.MdiActiveDocument;</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><font face="Consolas"><span lang="FR-CH" style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;; mso-ansi-language: fr-ch"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span></span><font style="font-size: 9.5pt"><span style="font-family: ; color: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font color="#2b91af">Database</font></span></font><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font style="font-size: 9.5pt" color="#000000"> db = doc.Database;</font></span></font></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">Editor</font></span><font color="#000000"> ed = doc.Editor;</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">using</font></span><font color="#000000"> (</font><span style="color: "><font color="#0000ff">var</font></span><font color="#000000"> tx = db.TransactionManager.StartTransaction())</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">{</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">var</font></span><font color="#000000"> nod = tx.GetObject(</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">db.NamedObjectsDictionaryId, </font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">OpenMode</font></span><font color="#000000">.ForRead) </font><span style="color: "><font color="#0000ff">as</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">DBDictionary</font></span><font color="#000000">;</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (!nod.Contains(</font><span style="color: "><font color="#a31515">&quot;ACAD_FIELDLIST&quot;</font></span><font color="#000000">))</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">{</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">ed.WriteMessage(</font></font><font style="font-size: 9.5pt"><span style="color: "><font color="#a31515">&quot;\nDrawing has no field...&quot;</font></span><font color="#000000">);</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000">;</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">var</font></span><font color="#000000"> id = nod.GetAt(</font><span style="color: "><font color="#a31515">&quot;ACAD_FIELDLIST&quot;</font></span><font color="#000000">);</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">List</font></span><font color="#000000">&lt;</font><span style="color: "><font color="#2b91af">TypedValue</font></span><font color="#000000">&gt; dxf = </font><span style="color: "><font color="#2b91af">ImportsR19</font></span><font color="#000000">.acdbEntGetTypedValues(id);</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">foreach</font></span><font color="#000000"> (</font><span style="color: "><font color="#0000ff">var</font></span><font color="#000000"> entry </font><span style="color: "><font color="#0000ff">in</font></span><font color="#000000"> dxf)</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt"><span style="mso-spacerun: yes">&#160;&#160; </span>{</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (entry.TypeCode == 330)</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">{</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">ObjectId</font></span><font color="#000000"> objId = (</font><span style="color: "><font color="#2b91af">ObjectId</font></span><font color="#000000">)entry.Value;</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (objId.ObjectClass.Name == </font><span style="color: "><font color="#a31515">&quot;AcDbField&quot;</font></span><font color="#000000">)</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">{</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">Field</font></span><font color="#000000"> field = tx.GetObject(</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">objId, </font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#2b91af">OpenMode</font></span><font color="#000000">.ForWrite) </font><span style="color: "><font color="#0000ff">as</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">Field</font></span><font color="#000000">;</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">field.Evaluate();</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">ed.WriteMessage(</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9.5pt"><span style="color: "><font color="#a31515">&quot;\n - Format: &quot;</font></span><font color="#000000"> + field.Format + </font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt"><span style="color: "><font color="#a31515">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &quot; Value: &quot;</font></span><font color="#000000"> + </font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; field.GetStringValue());</font></font><span style="mso-spacerun: yes"><font style="font-size: 9.5pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>  <p class="MsoNormal" style="margin: 0in 0in 0pt; line-height: normal; text-autospace: ; mso-layout-grid-align: none"><span style="font-family: ; mso-fareast-font-family: &quot;Times New Roman&quot;"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">}</font></font></span></p>
