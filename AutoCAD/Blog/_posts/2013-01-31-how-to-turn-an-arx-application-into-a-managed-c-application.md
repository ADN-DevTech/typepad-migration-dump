---
layout: "post"
title: "How to turn an ARX Application into a Managed C++ Application?"
date: "2013-01-31 04:08:07"
author: "Philippe Leefsma"
categories:
  - ".NET"
  - "AutoCAD"
  - "ObjectARX"
  - "Philippe Leefsma"
original_url: "https://adndevblog.typepad.com/autocad/2013/01/how-to-turn-an-arx-application-into-a-managed-c-application.html "
typepad_basename: "how-to-turn-an-arx-application-into-a-managed-c-application"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/philippe-leefsma.html" target="_self">Philippe Leefsma</a></p>  <p>You can directly create a mixed manage project using ObjectARX wizard. The steps below apply to projects which are being migrating from old releases or converting a unmanaged ObjectARX project to a mixed managed.</p>  <p>&#160;</p>  <p>The first thing to do is to turn on the /CLR compiler setting to compile as managed.</p>  <p>In the project properties window, under the Property Pages for the project, make the following modifications:</p>  <p><strong>C++ :&#160; General:</strong></p>  <p><strong></strong><font size="7">     <br /></font>&#160;&#160;&#160; <strong>Compile As Managed</strong>    <br />&#160;&#160;&#160;&#160; <strong>From:</strong> Not using managed extensions    <br />&#160;&#160;&#160;&#160; <strong>To:</strong> Assembly Support (/clr)</p>  <p>&#160;&#160;&#160; <strong>Debug Information Format: (Debug only)     <br /></strong>&#160;&#160;&#160; <strong>From:</strong> Program Database for Edit &amp; Continue (/ZI)    <br />&#160;&#160;&#160; <strong>To:</strong> Program Database (/Zi)</p>  <p>   <br /><strong>Code Generation (Debug only):</strong></p>  <p><strong></strong>    <br />&#160;&#160; <strong> Basic runtime checks     <br /></strong>&#160;&#160; <strong>&#160; From:</strong> Both (/RTC1, equip, to /RTC Su...)    <br />&#160;&#160;&#160;&#160; <strong>To:</strong> default</p>  <p>&#160;</p>  <p><strong>Precompiled Header:</strong>&#160;&#160; </p>  <p>   <br /><strong>&#160;&#160;&#160; Create/Use Precompiled Header</strong>    <br />&#160;&#160;&#160;&#160; <strong>From:</strong> Automatically Generate (/YX)    <br />&#160;&#160;&#160;&#160; <strong>To:</strong> Create Precompiled Header (/Yc)</p>  <p>&#160;</p>  <p><strong>Code Generation:</strong></p>  <p><strong></strong>    <br />&#160;&#160;&#160; <strong>Enable Minimal Rebuild</strong>    <br />&#160;&#160;&#160;&#160; <strong>From:</strong> Yes (/Gm)    <br />&#160;&#160;&#160;&#160; <strong>To:</strong> No</p>  <p>&#160;</p>  <p><strong>Link with the /NOENTRY flag</strong></p>  <p>&#160;</p>  <p><strong>In stdafx.h add:</strong></p>  <p>#using &lt;mscorlib.dll&gt;   <br />#using &lt;System.dll&gt;</p>  <p>#using &lt;System.Drawing.dll&gt;</p>  <p>#using &lt;system.windows.forms.dll&gt;</p>  <p>&#160;</p>  <p><strong>In the CPP file where you're going to use managed code, add the following after the compiler references through to stdafx.h</strong></p>  <p>using namespace System;</p>  <p>using namespace System::Reflection;</p>  <p>using namespace System::Collections;</p>  <p>using namespace System::ComponentModel;</p>  <p>using namespace System::Drawing;</p>  <p>using namespace System::Windows::Forms;</p>  <p>using namespace System::Security::Policy;</p>  <p>using namespace System::Runtime::InteropServices;</p>  <p>&#160;</p>  <p>See attached sample for more details.</p>  <div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:fb3a1972-4489-4e52-abe7-25a00bb07fdf:71121636-3a7e-4f80-aa40-4424804cfdc4" class="wlWriterEditableSmartContent"><p> <a href="http://adndevblog.typepad.com/arxdotnetsample.zip" target="_blank">ArxDotNetSample.zip</a></p></div>
