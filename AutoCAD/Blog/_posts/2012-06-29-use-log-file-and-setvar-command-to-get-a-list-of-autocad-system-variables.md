---
layout: "post"
title: "Use log file and SETVAR command to get a list of AutoCAD system variables"
date: "2012-06-29 13:02:37"
author: "Wayne Brill"
categories: []
original_url: "https://adndevblog.typepad.com/autocad/2012/06/use-log-file-and-setvar-command-to-get-a-list-of-autocad-system-variables.html "
typepad_basename: "use-log-file-and-setvar-command-to-get-a-list-of-autocad-system-variables"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/wayne-brill.html" target="_self">Wayne Brill</a></p>  <p>You may want to output the system variables to a text file. This VB.NET example turns the log file on and runs the SETVAR command. The QAFLAGS setting of 2 enables the command to complete without having to hit Enter multiple times. </p>  <div style="font-family: consolas; background: white; color: black; font-size: 10pt">   <p style="margin: 0px">&lt;CommandMethod(<span style="color: #a31515">&quot;saveTheVars&quot;</span>)&gt; _</p>    <p style="margin: 0px"><span style="color: blue">Public</span> <span style="color: blue">Sub</span> saveVars()</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Dim</span> strLogFileName <span style="color: blue">As</span> <span style="color: blue">String</span> = _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">Application</span>.GetSystemVariable(<span style="color: #a31515">&quot;LOGFILENAME&quot;</span>)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; MsgBox(<span style="color: #a31515">&quot;Varibles saved in &quot;</span> &amp; strLogFileName)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">' Setting QAFLAGS to 2 allows you to avoid</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">' hitting enter multiple times</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #2b91af">Application</span>.SetSystemVariable(<span style="color: #a31515">&quot;QAFLAGS&quot;</span>, 2)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #2b91af">Application</span>.DocumentManager.MdiActiveDocument _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; .SendStringToExecute _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (<span style="color: #a31515">&quot;_.LOGFILEON &quot;</span>, <span style="color: blue">False</span>, <span style="color: blue">False</span>, <span style="color: blue">False</span>)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">Dim</span> strCmd <span style="color: blue">As</span> <span style="color: blue">String</span></p>    <p style="margin: 0px">&#160;&#160;&#160; strCmd = _</p>    <p style="margin: 0px"><span style="color: #a31515">&quot;(command&quot;</span> &amp; <span style="color: #a31515">&quot;&quot;&quot;_setvar&quot;&quot;&quot;</span> &amp; <span style="color: #a31515">&quot;&quot;&quot;?&quot;&quot;&quot;</span> &amp; <span style="color: #a31515">&quot;&quot;&quot;*&quot;&quot;&quot;</span> &amp; <span style="color: #a31515">&quot;)&quot;</span> _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; &amp; vbCrLf</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #2b91af">Application</span>.DocumentManager.MdiActiveDocument. _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; SendStringToExecute _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (strCmd, <span style="color: blue">False</span>, <span style="color: blue">False</span>, <span style="color: blue">False</span>)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #2b91af">Application</span>.DocumentManager.MdiActiveDocument. _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; SendStringToExecute _</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (<span style="color: #a31515">&quot;_.LOGFILEOFF &quot;</span>, <span style="color: blue">False</span>, <span style="color: blue">False</span>, <span style="color: blue">False</span>)</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">End</span> <span style="color: blue">Sub</span></p> </div>
