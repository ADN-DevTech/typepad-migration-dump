---
layout: "post"
title: "Saving a file with password (Lisp)"
date: "2012-12-06 13:38:57"
author: "Augusto Goncalves"
categories:
  - "Augusto Goncalves"
  - "AutoCAD"
  - "LISP"
original_url: "https://adndevblog.typepad.com/autocad/2012/12/saving-a-file-with-password-lisp.html "
typepad_basename: "saving-a-file-with-password-lisp"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>First we need to create a AcadSecurityParams ActiveX object with some required properties, then call the SaveAs passing this parameter. The following code sample demonstrate it using AutoCAD default values.</p>  <p><span style="line-height: 120%; font-family: &#39;courier new&#39;, courier; font-size: 8pt"><span style="color: #ff0000">(</span><span style="color: #0000ff">setq</span> secparam&#160; <br /><span style="color: #ff0000">(</span><span style="color: #0000ff">vla-getinterfaceobject</span>&#160;<span style="color: #ff0000">(</span><span style="color: #0000ff">vlax-get-acad-object</span><span style="color: #ff0000">)</span>      <br /><span style="color: #ff0000">(</span><span style="color: #0000ff">strcat</span>&#160;<span style="color: #ff00ff">&quot;autocad.securityparams.19&quot;</span><span style="color: #ff0000">)</span><span style="color: #ff0000">)</span><span style="color: #ff0000">)</span>      <br />      <br /><span style="color: #ff0000">(</span><span style="color: #0000ff">vla-put-Action</span> secparam <span style="color: #008000">1</span><span style="color: #ff0000">)</span>&#160;<span style="background-color: #e6e6e6; color: #800080">;; ACADSECURITYPARAMS_ENCRYPT_DATA       <br /></span><span style="color: #ff0000">(</span><span style="color: #0000ff">vla-put-Algorithm</span> secparam <span style="color: #008000">26625</span><span style="color: #ff0000">)</span>&#160;<span style="background-color: #e6e6e6; color: #800080">;; ACADSECURITYPARAMS_ALGID_RC4       <br /></span><span style="color: #ff0000">(</span><span style="color: #0000ff">vla-put-KeyLength</span> secparam <span style="color: #008000">40</span><span style="color: #ff0000">)</span>&#160;<span style="background-color: #e6e6e6; color: #800080">;; default       <br /></span><span style="color: #ff0000">(</span><span style="color: #0000ff">vla-put-password</span> secparam <span style="color: #ff00ff">&quot;MyPass&quot;</span><span style="color: #ff0000">)</span>&#160;<span style="background-color: #e6e6e6; color: #800080">;; specify here...       <br /></span><span style="color: #ff0000">(</span><span style="color: #0000ff">vla-put-ProviderName</span> secparam&#160; <br /><span style="color: #ff00ff">&quot;Microsoft Base Cryptographic Provider v1.0&quot;</span><span style="color: #ff0000">)</span>&#160;<span style="background-color: #e6e6e6; color: #800080">;; default       <br /></span><span style="color: #ff0000">(</span><span style="color: #0000ff">vla-put-ProviderType</span> secparam <span style="color: #008000">1</span><span style="color: #ff0000">)</span>&#160;<span style="background-color: #e6e6e6; color: #800080">;; default       <br /></span>      <br /><span style="color: #ff0000">(</span><span style="color: #0000ff">setq</span> activedoc <span style="color: #ff0000">(</span><span style="color: #0000ff">vla-get-ActiveDocument</span>&#160;<span style="color: #ff0000">(</span><span style="color: #0000ff">vlax-get-Acad-Object</span><span style="color: #ff0000">)</span><span style="color: #ff0000">)</span><span style="color: #ff0000">)</span>      <br /><span style="color: #ff0000">(</span><span style="color: #0000ff">setq</span> fileName <span style="color: #ff00ff">&quot;c:\\temp\\passwordFile.dwg&quot;</span><span style="color: #ff0000">)</span>      <br /><span style="color: #ff0000">(</span><span style="color: #0000ff">setq</span> version <span style="color: #008000">60</span><span style="color: #ff0000">)</span>&#160;<span style="background-color: #e6e6e6; color: #800080">;; <span style="color: #008000">2013</span> DWG        <br /></span><span style="color: #ff0000">(</span><span style="color: #0000ff">vlax-invoke-method</span> activedoc 'SaveAs fileName version secparam<span style="color: #ff0000">)</span></span></p>
