---
layout: "post"
title: "Create Hatch Objects using Trace Boundaries using .NET"
date: "2013-07-16 12:06:37"
author: "Fenton Webb"
categories:
  - ".NET"
  - "2013"
  - "2014"
  - "AutoCAD"
  - "Fenton Webb"
  - "ObjectARX"
original_url: "https://adndevblog.typepad.com/autocad/2013/07/create-hatch-objects-using-trace-boundaries-using-net.html "
typepad_basename: "create-hatch-objects-using-trace-boundaries-using-net"
typepad_status: "Publish"
---

<p>by <a href="http://adndevblog.typepad.com/autocad/fenton-webb.html">Fenton Webb</a></p>  <p>After sweating over some Hatch creation code, I thought I better share with you guys how I solved it.</p>  <p>Here’s what I wanted Hatched:</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0192ac0a86ba970d-pi"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="/assets/image_531090.jpg" width="494" height="245" /></a></p>  <p>The way I made it work was, to first get all of the boundary geometry as Polylines using the <font face="Consolas"><span style="color: "><font color="#2b91af"><font style="font-size: 8pt">Editor</font></font></span><font style="font-size: 8pt"><font color="#000000">.</font></font><span style="color: "><font style="font-size: 8pt" color="#010001">TraceBoundary </font></span></font>function.</p>  <p>This gave me an array of 3 Polylines, shown in red e.g.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b019104415357970c-pi"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="/assets/image_699170.jpg" width="349" height="284" /></a></p>  <p>Next, I add the polylines to the Database (temporarily) so that the Hatch object can process them (outside of any Transaction) – sorry VB <img class="wlEmoticon wlEmoticon-smile" style="border-top-style: none; border-left-style: none; border-bottom-style: none; border-right-style: none" alt="Smile" src="/assets/image_916126.jpg" /></p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">dim</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#010001">loopObjectIds</font></span><font color="#000000"> = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">ObjectIdCollection</font></span><font color="#000000">()</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">Dim</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#010001">db</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">Database</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">Application</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">DocumentManager</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">MdiActiveDocument</font></span><font color="#000000">.</font></font><span style="color: "><font style="font-size: 8pt" color="#010001">Database</font></span></font></p>    <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">' add the loop objects to the dwg</font></font></span></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">For</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#0000ff">Each</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">polyline</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">Polyline</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">In</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#010001">loopObjects</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Using</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">curSpace</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">BlockTableRecord</font></span><font color="#000000"> = </font><span style="color: "><font color="#010001">db</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">CurrentSpaceId</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Open</font></span><font color="#000000">(</font><span style="color: "><font color="#2b91af">OpenMode</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">ForWrite</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">loopObjectIds</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Add</font></span><font color="#000000">(</font><span style="color: "><font color="#2b91af">curSpace</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">AppendEntity</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">polyline</font></span><font color="#000000">))</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">' make sure to close the polyline</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">polyline</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Close</font></span><font color="#000000">()</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">Using</font></span></font></p>    <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#0000ff">Next</font></font></span><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p> </div>  <p>Now append each polyline obtained by the trace as a separate loop e.g.</p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">For</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#0000ff">Each</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">objectId</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">In</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#010001">loopObjectIds</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Dim</font></span><font color="#000000"> </font><span style="color: "><font color="#010001">ids</font></span><font color="#000000"> = </font><span style="color: "><font color="#0000ff">New</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">ObjectIdCollection</font></span><font color="#000000">()</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">ids</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Add</font></span><font color="#000000">(</font><span style="color: "><font color="#010001">objectId</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">acHatch</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">AppendLoop</font></span><font color="#000000">(</font><span style="color: "><font color="#2b91af">HatchLoopTypes</font></span><font color="#000000">.</font><span style="color: "><font color="#010001">Outermost</font></span><font color="#000000">, </font><span style="color: "><font color="#010001">ids</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><span style="color: "><font face="Consolas"><font style="font-size: 8pt" color="#0000ff">Next</font></font></span></p>    <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#2b91af"><font style="font-size: 8pt">acHatch</font></font></span><font style="font-size: 8pt"><font color="#000000">.</font><span style="color: "><font color="#010001">EvaluateHatch</font></span><font color="#000000">(</font><span style="color: "><font color="#0000ff">True</font></span><font color="#000000">)</font></font></font></p> </div>  <p>That’s it!! </p>  <p>   <p>Also, here are the different results obtained by setting the Hatch.HatchStyle to:</p> </p>  <div style="font-size: 8pt; font-family: consolas; background: white; color: black">   <p style="margin: 0px"><span style="color: #2b91af">HatchStyle</span>.<span style="color: #010001">Ignore</span> results in this:</p> </div>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01901e4b414d970b-pi"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="/assets/image_586287.jpg" width="189" height="101" /></a></p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#2b91af"><font style="font-size: 8pt">HatchStyle</font></font></span><font style="font-size: 8pt"><font color="#000000">.</font></font><span style="color: "><font style="font-size: 8pt" color="#010001">Outer </font></span></font>results in this:</p> </div>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01901e4b4157970b-pi"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="/assets/image_347226.jpg" width="201" height="115" /></a></p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#2b91af"><font style="font-size: 8pt">HatchStyle</font></font></span><font style="font-size: 8pt"><font color="#000000">.</font></font><span style="color: "><font style="font-size: 8pt" color="#010001">Normal</font></span></font></p> </div>  <p>results in this:</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0192ac0a86d9970d-pi"><img title="image" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="image" src="/assets/image_806010.jpg" width="209" height="116" /></a></p>            <p>For the record, I could have used the appendLoop function which takes a Curve2dCollection, however I didn’t on this occasion because I didn’t know that we have equivalent .NET functions to these C++ versions…</p>  <p><strong>acdbConvertAcDbCurveToGelibCurve     <br />acdbConvertGelibCurveToAcDbCurve      <br />acdbAssignGelibCurveToAcDbCurve</strong></p>  <p>in .NET</p>  <p><strong>CreateFromGeCurve</strong></p>  <p><strong>SetFromGeCurve</strong></p>
