---
layout: "post"
title: "Getting started with AutoCAD P&amp;ID/Plant 3D 2013 API"
date: "2012-10-30 08:46:38"
author: "Augusto Goncalves"
categories:
  - ".NET"
  - "Augusto Goncalves"
  - "Plant3D"
  - "PnID"
original_url: "https://adndevblog.typepad.com/autocad/2012/10/getting-started-with-autocad-pidplant-3d-2013-api.html "
typepad_basename: "getting-started-with-autocad-pidplant-3d-2013-api"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>If you plan to start developing for any new product, a quick ‘getting started’ guide can be very useful. Here is what you need to develop for AutoCAD P&amp;ID/Plant 3D 2013.</p>  <p>Setting up the environment:</p>  <ol>   <li><strong><u>Product</u></strong>: there are two options: <a href="http://usa.autodesk.com/autocad-pid/">AutoCAD P&amp;ID</a> and <a href="http://usa.autodesk.com/autocad-plant-3d/">AutoCAD Plant 3D</a>. Check the trial versions available at <a title="http://usa.autodesk.com/products/free-product-trials" href="http://usa.autodesk.com/products/free-product-trials">http://usa.autodesk.com/products/free-product-trials</a>.       <br />      <br />From the API perspective, the second includes the first. An application developed for P&amp;ID can load on Plant 3D and work according to the current project/drawing type.      <br /></li>    <li><strong><u>Develop interface</u></strong>: to develop for AutoCAD P&amp;ID and Plant 3D we need a programming environment.       <br />      <br />The P&amp;ID/Plant 3D API was developed in .NET, which means we can use any .NET programming language, where <a href="http://en.wikipedia.org/wiki/Visual_Basic_.NET">VB.NET</a> and <a href="http://en.wikipedia.org/wiki/C_Sharp_%28programming_language%29">C#</a> are supported by Autodesk. It’s also possible to use Managed C++, also supported, but recommended for advanced developers.      <br />      <br />Microsoft offers the <a href="http://www.microsoft.com/express">Visual Express</a> edition to get started, just keep in mind that the version 2010 is required for AutoCAD 2013 based products. Make sure you download either Visual C# 2010 Express or Visual Basic 2010 Express.       <br />      <br />There is no relevant difference between C# to VB.NET regarding API features, so it’s a matter of which one you fell more confortable. Anytime you find code on one language and want to translate to the other, consider translate using online services like <a href="http://www.developerfusion.com/tools/convert">Developer Fusion</a>. Most of posts on this blog are in C#.      <br /></li>    <li><strong><u>SDK</u></strong>: the software development kit (SDK) contains all the files required to compile the code. Download it from <a href="http://usa.autodesk.com/adsk/servlet/index?siteID=123112&amp;id=15460551">ADN P&amp;ID/Plant 3D Developer Center</a>, make sure you download the proper version, e.g. <a href="http://images.autodesk.com/adsk/files/PlantSDK_2013_All.exe">2013</a>. As this product is based on AutoCAD, we also need to download the <a href="http://usa.autodesk.com/adsk/servlet/index?siteID=123112&amp;id=773204">AutoCAD SDK</a> (again make sure you select 2013).       <br />      <br />Due changes on the APIs, 2012 is not compatible with 2013, so applications developed for 2012 will not load on 2013. Some code change may be required before recompile.      <br />      <br />Documentation is available under <strong>\Plant SDK 2013\docs\</strong> folder. The <strong>plantsdk_dev.chm</strong> file is like a book, with first steps at the beginning and the topics advance throughout the reading. Now the <strong>plantsdk_ref.chm</strong> contains a full list of API objects and methods, useful for daily basis consult.      <br />      <br />The SDK also contains several interesting samples under <strong>\Plant SDK 2013\Samples\</strong> folder. The same applies to AutoCAD SDK under <strong>\ObjectARX 2013\samples\</strong>. </li> </ol>  <p>With all the above downloaded and installed, launch Visual C# Express or Visual Basic Express. Here I’ll show some images on Visual C#. Go to menu ‘File’, then ‘New Project’. On the window, select ‘Class Library’ as project type, finally give it a name, that cannot contains spaces or start with numbers (e.g. MyFirstPlant3DApp). </p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017d3d1e2adf970c-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="new_project" border="0" alt="new_project" src="/assets/image_205868.jpg" width="479" height="271" /></a></p>  <p>Now, following the image below, (1) go to ‘Solution Explorer’ palette. If you cannot see it, go to menu ‘View’, then submenu ‘Other Windows’ and select it. Now (2) right click on references to ‘Add Reference’. </p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017d3d1e2b20970c-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="add_references" border="0" alt="add_references" src="/assets/image_162446.jpg" width="328" height="278" /></a></p>  <p>On the window that opens (not shown), click on ‘Browse’ and navigate to AutoCAD SDK folder. Under <strong>\ObjectARX 2013\inc\ </strong>select <strong>AcMgd.dll</strong>,<strong> AcCoreMgd.dll</strong> and <strong>AcDbMgd.dll</strong>. These references will be used to access AutoCAD basic features required to build an application, such as command line and selection mechanism.</p>  <p>Now to add P&amp;ID and/or Plant 3D references, navigate to <strong>\Plant SDK 2013\inc-x64\</strong> or <strong>\Plant SDK 2013\inc-win32\</strong> depending on your OS configuration. References prefixed with PnID*** are for P&amp;ID and Plant 3D, references prefixed with PnP3d*** are for Plant 3D only. </p>  <p>All AutoCAD and P&amp;ID/Plant3D references must be marked with Copy Local equals false. This is extremely important. Otherwise, AutoCAD may crash unexpected.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017d3d1e2b83970c-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="copy_local" border="0" alt="copy_local" src="/assets/image_83794.jpg" width="194" height="385" /></a></p>  <p>Now you have a .NET project ready to use any C# sample available at this blog, try any sample for <a href="http://adndevblog.typepad.com/autocad/pnid/">P&amp;ID</a> or <a href="http://adndevblog.typepad.com/autocad/plant3d/">Plant 3D</a>. </p>  <p>After copy &amp; paste any sample code or write your own, go to menu ‘Debug’ then ‘Build Solution’, which will build a .dll, for this sample project, it should be at <strong>bin\Release\MyFirstPlant3DApp.dll</strong> (Visual Express always create .dll at Release folder for Build and at Debug folder while debugging, pay attention).</p>  <p>Now start AutoCAD P&amp;ID/Plant 3D and run NETLOAD command, choose the .dll generated by your project, finally run the custom command.</p>
