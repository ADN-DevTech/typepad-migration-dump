---
layout: "post"
title: "How to get Document Property"
date: "2012-05-15 23:59:43"
author: "Xiaodong Liang"
categories:
  - "2010"
  - "2011"
  - "2012"
  - "2013"
  - "AutoCAD"
  - "ObjectARX"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/autocad/2012/05/how-to-get-document-property.html "
typepad_basename: "how-to-get-document-property"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/aec/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>  <p>If you want to access the document property as DWGPROPS does, you will need to use <b>acdbGetSummaryInfo</b>. that is a global function to retrieve file information.</p>  <p>&#160;</p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> testCmd(</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">{ </span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// assume a drawing is opened</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; AcDbDatabaseSummaryInfo *pSummaryInfo = NULL; </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (Acad::eOk != </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; acdbGetSummaryInfo(acdbHostApplicationServices()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; -&gt;workingDatabase(), </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; pSummaryInfo)) </span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; {&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%">; } </span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">for</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: blue">int</span><span style="line-height: 140%"> i = 0; </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; i &lt; pSummaryInfo-&gt;numCustomInfo(); </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; i++) </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; { </span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160; <span style="line-height: 140%">&#160;&#160; </span><span style="line-height: 140%; color: green">// get custom properties</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160; ACHAR *pName, *pValue; </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160; pSummaryInfo-&gt;getCustomSummaryInfo(i,pName, pValue); </span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; acutPrintf(L</span><span style="line-height: 140%; color: #a31515">&quot;\nKey: %s, Value = %s&quot;</span><span style="line-height: 140%">,pName, pValue); </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; } </span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; acdbFree(pSummaryInfo); </span></p>    <p style="margin: 0px"><span style="line-height: 140%">}</span></p> </div>
