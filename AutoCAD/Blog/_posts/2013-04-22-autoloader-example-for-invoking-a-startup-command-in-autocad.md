---
layout: "post"
title: "Autoloader Example for invoking a Startup Command in AutoCAD"
date: "2013-04-22 11:47:01"
author: "Fenton Webb"
categories:
  - ".NET"
  - "2012"
  - "2013"
  - "AutoCAD"
  - "Fenton Webb"
original_url: "https://adndevblog.typepad.com/autocad/2013/04/autoloader-example-for-invoking-a-startup-command-in-autocad.html "
typepad_basename: "autoloader-example-for-invoking-a-startup-command-in-autocad"
typepad_status: "Publish"
---

<div style="font-family: ; background: white; color: ">   <p style="margin: 0px">by <a href="http://adndevblog.typepad.com/autocad/fenton-webb.html"><font color="#0066cc">Fenton Webb</font></a></p>    <p style="margin: 0px">&#160;</p> </div>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px">Initializing AutoCAD UI from within your .NET Initialize() is not advised. The reason is that your .NET DDL may be loaded on AutoCAD startup, and at the point Initialize for your App is called certain subsystems inside of AutoCAD have not properly initialized â€“ e.g. Ribbon, COM, Palettes, etc.</p> </div>  <p>The normal solution is to create a document event reactor inside of your Initialize() and watch for a new document created, then from within there create another event reactor which watches for AutoCAD entering Quiescent state, then, from within that function callback do your initialize.</p>  <p>Using the Autoloader, all of this is handled for your automatically, simply use the Commands::Command.StartupCommand attribute to indicate your startup/initialize command. e.g.</p>  <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">&lt;?</font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#a31515">xml</font></span><span style="color: "><font color="#0000ff"> </font></span><span style="color: "><font color="#ff0000">version</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">1.0</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff"> </font></span><span style="color: "><font color="#ff0000">encoding</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">utf-8</font></span><font color="#000000">&quot;</font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">?&gt;</font></span></font></p>  <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">&lt;</font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#a31515">ApplicationPackage</font></span><span style="color: "><font color="#0000ff"> </font></span><span style="color: "><font color="#ff0000">SchemaVersion</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">1.0</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff"> </font></span><span style="color: "><font color="#ff0000">AutodeskProduct</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">AutoCAD</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff"> </font></span><span style="color: "><font color="#ff0000">Name</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">MyTestApp</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff"> </font></span><span style="color: "><font color="#ff0000">Description</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">FentyCAD demo app</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff"> </font></span><span style="color: "><font color="#ff0000">AppVersion</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">1.0.0</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff"> </font></span><span style="color: "><font color="#ff0000">FriendlyVersion</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">1.0.0</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff"> </font></span><span style="color: "><font color="#ff0000">ProductType</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">Application</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff"> </font></span><span style="color: "><font color="#ff0000">SupportedLocales</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">Enu</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff"> </font></span><span style="color: "><font color="#ff0000">AppNameSpace</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">appstore.exchange.autodesk.com</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff"> </font></span><span style="color: "><font color="#ff0000">Author</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">Fenton Webb</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff"> </font></span><span style="color: "><font color="#ff0000">ProductCode</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">{17FFEEB3-D653-491D-97D3-40FC069FB967}</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff"> </font></span><span style="color: "><font color="#ff0000">UpgradeCode</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">{1F07C18D-E5D9-4775-9A80-3E240CB4D1C3}</font></span><font color="#000000">&quot;</font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font></p>  <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">&#160; &lt;</font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#a31515">RuntimeRequirements</font></span><span style="color: "><font color="#0000ff"> </font></span><span style="color: "><font color="#ff0000">OS</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">Win32|Win64</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff"> </font></span><span style="color: "><font color="#ff0000">Platform</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">AutoCAD|AutoCAD*</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff"> </font></span><span style="color: "><font color="#ff0000">SeriesMin</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">R19.0</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff"> </font></span><span style="color: "><font color="#ff0000">SeriesMax</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">R19.1</font></span><font color="#000000">&quot;</font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff"> /&gt;</font></span></font></p>  <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">&#160; &lt;</font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#a31515">CompanyDetails</font></span><span style="color: "><font color="#0000ff"> </font></span><span style="color: "><font color="#ff0000">Name</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">FentyCAD</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff"> </font></span><span style="color: "><font color="#ff0000">Url</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">www.FentyCAD.com</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff"> </font></span><span style="color: "><font color="#ff0000">Email</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">info@FentyCAD.com</font></span><font color="#000000">&quot;</font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff"> /&gt;</font></span></font></p>  <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">&#160; &lt;</font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#a31515">Components</font></span><span style="color: "><font color="#0000ff"> </font></span><span style="color: "><font color="#ff0000">Description</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">Any CPU DLLs</font></span><font color="#000000">&quot;</font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font></p>  <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160; &lt;</font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#a31515">RuntimeRequirements</font></span><span style="color: "><font color="#0000ff"> </font></span><span style="color: "><font color="#ff0000">OS</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">Win32|Win64</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff"> </font></span><span style="color: "><font color="#ff0000">Platform</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">AutoCAD|AutoCAD*</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff"> </font></span><span style="color: "><font color="#ff0000">SeriesMin</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">R19.0</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff"> </font></span><span style="color: "><font color="#ff0000">SeriesMax</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">R19.1</font></span><font color="#000000">&quot;</font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff"> /&gt;</font></span></font></p>  <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160; &lt;</font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#a31515">ComponentEntry</font></span><span style="color: "><font color="#0000ff"> </font></span><span style="color: "><font color="#ff0000">AppName</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">FentiCADMain</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff"> </font></span><span style="color: "><font color="#ff0000">Version</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">1.0.0</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff"> </font></span><span style="color: "><font color="#ff0000">ModuleName</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">./Contents/Windows/MyApp.dll</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff"> </font></span><span style="color: "><font color="#ff0000">AppDescription</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">Main App .NET DLL</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff"> </font></span><span style="color: "><font color="#ff0000">LoadOnCommandInvocation</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">True</font></span><font color="#000000">&quot;</font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font></p>  <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; &lt;</font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#a31515">Commands</font></span><span style="color: "><font color="#0000ff"> </font></span><span style="color: "><font color="#ff0000">GroupName</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">FentyCAD_MAIN</font></span><font color="#000000">&quot;</font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font></p>  <p style="margin: 0px"><font face="Consolas"><strong><span style="color: "><font color="#0000ff">&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;</font></span><span style="color: "><font color="#a31515">Command</font></span><span style="color: "><font color="#0000ff"> </font></span><span style="color: "><font color="#ff0000">Local</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">_FCStartup</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff"> </font></span><span style="color: "><font color="#ff0000">Global</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">FCStartup</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff"> </font></span><span style="color: "><font color="#ff0000">Description</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">Startup command used to initialize my app</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff"> </font></span><span style="color: "><font color="#ff0000">StartupCommand</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">True</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff"> /&gt;</font></span></strong></font></p>  <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; &lt;/</font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#a31515">Commands</font></span></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font></p>  <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160; &lt;/</font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#a31515">ComponentEntry</font></span></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font></p>  <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">&#160; &lt;/</font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#a31515">Components</font></span></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font></p>  <p style="margin: 0px"><font face="Consolas"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">&lt;/</font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#a31515">ApplicationPackage</font></span></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font></p>
