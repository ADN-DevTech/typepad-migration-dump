---
layout: "post"
title: "Getting full path of loaded LISP files by ARX"
date: "2012-06-24 08:34:58"
author: "Xiaodong Liang"
categories:
  - "AutoCAD"
  - "ObjectARX"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/autocad/2012/06/getting-full-path-of-loaded-lisp-files-by-arx.html "
typepad_basename: "getting-full-path-of-loaded-lisp-files-by-arx"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>  <p><strong>Issue     <br /></strong> How can I get the full path of loaded LISP applications? </p>  <p><strong>Solution     <br /></strong> There are two APIs on the AcApDocument class in ObjectARX that you can use to get this information. </p>  <p>The following is more information on these functions: </p>  <p>virtual int GetCountOfLispList() const;</p>  <p>Returns the number of load LISP files. </p>  <p>virtual AcLispAppInfo* GetItemOfLispList(int nIndex) const;</p>  <p>Returns the descriptor structure for the LISP application designated by nIndex. </p>  <p>Paramters: </p>  <p>nIndex - integer between 0 and GetCountOfLispList() </p>  <p>class AcLispAppInfo   <br />{    <br />&#160;&#160;&#160;&#160; public: TCHAR appFileName[_MAX_PATH];     <br />&#160;&#160;&#160;&#160; bool bUnloadable;    <br />};    <br />Returned by the GetItemOfLispList.     <br />appFileName - full path of the lisp application    <br /> bUnloadable - specifies if the lisp application is unloadable </p>  <p>&#160;</p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%; color: blue">static</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> getLISPFullPathByARX()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">{</span></p>    <p style="margin: 0px"><span style="line-height: 140%"> AcApDocument* pActiveDoc =</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160; acDocManager-&gt;mdiActiveDocument(); </span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">// count of LISP files</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">int</span><span style="line-height: 140%"> lispCount = pActiveDoc-&gt;GetCountOfLispList();</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%"> CString msg;</span></p>    <p style="margin: 0px"><span style="line-height: 140%"> msg.Format(L</span><span style="line-height: 140%; color: #a31515">&quot;count of LISP file: %d&quot;</span><span style="line-height: 140%">,lispCount);</span></p>    <p style="margin: 0px"><span style="line-height: 140%"> MessageBox(NULL,msg,msg,0); </span></p>    <p style="margin: 0px">&#160;</p>    <div style="font-family: courier new; background: white; color: black; font-size: 8pt">     <p style="margin: 0px"><span style="line-height: 140%">&#160;</span><span style="line-height: 140%; color: green">// each LISP info</span></p>   </div>    <p style="margin: 0px"><span style="line-height: 140%">&#160;</span><span style="line-height: 140%; color: blue">for</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: blue">int</span><span style="line-height: 140%"> index = 0 ;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160; index &lt; lispCount;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160; index++)</span></p>    <p style="margin: 0px"><span style="line-height: 140%"> {</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160; TCHAR msg1[256] = {0}; </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160; AcLispAppInfo *pEachInfo = </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; pActiveDoc-&gt;GetItemOfLispList(index);</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160; _tcscat( msg1,pEachInfo-&gt;appFileName);</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%">(pEachInfo-&gt;bUnloadable)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; _tcscat(msg1,L</span><span style="line-height: 140%; color: #a31515">&quot;\nloadable\n&quot;</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">else</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; _tcscat(msg1,L</span><span style="line-height: 140%; color: #a31515">&quot;\nunloadable\n&quot;</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; MessageBox(NULL,msg1,msg1,0); </span></p>    <p style="margin: 0px"><span style="line-height: 140%"> }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">}</span></p> </div>
