---
layout: "post"
title: "Lock a viewport using Visual LISP"
date: "2013-01-08 10:57:38"
author: "Augusto Goncalves"
categories:
  - "Augusto Goncalves"
  - "AutoCAD"
  - "LISP"
original_url: "https://adndevblog.typepad.com/autocad/2013/01/lock-a-viewport-using-visual-lisp.html "
typepad_basename: "lock-a-viewport-using-visual-lisp"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>It is not possible to lock the viewport by using (entmod).&#160; However, it can be successfully done using ActiveX functions.&#160; The following sample code checks the viewport object's <strong>DisplayLocked</strong> property and, if currently unlocked, proceeds to lock it:</p>  <p><span style="line-height: 120%; font-family: &#39;courier new&#39;, courier; font-size: 8pt"><span style="color: #ff0000">(</span><span style="color: #0000ff">defun</span> c:LockVP <span style="color: #ff0000">(</span><span style="color: #ff0000">)</span>      <br />&#160;&#160;&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">vl-load-com</span><span style="color: #ff0000">)</span>      <br />&#160;&#160;&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">setq</span> app <span style="color: #ff0000">(</span><span style="color: #0000ff">vlax-get-acad-object</span><span style="color: #ff0000">)</span>      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; doc <span style="color: #ff0000">(</span><span style="color: #0000ff">vla-get-activedocument</span> app<span style="color: #ff0000">)</span>      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ent <span style="color: #ff0000">(</span><span style="color: #0000ff">car</span>&#160;<span style="color: #ff0000">(</span><span style="color: #0000ff">entsel</span>&#160;<span style="color: #ff00ff">&quot;\nSelect a viewport:&quot;</span><span style="color: #ff0000">)</span><span style="color: #ff0000">)</span>      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; obj <span style="color: #ff0000">(</span><span style="color: #0000ff">vlax-ename-</span>&gt;vla-object ent<span style="color: #ff0000">)</span>      <br />&#160;&#160;&#160; <span style="color: #ff0000">)</span>      <br />&#160; <br />&#160;&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">if</span>&#160;<span style="color: #ff0000">(</span>= <span style="color: #ff0000">(</span><span style="color: #0000ff">vlax-get-property</span> obj 'objectName<span style="color: #ff0000">)</span>&#160;<span style="color: #ff00ff">&quot;AcDbViewport&quot;</span><span style="color: #ff0000">)</span>      <br />&#160;&#160;&#160;&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">progn</span>      <br />      <br />      <br />&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">setq</span> vpLk <span style="color: #ff0000">(</span><span style="color: #0000ff">vlax-get-property</span> obj 'DisplayLocked<span style="color: #ff0000">)</span><span style="color: #ff0000">)</span>      <br />&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">if</span>&#160;<span style="color: #ff0000">(</span>= vpLk :vlax-false<span style="color: #ff0000">)</span>      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">progn</span>      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">vlax-put-property</span> obj 'DisplayLocked :vlax-true<span style="color: #ff0000">)</span>      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">setq</span> vpLk <span style="color: #ff0000">(</span><span style="color: #0000ff">vlax-get-property</span> obj 'DisplayLocked<span style="color: #ff0000">)</span><span style="color: #ff0000">)</span>      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">alert</span>&#160;<span style="color: #ff00ff">&quot;Viewport is now locked&quot;</span><span style="color: #ff0000">)</span>      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #ff0000">)</span>      <br />&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">alert</span>&#160;<span style="color: #ff00ff">&quot;Viewport was already locked&quot;</span><span style="color: #ff0000">)</span>      <br />&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #ff0000">)</span>      <br />&#160;&#160;&#160;&#160; <span style="color: #ff0000">)</span>      <br />&#160;&#160; <span style="color: #ff0000">(</span><span style="color: #0000ff">alert</span>&#160;<span style="color: #ff00ff">&quot;Not a viewport&quot;</span><span style="color: #ff0000">)</span>      <br />&#160;&#160; <span style="color: #ff0000">)</span>      <br /><span style="color: #ff0000">)</span>&#160; </span></p>
