AUTHOR: Madhukar Moogala
AUTHOR EMAIL: fpdtypepadadmin@autodesk.com
TITLE: Boston Forge Accelerator
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: boston-forge-accelerator
CATEGORY: Announcement

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2018/03/boston-forge-accelerator.html 
DATE: 03/20/2018 11:47:53 PM
-----
BODY:
<p>The Forge team is accepting proposals for the upcoming Accelerator taking place in the Autodesk Boston office from April 30 - May 4, 2018.</p>
<p>It is a great opportunity for your software development team to learn and work intensively on a Forge-based project with one-on-one support and advice from Autodesk Forge API experts.&#0160; If you have an idea for a new web or mobile application based on Autodesk Forge APIs, or you need help getting an existing application working, then come along to the event. There is no cost to attend the Accelerator other than your own travel and living expenses. However, we do ask that you submit a proposal as part of your application so that we can verify that the intended use of the Autodesk Forge APIs in your project is feasible.</p>
<p>Apply and submit your proposal <a href="http://autodeskcloudaccelerator.com/apply/">here</a>. For more information, please visit the Forge Accelerator <a href="http://autodeskcloudaccelerator.com/forge-accelerator/">website</a>.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Madhukar Moogala
AUTHOR EMAIL: fpdtypepadadmin@autodesk.com
TITLE: Register now for Autodesk DevDays Online Webinars
STATUS: Draft
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: register-now-for-autodesk-devdays-online-webinars
CATEGORY: Announcement

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2018/01/register-now-for-autodesk-devdays-online-webinars.html 
DATE: 01/09/2018 12:12:59 AM
-----
BODY:
<p>Join us for the series of seven DevDays Webinars that begin on February 6<sup>th</sup>.&#0160;&#0160;</p>
<p>&#0160;DevDays Online is the best way keep up to date with new and upcoming technology and features. After the introductory business-oriented session that will review Autodesk’s business growth curves—past, present and future, most of the webinars will focus on desktop application development, and additionally two on Forge and one on BIM 360 for cloud development.&#0160;</p>
<p>&#0160;As in previous DevDays events we have a theme: “The Journey Continues”. &#0160;In the first webinar—DevDays Keynotes—Jim Quanci, Senior Director, Software Partner Development, will cover the” journey” in-depth with a presentation on Autodesk’s strategic direction.&#0160; This will cover the move to subscription licenses, Forge strategy, the Autodesk App Store and more.&#0160; As he discusses the transition Autodesk is going through from a business and technical perspective Jim will also explain the opportunities this transition creates for software partners, including our plans to build a much larger customer base—accessible to you.</p>
<p>In the desktop software webinars, you will learn about the product and API changes and enhancements for AutoCAD, Revit, Civil 3D, InfraWorks, Inventor, Vault and Fusion.&#0160; These sessions will help you prepare for the upcoming Autodesk 2019 family of products so that you can be ready to delight our joint customers by having your applications compatible with the new releases.&#0160;</p>
<p>&#0160;In addition to making sure you stay current with Autodesk desktop technology now is the time to start investing in “what’s next”—the next wave in the journey.&#0160; Forge is Autodesk’s answer to “what’s next”.&#0160; Forge is the foundation cloud/web technology platform that Autodesk is building its next generation of tools on—and also making available to you. Forge is not an Autodesk “experiment”.&#0160; It’s your opportunity to catch the next wave—the shift to the cloud. Autodesk itself is the largest user of Forge in the world—with several hundred thousand users every day using BIM 360, Fusion 360, A360 and more. Join us—and, over a thousand companies that have built Forge into their apps/services already. Attend the two Forge webinars to learn how you too can deliver new capabilities to your customers.&#0160; Learn more about <a href="https://forge.autodesk.com/">Forge</a>.</p>
<p><strong>DevDays Online Webinars</strong></p>
<p>Register today for the webinar(s) of your choice:</p>
<table border="2" style="height: 141px; width: 460px; border-color: #2b0522;">
<tbody>
<tr>
<td style="width: 65.8px;"><strong>Date</strong></td>
<td style="width: 278.2px;"><strong>Title</strong></td>
<td style="width: 125px;"><strong>Registration link&#0160;&#0160;&#0160;&#0160;</strong></td>
</tr>
<tr>
<td style="width: 65.8px;"><strong>Tues, Feb 6 2018</strong></td>
<td style="width: 278.2px;"><strong>DevDays Keynotes</strong></td>
<td style="width: 125px;"><strong>&#0160;<a href="https://register.gotowebinar.com/register/797707066268687619">Register</a>&#0160;</strong></td>
</tr>
<tr>
<td style="width: 65.8px;"><strong>Wed, Feb 7 2018</strong></td>
<td style="width: 278.2px;"><strong>Forge Platform overview and Roadmap</strong></td>
<td style="width: 125px;">&#0160;<strong><a href="https://attendee.gotowebinar.com/register/4102861009595953155">Register</a></strong></td>
</tr>
<tr>
<td style="width: 65.8px;"><strong>Thu, Feb 8 2018</strong></td>
<td style="width: 278.2px;"><strong>Revit API, Civil 3D &amp; InfraWorks updates</strong></td>
<td style="width: 125px;"><strong>&#0160;<a href="https://attendee.gotowebinar.com/register/490550796468203011">Register</a></strong></td>
</tr>
<tr>
<td style="width: 65.8px;"><strong>Tue, Feb 13 2018</strong></td>
<td style="width: 278.2px;"><strong>Forge API update (in detail)</strong></td>
<td style="width: 125px;"><strong>&#0160;<a href="https://attendee.gotowebinar.com/register/8531203464091738883">Register</a></strong></td>
</tr>
<tr>
<td style="width: 65.8px;"><strong>Wed, Feb 14 2018</strong></td>
<td style="width: 278.2px;"><strong>Inventor, Vault and Fusion API updates</strong></td>
<td style="width: 125px;"><strong>&#0160;<a href="https://attendee.gotowebinar.com/register/4033528005371724547">Register</a></strong></td>
</tr>
<tr>
<td style="width: 65.8px;"><strong>Thu, Feb 15 2018</strong></td>
<td style="width: 278.2px;"><strong>AutoCAD® and Design Automation for AutoCAD API updates</strong></td>
<td style="width: 125px;"><strong>&#0160;<a href="https://attendee.gotowebinar.com/register/8219783288198582531">Register</a></strong></td>
</tr>
<tr>
<td style="width: 65.8px;"><strong>Tue, Feb 20 2018</strong></td>
<td style="width: 278.2px;"><strong>BIM 360 product and API update </strong></td>
<td style="width: 125px;"><strong>&#0160;<a href="https://attendee.gotowebinar.com/register/3690479277994010883">Register</a></strong></td>
</tr>
</tbody>
</table>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: StationOffsetLabel.Create quick sample code
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: stationoffsetlabelcreate-quick-sample-code
CATEGORY: .NET
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2016/05/stationoffsetlabelcreate-quick-sample-code.html 
DATE: 05/05/2016 11:22:40 AM
-----
BODY:
<p>By Augusto Goncalves (<a href="https://twitter.com/augustomaia">@augustomaia</a>)</p>
<p>This is a quick sample code on how call StationOffsetLabel.Create method for all Alignments on each Station increment interval. Note it&#39;s using the first StationOffsetLabelStyle and first MarkerStyle from the respective style collections.</p>

<div>
<pre style="margin: 0; line-height: 125%;"><span style="color: #7d9029;">[CommandMethod(&quot;addStationOffsetLabel&quot;)]</span>
<span style="color: #008000; font-weight: bold;">public</span> <span style="color: #008000; font-weight: bold;">static</span> <span style="color: #008000; font-weight: bold;">void</span> <span style="color: #0000ff;">CmdAddStationOffsetLabel</span>()
{
  CivilDocument civilDoc = CivilApplication.ActiveDocument;
  Database db = Application.DocumentManager.MdiActiveDocument.Database;
  <span style="color: #008000; font-weight: bold;">using</span> (Transaction trans = db.TransactionManager.StartTransaction())
  {
    <span style="color: #008000; font-weight: bold;">foreach</span> (ObjectId alignId <span style="color: #008000; font-weight: bold;">in</span> civilDoc.GetSitelessAlignmentIds())
    {
      Alignment align = trans.GetObject(alignId, OpenMode.ForRead) <span style="color: #008000; font-weight: bold;">as</span> Alignment;

      <span style="color: #008000; font-weight: bold;">for</span> (<span style="color: #b00040;">double</span> s = align.StartingStation; s &lt; align.EndingStation; s+= align.StationIndexIncrement)
      {
        <span style="color: #b00040;">double</span> easting = <span style="color: #666666;">0</span>;
        <span style="color: #b00040;">double</span> northing = <span style="color: #666666;">0</span>;
        align.PointLocation(s, <span style="color: #666666;">0</span>, <span style="color: #008000; font-weight: bold;">ref</span> easting, <span style="color: #008000; font-weight: bold;">ref</span> northing);

        Point2d p = <span style="color: #008000; font-weight: bold;">new</span> Point2d(easting, northing);
        StationOffsetLabel.Create(
          alignId, 
          civilDoc.Styles.LabelStyles.AlignmentLabelStyles.StationOffsetLabelStyles[<span style="color: #666666;">0</span>], 
          civilDoc.Styles.MarkerStyles[<span style="color: #666666;">0</span>], 
          p);
      }
    }
    trans.Commit();
  }
}
</pre>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Set elevation for FeatureLine Points
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 0
ALLOW PINGS: 0
BASENAME: set-elevation-for-featureline-points
CATEGORY: .NET
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2016/04/set-elevation-for-featureline-points.html 
DATE: 04/14/2016 11:40:51 AM
-----
BODY:
<p>By Augusto Goncalves (<a href="http://twitter.com/augustomaia">@augustomaia</a>)</p>
<p>Since <a href="http://adndevblog.typepad.com/infrastructure/2015/08/civil-3d-2016-sp-1-new-feature-line-api.html">Civil 3D 2016 SP1</a> we have the Feature Line API available for developers. It's possible to set new elevation for points on the feature line,&nbsp;but it may not be that direct to do so as we need the index of the point and, if we think in delta of elevation, we need the original point elevation.&nbsp;</p>
<p>This quick extension method aims to do that, just call <strong>FeatureLine.SetPointNewElevation(somePoint, elevationDelta)</strong></p>
<!-- HTML generated using hilite.me --><div><pre style="margin: 0; line-height: 125%"><span style="color: #0000aa">public</span> <span style="color: #0000aa">static</span> <span style="color: #0000aa">void</span> <span style="color: #00aa00">SetNewPointElevation</span>(<span style="color: #0000aa">this</span> FeatureLine fl,
  Point3d point, <span style="color: #00aaaa">double</span> elevationDelta)
{
  <span style="color: #aaaaaa; font-style: italic">// get all points on the Feature Line</span>
  Point3dCollection pointsOnFL = 
    fl.GetPoints(FeatureLinePointType.AllPoints);

  <span style="color: #aaaaaa; font-style: italic">// find the closest point and index</span>
  <span style="color: #00aaaa">double</span> distance = <span style="color: #00aaaa">double</span>.MaxValue;
  <span style="color: #00aaaa">int</span> index= <span style="color: #009999">0</span>;
  Point3d closestPointOnCurve = Point3d.Origin;
  <span style="color: #0000aa">for</span> (<span style="color: #00aaaa">int</span> i = <span style="color: #009999">0</span>; i &lt; pointsOnFL.Count; i++ )
  {
    Point3d p = pointsOnFL[i];
    <span style="color: #0000aa">if</span> (p.DistanceTo(point) &lt; distance){
      distance = p.DistanceTo(point);
      closestPointOnCurve = p;
      index = i;
    }
  }

  <span style="color: #aaaaaa; font-style: italic">// apply the delta</span>
  fl.SetPointElevation(index,
    closestPointOnCurve.Z + elevationDelta);
}
</pre></div>

-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Profile entities by order via EntityAtId
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: profile-entities-by-order-via-entityatid
CATEGORY: .NET
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2016/04/profile-entities-by-order-via-entityatid.html 
DATE: 04/05/2016 07:04:38 AM
-----
BODY:
<p>By Augusto Goncalves (<a href="https://twitter.com/augustomaia">@augustomaia</a>)</p>
<p>Unlike Alignment.Entities.GetEntityByOrder, the Profile.Entities only offers a plain enumerator or .EntityAtId. But don&#39;t worry! With the FirstEntity we can iterate through the collection using a loop. The following code snippet show the idea.&#0160;</p>
<p>By the way, the .NET Extension method will not work here due the <a href="https://blogs.msdn.microsoft.com/ericwhite/2009/04/08/why-i-dont-use-the-foreach-extension-method/">stateless paradigm</a>.&#0160;</p>

<div>
<pre style="margin: 0; line-height: 125%;">Profile p = <span style="color: #aaaaaa; font-style: italic;">// get the object here</span>

<span style="color: #00aaaa;">uint</span> index = p.Entities.FirstEntity;
<span style="color: #0000aa;">try</span>
{
  <span style="color: #0000aa;">while</span>(<span style="color: #0000aa;">true</span>)
  {
    <span style="color: #aaaaaa; font-style: italic;">// get current entity</span>
    ProfileEntity profileEntity = p.Entities.EntityAtId(index);
        
    <span style="color: #aaaaaa; font-style: italic;">// do something</span>
    <span style="color: #aaaaaa; font-style: italic;">//</span>
    <span style="color: #aaaaaa; font-style: italic;">//</span>

    <span style="color: #aaaaaa; font-style: italic;">// get the next entity</span>
    index = profileEntity.EntityAfter; <span style="color: #aaaaaa; font-style: italic;">// throw exception</span>
  }

}
<span style="color: #0000aa;">catch</span>
{
  <span style="color: #aaaaaa; font-style: italic;">// EntityAfter will throw an excetion, end of the loop;</span>
}
</pre>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Profile Geometry Points on Alignment Label Styles
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: profile-geometry-points-on-alignment-label-styles
CATEGORY: .NET
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2016/03/profile-geometry-points-on-alignment-label-styles.html 
DATE: 03/01/2016 07:19:49 AM
-----
BODY:
<p>By Augusto Goncalves (<a href="https://twitter.com/augustomaia">@augustomaia</a>)</p>
<p>The Civil 3D Styles collection is big, really big. Under <strong>CivilDocument.Styles</strong> we can read most of the information, but it can be tricky to dig it. This post show how to read Profile Geometry Points, as shown at the image below, for Alignment Label Set style.</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01bb08c11d33970d-pi" style="display: inline;"><img alt="Style" border="0" class="asset  asset-image at-xid-6a0167607c2431970b01bb08c11d33970d image-full img-responsive" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01bb08c11d33970d-800wi" title="Style" /></a></p>
<p>The basic idea for this code is to get the <strong>LabelSetStyles</strong>, then the collection of <strong>AlignmentLabelSetItem</strong>, filter by <strong>ProfileGeometryPoint</strong> and, finally, get the dictionary containing the <strong>ProfilePointType</strong> and a boolean that indicates if is checked or not. Note the dictionary&#0160;will only show checked items (true) and, if is not checked, it&#39;s not on the dictionary&#0160;(so no false items on the dictionary).</p>
<p></p>
<div>
<pre style="margin: 0; line-height: 125%;">[CommandMethod(&quot;labelStyleTest&quot;)]
<span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> CmdLabelStyleTest()
{
  CivilDocument civilDoc = CivilApplication.ActiveDocument;
  Database db = Application.DocumentManager.MdiActiveDocument.Database;
  <span style="color: #0000ff;">using</span> (Transaction trans = db.TransactionManager.StartTransaction())
  {
    ObjectId alignLblSetStyleId = civilDoc.Styles.LabelSetStyles.
      AlignmentLabelSetStyles[<span style="color: #a31515;">&quot;Major and Minor only&quot;</span>]; <span style="color: #008000;">// or other name here</span>
    AlignmentLabelSetStyle alignlblsetstyle = trans.GetObject(
      alignLblSetStyleId, OpenMode.ForRead) <span style="color: #0000ff;">as</span> AlignmentLabelSetStyle;

    <span style="color: #0000ff;">foreach</span> (AlignmentLabelSetItem lblSetItem <span style="color: #0000ff;">in</span> alignlblsetstyle)
    {
      <span style="color: #008000;">// let&#39;s only treat Profile Geometry Point</span>
      <span style="color: #0000ff;">if</span> (lblSetItem.LabelStyleType !=
        LabelStyleType.AlignmentProfileGeometryPoint)
        <span style="color: #0000ff;">continue</span>; 

      <span style="color: #008000;">// this dictionary list should contain all marked (true)</span>
      Dictionary&lt;Autodesk.Civil.ProfilePointType, <span style="color: #2b91af;">bool</span>&gt; list =
        lblSetItem.GetLabeledProfileGeometryPoints();
    }
  }
}
</pre>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: About StructureSectionLabel.Create partIndex param
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: about-structuresectionlabelcreate-partindex-param
CATEGORY: .NET
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2015/12/about-structuresectionlabelcreate-partindex-param.html 
DATE: 12/18/2015 03:14:21 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>
<p>The partIndex is used to distinguish sections in sectionview with the same Network Part. As the image below, the curve pipe will have two points in the sectionview. If we want to add label for the left point, the partindex should be 0, and the right one should be 1.</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d185e74b970c-pi" style="display: inline;"><img alt="Pic1" border="0" class="asset  asset-image at-xid-6a0167607c2431970b01b8d185e74b970c image-full img-responsive" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d185e74b970c-800wi" title="Pic1" /></a> <a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b7c7fc134c970b-pi" style="display: inline;"><img alt="Pic2" border="0" class="asset  asset-image at-xid-6a0167607c2431970b01b7c7fc134c970b image-full img-responsive" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01b7c7fc134c970b-800wi" title="Pic2" /></a><br /><br /></p>
<p>But a Structure can’t have multiple parts in the sectionview, <strong>so the partIndex should always be 0 for Structure</strong>.</p>
<p>Thanks to Summer Ding for this interesting information.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: InfraWorks 360 API @ Autodesk University Las Vegas
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: infraworks-360-api-autodesk-university-las-vegas
CATEGORY: Infraworks 360

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2015/11/infraworks-360-api-autodesk-university-las-vegas.html 
DATE: 11/19/2015 03:12:04 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>Are you going to AU Las Vegas? If so, my class on <strong>InfraWorks 360 API - Sharing Model and Proposal Data </strong>will be Thursday, Dec 3rd, 3pm. If you cannot attend, here is the handout, enjoy.</p>  <p><strong>1. Start developing apps based on InfraWorks 360 REST API</strong> </p>  <p>To start developing with the REST API, first there are some required background topics. This material will not cover them in deep, but there are lots of resources on the web.</p>  <p><strong>Background </strong></p>  <p>The InfraWorks 360 model data available to be accessed via API is seating on the Autodesk Cloud servers and the protocol to talk with that server is REST (Representational State Transfer). In summary it’s quite similar to connect via regular browser, but with parameters (like when we submit a form on a webpage) and a reply format in JSON (JavaScript Object Notation), basically plain text with a standard notation for objects, properties and collections. </p>  <p><strong>Required Software and Libraries</strong> </p>  <p>First it’s required to have models on your account, so you should install InfraWorks 360 and create a model that will be accessed via API. If the model is created locally, it must be synched to the Autodesk Cloud, only then it will be accessible via API. As expected, any local change will not be visible via API until the model is synched again.</p>  <p>The communication code can be written in any language that has support for&#160; REST protocols. In fact, as REST is language agnostic, any language should work, but not every language have the libraries to do so. Most modern languages are natively compatible or have libraries to do so. For instance, in .NET, the RestSharp (<a href="http://restsharp.org)">http://restsharp.org)</a> should have all the main features.</p>  <p>The response will come in plain text formatted as JSON. Although we can read it (human-readable), it’s easier to deserialize into objects on your preferred language. From JSON to .NET Objects, for instance, the Newtonsoft.JSON library (<a href="https://www.nuget.org/packages/Newtonsoft.Json">https://www.nuget.org/packages/Newtonsoft.Json</a> ) can do the trick. To clarify, deserialize is the process of converting an object stored into an object in memory. For this process, we need the classes representing the JSON structure. We provide that class structure in .NET (we’ll talk about sample later in this material), just like many other libraries for other APIs.</p>  <p>The samples presented here were developed using .NET with Visual Studio, which is the same developing language supported for AutoCAD Civil 3D (and for other Autodesk desktop prodcuts). This language was selected by convenience and any other language with support for REST should work.</p>  <p><strong>2. Discover the data structure of the API</strong> </p>  <p>The API structure is basically the same as the product: for each account, there are models that represent a specific area and contains one or more proposals, with different designs for that specific area, then the features, such as road, buildings, trees, etc.    <br />On the API perspective, the first level resides at <a href="https://api.infraworks.autodesk.com">https://api.infraworks.autodesk.com</a>, but it doesn’t contain relevant model information, just some basic server information.</p>  <p><strong>Models</strong> </p>  <p>The first URL level to provide information is <strong>https://api.infraworks.autodesk.com/models</strong> and contains a list of models for the logged user, as shown on the example below. Note the id and name of each model, and the model id will be used on the next calls. </p>  <p>Using the model id, the response from <strong>https://api.infraworks.autodesk.com/models/:model_id</strong> will contain the name, boundary, list of proposals, among other properties. Below is a sample reply: </p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b7c7ee9990970b-pi"><img title="model" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="model" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d1785fd7970c-pi" width="429" height="446" /></a> </p>  <p><strong>Proposals</strong> </p>  <p>To access a specific proposal, we will need the model_id along with the proposal_name, obtained on the model level. The URL is <strong>https://api.infraworks.autodesk.com/models/:model_id/propsals/:proposal_name</strong>.&#160; As we can see, each level uses a URL build on top of the previous level URL.     <br />Below is a sample response for a proposal call (end-point). Note the list of available features at the bottom, the href parameter contains the URL for each feature collection. </p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01bb0892bbdb970d-pi"><img title="proposal" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="proposal" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01bb0892bbdf970d-pi" width="434" height="396" /></a> </p>  <p><strong>Features</strong> </p>  <p>At this level we can access the items (features) placed on the model’s proposal. The URL consists in <strong>https://api.infraworks.autodesk.com/models/:model_id/proposals/:proposal_name/:feature_type/</strong> and contains the model_id, the proposal_name and, finally, the feature_type, which will return a list of features.     <br />The feature types can be:     <br />•&#160;&#160;&#160; Barrier     <br />•&#160;&#160;&#160; Buildings     <br />•&#160;&#160;&#160; City furniture     <br />•&#160;&#160;&#160; Constraint definition     <br />•&#160;&#160;&#160; Coverages     <br />•&#160;&#160;&#160; Horizontal and Vertical constraint     <br />•&#160;&#160;&#160; Intersection and Intersection region     <br />•&#160;&#160;&#160; Markup     <br />•&#160;&#160;&#160; Pipe connector and Pipeline     <br />•&#160;&#160;&#160; Point clouds     <br />•&#160;&#160;&#160; Points of Interest (POI)     <br />•&#160;&#160;&#160; Railway     <br />•&#160;&#160;&#160; Road     <br />•&#160;&#160;&#160; Terrain surface and texture     <br />•&#160;&#160;&#160; Trees     <br />•&#160;&#160;&#160; Water     <br /><a href="http://api-docs.infraworks.autodesk.com/ref_guide/rg_collections_and_representations.html">Full list here</a>. After the list, next step is read the feature data itself. Each different feature will have different information, but the calling URL should be in the same format, using the model_id, proposal_name, feature_type and the its id: <a href="http://api.infraworks.autodesk.com/models/:model_id/proposals/:proposal_name/:feature_type/:id">http://api.infraworks.autodesk.com/models/:model_id/proposals/:proposal_name/:feature_type/:id</a>. Here is a sample response for a tree feature type: </p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d1785fdf970c-pi"><img title="feature" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="feature" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01b7c7ee9996970b-pi" width="494" height="253" /></a> </p>  <p>Some feature properties are expected for all types of features, such as revision and id. </p>  <p><strong>Learn how to make calls to InfraWorks 360 REST API</strong> </p>  <p>InfraWorks 360 REST API uses the OAuth 2.0 authentication, that requires a key &amp; secret on the developer side, plus a user login &amp; password on the user side. The developer authentication is required to increase security and avoid attacks to Autodesk servers. The user authentication certifies confidentially of each user’s information.</p>  <p>The first step is authenticate using the developer key &amp; secret on <a href="https://accounts.autodesk.com">https://accounts.autodesk.com</a> server, which will return a authorization token, allowing access to the API. With this token, your application can ask the user to login on the same server and, if ok, will return a verifier, that allows access to the user’s data. This process is known as “2 legged authentication” and is required because a developer and the user are different personas, and both need to authorization, to use the API and read the data. </p>  <p>All requests to the InfraWorks 360 REST API must have a header indicating the type of response required. If not, the server will automatically redirect to the documentation (and will not return API data). The header should include (along with the authentication token) the following “Accept” requirement:</p>  <p><strong>application/vnd.autodesk.infraworks-v1+json</strong></p>  <p>With this header, we just need to connect to the server using the URLs described on the previous topic. Each request will require a different URL (end-point). For instance, to get a model with ID 1234, make a request with /models/1234. </p>  <p>In C# .NET, using RestSharp and Newtonsoft.JSON libraries, it would be like:</p>  <pre style="font-size: 13px; font-family: consolas; background: white; color: black"><span style="color: green">// Required since relase May/2015 – TLS 1.2</span><br />System.Net.<span style="color: #2b91af">ServicePointManager</span>.SecurityProtocol =<br />&#160; System.Net.<span style="color: #2b91af">SecurityProtocolType</span>.Tls12;<br /> <br /><span style="color: green">// base client URL</span><br />RestClient client = <span style="color: blue">new</span> RestClient(<span style="color: #a31515">&quot;https://api.infraworks.autodesk.com&quot;</span>);<br /> <br /><span style="color: green">// consumer key &amp; secret + authorization tokens</span><br />OAuth1Authenticator authenticator = OAuth1Authenticator.ForProtectedResource(<br />&#160; consumerKey, consumerSecret, accessToken, accessTokenSecret);<br />client.Authenticator = authenticator;<br /> <br /><span style="color: green">// resource we need to access</span><br />RestRequest request = <span style="color: blue">new</span> RestRequest(<span style="color: #a31515">&quot;/models/1234&quot;</span>, Method.GET);<br />request.RequestFormat = DataFormat.Json;<br />request.AddHeader(<span style="color: #a31515">&quot;Accept&quot;</span>, <span style="color: #a31515">&quot;application/vnd.autodesk.infraworks-v1+json&quot;</span>);<br /> <br /><span style="color: green">// make the call</span><br />IRestResponse response = client.Execute(request);<br /> <br /><span style="color: green">// treat the results</span><br /><span style="color: blue">if</span> (response.StatusCode == System.Net.<span style="color: #2b91af">HttpStatusCode</span>.OK)<br />{<br />&#160; <span style="color: blue">string</span> json = response.Content;<br />&#160; <span style="color: green">// deserialize the JSON return into objects in .NET</span><br />&#160; <span style="color: blue">return</span> JsonConvert.DeserializeObject(json, <span style="color: blue">typeof</span>(Model));<br />}<br /><span style="color: blue">else</span><br />{<br />&#160; <span style="color: green">// many problems can happen...treat error here</span><br />&#160; <span style="color: blue">return</span>&#160;<span style="color: blue">null</span>;<br />}</pre>

<p>Note this is just a schematic, on a real application, this should be optimized (reuse variables) and adjusted according to each scenario. See next section for more sample code.</p>

<p><strong>Discover sample scenarios of integration</strong> </p>

<p>There is a huge number of webservices available on the web, providing all types of data. Most likely, your application will collect data from different sources and mashup different providers and create a unique interface. 
  <br />How we can we mashup webservices?

  <br />First we need to find out what makes sense. As InfraWorks 360 store geolocated city design information, it’s make sense to link to other geolocated data. There is an extensive catalog of webservice APIs at the <a href="http://www.programmableweb.com">Programmable Web</a>, check the Mapping and Geography categories for interesting providers. </p>

<p><strong>InfraWorks 360 + Four Square + Google Maps</strong> </p>

<p>This sample was originally presented at this blog post and now updated. It reads the buildings of the InfraWorks 360 model and, using the location information, asks the Four Square API for nearby venues. The result is shown at a Google Maps with the InfraWorks 360 location of the building and the Four Square location of the venue found and selected.</p>

<p>Just like Autodesk Cloud APIs, to use Four Square API you will need a key &amp; secret. To get more information about their API program, please <a href="https://developer.foursquare.com">visit here</a>. Below is a quick print-screen of the sample running. To use it with your personal account, please <a href="http://infraworks360samples.azurewebsites.net/IW360Demo.aspx">visit here</a>. and login with your Autodesk Account (the same used on InfraWorks 360). Note that you must have at least 1 model on that account. The source code is available at the sample sample page. </p>

<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d1785fe5970c-pi"><img title="sample1" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="sample1" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d1785fe9970c-pi" width="467" height="120" /></a> </p>

<p>About the technology: the sample was developed with ASP.NET (server side) and uses JavaScript (client side) to automate the interface with the <a href="https://jquery.com">JQuery library</a></p>

<p><strong>InfraWorks 360 + Google Maps</strong> </p>

<p>This sample aims to show 3D buildings from InfraWorks 360 on web map. As you may know and use, there is a 3D version of the Google Maps where we can see the city (mostly buildings) in 3D. It’s a cool interface. Despite there some APIs around the maps, there is no JavaScript API to interact with the 3D version.
  <br />After some searching, I found the John Dyer blog with a nice sample: Drawing 3D Objects and Buildings on Google Maps. After reading and understanding the code, you will see that it is actually a 2 + ½ D, not actually a 3D: the buildings are drawn in perspective to look like 3D. </p>

<p>Using InfraWorks 360 building polygon information and John Dyer’s code to draw the buildings, the result will be like shown below: </p>

<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d1785fed970c-pi"><img title="sample2" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="sample2" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01bb0892bbe5970d-pi" width="470" height="206" /></a> </p>

<p>And you can try with your models (using your Autodesk Account with InfraWorks 360 models) at <a href="http://infraworks360samples.azurewebsites.net/BuildingOnGMaps.aspx">this link</a>.</p>

<p><strong>InfraWorks 360 + AutoCAD Civil 3D</strong> </p>

<p>Sure we can also integrate with AutoCAD Civil 3D. As you may know some integration is already available via Productivity Pack, but this is just to demonstrate the idea. </p>

<p>This sample demonstrating how bring InfraWorks 360 Roads into AutoCAD Civil 3D as Alignments is available at the <a href="http://adndevblog.typepad.com/infrastructure/2014/10/importing-alignment-from-infraworks-360-to-civil-3d.html">Importing Alignment from InfraWorks 360 to AutoCAD Civil 3D</a> blog post and was also the sample presented at my Autodesk University 2014 class <a href="http://au.autodesk.com/au-online/classes-on-demand/class-catalog/2014/infraworks/sd6503">SD6503</a>.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Med
EMAIL: amehdi@gmail.com
IP: 213.233.187.144
URL: 
DATE: 11/28/2015 02:59:02 AM
Hi,

I am developing a Civil3D .net app using C# and need to call "Edit Style" dialog for a given style from the app.  For instance, let's say the app needs to let the user edit a given alignment style using native Civil3D dialog. The dialog is accessible through the TOOLSPACE, then SETTINGS tab, but I don't know where in the API.

One way to handle this is to create a temporary alignment with the given style, and then use Lisp to run EDITALIGNMENTSTYLE (entlast) command, but that seems rather unnatural and certainly not elegant. In addition, I have to make this work for any Civil3D style that is accessible through the API. Is there a way of calling these dialogs using the API properly? Any help would be appreciated.

Thanks!
-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 177.43.194.106
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 12/08/2015 02:12:26 AM
Hi Med,

Thanks for contacting. For API questions, please consider use the forum at http://forums.autodesk.com/t5/autocad-civil-3d-customization/bd-p/190

That said, indeed we cannot access Civil 3D dialogs from the API... just some "not elegant" workarounds, like you mentioned.

Regards,
Augusto Goncalves
-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Coding week! DevDays, DevHack and Accelerator
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: coding-week-devdays-devhack-and-accelerator

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2015/10/coding-week-devdays-devhack-and-accelerator.html 
DATE: 10/14/2015 06:10:22 AM
-----
BODY:
<p>Join us for DevWeeks around the globe. This year we’ll have our well known DevDay with what’s new and coming, the DevHack day to bring your questions and work with us, and the Accelerator program to help you get started with projects. </p>  <p>Register at <a title="http://autode.sk/1RF3lhB" href="http://autode.sk/1RF3lhB">http://autode.sk/1RF3lhB</a>&#160;</p>  <p>(non-ADN members can join too, just send email to <a href="mailto:devdaysinfo@autodesk.com">devdaysinfo@autodesk.com</a>) </p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b7c7dd7784970b-pi"><img title="devdays" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="devdays" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01b7c7dd778d970b-pi" width="483" height="359" /></a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: List layers from GetDiplayStyle method of the API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: list-layers-from-getdiplaystyle-method-of-the-api
CATEGORY: .NET
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2015/09/list-layers-from-getdiplaystyle-method-of-the-api.html 
DATE: 09/11/2015 12:58:47 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a> (<a href="https://twitter.com/augustomaia">@augustomaia</a>)</p>  <p>One of my favorites features of .NET is the ability to use Reflection. This is particularly powerful when we need to find something on the API that we’re not completely sure.</p>  <p>In this case we want to get all layers used on GetDisplay methods for some objects, let’s say AlignmentStyle. This specific case has GetDisplayStyleModel, GetDisplayStylePlan and GetDisplayStyleSection, but all options start with GetDisplay. Interesting!</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d15649f6970c-pi"><img title="Style Display on Civil 3D" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; display: inline; border-top-width: 0px" border="0" alt="Style Display on Civil 3D" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01bb0870b54a970d-pi" width="473" height="338" /></a> </p>  <p>So using Reflection let enumerate all methods that start with this prefix, then invoke them for all possible parameters. We assume the parameters are values from a enumeration, which can be found by Reflection.</p>  <p><strong>Updates (January, 2016): </strong><a href="http://forums.autodesk.com/t5/autocad-civil-3d-customization/displaystyle-layers/m-p/5965872">Jeff improved the code</a> to support some other types. See new version below.</p>  <pre style="font-size: 13px; font-family: consolas; background: white; color: black"><span style="color: blue">public</span>&#160;<span style="color: blue">static</span>&#160;<span style="color: #2b91af">List</span>&lt;<span style="color: blue">string</span>&gt; GetDisplayStylesLayer(StyleBase style)<br />{<br />&#160; <span style="color: #2b91af">List</span>&lt;<span style="color: blue">string</span>&gt; layers = <span style="color: blue">new</span>&#160;<span style="color: #2b91af">List</span>&lt;<span style="color: blue">string</span>&gt;();<br />&#160; <span style="color: green">// get all methods that contains &quot;DisplayStyle&quot; on their names</span><br />&#160; <span style="color: blue">var</span> methods = style.GetType().GetMethods()<br />&#160;&#160;&#160; .Where(m =&gt; (m.Name.Contains(<span style="color: #a31515">&quot;DisplayStyle&quot;</span>)<br />    &amp;&amp; !m.Name.Contains(<span style="color: #a31515">&quot;_&quot;</span>)));<br />&#160; <span style="color: green">// run through the collection of methods</span><br />&#160; <span style="color: blue">foreach</span> (MethodInfo method <span style="color: blue">in</span> methods)<br />&#160; {<br />&#160;&#160;&#160; <span style="color: blue">var</span> methodparams = method.GetParameters();<br />&#160;&#160;&#160; <span style="color: blue">if</span> (methodparams.Length &gt; 1)<br />&#160;&#160;&#160;&#160;&#160; <span style="color: blue">continue</span>; <span style="color: green">// if more than 1, then we don't know</span><br />&#160;&#160;&#160; <span style="color: blue">if</span> (methodparams.Length == 0)<br />&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160; DisplayStyle dispStyle = method.Invoke(style, <br />            <span style="color: blue">new</span>&#160;<span style="color: blue">object</span>[] { }) <span style="color: blue">as</span> DisplayStyle;<br />&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> (dispStyle == <span style="color: blue">null</span>)<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">continue</span>;<br />&#160;&#160;&#160;&#160;&#160; layers.Add(dispStyle.Layer);<br />&#160;&#160;&#160;&#160;&#160; <span style="color: blue">continue</span>;<br />&#160;&#160;&#160; }<br />&#160;&#160;&#160; ParameterInfo param = methodparams[0];<br />&#160;&#160;&#160; <span style="color: blue">if</span> (!param.ParameterType.IsEnum)<br />&#160;&#160;&#160;&#160;&#160; <span style="color: blue">continue</span>; <span style="color: green">// not a enum, skip</span><br />&#160;&#160;&#160; <span style="color: green">// check all values on the enum</span><br />&#160;&#160;&#160; <span style="color: blue">foreach</span> (<span style="color: blue">var</span> enumValue <span style="color: blue">in</span>&#160;<span style="color: #2b91af">Enum</span>.GetValues(<br />&#160;&#160;&#160;&#160;&#160; param.ParameterType))<br />&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160; <span style="color: blue">try</span><br />&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; DisplayStyle dispStyle = method.Invoke(style,<br />           <span style="color: blue">new</span>&#160;<span style="color: blue">object</span>[] { enumValue }) <span style="color: blue">as</span> DisplayStyle;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> (dispStyle == <span style="color: blue">null</span> || enumValue.<br />          ToString().Contains(<span style="color: #a31515">&quot;Curvature&quot;</span>))<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">continue</span>;<span style="color: green">// something went wrong</span><br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; layers.Add(dispStyle.Layer);<br />&#160;&#160;&#160;&#160;&#160; }<br />&#160;&#160;&#160;&#160;&#160; <span style="color: blue">catch</span> { }</pre>

<pre style="font-size: 13px; font-family: consolas; background: white; color: black">&#160;&#160;&#160; }<br />&#160; }<br />&#160; <span style="color: blue">return</span> layers;<br />}</pre>

<p>To use it, simply call the Extension method, below is a quick example:</p>

<pre style="font-size: 13px; font-family: consolas; background: white; color: black">[<span style="color: #2b91af">CommandMethod</span>(<span style="color: #a31515">&quot;getLayersFromDisplayStyle&quot;</span>)]<br /><span style="color: blue">public</span>&#160;<span style="color: blue">static</span>&#160;<span style="color: blue">void</span> CmdGetLayers()<br />{<br />&#160; <span style="color: #2b91af">CivilDocument</span> civilDoc = <span style="color: #2b91af">CivilApplication</span>.ActiveDocument;<br />&#160; <span style="color: blue">using</span> (<span style="color: #2b91af">Transaction</span> trans = <span style="color: #2b91af">Application</span>.DocumentManager<br />&#160;&#160;&#160; .MdiActiveDocument.Database.TransactionManager<br />    .StartTransaction())<br />&#160; {<br />&#160;&#160;&#160; <span style="color: #2b91af">StyleBase</span> st = trans.GetObject(<br />&#160;&#160;&#160;&#160;&#160; civilDoc.Styles.AlignmentStyles[0], <br />&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">OpenMode</span>.ForRead) <span style="color: blue">as</span>&#160;<span style="color: #2b91af">StyleBase</span>;<br />&#160;&#160;&#160; <span style="color: #2b91af">List</span>&lt;<span style="color: blue">string</span>&gt; res = st.GetDisplayStyleLayer();<br />&#160;&#160;&#160; <span style="color: blue">foreach</span> (<span style="color: blue">string</span> s <span style="color: blue">in</span> res)<br />&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">Application</span>.DocumentManager.MdiActiveDocument<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; .Editor.WriteMessage(<span style="color: #a31515">&quot;\n{0}&quot;</span>, s);<br />&#160; }<br />}</pre>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Brian Chapman
EMAIL: bcinnv@gmail.com
IP: 24.120.210.18
URL: http://www.pro-cad.net
DATE: 09/11/2015 03:14:46 PM
Thanks!
-----
COMMENT:
AUTHOR: Mfernandes
EMAIL: mfernandes@rand.com
IP: 24.108.117.131
URL: 
DATE: 12/02/2015 02:13:11 PM
on the lines
public static List GetDisplayStyleLayer(
and
style, new object[] { enumValue }) as DisplayStyle;

for both "List" and "object[]" I get the following error
"Expected class, delegate, enum, interface or struct"

any suggestion on how to fix.
thanks

-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 177.43.194.106
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 12/08/2015 02:03:09 AM
The code of this post is working fine on my end... not sure why you're receiving this error. Maybe you missed something during copy & paste?

Regards,
Augusto Goncalves
-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Is my drawing a AUD drawing?
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: is-my-drawing-a-aud-drawing
CATEGORY: .NET
CATEGORY: Augusto Goncalves

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2015/09/is-my-drawing-a-aud-drawing.html 
DATE: 09/08/2015 06:25:54 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a> (<a href="https://twitter.com/augustomaia">@augustomaia</a>)</p>  <p>It’s possible to check if a drawing was created using Civil 3D by checking its Named Objects Dictionary for a ‘root’ key, as demonstrated by <a href="http://civilizeddevelopment.typepad.com/civilized-development/2011/07/is-my-drawing-a-civil-3d-drawing.html">Isaac at this blog post</a>. Now we want the same for Autodesk Utility Design, is it possible?</p>  <p>Indeed the same approach should work, just need to check for a different key, in this case UUDMDICTIONARY. There is also one additional step, check for “Configuration:RUS” custom property on the drawing. </p>  <p>The following code sample demonstrate this approach. It can be used as an extension method for Database.</p>  <pre style="font-size: 13px; font-family: consolas; background: white; color: black"><span style="color: blue">public</span>&#160;<span style="color: blue">static</span>&#160;<span style="color: blue">bool</span> IsAUDDatabase(<span style="color: blue">this</span>&#160;<span style="color: #2b91af">Database</span> db)<br />{<br />&#160; <span style="color: blue">using</span> (<span style="color: #2b91af">Transaction</span> trans = db.TransactionManager.StartOpenCloseTransaction())<br />&#160; {<br />&#160;&#160;&#160; <span style="color: green">// must have this NOD key</span><br />&#160;&#160;&#160; <span style="color: #2b91af">DBDictionary</span> namedObjectDict = trans.GetObject(db.NamedObjectsDictionaryId,<br />&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">OpenMode</span>.ForRead) <span style="color: blue">as</span>&#160;<span style="color: #2b91af">DBDictionary</span>;<br />&#160;&#160;&#160; <span style="color: blue">if</span> (!namedObjectDict.Contains(<span style="color: #a31515">&quot;UUDMDICTIONARY&quot;</span>)) <span style="color: blue">return</span>&#160;<span style="color: blue">false</span>;<br /> <br />&#160;&#160;&#160; <span style="color: green">// must also have a &quot;Configuration:RUS&quot; custom property</span><br />&#160;&#160;&#160; <span style="color: #2b91af">IDictionaryEnumerator</span> summary = db.SummaryInfo.CustomProperties;<br />&#160;&#160;&#160; <span style="color: blue">while</span> (summary.MoveNext()) <br />&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> (summary.Key.ToString().Equals(<span style="color: #a31515">&quot;CONFIGURATION&quot;</span>, <span style="color: #2b91af">StringComparison</span>.OrdinalIgnoreCase) &amp;&amp;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; summary.Value.ToString().Equals(<span style="color: #a31515">&quot;RUS&quot;</span>, <span style="color: #2b91af">StringComparison</span>.OrdinalIgnoreCase))<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">return</span>&#160;<span style="color: blue">true</span>; <span style="color: green">// found it!</span><br />&#160;&#160;&#160; } <br /> <br />&#160;&#160;&#160; <span style="color: blue">return</span>&#160;<span style="color: blue">false</span>;<br />&#160; }<br />}</pre>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Civil 3D 2016 SP 1 &ndash; New Feature Line API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: civil-3d-2016-sp-1-new-feature-line-api
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2015/08/civil-3d-2016-sp-1-new-feature-line-api.html 
DATE: 08/28/2015 09:30:51 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a> (<a href="https://twitter.com/augustomaia">@augustomaia</a>)</p>  <p>Quick news: <a href="http://knowledge.autodesk.com/support/autocad-civil-3d/downloads/caas/downloads/content/autodesk-C2-AE-autocad-C2-AE-civil-3d-C2-AE-2016-service-pack-1.html?v=2016">Civil 3D 2016 SP1</a> included a new API for Feature Lines. The updated documentation is live at the <a href="http://docs.autodesk.com/CIV3D/2016/ENU/API_Reference_Guide/index.html">Civil 3D Reference Guide</a> (<a href="http://docs.autodesk.com/CIV3D/2016/ENU/API_Reference_Guide/html/856470c7-bf8f-2fa4-db5f-d290252f36c0.htm">direct link</a>).</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b7c7c5a748970b-pi"><img title="Updated Reference Guide" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="Updated Reference Guide" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01b7c7c5a750970b-pi" width="485" height="247" /></a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: joantopo
EMAIL: joantopo@hotmail.com
IP: 79.158.108.243
URL: 
DATE: 11/03/2016 11:29:22 AM
I am wondering why there is not SetPIPoint() method...
-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Object Data in AutoCAD Map 3D as the Simplest Alternative for Digital Mapping
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: object-data-in-autocad-map-3d-as-the-simplest-alternative-for-digital-mapping
CATEGORY: AutoCAD Map 3D 2014

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2015/08/object-data-in-autocad-map-3d-as-the-simplest-alternative-for-digital-mapping.html 
DATE: 08/19/2015 09:36:41 AM
-----
BODY:
<p>By <a href="mailto:a.v.sharov62@gmail.com">Alexander Sharov</a> (Contributor)</p>  <p>This is a non-API article from Alexander, a longtime Autodesk partner.</p>  <p>Object Data in AutoCAD Map 3D is a near-optimal way to describe graphic elements’ additional data in DWG files, which can turn AutoCAD Map 3D into one of the most effective digital mapping software given that the sufficient instrumentation is available. </p>  <p><strong>1. AutoCAD Map 3D overview</strong> </p>  <p>AutoCAD Map 3D is a mapping vertical product for AutoCAD, i.e. for the program designed mainly for drawing. Therefore, the first and the most expected and the most justified function of such product is drawing (creation) of digital plans and maps, GIS data preparation, collection and display of initial terrain data as well as initial spatial data in DWG files.</p>  <p>Digital mapping and GIS data preparation consist primarily of maps and plans drawing based on the initial terrain data: aerial interpretation of orthophotos, stereopairs, laser scanning and other remote-sensed data; ground survey data drawing; digitization of raster maps and plans. To create proper digital maps, drawn vector data should be defined with the information on entities and the attributes of terrain objects it represents to allow computer data analysis. Furthermore, for computer spatial analysis it is necessary to ensure digital maps’ graphical data topological correctness.</p>  <p>Thus, the most suitable digital mapping and GIS data creation software should have the most extensive drawing functionality (and CAD answers this purpose above all) and the possibility of graphical elements additional data assigning. In most cases, structure and volume of a digital map object additional data are simple and small. For technological reasons related to high operation speed requirements as well as organizational, technical and other restrictions, a mapping area is usually divided into numerous fragments (sheets), and maps and GIS data are created separately (sheet by sheet) by several users at the same time. There is almost no need for entire cartographical area common database at the map creation and GIS data preparation stage while its creation at the data collection stage is almost impossible since the work is being done by numerous regular and outsourced employees and organizations. In addition it is highly desirable to carry out drawing and additional data definition with a single easy-to-use software product with minimum of add-ons, settings, etc. In other words, it is reasonable to use internal databases for additional data definition. AutoCAD Map 3D generally has all the necessary capacities to create digital maps and GIS data as well as to perform cartographical and GIS tasks directly in DWG files.</p>  <p>However, in practice, AutoCAD Map 3D is not a widely used, recognized software product for digital mapping while its popularity and usability in terms of these tasks considerably falls behind the other corresponding software products.</p>  <p>The weak point of Map 3D is concerned with its insufficient, inconvenient digital mapping tools for description of graphic elements’ additional (semantic, attributive, user) data. In other words, the weakest side of Map 3D is insufficient ensuring of the key quality that distinguishes digital maps and GIS data from maps drawn for direct human perception.</p>  <p>At the same time, AutoCAD Map 3D offers three ways to describe additional data when working with DWG files: with the use of external databases and two internal ways – Feature classes and Object Data.</p>  <p>The use of external databases will not be examined here as this way to create maps and initial GIS data is not quite feasible and productive. This way requires additional software expenses, work complication, higher user skills and increased computer resources. Thus, it becomes almost impossible to involve many experienced mapmakers, freelancers and small enterprises in the work.</p>  <p>Moreover, the use of external databases is always associated with a principal problem of graphical data and descriptive database inconformity. There are also risks of losing additional data files with due to technical reasons, during data transfer, etc.   <br />This problem is resolved by the use of internal databases in DWG files. AutoCAD Map 3D offers two ways to describe the additional data with the help of internal databases: Feature classes and Object Data.</p>  <p>In principle, Feature classes (Object classes, FC) can be considered as a possible solution for graphical elements’ additional data description. The main advantage of FC is a convenient object menu for drawing with FC attaching to drawn elements. FC allow identifying graphical elements by their Class name and describing object properties with the help of user data fields – Custom properties. The most important positive sides of FC include a sufficient set of commands for object creation and data manipulation with FC attaching, selection by FC. All the additional data on graphical elements in the form of FC is saved directly in DWG files.</p>  <p>However, Feature classes have a number of restrictions and disadvantages, the principle one is no possibility to attach more than one FC to a graphical element. That is, when using FC, it is impossible to define file elements the way it is necessary to maintain topologically correct chain-node data structure when describing primarily areal objects. Due to the same reason, the creation of topological models (“topology”) and both areal and linear objects with FC requires excessive efforts and is not productive. But there is a disadvantage related to the additional data description – when redefining FC object it is impossible to detach or edit the data correctly.</p>  <p>These and other reasons prevent Feature classes to become popular among AutoCAD Map 3D users. FC are virtually not used for mapping.</p>  <p>Besides, AutoCAD Map 3D gives an opportunity to connect Feature classes and Object Data – to assign specific Feature classes to certain Object Data, what helps to define an object right after its creation (with corresponding FC) and to describe its characteristics and attributes (in of corresponding Object Data fields). In some cases, this can be rather convenient, but there are also some drawbacks. The joint usage of Feature classes and Object Data leads to the summation of its disadvantages and restrictions while new disadvantages appear due to Feature classes and Object Data overlapping. The principal disadvantage of this scheme is the same as of Feature classes – it is impossible to define one element simultaneously as a part of several objects, i.e. topologically correct chain-node data structure maintenance remains complicated.</p>  <p>Object Data (OD) – another way to describe AutoCAD Map 3D graphical elements additional data, which was developed long before Feature classes. The situation with Object Data in AutoCAD Map 3D is very contradictory. However, it is technically easy to overcome Object Data drawbacks, whereas their advantages give reasons to believe that Object Data are undeservingly underestimated being the simplest already existing and the most technologically feasible way to describe AutoCAD Map 3D graphical elements additional data. In the short term, the advantages of Object Data may let it not only compete with Feature classes in AutoCAD Map 3D, but also set them and AutoCAD Map 3D apart from other mapping software.   <br />Therefore, we will further examine AutoCAD Map 3D Object Data. </p>  <p><strong>2. AutoCAD Map 3D Object Data overview</strong> </p>  <p>Object Data (OD) – data blocks designed for AutoCAD Map 3D graphical elements’ additional data storage. These blocks are defined with unique names and fields sets. It is a special command with an intuitive and simple interface in AutoCAD Map 3D that allows users of any qualification and with any access rights to create and edit OD descriptions directly in AutoCAD Map 3D.</p>  <p>Object Data allows identifying graphic elements as cartographic objects by attaching corresponding OD and describing object characteristics in the data fields.</p>  <p>Users can attach any given OD to graphical elements of any type. Moreover, any number of identical or different OD can be attached to one element. Users can enter necessary object characteristics values in the OD fields. OD descriptions and records are saved directly in DWG files.</p>  <p>Thus OD is simple, intuitive and, consequently, potentially feasible and reliable way to describe additional data of graphical elements in DWG files.   <br />Nevertheless OD in AutoCAD Map 3D is not equipped with an adequate set of tools for its full and productive usage.</p>  <p>Being used in many AutoCAD Map 3D key functions, for many of them OD is not a data selection criteria. Moreover, OD is not included into the most important AutoCAD Map 3D functions – Drawing Cleanup for topological check-ups and data correction as well as “topologies” creation to form areal, linear and point objects from graphical elements.</p>  <p>It can be claimed that OD in AutoCAD Map 3D (in the Autodesk) is not regarded as an adequate and robust way of graphical elements’ additional data defining. Until now there have been only occasional attempts to create AutoCAD Map 3D plugins expanding the capabilities of Object Data. In general, AutoCAD Map 3D users do not regard Object Data as a productive way to define graphical elements’ additional data.</p>  <p>Such situation causes AutoCAD Map 3D users who did not master the use of Feature classes or external databases to decline orders where the attachment of additional information to graphical elements is required. Often while working on such orders the choice is made not in favor of Autodesk but in favor of other developers’ mapping software where additional, semantic information is defined in a more technically convenient way.</p>  <p>Despite the above, OD in AutoCAD Map 3D potentially has such an advantageous set of capabilities that its definitely underestimated position can be stated. OD can help to implement the complete technology for digital planning and mapping as well as for GIS data preparation. This technology is more effective in all senses than Feature classes and external databases usage in AutoCAD Map 3D and more productive than in most other popular cartographic and GIS environments. </p>  <p><strong>3. Object Data commands available</strong> </p>  <p>Currently there are only five special commands in AutoCAD Map 3D to work with Object Data:</p>  <ol>   <li>_ADEDEFDATA to create and edit Object Data descriptions.     <br />This command is used to create Object Data descriptions composed of OD name that is unique within the DWG file (up to 25 characters) and value fields of type integer, char, point or real. The fields are defined with unique within one OD (up to 31 characters) names, descriptions (up to 40 characters) and default values (up to 132 actual characters though character fields are defined as 254 characters after export).      <br />Cyrillic characters can be used in OD names and OD fields.      <br />There is no limit of Object Data descriptions in DWG file. The number of fields in one OD is also unlimited. Real files observed to contain more than a hundred OD descriptions and more than thirty fields in one OD.      <br />This command also allows Object Data descriptions editing – rename OD, remove descriptions, remove fields, change field descriptions and default values, add new fields.</li>    <li>_ADEATTACHDATA to attach/detach Object Data to/from graphic elements.&#160; <br />This command is used to attach Object Data to selected graphic elements, remove attached Object Data and define field values.      <br />Several OD including identical can be attached to one graphic element.      <br />The option of the identical OD overwriting is available, i.e. one can choose whether to remove the previous OD record or to create a duplicate.      <br />The allowed number of OD per graphical element is not determined.</li>    <li>_ADEEDITDATA to edit and add/remove similar Object Data.     <br />This command makes it possible to browse the Object Data attached to the specified graphic element, examine and edit the field values. It is also possible to add similar OD attached to this graphic element, remove OD, browse all duplicate OD and edit field values.</li>    <li>_MAPDIGISETUP to setup drawing with simultaneous Object Data attachment.     <br />This command is used to determine a graphical element entity class (block, polyline, 3D polyline) to draw, the layer for this element, name and insert options for blocks, width and line type for polylines, the Object Data immediately attached to the element.      <br />This command only partially refers to Object Data commands because Object Data attachment to the drawn elements is optional.      <br />This command makes it possible to describe only one parameter set for drawing of single type of graphic element with simultaneous attachment of corresponding Object Data at a time. In other words, when describing a new drawing parameter set with OD the previous set is deleted. Consequently, it is impossible to create objects menu for drawing with OD using this command.</li>    <li>_MAPDIGITIZE to draw with simultaneous Object Data attachment.     <br />This command is used to draw graphic elements defined with _MAPDIGISETUP and define Object Data field values when creating these elements.      <br />Object Data attached to the elements and its fields values are shown by Map 3D in AutoCAD Properties palette (_PROPERTIES) after the graphic elements are selected. This palette allows editing these fields values – similarly to other properties shown in the Properties palette.      <br />This helps to see presence/absence of OD attached to the graphic elements as well as to browse, input and edit OD field values. However, these capabilities are available only for preliminarily selected file elements. Besides, when selecting two or more elements with different OD, the information about OD is not displayed in the Properties palette. Also, OD is not used in Quick Select (_.QSELECT). </li> </ol>  <p><strong>4. Commands using Object Data</strong> </p>  <p>AutoCAD Map 3D currently has a set of commands that use or take into account Object Data: data export/import commands, data queries and associated commands, commands for work with external databases. However, it is impossible to select graphic elements to work with by its OD – the selection is made by layers, Feature classes and topological models but not by OD.</p>  <p>In addition to these commands where Object Data is used by users, it is also used by AutoCAD Map 3D as a service tool to store information about topological models and connections with external databases. Information about the belonging of the graphic element to the specified topological model or about connection of the graphic element with the external database is stored in file attached to graphic elements in the form of service OD of special structure with special names. One can see these special service ODs with the command for creation and editing of Object Data descriptions — _ADEDEFDATA. Besides, it is possible to see these ODs and its content in the Properties palette when corresponding graphic elements are selected. </p>  <p><strong>5. Object Data implementation drawbacks</strong> </p>  <p>The main disadvantage of Object Data implementation in AutoCAD Map 3D preventing its usage for digital mapping and initial spatial data creation is that there is no object menu for drawing based on OD. In other words there is no object menu tool for OD as it was implemented for Feature classes where users can choose the object needed for drawing among the classified objects list while the necessary set of graphic properties is immediately determined and corresponding OD is attached. The command available for drawing setup _MAPDIGISETUP does not allow saving of drawing parameters set description with OD for more than one type of objects.&#160; <br />Another principal drawback of Object Data implementation is absence of specialized tools for search by Object Data, their field values, graphical elements to which Object Data is attached (if any), etc. That is to say there is no simple way (with direct commands) to control the results of OD attachment, to find the errors of incomplete OD attachment and the errors of OD reattachment, to ensure OD fields are filled correctly. Besides, there are no simple (direct commands) tools to search graphic elements with several OD attached including duplicate and various OD as well as tools for duplicate OD detachment.</p>  <p>Many of the above OD operations can be performed with the use of AutoCAD Map 3D queries (_ADEQUERY), etc. However, these tools are too time-consuming or insufficient for mapping.</p>  <p>In addition, the principle disadvantage is the absence of a direct option for browsing the entire content of the specified OD in a table view.</p>  <p>Another considerable drawback of Object Data implementation is that there are no fast ways (direct commands) to fill in OD fields automatically such typical for work with attached data as the creation of unique identifiers, saving of coordinates, lengths, areas of graphic elements in OD fields, etc. In other words, there is no technological possibility to to define additional data attached to graphic elements.   <br />There is a number of OD drawbacks in the process of its description (_ADEDEFDATA):</p>  <ul>   <li>Excessive obligatory clicks are needed for all actions in OD descriptions creation window, causing loss of the input data.</li>    <li>OD are likely oversized because it is impossible to limit the description length of character fields and any OD character field is defined 254 characters long.</li>    <li>Default values for OD character fields cannot include more than 131 characters, so errors may occur because of too long field values.</li>    <li>Descriptions” column role is unclear – these values are not used in any OD command, are not displayed in the Properties palette, etc. Thus, these field descriptions add size to OD and are almost useless for the user.</li>    <li>It is impossible to describe the limitations of OD field values what makes the field values validity check impossible to automate.</li>    <li>OD field names cannot be changed when OD names can be changed.</li>    <li>AutoCAD Map 3D does not perceive OD descriptions addition or edit as file changes demanding direct save command, i.e. when DWG file is closed OD description changes might be lost if no other changes were made.</li> </ul>  <p>There are also some unpleasant aspects of OD descriptions affecting data exchange between DWG files: if files have OD with same names and identical set of fields, the attached OD may be lost during copy from file to file because of the difference in fields order. Disturbing warnings are also shown during copy if same OD fields describe different default values.</p>  <p>Furthermore, Object Data is not taken into account during two key operations in digital mapping – while topological data correction (_MAPCLEAN, Drawing cleanup) and topological model creation (_MAPTOPOCREATE). Preselected by OD elements could be used for these actions, but there are no tools for element selection by OD in AutoCAD Map 3D. This situation is a direct evidence of the fact that Object Data is not virtually regarded in AutoCAD Map 3D as a comprehensive way to describe additional data attached to graphic elements during digital mapping and GIS data creation.</p>  <p>It is also inconvenient that pre-selection is not used by the commands for OD attachment/detachment (_ADEATTACHDATA) and OD editing (_ADEEDITDATA).   <br />Besides, breaking an element with OD attached causes loss of OD for one of the resulting pieces.</p>  <p>Summing, AutoCAD Map 3D Object Data can be described according to its current state as a secondary, auxiliary tool for graphical elements’ additional data description, which is implemented incompletely and with disadvantages. In principle, it is possible to use OD for digital mapping and GIS data creation at the moment but taking into account its productivity and the above said facts. </p>  <p><strong>6. Object Data advantages</strong></p>  <p>Despite numerous disadvantages and restrictions, AutoCAD Map 3D Object Data has a number of advantages and capabilities which allow us to regard OD as a fundamentally productive possibility to describe graphical elements’ additional data for digital mapping and GIS data creation.</p>  <p>Object Data is an example of internal database – graphical elements’ additional data is stored directly in DWG file. First, such way of additional data storage minimizes the risk of inconformity (loss of connection, additional data loss, “orphan” records in the database) between graphic and descriptive data. Secondly, it minimizes the additional database management. Thirdly, it requires no additional software and at last this way facilitates complete data transfer as much as possible.</p>  <p>Object Data has no defects in the structure and description rules, which would impede its use for additional data description.</p>  <p>Object Data is extremely easy to manage – user of any level can create and edit OD descriptions.</p>  <p>Object Data makes it possible to save the proper range and volume of additional data for digital maps and initial GIS data.</p>  <p>Object Data is easy to use – users can attach/detach OD directly to/from graphic elements.</p>  <p>The practice of Object Data usage shows that OD is quite reliable, does not cause file and or AutoCAD errors, including basic AutoCAD.</p>  <p>Creation of OD addition commands does not require complex programming while these commands help to overcome easily all the disadvantages of OD implementation in AutoCAD Map 3D. This is proved by both the experience of additional OD commands creation and the presence of the commands similar to those necessary for OD in AutoCAD Map 3D.</p>  <p>It is of crucial importance that several different OD can be attached to one graphic element what allows to realize topologically correct chain-node data structure in AutoCAD Map 3D when describing areal objects without duplicating their contours.</p>  <p>Object Data as a way of additional information storage have no analogues of the same compactness and simplicity among the specialized cartographic or GIS software products. </p>  <p><strong>7. Modifications and additions required for Object Data productive usage</strong> </p>  <p>AutoCAD Map 3D adaptation in order to use all of the Object Data advantages requires neither considerable modifications of OD descriptions, nor available commands changes and serious efforts to add missing commands. Generally, it is possible to avoid any OD description or existing commands modifications.</p>  <p>All possible modifications and additions are listed below:</p>  <ul>   <li>add OD descriptions reading from another file;</li>    <li>mark file as changed after OD descriptions are created or edited;</li>    <li>eliminate excessive clicking in OD description windows – in _ADEDEFDATA;</li>    <li>add descriptions of OD field value limitations in order to control data (e.g. instead of column “OD Field description”);</li>    <li>change the type of 254 characters long fields to String (n), i.e. string of the specified length;</li>    <li>associate the default value length with character fields specified length;</li>    <li>remove or block the possibility of duplicate OD attaching;</li>    <li>consider the difference in OD descriptions field order and in default values during copy of OD attached elements from file to file as non-significant;</li>    <li>add object menu in order to select necessary objects from the classified list and draw elements of the type, properties and OD set defined for each object. The direct prototype of such object menu – Feature classes drawing menu. One may use XML files of the same structure and with same service as for Feature classes, but with a different main result – with OD attachment;</li>    <li>add processing of preselected elements for OD attachment/detachment command (_ADEATTACHDATA);</li>    <li>add commands for selection of graphical elements with OD attached, without OD attached, with duplicate OD attached, with multiple OD attached, with OD of specified values attached, etc.;</li>    <li>add commands for OD attachment/detachment by various attributes – attach OD by samples, detach duplicate OD, detach specified OD, etc.;</li>    <li>add OD contents table view – as external database contents table view; ensure coordinated OD browsing and editing between table view and graphical elements;</li>    <li>add commands for OD fields input and edit automation – for IDs creation, graphical properties storage, value replacement, etc.;</li>    <li>add commands for OD fields filling with texts values adjacent to graphic elements with these ODs;</li>    <li>add commands for OD field input check-up;</li>    <li>add element selection by OD for drawing correction commands (_MAPCLEAN, Drawing cleanup) and for topological model creation (_MAPTOPOCREATE).</li> </ul>  <p>Some other commands can be added to carry out operations with OD or to check graphic elements for OD presence e.g. element type conversion keeping OD, transfer Feature classes additional data descriptions to OD, etc.</p>  <p>The total number of required additional commands for OD could be about 40-60. Many of these commands are quite easy to develop. The most complicated have working prototypes in AutoCAD Map 3D. The experience in OD commands development as well as the existence of successfully working prototypes allows us to assume that such set of commands and modifications can be implemented by 2-3 experienced programmers within just 2-3 months including testing, debugging and user manual writing. Many of these commands are so simple that one programmer can create up to three such commands a day. </p>  <p><strong>8. Object Data prospects</strong> </p>  <p>As it was mentioned above, AutoCAD is one of the world leading CAD software and one of the leaders in geodesics, cartography, etc., as a drawing facility. AutoCAD holds the major part of both global and local drawing software markets. AutoCAD Map 3D at the same time holds incomparably lower place in the corresponding geodesics and cartography sectors while users often have to transform their graphical data into digital maps or GIS data using third-party software. Alternatively users have to reject AutoCAD in favour of other developers. For the same reason other developers of the specialized software do not take into account or insufficiently take into account AutoCAD Map 3D capabilities to exchange data with it.   <br />The key reason for such situation is that AutoCAD Map 3D has no convenient, simple, complete and reliable way to describe entities, objects and its characteristics during digital mapping and GIS data creation which can be learnt by most unskilled computer users e.g. mapmakers and operators building primary cartographic data.</p>  <p>Great drawing capabilities of AutoCAD will always encourage users to regard AutoCAD Map 3D as a tool for creation and drawing of digital maps and initial GIS data. On the other hand, various sources external data connection, data analysis, design, etc., do not require great AutoCAD drawing capacities making up the major part of AutoCAD Map 3D cost and will therefore be regarded as unreasonable expenses by users.</p>  <p>Object Data advantages suggest that the mapping vertical product of AutoCAD Map 3D will become the most effective tool to describe graphic objects’ additional data while digital mapping and GIS data creation after the corresponding modifications and commands addition.</p>  <p>Definitely, it is preferred to expect that Autodesk will modify Object Data by itself – it would be better, easier, more productive and cheaper for users. Surely it is possible that third-party developers will also create AutoCAD Map plugins for the better Object Data workflow, but the quality of such plugins could be questionable whereas its usage would require additional costs and could bring unpredictable results.</p>  <p>AutoCAD widespread distribution all over the world in the fields of geodesics and cartography and the extreme simplicity of Object Data allow us to expect that AutoCAD Map 3D has a reasonable chance to break through with the help of Object Data modifications and become one of the most popular digital mapping and GIS data preparation software.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Miroslav Vrabec
EMAIL: 
IP: 195.93.192.195
URL: http://profile.typepad.com/6p01a3fd417d42970b
DATE: 09/18/2015 12:32:20 AM
Thanks alot man for this good info.
-----
COMMENT:
AUTHOR: Alexander Sharov
EMAIL: a.v.sharov62@gmail.com
IP: 46.183.183.146
URL: 
DATE: 09/25/2015 06:08:40 AM
Thank you for rating!
-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Spiral Curve Spiral PI &ndash; Playing with Math
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: spiral-curve-spiral-pi-playing-with-math

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2015/08/spiral-curve-spiral-pi-playing-with-math.html 
DATE: 08/07/2015 09:32:53 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a> (@<a href="https://twitter.com/augustomaia">augustomaia</a>)</p>  <p>First, from the AutoCAD Civil 3D Knowledge Network, review the topic <a href="http://knowledge.autodesk.com/support/autocad-civil-3d/learn-explore/caas/CloudHelp/cloudhelp/2016/ENU/Civil3D-UserGuide/files/GUID-DD7C0EA1-8465-45BA-9A39-FC05106FD822-htm.html">About Spiral Definitions</a>. The following image summarize the article. We’re interested in start direction from <u>Spiral In</u> and end direction at <u>Spiral Out</u>.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d14533fb970c-pi"><img title="scs" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; display: inline; border-top-width: 0px" border="0" alt="scs" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01b7c7bb7e26970b-pi" width="333" height="195" /></a> </p>  <p>At the API we have the <strong>AlignmentSCS</strong> object with only the direction, which is actually an angle, at the <strong>SpiralIn.StartDirection</strong> and <strong>SpiralOut.EndDirection</strong> properties. </p>  <p>Now let’s have some fun with the math piece: the direction vector is the Sin and Cos of this direction (which is actually the tangent). Here an image definition from <a href="https://en.wikipedia.org/wiki/File:Sin-cos-defn-I.svg">Wikipedia</a>:</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d1453404970c-pi"><img title="247px-Sin-cos-defn-I.svg[1]" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; display: inline; border-top-width: 0px" border="0" alt="247px-Sin-cos-defn-I.svg[1]" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01bb085f8a8e970d-pi" width="244" height="237" /></a></p>  <p>From this definition we can create a Vector2d at both ends (<strong>SpiralIn.StartDirection</strong> and <strong>SpiralOut.EndDirection</strong>), then use Line2d to create lines and, finally, the intersection. Here is the code:</p>  <pre style="font-size: 13px; font-family: consolas; background: white; color: black"><span style="color: blue">public</span>&#160;<span style="color: blue">static</span>&#160;<span style="color: #2b91af">Point2d</span> PI(<span style="color: blue">this</span>&#160;<span style="color: #2b91af">AlignmentSCS</span> scs)<br />{<br />&#160; <span style="color: green">// vector at SpiralIn.StartDirection</span><br />&#160; <span style="color: #2b91af">Vector2d</span> vectorIn = <span style="color: blue">new</span>&#160;<span style="color: #2b91af">Vector2d</span>(<br />&#160;&#160;&#160; <span style="color: #2b91af">Math</span>.Sin(scs.SpiralIn.StartDirection),<br />&#160;&#160;&#160; <span style="color: #2b91af">Math</span>.Cos(scs.SpiralIn.StartDirection));<br /> <br />&#160; <span style="color: green">// vector at SpirtalOut.EndDirection</span><br />&#160; <span style="color: green">// negate to get the inner vector</span><br />&#160; <span style="color: green">// redundant as the line is infinite</span><br />&#160; <span style="color: #2b91af">Vector2d</span> vectorOut = <span style="color: blue">new</span>&#160;<span style="color: #2b91af">Vector2d</span>(<br />&#160;&#160;&#160; <span style="color: #2b91af">Math</span>.Sin(scs.SpiralOut.EndDirection),<br />&#160;&#160;&#160; <span style="color: #2b91af">Math</span>.Cos(scs.SpiralOut.EndDirection)).Negate();<br /> <br />&#160; <span style="color: green">// create line from start</span><br />&#160; <span style="color: blue">using</span> (<span style="color: #2b91af">Line2d</span> lineIn = <span style="color: blue">new</span>&#160;<span style="color: #2b91af">Line2d</span>(<br />&#160;&#160;&#160; scs.SpiralIn.StartPoint, vectorIn))<br />&#160; {<br />&#160;&#160;&#160; <span style="color: green">// and create line from end</span><br />&#160;&#160;&#160; <span style="color: blue">using</span> (<span style="color: #2b91af">Line2d</span> lineOut = <span style="color: blue">new</span>&#160;<span style="color: #2b91af">Line2d</span>(<br />&#160;&#160;&#160;&#160;&#160; scs.SpiralOut.EndPoint, vectorOut))<br />&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160; <span style="color: green">// now find the intersection</span><br />&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">Point2d</span>[] intersectPoints = lineIn.IntersectWith(lineOut);<br /> <br />&#160;&#160;&#160;&#160;&#160; <span style="color: green">// some minor error check</span><br />&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> (intersectPoints == <span style="color: blue">null</span> || intersectPoints.Length == 0)<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">throw</span>&#160;<span style="color: blue">new</span> Autodesk.Civil.<span style="color: #2b91af">CivilException</span>(<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #a31515">&quot;Could not find PI for this SCS&quot;</span>);<br /> <br />&#160;&#160;&#160;&#160;&#160; <span style="color: green">// should be just one point, return it</span><br />&#160;&#160;&#160;&#160;&#160; <span style="color: blue">return</span> intersectPoints[0];<br />&#160;&#160;&#160; }<br />&#160; }<br />}</pre>

<p>We can use this method with Extension, as it was declared with <strong>this</strong>. Below is a command method that uses it:</p>

<pre style="font-size: 13px; font-family: consolas; background: white; color: black">[<span style="color: #2b91af">CommandMethod</span>(<span style="color: #a31515">&quot;getSCSPI&quot;</span>)]<br /><span style="color: blue">public</span>&#160;<span style="color: blue">static</span>&#160;<span style="color: blue">void</span> CmdGetSCSPI()<br />{<br /></pre>

<pre style="font-size: 13px; font-family: consolas; background: white; color: black"><span style="color: green">  // minimum error check...</span><br /><br />&#160; <span style="color: #2b91af">Editor</span> ed = <span style="color: #2b91af">Application</span>.DocumentManager.MdiActiveDocument.Editor;<br />&#160; <span style="color: #2b91af">ObjectId</span> id = ed.GetEntity(<span style="color: #a31515">&quot;Select alignment: &quot;</span>).ObjectId;<br /> <br />&#160; <span style="color: #2b91af">Database</span> db = <span style="color: #2b91af">Application</span>.DocumentManager.MdiActiveDocument.Database;<br />&#160; <span style="color: blue">using</span> (<span style="color: #2b91af">Transaction</span> tr = db.TransactionManager.StartTransaction())<br />&#160; {<br />&#160;&#160;&#160; <span style="color: #2b91af">Alignment</span> align = tr.GetObject(id, <span style="color: #2b91af">OpenMode</span>.ForRead) <span style="color: blue">as</span>&#160;<span style="color: #2b91af">Alignment</span>;<br />&#160;&#160;&#160; <span style="color: blue">if</span> (align == <span style="color: blue">null</span>) <span style="color: blue">return</span>;<br /> <br />&#160;&#160;&#160; <span style="color: blue">foreach</span> (<span style="color: #2b91af">AlignmentEntity</span> alignEnt <span style="color: blue">in</span> align.Entities)<br />&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160; <span style="color: green">// for this test, just SCS, skip others</span><br />&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> (alignEnt.EntityType != <br />        <span style="color: #2b91af">AlignmentEntityType</span>.SpiralCurveSpiral) <span style="color: blue">continue</span>;<br /> <br />&#160;&#160;&#160;&#160;&#160; <span style="color: green">// finally get the PI (using the extension method)</span><br />&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">AlignmentSCS</span> scs = alignEnt <span style="color: blue">as</span>&#160;<span style="color: #2b91af">AlignmentSCS</span>;<br />&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">Point2d</span> scsPI = scs.PI();<br /> <br />&#160;&#160;&#160;&#160;&#160; <span style="color: green">// let's add a point to Model Space</span><br />&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">DBPoint</span> newPointAtSCS = <span style="color: blue">new</span>&#160;<span style="color: #2b91af">DBPoint</span>(<br />        <span style="color: blue">new</span>&#160;<span style="color: #2b91af">Point3d</span>(<span style="color: blue">new</span>&#160;<span style="color: #2b91af">Plane</span>(), scsPI));<br />&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">BlockTableRecord</span> mSpace = tr.GetObject(<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">SymbolUtilityServices</span>.GetBlockModelSpaceId(db),<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">OpenMode</span>.ForWrite) <span style="color: blue">as</span>&#160;<span style="color: #2b91af">BlockTableRecord</span>;<br />&#160;&#160;&#160;&#160;&#160; mSpace.AppendEntity(newPointAtSCS);<br />&#160;&#160;&#160;&#160;&#160; tr.AddNewlyCreatedDBObject(newPointAtSCS, <span style="color: blue">true</span>);<br />&#160;&#160;&#160; }<br />&#160;&#160;&#160; tr.Commit();<br />&#160; }<br />}</pre>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Showing InfraWorks 360 data on Google Maps
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: showing-infraworks-360-data-on-google-maps
CATEGORY: Augusto Goncalves
CATEGORY: Infraworks 360
CATEGORY: WebGL

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2015/07/showing-infraworks-360-data-on-google-maps.html 
DATE: 07/31/2015 01:16:58 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html" target="_self">Augusto Goncalves</a> @<a href="https://twitter.com/augustomaia" target="_self">augustomaia</a></p>
<p>This week I decided to show InfraWorks 360 data on the browser somehow. After some research on the web, trying to find whatever is out there already, found an interesting <a href="http://johndyer.name/drawing-3d-objects-and-building-on-google-maps/" target="_self">article from John Dyer</a>. He basically shows how to mimic a 3D behavior using polygons with tilt perspective, which in Google Maps is know as 45<sup>o</sup> imagery.&#0160;</p>
<p>Ok, we don&#39;t need to start from zero. In fact I did a first sample <a href="http://adndevblog.typepad.com/infrastructure/2014/05/infraworks-360-rest-api-tech-preview-available.html" target="_self">back on 2014</a>, and published an <a href="http://adndevblog.typepad.com/infrastructure/2015/05/changes-on-infraworks-360-rest-api.html" target="_self">updated version of the library early this year</a>. So it was a matter of getting the old sample and update the library.</p>
<p>Here is the result, not super fancy, but can do some tricks. At the left, a list of InfraWorks 360 models under my account, at the center the Google Maps with the buildings in red. Interesting, isn&#39;t it?</p>
<p><img alt="Iw360_gmaps" border="0" class="asset  asset-image at-xid-6a0167607c2431970b01b8d141a196970c image-full img-responsive" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d141a196970c-800wi" title="Iw360_gmaps" /></p>
<p>It&#39;s not a true 3D with WebGL, so my next goal it try something with <a href="https://github.com/vizicities/vizicities" target="_self">ViziCities</a>.&#0160;</p>
<p>By the way, this will be part of my upcoming classes at <a href="au.autodesk.com/brasil/home1" target="_self">AU Brazil</a> (early September) and <a href="http://au.autodesk.com/las-vegas/overview" target="_self">AU Las Vegas</a>.&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Index - Autodesk Infrastructure Map Server(AIMS) API Training Materials
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: index-autodesk-infrastructure-map-serveraims-api-training-materials
CATEGORY: AIMS
CATEGORY: AIMS 2013
CATEGORY: AIMS 2014
CATEGORY: ASP.NET
CATEGORY: Daniel Du
CATEGORY: DevTV

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2015/07/index-autodesk-infrastructure-map-serveraims-api-training-materials.html 
DATE: 07/29/2015 07:02:58 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>I am always asked where the AIMS API training materials are, actually they are posted to ADN Devblogs long time ago, you may find some of them by Google search. But they may scattered in different blog posts, for convenience, I compose this index, it just direct to each post: </p>  <p>&#160;</p>  <blockquote>   <h5><a href="http://adndevblog.typepad.com/infrastructure/2012/05/devtv-and-code-sample-create-temporary-layer-feature-editing-in-aims2012.html">DevTV and Code Sample: create temporary layer, feature editing</a></h5> </blockquote>  <p>&#160;</p>  <ul>   <li>     <h5><a href="http://adndevblog.typepad.com/infrastructure/2013/03/autodesk-infrastructure-map-serveraims-api-training-content-part-1.html">Autodesk Infrastructure Map Server(AIMS) API Training content : Part-1</a></h5>   </li>    <li><a href="http://widget3.linkwithin.com/redirect?url=http%3A//adndevblog.typepad.com/infrastructure/2013/04/autodesk-infrastructure-map-serveraims-api-training-content-part-2.html&amp;rtype=&amp;vars=%5B%22http%3A//adndevblog.typepad.com/infrastructure/2013/04/autodesk-infrastructure-map-serveraims-api-training-content-part-8.html%22%2C%201593489%2C%200%2C%20%22http%3A//adndevblog.typepad.com/infrastructure/2013/04/autodesk-infrastructure-map-serveraims-api-training-content-part-8.html%22%2C%20298966015%2C%201%2C%20298599151%5D&amp;ts=1438220474012">Autodesk Infrastructure Map Server(AIMS) API Training content : Part-2</a></li>    <li><a href="http://adndevblog.typepad.com/infrastructure/2013/04/autodesk-infrastructure-map-serveraims-api-training-content-part-3.html">Autodesk Infrastructure Map Server(AIMS) API Training content : Part-3</a></li>    <li><a href="http://adndevblog.typepad.com/infrastructure/2013/04/autodesk-infrastructure-map-serveraims-api-training-content-part-4.html">Autodesk Infrastructure Map Server(AIMS) API Training content : Part-4</a></li>    <li><a href="http://adndevblog.typepad.com/infrastructure/2013/04/autodesk-infrastructure-map-serveraims-api-training-content-part-5.html">Autodesk Infrastructure Map Server(AIMS) API Training content : Part-5</a></li>    <li><a href="http://adndevblog.typepad.com/infrastructure/2013/04/autodesk-infrastructure-map-serveraims-api-training-content-part-6.html">Autodesk Infrastructure Map Server(AIMS) API Training content : Part-6</a> </li>    <li><a href="http://adndevblog.typepad.com/infrastructure/2013/04/autodesk-infrastructure-map-serveraims-api-training-content-part-7.html">Autodesk Infrastructure Map Server(AIMS) API Training content : Part-7</a></li>    <li><a href="http://adndevblog.typepad.com/infrastructure/2013/04/autodesk-infrastructure-map-serveraims-api-training-content-part-8.html">Autodesk Infrastructure Map Server(AIMS) API Training content : Part-8</a> </li> </ul>  <p>&#160;</p>  <p>It maybe kind of out-dated as software versions are increasing, but the API should be compatible. If should be not difficult to apply them to new versions. Hope this helps some.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Using JIG with Civil 3D Labels
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: using-jig-with-civil-3d-labels
CATEGORY: .NET
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2015/07/using-jig-with-civil-3d-labels.html 
DATE: 07/15/2015 05:30:02 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>This is based on <a href="http://through-the-interface.typepad.com/through_the_interface/2008/03/using-a-jig-to.html">Kean’s original post for AutoCAD entities</a>, but adjusted to Move (instead Rotate) and using the Label specific property: <strong>LabelLocation</strong>.</p>  <p>Some background: JIG is an AutoCAD API feature to manipulate objects on screen, but with the ability to actually drag them around (rotate, move, scale, adjust) while seeing the object.</p>  <p>For labels, the final behavior is interesting as we can see the pointer adjusting while the location is also dragged with the cursor. </p>  <p>Enough said, here is the sample code.</p>  <p><span style="color: blue">using</span> Autodesk.AutoCAD.ApplicationServices;     <br /><span style="color: blue">using</span> Autodesk.AutoCAD.DatabaseServices;     <br /><span style="color: blue">using</span> Autodesk.AutoCAD.EditorInput;     <br /><span style="color: blue">using</span> Autodesk.AutoCAD.Runtime;     <br /><span style="color: blue">using</span> Autodesk.AutoCAD.Geometry;     <br />    <br /><span style="color: blue">using</span> Autodesk.Civil.DatabaseServices;     <br />    <br /><span style="color: blue">namespace</span> SampleTesting     <br />{     <br />&#160; <span style="color: blue">public</span>&#160;<span style="color: blue">class</span>&#160;<span style="color: #2b91af">MovelLabelJig</span> : <span style="color: #2b91af">EntityJig</span>     <br />&#160; {     <br />&#160;&#160;&#160; <span style="color: #2b91af">Point3d</span> _location;     <br />    <br />&#160;&#160;&#160; <span style="color: blue">public</span> MovelLabelJig(<span style="color: #2b91af">Label</span> lbl)     <br />&#160;&#160;&#160;&#160;&#160; : <span style="color: blue">base</span>(lbl.Clone() <span style="color: blue">as</span>&#160;<span style="color: #2b91af">Label</span>)     <br />&#160;&#160;&#160; {     <br />&#160;&#160;&#160;&#160;&#160; _location = lbl.LabelLocation;     <br />&#160;&#160;&#160; }     <br />    <br />&#160;&#160;&#160; <span style="color: blue">protected</span>&#160;<span style="color: blue">override</span>&#160;<span style="color: blue">bool</span> Update()     <br />&#160;&#160;&#160; {     <br />&#160;&#160;&#160;&#160;&#160; <span style="color: green">// adjust the entity on screen</span>     <br />&#160;&#160;&#160;&#160;&#160; ((<span style="color: #2b91af">Label</span>)Entity).LabelLocation = _location;     <br />&#160;&#160;&#160;&#160;&#160; <span style="color: blue">return</span>&#160;<span style="color: blue">true</span>;     <br />&#160;&#160;&#160; }     <br />    <br />&#160;&#160;&#160; <span style="color: blue">protected</span>&#160;<span style="color: blue">override</span>&#160;<span style="color: #2b91af">SamplerStatus</span> Sampler(     <br />&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">JigPrompts</span> prompts)     <br />&#160;&#160;&#160; {     <br />&#160;&#160;&#160;&#160;&#160; <span style="color: green">// get the new location (on cursor move)</span>     <br />&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">JigPromptPointOptions</span> jppo =     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">new</span>&#160;<span style="color: #2b91af">JigPromptPointOptions</span>(<span style="color: #a31515">&quot;Move label: &quot;</span>);     <br />&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">PromptPointResult</span> pdr = prompts.AcquirePoint(jppo);     <br />    <br />&#160;&#160;&#160;&#160;&#160; <span style="color: green">// check if is OK</span>     <br />&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> (pdr.Status != <span style="color: #2b91af">PromptStatus</span>.OK)     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">return</span>&#160;<span style="color: #2b91af">SamplerStatus</span>.Cancel;     <br />&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> (pdr.Value.DistanceTo(_location)     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt; <span style="color: #2b91af">Tolerance</span>.Global.EqualPoint)     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">return</span>&#160;<span style="color: #2b91af">SamplerStatus</span>.NoChange;     <br />    <br />&#160;&#160;&#160;&#160;&#160; <span style="color: green">// and store the new valuye</span>     <br />&#160;&#160;&#160;&#160;&#160; _location = pdr.Value;     <br />&#160;&#160;&#160;&#160;&#160; <span style="color: blue">return</span>&#160;<span style="color: #2b91af">SamplerStatus</span>.OK;     <br />&#160;&#160;&#160; }     <br />    <br />&#160;&#160;&#160; <span style="color: gray">///</span><span style="color: green">&#160;</span><span style="color: gray">&lt;summary&gt;</span>     <br />&#160;&#160;&#160; <span style="color: gray">///</span><span style="color: green"> Return the new location, during/after JIG</span>     <br />&#160;&#160;&#160; <span style="color: gray">///</span><span style="color: green">&#160;</span><span style="color: gray">&lt;/summary&gt;</span>     <br />&#160;&#160;&#160; <span style="color: blue">public</span>&#160;<span style="color: #2b91af">Point3d</span> Location { <span style="color: blue">get</span> { <span style="color: blue">return</span> _location; } }     <br />    <br />&#160;&#160;&#160; [<span style="color: #2b91af">CommandMethod</span>(<span style="color: #a31515">&quot;moveLabel&quot;</span>)]     <br />&#160;&#160;&#160; <span style="color: blue">public</span>&#160;<span style="color: blue">static</span>&#160;<span style="color: blue">void</span> CmdMoveLabel()     <br />&#160;&#160;&#160; {     <br />&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">Editor</span> ed = <span style="color: #2b91af">Application</span>.DocumentManager     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; .MdiActiveDocument.Editor;     <br />    <br />&#160;&#160;&#160;&#160;&#160; <span style="color: green">// select the label</span>     <br />&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">PromptEntityOptions</span> peo =     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">new</span>&#160;<span style="color: #2b91af">PromptEntityOptions</span>(<span style="color: #a31515">&quot;\nSelect a label to move: &quot;</span>);     <br />&#160;&#160;&#160;&#160;&#160; peo.SetRejectMessage(<span style="color: #a31515">&quot;\nLabels only&quot;</span>);     <br />&#160;&#160;&#160;&#160;&#160; peo.AddAllowedClass(<span style="color: blue">typeof</span>(<span style="color: #2b91af">Label</span>), <span style="color: blue">false</span>);     <br />&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">PromptEntityResult</span> per = ed.GetEntity(peo);     <br />&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> (per.Status != <span style="color: #2b91af">PromptStatus</span>.OK) <span style="color: blue">return</span>;     <br />    <br />&#160;&#160;&#160;&#160;&#160; <span style="color: green">// start a transaction</span>     <br />&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">Database</span> db = <span style="color: #2b91af">Application</span>.DocumentManager     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; .MdiActiveDocument.Database;     <br />&#160;&#160;&#160;&#160;&#160; <span style="color: blue">using</span> (<span style="color: #2b91af">Transaction</span> trans = db.     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; TransactionManager.StartTransaction())     <br />&#160;&#160;&#160;&#160;&#160; {     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// open the label object</span>     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">Label</span> lbl = trans.GetObject(per.ObjectId,     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">OpenMode</span>.ForRead) <span style="color: blue">as</span>&#160;<span style="color: #2b91af">Label</span>;     <br />    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// start the JIG drag</span>     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">MovelLabelJig</span> jig = <span style="color: blue">new</span>&#160;<span style="color: #2b91af">MovelLabelJig</span>(lbl);     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">PromptResult</span> pr = ed.Drag(jig);     <br />    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// if not OK, clean return</span>     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> (pr.Status != <span style="color: #2b91af">PromptStatus</span>.OK) <span style="color: blue">return</span>;     <br />    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// everything ok, update the location</span>     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; lbl.UpgradeOpen();     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; lbl.LabelLocation = jig.Location;     <br />    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; trans.Commit();     <br />&#160;&#160;&#160;&#160;&#160; }     <br />&#160;&#160;&#160; }     <br />&#160; }     <br />} </p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: One Million Downloads! And some cool Civil 3D apps
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: one-million-downloads-and-some-cool-civil-3d-apps
CATEGORY: Announcement
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2015/07/one-million-downloads-and-some-cool-civil-3d-apps.html 
DATE: 07/02/2015 11:40:47 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>We’re glad to announce One Million Downloads at the Autodesk Exchange Store! And a big-super-mega special thanks to all developers with apps on the store! This was only possible with a lot of great apps! </p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d131d8c6970c-pi"><img title="Screen Shot 2015-07-02 at 15.23.06" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; display: inline; border-top-width: 0px" border="0" alt="Screen Shot 2015-07-02 at 15.23.06" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01b7c7a86cee970b-pi" width="471" height="97" /></a></p>  <p>Although we have different stores for different Autodesk products, let me show a list of popular Civil 3D apps:</p>  <ul>   <li><a href="https://apps.exchange.autodesk.com/CIV3D/en/Detail/Index?id=appstore.exchange.autodesk.com%3Aslopeacrosspipes_windows32and64%3Aen">Slope Across Pipes</a> </li>    <li><a href="https://apps.exchange.autodesk.com/CIV3D/en/Detail/HelpDoc?id=appstore.exchange.autodesk.com:addlabelstocontours1421071587_windows64:en">Add Labels to Contours</a> </li>    <li><a href="https://apps.exchange.autodesk.com/CIV3D/en/Detail/Index?id=appstore.exchange.autodesk.com%3Agradepoly%3Aen">GradePoly</a> </li>    <li><a href="https://apps.exchange.autodesk.com/CIV3D/en/Detail/Index?id=appstore.exchange.autodesk.com%3Aextractpointblocks%3Aen">Extract Point Blocks</a> </li>    <li><a href="https://apps.exchange.autodesk.com/CIV3D/en/Detail/Index?id=appstore.exchange.autodesk.com%3Asurfacestoggle%3Aen">Surfaces Toggle</a> </li>    <li><a href="https://apps.exchange.autodesk.com/CIV3D/en/Detail/Index?id=appstore.exchange.autodesk.com%3Ac3dexportprofilestodxf-forusewithslide_windows32and64%3Aen">Export Profiles to DXF</a> </li>    <li><a href="https://apps.exchange.autodesk.com/CIV3D/en/Detail/Index?id=appstore.exchange.autodesk.com%3Asmartdraftinversepointstrial%3Aen">SmartDraft Inverse Points</a> </li>    <li><a href="https://apps.exchange.autodesk.com/CIV3D/en/Detail/Index?id=appstore.exchange.autodesk.com%3A3dpolytoprofile_windows64%3Aen">3DPolyToProfile</a> </li>    <li><a href="https://apps.exchange.autodesk.com/ACD/en/Detail/Index?id=appstore.exchange.autodesk.com:changepolylineoriginanddirection_windows32and64:en">Change Polyline Origin and Direction</a> </li>    <li><a href="https://apps.exchange.autodesk.com/ACD/en/Detail/Index?id=appstore.exchange.autodesk.com:tbn2cad_windows32and64:en">TBN2CAD</a> </li> </ul>  <p>Don’t have your app live on the store? It’s time! Get more <a href="http://www.autodesk.com/developapps">technical information here</a> and <a href="https://apps.exchange.autodesk.com/en/Publisher/Description?productline=CIV3D">publish your app</a>!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Read TinVolumeSurface triangles in Civil 3D
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: read-tinvolumesurface-triangles-in-civil-3d
CATEGORY: .NET
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2015/05/read-tinvolumesurface-triangles-in-civil-3d.html 
DATE: 05/14/2015 02:53:30 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>The TinSurface object has a Triangle property, which allow access to the list of triangles of the surface. But the TinVolumeSurface does not offer this property. The workaround is to use the COM version of this object, AeccTinVolumeSurface, which has a <a href="http://docs.autodesk.com/CIV3D/2012/ENU/API_Reference_Guide/com/AeccXLandLib__IAeccTinVolumeSurface__OutputTriangles@[out,retval]_VARIANT_.htm">OutputTriangles property</a>, that returns a array of doubles, but this need to be interpreted as points (XYZ coordinates). </p>  <p>On C# this property can be used with <a href="https://msdn.microsoft.com/en-us/library/dd264736.aspx">dynamic types</a>, which allow late-binding of COM Interop types. To make the points, it’s a matter of playing with arrays.</p>  <p>At this sample you’ll find a Triangle and TriangleCollection classes to use this array of doubles. This sample also create AutoCAD Faces of each triangle, just for testing.</p>  <pre style="font-size: 13px; font-family: consolas; background: white; color: black">[<span style="color: #2b91af">CommandMethod</span>(<span style="color: #a31515">&quot;getTriangles&quot;</span>)]<br /><span style="color: blue">public</span>&#160;<span style="color: blue">static</span>&#160;<span style="color: blue">void</span> CmdGetTriangles()<br />{<br />&#160; <span style="color: #2b91af">Editor</span> ed = <span style="color: #2b91af">Application</span>.DocumentManager.MdiActiveDocument.Editor;<br /> <br />&#160; <span style="color: #2b91af">PromptEntityOptions</span> peo = <span style="color: blue">new</span>&#160;<span style="color: #2b91af">PromptEntityOptions</span>(<br />&#160;&#160;&#160; <span style="color: #a31515">&quot;\nSelect tin volume surface: &quot;</span>);<br />&#160; peo.SetRejectMessage(<span style="color: #a31515">&quot;\nOnly tin volume surface&quot;</span>);<br />&#160; peo.AddAllowedClass(<span style="color: blue">typeof</span>(<span style="color: #2b91af">TinVolumeSurface</span>), <span style="color: blue">true</span>);<br />&#160; <span style="color: #2b91af">PromptEntityResult</span> per = ed.GetEntity(peo);<br />&#160; <span style="color: blue">if</span> (per.Status != <span style="color: #2b91af">PromptStatus</span>.OK) <span style="color: blue">return</span>;<br /> <br />&#160; <span style="color: #2b91af">Database</span> db = <span style="color: #2b91af">Application</span>.DocumentManager.<br />&#160;&#160;&#160; MdiActiveDocument.Database;<br />&#160; <span style="color: blue">using</span> (<span style="color: #2b91af">Transaction</span> trans = db.TransactionManager.<br />&#160;&#160;&#160; StartOpenCloseTransaction())<br />&#160; {<br />&#160;&#160;&#160; <span style="color: #2b91af">TinVolumeSurface</span> tvs = trans.GetObject(<br />&#160;&#160;&#160;&#160;&#160; per.ObjectId, <span style="color: #2b91af">OpenMode</span>.ForRead) <span style="color: blue">as</span>&#160;<span style="color: #2b91af">TinVolumeSurface</span>;<br />&#160;&#160;&#160; <span style="color: blue">dynamic</span> tvsCOM = tvs.AcadObject; <span style="color: green">// get the COM representation</span><br />&#160;&#160;&#160; <span style="color: #2b91af">TriangleCollection</span> triangles = <br />&#160;&#160;&#160;&#160;&#160; <span style="color: blue">new</span>&#160;<span style="color: #2b91af">TriangleCollection</span>(tvsCOM.OutputTriangles);<br /> <br />&#160;&#160;&#160; <span style="color: green">// for testing, let's create faces using the triangle data</span><br />&#160;&#160;&#160; <span style="color: #2b91af">BlockTableRecord</span> currSpace = trans.GetObject(<br />&#160;&#160;&#160;&#160;&#160; db.CurrentSpaceId, <span style="color: #2b91af">OpenMode</span>.ForWrite) <span style="color: blue">as</span>&#160;<span style="color: #2b91af">BlockTableRecord</span>;<br />&#160;&#160;&#160; <span style="color: blue">foreach</span>(<span style="color: #2b91af">Triangle</span> t <span style="color: blue">in</span> triangles)<br />&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">Face</span> f = <span style="color: blue">new</span>&#160;<span style="color: #2b91af">Face</span>(<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; t.Vertex1, t.Vertex2, t.Vertex3, <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">true</span>, <span style="color: blue">true</span>, <span style="color: blue">true</span>, <span style="color: blue">true</span>);<br />&#160;&#160;&#160;&#160;&#160; currSpace.AppendEntity(f);<br />&#160;&#160;&#160;&#160;&#160; trans.AddNewlyCreatedDBObject(f, <span style="color: blue">true</span>);<br />&#160;&#160;&#160; }<br /> <br />&#160;&#160;&#160; trans.Commit();<br />&#160; }<br />}<br /> <br /><span style="color: blue">public</span>&#160;<span style="color: blue">class</span>&#160;<span style="color: #2b91af">TriangleCollection</span> : <span style="color: #2b91af">List</span>&lt;<span style="color: #2b91af">Triangle</span>&gt;<br />{<br />&#160; <span style="color: blue">public</span> TriangleCollection(<span style="color: blue">double</span>[] arrayDoubles)<br />&#160; {<br />&#160;&#160;&#160; <span style="color: blue">if</span> (arrayDoubles.Length % 9 != 0) <br />&#160;&#160;&#160;&#160;&#160; <span style="color: blue">throw</span>&#160;<span style="color: blue">new</span>&#160;<span style="color: #2b91af">ArgumentException</span>(<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #a31515">&quot;Double array must have mulitple of 9 values.&quot;</span>);<br /> <br />&#160;&#160;&#160; <span style="color: blue">int</span> numberOfDoubles = arrayDoubles.Length;<br />&#160;&#160;&#160; <span style="color: blue">int</span> numberOfPoints = numberOfDoubles / 3 / 3;<br />&#160;&#160;&#160; <span style="color: blue">for</span> (<span style="color: blue">int</span> p = 0; p &lt; numberOfPoints; p++)<br />&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160; <span style="color: blue">double</span>[] pointValues = <span style="color: blue">new</span>&#160;<span style="color: blue">double</span>[9];<br />&#160;&#160;&#160;&#160;&#160; <span style="color: blue">for</span> (<span style="color: blue">int</span> v = 0; v &lt; 9; v++)<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; pointValues[v] = arrayDoubles[p * 9 + v];<br />&#160;&#160;&#160;&#160;&#160; <span style="color: blue">base</span>.Add(<span style="color: blue">new</span>&#160;<span style="color: #2b91af">Triangle</span>(pointValues));<br />&#160;&#160;&#160; }<br />&#160; }<br />}<br /> <br /><span style="color: blue">public</span>&#160;<span style="color: blue">struct</span>&#160;<span style="color: #2b91af">Triangle</span><br />{<br />&#160; <span style="color: blue">private</span>&#160;<span style="color: #2b91af">Point3d</span>[] _points;<br /> <br />&#160; <span style="color: blue">public</span> Triangle(<span style="color: blue">double</span>[] values)<br />&#160; {<br />&#160;&#160;&#160; <span style="color: blue">if</span> (values.Length != 9) <span style="color: blue">throw</span>&#160;<span style="color: blue">new</span>&#160;<span style="color: #2b91af">ArgumentException</span>(<br />&#160;&#160;&#160;&#160;&#160; <span style="color: #a31515">&quot;Double array must have 9 values.&quot;</span>);<br /> <br />&#160;&#160;&#160; _points = <span style="color: blue">new</span>&#160;<span style="color: #2b91af">Point3d</span>[3];<br />&#160;&#160;&#160; <span style="color: blue">for</span> (<span style="color: blue">int</span> p = 0; p &lt; 3; p++)<br />&#160;&#160;&#160;&#160;&#160; _points[p] = <span style="color: blue">new</span>&#160;<span style="color: #2b91af">Point3d</span>(<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; values[p * 3],<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; values[p * 3 + 1],<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; values[p * 3 + 2]);<br />&#160; }<br /> <br />&#160; <span style="color: blue">public</span>&#160;<span style="color: #2b91af">Point3d</span> Vertex1 { <span style="color: blue">get</span> { <span style="color: blue">return</span> _points[0]; } }<br />&#160; <span style="color: blue">public</span>&#160;<span style="color: #2b91af">Point3d</span> Vertex2 { <span style="color: blue">get</span> { <span style="color: blue">return</span> _points[1]; } }<br />&#160; <span style="color: blue">public</span>&#160;<span style="color: #2b91af">Point3d</span> Vertex3 { <span style="color: blue">get</span> { <span style="color: blue">return</span> _points[2]; } }<br />}</pre>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Madhukar Moogala
AUTHOR EMAIL: fpdtypepadadmin@autodesk.com
TITLE: Autodesk Exchange Apps Store – Publisher Survey
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 0
ALLOW PINGS: 0
BASENAME: autodesk-exchange-apps-store-publisher-survey
CATEGORY: Announcement

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2015/05/autodesk-exchange-apps-store-publisher-survey.html 
DATE: 05/13/2015 03:36:06 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/autocad/virupaksha-aithal.html" target="_self">Virupaksha Aithal</a></p>
<p>It is my pleasure to announce the launch of inaugural Autodesk Exchange Apps Store – Publisher survey. I hope you’ll be willing to give 5-10 minutes of your time to take the survey – the results will be used to guide the efforts of Autodesk Exchange Apps Store team.</p>
<p><a href="https://www.surveymonkey.com/s/surveypublisher" target="_self">Click here to take survey</a></p>
<p>The survey will remain open until 12th of June 2015.&nbsp;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Changes on Infraworks 360 REST API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: changes-on-infraworks-360-rest-api
CATEGORY: Augusto Goncalves
CATEGORY: Infraworks 360

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2015/05/changes-on-infraworks-360-rest-api.html 
DATE: 05/05/2015 10:50:00 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>  <p><strong><u>First things first</u></strong></p>  <p>If you are not aware, we have a <a href="http://adndevblog.typepad.com/infrastructure/2014/05/infraworks-360-rest-api-tech-preview-available.html">Infraworks 360 API Pilot</a> going on since mid last year and you can even try a <a href="http://adndevblog.typepad.com/infrastructure/2014/10/importing-alignment-from-infraworks-360-to-civil-3d.html">small sample with Civil 3D Alignments</a>. If you want to work with this API, contact us with more information about your needs.</p>  <p><strong><u>Back to the topic</u></strong></p>  <p>A new version of the Infraworks 360 REST API is now live! There are some cool new representations available.</p>  <p>First, we removed the /data/ on all URIs, which made it more simple. The objects on the model, previously known as <strong>classes</strong>, are now <strong>features, </strong>and the model object now has boundary information and proposals list.</p>  <p>The major addition is the <strong>Proposal </strong>representation that can be fully accessed via <em>/model/::mode_id::/proposals/::proposal_name::</em> and is also available under the model representation (just a list of names). </p>  <p>With proposals, all the features are now listed under each proposal with <em>models/::model_id::/proposals/::proposal_name::/::feature_name::/:feature_id::</em></p>  <p>Now the new basic structure is: <strong>models</strong> that contains <strong>proposals</strong> that contains <strong>features</strong> (e.g. roads, buildings, trees, constraints, etc).</p>  <p><a href="http://en.wikipedia.org/wiki/Transport_Layer_Security#TLS_1.2">TLS 1.2</a> security is required on calls to the server. If you are using .NET it should be easy, just set the security protocol with:</p>  <p><em>ServicePointManager.SecurityProtocol = SecurityProtocolType.Tls12</em></p>  <p><strong><u>Updated .NET library and sample</u></strong></p>  <p>To demonstrate the new and previous representations available on the API, we have remodeled the library and sample available at the <a href="https://github.com/ADN-DevTech/Infraworks_API_Samples">Github repository</a>. This project was also migrated to .NET 4.5 (required to support TLS 1.2) and all references migrated to newest versions (e.g. RestSharp).</p>  <p>Below is a quick view of the sample running with: models, proposals, features types, list and details.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b7c78555bd970b-pi"><img title="IW360 Sample app" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="IW360 Sample app" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d10ed2cc970c-pi" width="488" height="363" /></a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Overrule pipe network part in profile view
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: overrule-pipe-network-part-in-profile-view
CATEGORY: .NET
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2015/04/overrule-pipe-network-part-in-profile-view.html 
DATE: 04/30/2015 06:25:52 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>Using this <a href="http://adndevblog.typepad.com/autocad/2015/04/simple-drawable-overrule-skeleton.html">simple overrule skeleton</a> we can change the pipe or structure representation on a profile view. We just need to overrule the <a href="http://adndevblog.typepad.com/infrastructure/2014/07/pipe-network-parts-on-profile-view.html">ProfilePartView</a> class and do some additional geometry. Here is a quick sample.</p>  <pre style="font-size: 13px; font-family: consolas; background: white; color: black"><span style="color: blue">class</span>&#160;<span style="color: #2b91af">PipePartOverrule</span> : <span style="color: #2b91af">DrawableOverrule</span><br />{<br />&#160; <span style="color: blue">public</span>&#160;<span style="color: blue">override</span>&#160;<span style="color: blue">bool</span> WorldDraw(<br />&#160;&#160;&#160; <span style="color: #2b91af">Drawable</span> drawable, <span style="color: #2b91af">WorldDraw</span> wd)<br />&#160; {<br />&#160;&#160;&#160; <span style="color: blue">bool</span> ret = <span style="color: blue">base</span>.WorldDraw(drawable, wd);<br /> <br />&#160;&#160;&#160; <span style="color: #2b91af">ProfileViewPart</span> viewPart = drawable <span style="color: blue">as</span>&#160;<span style="color: #2b91af">ProfileViewPart</span>;<br />&#160;&#160;&#160; <span style="color: blue">if</span> (viewPart == <span style="color: blue">null</span>) <span style="color: blue">return</span> ret; <span style="color: green">// for safety</span><br /> <br />&#160;&#160;&#160; <span style="color: green">// get the database</span><br />&#160;&#160;&#160; <span style="color: green">// if the entity is database resident, if not,</span><br />&#160;&#160;&#160; <span style="color: green">// then get the active on</span><br />&#160;&#160;&#160; <span style="color: #2b91af">Database</span> db = (viewPart.Database != <span style="color: blue">null</span> ? <br />&#160;&#160;&#160;&#160;&#160; viewPart.Database :<br />&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">Application</span>.DocumentManager.<br />&#160;&#160;&#160;&#160;&#160; MdiActiveDocument.Database);<br /> <br />&#160;&#160;&#160; <span style="color: green">// get the model part type</span><br />&#160;&#160;&#160; <span style="color: blue">if</span> (viewPart.ModelPartId.ObjectClass ==<br />&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">RXClass</span>.GetClass(<span style="color: blue">typeof</span>(<span style="color: #2b91af">Pipe</span>)))<br />&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160; <span style="color: green">// ok, this view part represents a Pipe</span><br />&#160;&#160;&#160;&#160;&#160; <span style="color: green">// let's draw something... just a crossing line</span><br />&#160;&#160;&#160;&#160;&#160; wd.Geometry.WorldLine(<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; viewPart.Bounds.Value.MinPoint,<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; viewPart.Bounds.Value.MaxPoint);<br />&#160;&#160;&#160; }<br /> <br />&#160;&#160;&#160; <span style="color: green">// if you consider handle Structures</span><br />&#160;&#160;&#160; <span style="color: green">//else if (viewPart.ModelPartId.ObjectClass ==</span><br />&#160;&#160;&#160; <span style="color: green">//&#160; RXClass.GetClass(typeof(Structure)))</span><br />&#160;&#160;&#160; <span style="color: green">//{</span><br />&#160;&#160;&#160; <span style="color: green">//}</span><br /> <br />&#160;&#160;&#160; <span style="color: blue">return</span> ret;<br />&#160; }<br />}</pre>

<p>And here is the command based on the skeleton</p>

<pre style="font-size: 13px; font-family: consolas; background: white; color: black"><span style="color: blue">public</span>&#160;<span style="color: blue">class</span>&#160;<span style="color: #2b91af">Commads</span><br />{<br />&#160; [<span style="color: #2b91af">CommandMethod</span>(<span style="color: #a31515">&quot;profilePartOverrule&quot;</span>)]<br />&#160; <span style="color: blue">public</span>&#160;<span style="color: blue">static</span>&#160;<span style="color: blue">void</span> CmdProfilePartOverrule()<br />&#160; {<br />&#160;&#160;&#160; <span style="color: blue">if</span> (_overrule == <span style="color: blue">null</span>)<br />&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160; _overrule = <span style="color: blue">new</span>&#160;<span style="color: #2b91af">PipePartOverrule</span>();<br />&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">Overrule</span>.AddOverrule(<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">RXClass</span>.GetClass(<span style="color: blue">typeof</span>(<span style="color: #2b91af">ProfileViewPart</span>)),<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; _overrule, <span style="color: blue">false</span>);<br />&#160;&#160;&#160; }<br />&#160;&#160;&#160; <span style="color: blue">else</span><br />&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">Overrule</span>.RemoveOverrule(<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">RXClass</span>.GetClass(<span style="color: blue">typeof</span>(<span style="color: #2b91af">ProfileViewPart</span>)),<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; _overrule);<br />&#160;&#160;&#160;&#160;&#160; _overrule = <span style="color: blue">null</span>;<br />&#160;&#160;&#160; }<br />&#160;&#160;&#160; <span style="color: #2b91af">Application</span>.DocumentManager.<br />&#160;&#160;&#160;&#160;&#160; MdiActiveDocument.Editor.Regen();<br />&#160; }<br /> <br />&#160; <span style="color: blue">private</span>&#160;<span style="color: blue">static</span>&#160;<span style="color: #2b91af">PipePartOverrule</span> _overrule = <span style="color: blue">null</span>;<br />}</pre>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: rafrbu
EMAIL: rasmus@focus.no
IP: 195.18.137.50
URL: 
DATE: 05/11/2015 04:43:14 AM
There is only one ProfileViewPart per Network Part? So the Bounds of the ProfileViewPart spans across all the Profile Views where the Pipe is set to be drawn...
-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 177.43.194.106
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 05/11/2015 11:28:19 AM
Actually it's 1-N

You can have N profile part view showing a specific pipe or structure, use Part.GetProfileViewsDisplayingMe to get all profile view part.

Regards,
Augusto Goncalves
-----
COMMENT:
AUTHOR: rafrbu
EMAIL: rasmus@focus.no
IP: 46.9.227.108
URL: 
DATE: 05/14/2015 10:07:31 AM
1-N ProfileViewParts per NetworkPart? So at least 1 ProfileViewPart per NetworkPart...?

I observe that if you select one certain ProfileViewPart in a Profile View, then all 'ProfileViewParts' for the corresponding NetworkPart is selected. So there seems to be only one ProfileViewPart object "behind the scenes"..

And my point is that ProfileViewPart.Bounds includes the Bounds for all the 'ProfileViewParts' of a NetworkPart. Hence if the NetworkPart is set to be drawn in say two Profile Views, then the line you draw above will span from View number 1 to View number 2.

-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 177.43.194.106
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 05/14/2015 11:18:48 AM
Looks like it's getting very specific... would you mind discuss on ADN support case? Please attach a non-confidential sample drawing? Looking forward to your reply.

Regards
Augusto Goncalves
-----
COMMENT:
AUTHOR: Hoang
EMAIL: Trueblue0505@gmail.com
IP: 171.253.176.17
URL: 
DATE: 02/22/2018 03:29:14 AM
Hi Rafbru,
Have this issue been resolved?
-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Autodesk University 2015 - Las Vegas
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: autodesk-university-2015-las-vegas
CATEGORY: Augusto Goncalves

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2015/04/autodesk-university-2015-las-vegas.html 
DATE: 04/22/2015 12:06:56 PM
-----
BODY:
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d1075255970c-pi"><img title="Learn. Connect. Explore." style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="Learn. Connect. Explore." src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d107525c970c-pi" width="479" height="75" /></a> </p>  <p>Autodesk University Las Vegas just started receiving submissions for classes! <a href="http://au.typepad.com/au/2015/04/bring-itthe-au-2015-call-for-proposals-is-now-open.html">See the announcement</a>!</p>  <p>Want to present? Go ahead and <a href="http://au.autodesk.com/speaker-resource-center/call-for-proposals">submit your proposal</a>! We’ll love to have API programming classes on Civil 3D, Map 3D, Infraworks 360.</p>  <p>Want to suggest some specific topics? Contact us or use comments below, we’ll love to hear from you!</p>  <p>And see you in Las Vegas, December 1-3</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: New Features in the AutoCAD Civil 3D 2016 API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: new-features-in-the-autocad-civil-3d-2016-api
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2015/04/new-features-in-the-autocad-civil-3d-2016-api.html 
DATE: 04/15/2015 06:13:56 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>We’re glad to announce <a href="http://www.autodesk.com/products/autocad-civil-3d/overview">AutoCAD Civil 3D 2016</a> it’s available for download at our main portal. Here I would like to point what’s new on the API:</p>  <p><strong>.NET Changes</strong></p>  <p>This section covers changes to the AutoCAD Civil 3D .NET API for the 2016 release.</p>  <ul>   <li>Alignments </li>    <ul>     <li>A parameter named attainmentRegionType has been added to SuperelevationCriticalStationCollection::Add(…). This parameter is used to specify the attainment region type: AutoAttainmentRegionType, BeginingAttainmentRegion, or EndingAttainmentRegion. Specifying AutoAttainmentRegionType as the attainment region type will replicate the behavior that was in previous releases.</li>   </ul>    <li>Pipe Networks</li>    <ul>     <li>A new property named CrossPipeProfile is exposed in the SettingsCmdCreateNetwork::SettingsCmdLabelNewParts class to enable you to get whether a new crossing pipe is labeled by default when placed in profile view.</li>   </ul> </ul>  <p><strong>COM Changes</strong></p>  <p>If you are using the COM API, you need to update the object version to 10.5 (from 10.4 used in AutoCAD Civil 3D 2015). The objects and interfaces exposed have remained the same, but you should reference the new libraries, which are installed by default to: C:\Program Files\Common Files\Autodesk Shared\Civil Engineering 105.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Alej
EMAIL: alejandro.atencio.08@gmail.com
IP: 181.66.156.247
URL: 
DATE: 04/18/2015 12:02:14 PM
Augusto Goncalves!

Hi, YOU know where can i download THE c3d-16 extensions?
-----
COMMENT:
AUTHOR: Eduardo Guedes Ferreira
EMAIL: eguedesferreira@gmail.com
IP: 191.190.40.66
URL: 
DATE: 04/24/2015 09:10:13 PM
Olá Augusto.
Gostaria de sugerir um aprimoramento em um relatório gerado pelo Civil 3D, que ao meu julgo seria de grande serventia aos usuários.
Trata-se do Reports (Station Offset to Points Report) ele gera informações dos pontos em referencia a um alinhamento (Point, Station, Offset, Elevation e Discription) esse Relatório não tem uma opção para filtrar por grupo de pontos nem fornece informações de coordenadas o que nos economizaria um enorme tempo. Ah!!! uma opção para "station index increment" também nos pouparia algum tempo.

Grato pela atenção.


Eduardo Guedes Ferreira.
-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 177.43.194.106
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 04/27/2015 10:43:47 AM
Alej,

So far we don't have a Civil 3D 2016 Extension, if I understood right. You can download the Civil 3D 2015 Extension pack at the subscription.autodesk.com portal.

Regards,
Augusto Goncalves
-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 177.43.194.106
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 04/27/2015 10:46:37 AM
Eduardo,

Obrigado pela sugestão, por favor, verifique o blog Civil 3D Brasil neste link: http://infrabrasil.autodesk.com/blog/2015/04/novidades-autocad-civil-3d-parte-2-e-country-kit-brazil.html e meu colega Pedro Soethe poderá esclarecer os relatórios locais.

Att,
Augusto Goncalves
-----
COMMENT:
AUTHOR: John Stauffer
EMAIL: jstauffer@bohlereng.com
IP: 24.157.61.34
URL: 
DATE: 02/25/2016 06:24:30 AM
Thanks Augusto!  Any thoughts as to why I can't connect using this new library.  I keep getting a Type Mismatch on code I have been using for years.  The error happens on last line.

Dim oAcadApp As AcadApplication

Dim sCivilAppName As String

sCivilAppName = "AeccXUiLand.AeccApplication.10.5"

Dim oCivilApp As AeccApplication

Dim oDocument As AeccDocument


  'now, see if we have any alignments.  if we do, pick one...
Set oAcadApp = ThisDrawing.Application
 
 
Set oCivilApp = oAcadApp.GetInterfaceObject(sCivilAppName)
-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 187.106.222.63
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 02/25/2016 06:47:20 AM
Hi John

As this question is not related to this post, can you post at the forum: http://forums.autodesk.com/t5/autocad-civil-3d-customization/bd-p/190

Usually the 'type mismatch' happens when the types are incorrect, so please clarify (at the forum question) where it happens.

Regards,
Augusto Goncalves
-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Share design models &ndash; quick &amp; easy
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: share-design-models-quick-easy
CATEGORY: Announcement
CATEGORY: WebGL

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2015/04/share-design-models-quick-easy.html 
DATE: 04/07/2015 05:35:11 PM
-----
BODY:
<p>It’s just getting easier to send 2D and 3D design models with Autodesk technologies: just drag &amp; drop a file at <a title="https://360.autodesk.com/viewer" href="https://360.autodesk.com/viewer">https://360.autodesk.com/viewer</a> and you’re good to go! Yes, that easy! Go ahead and try it! And works for over 50 file formats, including non-Autodesk.</p>  <p><a href="https://360.autodesk.com/viewer"><img title="View and Share any design file" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="View and Share any design file" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01b7c774880c970b-pi" width="483" height="311" /></a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: First sample with Infraworks 360 Commuter API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: first-sample-with-infraworks-360-commuter-api
CATEGORY: Augusto Goncalves
CATEGORY: Infraworks 360

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2015/04/first-sample-with-infraworks-360-commuter-api.html 
DATE: 04/01/2015 05:35:10 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>Back in July 2014, Scott Sheppard announced the <a href="http://labs.blogs.com/its_alive_in_the_lab/2014/07/project-commuter-for-infraworks-available-via-autodesk-labs.html">Project Commuter</a> availability for Infraworks 360. From the main <a href="https://beta.autodesk.com/callout/?callid=D23E3D96B32A41EAA1AE9E8F1E319977">project website</a>, here is the description: <em>Project Commuter can be used for transport analysis — modeling all modes of transport, or it can be used for pedestrian-only analysis in urban spaces — both inside and outside buildings.</em></p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b7c76ffb38970b-pi"><img title="Scott Sheppard demonstration with Project Commuter" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="Scott Sheppard demonstration with Project Commuter" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01b7c76ffb3c970b-pi" width="471" height="269" /></a> </p>  <p>Although the main usage is around traffic commute, we also decided to focus this sample on inside building commute, as many employees are living and working at the same building, even at the same space (such as home-office or home-at-office). </p>  <p>Autodesk will allow local customization according to each country (or city) culture (as we understand each social group deals with commute in different ways). And a good way it to allow API customization via custom DLLs loaded into the product, just like other Autodesk products. </p>  <p>To have your local community behavior added to the product, first you’ll need to create a new project on Visual Studio, based on the interfaces available on the DLL inside the product, under TrafficAnalysis folder. As you may notice, it’s a .NET Managed API (the suffix <strong>mgd</strong> is widely used on Autodesk products).</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d0f99e22970c-pi"><img title="commuter_API" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="commuter_API" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d0f99e29970c-pi" width="473" height="248" /></a> </p>  <p>Now it’s easy to use: just create a .NET 4.5 project on Visual Studio, add reference to the DLL (commuter64mgd.dll) and implement the interface. For this sample, we’ll use the <strong>IMorningBehavior</strong> interface, which implements human morning behavior. The VS project should look like the following image. </p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d0f99e2d970c-pi"><img title="VS_projectsettings" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="VS_projectsettings" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01bb0813f541970d-pi" width="480" height="436" /></a> </p>  <p></p>  <p>To run this custom code, place the DLL under the same TrafficAnalyst folder, start Infraworks 360, it should automatically load it and recognize the class (via the interface implemented). When you launch Traffic Simulation on Infraworks 360, select “Human Morning Commute” and the DLL will trigger (make sure you select the “Traffic Study Area” as “In Home Behavior”).</p>  <p>As of today, this API is an early pilot, we’re gathering feedback around local cultures. Our social study group would love to hear feedback. For now, you can get first version of the <a href="http://en.wikipedia.org/wiki/April_Fools%27_Day">documentation at this link</a>.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Using Civil 3D 2015 via console
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: using-civil-3d-2015-via-console
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D 2015

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2015/03/using-civil-3d-2015-via-console.html 
DATE: 03/26/2015 05:35:23 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>Since release 2013, we can use AutoCAD in console mode. This is intended to developers, there is no graphical interface and only the command line is available through the console window or via programming.</p>  <p>Back on Autodesk University 2012, <a href="http://au.autodesk.com/au-online/classes-on-demand/class-catalog/2012/autocad/using-net-programming-to-create-new-possibilities-with-the-autocad-core-console">this class</a> covered the basics on how use and automate AutoCAD Console, including how to load custom .NET applications. Is this possible on Civil 3D? Yes!</p>  <p>To use the console with Civil 3D 2015 .NET API we just need to launch the console and load an additional .NET assembly: AeccDbMgd.dll. After that, a custom .NET DLL should work. The image below show the result. Note how we NETLOAD the AeccDbMgd, then NETLOAD a custom DLL C3D_2015_CS.dll that contains a simple command that count alignment styles.</p>  <p>Of course the AutoCAD Console was not designed to be used like this (via Windows Console), this is just a test. To take full advantage, you can use .bat files (simplest approach) or a full .NET application that will manage and control instances of it. As mentioned above, <a href="http://au.autodesk.com/au-online/classes-on-demand/class-catalog/2012/autocad/using-net-programming-to-create-new-possibilities-with-the-autocad-core-console">the AU class</a> show several samples and ideas, just need to include the additional NETLOAD AeccDbMgd.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01bb080faa2a970d-pi"><img title="original" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="original" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01b7c76bb8b8970b-pi" width="485" height="497" /></a>&#160;</p>  <blockquote>   <p><em>Tip: AutoCAD is now blocking DLLs that are not on the trusted folders. On the UI we can simply include our folders on the trusted path list. Via console this can take extra time, that’s why I copied my custom DLL to Program Files folder (which is trusted by default).</em></p> </blockquote>  <p>The console approach can significantly reduce batch processing time and, as you can launch one instance per drawing, also improve error handling (if one instance freeze, just kill the process and start again). In summary, at least consider and evaluate this option!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Norman Yuan
EMAIL: norman.yuan@focus.ca
IP: 207.229.13.65
URL: 
DATE: 08/21/2015 07:01:55 PM
Since AutoCAD Map 3D is subset of AutoCAD Civil 3D, does that mean that after "NETLOADING" AeccDbMgd.dll, the Civil 3D console can also be used with AutoCAD Map 3D API?

I have tried the console with AutoCAD Map 2014 installation with Map API: code based on MAP API does not run in the console. However, I may have to do similar thing as you described here: NETLOADING some MAP specific managed assemblies first?
-----
COMMENT:
AUTHOR: Norman Yuan
EMAIL: 
IP: 207.229.13.65
URL: http://profile.typepad.com/normanyuan
DATE: 08/21/2015 07:13:13 PM
Since AutoCAD Map3D is a subset included AutoCAD Civil3D, does that mean that after NETLOADING AeccDbMgd.dll, MAP API is also available as Civil3D API?

I have tried to use MAP API in console with AutoCAD Map 2014 installation and failed. Have not tried it with Map 2015/16.

Also, since AutoCAD I/O services are the online version of console, does that mean Civil API (or other vertical AutoCAD products, for that matter) is/will be available with AutoCAD I/O?
-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 177.140.171.253
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 08/25/2015 06:37:32 AM
Norman,

The trick was to NETLOAD the API assemblies (aeccdbmgd.dll) to ensure it's loaded. I haven't tried with Map (don't have it installed), have you trie NETLOADing them?

In fact the Console is an AutoCAD feature, that's why I used this workaround (NETLOAD the API DLLs).

Also, this approach is improving on newer versions. Not sure if was working fine on 2014. 

Regards,
Augusto Goncalves
-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 177.140.171.253
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 08/25/2015 06:40:10 AM
Norman,

AutoCAD I/O does not yet support C3D specific assemblies. When we use it locally we're actually using all C3D files installed locally, but I/O is a vanilla AutoCAD.

Regards,
Augusto Goncalves
-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Is a Civil 3D instance?
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: is-a-civil-3d-instance
CATEGORY: .NET
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D 2015

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2015/03/is-a-civil-3d-instance.html 
DATE: 03/24/2015 01:31:00 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>This is a .NET version of the code posted by a colleague, <a href="http://adndevblog.typepad.com/autocad/2012/09/determine-product-of-autocad-family.html">see original here</a>, redesigned to Civil 3D naming.</p>  <p>When we get a running instance of AutoCAD, we don’t know which vertical is actually running as all of them are basically the same root object. To determine which version we have, we need to try. And that’s what this code is doing.</p>  <pre style="font-size: 13px; font-family: consolas; background: white; color: black"><span style="color: green">' get the running instance of AutoCAD (or any vertical)</span><br /><span style="color: blue">Dim</span> acadApp <span style="color: blue">As</span>&#160;<span style="color: blue">Object</span> = GetObject(, <span style="color: #a31515">&quot;Autocad.Application&quot;</span>)<br /><span style="color: green">' is it a Civil 3D? let's try!</span><br /><span style="color: blue">Dim</span> civilLandApp <span style="color: blue">As</span>&#160;<span style="color: blue">Object</span><br /><span style="color: blue">Try</span><br />&#160; <span style="color: green">' the 10.4 stands for 2015 release</span><br />&#160; civilLandApp = acadApp.GetInterfaceObject<br />                 (<span style="color: #a31515">&quot;AeccXUiLand.AeccApplication.10.4&quot;</span>)<br /><span style="color: blue">Catch</span> ex <span style="color: blue">As</span>&#160;<span style="color: #2b91af">Exception</span><br />&#160; <span style="color: blue">Return</span>&#160;<span style="color: green">' not Civil 3D</span><br /><span style="color: blue">End</span>&#160;<span style="color: blue">Try</span><br /> <br /><span style="color: green">' now we know is Civil 3D</span><br /><span style="color: green">' do something</span><br /></pre>
And in C# it’s basically the same, except that you need to decide whenever to use <strong><em>var </em></strong>or <strong><em>dynamic.</em></strong> The above code uses <strong><em>Object</em></strong>, that enables late-binding. If that is your option, then use the C# equivalent: <a href="https://msdn.microsoft.com/library/dd264736.aspx">dynamic</a>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Anton Huizinga
EMAIL: a.huizinga@gmail.com
IP: 82.95.108.202
URL: 
DATE: 03/24/2015 12:35:06 PM
You also could check for a valid Civil3D command to be available:

 internal static bool IsCivil3D() {
    if (!(Autodesk.AutoCAD.Internal.Utils.IsCommandNameInUse("AeccToolSpace") == Autodesk.AutoCAD.Internal.CommandTypeFlags.NoneCmd)) {
      return true;
    } else {
      return false;
    }
  } // function

-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 177.43.194.106
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 03/24/2015 12:38:12 PM
Anton,

That's a nice idea, thanks for sharing.

In fact your code will work in-process, but not for automation (e.g. driving AutoCAD or Civil 3D from an external application), unless you expose your idea through a COM Interface.

My post was not clear on the scenario: COM Automation

Thanks again!

Cheers,
Augusto Goncalves
-----
COMMENT:
AUTHOR: Rosario Dilo
EMAIL: topogis.ao@gmail.com
IP: 41.210.192.15
URL: 
DATE: 03/07/2017 06:55:40 AM
Hi, Augusto
Hi, iam trying to create a macro in AutoCAD Civil 3D using vba that asks me to select a general segment label (Feature is LWPOLYLINE) and after selects he shown me the  informations of
Side (Eg L1)
Start Easting
Start Northing
Segment Length
Azimuth
End Easting
End Northing


Waiting feedback
Regards
-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 179.157.86.231
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 03/07/2017 07:03:14 AM
Rosario, I would suggest you to post as a question on http://forums.autodesk.com/t5/autocad-civil-3d-customization/bd-p/190 

Regards,
Augusto Goncalves
-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Network Pipe/Structure data fields
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: network-pipestructure-data-fields
CATEGORY: .NET
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D 2015
CATEGORY: Civil 3D

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2015/03/network-pipestructure-data-fields.html 
DATE: 03/13/2015 03:45:23 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>Civil 3D has different ways to store custom data on different objects. On the specific case of Network Parts (Pipe or Structure), a user can store custom property values as described on <a href="http://beingcivil.typepad.com/my_weblog/2010/07/assigning-optional-properties-to-a-part-size.html">this blog post</a>. In this case, the information is stored under the <strong>Part.PartData</strong> property, that contains a list/array of <strong>PartDataField</strong> objects. An easy way to output this data is using the code below:</p>  <pre style="font-size: 13px; font-family: consolas; background: white; color: black">[<span style="color: #2b91af">CommandMethod</span>(<span style="color: #a31515">&quot;pipedatafield&quot;</span>)]<br /><span style="color: blue">public</span>&#160;<span style="color: blue">static</span>&#160;<span style="color: blue">void</span> CmdSelectPipe()<br />{<br />&#160; <span style="color: #2b91af">Editor</span> ed = <span style="color: #2b91af">Application</span>.DocumentManager.MdiActiveDocument.Editor;<br />&#160; <span style="color: #2b91af">PromptEntityOptions</span> peo = <span style="color: blue">new</span>&#160;<span style="color: #2b91af">PromptEntityOptions</span>(<span style="color: #a31515">&quot;\nSelect network part: &quot;</span>);<br />&#160; peo.SetRejectMessage(<span style="color: #a31515">&quot;\nOnly network parts&quot;</span>);<br />&#160; peo.AddAllowedClass(<span style="color: blue">typeof</span>(<span style="color: #2b91af">Part</span>), <span style="color: blue">false</span>);<br />&#160; <span style="color: #2b91af">PromptEntityResult</span> per = ed.GetEntity(peo);<br />&#160; <span style="color: blue">if</span> (per.Status != <span style="color: #2b91af">PromptStatus</span>.OK) <span style="color: blue">return</span>;<br />&#160; <span style="color: #2b91af">ObjectId</span> partId = per.ObjectId;<br /> <br />&#160; <span style="color: #2b91af">Database</span> db = <span style="color: #2b91af">Application</span>.DocumentManager.MdiActiveDocument.Database;<br />&#160; <span style="color: blue">using</span> (<span style="color: #2b91af">Transaction</span> trans = db.TransactionManager.StartTransaction())<br />&#160; {<br />&#160;&#160;&#160; <span style="color: #2b91af">Part</span> p = trans.GetObject(partId, <span style="color: #2b91af">OpenMode</span>.ForRead) <span style="color: blue">as</span>&#160;<span style="color: #2b91af">Part</span>;<br />&#160;&#160;&#160; <span style="color: #2b91af">PartDataField</span>[] fields = p.PartData.GetAllDataFields();<br />&#160;&#160;&#160; <span style="color: blue">foreach</span>(<span style="color: #2b91af">PartDataField</span> field <span style="color: blue">in</span> fields)<br />&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(<span style="color: #a31515">&quot;\n{0}: {1}&quot;</span>, field.Description, field.Value);<br />&#160;&#160;&#160; }<br />&#160; }<br />}</pre>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Formatting Stations with .NET Extension
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: formatting-stations-with-net-extension
CATEGORY: .NET
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D 2015

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2015/03/formatting-stations-with-net-extension.html 
DATE: 03/06/2015 06:35:38 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>Format stations like Civil 3D using, for instance, 3+1.00 for a number like 61.00, can be easy with .NET, and even more easier with .NET Extensions. Here it is: first define a module class that contains your utility functions, something like</p>  <pre style="font-size: 13px; font-family: consolas; background: white; color: black"><span style="color: blue">Public</span>&#160;<span style="color: blue">Module</span>&#160;<span style="color: #2b91af">Utils</span>&#160;&#160; &lt;System.Runtime.CompilerServices.<span style="color: #2b91af">Extension</span>()&gt;&#160;&#160; <span style="color: blue">Public</span>&#160;<span style="color: blue">Function</span> ToStationString(station <span style="color: blue">As</span>&#160;<span style="color: blue">Double</span>) <span style="color: blue">As</span>&#160;<span style="color: blue">String</span>&#160;&#160;&#160;&#160; <span style="color: blue">Dim</span> fractionPart <span style="color: blue">As</span>&#160;<span style="color: blue">Double</span> = station <span style="color: blue">Mod</span> 20<br />&#160;&#160;&#160; <span style="color: blue">Dim</span> integerPart <span style="color: blue">As</span>&#160;<span style="color: blue">Double</span> = (station - fractionPart) / 20<br />&#160;&#160;&#160; <span style="color: blue">Return</span>&#160;<span style="color: blue">String</span>.Format(<span style="color: #a31515">&quot;{0:0}+{1:0.00}&quot;</span>, integerPart, fractionPart)<br />&#160; <span style="color: blue">End</span>&#160;<span style="color: blue">Function</span><br /><span style="color: blue">End</span>&#160;<span style="color: blue">Module</span></pre>

<p>The above code assumes the distance between stations as 20 and, for simplicity, this number was hard coded. Note the Extension attribute that does the trick to add it for all doubles. Now we can use like:</p>

<pre style="font-size: 13px; font-family: consolas; background: white; color: black"><span style="color: blue">Dim</span> stationDouble <span style="color: blue">As</span>&#160;<span style="color: blue">Double</span> = <font color="#008000">' some number here</font>
<span style="color: blue">Dim</span> stationString <span style="color: blue">As</span>&#160;<span style="color: blue">String</span> = stationDouble.ToStationString()<br /></pre>

<p>Isn’t that nice? </p>

<p>Hope you enjoyed.</p>

<p>Important: this simple code is not taking Civil 3D styles into consideration, but can be a nice addition to it.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: initrd
EMAIL: 
IP: 37.210.140.249
URL: http://profile.typepad.com/6p01b7c7657c68970b
DATE: 03/18/2015 04:11:03 AM
How do i make use of the C3D station format, i.e. string to raw and raw to string for stations.

Where can i download the complete running code so i can test this code also. Thank you.
-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 177.43.194.106
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 03/18/2015 05:29:46 AM
Hi,

In fact this code is not intended to run as an independent project, but used whenever you need to write (output) station data. If is there any specific scenario, I can try something...

Regards,
Augusto Goncalves
-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Snoop now support multiple drawings
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: snoop-now-support-multiple-drawings
CATEGORY: .NET
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D 2015

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2015/02/snoop-now-support-multiple-drawings.html 
DATE: 02/27/2015 11:45:59 AM
-----
BODY:
<p>By Augusto Goncalves</p>
<p>Now you can open another drawing using the same instance of Civil 3D, directly from the Snoop interface. Thanks everyone for the feedback! Hope you enjoy it.</p>
<p>Download it from <a href="https://github.com/ADN-DevTech/Civil3DSnoop" target="_blank" title="Github">Github</a>.</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01bb07f99f7b970d-pi" style="display: inline;"><img alt="Captura de Tela 2015-02-27 às 16.39.57" border="0" class="asset  asset-image at-xid-6a0167607c2431970b01bb07f99f7b970d image-full img-responsive" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01bb07f99f7b970d-800wi" title="New button to select another file" /></a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Curved Pipe Geometry
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: curved-pipe-geometry

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2015/02/curved-pipe-geometry.html 
DATE: 02/09/2015 03:25:02 AM
-----
BODY:
<p>Just a quick note that catch my attention, in fact a recurrent question. If the Pipe is of type Curved, how can we access/read the geometry information?</p>
<p>In fact, there is a Pipe.Curve2d property will return a CircularArc2d, which has a Radius property, and some others, like Center. If you need a point as a specific position, try EvaluatePoint at a specific parameter of the curve, which is a BRep API from AutoCAD.</p>
<p>Pipe myPipe = // read the pipe<br />myPipe.Curve2d.EvaluatePoint(0.5); // middle of the arc, for instance</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Med
EMAIL: edh777@gmail.com
IP: 2.176.213.3
URL: 
DATE: 02/17/2015 10:23:17 AM
Hi,

[Civil3D]

I have question about setting targets for a new BaselineRegion. I think I am getting an error that I do not understand. The code sample is below:

if (newTargetInfo.TargetType == targetInfo.TargetType)
{
    newTargetInfo.TargetIds = targetInfo.TargetIds;
}

Surprisingly, the above code throws an argument exception, saying that the target id is not within the expected range. This happens when the TargetType is Elevation or Offset, and the single target ObjectId is FeatureLine. How can such exception occur to begin with, when we are checking TargetTypes to match? Even without that, for an Elevation or Offset TargetType, a FeatureLine must be a valid ObjectId.

Your help is gratefully appreciated!

-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 191.180.38.142
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 02/20/2015 10:10:43 AM
Med,

Sorry about the problems you're having...

About this specific case, the target ID can be set via UI? The API has the same restrictions as the UI.

As this question is not related to the post, the best route to get support is via forums.

Regards,
Augusto
-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Reading Network Part Description
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: reading-network-part-description
CATEGORY: .NET
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D 2015

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2015/01/reading-network-part-description.html 
DATE: 01/23/2015 11:03:23 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>If you try read the Pipe or Structure Description using the API, it will return the size information, which is not what we need. In fact that information is on the database, but we need to get it from the part family. The code below show how it can be done. Note the method signature for Extensions.</p>  <p>Here is the code:</p>  <pre style="font-size: 12px; font-family: consolas; background: white; color: black"><span style="color: blue">public</span>&#160;<span style="color: blue">static</span>&#160;<span style="color: blue">string</span> GetPartDescription(<span style="color: blue">this</span>&#160;<span style="color: #2b91af">Part</span> p)<br />{<br />&#160; <span style="color: blue">using</span> (<span style="color: #2b91af">Transaction</span> trans = p.Database.TransactionManager.StartTransaction())<br />&#160; {<br />&#160;&#160;&#160; <span style="color: green">// access the part (pipe or structure) network</span><br />&#160;&#160;&#160; <span style="color: #2b91af">Network</span> pipenetwork = trans.GetObject(p.NetworkId, <span style="color: #2b91af">OpenMode</span>.ForRead) <span style="color: blue">as</span>&#160;<span style="color: #2b91af">Network</span>;<br />&#160;&#160;&#160; <span style="color: green">// get the parts list of the network</span><br />&#160;&#160;&#160; <span style="color: #2b91af">PartsList</span> partsList = trans.GetObject(pipenetwork.PartsListId, <span style="color: #2b91af">OpenMode</span>.ForRead) <span style="color: blue">as</span>&#160;<span style="color: #2b91af">PartsList</span>;<br />&#160;&#160;&#160; <span style="color: green">// for each family on the parts list...</span><br />&#160;&#160;&#160; <span style="color: blue">for</span> (<span style="color: blue">int</span> f = 0; f &lt; partsList.PartFamilyCount; f++)<br />&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160; <span style="color: green">// ... get the information and...</span><br />&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">PartFamily</span> partFam = trans.GetObject(partsList[f], <span style="color: #2b91af">OpenMode</span>.ForRead) <span style="color: blue">as</span>&#160;<span style="color: #2b91af">PartFamily</span>;<br />&#160;&#160;&#160;&#160;&#160; <span style="color: green">// ... get all sizes and...</span><br />&#160;&#160;&#160;&#160;&#160; <span style="color: blue">for</span> (<span style="color: blue">int</span> s = 0; s &lt; partFam.PartSizeCount; s++)<br />&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// for each size, check if the name match</span><br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">PartSize</span> partSize = trans.GetObject(partFam[s], <span style="color: #2b91af">OpenMode</span>.ForRead) <span style="color: blue">as</span>&#160;<span style="color: #2b91af">PartSize</span>;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// if the name match, return the part family name </span><br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// which is the information we're looking for</span><br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> (partSize.Name.Equals(p.PartDescription)) <span style="color: blue">return</span> partFam.Name;<br />&#160;&#160;&#160;&#160;&#160; }<br />&#160;&#160;&#160; }<br />&#160; }<br />&#160; <span style="color: blue">return</span>&#160;<span style="color: blue">string</span>.Empty;<br />}</pre>

<p>That can be used like a property (thanks to .NET Extension mechanism):</p>

<pre style="font-size: 12px; font-family: consolas; background: white; color: black">[<span style="color: #2b91af">CommandMethod</span>(<span style="color: #a31515">&quot;showpartdesc&quot;</span>)]<br /><span style="color: blue">public</span>&#160;<span style="color: blue">static</span>&#160;<span style="color: blue">void</span> CmdShowPartDescription()<br />{<br />&#160; <span style="color: #2b91af">Editor</span> ed = <span style="color: #2b91af">Application</span>.DocumentManager.MdiActiveDocument.Editor;<br />&#160; <span style="color: #2b91af">PromptEntityOptions</span> peo = <span style="color: blue">new</span>&#160;<span style="color: #2b91af">PromptEntityOptions</span>(<span style="color: #a31515">&quot;\nSelect a pipe or structure: &quot;</span>);<br />&#160; peo.SetRejectMessage(<span style="color: #a31515">&quot;\nOnly pipes or structures&quot;</span>);<br />&#160; peo.AddAllowedClass(<span style="color: blue">typeof</span>(<span style="color: #2b91af">Part</span>), <span style="color: blue">false</span>);<br />&#160; <span style="color: #2b91af">PromptEntityResult</span> per = ed.GetEntity(peo);<br />&#160; <span style="color: blue">if</span> (per.Status != <span style="color: #2b91af">PromptStatus</span>.OK) <span style="color: blue">return</span>;<br /> <br />&#160; <span style="color: #2b91af">Database</span> db = <span style="color: #2b91af">Application</span>.DocumentManager.MdiActiveDocument.Database;<br />&#160; <span style="color: blue">using</span> (<span style="color: #2b91af">Transaction</span> trans = db.TransactionManager.StartTransaction())<br />&#160; {<br />&#160;&#160;&#160; <span style="color: #2b91af">Part</span> p = trans.GetObject(per.ObjectId, <span style="color: #2b91af">OpenMode</span>.ForRead) <span style="color: blue">as</span>&#160;<span style="color: #2b91af">Part</span>;<br />&#160;&#160;&#160; ed.WriteMessage(<span style="color: #a31515">&quot;\nPipe description: {0}&quot;</span>, p.GetPartDescription());<br />&#160; }<br />}</pre>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Madhukar Moogala
AUTHOR EMAIL: fpdtypepadadmin@autodesk.com
TITLE: There's still time ...
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: theres-still-time-
CATEGORY: Announcement
CATEGORY: Stephen Preston

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2015/01/theres-still-time-.html 
DATE: 01/05/2015 03:15:12 PM
-----
BODY:
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01bb07d2fbdc970d-pi" style="float: right;"><img alt="Cloud accelerator image" class="asset  asset-image at-xid-6a0167607c2431970b01bb07d2fbdc970d img-responsive" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01bb07d2fbdc970d-320wi" style="margin: 0px 0px 5px 5px;" title="Cloud accelerator image" /></a>Happy New Year!</p>
<p>There&#39;s still time to make one more New Year&#39;s Resolution - to submit a proposal for the inaugural Autodesk Cloud Accelerator program.</p>
<p>Don&#39;t miss this opportunity to spend two weeks in sunny San Francisco integrating Autodesk cloud services with your application with the help of Autodesk experts.</p>
<p>Visit the program website to find out more - <a href="http://autodeskcloudaccelerator.com" target="_blank">autodeskcloudaccelerator.com</a>.</p>
<p>&#0160;</p>
<p>&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Change surface style with Civil 3D API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: change-surface-style-with-civil-3d-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2014
CATEGORY: AutoCAD Civil 3D 2015
CATEGORY: Civil 3D
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2014/12/change-surface-style-with-civil-3d-api.html 
DATE: 12/29/2014 03:43:05 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>I was asked how to edit the style of surface in Civil 3D, for example, we need to change the color of contours. We can do it with Civil 3D UI by right clicking the surface object and choose “Edit surface style…” and switching to “Display” tab to show the dialogue as below:</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d0b3430a970c-pi"><img title="image" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; display: inline; border-top-width: 0px" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d0b3430e970c-pi" width="452" height="362" /></a> </p>  <p>This is code snippet demonstrating how to do it with API:</p>  <pre style="font-size: 13px; font-family: consolas; background: white; color: black">[<span style="color: #2b91af">CommandMethod</span>(<span style="color: #a31515">&quot;MyGroup&quot;</span>, <span style="color: #a31515">&quot;SurfaceStyleExample&quot;</span>, <br />&#160;&#160;&#160; <span style="color: #a31515">&quot;SurfaceStyleExample&quot;</span>, <span style="color: #2b91af">CommandFlags</span>.Modal)]<br /><span style="color: blue">public</span>&#160;<span style="color: blue">void</span> MyCommand() <span style="color: green">// This method can have any name</span><br />{<br />&#160;<br />&#160;&#160;&#160; <span style="color: #2b91af">Document</span> doc = <span style="color: #2b91af">Application</span>.DocumentManager.MdiActiveDocument;<br />&#160;&#160;&#160; <br />&#160;&#160;&#160; <span style="color: blue">if</span> (doc != <span style="color: blue">null</span>)<br />&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">Editor</span> ed = <span style="color: #2b91af">Application</span>.DocumentManager<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; .MdiActiveDocument.Editor;<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// select a tin surface</span><br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">PromptEntityOptions</span> peo = <span style="color: blue">new</span>&#160;<span style="color: #2b91af">PromptEntityOptions</span>(<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #a31515">&quot;\nSelect a tin surface: &quot;</span>);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; peo.SetRejectMessage(<span style="color: #a31515">&quot;\nOnly Tin surface is accepted&quot;</span>);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; peo.AddAllowedClass(<span style="color: blue">typeof</span>(<span style="color: #2b91af">TinSurface</span>), <span style="color: blue">true</span>);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">PromptEntityResult</span> per = ed.GetEntity(peo);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> (per.Status != <span style="color: #2b91af">PromptStatus</span>.OK) <span style="color: blue">return</span>;<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">CivilDocument</span> civilDoc = <span style="color: #2b91af">CivilApplication</span>.ActiveDocument;<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">using</span> (<span style="color: #2b91af">Transaction</span> trans = doc.TransactionManager<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; .StartTransaction())<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">TinSurface</span> surface = trans.GetObject(per.ObjectId, <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">OpenMode</span>.ForRead) <span style="color: blue">as</span>&#160;<span style="color: #2b91af">TinSurface</span>;<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">//exclude invalid points</span><br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; surface.BuildOptions.ExecludeMaximumElevation = <span style="color: blue">true</span>;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; surface.BuildOptions.MaximumElevation = 5000;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; surface.BuildOptions.ExecludeMinimumElevation = <span style="color: blue">true</span>;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; surface.BuildOptions.MinimumElevation = 200;<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">//set the Maximum Triangle Length</span><br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; surface.BuildOptions.MaximumTriangleLength = 200;<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">//change the style</span><br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">ObjectId</span> styleId;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> (civilDoc.Styles.SurfaceStyles.Contains(<span style="color: #a31515">&quot;Standard&quot;</span>))<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; styleId = civilDoc.Styles.SurfaceStyles[<span style="color: #a31515">&quot;Standard&quot;</span>];<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">else</span><br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// create a new style called 'example style':</span><br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; styleId = civilDoc.Styles.SurfaceStyles<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; .Add(<span style="color: #a31515">&quot;example style&quot;</span>);<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// modify the style</span><br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">SurfaceStyle</span> surfaceStyle = styleId.GetObject(<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">OpenMode</span>.ForWrite) <span style="color: blue">as</span>&#160;<span style="color: #2b91af">SurfaceStyle</span>;<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">//countours smoothing </span><br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; surfaceStyle.ContourStyle.SmoothContours = <span style="color: blue">true</span>;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; surfaceStyle.ContourStyle.SmoothingType <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; = <span style="color: #2b91af">ContourSmoothingType</span>.AddVertices;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; surfaceStyle.ContourStyle.SmoothingFactor = 10;<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; surfaceStyle.ContourStyle.MajorContourColorScheme <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; = <span style="color: #2b91af">ColorSchemeType</span>.Rainbow;<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">//Major contour, red</span><br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; surfaceStyle.GetDisplayStylePlan(<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">SurfaceDisplayStyleType</span>.MajorContour).Color <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; = Autodesk.AutoCAD.Colors.<span style="color: #2b91af">Color</span>.FromRgb(255, 0, 0);<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">//Major contour, layer 0</span><br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; surfaceStyle.GetDisplayStylePlan(<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">SurfaceDisplayStyleType</span>.MajorContour).Layer = <span style="color: #a31515">&quot;0&quot;</span>;<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">//Mainor contour, gree</span><br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; surfaceStyle.GetDisplayStylePlan(<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">SurfaceDisplayStyleType</span>.MinorContour).Color <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; = Autodesk.AutoCAD.Colors.<span style="color: #2b91af">Color</span>.FromRgb(0, 255, 0);<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">//Mainor contour, layer 0</span><br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; surfaceStyle.GetDisplayStylePlan(<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">SurfaceDisplayStyleType</span>.MajorContour).Layer = <span style="color: #a31515">&quot;0&quot;</span>;<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// display major contours:</span><br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; surfaceStyle.GetDisplayStylePlan(<span style="color: #2b91af">SurfaceDisplayStyleType</span><br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; .MajorContour).Visible = <span style="color: blue">true</span>;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; surfaceStyle.GetDisplayStylePlan(<span style="color: #2b91af">SurfaceDisplayStyleType</span><br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; .MinorContour).Visible = <span style="color: blue">true</span>;<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// turn off display of other items:</span><br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; surfaceStyle.GetDisplayStylePlan(<span style="color: #2b91af">SurfaceDisplayStyleType</span><br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; .UserContours).Visible = <span style="color: blue">false</span>;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; surfaceStyle.GetDisplayStylePlan(<span style="color: #2b91af">SurfaceDisplayStyleType</span><br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; .Directions).Visible = <span style="color: blue">false</span>;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; surfaceStyle.GetDisplayStylePlan(<span style="color: #2b91af">SurfaceDisplayStyleType</span><br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; .Elevations).Visible = <span style="color: blue">false</span>;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; surfaceStyle.GetDisplayStylePlan(<span style="color: #2b91af">SurfaceDisplayStyleType</span><br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; .Slopes).Visible = <span style="color: blue">false</span>;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; surfaceStyle.GetDisplayStylePlan(<span style="color: #2b91af">SurfaceDisplayStyleType</span><br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; .SlopeArrows).Visible = <span style="color: blue">false</span>;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; surfaceStyle.GetDisplayStylePlan(<span style="color: #2b91af">SurfaceDisplayStyleType</span><br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; .Watersheds).Visible = <span style="color: blue">false</span>;<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">//TODO: do the same for all model display settings as well</span><br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">//</span><br /> <br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// assign the style to the first surface in the document:</span><br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; surface.StyleId = styleId;<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// commit the transaction</span><br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; trans.Commit();<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">//rebuild the surface </span><br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; surface.Rebuild();<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br /> <br />&#160;&#160;&#160; }<br /> <br /> <br /> <br />}<br /></pre>

<p>&#160;</p>

<p>This is how it looks like before editing:</p>

<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d0b34312970c-pi"><img title="image" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; display: inline; border-top-width: 0px" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01bb07cdceb4970d-pi" width="396" height="320" /></a> </p>

<p>And here is how it looks like after editing the surface contour style with major contour color to red and monor contour color to green. </p>

<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01bb07cdcebe970d-pi"><img title="image" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; display: inline; border-top-width: 0px" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01bb07cdcec6970d-pi" width="404" height="332" /></a> </p>

<p></p>

<p></p>

<p>Hope this helps.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Running built-in property commands on Civil 3D
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: running-built-in-property-commands-on-civil-3d
CATEGORY: .NET
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D 2015

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2014/11/running-built-in-property-commands-on-civil-3d.html 
DATE: 11/21/2014 07:44:15 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>In some cases we just want to invocate Civil 3D property dialogs for specific entities, let’s say an Alignment. But most commands are not customizable via APIs. Here the alternative idea is set the selection and then call the command. The following code uses AutoCAD Editor.Command API, available on 2015+</p>  <pre style="font-size: 12px; font-family: consolas; background: white; color: black"><span style="color: blue">private</span>&#160;<span style="color: blue">static</span>&#160;<span style="color: blue">void</span> ShowAlignProp(ObjectId id)<br />{<br />&#160; <span style="color: green">// test type as this command will not work for other types</span><br />&#160; <span style="color: blue">if</span> (id.ObjectClass != <span style="color: #2b91af">RXClass</span>.GetClass(<span style="color: blue">typeof</span>(<span style="color: #2b91af">Alignment</span>))) <span style="color: blue">return</span>;<br /> <br />&#160; <span style="color: #2b91af">Editor</span> ed = <span style="color: #2b91af">Application</span>.DocumentManager.MdiActiveDocument.Editor;<br />&#160; ed.SetImpliedSelection(<span style="color: blue">new</span> ObjectId[] { id }); <span style="color: green">// set selection</span><br />&#160; ed.Command(<span style="color: blue">new</span>&#160;<span style="color: blue">string</span>[] { <span style="color: #a31515">&quot;_AeccEditAlignmentProperties&quot;</span> }); <span style="color: green">// run command</span><br />&#160; ed.SetImpliedSelection(<span style="color: blue">new</span> ObjectId[0]); <span style="color: green">// clear selection</span><br />}</pre>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Valeria  Klimenko
EMAIL: 
IP: 78.152.183.138
URL: http://profile.typepad.com/6p01bb07d809f3970d
DATE: 01/12/2015 01:56:19 AM
Hi, Augusto
would you please help me to solve the following issue?

I am developing a plug-in for AutoCAD Civil 3D 2015 on .NET C#. https://www.youtube.com/watch?v=Xmcz4kZDTx4&feature=youtu.be

This plugin is used for export 3d objects to Google earth. With help of Brep i get all information about 3d objects and write it to Collada. During the export plug-in works without errors, even with a lot of 3d objects. I dispose unused objects and use the "using" statement. But after exiting Civil 3d, occurs an error. 
http://dl2.joxi.net/drive/0006/2797/457453/150109/a1c3898e0a.jpg 
Problem signature:
Problem Event Name: APPCRASH
Application Name: acad.exe
Application Version: 26.0.51.0
Application Timestamp: 52f4adcc
Fault Module Name: accore.dll
Fault Module Version: 20.0.51.0
Fault Module Timestamp: 52f4ae8b
Exception Code: c0000005
Exception Offset: 00000000006d9cef
OS Version: 6.1.7601.2.1.0.256.48
Locale ID: 1033
Additional Information 1: 59bc
Additional Information 2: 59bc2f24ac83312559015d6dcf3c387a
Additional Information 3: 2949
Additional Information 4: 2949d7b14d7a156deca638281aa20dfa

As i have understood it is Access Violation Exception, that throws when we try to access the objects that are disposed..
This error occurs just after working with a large objects or with a lot of objects (not when closing a drawing, but when exiting the Civil)

Here is some dumpdata... http://dl1.joxi.net/drive/0006/2797/457453/150109/90a47db9d6.jpg 
How can I fix this problem, has you any ideas?
Any help would be appreciated!
-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 177.43.194.106
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 01/12/2015 04:29:49 AM
Hi Valeria,

This is a tricky problem. As you mentioned, it's probably related to reading data from a invalid object... 

Please do the following: run your code again and, when the problem happens, submit the error report with your email, I'll track from here.

Also, as this question is not related to this blog post, please log at our forum, we'll have a better tool to talk there: http://forums.autodesk.com/t5/autocad-civil-3d-customization/bd-p/190

Thanks!

Regards,
Augusto Goncalves
-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Understanding Civil 3D labels and features
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: understanding-civil-3d-labels-and-features
CATEGORY: .NET
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D 2015

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2014/11/understanding-civil-3d-labels-and-features.html 
DATE: 11/14/2014 08:52:28 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>Civil 3D uses a base class <strong>LabelBase</strong> to handle labels and the features that it’s being labeled. This is done using the <strong>FeatureId</strong> property, which is available for all labels. The following code show a generic approach for this.</p>  <pre style="font-size: 12px; font-family: consolas; background: white; color: black">[<span style="color: #2b91af">CommandMethod</span>(<span style="color: #a31515">&quot;testReadLabelFeature&quot;</span>)]<br /><span style="color: blue">public</span>&#160;<span style="color: blue">void</span> CmdReadLabelFeature()<br />{<br />&#160; <span style="color: #2b91af">Database</span> db = <span style="color: #2b91af">Application</span>.DocumentManager.MdiActiveDocument.Database;<br />&#160; <span style="color: #2b91af">Editor</span> ed = <span style="color: #2b91af">Application</span>.DocumentManager.MdiActiveDocument.Editor;<br /> <br />&#160; <span style="color: #2b91af">PromptEntityOptions</span> peo = <span style="color: blue">new</span>&#160;<span style="color: #2b91af">PromptEntityOptions</span>(<span style="color: #a31515">&quot;\nSelect a label: &quot;</span>);<br />&#160; peo.SetRejectMessage(<span style="color: #a31515">&quot;\nPlease select a Label, try again.&quot;</span>);<br />&#160; peo.AddAllowedClass(<span style="color: blue">typeof</span>(<span style="color: #2b91af">LabelBase</span>), <span style="color: blue">true</span>);<br />&#160; <span style="color: #2b91af">PromptEntityResult</span> per = ed.GetEntity(peo);<br />&#160; <span style="color: blue">if</span> (per.Status != <span style="color: #2b91af">PromptStatus</span>.OK) <span style="color: blue">return</span>;<br /> <br />&#160; <span style="color: blue">using</span> (<span style="color: #2b91af">Transaction</span> tr = db.TransactionManager.StartTransaction())<br />&#160; {<br />&#160;&#160;&#160; <span style="color: green">// open the label</span><br />&#160;&#160;&#160; <span style="color: #2b91af">LabelBase</span> genericLabel = tr.GetObject(per.ObjectId, <br />&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">OpenMode</span>.ForRead) <span style="color: blue">as</span>&#160;<span style="color: #2b91af">LabelBase</span>;<br /> <br />&#160;&#160;&#160; <span style="color: green">// open the entity that this label points to</span><br />&#160;&#160;&#160; Autodesk.AutoCAD.DatabaseServices.<span style="color: #2b91af">Entity</span> featureEnt = tr.GetObject(<br />&#160;&#160;&#160;&#160;&#160; genericLabel.FeatureId, <span style="color: #2b91af">OpenMode</span>.ForRead) <br />&#160;&#160;&#160;&#160;&#160; <span style="color: blue">as</span> Autodesk.AutoCAD.DatabaseServices.<span style="color: #2b91af">Entity</span>;<br /> <br />&#160;&#160;&#160; <span style="color: blue">if</span> (featureEnt != <span style="color: blue">null</span>)<br />&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160; <span style="color: green">// now we know this label points to an entity... </span><br />&#160;&#160;&#160;&#160;&#160; <span style="color: green">// is it the one we need?</span><br />&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> (featureEnt <span style="color: blue">is</span>&#160;<span style="color: #2b91af">Pipe</span>)<br />&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// is a Pipe, can do something related to PipeLabel</span><br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">PipeLabel</span> pipeLabel = genericLabel <span style="color: blue">as</span>&#160;<span style="color: #2b91af">PipeLabel</span>;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">Pipe</span> pipe = featureEnt <span style="color: blue">as</span>&#160;<span style="color: #2b91af">Pipe</span>;<br />&#160;&#160;&#160;&#160;&#160; }<br />&#160;&#160;&#160; }<br />&#160;&#160;&#160; <span style="color: blue">else</span><br />&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160; <span style="color: green">// make a test to ensure is valid</span><br />&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(<span style="color: #a31515">&quot;\nThis label is not linked to an entity. Sorry&quot;</span>);<br />&#160;&#160;&#160; }<br />&#160;&#160;&#160; tr.Commit();<br />&#160; }<br />}</pre>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Infraworks 360 REST API at Autodesk University
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: infraworks-360-rest-api-at-autodesk-university
CATEGORY: Augusto Goncalves

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2014/11/infraworks-360-rest-api-at-autodesk-university.html 
DATE: 11/11/2014 08:00:00 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d090a24a970c-pi"><img title="DSCN0253" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="DSCN0253" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01bb07abea16970d-pi" width="473" height="356" /></a> </p>  <p>Are you attending <a href="http://au.autodesk.com/">Autodesk University</a> in Las Vegas? Great! Want to learn more about Infraworks 360 REST API? Then don’t miss my class!</p>  <p><a href="https://events.au.autodesk.com/connect/sessionDetail.ww?SESSION_ID=6503">SD6503 - Introducing the InfraWorks 360 API</a></p>  <p><em>This class will guide you through the new, exciting, cloud-based API for InfraWorks 360 software. We will cover how to get started and extract data from the model, how to generate report from the extracted information, and how to integrate with other providers—all by reading InfraWorks 360 software models using the REST API. Previous programming knowledge is required (Microsoft C# and Microsoft .NET), and knowledge of REST and the JavaScript API is recommended.</em></p>  <p>See you in Vegas!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Greg Schleusner
EMAIL: greg.schleusner@hok.com
IP: 173.77.208.21
URL: http://HOK.com
DATE: 01/09/2015 10:36:57 AM
Hi,

Is it possible to cal model builder from the API to externally create the project in the first place?
-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 177.43.194.106
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 01/12/2015 04:24:04 AM
Hi Greg,

Unfortunately no, this feature is available on the product (UI) only.

Regards,
Augusto Goncalves
-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Doing some math to create SurfaceContourLabelGroup
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: doing-some-math-to-create-surfacecontourlabelgroup
CATEGORY: .NET
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D 2015

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2014/11/doing-some-math-to-create-surfacecontourlabelgroup.html 
DATE: 11/07/2014 12:18:19 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>I’m always amazed how AutoCAD Geometry namespace can be used to perform some vector based math very easy. On this post, the goal is get all contours lines from a Tin Surface and create label group object on each of them. </p>  <p>The main point is the <strong>SurfaceContourLabelGroup.Create</strong> method requires a list of points. Why? Because you can pass a sequence of points where Civil 3D will draw a line (or polyline) and every time it crosses (intersect) a contour, will add a label.</p>  <p>Just like in the UI, we can add this SurfaceContourLabelGroup object for each contour line but, just like in the UI, we need a small line that cross the contour line. Here is where the math enters: get a point at the middle of a contour line, get the first derivative vector (that points on the direction of the contour line), rotate by +90 and by -90 degrees, finally convert to a unit vector (to make it small enough) and add on both direction to the original point on the contour line. And with that we have the 2 points we need. </p>  <pre style="font-size: 12px; font-family: consolas; background: white; color: black">[<span style="color: #2b91af">CommandMethod</span>(<span style="color: #a31515">&quot;testAddLabelContour&quot;</span>)]<br /><span style="color: blue">public</span>&#160;<span style="color: blue">static</span>&#160;<span style="color: blue">void</span> CmdAddLabelAtContour()<br />{<br />&#160; <span style="color: #2b91af">Editor</span> ed = <span style="color: #2b91af">Application</span>.DocumentManager.MdiActiveDocument.Editor;<br /> <br />&#160; <span style="color: green">// select a tin surface</span><br />&#160; <span style="color: #2b91af">PromptEntityOptions</span> peo = <span style="color: blue">new</span>&#160;<span style="color: #2b91af">PromptEntityOptions</span>(<br />&#160;&#160;&#160; <span style="color: #a31515">&quot;\nSelect a tin surface: &quot;</span>);<br />&#160; peo.SetRejectMessage(<span style="color: #a31515">&quot;\nOnly surface&quot;</span>);<br />&#160; peo.AddAllowedClass(<span style="color: blue">typeof</span>(<span style="color: #2b91af">TinSurface</span>), <span style="color: blue">true</span>);<br />&#160; <span style="color: #2b91af">PromptEntityResult</span> per = ed.GetEntity(peo);<br />&#160; <span style="color: blue">if</span> (per.Status != <span style="color: #2b91af">PromptStatus</span>.OK) <span style="color: blue">return</span>;<br /> <br />&#160; AddLabelAtContours(per.ObjectId);<br />}<br /> <br /><span style="color: blue">private</span>&#160;<span style="color: blue">static</span>&#160;<span style="color: blue">void</span> AddLabelAtContours(ObjectId surfaceId)<br />{<br />&#160; <span style="color: #2b91af">Database</span> db = <span style="color: #2b91af">Application</span>.DocumentManager.MdiActiveDocument.Database;<br />&#160; <span style="color: #2b91af">CivilDocument</span> civilDoc = <span style="color: #2b91af">CivilApplication</span>.ActiveDocument;<br />&#160; <span style="color: blue">using</span> (<span style="color: #2b91af">Transaction</span> trans = db.TransactionManager.StartTransaction())<br />&#160; {<br />&#160;&#160;&#160; <span style="color: #2b91af">TinSurface</span> surface = trans.GetObject(surfaceId,<br />&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">OpenMode</span>.ForRead) <span style="color: blue">as</span>&#160;<span style="color: #2b91af">TinSurface</span>;<br /> <br />&#160;&#160;&#160; <span style="color: green">// finally call our custom method to add labels</span><br />&#160;&#160;&#160; <span style="color: green">// on each polyline extracted from the surface</span><br />&#160;&#160;&#160; AddContoursLabels(surfaceId,<br />&#160;&#160;&#160;&#160;&#160; surface.ExtractMajorContours(<span style="color: #2b91af">SurfaceExtractionSettingsType</span>.Plan));<br />&#160;&#160;&#160; AddContoursLabels(surfaceId,<br />&#160;&#160;&#160;&#160;&#160; surface.ExtractMinorContours(<span style="color: #2b91af">SurfaceExtractionSettingsType</span>.Plan));<br /> <br />&#160;&#160;&#160; trans.Commit();<br />&#160; }<br />}<br /> <br /><span style="color: blue">private</span>&#160;<span style="color: blue">static</span>&#160;<span style="color: blue">void</span> AddContoursLabels(ObjectId surfaceId,<br />&#160; <span style="color: #2b91af">ObjectIdCollection</span> contourIds)<br />{<br />&#160; <span style="color: blue">for</span> (<span style="color: blue">int</span> i = 0; i &lt; contourIds.Count; i++)<br />&#160; {<br />&#160;&#160;&#160; ObjectId contourId = contourIds[i];<br />&#160;&#160;&#160; <span style="color: green">// Contours are lightweight Polyline objects:</span><br />&#160;&#160;&#160; <span style="color: #2b91af">Polyline</span> contour = contourId.GetObject(<span style="color: #2b91af">OpenMode</span>.ForWrite) <span style="color: blue">as</span>&#160;<span style="color: #2b91af">Polyline</span>;<br />&#160;&#160;&#160; <span style="color: green">// get a point at the middle of the pline</span><br />&#160;&#160;&#160; Point3d pointOnContour = contour.GetPointAtParameter(0.5);<br />&#160;&#160;&#160; <span style="color: green">// get the first derivative on this point</span><br />&#160;&#160;&#160; Vector3d firstDerivative = contour.GetFirstDerivative(pointOnContour);<br />&#160;&#160;&#160; <span style="color: green">// now do some math to get one point on each side, not far</span><br />&#160;&#160;&#160; <span style="color: green">// than 0.5 units...</span><br />&#160;&#160;&#160; Point3d leftPoint = pointOnContour<br />&#160;&#160;&#160;&#160;&#160; .Add(firstDerivative.RotateBy(<span style="color: #2b91af">Math</span>.PI / 2, Vector3d.ZAxis) <span style="color: green">// rotate 90o</span><br />&#160;&#160;&#160;&#160;&#160; .DivideBy(firstDerivative.Length) <span style="color: green">// make unit vector</span><br />&#160;&#160;&#160;&#160;&#160; .MultiplyBy(0.5)); <span style="color: green">// size 0.5</span><br />&#160;&#160;&#160; Point3d rightPoint = pointOnContour<br />&#160;&#160;&#160;&#160;&#160; .Add(firstDerivative.RotateBy(-<span style="color: #2b91af">Math</span>.PI / 2, Vector3d.ZAxis) <span style="color: green">// rotate -90o</span><br />&#160;&#160;&#160;&#160;&#160; .DivideBy(firstDerivative.Length) <span style="color: green">// make unit vector</span><br />&#160;&#160;&#160;&#160;&#160; .MultiplyBy(0.5)); <span style="color: green">// size 0.5</span><br /> <br />&#160;&#160;&#160; <span style="color: green">// create a list of points</span><br />&#160;&#160;&#160; <span style="color: #2b91af">Point2dCollection</span> points = <span style="color: blue">new</span>&#160;<span style="color: #2b91af">Point2dCollection</span>();<br />&#160;&#160;&#160; points.Add(leftPoint.Convert2d(<span style="color: blue">new</span>&#160;<span style="color: #2b91af">Plane</span>()));<br />&#160;&#160;&#160; points.Add(rightPoint.Convert2d(<span style="color: blue">new</span>&#160;<span style="color: #2b91af">Plane</span>()));<br /> <br />&#160;&#160;&#160; <span style="color: green">// and create the label group</span><br />&#160;&#160;&#160; <span style="color: #2b91af">SurfaceContourLabelGroup</span>.Create(surfaceId, points);<br /> <br />&#160;&#160;&#160; <span style="color: green">// and erase the pline (don't need anymore...)</span><br />&#160;&#160;&#160; contour.Erase();<br />&#160; }<br />}</pre>

<p>As a result, a label is added at the middle (parameter 0.5) of each contour line (major and minor).</p>

<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b7c7027520970b-pi"><img title="contours_labels" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="contours_labels" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01bb07a7aa95970d-pi" width="379" height="354" /></a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Alignment Sample Line Intersection
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: alignment-sample-line-intersection
CATEGORY: .NET
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D 2015

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2014/10/alignment-sample-line-intersection.html 
DATE: 10/31/2014 07:58:00 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>This question came from <a href="http://www.maubertec.com.br">Grace Ferrari</a>: from a given alignment (e.g. Alignment 01) with sample lines, how can I find the intersection of each sample line on another alignment (e.g. Alignment 02). The image below show the scenario, thanks Grace for sharing the image.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d087ea55970c-pi"><img title="Explanation" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; display: inline; border-top-width: 0px" border="0" alt="Explanation" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01bb07a31f4b970d-pi" width="482" height="301" /></a> </p>  <p>To implement this I decided to try something that I was willing to understand for a while: custom <em>foreach</em> on .NET. Also, we need to use Extensions to make it fun.</p>  <p>The first piece is quite straight forward: select both alignments and open them for read. Also, draw AutoCAD DBPoints (plain points) at each intersection. Below is the code.</p>  <pre style="font-size: 12px; font-family: consolas; background: white; color: black">[<span style="color: #2b91af">CommandMethod</span>(<span style="color: #a31515">&quot;testDrawPointsIntersection&quot;</span>)]<br /><span style="color: blue">public</span>&#160;<span style="color: blue">static</span>&#160;<span style="color: blue">void</span> CmdDrawPointsOnIntersection()<br />{<br />&#160; <span style="color: #2b91af">Editor</span> ed = <span style="color: #2b91af">Application</span>.DocumentManager.MdiActiveDocument.Editor;<br /> <br />&#160; <span style="color: green">// select reference alignment</span><br />&#160; <span style="color: green">// this is the alignment with sample lines</span><br />&#160; <span style="color: green">// (for simplicity, this condition is not verified)</span><br />&#160; <span style="color: #2b91af">PromptEntityOptions</span> peo = <span style="color: blue">new</span>&#160;<span style="color: #2b91af">PromptEntityOptions</span>(<br />&#160;&#160;&#160; <span style="color: #a31515">&quot;\nSelect reference alignment (with sample lines): &quot;</span>);<br />&#160; peo.SetRejectMessage(<span style="color: #a31515">&quot;\nOnly alignments&quot;</span>);<br />&#160; peo.AddAllowedClass(<span style="color: blue">typeof</span>(<span style="color: #2b91af">Alignment</span>), <span style="color: blue">true</span>);<br />&#160; <span style="color: #2b91af">PromptEntityResult</span> per = ed.GetEntity(peo);<br />&#160; <span style="color: blue">if</span> (per.Status != <span style="color: #2b91af">PromptStatus</span>.OK) <span style="color: blue">return</span>;<br />&#160; ObjectId sourceAlignId = per.ObjectId;<br /> <br />&#160; <span style="color: green">// now select the other alignment</span><br />&#160; peo.Message = <span style="color: #a31515">&quot;\nSelect the other alignment: &quot;</span>;<br />&#160; per = ed.GetEntity(peo);<br />&#160; ObjectId otherAlignId = per.ObjectId;<br /> <br />&#160; DrawPointOnSampleLineIntersection(sourceAlignId, otherAlignId);<br />}<br /> <br /><span style="color: blue">public</span>&#160;<span style="color: blue">static</span>&#160;<span style="color: blue">void</span> DrawPointOnSampleLineIntersection(<br />&#160; ObjectId sourceAlignId, ObjectId otherAlignId)<br />{<br />&#160; <span style="color: #2b91af">Database</span> db = <span style="color: #2b91af">Application</span>.DocumentManager.MdiActiveDocument.Database;<br />&#160; <span style="color: #2b91af">CivilDocument</span> civilDoc = <span style="color: #2b91af">CivilApplication</span>.ActiveDocument;<br />&#160; <span style="color: blue">using</span> (<span style="color: #2b91af">Transaction</span> trans = db.TransactionManager.StartTransaction())<br />&#160; {<br />&#160;&#160;&#160; <span style="color: green">// open both alignments</span><br />&#160;&#160;&#160; <span style="color: #2b91af">Alignment</span> sourceAlign = trans.GetObject(sourceAlignId, <span style="color: #2b91af">OpenMode</span>.ForRead) <span style="color: blue">as</span>&#160;<span style="color: #2b91af">Alignment</span>;<br />&#160;&#160;&#160; <span style="color: #2b91af">Alignment</span> otherAlign = trans.GetObject(otherAlignId, <span style="color: #2b91af">OpenMode</span>.ForRead) <span style="color: blue">as</span>&#160;<span style="color: #2b91af">Alignment</span>;<br /> <br />&#160;&#160;&#160; <span style="color: green">// open model space (i.e. current space)</span><br />&#160;&#160;&#160; <span style="color: #2b91af">BlockTableRecord</span> mSpace = trans.GetObject(db.CurrentSpaceId,<br />&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">OpenMode</span>.ForWrite) <span style="color: blue">as</span>&#160;<span style="color: #2b91af">BlockTableRecord</span>;<br />&#160;&#160;&#160; <span style="color: blue">foreach</span> (Point3d point <span style="color: blue">in</span> sourceAlign.<strong><span style="background-color: #ffff00">SampleLinesIntersectionWith(otherAlign)</span></strong>)<br />&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160; <span style="color: green">// point AutoCAD plain points</span><br />&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">DBPoint</span> newPoint = <span style="color: blue">new</span>&#160;<span style="color: #2b91af">DBPoint</span>(point);<br />&#160;&#160;&#160;&#160;&#160; mSpace.AppendEntity(newPoint);<br />&#160;&#160;&#160;&#160;&#160; trans.AddNewlyCreatedDBObject(newPoint, <span style="color: blue">true</span>);<br />&#160;&#160;&#160; }<br />&#160;&#160;&#160; trans.Commit();<br />&#160; }<br />}</pre>

<p>And now you might wonder: where this <em>SampleLinesIntersectionWith</em> method came from? This is actually a <a href="http://msdn.microsoft.com/en-us/library/bb383977.aspx">extension on .NET</a>. To have this, we need a <em>static public</em> class in C#. We made a <a href="http://adndevblog.typepad.com/autocad/2012/05/extension-methods-in-autocad-2013.html">cool article on this</a>. </p>

<p>Below is the extension class. Note the <em>this</em> on the first parameter, indicating the objects where this extension is applicable.</p>

<pre style="font-size: 12px; font-family: consolas; background: white; color: black"><span style="color: blue">using</span> System;<br /><span style="color: blue">using</span> System.Collections.Generic;<br /><span style="color: blue">using</span> Autodesk.AutoCAD.DatabaseServices;<br /><span style="color: blue">using</span> Autodesk.AutoCAD.Geometry;<br /><span style="color: blue">using</span> Autodesk.Civil.DatabaseServices;<br /> <br /><span style="color: blue">namespace</span> MyProjectName<br />{<br />&#160; <span style="color: blue">public</span>&#160;<span style="color: blue">static</span>&#160;<span style="color: blue">class</span>&#160;<span style="color: #2b91af">Extensions</span><br />&#160; {<br />&#160;&#160;&#160; <span style="color: gray">///</span><span style="color: green">&#160;</span><span style="color: gray">&lt;summary&gt;</span><br />&#160;&#160;&#160; <span style="color: gray">///</span><span style="color: green"> Interate on the collection of intersection points</span><br />&#160;&#160;&#160; <span style="color: gray">///</span><span style="color: green"> from this alignment sample lines on the other alignment</span><br />&#160;&#160;&#160; <span style="color: gray">///</span><span style="color: green">&#160;</span><span style="color: gray">&lt;/summary&gt;</span><br />&#160;&#160;&#160; <span style="color: gray">///</span><span style="color: green">&#160;</span><span style="color: gray">&lt;param name=</span><span style="color: gray">&quot;source&quot;</span><span style="color: gray">&gt;</span><span style="color: green">This base/reference alignment</span><span style="color: gray">&lt;/param&gt;</span><br />&#160;&#160;&#160; <span style="color: gray">///</span><span style="color: green">&#160;</span><span style="color: gray">&lt;param name=</span><span style="color: gray">&quot;other&quot;</span><span style="color: gray">&gt;</span><span style="color: green">Other alignment</span><span style="color: gray">&lt;/param&gt;</span><br />&#160;&#160;&#160; <span style="color: blue">public</span>&#160;<span style="color: blue">static</span>&#160;<span style="color: #2b91af">IEnumerable</span>&lt;Point3d&gt; SampleLinesIntersectionWith(<br />&#160;&#160;&#160;&#160;&#160; <span style="color: blue">this</span>&#160;<span style="color: #2b91af">Alignment</span> source, <span style="color: #2b91af">Alignment</span> other)<br />&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160; <span style="color: green">// get the base curve for the base alignment</span><br />&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">Curve</span> baseCurveAlign2 = other.BaseCurve;<br />&#160;&#160;&#160;&#160;&#160; <span style="color: blue">using</span> (<span style="color: #2b91af">Transaction</span> trans = source.Database.TransactionManager.StartTransaction())<br />&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// get the collection of sample lines on the base alignment</span><br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">ObjectIdCollection</span> sLineGroupIds = source.GetSampleLineGroupIds();<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">foreach</span> (ObjectId sLineGroupId <span style="color: blue">in</span> sLineGroupIds)<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// for each sample line group, get all sample lines</span><br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">SampleLineGroup</span> sLineGroup = trans.GetObject(sLineGroupId,<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">OpenMode</span>.ForRead) <span style="color: blue">as</span>&#160;<span style="color: #2b91af">SampleLineGroup</span>;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">ObjectIdCollection</span> sLineIds = sLineGroup.GetSampleLineIds();<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">foreach</span> (ObjectId sLineId <span style="color: blue">in</span> sLineIds)<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// for each sample line, use the GetBasePLine to get the base curve/pline</span><br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">SampleLine</span> sLine = trans.GetObject(sLineId, <span style="color: #2b91af">OpenMode</span>.ForRead) <span style="color: blue">as</span>&#160;<span style="color: #2b91af">SampleLine</span>;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">using</span> (<span style="color: #2b91af">Polyline</span> baseCurveSampleLine = sLine.GetBasePLine())<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// finally find the intersection</span><br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">Point3dCollection</span> points = <span style="color: blue">new</span>&#160;<span style="color: #2b91af">Point3dCollection</span>();<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; baseCurveAlign2.IntersectWith(baseCurveSampleLine,<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">Intersect</span>.OnBothOperands, points, IntPtr.Zero, IntPtr.Zero);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> (points.Count &gt; 0)<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">yield</span>&#160;<span style="color: blue">return</span> points[0]; <span style="color: green">// this will yield for each point</span><br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; trans.Commit(); <span style="color: green">// commit, otherwise the outer transaction will abort</span><br />&#160;&#160;&#160;&#160;&#160; }<br />&#160;&#160;&#160; }<br /> <br />&#160;&#160;&#160; <span style="color: gray">///</span><span style="color: green">&#160;</span><span style="color: gray">&lt;summary&gt;</span><br />&#160;&#160;&#160; <span style="color: gray">///</span><span style="color: green"> Get a Polyline for this SampleLine</span><br />&#160;&#160;&#160; <span style="color: gray">///</span><span style="color: green">&#160;</span><span style="color: gray">&lt;/summary&gt;</span><br />&#160;&#160;&#160; <span style="color: blue">public</span>&#160;<span style="color: blue">static</span>&#160;<span style="color: #2b91af">Polyline</span> GetBasePLine(<span style="color: blue">this</span>&#160;<span style="color: #2b91af">SampleLine</span> sline)<br />&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">Polyline</span> pline = <span style="color: blue">new</span>&#160;<span style="color: #2b91af">Polyline</span>();<br />&#160;&#160;&#160;&#160;&#160; <span style="color: blue">int</span> v = 0;<br />&#160;&#160;&#160;&#160;&#160; <span style="color: blue">foreach</span> (<span style="color: #2b91af">SampleLineVertex</span> vertex <span style="color: blue">in</span> sline.Vertices)<br />&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; pline.AddVertexAt(v,<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; vertex.Location.Convert2d(<span style="color: blue">new</span>&#160;<span style="color: #2b91af">Plane</span>()),<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 0, 0, 0);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; v++;<br />&#160;&#160;&#160;&#160;&#160; }<br />&#160;&#160;&#160;&#160;&#160; <span style="color: blue">return</span> pline;<br />&#160;&#160;&#160; }<br />&#160; }<br />}</pre>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Pierre de la Verre
EMAIL: 
IP: 144.85.144.75
URL: http://profile.typepad.com/6p01bb08a09823970d
DATE: 07/26/2017 05:23:46 AM
Hi Augusto

I working example in Lisp would be great :-)
-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 179.157.86.231
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 07/26/2017 08:24:01 AM
Hi Pierre,

.NET the way to go with Civil 3D. Lisp may fail on some Civil 3D ActiveX API calls, it's not supported....

-Augusto Goncalves
-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Importing Alignment from Infraworks 360 to Civil 3D
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: importing-alignment-from-infraworks-360-to-civil-3d
CATEGORY: .NET
CATEGORY: Augusto Goncalves
CATEGORY: Infraworks 360

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2014/10/importing-alignment-from-infraworks-360-to-civil-3d.html 
DATE: 10/17/2014 07:49:21 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>
<p>Now from the interesting experience at AU Russia, I would like to share this cool picture of the <a href="http://en.wikipedia.org/wiki/New_Arbat_Avenue">Новый Арбат (Novyy Arbat)</a> avenue near the Kremlin, I was impressed by the light show at the buildings facade! Cool!</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d07f4050970c-pi"><img alt="Новый Арбат (Nobyy Arbat) avenue in Moscow" border="0" height="359" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01b7c6f5402a970b-pi" style="display: inline; border: 0px;" title="Новый Арбат (Nobyy Arbat) avenue in Moscow" width="477" /></a></p>
<p>Back to our technical topic, as <a href="http://adndevblog.typepad.com/infrastructure/2014/05/infraworks-360-rest-api-tech-preview-available.html">announced early this year</a>, the Infraworks 360 API Pilot is live. The first sample was around connecting IW360 with other providers (Four Square and Google Maps). Now it’s time for another sample, connecting to Civil 3D.</p>
<p>This sample uses the <a href="https://github.com/ADN-DevTech/Infraworks_API_Samples">Infraworks 360 sample</a> and the <a href="https://github.com/ADN-DevTech/AutodeskOAuthSamples">ADN OAuth sample</a>, both available on Github. Also, as IW360 is using LL84 coordinate system, we need to convert the values to the project coordinate system used on Civil 3D using the code at this <a href="http://adndevblog.typepad.com/infrastructure/2012/10/convert-coordinates-from-gps-ll84-to-civil-3d-active-project-settings.html">blog post</a>.</p>
<p>There are a few steps on the code. (1) Connect to Autodesk server using the user SSO (Autodesk Single Sign On account), after the authentication we have the token that allow access to files, so we can (2) get the IW360 list of models. With the model number, we can (3) get the roads of this model. Note that this list contains only the IDs, so we also need to read the road information to finally (4) create one alignment for each road.</p>
<p>Some comments before you read the code: I’m not creating a fancy interface, just listing the options and asking the user to type a number. Also, to avoid reading all the roads, I’m limiting the number. The alignment is created, which by design contains only 2D data, so if you need elevation data, you’ll need to also create profiles (which was not done here for simplicity). As IW360 may have more than one road with the same name (for instance, for each direction or due intersections), this sample code is only creating the first one, so one improvement may be treat this scenario to merge the roads before creating the alignments.</p>
<p>What is needed to use IW360 API: you need to be part of the Pilot. That involves using the Beta version of Infraworks 360 and a key &amp; secret pair. If you have a project and would like to join, email me at <span style="text-decoration: underline;">augusto.goncalves[AT]autodesk.com</span> with more information about your idea.</p>
<pre style="font-size: 13px; font-family: consolas; background: white; color: black;"><span style="color: green;">// System namespaces</span><span style="color: blue;"><br />using</span> System;<br /><span style="color: blue;">using</span> System.Collections.Generic;<br /><span style="color: blue;">using</span> System.Linq;<br /><span style="color: blue;">using</span> System.Text;<br /> <br /><span style="color: green;">// AutoCAD Namespaces (main code for commands and interface)</span><br /><span style="color: blue;">using</span> Autodesk.AutoCAD.ApplicationServices;<br /><span style="color: blue;">using</span> Autodesk.AutoCAD.Runtime;<br /><span style="color: blue;">using</span> Autodesk.AutoCAD.DatabaseServices;<br /><span style="color: blue;">using</span> Autodesk.AutoCAD.EditorInput;<br /> <br /><span style="color: green;">// Civil 3D namespaces (to create alingmnet)</span><br /><span style="color: blue;">using</span> Autodesk.Civil.ApplicationServices;<br /><span style="color: blue;">using</span> Autodesk.Civil.DatabaseServices;<br /> <br /><span style="color: green;">// Autodesk OAuth namespaces (implemented by ADN)</span><br /><span style="color: blue;">using</span> Autodesk.Adn.OAuthentication;<br /> <br /><span style="color: green;">// Infraworks namespaces (model data implemented by ADN)</span><br /><span style="color: blue;">using</span> Autodesk.Adn.InfraworksService.Service;<br /><span style="color: blue;">using</span> Autodesk.Adn.InfraworksService.Models;<br /><span style="color: blue;">using</span> Autodesk.Adn.InfraworksService.Models.Geometries;<br /><span style="color: blue;">using</span> Autodesk.AutoCAD.Geometry;<br /> <br /><span style="color: blue;">namespace</span> Civil3DSample<br />{<br />&#0160; <span style="color: blue;">public</span>&#0160;<span style="color: blue;">class</span>&#0160;<span style="color: #2b91af;">Commands</span><br />&#0160; {<br />&#0160;&#0160;&#0160; <span style="color: green;">// static variables for local cache</span><br />&#0160;&#0160;&#0160; <span style="color: blue;">private</span>&#0160;<span style="color: blue;">static</span>&#0160;<span style="color: #2b91af;">OAuthService</span> _oauth = <span style="color: blue;">null</span>;<br />&#0160;&#0160;&#0160; <span style="color: blue;">private</span>&#0160;<span style="color: blue;">static</span>&#0160;<span style="color: #2b91af;">InfraworksRestService</span> _iw360 = <span style="color: blue;">null</span>;<br />&#0160;&#0160;&#0160; <span style="color: blue;">private</span>&#0160;<span style="color: blue;">static</span>&#0160;<span style="color: #2b91af;">List</span>&lt;<span style="color: #2b91af;">ModelInfo</span>&gt; _models = <span style="color: blue;">null</span>;<br />&#0160;&#0160;&#0160; <span style="color: blue;">private</span>&#0160;<span style="color: blue;">static</span>&#0160;<span style="color: blue;">int</span> _modelId = 0;<br />&#0160;&#0160;&#0160; <span style="color: blue;">private</span>&#0160;<span style="color: blue;">static</span>&#0160;<span style="color: #2b91af;">List</span>&lt;<span style="color: #2b91af;">Road</span>&gt; _roads = <span style="color: blue;">null</span>;<br /> <br />&#0160;&#0160;&#0160; [<span style="color: #2b91af;">CommandMethod</span>(<span style="color: #a31515;">&quot;importIW360Alignment&quot;</span>)]<br />&#0160;&#0160;&#0160; <span style="color: blue;">public</span>&#0160;<span style="color: blue;">static</span>&#0160;<span style="color: blue;">void</span> CmdImportIW360Alignment()<br />&#0160;&#0160;&#0160; {<br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// *********************************************</span><br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// 1. Connect to Autodesk servers</span><br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// *********************************************</span><br /> <br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// connect to Autodesk SSO (Single Sign On) accounts</span><br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// this will request the user to login (username &amp; password)</span><br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">if</span> (_oauth == <span style="color: blue;">null</span>)<br />&#0160;&#0160;&#0160;&#0160;&#0160; {<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; _oauth = <span style="color: blue;">new</span>&#0160;<span style="color: #2b91af;">OAuthService</span>(<span style="color: #2b91af;">IW360Constants</span>.CONSUMER_KEY, <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">IW360Constants</span>.CONSUMER_SECRET, <span style="color: #2b91af;">IW360Constants</span>.BASE_OAUTH_URL);<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">if</span> (!_oauth.StartOAuth()) <span style="color: blue;">return</span>;<br />&#0160;&#0160;&#0160;&#0160;&#0160; }<br /> <br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// connect to Infraworks 360 server</span><br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// using the OAuth authentication from the previous step</span><br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// therefore all the information is specific to this user</span><br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">if</span> (_iw360 == <span style="color: blue;">null</span>) _iw360 = <span style="color: blue;">new</span>&#0160;<span style="color: #2b91af;">InfraworksRestService</span>(_oauth);<br /> <br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// *********************************************</span><br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// 2. Ask user to select one IW360 Model</span><br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// *********************************************</span><br /> <br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// get a list of models</span><br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">if</span> (_models == <span style="color: blue;">null</span>) _models = _iw360.GetModels();<br /> <br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// list models</span><br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">int</span> m = 0;<br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">foreach</span> (<span style="color: #2b91af;">ModelInfo</span> mode <span style="color: blue;">in</span> _models)<br />&#0160;&#0160;&#0160;&#0160;&#0160; {<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; m++;<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ed.WriteMessage(<span style="color: #a31515;">&quot;\n{0} - {1}&quot;</span>, m, mode.name);<br />&#0160;&#0160;&#0160;&#0160;&#0160; }<br /> <br />&#0160;&#0160;&#0160;&#0160;&#0160; {<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// ask the user to choose one model</span><br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">PromptIntegerOptions</span> pio = <span style="color: blue;">new</span>&#0160;<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">PromptIntegerOptions</span>(<span style="color: #a31515;">&quot;\nEnter model number: &quot;</span>);<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; pio.AllowZero = <span style="color: blue;">false</span>;<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; pio.AllowNegative = <span style="color: blue;">false</span>;<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; pio.UpperLimit = m;<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">PromptIntegerResult</span> pir = ed.GetInteger(pio);<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">if</span> (pir.Status != <span style="color: #2b91af;">PromptStatus</span>.OK) <span style="color: blue;">return</span>;<br /> <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">ModelInfo</span> selectedModel = _models[pir.Value - 1]; <span style="color: green;">// zero-based array</span><br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">int</span> selectedModelId = <span style="color: blue;">int</span>.Parse(selectedModel.id);<br /> <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// if is NOT the sample model, then the local</span><br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// cache is invalid applies (if exists)</span><br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">if</span> (selectedModelId != _modelId) _roads = <span style="color: blue;">null</span>;<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// and store the selected model ID</span><br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; _modelId = selectedModelId;<br />&#0160;&#0160;&#0160;&#0160;&#0160; }<br /> <br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// *********************************************</span><br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// 3. Ask user to select one IW360 Road</span><br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// *********************************************</span><br /> <br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">if</span> (_roads == <span style="color: blue;">null</span>) <span style="color: green;">// if the local cache is empty</span><br />&#0160;&#0160;&#0160;&#0160;&#0160; {<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// get all roads, this list returns IDs </span><br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">Collection</span> roadsProxy = _iw360.GetItemsByClass(_modelId, <span style="color: #a31515;">&quot;roads&quot;</span>);<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">if</span> (roadsProxy == <span style="color: blue;">null</span>) <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ed.WriteMessage(<span style="color: #a31515;">&quot;\nCould not load roads. Please try again.&quot;</span>);<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">return</span>; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }<br /> <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// from the IDs, let get the full object (which contains the names)</span><br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; _roads = <span style="color: blue;">new</span>&#0160;<span style="color: #2b91af;">List</span>&lt;<span style="color: #2b91af;">Road</span>&gt;();<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">foreach</span> (<span style="color: #2b91af;">Item</span> item <span style="color: blue;">in</span> roadsProxy.items)<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">int</span> itemId = <span style="color: blue;">int</span>.Parse(item.id);<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">Road</span> road = _iw360.GetModelItem&lt;<span style="color: #2b91af;">Road</span>&gt;(_modelId, <span style="color: #a31515;">&quot;roads&quot;</span>, <span style="color: #a31515;">&quot;roads&quot;</span>, itemId);<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">if</span> (<span style="color: blue;">string</span>.IsNullOrWhiteSpace(road.name)) <span style="color: blue;">continue</span>; <span style="color: green;">// skip roads with no name</span><br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; _roads.Add(road);<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">if</span> (_roads.Count &gt; 2) <span style="color: blue;">break</span>; <span style="color: green;">// list only the first 3, due internet speed</span><br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }<br />&#0160;&#0160;&#0160;&#0160;&#0160; }<br /> <br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// list all roads</span><br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">int</span> r = 0;<br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">foreach</span> (<span style="color: #2b91af;">Road</span> road <span style="color: blue;">in</span> _roads)<br />&#0160;&#0160;&#0160;&#0160;&#0160; {<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; r++;<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ed.WriteMessage(<span style="color: #a31515;">&quot;\n{0} - {1} (ID: {2})&quot;</span>, r, road.name, road.id);<br />&#0160;&#0160;&#0160;&#0160;&#0160; }<br /> <br />&#0160;&#0160;&#0160;&#0160;&#0160; {<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// ask the user to choose one model</span><br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">PromptIntegerOptions</span> pio = <span style="color: blue;">new</span>&#0160;<span style="color: #2b91af;">PromptIntegerOptions</span>(<span style="color: #a31515;">&quot;\nEnter road number: &quot;</span>);<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; pio.AllowZero = <span style="color: blue;">true</span>;<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; pio.AllowNegative = <span style="color: blue;">false</span>;<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; pio.UpperLimit = r;<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">PromptIntegerResult</span> pir = ed.GetInteger(pio);<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">if</span> (pir.Status != <span style="color: #2b91af;">PromptStatus</span>.OK) <span style="color: blue;">return</span>;<br /> <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// *********************************************</span><br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// 4. Import points from the selected Road</span><br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// *********************************************</span><br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">if</span> (pir.Value == 0)<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// create all roads</span><br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">foreach</span>(<span style="color: #2b91af;">Road</span> road <span style="color: blue;">in</span> _roads)<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; CreateCivil3DAlignment(road); <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">else</span><br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// create just the selected road</span><br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; CreateCivil3DAlignment(_roads[pir.Value - 1]); <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }<br />&#0160;&#0160;&#0160;&#0160;&#0160; }<br />&#0160;&#0160;&#0160; }<br /> <br />&#0160;&#0160;&#0160; <span style="color: blue;">private</span>&#0160;<span style="color: blue;">static</span>&#0160;<span style="color: blue;">void</span> CreateCivil3DAlignment(<span style="color: #2b91af;">Road</span> road)<br />&#0160;&#0160;&#0160; {<br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">if</span> (road.geometry.Type != <span style="color: #2b91af;">AiwGeometryType</span>.LineString) <span style="color: blue;">return</span>;<br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">AiwLineString</span> lineString = road.geometry <span style="color: blue;">as</span>&#0160;<span style="color: #2b91af;">AiwLineString</span>;<br /> <br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// start an AutoCAD transaction</span><br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">Database</span> db = <span style="color: #2b91af;">Application</span>.DocumentManager.MdiActiveDocument.Database;<br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">using</span> (<span style="color: #2b91af;">Transaction</span> trans = db.TransactionManager.StartTransaction())<br />&#0160;&#0160;&#0160;&#0160;&#0160; {<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// create a polyline with the coordinates</span><br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">Polyline</span> pline = <span style="color: blue;">new</span>&#0160;<span style="color: #2b91af;">Polyline</span>();<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">int</span> p = 0;<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">foreach</span> (<span style="color: #2b91af;">AiwCoordinate</span> coordinate <span style="color: blue;">in</span> lineString.Coordinates)<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; pline.AddVertexAt(p,<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">PointConverter</span>.ConvertPointCoordinate(<span style="color: blue;">new</span> Point2d(coordinate.X, coordinate.Y)),<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; 0, 0, 0);<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; p++;<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }<br /> <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// add this polyline to AutoCAD model space</span><br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">BlockTableRecord</span> currentSpace = trans.GetObject(db.CurrentSpaceId,<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">OpenMode</span>.ForWrite) <span style="color: blue;">as</span>&#0160;<span style="color: #2b91af;">BlockTableRecord</span>;<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; currentSpace.AppendEntity(pline);<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; trans.AddNewlyCreatedDBObject(pline, <span style="color: blue;">true</span>);<br /> <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// create the alignment</span><br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; PolylineOptions alignOptions = <span style="color: blue;">new</span> PolylineOptions();<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; alignOptions.EraseExistingEntities = <span style="color: blue;">true</span>;<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; alignOptions.PlineId = pline.Id;<br /> <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">CivilDocument</span> civilDoc = <span style="color: #2b91af;">CivilDocument</span>.GetCivilDocument(db);<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// create a siteless alignment, at layer 0,<br />       </span><span style="color: green;"> // using Standard style and Standard label set</span><br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">try</span><br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #2b91af;">Alignment</span>.Create(civilDoc, alignOptions, road.name, <span style="color: blue;">string</span>.Empty, <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #a31515;">&quot;0&quot;</span>, <span style="color: #a31515;">&quot;Basic&quot;</span>, <span style="color: #a31515;">&quot;Major and Minor only&quot;</span>);<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">catch</span> (System.<span style="color: #2b91af;">Exception</span> ex)<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: green;">// skip creating problems, such as duplicated alignment name</span><br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ed.WriteMessage(<span style="color: #a31515;">&quot;\nCould not create {0}: {1}&quot;</span>, road.name, ex.Message);<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }<br /> <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; trans.Commit();<br />&#0160;&#0160;&#0160;&#0160;&#0160; }<br />&#0160;&#0160;&#0160; }<br /> <br />&#0160;&#0160;&#0160; <span style="color: blue;">private</span>&#0160;<span style="color: blue;">static</span>&#0160;<span style="color: #2b91af;">Editor</span> ed<br />&#0160;&#0160;&#0160; { <br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">get</span><br />&#0160;&#0160;&#0160;&#0160;&#0160; {<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: blue;">return</span>&#0160;<span style="color: #2b91af;">Application</span>.DocumentManager.MdiActiveDocument.Editor; <br />&#0160;&#0160;&#0160;&#0160;&#0160; } <br />&#0160;&#0160;&#0160; }<br />&#0160; }<br />}</pre>
<p>To run this code, you’ll need a model on IW360. The following model from Moscow Kremlin area was created using the Model Builder feature.</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01bb079a62c7970d-pi"><img alt="IW360_Kremlin" border="0" height="275" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01bb079a62cb970d-pi" style="display: inline; border: 0px;" title="IW360_Kremlin" width="468" /></a></p>
<p>After run this code, we’ll have a good number of alignments with the same name as the roads on the IW360 project. Note that the coordinate system was adjusted, I removed the styles labels for simplicity.</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b7c6f54192970b-pi"><img alt="C3D_Kremlin" border="0" height="188" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01bb079a62d2970d-pi" style="display: inline; border: 0px;" title="C3D_Kremlin" width="470" /></a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Madhukar Moogala
AUTHOR EMAIL: fpdtypepadadmin@autodesk.com
TITLE: Autodesk Exchange Apps Hackathon – Update
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: autodesk-exchange-apps-hackathon-update
CATEGORY: Announcement

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2014/10/autodesk-exchange-apps-hackathon-update.html 
DATE: 10/06/2014 09:08:57 PM
-----
BODY:
<p>By&#0160;<a href="http://adndevblog.typepad.com/autocad/virupaksha-aithal.html" target="_self">Virupaksha Aithal</a></p>
<p>The Autodesk Exchange Apps Hackathon event is over. We have received more than&#0160;<strong>180</strong>&#0160;Apps as part of this event.</p>
<p>On behalf of the Autodesk Developer Network (ADN) team I’d like to say a big “thank you” to all the publishers who has registered and submitted Apps to Autodesk exchange store.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Civil 3D Project Template for Visual Studio
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: civil-3d-project-template-for-visual-studio
CATEGORY: .NET
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D 2015

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2014/09/civil-3d-project-template-for-visual-studio.html 
DATE: 09/24/2014 02:52:55 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>
<p>This is a long time request: an easy way to create a Visual Studio project for Civil 3D using VB.NET or C#.</p>
<p>If you visit the <a href="http://www.autodesk.com/developautocad">AutoCAD Developer Center</a> you’ll see some AutoCAD .NET Wizards for both VB.NET and C#, which is very powerful and can be customized. Some time ago I started by doing some templates for <a href="http://thebuildingcoder.typepad.com/blog/2010/07/devtv-addin-templates.html">Revit</a>, which still in use, so now I decided to try one for Civil 3D, and here it is.</p>
<p>Basic benefits:</p>
<ul>
<li>Create a simple project, nothing else;</li>
<li>Configure all required references (AcMgd, AcCoreMgd, AcDbMgd, AecBaseMgd and AeccDbMgd) with respective reference paths;</li>
<li>Debug settings ready;</li>
</ul>
<p>Extra benefits:</p>
<ul>
<li>Create a basic PackageContents.xml with the basic required tags and attributes for Civil 3D;</li>
<li>On build, copy all the files (DLL and XML) to a newly created folder under Application Plugins folder;</li>
<li>On clean, remove the plugin folder from Application Plugins</li>
</ul>
<p>Cons:</p>
<ul>
<li>The path are hardcoded to 2015 release. If you are using a different version, you’ll need to open and change the paths and reference versions.</li>
</ul>
<p>To use it, simple download the packages below and place under [<span style="text-decoration: underline;">My Documents]\Visual Studio 2012\Templates\ProjectTemplates\Visual Basic\</span> folder for VB.NET or [<span style="text-decoration: underline;">My Documents]\Visual Studio 2012\Templates\ProjectTemplates\Visual C#\</span> folder for C#. <strong>Do not unzip the files</strong>.</p>
<p><span class="asset  asset-generic at-xid-6a0167607c2431970b01b7c6e6f784970b img-responsive"><a href="http://adndevblog.typepad.com/files/civil2015template_vb.zip">VB.NET Template</a></span></p>
<p><span class="asset  asset-generic at-xid-6a0167607c2431970b01b7c6e6f79b970b img-responsive"><a href="http://adndevblog.typepad.com/files/civil2015template_cs.zip">C# Template</a></span></p>
<p>With the template .ZIP file in place, you should see the following:</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01bb078c0c0c970d-pi"><img alt="new_project" border="0" height="135" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01b7c6e6f763970b-pi" style="display: inline; border-width: 0px;" title="new_project" width="473" /></a></p>
<p><strong>Tip</strong>: you can organize it better by creating a subfolder “Autodesk” and placing the ZIP at this location.</p>
<p>Finally, I will be using these template at the AU Russia next week, if you are attending, come and say ‘hi’.</p>
<p><a href="http://www.autodeskuniversity.ru/"><img alt="au_russia" border="0" height="213" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01bb078c0c12970d-pi" style="display: inline; border-width: 0px;" title="au_russia" width="385" /></a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Mehdi
EMAIL: edh777@gmail.com
IP: 2.176.128.118
URL: 
DATE: 10/05/2014 01:21:45 PM
Hi Augusto,

I was wondering if you know anything about the unhandled exception in the following code:

PromptEntityOptions prompt = new PromptEntityOptions("\nSelect Base Line Region:");
prompt.SetRejectMessage("\nObject must be a Base Line Region:\n");
prompt.AddAllowedClass(typeof(BaselineRegion), true);

The last line throws the following exception:

System.IndexOutOfRangeException was unhandled
  HResult=-2146233080
  Message=Index was outside the bounds of the array.
  Source=Acdbmgd
  StackTrace:
       at Autodesk.AutoCAD.Runtime.RXObject.GetClass(Type type)
       at Autodesk.AutoCAD.EditorInput.PromptEntityOptions.AddAllowedClass(Type type, Boolean exactMatch)
  InnerException: 

-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 177.43.194.106
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 10/06/2014 11:16:30 AM


Mehdi,

In fact this Prompt option will only work for Database resident entities... as the BaselineRegion is not one of those, it will not work...

Note there is no ObjectId property, meaning is not a database entity...

Hope this clarifies.

Regards,
Augusto Goncalves

(Some comments are requiring a manual approval, so don't worry, we're receive the notification)

-----
COMMENT:
AUTHOR: Jeremy
EMAIL: jeremywarren@ufl.edu
IP: 68.101.79.155
URL: 
DATE: 07/15/2015 09:01:33 PM
Augusto,

I also have a question about an Unhandled Exception.  I wrote a program that downloads GIS data.  The URL has the year in it, and this varies from file to file.  It runs through a loop using different years and calls the following function to check the URL before downloading:

    Public Function CheckURL(ByVal URL As String) As Boolean

        Try
            Dim request As WebRequest = WebRequest.Create(URL)
            Dim response As WebResponse = request.GetResponse()
            response.Close()
            request = Nothing
            response = Nothing

        Catch ex As Exception
            Return False
        End Try

        Return True

    End Function

When I compile a standalone executable, it runs perfect.  When I copy this into the Civil3d template and call the command after net-loading the .dll, it crashes at the "GetResponse()" line when the URL is not valid.  Why does it work in a standalone, but not in Civil3D?  I can't figure out why the 'try-catch-ex' doesn't catch this exception like it is supposed to.

Any thoughts would be greatly appreaciated.  Thanks! 
-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 177.43.194.106
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 07/16/2015 05:47:37 AM
Jeremy, 

I would suggest check permissions and/or .NET version. As this question is not on this post, please create a new question at http://forums.autodesk.com/t5/autocad-civil-3d-customization/bd-p/190 so we can discuss it.

Regards,
Augusto Goncalves
-----
--------
AUTHOR: Madhukar Moogala
AUTHOR EMAIL: fpdtypepadadmin@autodesk.com
TITLE: Autodesk Exchange Apps Hackathon – Big Success
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: autodesk-exchange-apps-hackathon-big-success
CATEGORY: Announcement

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2014/09/autodesk-exchange-apps-hackathon-big-success.html 
DATE: 09/24/2014 01:13:23 AM
-----
BODY:
<p>By&#0160;<a href="http://adndevblog.typepad.com/autocad/virupaksha-aithal.html" target="_self">Virupaksha Aithal</a></p>
<p>The Autodesk Exchange Apps Hackathon – Big Success event is over. On behalf of the Autodesk Developer Network (ADN) team I’d like to say a big “thank you” to all the publishers who has registered and submitted Apps to Autodesk exchange store. We have received more than 110 Apps as part of this event till date. Till september 30th, publishers can submit the Apps as part of this event. &#0160;Visit&#0160;<a href="http://adndevblog.typepad.com/autocad/2014/08/an-online-event-with-an-opportunity-to-receive-up-to-us-100-per-app-published-and-win-one-of-eight-i.html">http://adndevblog.typepad.com/autocad/2014/08/an-online-event-with-an-opportunity-to-receive-up-to-us-100-per-app-published-and-win-one-of-eight-i.html</a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Madhukar Moogala
AUTHOR EMAIL: fpdtypepadadmin@autodesk.com
TITLE: Autodesk Exchange Apps Hackathon – update
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: autodesk-exchange-apps-hackathon-update
CATEGORY: Announcement

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2014/09/autodesk-exchange-apps-hackathon-update.html 
DATE: 09/16/2014 11:22:39 PM
-----
BODY:
<p>By&#0160;<a href="http://adndevblog.typepad.com/autocad/virupaksha-aithal.html" target="_self">Virupaksha Aithal</a></p>
<p>Since we began the registration for Autodesk Exchange Apps Hackathon event, we received 145 registrations till date. We have received 74 Apps as part of the event. There is less than 3 days to the event. if you have not registered yet, visit Autodesk® Exchange Apps Hackathon&#0160;<a href="http://exchangeapphack.com/" target="_self">http://exchangeapphack.com/</a></p>
<p>Discussions and presentations during the Hackathon include:</p>
<ul>
<li>How to architect your app for Autodesk Exchange?</li>
<li>Developing cloud applications round table discussion</li>
<li>Sustainability apps</li>
<li>AutoCAD APIs roundtable discussion</li>
<li>Advanced Exchange features – copy protection, IPN notifications, monthly subscriptions, selling web services</li>
<li>Revit APIs roundtable discussion</li>
<li>Max and Maya APIs round table discussion</li>
<li>Inventor APIs round table discussion</li>
</ul>
<p>for timing visit&#0160;<a href="http://exchangeapphack.com/agenda/" target="_self">http://exchangeapphack.com/agenda/</a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Commercial Layers versions
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: commercial-layers-versions
CATEGORY: AIMS
CATEGORY: Augusto Goncalves

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2014/09/commercial-layers-versions.html 
DATE: 09/11/2014 12:08:21 PM
-----
BODY:
<p>Tomorrow, Friday September 12, we’ll be at the <a href="http://www.aechackathon.com/seattle.html">AEC Hackathon in Seattle</a>. But before travelling, here is a quick list of links for AIMS: it supports 4 kind of commercial layers (Google, Yahoo, Bing and Open Street Map). Each uses its own API. The API links are: </p>  <p><a href="http://maps.google.com/maps/api/js?v=3.3">http://maps.google.com/maps/api/js?v=3.3</a>     <br /><a href="http://api.maps.yahoo.com/ajaxymap?v=3.0">http://api.maps.yahoo.com/ajaxymap?v=3.0</a>     <br /><a href="http://dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=6.2">http://dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=6.2</a>     <br /><a href="http://www.openstreetmap.org/openlayers/OpenStreetMap.js">http://www.openstreetmap.org/openlayers/OpenStreetMap.js</a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Pipe/Structure stations &amp; elevation at ProfileView
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: pipestructure-stations-elevation-at-profileview
CATEGORY: .NET
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D 2015

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2014/08/pipestructure-stations-elevation-at-profileview.html 
DATE: 08/18/2014 12:14:28 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>There is an interesting object available on the Civil 3D API: the <strong>ProfileViewPart</strong>. Actually it’s a database resident object, meaning we can select and get its <strong>ObjectId</strong>, but also acts as a ‘proxy’ for Part (Pipe and Structure) that are on a specific <strong>ProfileView</strong>.</p>  <p>More than that, from this <strong>ProfileViewPart</strong>, we can reach the original Part and get all the profile views showing it. Now the tricky part is: how get the station and elevation? In fact there is no direct API for it, but we can workaround this with the geometry of the part at the profile view getting its <strong>GeometryExtent</strong> and, from the XY, get the station and elevation.</p>  <p>The sample below demonstrate the idea.</p>  <pre style="font-size: 13px; font-family: consolas; background: white; color: black">[<span style="color: #2b91af">CommandMethod</span>(<span style="color: #a31515">&quot;getPartOnProfileView&quot;</span>)]<br /><span style="color: blue">public</span>&#160;<span style="color: blue">static</span>&#160;<span style="color: blue">void</span> CmdGetPartOnProfileView()<br />{<br />&#160; <span style="color: green">// select a part on the profile view</span><br />&#160; <span style="color: #2b91af">Editor</span> ed = <span style="color: #2b91af">Application</span>.DocumentManager.MdiActiveDocument.Editor;<br />&#160; <span style="color: #2b91af">PromptEntityOptions</span> peo = <span style="color: blue">new</span>&#160;<span style="color: #2b91af">PromptEntityOptions</span>(<br />&#160;&#160;&#160; <span style="color: #a31515">&quot;Select a part on the profile view: &quot;</span>);<br />&#160; peo.SetRejectMessage(<span style="color: #a31515">&quot;\nOnly parts on profile view&quot;</span>);<br />&#160; peo.AddAllowedClass(<span style="color: blue">typeof</span>(<span style="color: #2b91af">ProfileViewPart</span>), <span style="color: blue">true</span>);<br />&#160; <span style="color: #2b91af">PromptEntityResult</span> per = ed.GetEntity(peo);<br />&#160; <span style="color: blue">if</span> (per.Status != <span style="color: #2b91af">PromptStatus</span>.OK) <span style="color: blue">return</span>;<br /> <br />&#160; <span style="color: #2b91af">Database</span> db = <span style="color: #2b91af">Application</span>.DocumentManager.MdiActiveDocument.Database;<br />&#160; <span style="color: blue">using</span> (<span style="color: #2b91af">Transaction</span> trans = db.TransactionManager.StartTransaction())<br />&#160; {<br />&#160;&#160;&#160; <span style="color: green">// get the part showing on the view</span><br />&#160;&#160;&#160; <span style="color: #2b91af">ProfileViewPart</span> partPV = trans.GetObject(per.ObjectId,<br />&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">OpenMode</span>.ForRead) <span style="color: blue">as</span>&#160;<span style="color: #2b91af">ProfileViewPart</span>;<br />&#160;&#160;&#160; <span style="color: #2b91af">Part</span> part = trans.GetObject(partPV.ModelPartId,<br />&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">OpenMode</span>.ForRead) <span style="color: blue">as</span>&#160;<span style="color: #2b91af">Part</span>;<br /> <br />&#160;&#160;&#160; <span style="color: green">// may have several PVs showing this part...</span><br />&#160;&#160;&#160; <span style="color: #2b91af">ObjectIdCollection</span> pvIds = part.GetProfileViewsDisplayingMe();<br />&#160;&#160;&#160; <span style="color: blue">foreach</span> (ObjectId pvId <span style="color: blue">in</span> pvIds)<br />&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160; <span style="color: green">// get the average point of this structure on the profile view</span><br />&#160;&#160;&#160;&#160;&#160; <span style="color: green">// you may change this X,Y to the max or min...</span><br />&#160;&#160;&#160;&#160;&#160; Extents3d ext = partPV.GeometricExtents;<br />&#160;&#160;&#160;&#160;&#160; <span style="color: blue">double</span> x = (ext.MaxPoint.X - ext.MinPoint.X) / 2 + ext.MinPoint.X;<br />&#160;&#160;&#160;&#160;&#160; <span style="color: blue">double</span> y = (ext.MaxPoint.Y - ext.MinPoint.Y) / 2 + ext.MinPoint.Y;<br /> <br />&#160;&#160;&#160;&#160;&#160; <span style="color: green">// get the profile view</span><br />&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">ProfileView</span> pv = trans.GetObject(pvId, <span style="color: #2b91af">OpenMode</span>.ForRead) <span style="color: blue">as</span>&#160;<span style="color: #2b91af">ProfileView</span>;<br /> <br />&#160;&#160;&#160;&#160;&#160; <span style="color: green">// and the station/elevation on the profile view</span><br />&#160;&#160;&#160;&#160;&#160; <span style="color: blue">double</span> station = 0.0;<br />&#160;&#160;&#160;&#160;&#160; <span style="color: blue">double</span> elevation = 0.0;<br />&#160;&#160;&#160;&#160;&#160; pv.FindStationAndElevationAtXY(x, y, <span style="color: blue">ref</span> station, <span style="color: blue">ref</span> elevation);<br /> <br />&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #a31515">&quot;\n{0} showing on {1} at station: {2:0.00} | Elevation: {3:0.00}&quot;</span>,<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; part.Name, pv.Name, station, elevation);<br />&#160;&#160;&#160; }<br />&#160; }<br />}</pre>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Sebastian Schoeller
EMAIL: sebastian.schoeller@gmail.com
IP: 172.16.49.167
URL: 
DATE: 11/06/2017 09:16:37 AM
Hello Augusto,

thanks for your sample. When I alter that to

            using (Transaction trans = db.TransactionManager.StartTransaction())
            {
                // get the part showing on the view
                ProfileViewPressurePart partPV = trans.GetObject(per.ObjectId, OpenMode.ForRead) as ProfileViewPressurePart;
                PressurePart part = trans.GetObject(partPV.ModelPartId, OpenMode.ForRead) as PressurePart;

                // get the network for the part
                PressurePipeNetwork ppNet = trans.GetObject(part.NetworkId, OpenMode.ForRead) as PressurePipeNetwork;

in order to fetch a pipe network via pressure pipes I receive an error while trying to browse the variable ppNet which reads

'ppNet.AcadObject' threw an exception of type 'System.Runtime.InteropServices.COMException'

Do you have an idea why this could be?

Best regars

Sebastian
-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 209.201.110.48
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 11/14/2017 09:45:05 AM
Sebastian,

Unfortunately the Pipe Pressure network is not exposed as COM objects, therefore this will not work.

Regards,
Augusto Goncalves 
-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Workaround for displacement of base map layer and dynamic layer
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: workaround-for-displacement-of-base-map-layer-and-dynamic-layer
CATEGORY: AIMS 2013
CATEGORY: AIMS 2014
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2014/08/workaround-for-displacement-of-base-map-layer-and-dynamic-layer.html 
DATE: 08/11/2014 03:42:53 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>To improve viewing performance of Autodesk Infrastructure Map Server, you can set some layers into base layer group so that they can be rendering as tile. The tile size is 300*300 by default, which is defined in serverconfig.ini(in C:\Program Files\Autodesk\Autodesk Infrastructure Map Server 201x\Bin folder by default).&#160; </p>  <p>&#160;</p>  <p>[TileServiceProperties]    <br /># *****************************************************************************     <br /># T I L E&#160; S E R V I C E     <br />#     <br /># Property Name&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Description     <br /># -----------------------------------------------------------------------------     <br /># RenderOnly&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Renders the tile only     <br />#&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 0 = false and 1 = true     <br /># TileCachePath&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Root path of the image tile cache     <br /># TileColumnsPerFolder&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Number of columns of tiles per folder     <br />#&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 0 &lt; Value &lt;= 1000     <br /># TileRowsPerFolder&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Number of rows of tiles per folder     <br />#&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 0 &lt; Value &lt;= 1000     <br /># DefaultTileSizeX&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Width of generated tiles in pixels     <br />#&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 50 &lt; value &lt;= 10000     <br /># DefaultTileSizeY&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Height of generated tiles in pixels     <br />#&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 50 &lt; value &lt;= 10000     <br /># ImageFormat&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Image format for generated tiles     <br />#&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; PNG, PNG8, GIF or JPG     <br /># *****************************************************************************     <br />RenderOnly&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; = 0     <br />TileCachePath&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; =C:\Program Files\Autodesk\Autodesk Infrastructure Map Server 2014\Repositories\TileCache\     <br />TileColumnsPerFolder&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; = 30     <br />TileRowsPerFolder&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; = 30     <br /><strong>DefaultTileSizeX&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; = 300      <br />DefaultTileSizeY&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; = 300</strong>     <br />ImageFormat&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; = PNG</p>  <p>&#160;</p>  <p>You may find some issues if you are using flexible web layout when changing the default tile size, there is a displacement between base map layer and dynamic layer, it works fine in basic layout. Here is the workaround to fix this issue: </p>  <p>1. Open file fusionSF-compressed.js with NotePad. By default, the file is in C:\Program Files\Autodesk\Autodesk Infrastructure Web Server Extension 201x\www\fusion\lib</p>  <p>2. Find text ‘<i>defaultSize:new OpenLayers.Size(300,300)</i>’. There is only one occurrence.</p>  <p>3. Update (300,300) to the value that you defined on server side. </p>  <p>4. Clear the tile cache, the default folder is C:\Program Files\Autodesk\Autodesk Infrastructure Map Server 201x\Repositories\TileCache</p>  <p>5. Restart Map Server.</p>  <p>&#160;</p>  <p>Hope this helps if you run into this issue.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Madhukar Moogala
AUTHOR EMAIL: fpdtypepadadmin@autodesk.com
TITLE: An online event with an opportunity to receive up to US $100 per app published and win one of eight iPad minis!
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: an-online-event-with-an-opportunity-to-receive-up-to-us-100-per-app-published-and-win-one-of-eight-i
CATEGORY: Announcement

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2014/08/an-online-event-with-an-opportunity-to-receive-up-to-us-100-per-app-published-and-win-one-of-eight-i.html 
DATE: 08/08/2014 03:11:54 AM
-----
BODY:
<p>By&#0160;<a href="http://adndevblog.typepad.com/autocad/virupaksha-aithal.html" target="_self">Virupaksha Aithal</a></p>
<p>We are excited to announce the 2014&#0160;<a href="http://exchangeapphack.com/">Autodesk® Exchange Apps Hackathon</a>. While similar in concept to the Portathon that we held in 2013, this event is bigger, better, has new competitions and great prizes. Anyone can participate from anywhere in the world and at any time both before the event and during the Hackathon days. We’ve assembled a great line up of speakers to give presentations and demos on hot topics that will help your overall app development and technical experts will be on hand to help and guide you.</p>
<p>The Autodesk Exchange Apps Hackathon is a virtual web based Hackathon.&#0160; It’s a community event that gives you the opportunity to work closely with other members of the software development community and Autodesk engineers — in real time, developing new apps for Autodesk Exchange.&#0160;</p>
<p>The Hackathon will run from 9:00 a.m. U.S. Pacific Time (PT) on Saturday, September 20, 2014 to 4 p.m. PT on September 21, 2014. You can participate from anywhere you have internet access. &#0160;</p>
<p>The Hackathon is a free event.&#0160; Plus, there is a reward!&#0160; For all new apps submitted to the Autodesk Exchange Apps store by midnight on September 30, 2014 and accepted for publication in the store by November 30, 2014, you will receive US$ 100 per “non-Free” app and US $50 “Free or Trial” app for up to 5 apps per company.</p>
<p><strong>More Information and Registration:</strong></p>
<p>Head on over to&#0160;<a href="http://exchangeapphack.com">exchangeapphack.com</a>&#0160;for details on the event, including a FAQ, the schedule and speaker line up, the Rules and the Registration link.</p>
<p>If you have any questions about the Hackathon or the Cloud Apps and Sustainability Apps competitions, please send an email to&#0160;<a href="mailto:exchangeapphack@autodesk.com">exchangeapphack@autodesk.com</a>.&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Introduction to Civil 3D 2015 programming
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: introduction-to-civil-3d-2015-programming
CATEGORY: .NET
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D 2015
CATEGORY: Civil 3D

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2014/07/introduction-to-civil-3d-2015-programming.html 
DATE: 07/18/2014 01:36:21 PM
-----
BODY:
<p>This is a short recording on how set up a development environment for Civil 3D 2015 with Visual Basic .NET. For a detailed description, check <a href="http://adndevblog.typepad.com/infrastructure/2014/04/visual-studio-net-settings-for-civil-3d-2015.html">this previous post</a>.</p>  <div id="scid:5737277B-5D6D-4f48-ABFC-DD9C333F4C5D:a934d73b-80a3-42f3-a718-fbfc9b57fbf6" class="wlWriterEditableSmartContent" style="float: none; padding-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px"><div id="7bed4ec9-dd4b-4015-898a-9ab00ac8da68" style="margin: 0px; padding: 0px; display: inline;"><div><a href="http://www.youtube.com/watch?v=lu_jGGR9TXI" target="_new"><img src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01a73defd2f8970d-pi" style="border-style: none" galleryimg="no" onload="var downlevelDiv = document.getElementById('7bed4ec9-dd4b-4015-898a-9ab00ac8da68'); downlevelDiv.innerHTML = &quot;&lt;div&gt;&lt;object width=\&quot;425\&quot; height=\&quot;355\&quot;&gt;&lt;param name=\&quot;movie\&quot; value=\&quot;http://www.youtube.com/v/lu_jGGR9TXI&amp;hl=en\&quot;&gt;&lt;\/param&gt;&lt;embed src=\&quot;http://www.youtube.com/v/lu_jGGR9TXI&amp;hl=en\&quot; type=\&quot;application/x-shockwave-flash\&quot; width=\&quot;425\&quot; height=\&quot;355\&quot;&gt;&lt;\/embed&gt;&lt;\/object&gt;&lt;\/div&gt;&quot;;" alt=""></a></div></div></div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Miguel Angel Alanis
EMAIL: miguel.alanis@dasoft.com.mx
IP: 187.162.112.106
URL: http://dasoft.mx/
DATE: 08/13/2014 10:14:10 AM
Hello
Do you have any training or labs that you could share for AutoCAD Civil 3D API? Just like the ones on the Learning section of the Autodesk Developer Network
Thanks

-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 71.161.120.179
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 08/13/2014 11:37:34 AM
Miguel,

The most updated material would be Developer Guide at http://help.autodesk.com/cloudhelp/2015/ENU/Civil3D-DevGuide/files/GUID-DA303320-B66D-4F4F-A4F4-9FBBEC0754E0.htm

Would that help?

Regards,
Augusto Goncalves
-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Pipe Network parts on Profile View
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: pipe-network-parts-on-profile-view
CATEGORY: .NET
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D 2015

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2014/07/pipe-network-parts-on-profile-view.html 
DATE: 07/11/2014 10:41:16 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>On a profile view, after add a pipe network part (structure or pipe), Civil 3D creates a new entity: <strong>ProfileViewPart</strong>. This object don’t have many methods, but it’s a database resident object (with ID and geometry).</p>  <p>So the question is: how get the part station and elevation of the profile view?</p>  <p>Using the part bounding box, we’ll access the XY coordinate on the model space. Then it’s possible to get the average point (or any other point, like minimum or maximum Y). Using that XY, we can go back to the profile view and ask what’s the station &amp; elevation on that point.</p>  <p>The code sample below demonstrate the idea:</p>  <pre style="font-size: 13px; font-family: consolas; background: white; color: black"><span style="color: green">// select a part on the profile view</span><br /><span style="color: #2b91af">Editor</span> ed = <span style="color: #2b91af">Application</span>.DocumentManager.MdiActiveDocument.Editor;<br /><span style="color: #2b91af">PromptEntityOptions</span> peo = <span style="color: blue">new</span>&#160;<span style="color: #2b91af">PromptEntityOptions</span>(<br />&#160; <span style="color: #a31515">&quot;Select a part on the profile view: &quot;</span>);<br />peo.SetRejectMessage(<span style="color: #a31515">&quot;\nOnly parts on profile view&quot;</span>);<br />peo.AddAllowedClass(<span style="color: blue">typeof</span>(<span style="color: #2b91af">ProfileViewPart</span>), <span style="color: blue">true</span>);<br /><span style="color: #2b91af">PromptEntityResult</span> per = ed.GetEntity(peo);<br /><span style="color: blue">if</span> (per.Status != <span style="color: #2b91af">PromptStatus</span>.OK) <span style="color: blue">return</span>;<br /> <br /><span style="color: #2b91af">Database</span> db = <span style="color: #2b91af">Application</span>.DocumentManager.MdiActiveDocument.Database;<br /><span style="color: blue">using</span> (<span style="color: #2b91af">Transaction</span> trans = db.TransactionManager.StartTransaction())<br />{<br />&#160; <span style="color: green">// get the part showing on the view</span><br />&#160; <span style="color: #2b91af">ProfileViewPart</span> partPV = trans.GetObject(per.ObjectId,<br />&#160;&#160;&#160; <span style="color: #2b91af">OpenMode</span>.ForRead) <span style="color: blue">as</span>&#160;<span style="color: #2b91af">ProfileViewPart</span>;<br />&#160; <span style="color: #2b91af">Part</span> part = trans.GetObject(partPV.ModelPartId,<br />&#160;&#160;&#160; <span style="color: #2b91af">OpenMode</span>.ForRead) <span style="color: blue">as</span>&#160;<span style="color: #2b91af">Part</span>;<br /> <br />&#160; <span style="color: green">// may have several PVs showing this part...</span><br />&#160; <span style="color: #2b91af">ObjectIdCollection</span> pvIds = part.GetProfileViewsDisplayingMe();<br />&#160; <span style="color: blue">foreach</span> (ObjectId pvId <span style="color: blue">in</span> pvIds)<br />&#160; {<br />&#160;&#160;&#160; <span style="color: green">// get the average point of this structure on the profile view</span><br />&#160;&#160;&#160; <span style="color: green">// you may change this X,Y to the max or min...</span><br />&#160;&#160;&#160; Extents3d ext = partPV.GeometricExtents;<br />&#160;&#160;&#160; <span style="color: blue">double</span> x = (ext.MaxPoint.X - ext.MinPoint.X) / 2 + ext.MinPoint.X;<br />&#160;&#160;&#160; <span style="color: blue">double</span> y = (ext.MaxPoint.Y - ext.MinPoint.Y) / 2 + ext.MinPoint.Y;<br /> <br />&#160;&#160;&#160; <span style="color: green">// get the profile view</span><br />&#160;&#160;&#160; <span style="color: #2b91af">ProfileView</span> pv = trans.GetObject(pvId, <span style="color: #2b91af">OpenMode</span>.ForRead) <span style="color: blue">as</span>&#160;<span style="color: #2b91af">ProfileView</span>;<br /> <br />&#160;&#160;&#160; <span style="color: green">// and the station/elevation on the profile view</span><br />&#160;&#160;&#160; <span style="color: blue">double</span> station = 0.0;<br />&#160;&#160;&#160; <span style="color: blue">double</span> elevation = 0.0;<br />&#160;&#160;&#160; pv.FindStationAndElevationAtXY(x, y, <span style="color: blue">ref</span> station, <span style="color: blue">ref</span> elevation);<br /> <br />&#160;&#160;&#160; ed.WriteMessage(<br />&#160;&#160;&#160;&#160;&#160; <span style="color: #a31515">&quot;\n{0} showing on {1} at station: {2:0.00} | Elevation: {3:0.00}&quot;</span>,<br />&#160;&#160;&#160;&#160;&#160; part.Name, pv.Name, station, elevation);<br />&#160; }<br />}</pre>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Damir Vidakovic
EMAIL: 
IP: 195.29.94.98
URL: http://profile.typepad.com/6p01b8d0efe53f970c
DATE: 07/28/2016 03:18:26 AM
Hi

Good example, but there is a problem if a profile view part is visible in several ProfileViews, then its extents is actually box around all of them so x and y coordinates that you use for querying station and elevation are useless, and station or elevations you get in return are wrong.
-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 177.43.194.106
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 07/28/2016 04:31:32 AM
Thanks for your comment Damir, I haven't tested this scenario... will need to double check it. Do you have an alternative suggestion?

Best,
Augusto Goncalves
-----
COMMENT:
AUTHOR: Hoang
EMAIL: trueblue0505@gmail.com
IP: 171.227.29.131
URL: 
DATE: 02/25/2018 07:44:35 AM
Hi Damir,

Have you got any answer for this scenario?
-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Read coordinates of line features with Map 3D API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: read-coordinates-of-line-features-with-map-3d-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: AutoCAD Civil 3D 2014
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: AutoCAD Map 3D 2014
CATEGORY: Daniel Du
CATEGORY: FDO
CATEGORY: Map 3D

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2014/07/read-coordinates-of-line-features-with-map-3d-api.html 
DATE: 07/10/2014 01:39:15 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>I am asked how to get the coordinates of each vertices from a line feature, for example, a line feature which is created from an AutoCAD polyline .</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01a73de9e02c970d-pi"><img title="image" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; display: inline; border-top-width: 0px" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01a3fd2ede00970b-pi" width="405" height="225" /></a> </p>  <p>For an AutoCAD polyline which only contains lines, when it is converted to feature with Map 3D command “Create from Geometry”, the feature type will be MgCurveString which contains only one linear segments. </p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01a3fd2ede04970b-pi"><img title="image" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; display: inline; border-top-width: 0px" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01a511de91f2970c-pi" width="409" height="200" /></a> </p>  <p></p>  <p>For AutoCAD polyline which contains arc, the feature after conversion will be several segments, including arc segments and linear segments. </p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01a511de91f6970c-pi"><img title="image" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; display: inline; border-top-width: 0px" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01a73de9e034970d-pi" width="406" height="263" /></a> </p>  <p>&#160;</p>  <p>Here is the code snippet: </p>  <pre style="font-size: 13px; font-family: consolas; background: white; color: black"><span style="color: blue">using</span> System;<br /><span style="color: blue">using</span> Autodesk.AutoCAD.Runtime;<br /><span style="color: blue">using</span> Autodesk.AutoCAD.ApplicationServices;<br /><span style="color: blue">using</span> Autodesk.AutoCAD.DatabaseServices;<br /><span style="color: blue">using</span> Autodesk.AutoCAD.Geometry;<br /><span style="color: blue">using</span> Autodesk.AutoCAD.EditorInput;<br /><span style="color: blue">using</span> Autodesk.Gis.Map.Platform.Interop;<br /><span style="color: blue">using</span> Autodesk.Gis.Map.Platform;<br /><span style="color: blue">using</span> OSGeo.MapGuide;<br /> <br /><span style="color: green">// This line is not mandatory, but improves loading performances</span><br />[<span style="color: blue">assembly</span>: <span style="color: #2b91af">CommandClass</span>(<span style="color: blue">typeof</span>(GetFeatureType.<span style="color: #2b91af">MyCommands</span>))]<br /> <br /><span style="color: blue">namespace</span> GetFeatureType<br />{<br /> <br /><span style="color: blue">public</span>&#160;<span style="color: blue">class</span>&#160;<span style="color: #2b91af">MyCommands</span><br />{<br /> <br /> <br /><span style="color: green">// Modal Command with localized name</span><br />[<span style="color: #2b91af">CommandMethod</span>(<span style="color: #a31515">&quot;getPolylineCoordinates&quot;</span>)]<br /><span style="color: blue">public</span>&#160;<span style="color: blue">void</span> MyCommand() <span style="color: green">// This method can have any name</span><br />{<br />&#160;&#160;&#160; <span style="color: #2b91af">Editor</span> ed = Autodesk.AutoCAD.ApplicationServices.<span style="color: #2b91af">Application</span><br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; .DocumentManager.MdiActiveDocument.Editor;<br /> <br />&#160;&#160;&#160; <span style="color: #2b91af">Transaction</span> trans = Autodesk.AutoCAD.ApplicationServices.<span style="color: #2b91af">Application</span><br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; .DocumentManager.MdiActiveDocument.Database.TransactionManager<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; .StartTransaction();<br /> <br />&#160;&#160;&#160; <span style="color: blue">using</span> (trans)<br />&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// Get the Map Object</span><br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">AcMapMap</span> currentMap = <span style="color: #2b91af">AcMapMap</span>.GetCurrentMap();<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// Prompt user to Select Feature in Map</span><br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">PromptSelectionOptions</span> psop = <span style="color: blue">new</span>&#160;<span style="color: #2b91af">PromptSelectionOptions</span>();<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; psop.MessageForAdding = <span style="color: #a31515">&quot;Select the FDO Feature in Map 3D to read Data : &quot;</span>;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; psop.SingleOnly = <span style="color: blue">true</span>;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">PromptSelectionResult</span> psResult = ed.GetSelection(psop);<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> (psResult.Status == <span style="color: #2b91af">PromptStatus</span>.OK)<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">SelectionSet</span> selSet = psResult.Value;<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// Get Map Selectionset from AutoCAD SelectionSet</span><br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">MgSelectionBase</span> mapSelBase = <span style="color: #2b91af">AcMapFeatureEntityService</span><br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; .GetSelection(selSet);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">AcMapLayer</span> mapLayer = <span style="color: #2b91af">AcMapFeatureEntityService</span><br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; .GetLayer(psResult.Value[0].ObjectId);<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">//Get the ID of the selected Parcel</span><br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">MgFeatureReader</span> ftrRdr = mapSelBase.GetSelectedFeatures(<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; mapLayer, mapLayer.FeatureClassName, <span style="color: blue">false</span>);<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">while</span> (ftrRdr.ReadNext())<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">MgClassDefinition</span> cd = ftrRdr.GetClassDefinition();<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">//the geomety property name maybe different for your </span><br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">//data source </span><br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">MgByteReader</span> byteRdr = ftrRdr.GetGeometry(<span style="color: #a31515">&quot;Geometry&quot;</span>);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">MgAgfReaderWriter</span> wtr = <span style="color: blue">new</span>&#160;<span style="color: #2b91af">MgAgfReaderWriter</span>();<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">MgGeometry</span> geom = wtr.Read(byteRdr);<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> (geom <span style="color: blue">is</span> OSGeo.MapGuide.<span style="color: #2b91af">MgCurveString</span>)<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">var</span> cs = geom <span style="color: blue">as</span>&#160;<span style="color: #2b91af">MgCurveString</span>;<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(<span style="color: #a31515">&quot;\n geo is MgCurveString.&quot;</span>);<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">for</span> (<span style="color: blue">int</span> i = 0, segmentCount = cs.Count; i &lt; segmentCount; i++)<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">var</span> seg = cs.GetSegment(i);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> (seg <span style="color: blue">is</span>&#160;<span style="color: #2b91af">MgArcSegment</span>)<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(<span style="color: #a31515">&quot;\nthis is an Arc Segment.&quot;</span>);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">var</span> arcSeg = seg <span style="color: blue">as</span>&#160;<span style="color: #2b91af">MgArcSegment</span>;<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">string</span> msg = <span style="color: blue">string</span>.Format(<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #a31515">&quot;\nstart point: x= {0}, y={1}&quot;</span>,<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; arcSeg.StartCoordinate.X,<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; arcSeg.StartCoordinate.Y);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(msg);<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; msg = <span style="color: blue">string</span>.Format(<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #a31515">&quot;\ncontrol point&#160; x= {0}, y={1}&quot;</span>,<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; arcSeg.ControlCoordinate.X,<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; arcSeg.ControlCoordinate.Y);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(msg);<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; msg = <span style="color: blue">string</span>.Format(<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #a31515">&quot;\nend point: x= {0}, y={1}&quot;</span>,<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; arcSeg.EndCoordinate.X,<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; arcSeg.EndCoordinate.Y);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(msg);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> (seg <span style="color: blue">is</span>&#160;<span style="color: #2b91af">MgLinearSegment</span>)<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(<span style="color: #a31515">&quot;\nthis is a linear Segment.&quot;</span>);<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">var</span> linearSeg = seg <span style="color: blue">as</span>&#160;<span style="color: #2b91af">MgLinearSegment</span>;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">var</span> interator = linearSeg.GetCoordinates();<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">while</span> (interator.MoveNext())<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">var</span> x = interator.GetCurrent().X;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">var</span> y = interator.GetCurrent().Y;<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(<span style="color: blue">string</span>.Format(<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #a31515">&quot;\n x = {0}, y={1} &quot;</span>, x, y));<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> (geom <span style="color: blue">is</span> OSGeo.MapGuide.<span style="color: #2b91af">MgLineString</span>)<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">var</span> ls = geom <span style="color: blue">as</span>&#160;<span style="color: #2b91af">MgLineString</span>;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">var</span> interator = ls.GetCoordinates();<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">while</span> (interator.MoveNext())<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">var</span> x = interator.GetCurrent().X;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">var</span> y = interator.GetCurrent().Y;<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(<span style="color: blue">string</span>.Format(<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #a31515">&quot;\n x = {0}, y={1} &quot;</span>, x, y));<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; trans.Commit();<br />&#160;&#160;&#160; }<br /> <br />}<br /> <br /> <br /> <br />}<br /> <br />}</pre>

<pre style="font-size: 13px; font-family: consolas; background: white; color: black"><br /></pre>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Infraworks 360 REST API &ndash; Tech Preview available
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: infraworks-360-rest-api-tech-preview-available
CATEGORY: .NET
CATEGORY: Announcement
CATEGORY: Augusto Goncalves
CATEGORY: HTML
CATEGORY: Infraworks 360
CATEGORY: Web

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2014/05/infraworks-360-rest-api-tech-preview-available.html 
DATE: 05/14/2014 10:14:07 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01a73dc3a3d0970d-pi"><img align="right" alt="infraworks-2015-banner-lockup-331x66" border="0" height="68" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01a73dc3a3d5970d-pi" style="margin: 0px 0px 0px 10px; display: inline; border-width: 0px;" title="infraworks-2015-banner-lockup-331x66" width="260" /></a></p>
<p>It’s our pleasure to announce that <a href="http://www.autodesk.com/products/infraworks-family/overview">Infraworks 360</a> now have an <a href="http://en.wikipedia.org/wiki/Representational_state_transfer">REST API</a> open for developers, which creates an opportunity for you to integrate your business with this big data approach.</p>
<p>This tech preview will enable read access to all major objects, including roads, terrain, city furniture, buildings, pipes and others, through a dedicated sandbox server using modern REST protocols.</p>
<p>Below is the general architecture of the API: it will read information from the server from any custom app. It will not be hosted or access the desktop or iPad versions.</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01a511b85e39970c-pi"><img alt="iw360_general_arch" border="0" height="297" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01a511b85e3e970c-pi" style="display: inline; border-width: 0px;" title="iw360_general_arch" width="430" /></a></p>
<p><strong>Sample demonstration</strong></p>
<p>To demonstrate the benefits of this API, we created a sample web app (browser-based) that reads model data from IW360, more specifically the buildings, and connect with FourSquare to get close venues and finally use Google Maps to show to the user. This allow you to compare buildings with near venues.</p>
<p>The image below show the high-level architecture with the technologies and tools used to develop the sample.</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01a511b85e4e970c-pi"><img alt="iw360sample_general_arch" border="0" height="298" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01a73dc3a3e7970d-pi" style="display: inline; border-width: 0px;" title="iw360sample_general_arch" width="426" /></a></p>
<p><strong>Try it yourself</strong>: go to <a href="http://infraworks360samples.azurewebsites.net/IW360Demo.aspx">this address</a> using your Autodesk account. To use it, first you must have Infraworks 360 models linked to your account. To do so, you’ll need the beta version, available under Autodesk Beta program. Or watch the video recording below.</p>
<div class="wlWriterEditableSmartContent" id="scid:5737277B-5D6D-4f48-ABFC-DD9C333F4C5D:e8024692-f05b-42ec-abf4-495a8331475b" style="float: none; margin: 0px; display: inline; padding: 0px;">
<div id="04acaeb2-5d78-4b38-823f-ef14bfea7a58" style="margin: 0px; padding: 0px; display: inline;">
<div><a href="http://www.youtube.com/watch?v=tRJ-o1hL9J0" target="_new"><img alt="" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01a73dc3a8cb970d-pi" style="border-style: none;" /></a></div>
</div>
</div>
<p>You can download the source code <span class="asset  asset-generic at-xid-6a0167607c2431970b01a3fd08b91a970b img-responsive"><a href="http://adndevblog.typepad.com/files/iw360websample.zip">here.</a></span></p>
<p><strong>Want to join!</strong></p>
<p>The program still restrict, we’re creating this API, and to start working with this API, you’ll need a key/secret pair. Please email me at <span style="text-decoration: underline;">augusto.goncalves[at]autodesk.com</span> with your development plans for more information and how join the program.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Henry Fenby-Taylor
EMAIL: henryfenbytaylor@gmail.com
IP: 31.22.0.74
URL: 
DATE: 07/09/2014 04:25:58 AM
Is this for 360 only?
-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 177.43.194.106
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 07/10/2014 08:01:32 AM
Henry, 

Yes, this requires the model hosted on the cloud.

Regards,
Augusto Goncalves
-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Accessing Point File Format names and their extension using Civil 3D .NET API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: accessing-point-file-format-names-and-their-extension-using-civil-3d-net-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2015
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2014/04/accessing-point-file-format-names-and-their-extension-using-civil-3d-net-api.html 
DATE: 04/28/2014 12:35:17 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>Those of you tried to access the Point File Format names and their extension using Civil 3D .NET API earlier and found some issues in enumerating <strong>PointFileFormatCollection</strong> and extracting the name of the individual point file format in a DWG file, this is now resolved in Civil 3D 2015 release.</p>
<p>We can now iterate the <strong>PointFileFormatCollection</strong> object and extract the name as well as other associated properties like file extension etc.</p>
<p>&#0160;</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01a511aad4f3970c-pi" style="display: inline;"><img alt="Point_File_Formats" class="asset  asset-image at-xid-6a0167607c2431970b01a511aad4f3970c img-responsive" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01a511aad4f3970c-500wi" title="Point_File_Formats" /></a><br />&#0160;</p>
<p>&#0160;</p>
<p>Here is the C# code snippet :</p>
<p>&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">Editor</span><span style="line-height: 140%;"> ed = </span><span style="color: #2b91af; line-height: 140%;">AcadApp</span><span style="line-height: 140%;">.DocumentManager.MdiActiveDocument.Editor;</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">Database</span><span style="line-height: 140%;"> db = </span><span style="color: #2b91af; line-height: 140%;">AcadApp</span><span style="line-height: 140%;">.DocumentManager.MdiActiveDocument.Database;</span>&#0160;</p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">PointFileFormatCollection</span><span style="line-height: 140%;"> ptFileFormatColls = </span><span style="color: #2b91af; line-height: 140%;">PointFileFormatCollection</span><span style="line-height: 140%;">.GetPointFileFormats(db);</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">String</span><span style="line-height: 140%;"> ptFileFormatstring = </span><span style="color: #a31515; line-height: 140%;">&quot;&quot;</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">//start a transaction </span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">Transaction</span><span style="line-height: 140%;"> trans = db.TransactionManager.StartTransaction())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">foreach</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">PointFileFormat</span><span style="line-height: 140%;"> pointFileFormat </span><span style="color: blue; line-height: 140%;">in</span><span style="line-height: 140%;"> ptFileFormatColls)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; {&#0160; &#0160; &#0160; &#0160; &#0160;&#0160; </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; ptFileFormatstring = ptFileFormatstring + </span><span style="color: #a31515; line-height: 140%;">&quot;\nPoint File Format Name : &quot;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; + pointFileFormat.Name.ToString() + </span><span style="color: #a31515; line-height: 140%;">&quot;&#0160;&#0160; &quot;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; + </span><span style="color: #a31515; line-height: 140%;">&quot;File Extension :&#0160; &quot;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; + pointFileFormat.FileExtension.ToString();&#0160; &#0160;&#0160; </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; }</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; ed.WriteMessage(ptFileFormatstring);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; trans.Commit();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
<p>&#0160;</p>
<p>Hope this is useful to you.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Visual Studio .NET settings for Civil 3D 2015
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: visual-studio-net-settings-for-civil-3d-2015

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2014/04/visual-studio-net-settings-for-civil-3d-2015.html 
DATE: 04/25/2014 07:26:46 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>Now that we have released <a href="http://www.autodesk.com/products/autodesk-autocad-civil-3d/free-trial">Civil 3D 2015</a>, you might be wondering what is required to create a .NET addin project for this new release. First, let me point out that if you have a Civil 3D 2014 .NET addin, it should just work on 2015 in compatibility mode (.NET supports older versions).</p>  <p><strong>Platform changes for Civil 3D 2015</strong></p>  <p>There are some major changes you need to consider when creating a new addin. As mentioned, 2014 addins should work in compatibility mode. Here are the main points:</p>  <ul>   <li>Visual Studio 2012 </li>    <li>.NET 4.5 </li>    <li>64 bit only – since 2014 </li>    <li>No Windows XP support </li> </ul>  <p><strong>Configurable AutoCAD &amp; Civil 3D</strong></p>  <p>Now an interesting point: there is no Civil 3D 2015 install folder, it’s actually installed at the same folder as plain AutoCAD and there is a subfolder with Civil 3D specific files: [\Program Files\Autodesk\AutoCAD 2015\C3D]. Actually this change started back on 2014, see more details at <a href="http://adndevblog.typepad.com/autocad/2013/06/new-2014-configurable-autocad-installation-structure.html">this post</a>.</p>  <p>This also means the Civil 3D will actually start AutoCAD with a few parameters. For instance, this is the default icon target for Metric profile: <strong>&quot;C:\Program Files\Autodesk\AutoCAD 2015\acad.exe&quot; /ld &quot;C:\Program Files\Autodesk\AutoCAD 2015\\AecBase.dbx&quot; /p &quot;&lt;&lt;C3D_Metric&gt;&gt;&quot; /product &quot;C3D&quot;</strong></p>  <p>This change will affect our project settings… let’s see.</p>  <p><strong>Required .NET references</strong></p>  <p>First, as usual, we need to add reference to AutoCAD .NET references. Those are required as Civil 3D was build on top of AutoCAD. You may choose to download the <a href="http://www.autodesk.com/objectarx">ObjectARX SDK</a> and get the references from [\ObjectARX 2015\inc] folder or simply get them from [\Program Files\Autodesk\AutoCAD 2015] folder. As Civil 3D 2015 is 64 bit only, there is no relevant difference between them. Here are the AutoCAD references required:</p>  <ol>   <li><strong>AcMgd.dll</strong> – AutoCAD interface objects </li>    <li><strong>AcCoreMgd.dll</strong> – Core objects, used on both AutoCAD and Console </li>    <li><strong>AcDbMgd.dll</strong> – Database objects, required to access the drawing data </li> </ol>  <p>Now, Civil 3D will require its reference. As there is no SDK for Civil 3D, the reference is located [\Program Files\Autodesk\AutoCAD 2015\C3D] folder:</p>  <ol>   <li><strong>AeccDbMgd.dll</strong> – Civil 3D main objects </li> </ol>  <p>When you start writing code, it will complain that another reference is missing. Actually our AEC products share some objects, therefore Civil 3D also needs reference to this common DLL located under AutoCAD [\Program Files\Autodesk\AutoCAD 2015] folder:</p>  <ol>   <li><strong>AecBaseMgd.dll</strong> – AEC common objects, not directly used, but required </li> </ol>  <p>There are some other references, but those 5 are required, all others are optional and only used on specific features;</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01a3fcf98b01970b-pi"><img title="copylocal_false" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; margin-left: 0px; display: inline; border-top-width: 0px; margin-right: 0px" border="0" alt="copylocal_false" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01a73db44afd970d-pi" width="199" align="right" height="297" /></a>By default, Visual Studio will assume the&#160; references are required to run this code and then make a copy of the under the [\bin\] output folder of your .NET project. But, as this addin will load and run inside AutoCAD Civil 3D, the references are already there. <strong>So we need to specify the references as ‘Copy Local’ equals false</strong>. This is extremely important, otherwise Civil 3D will get confused and start crashing randomly. </p>  <p>Finally it’s time to build, but you’ll see a warning saying: “<em>there was a mismatch between the processor architecture of the project being built</em>”. This is somehow expected as the AutoCAD and Civil 3D references are 64 bit and the .NET project is Any CPU. You can simply ignore this warning or go to project settings and change the ‘Platform target’ to ‘x64’ (64 bit).</p>  <p><strong>Setting up Debug options</strong></p>  <p>Now we’re ready to debug the project. As Civil 3D is running as a configurable AutoCAD, you need to specify a few command line arguments. Actually, the same used on the icon. Below is a sample assuming the default install folder with Metric profile.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01a3fcf98b07970b-pi"><img title="debug_VS" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; display: inline; border-top-width: 0px" border="0" alt="debug_VS" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01a3fcf98b0c970b-pi" width="462" height="281" /></a> </p>  <p></p>  <p></p>  <p></p>  <p></p>  <p></p>  <p></p>  <p>That’s it! You should be able to start developing for AutoCAD Civil 3D 2015 with these settings. Next topic, let’s talk about Interop settings.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Steve Hill
EMAIL: steve@redtransitconsultants.com
IP: 108.162.216.232
URL: http://www.redtransitconsultants.com
DATE: 04/25/2014 07:45:19 AM
Thanks Augusto.

Very helpful post. One thing I noticed with 2014 code in 2015 is that even though the code runs, dialog boxes seem to shrink a bit and don't appear as they do in 2014. I'll ultimately be upgrading my apps to VS 2012 specifically for 2015 anyway, but I am curious. Any ideas as to why?
-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 108.162.219.76
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 04/25/2014 07:52:21 AM
Steve,

I'm not aware of any issue. Also, tried on my end (same DLL on both version) and the Forms are exactly the same (size, style, etc).

If you have a repro sample, please send to me, will investigate.

Regards,
Augusto Goncalves
-----
COMMENT:
AUTHOR: saman
EMAIL: saman_b185@yahoo.com
IP: 31.184.151.235
URL: 
DATE: 11/17/2014 11:40:38 PM
Hi
I'm going with the programming language C # in Visual Studio AutoCAD software developed.plz help me.
-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 132.188.64.149
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 11/18/2014 07:15:12 AM
Saman,

These VS settings are independent of language, you need to configure for both VB.NET and C#. If you have a specific question, please use our forum: http://forums.autodesk.com/t5/autocad-civil-3d-customization/bd-p/190

Regards,
Augusto Goncalves
-----
COMMENT:
AUTHOR: Borja1980
EMAIL: Borja_delcampo@hotmail.com
IP: 90.165.187.86
URL: 
DATE: 08/23/2015 02:42:38 PM
Hi. I have done the steps described here, and the proyect compiles perfectly. However, when i start debuging, acad.exe starts executing, and allways crashes. I hace reinstalled visual studio 2012 and civil2015, but the problem persist. I would like to know i somebody has run into a similar problem, and has been able to finde a solution.
Thanks
-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 177.43.194.106
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 08/24/2015 04:42:16 AM
Hi,

I would need more details on what's happening (error message). 

You can also try with the template at http://adndevblog.typepad.com/infrastructure/2014/09/civil-3d-project-template-for-visual-studio.html

Regards,
Augusto Goncalves
-----
COMMENT:
AUTHOR: hade
EMAIL: wrya.hade@yahoo.com
IP: 93.91.194.245
URL: http://www.institueerbil.com
DATE: 09/23/2015 08:58:55 AM
hellow 
 i want create programing for optimazation vertical and horizontal alignment, do you have any sugestion for me.
-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 177.43.194.106
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 09/23/2015 09:13:15 AM
Hi, this could give you a starting point: http://adndevblog.typepad.com/infrastructure/2012/08/replacing-alignment-entities.html

Regards,
Augusto Goncalves
-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Snoop Civil 3D 2015 Database (.bundle format)
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: snoop-civil-3d-2015-database-bundle-format-1
CATEGORY: .NET
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D 2015
CATEGORY: Civil 3D

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2014/04/snoop-civil-3d-2015-database-bundle-format-1.html 
DATE: 04/15/2014 11:21:04 AM
-----
BODY:
<p>The Civil 3D 2015 release is available, you can already download from our <a href="http://www.autodesk.com/products/autodesk-autocad-civil-3d/free-trial">website</a> and check the new APIs <a href="http://adndevblog.typepad.com/infrastructure/2014/03/autocad-civil-3d-2015-new-features-in-net-api-and-com-api-changes.html">here</a>. Now it’s time for our snoop database tool to be ready, actually I’m glad that the code base is the same, mainly because it’s based on reflection and automatically ‘understand’ changes on methods and properties.</p>
<p>Starting from the code posted <a href="http://adndevblog.typepad.com/infrastructure/2013/05/snoop-civil-3d-2014-database-bundle-format.html">here</a>, the new version is ready to download at the link below. Note it still using .NET 4.0 so it can remain compatible with previous release.</p>
<p><span class="asset  asset-generic at-xid-6a0167607c2431970b01a73dab3527970d img-responsive"><a href="http://adndevblog.typepad.com/files/civil3dsnoopdb.bundle-1.zip">Download</a></span></p>
<p>Like previous release, just extract the .zip under <em><span style="text-decoration: underline;">C:\Users\&lt;your login&gt;\AppData\Roaming\Autodesk\ApplicationPlugins</span></em> folder and it will autoload on Civil 3D 2012, 2013, 2014 and 2015. Please note that if you extract under <span style="text-decoration: underline;">C:\ProgramData\Autodesk\ApplicationPlugins</span> it will not load on 2012 version.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Malcolm
EMAIL: mfernandes@rand.com
IP: 24.108.117.131
URL: 
DATE: 09/05/2014 10:48:38 AM
I have IDSU2015, win8.1/64 download the Civil3DSnoopDB.bundle file. 
In my C3D2015, I typed Netload and loaded SnoopCivil3DObjects.dll from the folder Contents/R19 and got the following error.
"Cannot load assembly. Error details: System.IO.FileLoadException: Could not load file or assembly"
-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 76.24.252.243
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 09/05/2014 10:58:02 AM
Hi Malcolm,

Actually you just need to place the .bundle at the specified location, no need to manually NETLOAD the DLL.

That said, you may need to 'unblock' the DLL following this post: http://labs.blogs.com/its_alive_in_the_lab/2011/05/unblock-net.html

Regards,
Augusto Goncalves
-----
COMMENT:
AUTHOR: Michael Gruben
EMAIL: mgruben@usaengineers.com
IP: 12.5.171.242
URL: 
DATE: 04/07/2016 06:25:01 AM
The .zip file provided here does not contain R20 (AutoCAD 2015) .dlls

To obtain the most up-to-date version of Civil3DSnoop, download from the project's GitHub page:

https://github.com/ADN-DevTech/Civil3DSnoop
-----
COMMENT:
AUTHOR: Pierre de la Verre
EMAIL: 
IP: 46.140.68.194
URL: http://profile.typepad.com/6p01bb08a09823970d
DATE: 07/20/2017 05:04:32 AM
Hi to all

it would be great if the tool will be updated for versions 2017 and 2018. Any change to realize it?

Pierre
-----
COMMENT:
AUTHOR: Pierre de la Verre
EMAIL: 
IP: 46.140.68.194
URL: http://profile.typepad.com/6p01bb08a09823970d
DATE: 07/20/2017 05:12:57 AM
Hi

just found the 2017-version here:
https://github.com/ADN-DevTech/Civil3DSnoop/tree/2017

Hoping for a 2018-version coming soon ;-)
-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Snoop Civil 3D 2015 Database (.bundle format)
STATUS: Draft
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: snoop-civil-3d-2015-database-bundle-format

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2014/04/snoop-civil-3d-2015-database-bundle-format.html 
DATE: 04/15/2014 11:20:48 AM
-----
BODY:
<p>The Civil 3D 2015 release is available, you can already download from our <a href="http://www.autodesk.com/products/autodesk-autocad-civil-3d/free-trial">website</a> and check the new APIs <a href="http://adndevblog.typepad.com/infrastructure/2014/03/autocad-civil-3d-2015-new-features-in-net-api-and-com-api-changes.html">here</a>. Now it’s time for our snoop database tool to be ready, actually I’m glad that the code base is the same, mainly because it’s based on reflection and automatically ‘understand’ changes on methods and properties. </p>  <p>Starting from the code posted <a href="http://adndevblog.typepad.com/infrastructure/2013/05/snoop-civil-3d-2014-database-bundle-format.html">here</a>, the new version is ready to download at the link below. Note it still using .NET 4.0 so it can remain compatible with previous release.</p>  <p>Download</p>  <p>Like previous release, just extract the .zip under <em><u>C:\Users\&lt;your login&gt;\AppData\Roaming\Autodesk\ApplicationPlugins</u></em> folder and it will autoload on Civil 3D 2012, 2013, 2014 and 2015. Please note that if you extract under <u>C:\ProgramData\Autodesk\ApplicationPlugins</u> it will not load on 2012 version.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: AutoCAD Map 3D 2015 ObjectARX SDK
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: autocad-map-3d-2015-objectarx-sdk
CATEGORY: .NET
CATEGORY: C++
CATEGORY: Map 3D

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2014/04/autocad-map-3d-2015-objectarx-sdk.html 
DATE: 04/10/2014 10:08:39 PM
-----
BODY:
<p>Those of you, looking for AutoCAD <strong>Map 3D 2015 ObjectARX SDK</strong> to migrate your custom application, here is the link to download it now -&#0160;</p>
<p><a href="http://usa.autodesk.com/adsk/servlet/item?siteID=123112&amp;id=868205">http://usa.autodesk.com/adsk/servlet/item?siteID=123112&amp;id=868205</a></p>
<p>Thanks!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Infraworks 360 Public Pilot
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: infraworks-360-public-pilot
CATEGORY: Augusto Goncalves

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2014/04/infraworks-360-public-pilot.html 
DATE: 04/01/2014 03:44:15 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01a51193f051970c-pi"><img title="infraworks-2015-banner-lockup-331x66" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; margin: 0px 15px 0px 0px; display: inline; border-top-width: 0px" border="0" alt="infraworks-2015-banner-lockup-331x66" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01a73d9efc31970d-pi" width="240" align="left" height="48" /></a> </p>  <p>By now, you’re aware and have started using the <a href="http://www.autodesk.com/products/infraworks-family/overview">Infraworks 360</a>, the Autodesk solution to manage larger-scale infrastructure models created from existing data sources and generate proposals and early design concepts more effectively in the context of the built environment. </p>  <p>The main approach is that we can rapidly generate data-rich proposals to better predict how design alternatives may perform in the existing environment. Even more than that, it leverages the power of the cloud to transform the way infrastructure professionals manage <strong>big data</strong>, create 3D models and collaborate on infrastructure projects.</p>  <p><strong><u>Collaboration on the cloud</u></strong></p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01a51193f059970c-pi"><img title="quantitative-real-time-feedback-thumb-252x150" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; margin-left: 0px; display: inline; border-top-width: 0px; margin-right: 0px" border="0" alt="quantitative-real-time-feedback-thumb-252x150" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01a3fce4330c970b-pi" width="210" align="right" height="127" /></a> Autodesk InfraWorks 360 Pro’s cloud-based technology provides nearly anywhere, anytime access via desktop or mobile devices for stakeholders to view and/or collaborate on project models.</p>  <p>Taking advantage of this collaboration feature, we’ll start a project to design a full magic and legendary world, using the big data approach, crowdsourcing and all well-known APIs designed by Autodesk and used by the community for years.</p>  <p><u><strong>About the pilot</strong></u></p>  <p>As expected, this pilot design project will start with a region that contain all major objects treated by Infraworks 360, including caves, stone trolls and talking forests. The first region will include the <a href="http://en.wikipedia.org/wiki/Mordor">black land of Mordor</a>. </p>  <p>Like any project of this nature, it will start by the entry point, the black gate. The servers are already and in place and the first draft ready, as you can see on image below.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01a3fce43316970b-pi"><img title="black_gate" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; display: inline; border-top-width: 0px" border="0" alt="black_gate" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01a73d9efc45970d-pi" width="493" height="267" /></a><em><font size="1">(Initial gate model downloaded from </font></em><a href="https://3dwarehouse.sketchup.com/model.html?id=237a0777376a823f6a6392f94efcb239"><em><font size="1">here</font></em></a><em><font size="1">)</font></em></p>  <p><strong><u>Count me in!</u></strong></p>  <p>I’m sure that by now you are eager to join the Fellowship, indeed the quest is noble and all those with good heart are welcome to try. But first, as usual, there is a <a href="http://cdn.memegenerator.net/instances/500x/47852614.jpg">Non-Disclosure Agreement (NDA)</a>. Please be fast to join, the Council of Elrond will meet and select one member of each of the Free People.</p>  <p><u><strong>More information - FAQ</strong></u></p>  <p>If you have any questions, please check the following links:</p>  <ul>   <li><a href="http://en.wikipedia.org/wiki/File:Fellowship.JPG">About the team</a> </li>    <li><a href="http://en.wikipedia.org/wiki/One_Ring">Furniture used</a> – Keep it secret. Keep it safe. </li>    <li><a href="http://en.wikipedia.org/wiki/April_Fools%27_Day">Details about timing</a> </li> </ul>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: AutoCAD Civil 3D 2015 - new features in .NET API and COM API changes
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: autocad-civil-3d-2015-new-features-in-net-api-and-com-api-changes
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2015
CATEGORY: Civil 3D
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2014/03/autocad-civil-3d-2015-new-features-in-net-api-and-com-api-changes.html 
DATE: 03/28/2014 02:33:42 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>AutoCAD® Civil 3D® <strong>2015</strong> is just released! In this post I am sharing with you some useful links on what’s new.</p>
<p><strong><a href="http://help.autodesk.com/view/CIV3D/2015/ENU/?guid=GUID-6D41D043-4958-40B7-9C7E-45A6D780955B">New features and updates in AutoCAD® Civil 3D® 2015 .NET API</a></strong>&#0160;</p>
<p>&#0160;</p>
<p><strong><a href="http://help.autodesk.com/view/CIV3D/2015/ENU/?contextId=CIVIL-NEWhttp://help.autodesk.com/view/CIV3D/2015/ENU/?guid=GUID-A2D82D86-C85C-42C0-BA42-B62948A58FDA">New Features in Autodesk® AutoCAD® Civil 3D® 2015</a></strong>&#0160;</p>
<p>&#0160;</p>
<p><strong>COM API Changes</strong> :&#0160; If you are using the COM API, you need to update the object version to <strong>10.4</strong> (from 10.3 used in AutoCAD Civil 3D 2014). The objects and interfaces exposed have remained the same, but you should reference the new libraries, which are installed by default to: C:\Program Files\Common Files\Autodesk Shared\Civil Engineering 104.&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Customized .NET Report in Civil 3D doesn't use 'Report Settings'
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: customized-net-report-in-civil-3d-doesnt-use-report-settings
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: AutoCAD Civil 3D 2014
CATEGORY: Civil 3D
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2014/03/customized-net-report-in-civil-3d-doesnt-use-report-settings.html 
DATE: 03/26/2014 02:13:04 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>If you have created a custom Civil 3D .NET report and added that in Toolbox and then set the units, precision value as shown in the picture below, but to your surprise when you generate the report you find the unit or precision value is not set as per the setting you opted in the &#39;Report Settings&#39; dialogbox.</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01a3fcdf1a80970b-pi" style="display: inline;"><img alt="Report_Settings_Civil3D" class="asset  asset-image at-xid-6a0167607c2431970b01a3fcdf1a80970b img-responsive" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01a3fcdf1a80970b-500wi" title="Report_Settings_Civil3D" /></a><br />&#0160;</p>
<p>&#0160;&#0160;</p>
<p>Reason for this is :&#0160;</p>
<p>.NET reports use a combination of the Report Settings (for Client and Owner settings) and <strong>they use the drawing Ambient Settings</strong> for units, precision, and so on.&#0160;</p>
<p>LandXML reports use the Report Settings for all settings, such as report header information, units, precision, and so on.&#0160;</p>
<p>[Note -&#0160; You can tell if a report is a LandXML-based report if the Export To XML Report dialog box is displayed when you run the report.]</p>
<p>&#0160;</p>
<p>To set the Precision, units for your custom .NET report, use the Drawing Ambient Settings as shown in the picture below -</p>
<p>&#0160;</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01a3fcdf1a85970b-pi" style="display: inline;"><img alt="Drawing_Ambient_Settings" class="asset  asset-image at-xid-6a0167607c2431970b01a3fcdf1a85970b img-responsive" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01a3fcdf1a85970b-500wi" title="Drawing_Ambient_Settings" /></a><br />&#0160;</p>
<p>Hope this is useful to you !</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Road Widening using AutoCAD Civil 3D .NET API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: road-widening-using-autocad-civil-3d-net-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2014
CATEGORY: Civil 3D
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2014/03/road-widening-using-autocad-civil-3d-net-api.html 
DATE: 03/18/2014 02:04:44 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>In AutoCAD Civil 3D, programmatically we can create Offset Alignment using overloaded <strong>Alignment.CreateOffsetAlignment()</strong> API. Once we have created an Offset Alignment, we can call <strong>OffsetAlignmentInfo.AddWidening()</strong> to create a road widening for a specific section of the road.</p>
<p>Here is a C# .NET code snippet demonstrating usage of OffsetAlignmentInfo.<strong>AddWidening()</strong> API :</p>
<p>&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">Transaction</span><span style="line-height: 140%;"> trans = db.TransactionManager.StartTransaction())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">ObjectIdCollection</span><span style="line-height: 140%;"> alignmentIdColl = civilDoc.GetAlignmentIds();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">foreach</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> alignmentId </span><span style="color: blue; line-height: 140%;">in</span><span style="line-height: 140%;"> alignmentIdColl)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; alignment = alignmentId.GetObject(</span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForRead) </span><span style="color: blue; line-height: 140%;">as</span><span style="color: #2b91af; line-height: 140%;">Alignment</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (alignment.Name.ToString() == </span><span style="color: #a31515; line-height: 140%;">&quot;Centerline (1)&quot;</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">break</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; }</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (alignment != </span><span style="color: blue; line-height: 140%;">null</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; {</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// Get a AlignmentStyle Object to use in OffSet Alignment creation</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> offsetAlignmentStyleId = civilDoc.Styles.AlignmentStyles[</span><span style="color: #a31515; line-height: 140%;">&quot;Design Style&quot;</span><span style="line-height: 140%;">];</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (offsetAlignmentStyleId == </span><span style="color: blue; line-height: 140%;">null</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nOffset Alignment Style NOT found !&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">return</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; }</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// Now create the OffSetAlignment</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// A negative value (offset &lt; 0) indicates the Offset Alignment is at the left of the parent alignment.</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// A positive value (offset &gt; 0) indicates the Offset Alignment is at the right.</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="background-color: #ffff00;"><strong><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> offsetAlignmentId = </span><span style="color: #2b91af; line-height: 140%;">Alignment</span><span style="line-height: 140%;">.CreateOffsetAlignment(</span><span style="color: #a31515; line-height: 140%;">&quot;Offset_Alignment&quot;</span><span style="line-height: 140%;">, alignment.ObjectId, -30.00, offsetAlignmentStyleId);</span></strong></span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// Open the Offset Alignment object to add road widening</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">Alignment</span><span style="line-height: 140%;"> offsetAlignment = offsetAlignmentId.GetObject(</span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForWrite) </span><span style="color: blue; line-height: 140%;">as</span><span style="color: #2b91af; line-height: 140%;">Alignment</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">OffsetAlignmentInfo</span><span style="line-height: 140%;"> offsetInfo1 = offsetAlignment.OffsetAlignmentInfo;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// Now use AddWidening( double startStation, double endStation, double offsetDistance )</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// This method will create a specific region from startStation to endStation </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// with slim entry transition and exit transition.</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; <span style="background-color: #ffff00;"><strong>offsetInfo1.AddWidening(200.00, 533.0, 40.0);</strong></span></span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; }&#0160; &#0160; </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; trans.Commit();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
<p>&#0160;</p>
<p>Following picture shows how it appears in AutoCAD Civil 3D :</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01a3fcd87c87970b-pi" style="display: inline;"><img alt="Civil3D_Road_Widening_API" class="asset  asset-image at-xid-6a0167607c2431970b01a3fcd87c87970b img-responsive" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01a3fcd87c87970b-500wi" title="Civil3D_Road_Widening_API" /></a></p>
<p>Hope this is useful to you!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Avijit Jana
EMAIL: 
IP: 123.63.75.164
URL: http://profile.typepad.com/avijan
DATE: 03/19/2014 12:22:18 AM
 It was a nice Code snipe on Civil3D Offset Alignment API.

 Alignment.CreateOffsetAlignment()
 OffsetAlignmentInfo.AddWidening()

offsetInfo1.AddWidening(200.00, 533.0, 40.0);

(Adds a widening with two 0-length linear transitions to the Offset Alignment.)
 
This tow are parity much straight forward.
 
Will it be possible to add Tapper(2.5m) before or after the Offset ?

For sample file can access the link.

https://drive.google.com/?tab=mo&authuser=0#folders/0B6KcEUo0Z1ylTEhKcUNhUm9hek0


If possible with sample code snipe will be great help. 


Regards

Avijit
-----
COMMENT:
AUTHOR: Avijit Jana
EMAIL: 
IP: 123.63.75.164
URL: http://profile.typepad.com/avijan
DATE: 03/19/2014 01:44:34 AM
It was a nice Code snipe on Civil3D Offset Alignment API.

Alignment.CreateOffsetAlignment()
OffsetAlignmentInfo.AddWidening()

offsetInfo1.AddWidening(200.00, 533.0, 40.0);

Adds a widening with two 0-length linear transitions to the Offset Alignment.
 
This are parity much straight forward.

Will it be possible to add Tapper(2.5m) before or after the Offset ?

For Sample data to work on can be found on this link.

https://drive.google.com/?tab=mo&authuser=0#folders/0B6KcEUo0Z1ylTEhKcUNhUm9hek0


if possible with sample code snipe will be great.


Regards

Avijit Jana

WS Atkins


-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 59.92.173.80
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 03/19/2014 03:32:55 AM
Hi Avijit,

I did a quick check and I think to use the 'Transition Length' you need to create a AutoWideningInfo object and set AutoWideningInfo.TransitionLength = double value;

And then use this AutoWideningInfo object in AddAutoWidenings (AutoWideningInfo, SweptCurveLocation)

Hope this helps.

Let me know if you need any further help.

Thanks,
Partha
-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Using MAPTRIM in .NET Application
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: using-maptrim-in-net-application
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2012
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: AutoCAD Civil 3D 2014
CATEGORY: AutoCAD Map 3D 2014
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2014/03/using-maptrim-in-net-application.html 
DATE: 03/11/2014 02:25:08 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p><strong>MAPTRIM</strong> is AutoCAD Map 3D&#39;s UI command. API equivalent for MAPTRIM is <strong>map_dwgtrimobj(). </strong>&#0160;It is part of the C/C++ and LISP APIs.&#0160;API equivalent of MAPTRIM is not yet available in <a class="zem_slink" href="http://www.microsoft.com/net" rel="homepage" target="_blank" title=".NET Framework">.NET</a>.</p>
<p>&#0160;</p>
<p>If you want to use MAPTRIM with necessary input parameters, you can build the command string and use <strong>SendCommand()</strong> or <strong>SendStringToExecute()</strong> to pump the command in AutoCAD Map 3D&#39;s command line.</p>
<p>&#0160;</p>
<p>Here is code snippet on how to use it for a selected layer and for all layers :&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">&#39;&#39; Using Maptrim command through SendCommand</span></p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">&#39;&#39; in the following example &#39;miscellaneous0&#39; is the layer name for selection </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> commandStr </span><span style="color: blue; line-height: 140%;">As</span><span style="color: blue; line-height: 140%;">String</span><span style="line-height: 140%;"> = </span><span style="color: #a31515; line-height: 140%;">&quot;.maptrim &quot;</span><span style="line-height: 140%;"> +</span><span style="color: #a31515; line-height: 140%;">&quot;s &quot;</span><span style="line-height: 140%;"> +</span><span style="color: #a31515; line-height: 140%;">&quot;l &quot;</span><span style="line-height: 140%;"> +</span><span style="color: #a31515; line-height: 140%;">&quot;y &quot;</span><span style="line-height: 140%;"> +</span><span style="color: #a31515; line-height: 140%;">&quot;miscellaneous0&quot;</span><span style="line-height: 140%;"> + vbCr +</span><span style="color: #a31515; line-height: 140%;">&quot;n &quot;</span><span style="line-height: 140%;"> + </span><span style="color: #a31515; line-height: 140%;">&quot;o &quot;</span><span style="line-height: 140%;"> + </span><span style="color: #a31515; line-height: 140%;">&quot;y &quot;</span><span style="line-height: 140%;"> + </span><span style="color: #a31515; line-height: 140%;">&quot;y &quot;</span><span style="line-height: 140%;"> + </span><span style="color: #a31515; line-height: 140%;">&quot;i &quot;</span><span style="line-height: 140%;"> + </span><span style="color: #a31515; line-height: 140%;">&quot;y &quot;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; acApp.ActiveDocument.SendCommand(commandStr)</span></p>
<p style="margin: 0px;">&#0160;</p>
</div>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">&#39;&#39; Using Maptrim command through SendCommand</span></p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">&#39;&#39; this example is for all Layers </span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> commandStr </span><span style="color: blue; line-height: 140%;">As</span><span style="color: blue; line-height: 140%;">String</span><span style="line-height: 140%;"> = </span><span style="color: #a31515; line-height: 140%;">&quot;.maptrim &quot;</span><span style="line-height: 140%;"> +</span><span style="color: #a31515; line-height: 140%;">&quot;s &quot;</span><span style="line-height: 140%;"> +</span><span style="color: #a31515; line-height: 140%;">&quot;l &quot;</span><span style="line-height: 140%;"> +</span><span style="color: #a31515; line-height: 140%;">&quot;n &quot;</span><span style="line-height: 140%;"> +</span><span style="color: #a31515; line-height: 140%;">&quot;n &quot;</span><span style="line-height: 140%;"> + </span><span style="color: #a31515; line-height: 140%;">&quot;o &quot;</span><span style="line-height: 140%;"> + </span><span style="color: #a31515; line-height: 140%;">&quot;y &quot;</span><span style="line-height: 140%;"> + </span><span style="color: #a31515; line-height: 140%;">&quot;y &quot;</span><span style="line-height: 140%;"> + </span><span style="color: #a31515; line-height: 140%;">&quot;i &quot;</span><span style="line-height: 140%;"> + </span><span style="color: #a31515; line-height: 140%;">&quot;y &quot;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">acApp.ActiveDocument.SendCommand(commandStr)</span></p>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Extra Surfaces are available using Civil 3D API than what is shown / visible in UI
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: extra-surfaces-are-available-using-civil-3d-api-than-what-is-shown-visible-in-ui
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: AutoCAD Civil 3D 2014
CATEGORY: Civil 3D
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2014/03/extra-surfaces-are-available-using-civil-3d-api-than-what-is-shown-visible-in-ui.html 
DATE: 03/06/2014 01:32:24 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>Have you come across a situation where in you get more number of Civil 3D Surface objects using <a class="zem_slink" href="http://en.wikipedia.org/wiki/Application_programming_interface" rel="wikipedia" target="_blank" title="Application programming interface">API</a> than what is shown / visible in AutoCAD Civil 3D User Interface (<a class="zem_slink" href="http://en.wikipedia.org/wiki/User_interface" rel="wikipedia" target="_blank" title="User interface">UI</a>) in Toolspace -&gt;Prospector Tab ?</p>
<p>I have come across few such DWG files where-in I got more number of Surfaces using API than what is shown in Civil 3D UI Toolspace. Interestingly all those files came to me from external sources and I have no idea how those DWG files were created.</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01a73d88ba97970d-pi" style="display: inline;"><img alt="Extra_Surfaces_In_API" class="asset  asset-image at-xid-6a0167607c2431970b01a73d88ba97970d img-responsive" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01a73d88ba97970d-500wi" title="Extra_Surfaces_In_API" /></a></p>
<p><br />&#0160;</p>
<p>AutoCAD Civil 3D UI only iterate and shows all the Surfaces in the layouts. However in the current API implementation, we find all the surfaces in the drawing, including all the blocks and that&#39;s why we see more number of Surfaces using API.</p>
<p>So, how do you get the actual surfaces those are visible in Civil 3D UI Toolspace ?</p>
<p>Here is the relevant code snippet that demonstrates how you can get the Surfaces which are available / shown in UI Toolspace :&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; </span></p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">Editor</span><span style="line-height: 140%;"> ed = </span><span style="color: #2b91af; line-height: 140%;">AcadApp</span><span style="line-height: 140%;">.DocumentManager.MdiActiveDocument.Editor;</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">Database</span><span style="line-height: 140%;"> db = </span><span style="color: #2b91af; line-height: 140%;">AcadApp</span><span style="line-height: 140%;">.DocumentManager.MdiActiveDocument.Database;</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">Transaction</span><span style="line-height: 140%;"> trans = db.TransactionManager.StartTransaction())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">CivilDocument</span><span style="line-height: 140%;"> civilDoc = </span><span style="color: #2b91af; line-height: 140%;">CivilApplication</span><span style="line-height: 140%;">.ActiveDocument;&#0160; &#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">ObjectIdCollection</span><span style="line-height: 140%;"> surfaceIds = civilDoc.GetSurfaceIds();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">ObjectIdCollection</span><span style="line-height: 140%;"> surfaceVisibleinUI= </span><span style="color: blue; line-height: 140%;">new</span><span style="color: #2b91af; line-height: 140%;">ObjectIdCollection</span><span style="line-height: 140%;">();</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// iterate through the list of all the surface objects</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">foreach</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> surfaceId </span><span style="color: blue; line-height: 140%;">in</span><span style="line-height: 140%;"> surfaceIds)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; Autodesk.Civil.DatabaseServices.</span><span style="color: #2b91af; line-height: 140%;">Surface</span><span style="line-height: 140%;"> surface = surfaceId.GetObject(</span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForRead) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> Autodesk.Civil.DatabaseServices.</span><span style="color: #2b91af; line-height: 140%;">Surface</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">BlockTableRecord</span><span style="line-height: 140%;"> record = surface.OwnerId.GetObject(</span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForRead) </span><span style="color: blue; line-height: 140%;">as</span><span style="color: #2b91af; line-height: 140%;">BlockTableRecord</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (<span style="background-color: #ffff00;"><strong>record.IsLayout</strong></span>)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; surfaceVisibleinUI.Add(surfaceId);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nTotal Number of Surfaces available in this DWG file&#0160; : &quot;</span><span style="line-height: 140%;"> + surfaceIds.Count.ToString());</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\n ------------------------------------------------------------- \n&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nTotal Number of Surfaces Visible in UI&#0160; : &quot;</span><span style="line-height: 140%;"> + surfaceVisibleinUI.Count.ToString());</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}&#0160; &#0160; &#0160;&#0160; </span></p>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Steve Hill
EMAIL: stevenh0616@gmail.com
IP: 173.161.87.41
URL: http://beyondcivil3d.blogspot.com
DATE: 03/06/2014 06:09:08 AM
Great post. Always wondered what that IsLayout method was for.
-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 59.92.160.141
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 03/06/2014 07:15:05 AM
Thanks Steve !
I am glad that you liked it :)

Thanks !
Partha
-----
COMMENT:
AUTHOR: Andrew Puller
EMAIL: andrewp@maitland.nsw.gov.au
IP: 203.12.148.20
URL: 
DATE: 03/06/2014 04:30:39 PM
Thanks for that post. It explains an issue I have not gotten around to finding out what the cause was, as it was only occurring in the occasional drawing.
-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 203.202.234.243
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 03/06/2014 08:52:34 PM
You are welcome Andrew !

Thanks,
Partha
-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Creating AutoCAD Civil 3D Pipe Label using .NET API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: creating-autocad-civil-3d-pipe-label-using-net-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2014
CATEGORY: Civil 3D

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2014/03/creating-autocad-civil-3d-pipe-label-using-net-api.html 
DATE: 03/03/2014 03:05:12 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>In AutoCAD Civil 3D we can conveniently add labels to Pipe / PipeNetwork using UI tools / commands as shown in the screenshot below :</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01a73d8600b9970d-pi" style="display: inline;"><img alt="Civil3D_Pipe_Label_UI_Tools" class="asset  asset-image at-xid-6a0167607c2431970b01a73d8600b9970d img-responsive" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01a73d8600b9970d-500wi" title="Civil3D_Pipe_Label_UI_Tools" /></a><br />&#0160;</p>
<p>&#0160;</p>
<p>If you want to add Labels to Civil 3D Pipe objects without any user interaction, you can use <strong>PipeLabel.Create()</strong> .NET API.</p>
<p>Here is a C# .NET code snippet demonstrating the how to add a Pipe Label :&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> pipeID = ed.GetEntity(opt).ObjectId;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">CivilDocument</span><span style="line-height: 140%;"> civildoc = </span><span style="color: #2b91af; line-height: 140%;">CivilApplication</span><span style="line-height: 140%;">.ActiveDocument;</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">Transaction</span><span style="line-height: 140%;"> ts = </span><span style="color: #2b91af; line-height: 140%;">AcadApp</span><span style="line-height: 140%;">.DocumentManager.MdiActiveDocument.Database.TransactionManager.StartTransaction())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// We will use PipeLabel.Create()</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// public static ObjectId Create(&#0160; ObjectId pipeId,&#0160; double ratio,&#0160; ObjectId labelStyleId )</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// pipeId - Type: ObjectId // The ObjectId of Pipe on which the label is located.</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// ratio - Type: System.Double // The relative position of the label to the pipe.</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// labelStyleId - Type: ObjectId // The ObjectId of a PipeLabel style to use.</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> labelStyleId = civildoc.Styles.LabelStyles.PipeLabelStyles.PlanProfileLabelStyles[0];</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="background-color: #ffff00;"><strong><span style="color: #2b91af; line-height: 140%;">PipeLabel</span></strong></span><span style="line-height: 140%;"><span style="background-color: #ffff00;"><strong>.Create(pipeID, 0.5, labelStyleId);&#0160; &#0160; &#0160;</strong></span> &#0160; &#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; ts.Commit();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
<p>&#0160;</p>
<p>And the result in Civil 3D :</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01a5117ac300970c-pi" style="display: inline;"><img alt="Civil3D_Pipe_Label_Using_API" class="asset  asset-image at-xid-6a0167607c2431970b01a5117ac300970c img-responsive" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01a5117ac300970c-500wi" title="Civil3D_Pipe_Label_Using_API" /></a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Setting the Working Folder for Civil 3D Survey Projects using .NET API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: setting-the-working-folder-for-civil-3d-survey-projects-using-net-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2014
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2014/02/setting-the-working-folder-for-civil-3d-survey-projects-using-net-api.html 
DATE: 02/24/2014 08:40:53 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>Using AutoCAD Civil 3D UI tools we can conveniently set the working folder for Survey Projects.</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01a73d808c96970d-pi" style="display: inline;"><img alt="Civil3D_Survey_SetWorkingFolder" class="asset  asset-image at-xid-6a0167607c2431970b01a73d808c96970d img-responsive" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01a73d808c96970d-500wi" title="Civil3D_Survey_SetWorkingFolder" /></a><br />&#0160;</p>
<p>&#0160;</p>
<p>If you want to do the same using Civil 3D .NET API, you need to use <strong>SurveyProjectCollection.WorkingFolder</strong> API. Using this API we can <em><strong>get</strong> </em>or <em><strong>set</strong></em> the working folder for survey projects.</p>
<p>&#0160;</p>
<p>Here is a C# .NET code snippet on how to use this API :&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">SurveyProjectCollection</span><span style="line-height: 140%;"> surveyProjColl = </span><span style="color: #2b91af; line-height: 140%;">CivilApplication</span><span style="line-height: 140%;">.SurveyProjects;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// print the current working folder name</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nSurvey Projects Working Folder Before Change : &quot;</span><span style="line-height: 140%;"> + surveyProjColl.WorkingFolder.ToString());</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// now change the working folder location</span></p>
<p style="margin: 0px;"><span style="background-color: #ffff00;"><strong><span style="line-height: 140%;">surveyProjColl.WorkingFolder = </span><span style="color: #a31515; line-height: 140%;">&quot;c:\\Temp&quot;</span><span style="line-height: 140%;">;</span></strong></span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// print the current working folder name after change </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nSurvey Projects Working Folder After Change : &quot;</span><span style="line-height: 140%;"> + surveyProjColl.WorkingFolder.ToString());</span></p>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Updating PipeLabel Style using Civil 3D API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: updating-pipelabel-style-using-civil-3d-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: AutoCAD Civil 3D 2014
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2014/02/updating-pipelabel-style-using-civil-3d-api.html 
DATE: 02/13/2014 01:08:17 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>&#0160;</p>
<p><strong>Label.StyleName</strong> API allows to <strong>get</strong> or <strong>set</strong> the Entity object&#39;s style name and we can use this to update PipeLabel Style.</p>
<p>Here is a C# .NET code snippet :</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">PipeLabel</span><span style="line-height: 140%;"> pipeLbl = ts.GetObject(pipeLblID, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForWrite) </span><span style="color: blue; line-height: 140%;">as</span><span style="color: #2b91af; line-height: 140%;">PipeLabel</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Label.StyleName Property -&gt; Gets or sets the Entity object&#39;s style name.&#0160; &#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nStyle Name Before Change : &quot;</span><span style="line-height: 140%;"> + pipeLbl.StyleName.ToString());</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Now update the Style</span></p>
<p style="margin: 0px;"><span style="background-color: #ffff00;"><strong><span style="line-height: 140%;">pipeLbl.StyleName = </span><span style="color: #a31515; line-height: 140%;">&quot;2D Length - Total Span&quot;</span><span style="line-height: 140%;">;</span></strong></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nStyle Name After Change : &quot;</span><span style="line-height: 140%;"> + pipeLbl.StyleName.ToString());</span></p>
</div>
<p>&#0160;</p>
<p>In the following screenshot we can see a particular Label Style being used for Pipe Object in Civil 3D.</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01a3fcbbc47d970b-pi" style="display: inline;"><img alt="Pipe_Label_Before_Change" class="asset  asset-image at-xid-6a0167607c2431970b01a3fcbbc47d970b img-responsive" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01a3fcbbc47d970b-500wi" title="Pipe_Label_Before_Change" /></a><br />&#0160;</p>
<p>And here we see by updating the StyleName how the Label style is changed :</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01a5116b789b970c-pi" style="display: inline;"><img alt="Pipe_Label_After_Change" class="asset  asset-image at-xid-6a0167607c2431970b01a5116b789b970c img-responsive" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01a5116b789b970c-500wi" title="Pipe_Label_After_Change" /></a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Creating Civil 3D TIN Surface from Contours (Polylines) using .NET API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: creating-civil-3d-tin-surface-from-contours-polylines-using-net-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: AutoCAD Civil 3D 2014
CATEGORY: Civil 3D
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2014/01/creating-civil-3d-tin-surface-from-contours-polylines-using-net-api.html 
DATE: 01/28/2014 05:12:24 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>You have a <a class="zem_slink" href="http://en.wikipedia.org/wiki/.dwg" rel="wikipedia" target="_blank" title=".dwg">DWG</a> file with <a class="zem_slink" href="http://en.wikipedia.org/wiki/Contour_line" rel="wikipedia" target="_blank" title="Contour line">contour lines</a> which are actually polylines with elevation values and you want to create a Civil 3D TIN Surface using those Polylines.</p>
<p>Here is a screenshot which shows few Polylines in a DWG file :</p>
<p>&#0160; <a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01a73d682b8e970d-pi" style="display: inline;"><img alt="Civil3D_Contour_Lines" class="asset  asset-image at-xid-6a0167607c2431970b01a73d682b8e970d img-responsive" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01a73d682b8e970d-500wi" title="Civil3D_Contour_Lines" /></a></p>
<p>&#0160;</p>
<p>&#0160;</p>
<p>If want to create a Civil 3D TIN Surface using these Polylines, first you need to create an empty TinSurface by using <strong>TinSurface.Create()</strong> <a class="zem_slink" href="http://en.wikipedia.org/wiki/Application_programming_interface" rel="wikipedia" target="_blank" title="Application programming interface">API</a> and then using <strong>SurfaceOperationAddContour.AddContours()</strong> API you need to add the Polylines to the TinSurface.&#0160;</p>
<p>Here is a C#<a class="zem_slink" href="http://www.microsoft.com/net" rel="homepage" target="_blank" title=".NET Framework">.NET</a> code snippet :</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Get the AutoCAD Editor</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">Editor</span><span style="line-height: 140%;"> ed = </span><span style="color: #2b91af; line-height: 140%;">AcadApp</span><span style="line-height: 140%;">.DocumentManager.MdiActiveDocument.Editor;</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">Database</span><span style="line-height: 140%;"> db = </span><span style="color: #2b91af; line-height: 140%;">AcadApp</span><span style="line-height: 140%;">.DocumentManager.MdiActiveDocument.Database;</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">CivilDocument</span><span style="line-height: 140%;"> civilDoc = </span><span style="color: #2b91af; line-height: 140%;">CivilApplication</span><span style="line-height: 140%;">.ActiveDocument;</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">Transaction</span><span style="line-height: 140%;"> trans = db.TransactionManager.StartTransaction())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">try</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// Select a Surface style to use </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> styleId = civilDoc.Styles.SurfaceStyles[</span><span style="color: #a31515; line-height: 140%;">&quot;Slope Banding (2D)&quot;</span><span style="line-height: 140%;">];</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">//Contour Entities collection</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">ObjectIdCollection</span><span style="line-height: 140%;"> contourEntitiesIdColl = </span><span style="color: blue; line-height: 140%;">new</span><span style="color: #2b91af; line-height: 140%;">ObjectIdCollection</span><span style="line-height: 140%;">();</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// In the following line I use a custom function GetContourEntities() </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// which creates a collection of all the contour polyline Ids</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; contourEntitiesIdColl = GetContourEntities(); </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (styleId != </span><span style="color: blue; line-height: 140%;">null</span><span style="line-height: 140%;"> &amp;&amp; contourEntitiesIdColl != </span><span style="color: blue; line-height: 140%;">null</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: green; line-height: 140%;">// Create an empty TIN Surface</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="background-color: #ffff00;"><strong><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> surfaceId = </span><span style="color: #2b91af; line-height: 140%;">TinSurface</span><span style="line-height: 140%;">.Create(</span><span style="color: #a31515; line-height: 140%;">&quot;TIN_Surface_From_Contours&quot;</span><span style="line-height: 140%;">, styleId);</span></strong></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">TinSurface</span><span style="line-height: 140%;"> surface = trans.GetObject(surfaceId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForWrite) </span><span style="color: blue; line-height: 140%;">as</span><span style="color: #2b91af; line-height: 140%;">TinSurface</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: green; line-height: 140%;">//public SurfaceOperationAddContour AddContours( ObjectIdCollection contourEntities, double midOrdinateDistance,</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: green; line-height: 140%;">// double maximumDistance,&#0160; double weedingDistance,&#0160; double weedingAngle )</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; <span style="background-color: #ffff00;"><strong>surface.ContoursDefinition.AddContours(contourEntitiesIdColl, 1.0, 100.00, 15.0, 4.0);&#0160;</strong></span> &#0160; &#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; }&#0160;&#0160; </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; trans.Commit();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; }</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">catch</span><span style="line-height: 140%;"> (System.</span><span style="color: #2b91af; line-height: 140%;">Exception</span><span style="line-height: 140%;"> ex)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// handle the exception</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;Surface Creation from Contours Failed !&quot;</span><span style="line-height: 140%;"> + </span><span style="color: #a31515; line-height: 140%;">&quot;&#0160; &quot;</span><span style="line-height: 140%;"> +&#0160; ex.Message);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; }</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
<p>&#0160;</p>
<p>&#0160;</p>
<p>And a TinSurface created using Polylines :</p>
<p>&#0160;</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01a5115c97f0970c-pi" style="display: inline;"><img alt="Civil3D_Contour_Lines_used2create_TinSurface" class="asset  asset-image at-xid-6a0167607c2431970b01a5115c97f0970c img-responsive" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01a5115c97f0970c-500wi" title="Civil3D_Contour_Lines_used2create_TinSurface" /></a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Adding Bands data to Civil 3D Profile View using .NET API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: adding-bands-data-to-civil-3d-profile-view-using-net-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2014
CATEGORY: Civil 3D
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2014/01/adding-bands-data-to-civil-3d-profile-view-using-net-api.html 
DATE: 01/20/2014 10:40:39 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>In this example we see how to add Profile View data bands to a Profile View in AutoCAD Civil 3D using .NET API.</p>
<p>Here we add the band for the top band. In AutoCAD Civil 3D &quot;Profile View Properties&quot; dialog box, you will notice &#39;Location&#39; drop down box under the &#39;List of Bands&#39; and it has two options -&#0160; &#39;Top of Profile View&#39; or &#39;Bottom of Profile View&#39;. In this example I am going to add a new band in the &#39;Top of Profile View&#39;.</p>
<p>&#0160;</p>
<p>Top of Profile View before adding the data band :</p>
<p>&#0160; <a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01a51134ca06970c-pi" style="display: inline;"><img alt="Civil_3D_ProfileView_TopBand_Empty" class="asset  asset-image at-xid-6a0167607c2431970b01a51134ca06970c img-responsive" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01a51134ca06970c-500wi" title="Civil_3D_ProfileView_TopBand_Empty" /></a></p>
<p>&#0160;</p>
<p>And After adding the data band :</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b019b0511a9c1970d-pi" style="display: inline;"><img alt="Civil_3D_ProfileView_TopBand_API" class="asset  asset-image at-xid-6a0167607c2431970b019b0511a9c1970d img-responsive" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b019b0511a9c1970d-500wi" title="Civil_3D_ProfileView_TopBand_API" /></a><br />&#0160;</p>
<p>And here is the C# .NET code snippet :&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">Database</span><span style="line-height: 140%;"> db = </span><span style="color: #2b91af; line-height: 140%;">AcadApp</span><span style="line-height: 140%;">.DocumentManager.MdiActiveDocument.Database;</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">Transaction</span><span style="line-height: 140%;"> trans = db.TransactionManager.StartTransaction())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">CivilDocument</span><span style="line-height: 140%;"> civilDoc = </span><span style="color: #2b91af; line-height: 140%;">CivilApplication</span><span style="line-height: 140%;">.ActiveDocument;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">//open the profile view</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">ProfileView</span><span style="line-height: 140%;"> pv = trans.GetObject(pvId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForWrite) </span><span style="color: blue; line-height: 140%;">as</span><span style="color: #2b91af; line-height: 140%;">ProfileView</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">//get the style of the first Bottom Bands&#0160; &#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> bandStyleId = pv.Bands.GetBottomBandItems()[0].BandStyleId;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">//now access the collection of top band</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">ProfileViewBandItemCollection</span><span style="line-height: 140%;"> topBandItems = pv.Bands.GetTopBandItems();&#0160; &#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">//add a new one (using the above style)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; topBandItems.Add(bandStyleId);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">//now Set the Top Bands</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; pv.Bands.SetTopBandItems(topBandItems);&#0160; &#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; trans.Commit();</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Updating Civil 3D Corridor BaseLineRegion Start and End Stations using API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: updating-civil-3d-corridor-baselineregion-start-and-end-stations-using-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2014
CATEGORY: Civil 3D
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2014/01/updating-civil-3d-corridor-baselineregion-start-and-end-stations-using-api.html 
DATE: 01/17/2014 12:30:08 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>In <a href="http://adndevblog.typepad.com/infrastructure/2013/04/adding-removing-baselineregion-using-net-api.html" target="_blank">this</a> earlier blog <a href="http://adndevblog.typepad.com/infrastructure/2013/04/adding-removing-baselineregion-using-net-api.html" target="_blank">post</a>, I demonstrated how to Add / Remove BaseLineRegion in <a class="zem_slink" href="http://construction-project-management-software.findthebest.com/l/70/AutoCAD" rel="fdbsoftware" target="_blank" title="AutoCAD">AutoCAD Civil 3D</a> using <a class="zem_slink" href="http://www.microsoft.com/net" rel="homepage" target="_blank" title=".NET Framework">.NET</a> <a class="zem_slink" href="http://en.wikipedia.org/wiki/Application_programming_interface" rel="wikipedia" target="_blank" title="Application programming interface">API</a>. In one of the <a href="http://forums.autodesk.com/t5/AutoCAD-Civil-3D-Customization/Corridor-BaseLine-Region/td-p/4755079" target="_blank">questions </a>in AutoCAD Civil 3D Customization Forum, I see a developer having an issue in editing the Corridor Baseline Region start and end station. In the <a href="http://docs.autodesk.com/CIV3D/2014/ENU/API_Reference_Guide/" target="_blank">Civil 3D API reference</a> document I see the <strong>BaselineRegion.StartStation</strong> and <strong>BaselineRegion.EndStation</strong> properties are <strong>Get</strong> and <strong>Set</strong> i.e. we can Get the station values as well as we Set them. I thought to give it a try to confirm they are working as per the API reference doc and I do find we can Get as well as Set the station values.</p>
<p>&#0160;</p>
<p>Here is the working C# .NET code snippet :&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">Corridor</span><span style="line-height: 140%;"> corridor = trans.GetObject(corridorId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForWrite) </span><span style="color: blue; line-height: 140%;">as</span><span style="color: #2b91af; line-height: 140%;">Corridor</span><span style="line-height: 140%;">;&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Get the BaselineRegionCollection</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">BaselineRegionCollection</span><span style="line-height: 140%;"> baselineRegionColl = corridor.Baselines[0].BaselineRegions;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Get the BaselineRegion to update the Start and End Station</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">BaselineRegion</span><span style="line-height: 140%;"> baselineregion = baselineRegionColl[</span><span style="color: #a31515; line-height: 140%;">&quot;Corridor Region (1)&quot;</span><span style="line-height: 140%;">];</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (baselineregion != </span><span style="color: blue; line-height: 140%;">null</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\n BaseLineRegion Start Station Before Update : &quot;</span><span style="line-height: 140%;"> + baselineregion.StartStation.ToString());</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\n BaseLineRegion End&#0160;&#0160; Station Before Update : &quot;</span><span style="line-height: 140%;"> + baselineregion.EndStation.ToString());</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// update the stations Value</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;<span style="background-color: #ffff00;"> baselineregion.StartStation = 50.00;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%; background-color: #ffff00;">&#0160; baselineregion.EndStation = 568.00;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">//rebuild the corridor</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; corridor.Rebuild();</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\n BaseLineRegion Start Station After Update : &quot;</span><span style="line-height: 140%;"> + baselineregion.StartStation.ToString());</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\n BaseLineRegion End&#0160;&#0160; Station After Update : &quot;</span><span style="line-height: 140%;"> + baselineregion.EndStation.ToString());</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">}&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span></p>
</div>
<p>&#0160;</p>
<p>And the result in AutoCAD Civil 3D 2014 :</p>
<p>&#0160;</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01a51103e9e4970c-pi" style="display: inline;"><img alt="Civil_3D_Corridor_Baseline_Station_Update_API" class="asset  asset-image at-xid-6a0167607c2431970b01a51103e9e4970c img-responsive" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01a51103e9e4970c-500wi" title="Civil_3D_Corridor_Baseline_Station_Update_API" /></a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: AUTOCAD CIVIL 3D 2014 Developer’s Guide
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: autocad-civil-3d-2014-developers-guide
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2014
CATEGORY: Civil 3D
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2014/01/autocad-civil-3d-2014-developers-guide.html 
DATE: 01/15/2014 02:02:07 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>AUTOCAD CIVIL 3D 2014 <strong>Developer’s Guide</strong> link given in this earlier <a href="http://adndevblog.typepad.com/infrastructure/2013/04/autocad-civil-3d-2014-developer-documents.html" target="_blank">blog post</a> as well as in <a href="http://usa.autodesk.com/adsk/servlet/index?siteID=123112&amp;id=21329326" target="_blank">AutoCAD Civil 3D Services &amp; Support</a> page is temporarily unavailable.</p>
<p>If you are looking for the working link for immediate reference, here it is :</p>
<p><a href="http://docs.autodesk.com/CIV3D/2014/ENU/Developers_Guide/index.html" target="_blank">AUTOCAD CIVIL 3D 2014 Developer’s Guide</a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: arthur
EMAIL: arthurfy@foxmail.com
IP: 59.42.158.42
URL: 
DATE: 01/16/2014 12:38:22 AM
I have a problem in finding Intersections between cad line and civil tinsurface. In civil 3d 2010, there is a method,varIntPt = objSurf.IntersectPointWithSurface(varStartPt, varDir), but the method .IntersectPointWithSurface is not usable in civil 3d 2012. I used C3dSurface.IntersectWith(acLine, Intersect.OnBothOperands, IntersectPoint3d, 0, 0), but it can not find Intersections.
      Could you tell me which method we can use to find Intersections between cad line and civil tinsurface.

-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 203.202.234.243
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 01/16/2014 01:12:49 AM
Hi Arthur,

I don't have Civil 3D 2012 at the moment in my machine to check what's the issue with IntersectPointWithSurface(), however in Civil 3D 2014 .NET API I see the following which should be useful for you -

Surface.GetIntersectionPoint()

-> Gets the intersection point with surface by the specified point and vector.

http://docs.autodesk.com/CIV3D/2014/ENU/API_Reference_Guide/html/d741aa49-e7da-9513-6b0b-226ebe3fa43f.htm

Thanks,
Partha
-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Get the Civil 3D Label Expression using .NET API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: get-the-civil-3d-label-expression-using-net-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: AutoCAD Civil 3D 2014
CATEGORY: Civil 3D
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2014/01/get-the-civil-3d-label-expression-using-net-api.html 
DATE: 01/08/2014 01:51:40 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>In AutoCAD Civil 3D, by using expressions, we can set up separate mathematical formulas using the existing properties. Expressions are unique to a particular label style type. Only those properties that are relevant to the label style type are available in the Expressions dialog box.&#0160;</p>
<p>After you set up expressions, they are available in the Properties list in the Text Component Editor so that you can add them to label styles. In effect, expressions become new properties that you can use to compose a label style.</p>
<p>&#0160;</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01a3fbdf4dfc970b-pi" style="display: inline;"><img alt="Lable_Expression" class="asset  asset-image at-xid-6a0167607c2431970b01a3fbdf4dfc970b" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01a3fbdf4dfc970b-500wi" title="Lable_Expression" /></a><br />&#0160;</p>
<p>&#0160;</p>
<p>Now if you want to access the expression formula / string used for a particular Label style using <a class="zem_slink" href="http://en.wikipedia.org/wiki/Application_programming_interface" rel="wikipedia" target="_blank" title="Application programming interface">API</a>, its simple, you need to get the <strong>ExpressionCollection</strong> for that Label Styles collection.</p>
<p>Here is a C# .NET code snippet demonstrating how to access an expression formula used for AlignmentLabelStyles :</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">Transaction</span><span style="line-height: 140%;"> trans = db.TransactionManager.StartTransaction())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// Get the desired Lable Styles collection</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">LabelStyleCollection</span><span style="line-height: 140%;"> lblStyleColl = civilDoc.Styles.LabelStyles.AlignmentLabelStyles.GeometryPointLabelStyles;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// Now get the Expression collection</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// Expressions are unique to a particular label style type. </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">ExpressionCollection</span><span style="line-height: 140%;"> expColl = lblStyleColl.Expressions;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">try</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">foreach</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">Expression</span><span style="line-height: 140%;"> lblExp </span><span style="color: blue; line-height: 140%;">in</span><span style="line-height: 140%;"> expColl)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\n Expression Name : &quot;</span><span style="line-height: 140%;"> + lblExp.Name);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\n Expression String : &quot;</span><span style="line-height: 140%;"> + lblExp.ExpressionString);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; trans.Commit();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; }</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">catch</span><span style="line-height: 140%;"> (Autodesk.AutoCAD.Runtime.</span><span style="color: #2b91af; line-height: 140%;">Exception</span><span style="line-height: 140%;"> ex)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\n Exception message :&quot;</span><span style="line-height: 140%;"> + ex.Message);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; }</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;"> <a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b019b046badc7970d-pi" style="display: inline;"><img alt="Lable_Expression_API" class="asset  asset-image at-xid-6a0167607c2431970b019b046badc7970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b019b046badc7970d-500wi" title="Lable_Expression_API" /></a><br /></span></p>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Merry Christmas & Happy New Year !
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: merry-christmas-happy-new-year-
CATEGORY: Civil 3D
CATEGORY: Events
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/12/merry-christmas-happy-new-year-.html 
DATE: 12/23/2013 04:30:00 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>Hope you enjoyed reading our posts in <a href="http://adndevblog.typepad.com/infrastructure/" target="_self">ADN DevBlog - Infrastructure Modeling</a> throughout this year!</p>
<p>It&#39;s time to take a break ! And when we come back in new year - 2014, we will start again with renewed sustainable energy :)&#0160;&#0160;</p>
<p>&#0160;</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01a3faf724f2970b-pi" style="display: inline;"><img alt="IM DevBlog Merry Christmas" class="asset  asset-image at-xid-6a0167607c2431970b01a3faf724f2970b" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01a3faf724f2970b-500wi" title="IM DevBlog Merry Christmas" /></a><br />&#0160;</p>
<p>Merry Christmas, Happy holidays and a very Happy New Year 2014 !</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Intelligent landing page for AIMS/MapGuide Fusion Viewer
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: intelligent-landing-page-for-aimsmapguide
CATEGORY: AIMS
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: AIMS 2014
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/12/intelligent-landing-page-for-aimsmapguide.html 
DATE: 12/05/2013 10:26:11 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p> <p>You may come across <a href="http://adndevblog.typepad.com/infrastructure/2012/09/intelligent-landing-page-for-aimsmapguide-ajax-viewer-1.html">this post</a>, implementing an intelligent landing page in AIMS/MapGuide Ajax viewer(Basic web layout), and I am also asked how to do it in Fusion viewer(flexible web layout). Actually the implemenation is pretty similar, as both Ajax Viewer and Fusion viewer share the same server side logic. Let’s take the first one as an example,zooming to specified view port by initial x, y and scale. If you have not read <a href="http://adndevblog.typepad.com/infrastructure/2012/09/intelligent-landing-page-for-aimsmapguide-ajax-viewer-1.html">this post</a> and the source code of the sample attached, please do it now, then come back to this one. </p> <p>&nbsp;</p> <p>In the implementation of zooming to specified view port, it takes a copy of the basic <em><a>WebLayout</a></em> stored in the <em>Library repository</em> and changing the &lt;CenterX/&gt;, &lt;CenterY/&gt; and &lt;Scale/&gt; elements. The updated XML is written into the <em>Session</em> and is used as the target when the page is ultimately loaded. In fusion web layout, there are similar tags if you “use custom view”: </p> <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b019b0238d96c970c-pi"><img title="image" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; display: inline; border-top-width: 0px" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b019b0238d987970c-pi" width="487" height="316"></a> </p> <p>Let’s examine the xml of fusion weblayout with mapagent(<a title="http://localhost/mapserver2014/mapagent/" href="http://localhost/mapserver2014/mapagent/">http://localhost/mapserver2014/mapagent/</a>), select resource –&gt; GetResource Content </p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b019b02394b21970b-pi"><img title="image" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; display: inline; border-top-width: 0px" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b019b02394b3d970b-pi" width="488" height="236"></a>  <p>&nbsp;</p> <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b019b0238d9d8970c-pi"><img title="image" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; display: inline; border-top-width: 0px" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b019b02394b78970b-pi" width="498" height="300"></a> </p> <p>You will see the <strong>InitialView</strong> tag, which is similar with basic web layout. OK, with that, you can do the similar within basic weblayout, taking a copy of theflexible&nbsp; <em><a>WebLayout</a></em> stored in the <em>Library repository</em> and changing the &lt;CenterX/&gt;, &lt;CenterY/&gt; and &lt;Scale/&gt; elements. The updated XML is written into the <em>Session</em> and is used as the target when the page is ultimately loaded.&nbsp; Please refer to the <a href="http://adndevblog.typepad.com/files/mgviewerextention.zip">source code</a> in <a href="http://adndevblog.typepad.com/infrastructure/2012/09/intelligent-landing-page-for-aimsmapguide-ajax-viewer-1.html">this post</a> for detail. </p> <p>&nbsp;</p> <p>Good luck!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: How to access the AutoCAD Civil 3D Survey Database in .NET Application?
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: how-to-access-the-autocad-civil-3d-survey-database-in-net-application
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2012
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: AutoCAD Civil 3D 2014
CATEGORY: Civil 3D
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/11/how-to-access-the-autocad-civil-3d-survey-database-in-net-application.html 
DATE: 11/28/2013 03:16:09 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>In AutoCAD Civil 3D COM API, using <strong>AeccSurveyDatabase:: Projects</strong>, we can access the collection of the existing Survey projects. If you want to access a particular Survey Project e.g. (Test_Survey_DB) as shown in the screenshot below, we can use the <strong>AeccSurveyProjects:: FindItem(</strong><em>VARIANT varIndex</em>).</p>
<p>&#0160;</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b019b01c7d462970d-pi" style="display: inline;"><img alt="Civil3D_Survey_Database" class="asset  asset-image at-xid-6a0167607c2431970b019b01c7d462970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b019b01c7d462970d-500wi" title="Civil3D_Survey_Database" /></a></p>
<p>&#0160;</p>
<p>Here is a C# .NET code snippet which demonstrates how to access a particular Survey Project using the COM API &#0160;:&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Get the AutoCAD Editor</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">Editor</span><span style="line-height: 140%;"> ed = </span><span style="color: #2b91af; line-height: 140%;">AcadApp</span><span style="line-height: 140%;">.DocumentManager.MdiActiveDocument.Editor;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Get the Survey Application and AeccSurveyDatabase</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">AeccSurveyApplication</span><span style="line-height: 140%;"> aeccSurveyApp = </span><span style="color: blue; line-height: 140%;">new</span><span style="color: #2b91af; line-height: 140%;">AeccSurveyApplication</span><span style="line-height: 140%;">();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">aeccSurveyApp.Init((</span><span style="color: #2b91af; line-height: 140%;">AcadApplication</span><span style="line-height: 140%;">)</span><span style="color: #2b91af; line-height: 140%;">AcadApp</span><span style="line-height: 140%;">.AcadApplication);</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">AeccSurveyDatabase</span><span style="line-height: 140%;"> aeccSurveydb = (</span><span style="color: #2b91af; line-height: 140%;">AeccSurveyDatabase</span><span style="line-height: 140%;">)aeccSurveyApp.ActiveDocument.Database;</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">AeccSurveyProjects</span><span style="line-height: 140%;"> surveyProjs = aeccSurveydb.Projects;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Accessing a Particular Survey Project</span></p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// IAeccSurveyProjects:: FindItem </span></p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Gets the Survey Project with the given name. </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="background-color: #ffff00;"><strong><span style="color: #2b91af; line-height: 140%;">AeccSurveyProject</span><span style="line-height: 140%;"> surveyProj = surveyProjs.FindItem(</span><span style="color: #a31515; line-height: 140%;">&quot;Test_Survey_DB&quot;</span><span style="line-height: 140%;">);</span></strong></span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (surveyProj != </span><span style="color: blue; line-height: 140%;">null</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// now we can access the various Props of AeccSurveyProject object&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nSurvey Project Name :&#0160; &quot;</span><span style="line-height: 140%;"> + surveyProj.Name.ToString());</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nSurvey Project Path :&#0160; &quot;</span><span style="line-height: 140%;"> + surveyProj.Path.ToString());</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nNext available point number&#0160;&#0160; : &quot;</span><span style="line-height: 140%;"> + surveyProj.GetNextWritablePointNumber().ToString());</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;"> <a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b019b01c76bb3970b-pi" style="display: inline;"><img alt="Civil3D_Survey_Database_Result" class="asset  asset-image at-xid-6a0167607c2431970b019b01c76bb3970b" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b019b01c76bb3970b-500wi" title="Civil3D_Survey_Database_Result" /></a></span></p>
<p style="margin: 0px;">&#0160;</p>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Dave B
EMAIL: dcbosworth@btinternet.com
IP: 212.183.128.58
URL: 
DATE: 12/11/2013 02:44:19 AM
When I try this example (using 2013, and VB .Net), I am unable to load the AeccXSurvey and AeccXUiSurvey type libraries. Am I added the correct references?
-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 203.202.234.243
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 12/11/2013 02:49:16 AM
Hi Dave -

For Civil 3D 2013 COM libs, please refer to the following topic - 

http://adndevblog.typepad.com/infrastructure/2012/04/com-references-on-civil-3d-2013.html

Thanks,
Partha
-----
COMMENT:
AUTHOR: Dave B
EMAIL: dcbosworth@btinternet.com
IP: 212.183.128.58
URL: 
DATE: 12/11/2013 09:32:52 AM
Thanks, that was very useful!
-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: AutoCAD FIELD Expression to display Lat/Long value as Text
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: autocad-field-expression-to-display-latlong-value-as-text
CATEGORY: AutoCAD Map 3D 2011
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: AutoCAD Map 3D 2014
CATEGORY: Map 3D
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/11/autocad-field-expression-to-display-latlong-value-as-text.html 
DATE: 11/25/2013 12:46:44 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>What <strong>FIELD</strong> Expression should I use to show the Lat/Long value of a Point object in a DWG file in AutoCAD Map 3D which has an assigned coordinate system ?&#0160;</p>
<p>Here is an example of a &#39;FIELD Expression&#39; you can use to how the Lat/Long value as Text in AutoCAD Map 3D -</p>
<p><strong>%&lt;\AcObjProp Object(%&lt;\_ObjId 8796087804352&gt;%).Coordinates \f &quot;%lu6&quot;&gt;%</strong></p>
<p>&#0160;</p>
<p><strong> <a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b019b01a0a6bf970d-pi" style="display: inline;"><img alt="Map3D_CS_Field" class="asset  asset-image at-xid-6a0167607c2431970b019b01a0a6bf970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b019b01a0a6bf970d-500wi" title="Map3D_CS_Field" /></a><br /></strong></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Stacy
EMAIL: stacy_dunn_@hotmail.com
IP: 64.251.230.39
URL: 
DATE: 11/26/2013 03:45:15 PM
Partha,

The field string is showing the coordinates for the point and since the point happens to be within the limits of the lat/long values, it works.  If you were to have a point that was at a state plane coordinate, is there a way to show the latitude and longitude for it with a field?

Thank you,
Stacy
-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 59.92.192.48
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 11/26/2013 10:05:04 PM
Beyond the limit, it won't have the correct information of the Lat/Long. 

Let me know if I am missing something here and in that case you can drop me an email with some screenshot / sample dwg file explaining the requirement.

Thanks,
Partha
-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Adding multiple Section Views using AutoCAD Civil 3D .NET API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: adding-multiple-section-views-using-autocad-civil-3d-net-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2014
CATEGORY: Civil 3D
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/11/adding-multiple-section-views-using-autocad-civil-3d-net-api.html 
DATE: 11/21/2013 03:00:09 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>In AutoCAD Civil 3D Toolspace, under the &#39;Sample Line Groups&#39; collection, for a particular Sample Line Group (SLG), you will see &#39;<strong>Section View Groups</strong>&#39; collection.</p>
<p>&#0160;</p>
<p>&#0160; <a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b019b016cb7b0970d-pi" style="display: inline;"><img alt="Civil3D_Toolspace_Section_View_Groups" class="asset  asset-image at-xid-6a0167607c2431970b019b016cb7b0970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b019b016cb7b0970d-320wi" title="Civil3D_Toolspace_Section_View_Groups" /></a></p>
<p>&#0160;</p>
<p>&#0160;</p>
<p>Once you expand this collection, you will see &#39;<strong>Individual section views</strong>&#39;. When we add a single Section View using <strong>SectionView.Create()</strong> <a class="zem_slink" href="http://en.wikipedia.org/wiki/Application_programming_interface" rel="wikipedia" target="_blank" title="Application programming interface">API</a>, it will be added to this collection. In Civil 3D <a class="zem_slink" href="http://www.microsoft.com/net" rel="homepage" target="_blank" title=".NET Framework">.NET</a> API, we can access this through the following API -</p>
<p><strong>SampleLineGroup.IndividualSectionViewGroup</strong> Property&#0160;<span style="color: #60bf00;">// Gets the individual SectionViewGroup.</span></p>
<p>&#0160; <a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b019b016bd8dd970c-pi" style="display: inline;"><img alt="Civil3D_Toolspace_Individual_section_Views" class="asset  asset-image at-xid-6a0167607c2431970b019b016bd8dd970c" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b019b016bd8dd970c-320wi" title="Civil3D_Toolspace_Individual_section_Views" /></a></p>
<p>&#0160;</p>
<p>If you want to create multiple section views for a group of sample lines along an Alignment, in Civil UI tools we use &#39;CreateMultipleSectionView&#39; as shown below -</p>
<p>&#0160;</p>
<p>&#0160; <a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b019b016cbc40970d-pi" style="display: inline;"><img alt="Civil3D_Create_Multiple_UI" class="asset  asset-image at-xid-6a0167607c2431970b019b016cbc40970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b019b016cbc40970d-320wi" title="Civil3D_Create_Multiple_UI" /></a>&#0160;</p>
<p>&#0160;</p>
<p>If you want to programmatically&#0160;create multiple section views, use <strong>SectionViewGroupCollection.Add()</strong> API. First to access the SectionViewGroup collection use the following Civil 3D .NET API -&#0160;</p>
<p><strong>SampleLineGroup.SectionViewGroups</strong> Property &#0160;<span style="color: #60bf00;">// Gets the collection of SectionViewGroup</span>.</p>
<p>&#0160;</p>
<p>Here is a C# .NET code snippet using one of the overloaded versions of SectionViewGroupCollection.Add() API :&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">SampleLineGroup</span><span style="line-height: 140%;"> sampleLineGrp = SampleLineGrpId.GetObject(</span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForWrite) </span><span style="color: blue; line-height: 140%;">as</span><span style="color: #2b91af; line-height: 140%;">SampleLineGroup</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">//SampleLineGroup.SectionViewGroups Property</span></p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Gets the collection of SectionViewGroup.</span></p>
<p style="margin: 0px;"><strong><span style="color: #2b91af; line-height: 140%;">SectionViewGroupCollection</span><span style="line-height: 140%;"> sectionViewGrpColl = sampleLineGrp.SectionViewGroups;</span></strong></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// get the location to insert the Section views</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">Point3d</span><span style="line-height: 140%;"> insertPosition;</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">PromptPointResult</span><span style="line-height: 140%;"> ppr = ed.GetPoint(</span><span style="color: #a31515; line-height: 140%;">&quot;\nSelect a Location for the SectionViews:&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (ppr.Status != </span><span style="color: #2b91af; line-height: 140%;">PromptStatus</span><span style="line-height: 140%;">.OK)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">return</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">insertPosition = ppr.Value;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// now call the Add()</span></p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Add a SectionViewGroup which will create multiple SectionViews for each SampleLine in SampleLineGroup.</span></p>
<p style="margin: 0px;"><span style="background-color: #ffff00;"><strong><span style="line-height: 140%;">sectionViewGrpColl.Add(insertPosition);</span></strong></span></p>
</div>
<p>&#0160;</p>
<p>And result in AutoCAD Civil 3D –</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b019b016cc564970d-pi" style="display: inline;"><img alt="Civil3D_Create_Multiple_Section_View_API" class="asset  asset-image at-xid-6a0167607c2431970b019b016cc564970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b019b016cc564970d-320wi" title="Civil3D_Create_Multiple_Section_View_API" /></a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: How do I get the list of available Coordinate Systems in AutoCAD Civil 3D ?
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: how-do-i-get-the-list-of-available-coordinate-systems-in-autocad-civil-3d-
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: AutoCAD Civil 3D 2014
CATEGORY: Civil 3D
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/11/how-do-i-get-the-list-of-available-coordinate-systems-in-autocad-civil-3d-.html 
DATE: 11/18/2013 10:15:51 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>&#0160;</p>
<p>Is there a way to get a list of the coordinate systems that are available to the Civil 3D drawing i.e. how can I access the list found in the <strong>Drawing Settings&gt;Units and Zone&gt;Zone</strong> section as shown in the screenshot below ?</p>
<p>&#0160;</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b019b0150b267970c-pi" style="display: inline;"><img alt="Civil3D_Coordinate_Systems_1" class="asset  asset-image at-xid-6a0167607c2431970b019b0150b267970c" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b019b0150b267970c-500wi" title="Civil3D_Coordinate_Systems_1" /></a><br />&#0160;&#0160;</p>
<p>&#0160;</p>
<p>We can access the list of available coordinate systems using Geospatial Platform API which is part of AutoCAD Map 3D. As you know, AutoCAD Civil 3D is built on top of AutoCAD Map 3D and we can use the available Map 3D functionalities and API features in building custom application running on AutoCAD Civil 3D as well. To get the list of all the available Coordinate systems in a Drawing file in AutoCAD Civil 3D, we need to use <strong>MgCoordinateSystemFactory</strong> from <strong>OSGeo.MapGuide</strong> <em><strong>namespace</strong></em>. And for that you need to reference the following assemblies from &#39;AutoCAD Civil 3D 2014&#39; installation folder -&#0160;</p>
<ul>
<li><strong>OSGeo.MapGuide.Foundation.dll</strong></li>
<li><strong>OSGeo.MapGuide.PlatformBase.dll</strong></li>
<li><strong>OSGeo.MapGuide.Geometry.dll</strong></li>
</ul>
<p>&#0160;&#0160;</p>
<p>Here is the C# .NET code snippet -&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">MgCoordinateSystemFactory</span><span style="line-height: 140%;"> coordSysFactory = </span><span style="color: blue; line-height: 140%;">new</span><span style="color: #2b91af; line-height: 140%;">MgCoordinateSystemFactory</span><span style="line-height: 140%;">();</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">MgCoordinateSystemCatalog</span><span style="line-height: 140%;"> csCatalog = coordSysFactory.GetCatalog();</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">MgCoordinateSystemDictionary</span><span style="line-height: 140%;"> csDict = csCatalog.GetCoordinateSystemDictionary(); </span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">MgCoordinateSystemEnum</span><span style="line-height: 140%;"> csDictEnum = csDict.GetEnum();</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">int</span><span style="line-height: 140%;"> csCount = csDict.GetSize();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nCoordinate System Count : &quot;</span><span style="line-height: 140%;"> + csCount.ToString());</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\n-------------------------------------------------&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">MgStringCollection</span><span style="line-height: 140%;"> csNames = csDictEnum.NextName(csCount);</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">string</span><span style="line-height: 140%;"> csName = </span><span style="color: blue; line-height: 140%;">null</span><span style="line-height: 140%;">;&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">MgCoordinateSystem</span><span style="line-height: 140%;"> cs = </span><span style="color: blue; line-height: 140%;">null</span><span style="line-height: 140%;">;&#0160;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"> &#0160; &#0160; &#0160; &#0160;&#0160; </span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">for</span><span style="line-height: 140%;"> (</span><span style="color: blue; line-height: 140%;">int</span><span style="line-height: 140%;"> i = 0; i &lt; csCount; i++)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; csName = csNames.GetItem(i);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; cs = csDict.GetCoordinateSystem(csName);&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160;&#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nCoordinate System Name : &quot;</span><span style="line-height: 140%;"> + csName.ToString() + </span><span style="color: #a31515; line-height: 140%;">&quot;&#0160; &quot;</span><span style="line-height: 140%;"> + </span><span style="color: #a31515; line-height: 140%;">&quot;CS Code :&#0160; &quot;</span><span style="line-height: 140%;"> + cs.CsCode.ToString());</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\n-------------------------------------------------&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
<p>&#0160;</p>
<p>and Result in AutoCAD Civil 3D -</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b019b0150b397970c-pi" style="display: inline;"><img alt="Civil3D_Coordinate_Systems" class="asset  asset-image at-xid-6a0167607c2431970b019b0150b397970c" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b019b0150b397970c-500wi" title="Civil3D_Coordinate_Systems" /></a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: AutoCAD Map 3D Industry Data Modeling Plug-ins and their execution targets
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: autocad-map-3d-industry-data-modeling-plug-ins-and-their-execution-targets
CATEGORY: .NET
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: AutoCAD Map 3D 2014
CATEGORY: Map 3D
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/11/autocad-map-3d-industry-data-modeling-plug-ins-and-their-execution-targets.html 
DATE: 11/13/2013 11:45:40 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>You have developed a custom Industry Data Modeling Plug-in in AutoCAD Map 3D and if you are wondering how to restrict the usage to only in AutoCAD Map 3D, here is the answer :&#0160;</p>
<p>A typical tbp file looks like the following where in you define the plugins execution target.</p>
<p style="padding-left: 30px;"><span style="font-family: tahoma, arial, helvetica, sans-serif; font-size: 10pt;">&lt;PlugIn&gt;&#0160;</span></p>
<p style="padding-left: 60px;"><span style="font-family: tahoma, arial, helvetica, sans-serif; font-size: 10pt;">&lt;Default</span></p>
<p style="padding-left: 60px;"><span style="font-family: tahoma, arial, helvetica, sans-serif; font-size: 10pt;">AssemblyName=&quot;MyCompany.Mapping.MyTest.dll&quot;</span></p>
<p style="padding-left: 60px;"><span style="font-family: tahoma, arial, helvetica, sans-serif; font-size: 10pt;">Namespace=&quot;MyCompany.Mapping.MyTest&quot;</span></p>
<p style="padding-left: 60px;"><span style="font-family: tahoma, arial, helvetica, sans-serif; font-size: 10pt;">Priority=&quot;100&quot;</span></p>
<p style="padding-left: 60px;"><span style="font-family: tahoma, arial, helvetica, sans-serif; font-size: 10pt; background-color: #ffff00;">ExecutionTargetDesktop=&quot;True&quot;</span></p>
<p style="padding-left: 60px;"><span style="font-family: tahoma, arial, helvetica, sans-serif; font-size: 10pt;">ExecutionTargetWeb=&quot;False&quot;</span></p>
<p style="padding-left: 60px;"><span style="font-family: tahoma, arial, helvetica, sans-serif; font-size: 10pt;">ExecutionTargetAdmin=&quot;False&quot;</span></p>
<p style="padding-left: 60px;"><span style="font-family: tahoma, arial, helvetica, sans-serif; font-size: 10pt;">DMCode=&quot;&quot;</span></p>
<p style="padding-left: 60px;"><span style="font-family: tahoma, arial, helvetica, sans-serif; font-size: 10pt;">Company=&quot;MyCompany&quot;</span></p>
<p style="padding-left: 60px;"><span style="font-family: tahoma, arial, helvetica, sans-serif; font-size: 10pt;">Author=&quot;Partha Sarkar&quot;</span></p>
<p style="padding-left: 60px;"><span style="font-family: tahoma, arial, helvetica, sans-serif; font-size: 10pt;">/&gt;</span>&#0160;</p>
<p style="padding-left: 60px;"><span style="font-family: tahoma, arial, helvetica, sans-serif; font-size: 10pt;">&lt;ApplicationPlugIn ClassName=&quot;MyTestApplicationPlugin&quot;/&gt;/&gt;&#0160;</span></p>
<p style="padding-left: 30px;"><span style="font-family: tahoma, arial, helvetica, sans-serif; font-size: 10pt;">&lt;/PlugIn&gt;</span>&#0160;</p>
<p>&#0160;</p>
<p>In this post let me explain you the various options of the execution targets and when we should use them -</p>
<p>&#0160;</p>
<p><strong>ExecutionTargetDesktop</strong>&#0160; &#0160;&#0160;&#0160;&#0160;&#0160;&#0160; : used for “AutoCAD Map3D Client” (Map3D + Industry Model Data Editor + Infrastructure Administrator + IMBatch.exe)&#0160;</p>
<p><strong>ExecutionTargetWeb&#0160;&#0160;</strong>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; : used for Industry Data Model Extensions (Web)&#0160;</p>
<p>&#0160;</p>
<p>Most plug-ins only use these two, but some need the more specific properties like the following:</p>
<p>&#0160;</p>
<p><strong>ExecutionTargetClient *</strong>&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; : used specifically for AutoCAD Map 3D</p>
<p><strong>ExecutionTargetStandalone&#0160;</strong>&#0160; &#0160;: used specifically for Industry Model Data Editor</p>
<p><strong>ExecutionTargetAdmin&#0160;</strong>&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160;: used&#0160; specifically for Industry Data Model Administrator / Infrastructure Administrator.</p>
<p><strong>ExecutionTargetBatch</strong>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; : used specifically for IMBatch.exe / Industry Data Model Batch applications.&#0160;&#0160;&#0160;&#0160;</p>
<p>&#0160;&#0160;</p>
<p><strong>*</strong> You can use ‘<em><strong>ExecutionTargetClient=”true”</strong></em>’ for plugins that require graphical data interaction.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Creating Surface Contour Labels using Civil 3D .NET API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: creating-surface-contour-labels-using-civil-3d-net-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2014
CATEGORY: Civil 3D
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/11/creating-surface-contour-labels-using-civil-3d-net-api.html 
DATE: 11/08/2013 03:03:20 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>&#0160;</p>
<p>In AutoCAD Civil 3D<a href="http://docs.autodesk.com/CIV3D/2014/ENU/API_Reference_Guide/" target="_self"> .NET API Reference</a> guide, you will notice <strong>SurfaceContourLabelGroup</strong> class has overloaded function <strong>Create()</strong> to create a new Surface Contour LabelGroup.</p>
<p>&#0160;</p>
<p>In this post, I will show you how to use <strong>SurfaceContourLabelGroup.Create(</strong><em>ObjectId surfaceId, Point2dCollection labelLinePoints</em> ) and <strong>SurfaceContourLabelGroup.CreateMultipleAtInterval(</strong></p>
<p>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <em>ObjectId surfaceId,</em></p>
<p><em>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Point2d labelLineStartPoint,</em></p>
<p><em>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Point2d labelLineEndPoint,</em></p>
<p><em>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; double interval)</em>&#0160;</p>
<p>&#0160;</p>
<p>When we use <strong>SurfaceContourLabelGroup.Create(</strong><em>ObjectId surfaceId, Point2dCollection labelLinePoints</em>), we need to pass in surfaceId and labelLinePoints. One important point to note here - <em><strong>There must be at least 2 points to compose the label line</strong></em>.</p>
<p>&#0160;</p>
<p>Here is a C# .NET code snippet -&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">Transaction</span><span style="line-height: 140%;"> trans = db.TransactionManager.StartTransaction())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">try</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; {&#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: gray; line-height: 140%;">///</span><span style="color: green; line-height: 140%;"> surfaceId // Type: ObjectId // The ObjectId of surface to which the label is attahed.</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: gray; line-height: 140%;">///</span><span style="color: green; line-height: 140%;"> labelLinePoints // Type: Point2dCollection // The place in which the label is located.</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: gray; line-height: 140%;">///</span><span style="color: green; line-height: 140%;"> There must be at least 2 points to compose the label line.</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="background-color: #ffff00;"><strong><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> surfaceContourGrpLblId = </span><span style="color: #2b91af; line-height: 140%;">SurfaceContourLabelGroup</span></strong></span><span style="line-height: 140%;"><span style="background-color: #ffff00;"><strong>.Create(surfaceId, labelLinePoints);&#0160; &#0160; &#0160;</strong></span> &#0160; &#0160;&#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; trans.Commit();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">catch</span><span style="line-height: 140%;"> (Autodesk.AutoCAD.Runtime.</span><span style="color: #2b91af; line-height: 140%;">Exception</span><span style="line-height: 140%;"> ex)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\n Exception message :&quot;</span><span style="line-height: 140%;"> + ex.Message);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
<p>&#0160;</p>
<p>And the result you will see in Civil 3D -&#0160;</p>
<p>&#0160;</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b019b00ced4a7970b-pi" style="display: inline;"><img alt="Civil3D_Surface_Contour_Label_Create" class="asset  asset-image at-xid-6a0167607c2431970b019b00ced4a7970b" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b019b00ced4a7970b-500wi" title="Civil3D_Surface_Contour_Label_Create" /></a></p>
<p><br />&#0160;</p>
<p>In this example I have used <strong>SurfaceContourLabelGroup.CreateMultipleAtInterval</strong>(<em>ObjectId surfaceId, &#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Point2d labelLineStartPoint, Point2d labelLineEndPoint, double interval</em>).&#0160;One important point to note here - you need to use an <strong><span style="text-decoration: underline;">appropriate</span> </strong>double value for the interval based on your surface extends so that the interval is not too close nor too large.&#0160;</p>
<p>&#0160;</p>
<p>Here is a C# .NET code snippet -&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">try</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: gray; line-height: 140%;">///</span><span style="color: green; line-height: 140%;"> labelLineStartPoint // Type: Point2d // The start point of label line.</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: gray; line-height: 140%;">///</span><span style="color: green; line-height: 140%;"> labelLineEndPoint // Type: Point2d // The end point of label line.</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: gray; line-height: 140%;">///</span><span style="color: green; line-height: 140%;"> interval // Type: System.Double // The interval between the label groups along contours.</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: gray; line-height: 140%;">///</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="background-color: #ffff00;"><strong><span style="color: #2b91af; line-height: 140%;">SurfaceContourLabelGroup</span><span style="line-height: 140%;">.CreateMultipleAtInterval(surfaceId, labelLineStartPoint, labelLineEndPoint, 100.0); </span></strong></span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; trans.Commit();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
<p>&#0160;&#0160;</p>
<p>And the result you will see in Civil 3D -</p>
<p>&#0160;</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b019b00ceda25970b-pi" style="display: inline;"><img alt="Civil3D_Surface_Contour_Label_CreateMultipleAtInterval" class="asset  asset-image at-xid-6a0167607c2431970b019b00ceda25970b" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b019b00ceda25970b-500wi" title="Civil3D_Surface_Contour_Label_CreateMultipleAtInterval" /></a></p>
<p>&#0160;</p>
<p>Hope this is useful to you!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Civil 3D FeatureLine Labeling and Style changing through .NET API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: civil-3d-featureline-labeling-and-style-changing-through-net-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2014
CATEGORY: Civil 3D
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/11/civil-3d-featureline-labeling-and-style-changing-through-net-api.html 
DATE: 11/05/2013 02:55:35 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>If you are
looking for an API to change AutoCAD Civil 3D FeatureLine object&#39;s style you
can use <strong>FeatureLine.StyleName</strong> property which <em><strong>gets</strong></em> or<em><strong> sets</strong></em> the Featureline&#39;s
style name.&#0160;</p>
<p>And using
<strong>Autodesk.Civil.DatabaseServices.GeneralSegmentLabel.Create</strong>() method we can add
Label to a FeatureLine.&#0160;</p>
<p>In the
screenshot below we can see a Civil 3D FeatureLine before changing it&#39;s style -</p>
<p>&#0160;</p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b019b00af8bc3970b-pi" style="display: inline;"><img alt="Civil3D_FeatureLine_Style" class="asset  asset-image at-xid-6a0167607c2431970b019b00af8bc3970b" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b019b00af8bc3970b-500wi" title="Civil3D_FeatureLine_Style" /></a></p>
<p>&#0160;</p>
<p>And using the
following C# .NET code we can change the style and label it - </p>
<p>&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">Transaction</span><span style="line-height: 140%;"> ts = </span><span style="color: #2b91af; line-height: 140%;">AcadApp</span><span style="line-height: 140%;">.DocumentManager.MdiActiveDocument.Database.TransactionManager.StartTransaction())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">FeatureLine</span><span style="line-height: 140%;"> featureLine = ts.GetObject(ftrLineID, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForWrite) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">FeatureLine</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// Change the Style to &quot;Flowline&quot; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// Style name used abobe is specific to a DWG file </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// FeatureLine.StyleName // Gets or sets the Featureline&#39;s style name.</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="background-color: #ffff00;"><span style="line-height: 140%;">&#0160; featureLine.StyleName = </span><span style="color: #a31515; line-height: 140%;">&quot;Flowline&quot;</span><span style="line-height: 140%;">;</span></span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// Use Autodesk.Civil.DatabaseServices.GeneralSegmentLabel.Create to add label to a feature line</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="background-color: #ffff00;"><span style="color: #2b91af; line-height: 140%;">GeneralSegmentLabel</span><span style="line-height: 140%;">.Create(featureLine.ObjectId, 0.5);</span></span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; ts.Commit();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
<p>&#0160;</p>
<p>FeatureLine
style after change -</p>
<p>&#0160;</p>
<p>&#0160;
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b019b00af8cdc970b-pi" style="display: inline;"><img alt="Civil3D_FeatureLine_Style_Changed" class="asset  asset-image at-xid-6a0167607c2431970b019b00af8cdc970b" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b019b00af8cdc970b-500wi" title="Civil3D_FeatureLine_Style_Changed" /></a></p>
<p>&#0160;</p>
<p>and
FeatureLine with label -</p>
<p>&#0160;</p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b019b00af574d970c-pi" style="display: inline;"><img alt="Civil3D_FeatureLine_Label_using_API" class="asset  asset-image at-xid-6a0167607c2431970b019b00af574d970c" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b019b00af574d970c-500wi" title="Civil3D_FeatureLine_Label_using_API" /></a></p>
Hope this is useful
to you.
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Area51Visitor
EMAIL: bcinnv@gmail.com
IP: 146.135.102.84
URL: http://www.pro-cad.net
DATE: 02/24/2014 02:45:52 PM
Thanks Partha.  How would I go about moving the label to a different coordinate after it's been inserted?
-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: 'StationOffsetElevationToXYZ' is ambiguous because...
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: stationoffsetelevationtoxyz-is-ambiguous-because-multiple-kinds-of-members-with-this-name-exist-in-c
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2014
CATEGORY: Civil 3D
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/10/stationoffsetelevationtoxyz-is-ambiguous-because-multiple-kinds-of-members-with-this-name-exist-in-c.html 
DATE: 10/31/2013 01:27:23 AM
-----
BODY:
<p>&#39;StationOffsetElevationToXYZ&#39;
is ambiguous because multiple kinds of members with this name exist in class
&#39;Autodesk.Civil.DatabaseServices.BaseBaseline&#39;</p>
<p>&#0160;</p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b019b007d6411970c-pi" style="display: inline;"><img alt="StationOffsetElevationToXYZ_Issue" class="asset  asset-image at-xid-6a0167607c2431970b019b007d6411970c" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b019b007d6411970c-500wi" title="StationOffsetElevationToXYZ_Issue" /></a><br /><br /></p>
<p>This issue
seems to be specific to VB.NET project (if you are using C# .NET, it works fine).</p>
<p>We have
noticed this in Civil 3D 2014 release and by the time we address this issue in
Civil 3D .NET API, here is a workaround with Reflection and .NET Extensions which you can
adopt to overcome this -</p>
<p>&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">Public</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Sub</span><span style="line-height: 140%;"> TestCommand()</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> db </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Database</span><span style="line-height: 140%;"> = </span><span style="color: #2b91af; line-height: 140%;">Application</span><span style="line-height: 140%;">.DocumentManager.MdiActiveDocument.Database</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> civilDoc </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">CivilDocument</span><span style="line-height: 140%;"> = </span><span style="color: #2b91af; line-height: 140%;">CivilApplication</span><span style="line-height: 140%;">.ActiveDocument</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">If</span><span style="line-height: 140%;"> (civilDoc.CorridorCollection.Count = 0) </span><span style="color: blue; line-height: 140%;">Then</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Exit Sub</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Using</span><span style="line-height: 140%;"> trans </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Transaction</span><span style="line-height: 140%;"> = db.TransactionManager.StartOpenCloseTransaction</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> corr </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Corridor</span><span style="line-height: 140%;"> = trans.GetObject(civilDoc.CorridorCollection.Item(0), </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForRead)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> bl </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Baseline</span><span style="line-height: 140%;"> = corr.Baselines.Item(0)</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> soe </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Point3d</span><span style="line-height: 140%;"> = </span><span style="color: blue; line-height: 140%;">New</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Point3d</span><span style="line-height: 140%;">(bl.StartStation, 0, 0)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> pointAtSOE </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Point3d</span><span style="line-height: 140%;"> = bl.StationOffsetElevationToXYZ(soe)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Using</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Sub</span></p>
</div>
<p>&#0160;</p>
<p>&lt;&lt;&lt; &#0160;</p>
<p>And declare a
<strong>VB.NET Module</strong> as below:&#0160;</p>
<p>&gt;&gt;&gt;&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">Public</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Module</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Utility</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &lt;System.Runtime.CompilerServices.</span><span style="color: #2b91af; line-height: 140%;">Extension</span><span style="line-height: 140%;">()&gt; _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">Public</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Function</span><span style="line-height: 140%;"> StationOffsetElevationToXYZ(bl </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Baseline</span><span style="line-height: 140%;">, soe </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Point3d</span><span style="line-height: 140%;">) </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Point3d</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> args </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Object</span><span style="line-height: 140%;"> = {</span><span style="color: blue; line-height: 140%;">CType</span><span style="line-height: 140%;">(soe, </span><span style="color: blue; line-height: 140%;">Object</span><span style="line-height: 140%;">)}</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> argsModifiers </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">New</span><span style="line-height: 140%;"> System.Reflection.</span><span style="color: #2b91af; line-height: 140%;">ParameterModifier</span><span style="line-height: 140%;">(1)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">&#39; dont pass by reference, which is the new override for this method</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; argsModifiers(0) = </span><span style="color: blue; line-height: 140%;">False</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> mods() </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> System.Reflection.</span><span style="color: #2b91af; line-height: 140%;">ParameterModifier</span><span style="line-height: 140%;"> = {argsModifiers}</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">&#39; Invoke the method late bound.</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Return</span><span style="line-height: 140%;"> bl.GetType().InvokeMember(</span><span style="color: #a31515; line-height: 140%;">&quot;StationOffsetElevationToXYZ&quot;</span><span style="line-height: 140%;">, _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160;&#0160; System.Reflection.</span><span style="color: #2b91af; line-height: 140%;">BindingFlags</span><span style="line-height: 140%;">.InvokeMethod, _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160;&#0160; </span><span style="color: blue; line-height: 140%;">Nothing</span><span style="line-height: 140%;">, bl, args, mods, </span><span style="color: blue; line-height: 140%;">Nothing</span><span style="line-height: 140%;">, </span><span style="color: blue; line-height: 140%;">Nothing</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Function</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Module</span></p>
</div>
<p>&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Accessing ProfileView from PartProfileLabel using AutoCAD Civil 3D .NET API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: accessing-profileview-from-partprofilelabel-using-autocad-civil-3d-net-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2014
CATEGORY: Civil 3D
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/10/accessing-profileview-from-partprofilelabel-using-autocad-civil-3d-net-api.html 
DATE: 10/23/2013 01:14:04 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>In AutoCAD
Civil 3D using UI tools, if we select a Structure Profile Label in the Profile
View and look into the Property Window you will see the name of the Profile
View as shown in the screenshot below -</p>
<p>&#0160;</p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b019b003bf4a2970d-pi" style="display: inline;"><img alt="ProfileView_From_StructureProfileLabel" class="asset  asset-image at-xid-6a0167607c2431970b019b003bf4a2970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b019b003bf4a2970d-500wi" title="ProfileView_From_StructureProfileLabel" /></a></p>
<p>&#0160;</p>
<p>If you want
to access the same using AutoCAD Civil 3D .NET API, here is a C# .NET code
sample - </p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">//get editor and database </span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">Editor</span><span style="line-height: 140%;"> ed = </span><span style="color: #2b91af; line-height: 140%;">AcadApp</span><span style="line-height: 140%;">.DocumentManager.MdiActiveDocument.Editor;</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">Database</span><span style="line-height: 140%;"> db = </span><span style="color: #2b91af; line-height: 140%;">AcadApp</span><span style="line-height: 140%;">.DocumentManager.MdiActiveDocument.Database;</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">CivilDocument</span><span style="line-height: 140%;"> civilDoc = </span><span style="color: #2b91af; line-height: 140%;">CivilApplication</span><span style="line-height: 140%;">.ActiveDocument;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">PromptEntityOptions</span><span style="line-height: 140%;"> entOpt = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">PromptEntityOptions</span><span style="line-height: 140%;">(</span><span style="color: #a31515; line-height: 140%;">&quot;\nSelect ProfileViewPart:&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">entOpt.SetRejectMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nThis is not ProfileViewPart!&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">entOpt.AddAllowedClass(</span><span style="color: blue; line-height: 140%;">typeof</span><span style="line-height: 140%;">(</span><span style="color: #2b91af; line-height: 140%;">ProfileViewPart</span><span style="line-height: 140%;">), </span><span style="color: blue; line-height: 140%;">true</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">PromptEntityResult</span><span style="line-height: 140%;"> entRes = ed.GetEntity(entOpt);</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (entRes.Status == </span><span style="color: #2b91af; line-height: 140%;">PromptStatus</span><span style="line-height: 140%;">.OK)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> pViewPartId = entRes.ObjectId;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">Transaction</span><span style="line-height: 140%;"> tr = db.TransactionManager.StartTransaction())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">ObjectIdCollection</span><span style="line-height: 140%;"> pViewPartLabelsIds;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">ProfileViewPart</span><span style="line-height: 140%;"> pViewPart = tr.GetObject(pViewPartId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForRead) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">ProfileViewPart</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; pViewPartLabelsIds = pViewPart.GetPartProfileLabelIds();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">foreach</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> labelId </span><span style="color: blue; line-height: 140%;">in</span><span style="line-height: 140%;"> pViewPartLabelsIds)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">PartProfileLabel</span><span style="line-height: 140%;"> label = tr.GetObject(labelId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForRead) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">PartProfileLabel</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (label </span><span style="color: blue; line-height: 140%;">is</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">StructureProfileLabel</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">StructureProfileLabel</span><span style="line-height: 140%;"> spLabel = label </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">StructureProfileLabel</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: green; line-height: 140%;">//Accessing a ProfileView from PartProfileLabel</span></p>
<p style="margin: 0px;"><span style="background-color: #ffff00;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> profileViewId = spLabel.ViewId;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">ProfileView</span><span style="line-height: 140%;"> profileView = tr.GetObject(profileViewId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForRead) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">ProfileView</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nProfileView Name : &quot;</span><span style="line-height: 140%;"> + profileView.Name.ToString());&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; } </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
<p>&#0160;</p>
<p>&#0160;</p>
<p>Hope this is
useful to you!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Announcement: DevHelp Online and Autodesk Discussion Group Integrated!
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: devhelp-online-and-autodesk-discussion-forums-integrated
CATEGORY: Announcement
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/10/devhelp-online-and-autodesk-discussion-forums-integrated.html 
DATE: 10/21/2013 01:07:28 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>We are pleased to announce a <strong>significant enhancement</strong> to our Autodesk
Developer Network (ADN) Support service. Apart from asking questions privately
through DevHelp Online, you can now also ask your questions on the <a href="http://forums.autodesk.com/">Autodesk Discussion
Group</a> (Autodesk Forums). Here is the API forums list that integrated
with the DevHelp Online. </p>
<ul>
<li><a href="http://forums.autodesk.com/t5/NET/bd-p/152">AutoCAD® .NET</a></li>
<li><a href="http://forums.autodesk.com/t5/Autodesk-ObjectARX/bd-p/34">AutoCAD® ObjectARX®</a></li>
<li><a href="http://forums.autodesk.com/t5/AutoCAD-Civil-3D-Customization/bd-p/190">AutoCAD® Civil 3D® Customization</a></li>
<li><a href="http://forums.autodesk.com/t5/Autodesk-Inventor-Customization/bd-p/120">Autodesk® Inventor®
     Customization</a></li>
<li><a href="http://forums.autodesk.com/t5/Autodesk-Navisworks-API/bd-p/600">Autodesk® Navisworks® API</a></li>
<li><a href="http://forums.autodesk.com/t5/Autodesk-Revit-API/bd-p/160">Autodesk® Revit® API</a></li>
<li><a href="http://forums.autodesk.com/t5/Autodesk-Vault-Customization/bd-p/301">Autodesk® Vault Customization</a></li>
<li><a href="http://forums.autodesk.com/t5/Programming/bd-p/area-b35">Autodesk Media and Entertainment
     &gt; Autodesk 3ds® Max® &gt; Programming</a></li>
<li><a href="http://forums.autodesk.com/t5/Programming/bd-p/area-b50">Autodesk Media and Entertainment
     &gt; Autodesk® Maya® &gt; Programming</a></li>
<li><a href="http://forums.autodesk.com/t5/FBX-SDK/bd-p/area-b64">Autodesk Media and Entertainment
     &gt; Autodesk® FBX® &gt; FBX SDK</a></li>
<li><a href="http://forums.autodesk.com/t5/Python/bd-p/area-b8">Autodesk Media and Entertainment
     &gt; Autodesk® MotionBuilder® &gt; Python</a></li>
<li><a href="http://forums.autodesk.com/t5/Open-Reality/bd-p/area-b11">Autodesk Media and Entertainment
     &gt; Autodesk® MotionBuilder® &gt; Open Reality</a></li>
</ul>
<p>&#0160;</p>
<p>Many ADN partners already make extensive use of the <a href="http://forums.autodesk.com" target="_self">Autodesk discussion forums</a> – asking
API questions on the forums as well as through DevHelp Online in order to
benefit from the advice of as wide a range of experts as possible. But there is
a problem with relying solely on a public forum for support - sometimes you
don’t get an answer to your question. We’re fixing that problem by creating
tighter integration between the Autodesk API forums and DevHelp Online (the ADN
support portal).&#0160;</p>
<p>From now on, if you ask a question on one of our managed Autodesk
API public forums, you will benefit from the following enhanced support:&#0160;</p>
<p>-&#0160;&#0160; Members of the ADN DevTech team can identify you as an ADN partner
on the forum and prioritize answering your questions.</p>
<p>-&#0160;&#0160; If your question goes unanswered, it is automatically escalated to
DevHelp Online to ensure it receives the attention it deserves.</p>
<p>-&#0160;&#0160; If you’re not happy with the answer you’ve received from one of
your peers, you can escalate the question to DevHelp Online yourself.</p>
<p>If you’ve not used the Autodesk discussion forums before, we
encourage you to give them a try. You may be surprised at the breadth and depth
of knowledge freely given by the community. With these enhancements for ADN
Standard and Professional partners, you no longer have to choose between asking
Autodesk or asking your forum peers – now you can ask Autodesk and your forum
peers in the same place.&#0160;</p>
<p>And while you’re visiting the forum, why not browse around and
contribute to some of the discussions.&#0160;</p>
Taking advantage of this
new service is really easy. The account you already use to login to DevHelp
Online will also allow you to login to the Autodesk forums. If you are an ADN
member, please visit the ADN extranet for<a href="http://adn.autodesk.com/adn/servlet/item?siteID=4814862&amp;id=22170101"> more
detailed information</a> on how to setup your forum account so that you are
correctly recognized as an ADN member and benefit from this enhanced support.
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Mark errors when doing mapclean in Map 3D
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: mark-errors-when-doing-mapclean-in-map-3d
CATEGORY: AutoCAD Map 3D 2011
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/10/mark-errors-when-doing-mapclean-in-map-3d.html 
DATE: 10/15/2013 09:13:18 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>In Map 3D map clean tool, it marks the errors it finds.Here is an example to demonstrate how to use do it with API: </p>  <p>[CommandMethod(&quot;clean&quot;)]    <br />public void DrawingCleanUp()     <br />{     <br />&#160;&#160;&#160; string sGroupKeyword = &quot;GROUP&quot;;     <br />&#160;&#160;&#160; string sErrorKeyword = &quot;ERROR&quot;;     <br />&#160;&#160;&#160; string sYes = &quot;YES&quot;;     <br />&#160;&#160;&#160; string sNo = &quot;NO&quot;;</p>  <p>&#160;&#160;&#160; int iGrpErrCnt = 0;    <br />&#160;&#160;&#160; Editor ed = Application.DocumentManager.MdiActiveDocument.Editor;</p>  <p>&#160;&#160;&#160; Autodesk.Gis.Map.Topology.Variable cadAction =    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; new Autodesk.Gis.Map.Topology.Variable();     <br />&#160;&#160;&#160; cadAction.LoadProfile(@&quot;C:\MapCleanDemo\myClean.dpf&quot;);</p>  <p>   <br />&#160;&#160;&#160; PromptKeywordOptions pkoCleanupType =     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; new PromptKeywordOptions(&quot;Cleanup Type:&quot;);     <br />&#160;&#160;&#160; pkoCleanupType.Keywords.Add(     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; sGroupKeyword, sGroupKeyword, sGroupKeyword, true, true);     <br />&#160;&#160;&#160; pkoCleanupType.Keywords.Add(     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; sErrorKeyword, sErrorKeyword, sErrorKeyword, true, true);     <br />&#160;&#160;&#160; pkoCleanupType.AllowNone = true;</p>  <p>&#160;&#160;&#160; PromptKeywordOptions pkoFixError = new PromptKeywordOptions(&quot;Fix?&quot;);    <br />&#160;&#160;&#160; pkoFixError.Keywords.Add(sYes, sYes, sYes, true, true);     <br />&#160;&#160;&#160; pkoFixError.Keywords.Add(sNo, sNo, sNo, true, true);     <br />&#160;&#160;&#160; pkoFixError.AllowNone = true;</p>  <p>   <br />&#160;&#160;&#160; PromptResult pres = ed.GetKeywords(pkoCleanupType);     <br />&#160;&#160;&#160; if (pres.Status != PromptStatus.Cancel)     <br />&#160;&#160;&#160; {     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; using (Autodesk.Gis.Map.Topology.TopologyClean cadCleanobj     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; = new Autodesk.Gis.Map.Topology.TopologyClean())     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; {     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; cadCleanobj.Init(cadAction, null);</p>  <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; cadCleanobj.Start();    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; cadCleanobj.GroupNext();     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; if (pres.StringResult.ToUpper().Equals(sErrorKeyword))     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; while (!cadCleanobj.Completed)     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; iGrpErrCnt = cadCleanobj.GroupErrorCount;</p>  <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(&quot;\nGroup Error Count: &quot; + iGrpErrCnt);    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(&quot;\n* Iterating over Errors.&quot;);</p>  <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; for (int i = 0; i &lt; iGrpErrCnt; i++)    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; cadCleanobj.ErrorCur(i);     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(&quot;\n* Current Error (X: &quot;     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; + Math.Round(cadCleanobj.ErrorPoint.X, 2)     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; + &quot; Y: &quot; + Math.Round(cadCleanobj.ErrorPoint.Y, 2) + &quot;)&quot;);     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; cadCleanobj.ErrorDraw();</p>  <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; if (ed.GetKeywords(pkoFixError).StringResult.ToUpper().Equals(sYes))    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; cadCleanobj.ErrorFix();     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; else     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; cadCleanobj.ErrorMark();     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</p>  <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; cadCleanobj.GroupNext();    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; else if (pres.StringResult.ToUpper().Equals(sGroupKeyword))     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(&quot;\nGroup Cleanup&quot;);     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(&quot;\n* Iterating over Groups.&quot;);     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; while (!cadCleanobj.Completed)     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; iGrpErrCnt = cadCleanobj.GroupErrorCount;</p>  <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(&quot;\nGroup Error Count: &quot; + iGrpErrCnt);</p>  <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; cadCleanobj.GroupDraw();</p>  <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; if (ed.GetKeywords(pkoFixError).StringResult.ToUpper().Equals(sYes))    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; cadCleanobj.GroupFix();     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; else     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; cadCleanobj.GroupMark();</p>  <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; cadCleanobj.GroupNext();    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; else     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(&quot;\n&quot; + pres.StringResult + &quot; is not a valid option.&quot;);</p>  <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; cadCleanobj.End();    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; }     <br />&#160;&#160;&#160; }     <br />} </p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Applying Spatial Filter to Query FDO data using Geospatial Platform API in AutoCAD Map 3D
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: applying-spatial-filter-to-query-fdo-data-using-geospatial-platform-api-in-autocad-map-3d
CATEGORY: .NET
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: AutoCAD Map 3D 2014
CATEGORY: FDO
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/10/applying-spatial-filter-to-query-fdo-data-using-geospatial-platform-api-in-autocad-map-3d.html 
DATE: 10/10/2013 12:10:33 AM
-----
BODY:
<p>Applying
Spatial Filter to Query FDO data using Geospatial Platform API in AutoCAD Map
3D</p>
<p>In AutoCAD
Map 3D, using the UI tools, we can apply spatial filter to query FDO data. To
give an example, in the screenshot below, if we want to see the Road feature
(FDO Feature) inside of the highlighted parcel (FDO feature), we can apply the
Map 3D Query Filter Data UI tools and see the road features inside of the
parcel. “Inside” is just an example here, we can apply many other spatial
conditions like intersects , Overlaps etc.</p>
<p>&#0160;</p>
<p>&#0160;
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b019affe7e0df970d-pi" style="display: inline;"><img alt="Map3D_Query_Filter_API_01" class="asset  asset-image at-xid-6a0167607c2431970b019affe7e0df970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b019affe7e0df970d-500wi" title="Map3D_Query_Filter_API_01" /></a></p>
<p>&#0160;</p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b019affe76ace970b-pi" style="display: inline;"><img alt="Map3D_Query_Filter_API_02" class="asset  asset-image at-xid-6a0167607c2431970b019affe76ace970b" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b019affe76ace970b-500wi" title="Map3D_Query_Filter_API_02" /></a><br /><br /></p>
<p>If we want to achieve the same using Map 3D API, we can
use Map 3D Geospatial Platform API <strong>SetSpatialFilter &#0160;</strong>and <em><strong>MgFeatureSpatialOperations.Intersects</strong></em> spatial operation.</p>
<p>&#0160;</p>
<p>Here is a C# .NET code snippet demonstrating this -</p>
<p>&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">public</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">void</span><span style="line-height: 140%;"> MapSpatialQueryFilterDemo()</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">try</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: green; line-height: 140%;">// Selct using API</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">AcMapMap</span><span style="line-height: 140%;"> currentMap = </span><span style="color: #2b91af; line-height: 140%;">AcMapMap</span><span style="line-height: 140%;">.GetCurrentMap();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">MgLayerCollection</span><span style="line-height: 140%;"> layers = currentMap.GetLayers();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">MgLayerBase</span><span style="line-height: 140%;"> layer = layers.GetItem(</span><span style="color: #a31515; line-height: 140%;">&quot;Roads&quot;</span><span style="line-height: 140%;">); </span><span style="color: green; line-height: 140%;">// specific to Roads SDF data</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">MgFeatureService</span><span style="line-height: 140%;"> fs = </span><span style="color: #2b91af; line-height: 140%;">AcMapServiceFactory</span><span style="line-height: 140%;">.GetService(</span><span style="color: #2b91af; line-height: 140%;">MgServiceType</span><span style="line-height: 140%;">.FeatureService) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">MgFeatureService</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">string</span><span style="line-height: 140%;"> fsId = layer.GetFeatureSourceId();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">string</span><span style="line-height: 140%;"> className = layer.GetFeatureClassName();</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: green; line-height: 140%;">// Selecting the Boundary feature </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: green; line-height: 140%;">// In this case the Parcel boundary&#0160; &#0160;&#0160; </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">PromptSelectionResult</span><span style="line-height: 140%;"> selResult = ed.GetSelection();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">SelectionSet</span><span style="line-height: 140%;"> selSet = selResult.Value;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">MgSelectionBase</span><span style="line-height: 140%;"> selection = </span><span style="color: #2b91af; line-height: 140%;">AcMapFeatureEntityService</span><span style="line-height: 140%;">.GetSelection(selSet);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">MgLayerBase</span><span style="line-height: 140%;"> layerFrame = </span><span style="color: blue; line-height: 140%;">null</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">foreach</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">MgLayerBase</span><span style="line-height: 140%;"> testlayer </span><span style="color: blue; line-height: 140%;">in</span><span style="line-height: 140%;"> selection.GetLayers())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (testlayer.Name == </span><span style="color: #a31515; line-height: 140%;">&quot;Parcels&quot;</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; layerFrame = testlayer;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">break</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; }</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: green; line-height: 140%;">//get the properties </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">MgFeatureReader</span><span style="line-height: 140%;"> reader = selection.GetSelectedFeatures(layerFrame, layerFrame.FeatureClassName, </span><span style="color: blue; line-height: 140%;">false</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">MgAgfReaderWriter</span><span style="line-height: 140%;"> agfReadWrite = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">MgAgfReaderWriter</span><span style="line-height: 140%;">();</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">MgGeometry</span><span style="line-height: 140%;"> boundaryGeomtry = </span><span style="color: blue; line-height: 140%;">null</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">try</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (reader.ReadNext())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; boundaryGeomtry = agfReadWrite.Read(reader.GetGeometry(layerFrame.GetFeatureGeometryName()));</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">finally</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; reader.Close();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; }</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: green; line-height: 140%;">//spatial relationship inside&#0160; filter</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">MgFeatureQueryOptions</span><span style="line-height: 140%;"> query = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">MgFeatureQueryOptions</span><span style="line-height: 140%;">();</span></p>
<p style="margin: 0px;"><span style="background-color: #ffff00;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; query.SetSpatialFilter(</span><span style="color: #a31515; line-height: 140%;">&quot;Geometry&quot;</span><span style="line-height: 140%;">, boundaryGeomtry, </span><span style="color: #2b91af; line-height: 140%;">MgFeatureSpatialOperations</span><span style="line-height: 140%;">.Inside);</span></span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: green; line-height: 140%;">//Get the features </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">MgResourceIdentifier</span><span style="line-height: 140%;"> resId = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">MgResourceIdentifier</span><span style="line-height: 140%;">(fsId);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">MgFeatureReader</span><span style="line-height: 140%;"> ftrRdr = fs.SelectFeatures(resId, className, query);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: green; line-height: 140%;">//Display the ID and Other Property of the selected features </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">while</span><span style="line-height: 140%;"> (ftrRdr.ReadNext())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">int</span><span style="line-height: 140%;"> id = ftrRdr.GetInt32(</span><span style="color: #a31515; line-height: 140%;">&quot;Autogenerated_SDF_ID&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">string</span><span style="line-height: 140%;"> roadName = ftrRdr.GetString(</span><span style="color: #a31515; line-height: 140%;">&quot;ST_NAME&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nID: &quot;</span><span style="line-height: 140%;"> + id + </span><span style="color: #a31515; line-height: 140%;">&quot; &quot;</span><span style="line-height: 140%;"> + </span><span style="color: #a31515; line-height: 140%;">&quot;Road Name : &quot;</span><span style="line-height: 140%;"> + roadName.ToString());</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; ftrRdr.Close();</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; }</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">catch</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">MgException</span><span style="line-height: 140%;"> ex)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; ed.WriteMessage(ex.Message.ToString());</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; }</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; }</span></p>
</div>
<p>&#0160;</p>
<p>And the result of the same :</p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b019affe76709970c-pi" style="display: inline;"><img alt="Map3D_Query_Filter_API_03" class="asset  asset-image at-xid-6a0167607c2431970b019affe76709970c" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b019affe76709970c-500wi" title="Map3D_Query_Filter_API_03" /></a></p>
<p>&#0160;</p>
<p>Hope this is useful to you.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Get / Set SuperelevationOptions using AutoCAD Civil 3D .NET API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: get-set-superelevationoptions-using-autocad-civil-3d-net-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2014
CATEGORY: Civil 3D
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/10/get-set-superelevationoptions-using-autocad-civil-3d-net-api.html 
DATE: 10/03/2013 04:28:16 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>If we refer
to AutoCAD Civil 3D API reference document for <a href="http://docs.autodesk.com/CIV3D/2014/ENU/API_Reference_Guide/html/7b4b7995-09ab-cddf-8e54-cfe008d15713.htm">SuperelevationOptions</a>,
we see most of the properties are Get as shown in the screenshot below -</p>
<p>&#0160;</p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b019affbff313970c-pi" style="display: inline;"><img alt="Civil3D_SuperelevationOptions_01" class="asset  asset-image at-xid-6a0167607c2431970b019affbff313970c" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b019affbff313970c-500wi" title="Civil3D_SuperelevationOptions_01" /></a><br /><br /></p>
<p>If you are
wondering why these are only Get and how do we set these properties using API,
answer is, their <strong>values</strong> are <em><strong>Get</strong></em> and <em><strong>Set</strong></em> and we can use the appropriate property
and it’s value to set as per our project requirement.</p>
<p>Here is an
example using C# .NET API – </p>
<p>Default
settings before we make a change using API – </p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b019affbfd8d3970b-pi" style="display: inline;"><img alt="Civil3D_SuperelevationOptions_02" class="asset  asset-image at-xid-6a0167607c2431970b019affbfd8d3970b" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b019affbfd8d3970b-500wi" title="Civil3D_SuperelevationOptions_02" /></a></p>
<p>Here is the
code snippet –</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">Transaction</span><span style="line-height: 140%;"> trans = db.TransactionManager.StartTransaction())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">SettingsAlignment</span><span style="line-height: 140%;"> alignmentSettings = civilDoc.Settings.GetSettings&lt;</span><span style="color: #2b91af; line-height: 140%;">SettingsAlignment</span><span style="line-height: 140%;">&gt;(); </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nSuperelevationOptions.CorridorType Before Set :&quot;</span><span style="line-height: 140%;"> +</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; alignmentSettings.SuperelevationOptions.CorridorType.Value.ToString() +</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: #a31515; line-height: 140%;">&quot;\nSuperelevationOptions.NominalWidth Before Set&#0160; :&quot;</span><span style="line-height: 140%;"> +</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; alignmentSettings.SuperelevationOptions.NominalWidth.Value.ToString());</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// Values are Get / Set</span></p>
<p style="margin: 0px;"><span style="background-color: #ffff00;"><span style="line-height: 140%;">&#0160; alignmentSettings.SuperelevationOptions.CorridorType.Value = </span><span style="color: #2b91af; line-height: 140%;">SuperelevationCorridorType</span><span style="line-height: 140%;">.Divided;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%; background-color: #ffff00;">&#0160; alignmentSettings.SuperelevationOptions.NominalWidth.Value = 8.2;&#0160; &#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; trans.Commit();&#0160;&#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
<p>&#0160;</p>
<p>And changed
values after we run our custom code – </p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b019affc08336970d-pi" style="display: inline;"><img alt="Civil3D_SuperelevationOptions_afterChange" class="asset  asset-image at-xid-6a0167607c2431970b019affc08336970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b019affc08336970d-500wi" title="Civil3D_SuperelevationOptions_afterChange" /></a></p>
<p>Hope this helps
!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Removing Surface Breaklines using AutoCAD Civil 3D API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: removing-surface-breaklines-using-autocad-civil-3d-com-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: AutoCAD Civil 3D 2014
CATEGORY: Civil 3D
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/09/removing-surface-breaklines-using-autocad-civil-3d-com-api.html 
DATE: 09/25/2013 02:11:29 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>AutoCAD Civil
3D COM API has <em><strong>IAeccSurfaceBreaklines:: Remove</strong></em> method to remove Surface
Breaklines. In the ‘ActiveX API Reference’ document we see this &#0160;– </p>
<p><strong>IAeccSurfaceBreaklines::
Remove</strong> Method - &gt; Removes an item from the collection, specified by <em><strong>index</strong></em> or
<em>object reference</em>. </p>
<p>HRESULT
Remove( [in] VARIANT varIndex);</p>
<p>One of our
Civil 3D application developers friend recently asked me ‘how do we use <em>object
reference</em> in Remove()’ ? That prompted me to dig deeper in this and I find we
can only use <strong>index</strong> in the <strong>Remove()</strong> and it <span style="text-decoration: underline;">doesn’t</span> work with <em>object reference</em>. By
the time we update the Civil 3D ActiveX API reference document on this, I
thought it would be useful to you all if I share this information here in IM
DevBlog. </p>
<p>Here is the
VB.NET code snippet showing usage of COM API Remove(index) –</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">If</span><span style="line-height: 140%;">(oTinSurface.Breaklines.Count &gt; 0)</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">&#39; Remove() Breakline using COM API</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; background-color: #ffff00;">&#0160; oTinSurface.Breaklines.Remove(0)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; oTinSurface.Rebuild()</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; ed.WriteMessage(vbCrLf + </span><span style="color: #a31515; line-height: 140%;">&quot;Breakline Removed ! &quot;</span><span style="line-height: 140%;"> )</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">If</span><span style="line-height: 140%;"> </span></p>
</div>
<p>&#0160;</p>
<p>In Civil 3D .NET API we have the equivalent <strong>RemoveAt(int)</strong>
and here is C# .NET code snippet –</p>
<p><span style="color: green; line-height: 140%; font-family: &#39;Courier New&#39;; font-size: 8pt;">// Get the TIN Surface &#0160; &#0160; &#0160;&#0160;</span></p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">TinSurface</span><span style="line-height: 140%;"> tinSurface = surfaceId.GetObject(</span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForWrite) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">TinSurface</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Lets try to Remove Breakline using RemoveAt(int)&#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%; background-color: #ffff00;">&#0160; tinSurface.BreaklinesDefinition.RemoveAt(0);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// rebuild the surface</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; tinSurface.Rebuild();</span></p>
</div>
<p>&#0160;</p>
<p>Hope this is useful to you!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: James Maeding
EMAIL: jmaeding@hunsaker.com
IP: 24.249.247.46
URL: 
DATE: 09/30/2013 10:34:06 AM
this is a big deal, as I recall I could only remove groups of breaklines before.
I have tools that make 3d plines and add to a surface. Updates need the ability to remove items and add on a pline by pline basis.
Are you sure this does not refer to groups of breaklines, as that is not what I need. thanks
-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 59.92.207.214
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 10/03/2013 12:35:01 AM
Hi James - 

Which release of Civil 3D and what API (COM / .NET) you used >>> I recall I could only remove groups of breaklines before. <<<

If you provide me these details, I can investigate it further.

Thanks,
Partha Sarkar
ADN
-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 177.43.194.106
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 03/25/2015 11:33:36 AM
James,

It's being a while... but I made some testing with this: the RemoveAt will act at the operation level, not at each breakline. For instance, if you add a Std Breakline and select 3 plines, the RemoveAt will remove all 3 plines.

Database db = Application.DocumentManager.MdiActiveDocument.Database;
using (Transaction trans = db.TransactionManager.StartTransaction())
{
  TinSurface tinSurface = trans.GetObject(surfaceId, OpenMode.ForWrite) as TinSurface;
  for (int b = 0; b < tinSurface.BreaklinesDefinition.Count; b++)
  {
    SurfaceOperationAddBreakline operation = tinSurface.BreaklinesDefinition[b];

    // the RemoveAt will act at this level
    ed.WriteMessage("\n{0}", operation.Description); 

    foreach (SurfaceBreakline breakline in operation)
    {
      // this level don't have a Remove method...
      ed.WriteMessage("\n\t{0}", breakline.Description);
    }
  }
  //tinSurface.BreaklinesDefinition.RemoveAt(...);
  //tinSurface.Rebuild();
  //trans.Commit();
}

Regards,
Augusto Goncalves
-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Autodesk Developer Days 2013 : rEvolution
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: autodesk-developer-days-2013-revolution
CATEGORY: Announcement
CATEGORY: Events
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/09/autodesk-developer-days-2013-revolution.html 
DATE: 09/23/2013 10:34:37 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>&#0160;</p>
<p><strong><em>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b019aff927bc9970c-pi" style="float: left;"><img alt="ADN_Developer_Days2013" class="asset  asset-image at-xid-6a0167607c2431970b019aff927bc9970c" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b019aff927bc9970c-500wi" style="margin: 0px 5px 5px 0px;" title="ADN_Developer_Days2013" /></a>rEvolution -&#0160;</em></strong><em>Where
Desktop meets the Cloud</em></p>
<p>&#0160;</p>
<p>Got great ideas for cloud and mobile apps?&#0160; Want to learn where Autodesk is taking the
convergence of desktop computing and cloud technology? &#0160;</p>
<p>If you’re an innovator developing on Autodesk platform technology and
have not yet attended an Autodesk Developer Network Conference join us for a deep
dive as we take an in-depth look at Autodesk’s newest technologies and the next
generation of products coming in 2014.&#0160;
The Autodesk Developer Network is holding its annual, worldwide
Developer Day Conference and DevLab in cities around the world from November
2013 through February 2014.</p>
<p>&#0160;</p>
<p>Called Autodesk DevDays 2013, the theme for this year’s event is
<strong>rEvolution</strong> – <em>Where Desktop meets the Cloud</em>.&#0160; Come and learn about upcoming
releases of several new web service APIs from Autodesk.&#0160; You’ll see how
these new web services extend the power of the desktop: delivering easy
collaboration, limitless compute power and big data – and are platforms that
can deliver the same to you and your customers.&#0160; It’s an opportunity to
learn about a range of “360 based” web service APIs delivering you Cloud based
platforms for a number of industries - Manufacturing, AEC, Infrastructure and
more. And, we will of course also cover what’s new in the next releases of our
desktop products (AutoCAD®, Autodesk® Revit®, Autodesk® Inventor®, AutoCAD® Civil
3D®, Autodesk® InfraWorks™&#0160;and so on)!</p>
<p>&#0160;</p>
Note that material at
Developer Days is forward-looking and highly confidential so ADN membership is
required. &#0160;Maybe you are using ADN Open
and forums and would like to attend DevDays?&#0160;
Visit <a href="http://www.autodesk.com/joinadn">www.autodesk.com/joinadn</a> or send an email to
your <a href="http://usa.autodesk.com/adsk/servlet/index?siteID=123112&amp;id=473880">local
ADN representative</a> and let’s talk.&#0160;
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Madhukar Moogala
AUTHOR EMAIL: fpdtypepadadmin@autodesk.com
TITLE: Autodesk exchange Portathon event – Big Success
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 0
ALLOW PINGS: 0
BASENAME: autodesk-exchange-portathon-event-big-success
CATEGORY: Announcement

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/09/autodesk-exchange-portathon-event-big-success.html 
DATE: 09/16/2013 05:48:42 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/autocad/Virupaksha-Aithal.html" target="_self">Virupaksha Aithal</a></p>
The Autodesk Exchange Apps Portathon event is over.  On behalf of the Autodesk Developer Network (ADN) team I’d like to say a big “thank you” to all the publishers who has registered and submitted Apps to Autodesk exchange store.   We have received more than 240 Apps as part of this event.
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Madhukar Moogala
AUTHOR EMAIL: fpdtypepadadmin@autodesk.com
TITLE: Autodesk exchange Portathon event – Day1 update
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 0
ALLOW PINGS: 0
BASENAME: autodesk-exchange-portathon-event-day1-update
CATEGORY: Announcement

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/09/autodesk-exchange-portathon-event-day1-update.html 
DATE: 09/14/2013 03:09:42 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/autocad/Virupaksha-Aithal.html" target="_self">Virupaksha Aithal</a></p>
<p>We are now&nbsp;into second day of two day Autodesk exchange Portathon event. Response is very positive,&nbsp;Since we began the registration for Autodesk exchange Portathon event, we received 166 registrations till date. We have received 180+ Apps as part of the event and out of which we have published 62 Apps in the exchange store already.</p>
<p>Last 20 hours left to submit the apps as part of Autodesk exchange Portathon event.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Introducing our DevTV YouTube channel
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: introducing-our-devtv-youtube-channel
CATEGORY: Announcement
CATEGORY: DevTV
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/09/introducing-our-devtv-youtube-channel.html 
DATE: 09/09/2013 10:13:12 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>&#0160;</p>
<p>DevTVs of AEC BIM for Infrastructure
Modeling products are now in&#0160;<a href="http://www.youtube.com/channel/UC6Fl_1mFNt0rBqa068Vaxcg" target="_blank">Autodesk DevTV YouTube Channel</a>.</p>
<p>As indicated
by Stephen in his <a href="http://adndevblog.typepad.com/autocad/2013/09/introducing-our-devtv-youtube-channel.html" target="_self">post</a> in AutoCAD DevBlog – “<em>At the moment, its mostly a selection of old recordings we&#39;ve
posted in other places in the past. Our plan is to post all our DevTV videos
there in future, and link to them from our blogs and elsewhere.</em>”</p>
<p>Please send us your feedback and suggestion on the channel.</p>
Thanks!
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Madhukar Moogala
AUTHOR EMAIL: fpdtypepadadmin@autodesk.com
TITLE: Autodesk exchange Portathon event – update
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: autodesk-exchange-portathon-event-update
CATEGORY: Announcement

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/09/autodesk-exchange-portathon-event-update.html 
DATE: 09/06/2013 01:47:12 AM
-----
BODY:
<p>By&#0160;<a href="http://adndevblog.typepad.com/autocad/Virupaksha-Aithal.html" target="_self">Virupaksha
Aithal</a></p>
<p>Since
we began the registration for Autodesk exchange Portathon event, we received
127 registrations till date. We have received 98 Apps as part of the event and
out of which we have published 52 Apps in the exchange store already.</p>
<p>There
is less than 9 days to the event. if you have not registered&#0160;yet, visit&#0160;<a href="http://adndevblog.typepad.com/autocad/announcing-the-autodesk-exchange-apps-portathon.html">Autodesk®
Exchange Apps Portathon event page</a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: AutoCAD Civil 3D 2014 and Custom Draw API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: autocad-civil-3d-2014-and-custom-draw-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2014
CATEGORY: C++
CATEGORY: Civil 3D
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/08/autocad-civil-3d-2014-and-custom-draw-api.html 
DATE: 08/20/2013 01:49:42 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>Custom Draw
API is an extension of the AutoCAD ObjectARX (C++) API that allows us to
customize the way AutoCAD Civil 3D renders objects. There is a sample
application demonstrating this API which is part of the AutoCAD Civil 3D
installation folder typically at &lt;Civil 3D installation folder
&gt;<strong>\Sample\Civil 3D API\COM\VC++\CustomDraw\Lib\</strong>x64</p>
<p>&#0160;</p>
<p>In AutoCAD
Civil 3D 2014 release, unfortunately the Custom Draw API lib file [
<strong>AeccCustomDraw.lib</strong> ] is missing. I am uploading this
&quot;<strong>&#0160;</strong>
<span class="asset  asset-generic at-xid-6a0167607c2431970b0192aca271a1970d"><a href="http://adndevblog.typepad.com/files/lib.zip">AeccCustomDraw Lib</a></span>&quot; file here for those of you who want to use the
same in Civil 3D 2014.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Rasmus Bugge
EMAIL: rfb@focus.no
IP: 195.18.137.50
URL: 
DATE: 10/24/2013 03:32:10 AM
Hi Partha,

Thanks for the lib files. I link to this file and manage to build, but when my C3D 2014 add-on receives the AcRx::kInitAppMsg message and tries to do the following:
acrxLoadApp(_T("AeccCustomDraw100");
then I get this message from C3D:
"AeccCustomDrawRes.dll not found"

However acrxLoadApp returns true and I'm allowed to set my callback...Any idea?

-----
COMMENT:
AUTHOR: Rasmus Bugge
EMAIL: rfb@focus.no
IP: 195.18.137.50
URL: 
DATE: 10/24/2013 03:37:48 AM
Hi Partha,

Thanks for the lib-files! However, when my C3D 2014 add-in receives the AcRx::kInitAppMsg message and tries to load the Custom Draw app module (AeccCustomDraw100), C3D pops the following message:
AeccCustomDrawRes.dll not found

I'm allowed to set my callback, but the message box is a show stopper.
-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 59.92.205.209
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 10/31/2013 01:06:28 AM
Could apply SP1 and check it again ?

http://usa.autodesk.com/adsk/servlet/ps/dl/item?siteID=123112&id=22421170&linkID=9240698

I understand this is fixed in SP1.

Thanks,
Partha
-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Creating SampleLineGroup and SampleLine using AutoCAD Civil 3D .NET API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: creating-samplelinegroup-and-sampleline-using-autocad-civil-3d-net-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2014
CATEGORY: Civil 3D
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/08/creating-samplelinegroup-and-sampleline-using-autocad-civil-3d-net-api.html 
DATE: 08/13/2013 01:59:10 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>In this post,
let&#39;s see how to create <strong>SampleLineGroup</strong> and <strong>SampleLine</strong> using new .NET API in
Civil 3D 2014 release.</p>
<p><strong>Samplelines
</strong>are used to cut sections across an alignment. Samplelines are lines placed
along an alignment at a specified station interval (or at defined stations of
interest, such as at assemblies of a corridor object), using a specified left
and right swath width. SampleLine objects are contained in SampleLineGroup
objects, which organize multiple related sample lines. A <strong>SampleLine</strong> is used to
create a <strong>SectionView</strong> object, which displays some or all of the sections sampled
at that sample line. </p>
<p>We can create
a new <strong>SampleLineGroup</strong> object using <strong>SampleLineGroup.Create(</strong><em>string
groupName,&#0160; ObjectId alignmentId</em><strong> )</strong></p>
<p>And we can
create new <strong>SampleLine</strong> using the <strong>SampleLine.Create()</strong> static method which has two
different variants -</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="font-size: 10pt;"><span style="color: blue; line-height: 140%;">public</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">static</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> Create(</span><span style="color: blue; line-height: 140%;">string</span><span style="line-height: 140%;"> sampleLineName, </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> sampleLineGroupId, </span><span style="color: blue; line-height: 140%;">double</span><span style="line-height: 140%;"> station);</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;</span><span style="font-size: 10pt;"><span style="color: blue; line-height: 140%;">public</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">static</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> Create(</span><span style="color: blue; line-height: 140%;">string</span><span style="line-height: 140%;"> sampleLineName, </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> sampleLineGroupId, </span><span style="color: #2b91af; line-height: 140%;">Point2dCollection</span><span style="line-height: 140%;"> points);</span></span></p>
</div>
<p>&#0160;</p>
<p>C# code
snippet below, shows how to add a <strong>SampleLineGroup</strong> and a <strong>SampleLine</strong> using
Create(string sampleLineName, ObjectId sampleLineGroupId, Point2dCollection
points) –</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">Alignment</span><span style="line-height: 140%;"> alignment = trans.GetObject(alignmentId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForWrite) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Alignment</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> slgId = </span><span style="background-color: #ffff00;"><span style="color: #2b91af; line-height: 140%;">SampleLineGroup</span><span style="line-height: 140%;">.Create(</span><span style="color: #a31515; line-height: 140%;">&quot;My SampleLineGroup&quot;</span></span><span style="line-height: 140%;"><span style="background-color: #ffff00;">, alignment.ObjectI</span>d);</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">SampleLineGroup</span><span style="line-height: 140%;"> sampleLineGroup = trans.GetObject(slgId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForWrite) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">SampleLineGroup</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Creating Sample line from a selected set of Points</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">Point2dCollection</span><span style="line-height: 140%;"> points = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Point2dCollection</span><span style="line-height: 140%;">();</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">Point2d</span><span style="line-height: 140%;"> samplelineVertexPoint1 = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Point2d</span><span style="line-height: 140%;">(4528.7808,3884.1900);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">points.Add(samplelineVertexPoint1);</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">Point2d</span><span style="line-height: 140%;"> samplelineVertexPoint2 = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Point2d</span><span style="line-height: 140%;">(4545.6858,3859.4065);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">points.Add(samplelineVertexPoint2);</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> slatStationId = </span><span style="background-color: #ffff00;"><strong><span style="color: #2b91af; line-height: 140%;">SampleLine</span><span style="line-height: 140%;">.Create(</span><span style="color: #a31515; line-height: 140%;">&quot;SampleLineByPoints&quot;</span><span style="line-height: 140%;">, slgId, points);</span></strong></span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">SampleLine</span><span style="line-height: 140%;"> sampleLine = trans.GetObject(slatStationId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForWrite) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">SampleLine</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">sampleLine.StyleId = civilDoc.Styles.SampleLineStyles[0];</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">Here is the result -&#0160;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0192ac8336fb970d-pi" style="display: inline;"><img alt="Civil3D_Sampleline_using_API" class="asset  asset-image at-xid-6a0167607c2431970b0192ac8336fb970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0192ac8336fb970d-500wi" title="Civil3D_Sampleline_using_API" /></a><br /><br /></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><br /></span></p>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Dmitry
EMAIL: zagor_dmtr@mail.ru
IP: 77.232.58.146
URL: 
DATE: 09/06/2013 07:05:19 AM
I created Sample Line Group with using NET. AUDIT find two errors - not set parameters for Sample Line Group. In COM API this parameters may be set in method Add: AeccSampleLineGroup Add(string Name, string Layer, AeccGroupPlotStyle GroupPlotStyle, AeccSampleLineStyle SampleLineStyle, AeccLabelStyle SampleLineLabelStyle);
Command line log:
Command: _AUDIT
Fix any errors detected? [Yes/No] : Y
Auditing Header
Auditing Tables
Auditing Entities Pass 1
Pass 1 5700    objects auditedSample Line Group (Sample Line Style)
                    eNullObjectId                       Standard
Sample Line Group (Label Style)
                    eNullObjectId                       Standard
Auditing Entities Pass 2
Pass 2 5700    objects audited
Auditing Blocks
 58      Blocks audited
Auditing AcDsRecords
Total errors found 2 fixed 2
Erased 0 objects

-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 59.92.156.51
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 09/10/2013 08:49:00 PM
Thanks Dmitry !
I could reproduce it. I have logged this issue in our internal system to investigate it further. I hope this would be addressed soon.

Thanks again !
Partha
-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Demystifying CogoPoint.Latitude and CogoPoint.Longitude API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: demystifying-cogopointlatitude-and-cogopointlongitude-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: AutoCAD Civil 3D 2014
CATEGORY: Civil 3D
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/08/demystifying-cogopointlatitude-and-cogopointlongitude-api.html 
DATE: 08/08/2013 01:25:24 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>AutoCAD Civil
3D <a href="http://docs.autodesk.com/CIV3D/2014/ENU/API_Reference_Guide/index.html">.NET
API 2014 Reference</a> document clearly lists the following on <strong>CogoPoint.Latitude</strong>
and <strong>CogoPoint.Longitude</strong> –</p>
<p><strong>CogoPoint.Longitude</strong> -&gt; Gets or sets
the longitude for a point, relative to the coordinate zone and the
transformation settings specified for the drawing.</p>
<p><span style="font-size: 10pt;"><em>public:</em></span></p>
<p><span style="font-size: 10pt;"><em>property double Longitude {</em></span></p>
<p><span style="font-size: 10pt;"><em>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; double
get ();</em></span></p>
<p><span style="font-size: 10pt;"><em>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; void
set (double value);</em></span></p>
<p><span style="font-size: 10pt;"><em>}</em></span></p>
<p>&#0160;</p>
<p><strong>CogoPoint.Latitude</strong> -&gt; Gets or sets
the latitude for a point, relative to the coordinate zone and the
transformation settings specified for the drawing.</p>
<p>&#0160;</p>
<p><span style="font-size: 10pt;"><em>public:</em></span></p>
<p><span style="font-size: 10pt;"><em>property double Latitude {</em></span></p>
<p><span style="font-size: 10pt;"><em>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; double
get ();</em></span></p>
<p><span style="font-size: 10pt;"><em>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; void
set (double value);</em></span></p>
<p><span style="font-size: 10pt;"><em>}</em></span></p>
<p><span style="font-size: 10pt;"><em><br /></em></span></p>
<p>Let’s explore
this API returned results. First, we need to set an appropriate coordinate system
to our drawing file. For this experiment, I have used CA-II CS code as shown in
the screenshot below -</p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b019104a462a1970c-pi" style="display: inline;"><img alt="AutoCAD_Civil3D_Point_Lat_Long_01" class="asset  asset-image at-xid-6a0167607c2431970b019104a462a1970c" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b019104a462a1970c-500wi" title="AutoCAD_Civil3D_Point_Lat_Long_01" /></a><br /><br /></p>
<p>Now I will
create a COGO Point in the drawing area and we will investigate it’s Latitude
and Longitude values from API and in UI OPM.</p>
<p>Now let’s run
our custom application using Civil 3D .NET API CogoPoint.Latitude and CogoPoint.Longitude.
Here is the code snippet :</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> pointId = points.Add(pointCoord, </span><span style="color: #a31515; line-height: 140%;">&quot;My_Test_Point&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">CogoPoint</span><span style="line-height: 140%;"> cgPoint = trans.GetObject(pointId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForRead) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">CogoPoint</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Point Latitude and Longitude values are in Radians</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nPoint Lat : &quot;</span><span style="line-height: 140%;"> + <span style="background-color: #ffff00;">cgPoint.Latitude.ToString()</span> + </span><span style="color: #a31515; line-height: 140%;">&quot;&#0160; &quot;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; + </span><span style="color: #a31515; line-height: 140%;">&quot;Point Long : &quot;</span><span style="line-height: 140%;"> + <span style="background-color: #ffff00;">cgPoint.Longitude.ToString()</span>);</span></p>
</div>
<p>&#0160;</p>
<p>And here is
the result shown :</p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b019104a46312970c-pi" style="display: inline;"><img alt="AutoCAD_Civil3D_Point_Lat_Long_02" class="asset  asset-image at-xid-6a0167607c2431970b019104a46312970c" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b019104a46312970c-500wi" title="AutoCAD_Civil3D_Point_Lat_Long_02" /></a><br /><br /></p>
<p>In the result
we get decimal values whereas in the Properties window we see the values are in
degree-minute-second. However the values don’t seem to match! </p>
<p>API returned double
values are in <strong>Radians</strong>. Referring the above screenshot, if we convert the
Latitude value 0.654133960948817 radians to degree we get 37.4791089757124
degree and the Longitude value 2.24952166028165 radians converts to 128.8880756575156
degree. </p>
<p>Hope this is
useful to you!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Accessing Survey Database Points using AutoCAD Civil 3D COM API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: accessing-survey-database-points-using-autocad-civil-3d-com-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: AutoCAD Civil 3D 2014
CATEGORY: Civil 3D
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/08/accessing-survey-database-points-using-autocad-civil-3d-com-api.html 
DATE: 08/07/2013 12:11:31 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>Using
<strong>IAeccSurveyProject:: GetPointByNumber</strong> API we can access a Survey Point instance
with the input point number. Once we get the specific <strong>AeccSurveyPoint</strong> object we
can access its various properties and methods. Most of the properties in COM
API are read only i.e. we can get the value, but can set them using API except
few e.g. -</p>
<p><strong>IAeccSurveyPoint::
Name</strong> Property - &gt; Gets or sets the name of the Point.</p>
<p>Here is a
VB.NET sample code which demonstrates how to access Survey Database Points
using COM API in Civil 3D 2014 :</p>
<p>&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">Public</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Sub</span><span style="line-height: 140%;"> DemoAccessSurveyPoints()</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">&#39;&#39; This sample Demonstrates How to access Survey Database Points using COM API in Civil 3D 2014</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">&#39;&#39; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">&#39;&#39; Created by Partha Sarkar - DevTech, Autodesk</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> ed </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Editor</span><span style="line-height: 140%;"> = Autodesk.AutoCAD.ApplicationServices.</span><span style="color: #2b91af; line-height: 140%;">Application</span><span style="line-height: 140%;">.DocumentManager.MdiActiveDocument.Editor</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> oAcadApp </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> Autodesk.AutoCAD.Interop.</span><span style="color: #2b91af; line-height: 140%;">AcadApplication</span><span style="line-height: 140%;"> = </span><span style="color: blue; line-height: 140%;">Nothing</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> oAeccSurveyApp </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> Autodesk.AECC.Interop.UiSurvey.</span><span style="color: #2b91af; line-height: 140%;">AeccSurveyApplication</span><span style="line-height: 140%;"> = </span><span style="color: blue; line-height: 140%;">Nothing</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> oAeccSurveyDoc </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> Autodesk.AECC.Interop.UiSurvey.</span><span style="color: #2b91af; line-height: 140%;">AeccSurveyDocument</span><span style="line-height: 140%;"> = </span><span style="color: blue; line-height: 140%;">Nothing</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> oAeccSurveyDB </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> Autodesk.AECC.Interop.Survey.</span><span style="color: #2b91af; line-height: 140%;">AeccSurveyDatabase</span><span style="line-height: 140%;"> = </span><span style="color: blue; line-height: 140%;">Nothing</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">Using</span><span style="line-height: 140%;"> trans </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Transaction</span><span style="line-height: 140%;"> = </span><span style="color: #2b91af; line-height: 140%;">HostApplicationServices</span><span style="line-height: 140%;">.WorkingDatabase.TransactionManager.StartTransaction()</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Try</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">If</span><span style="line-height: 140%;"> oAcadApp </span><span style="color: blue; line-height: 140%;">Is</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Nothing</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Then</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; oAcadApp = GetObject(, </span><span style="color: #a31515; line-height: 140%;">&quot;AutoCAD.Application&quot;</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">If</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Catch</span><span style="line-height: 140%;"> ex </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Exception</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; ed.WriteMessage(ex.Message)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Try</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Try</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: green; line-height: 140%;">&#39; If you are using the COM API in Civil 3D 2014</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: green; line-height: 140%;">&#39; you need to update the object version to 10.3 </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: green; line-height: 140%;">&#39; http://adndevblog.typepad.com/infrastructure/2013/03/whats-new-in-autocad-civil-3d-2014-api.html</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; oAeccSurveyApp = oAcadApp.GetInterfaceObject(</span><span style="color: #a31515; line-height: 140%;">&quot;AeccXUiSurvey.AeccSurveyApplication.10.3&quot;</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; oAeccSurveyDoc = oAeccSurveyApp.ActiveDocument</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; oAeccSurveyDB = oAeccSurveyApp.ActiveDocument.Database</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> oSurveyProjects </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">AeccSurveyProjects</span><span style="line-height: 140%;"> = </span><span style="color: blue; line-height: 140%;">CType</span><span style="line-height: 140%;">(oAeccSurveyDB.Projects, </span><span style="color: #2b91af; line-height: 140%;">AeccSurveyProjects</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: green; line-height: 140%;">&#39; get the 1st Project from the Survey Projects collection</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="background-color: #ffff00;"><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> oSurveyProject </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">AeccSurveyProject</span><span style="line-height: 140%;"> = oSurveyProjects.Item(0)</span></span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">If</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Not</span><span style="line-height: 140%;"> (oSurveyProject </span><span style="color: blue; line-height: 140%;">Is</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Nothing</span><span style="line-height: 140%;">) </span><span style="color: blue; line-height: 140%;">Then</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; </span><span style="color: green; line-height: 140%;">&#39; Get the Project Name</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; ed.WriteMessage(vbCrLf + </span><span style="color: #a31515; line-height: 140%;">&quot;Projcet Name : &quot;</span><span style="line-height: 140%;"> + </span><span style="color: #a31515; line-height: 140%;">&quot; &quot;</span><span style="line-height: 140%;"> + oSurveyProject.Name.ToString())</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; </span><span style="color: green; line-height: 140%;">&#39; IAeccSurveyProject:: GetPointByNumber </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; </span><span style="color: green; line-height: 140%;">&#39; Gets the Survey Point instance with the input point number.</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; </span><span style="background-color: #ffff00;"><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> oSurveyPoint </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">AeccSurveyPoint</span><span style="line-height: 140%;"> = oSurveyProject.GetPointByNumber(1)</span></span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; </span><span style="color: green; line-height: 140%;">&#39; Check the Point Properties Name, Easting, Northing &amp; Elevation</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; ed.WriteMessage(vbCrLf + </span><span style="color: #a31515; line-height: 140%;">&quot;Point Name : &quot;</span><span style="line-height: 140%;"> + oSurveyPoint.Name.ToString() )</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; ed.WriteMessage(vbCrLf + </span><span style="color: #a31515; line-height: 140%;">&quot;Easting : &quot;</span><span style="line-height: 140%;"> + oSurveyPoint.Easting.ToString() + </span><span style="color: #a31515; line-height: 140%;">&quot; &quot;</span><span style="line-height: 140%;"> +</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: #a31515; line-height: 140%;">&quot;Northing : &quot;</span><span style="line-height: 140%;"> + oSurveyPoint.Northing.ToString() + </span><span style="color: #a31515; line-height: 140%;">&quot; &quot;</span><span style="line-height: 140%;"> + </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: #a31515; line-height: 140%;">&quot;Elevation : &quot;</span><span style="line-height: 140%;"> + oSurveyPoint.Elevation.ToString())</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">If</span><span style="line-height: 140%;">&#0160; &#0160; &#0160;&#0160; </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; trans.Commit()</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Catch</span><span style="line-height: 140%;"> ex </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Exception</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;Error : &quot;</span><span style="line-height: 140%;">, ex.Message &amp; vbCrLf)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Try</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Using</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Sub</span></p>
</div>
<p>&#0160;</p>
<p>Here is a
screenshot of the result from this code snippet :</p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0192ac68c09b970d-pi" style="display: inline;"><img alt="AutoCAD_Civil3D_Survey_Points_Access" class="asset  asset-image at-xid-6a0167607c2431970b0192ac68c09b970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0192ac68c09b970d-500wi" title="AutoCAD_Civil3D_Survey_Points_Access" /></a><br /><br /></p>
<p>&#0160;</p>
<p>Hope this is
useful to you!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Result of AutoCAD Civil 3D API wish-list Survey 2013
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: result-of-autocad-civil-3d-api-wish-list-survey-2013
CATEGORY: AutoCAD Civil 3D 2014
CATEGORY: Civil 3D
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/08/result-of-autocad-civil-3d-api-wish-list-survey-2013.html 
DATE: 08/01/2013 02:34:07 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>Recently we
concluded our <a href="http://adndevblog.typepad.com/infrastructure/2013/05/autocad-civil-3d-api-wishlist-survey-2013.html">AUTOCAD Civil 3D API Wishlist Survey,
2013</a>. First of all, I
would like to ‘<strong>Thank You</strong>’ all, who participated in the survey and shared their
valuable feedback. I am sharing some part of the result here using <a href="https://en.wikipedia.org/wiki/Infographic">infographics</a> – </p>
<p>&#0160;</p>
<p><strong>Question</strong>: <em>From
the following list of possible Civil 3D API enhancements, please select the
three areas most important to you -</em></p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0191048408d4970c-pi" style="display: inline;"><img alt="Civil3D_API_Wishlist_Result_01" class="asset  asset-image at-xid-6a0167607c2431970b0191048408d4970c" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0191048408d4970c-500wi" title="Civil3D_API_Wishlist_Result_01" /></a><br /><br /></p>
<p>&#0160;</p>
<p><strong>Question</strong>: <em>Rate
the importance of the following resources -</em></p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0192ac4d448b970d-pi" style="display: inline;"><img alt="Civil3D_API_Wishlist_Result_02" class="asset  asset-image at-xid-6a0167607c2431970b0192ac4d448b970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0192ac4d448b970d-500wi" title="Civil3D_API_Wishlist_Result_02" /></a><br /><br /></p>
<p>&#0160;</p>
<p><strong>Question</strong>: <em>What
are you doing with cloud technology?</em></p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b019104840a0b970c-pi" style="display: inline;"><img alt="Civil3D_API_Wishlist_Result_03" class="asset  asset-image at-xid-6a0167607c2431970b019104840a0b970c" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b019104840a0b970c-500wi" title="Civil3D_API_Wishlist_Result_03" /></a><br /><br /></p>
<p><strong>Question</strong>: <em>What
are you doing with mobile technology?</em></p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01901e8de6ba970b-pi" style="display: inline;"><img alt="Civil3D_API_Wishlist_Result_04" class="asset  asset-image at-xid-6a0167607c2431970b01901e8de6ba970b" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01901e8de6ba970b-500wi" title="Civil3D_API_Wishlist_Result_04" /></a><br /><br /></p>
<p><strong>Question</strong>: <em>Have
you posted your Apps to the Exchange Store?</em></p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b019104840ab7970c-pi" style="display: inline;"><img alt="Civil3D_API_Wishlist_Result_05" class="asset  asset-image at-xid-6a0167607c2431970b019104840ab7970c" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b019104840ab7970c-500wi" title="Civil3D_API_Wishlist_Result_05" /></a><br /><br /></p>
<p>&#0160;</p>
<p><strong>Question</strong>: <em>How
many people are using your Autodesk technology integrated product(s) today?</em></p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b019104840b2a970c-pi" style="display: inline;"><img alt="Civil3D_API_Wishlist_Result_06" class="asset  asset-image at-xid-6a0167607c2431970b019104840b2a970c" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b019104840b2a970c-500wi" title="Civil3D_API_Wishlist_Result_06" /></a><br /><br /></p>
<p>&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Setting the Point Style Marker Size and Scale using AutoCAD Civil 3D .NET API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: setting-the-point-style-marker-size-and-scale-using-autocad-civil-3d-net-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: AutoCAD Civil 3D 2014
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/07/setting-the-point-style-marker-size-and-scale-using-autocad-civil-3d-net-api.html 
DATE: 07/26/2013 12:14:09 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>If you want to create a new <strong>PointStyle</strong> object in AutoCAD
Civil 3D and set the <em><strong>Marker Size</strong></em> and <em><strong>Scale</strong></em> using .NET API, you first need to
create the new Point style or access the point style object you want to modify
and then set the SizeType property to use the <strong>MarkerSizeType</strong> enum values that
defines how the marker is sized such as ‘Use drawing scale’ or ‘Use fixed scale’
etc. Next set the MarkerSize or Scale values accordingly.</p>
<p>Here
is a C# .NET code snippet demonstrating the same :</p>
<p>&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">Transaction</span><span style="line-height: 140%;"> trans = db.TransactionManager.StartTransaction())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// Create a point style that uses a custom marker</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// and set the Size and scale</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> pointStyleId = civilDoc.Styles.PointStyles.Add(</span><span style="color: #a31515; line-height: 140%;">&quot;My DEMO Point Style&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">PointStyle</span><span style="line-height: 140%;"> pointStyle = pointStyleId.GetObject(</span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForWrite) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">PointStyle</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; pointStyle.MarkerType = </span><span style="color: #2b91af; line-height: 140%;">PointMarkerDisplayType</span><span style="line-height: 140%;">.UseCustomMarker;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; pointStyle.CustomMarkerStyle = </span><span style="color: #2b91af; line-height: 140%;">CustomMarkerType</span><span style="line-height: 140%;">.CustomMarkerX;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; pointStyle.CustomMarkerSuperimposeStyle = </span><span style="color: #2b91af; line-height: 140%;">CustomMarkerSuperimposeType</span><span style="line-height: 140%;">.Circle;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// set the size to use &#39;Drawing Scale&#39;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><strong><span style="line-height: 140%;">&#0160; pointStyle.SizeType = </span><span style="color: #2b91af; line-height: 140%;">MarkerSizeType</span><span style="line-height: 140%;">.DrawingScale;</span></strong></p>
<p style="margin: 0px;"><strong><span style="line-height: 140%;">&#0160; pointStyle.MarkerSize = 0.003;</span></strong></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// If you want to set the size to use &#39;Fixed Scale&#39;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">//pointStyle.SizeType = MarkerSizeType.FixedScale;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">//Point3d markerfixedscalePoint3d = new Point3d(3, 3, 3);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">//pointStyle.MarkerFixedScale = markerfixedscalePoint3d;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; trans.Commit();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
<p>&#0160;</p>
<p>Here is a screenshot of my new PointStyle with custom Marker :</p>
<p>&#0160;</p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b019104694fdc970c-pi" style="display: inline;"><img alt="Civil3D_PointStyle_Marker_Setting" class="asset  asset-image at-xid-6a0167607c2431970b019104694fdc970c" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b019104694fdc970c-500wi" title="Civil3D_PointStyle_Marker_Setting" /></a><br /><br /></p>
<p>Hope this is useful to you!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Mary Ann
EMAIL: MaryAnn.Africa@ocpw.ocgov.com
IP: 206.194.127.112
URL: 
DATE: 03/03/2014 12:02:23 PM
Is it possible in Civil3d to have the size of the point style base on field points. Let's say, first point shot is at the center of the electrical pullbox, next shot is middle west side and the last point shot is at northwest corner of the pullbox. So the actual dimension of the utility will be shown. 
-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 59.92.160.141
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 03/06/2014 07:15:52 AM
Hi Mary,

Are you talking about using same Style object but with different scale factor ? 
Or different Style object (may be using same block as symbol marker and other similar properties) but a different scale for marker ?

Thanks,
Partha
-----
--------
AUTHOR: Madhukar Moogala
AUTHOR EMAIL: fpdtypepadadmin@autodesk.com
TITLE: Get your Exchange Apps done by September 14 and receive US$100 per app published!
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 0
ALLOW PINGS: 0
BASENAME: get-your-exchange-apps-done-by-september-14-and-receive-us100-per-app-published
CATEGORY: Announcement

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/07/get-your-exchange-apps-done-by-september-14-and-receive-us100-per-app-published.html 
DATE: 07/22/2013 08:50:41 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/autocad/Virupaksha-Aithal.html" target="_self">Virupaksha Aithal</a></p>
<p>Do
you have apps you want to publish on Autodesk® Exchange Apps but can’t find the
time to actually do it? &nbsp;We have some good news - &nbsp;the Autodesk
Developer Network team is going to give you some of our time to help you get
the job done.</p>
<p>You
are invited to join the inaugural Autodesk® Exchange Apps Portathon – a 48 hour
virtual web based coding “festival” that will run from&nbsp;Friday, September
13 through September 14.&nbsp; The Exchange Apps Portathon is a community event
where you’ll have the opportunity to work closely with Autodesk engineers in
real time and learn from the questions asked by Autodesk software partners from
around the world.&nbsp; It is all designed to help you get your apps ready and
published on Autodesk Exchange Apps.&nbsp; Note: the event is for “new” apps –
whether you are a first-time publisher or an existing publisher with ideas for
additional apps.</p>
<p>For registrations and details visit <a href="http://adndevblog.typepad.com/autocad/announcing-the-autodesk-exchange-apps-portathon.html">Autodesk®
Exchange Apps Portathon event page</a>. &nbsp;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Assign coordinate systems to an AutoCAD Civil 3D DWG file using API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: assign-coordinate-systems-to-an-autocad-civil-3d-dwg-file-using-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: AutoCAD Civil 3D 2014
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/07/assign-coordinate-systems-to-an-autocad-civil-3d-dwg-file-using-api.html 
DATE: 07/18/2013 12:05:13 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>In AutoCAD
Civil 3D user interface (UI), in the &#39;Drawing Settings&#39; dialog, at &#39;Units and
Zone&#39; tab, we can select a geographic coordinate system from the available list
and apply the same to the current DWG file.</p>
<p>
Here is a C# .NET
code snippet which demonstrates how to do the same using .NET API -</p>
<p>&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">//start a transaction </span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">Transaction</span><span style="line-height: 140%;"> trans = db.TransactionManager.StartTransaction())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> (Autodesk.AutoCAD.ApplicationServices.</span><span style="color: #2b91af; line-height: 140%;">DocumentLock</span><span style="line-height: 140%;"> locker = </span><span style="color: #2b91af; line-height: 140%;">AcadApp</span><span style="line-height: 140%;">.DocumentManager.MdiActiveDocument.LockDocument())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; {&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: green; line-height: 140%;">// perform any document / database modifications here&#0160;&#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">SettingsDrawing</span><span style="line-height: 140%;"> settingsDWG = civilDoc.Settings.DrawingSettings;&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: green; line-height: 140%;">//settingsDWG.UnitZoneSettings.CoordinateSystemCode = &quot;LL84&quot;;</span></p>
<p style="margin: 0px;"><span style="background-color: #ffff00;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; settingsDWG.UnitZoneSettings.CoordinateSystemCode = </span><span style="color: #a31515; line-height: 140%;">&quot;FL83-EF&quot;</span><span style="line-height: 140%;">;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nCoordinateSystemCode = &quot;</span><span style="line-height: 140%;"> + settingsDWG.UnitZoneSettings.CoordinateSystemCode.ToString());</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; }</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; trans.Commit();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01901e51ae2b970b-pi" style="display: inline;"><img alt="Civil3D_CoordinateSystem" class="asset  asset-image at-xid-6a0167607c2431970b01901e51ae2b970b" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01901e51ae2b970b-500wi" title="Civil3D_CoordinateSystem" /></a><br /><br /></span></p>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Removing ProfileXXXLabelGroup using AutoCAD Civil 3D .NET API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: removing-profilexxxlabelgroup-using-autocad-civil-3d-net-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: AutoCAD Civil 3D 2014
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/07/removing-profilexxxlabelgroup-using-autocad-civil-3d-net-api.html 
DATE: 07/15/2013 04:23:32 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>In AutoCAD
Civil 3D, User Interface (UI) , we can select a Profile LabelGroup in the
Profile View and from the &quot;Edit Label Group&quot; tool / command we can
bring-up the &quot;Profile Label&quot; dialog box. In that dialog box, each
Type of Profile Label Groups are listed and using the UI tools we can Add or
Remove (X) a particular Type.</p>
<p>&#0160;</p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01901e45ad16970b-pi" style="display: inline;"><img alt="ProfileLabelGroup" class="asset  asset-image at-xid-6a0167607c2431970b01901e45ad16970b" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01901e45ad16970b-500wi" title="ProfileLabelGroup" /></a></p>
<p>&#0160;</p>
<p>If you want
to programmatically remove / erase a particular Profile Label Group, the first
task is to identify the Profile Label Group Type. In the following example, we
can see <strong>ProfileCrestCurveLabelGroup</strong> Type which is listed as
<strong>AECC_VALIGNMENT_CRESTCURVE_LABEL_GROUP</strong> when we use the LIST command is selected
first and later removed just by calling the <strong>Erase()</strong> method.</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// select a Label Object </span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">PromptEntityOptions</span><span style="line-height: 140%;"> peo = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">PromptEntityOptions</span><span style="line-height: 140%;">(</span><span style="color: #a31515; line-height: 140%;">&quot;Select A Profile Label Group : &quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">peo.SetRejectMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nOnly Label is allowed&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">peo.AddAllowedClass(</span><span style="color: blue; line-height: 140%;">typeof</span><span style="line-height: 140%;">(Autodesk.Civil.DatabaseServices.</span><span style="color: #2b91af; line-height: 140%;">ProfileCrestCurveLabelGroup</span><span style="line-height: 140%;">), </span><span style="color: blue; line-height: 140%;">false</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">PromptEntityResult</span><span style="line-height: 140%;"> per = ed.GetEntity(peo);</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (per.Status != </span><span style="color: #2b91af; line-height: 140%;">PromptStatus</span><span style="line-height: 140%;">.OK) </span><span style="color: blue; line-height: 140%;">return</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">//start a transaction </span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">Transaction</span><span style="line-height: 140%;"> trans = db.TransactionManager.StartTransaction())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%; background-color: #ffff00;">ProfileCrestCurveLabelGroup</span><span style="line-height: 140%;"> profCrestCurveLabelGroup = trans.GetObject(per.ObjectId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForWrite) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">ProfileCrestCurveLabelGroup</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%; background-color: #ffff00;">&#0160; profCrestCurveLabelGroup.Erase();</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; trans.Commit();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
<p>&#0160;</p>
<p>Hope this is
useful to you!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: SettingsObjectLayerType Enumeration includes more Object Types in 2014 Release
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: settingsobjectlayertype-enumeration-includes-more-object-types-in-2014-release
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2014
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/07/settingsobjectlayertype-enumeration-includes-more-object-types-in-2014-release.html 
DATE: 07/12/2013 12:53:19 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p><strong>SettingsObjectLayerType</strong>
Enumeration includes more Object Types in 2014 release – e.g.</p>
<p>Appurtenance</p>
<p>AppurtenanceLabeling</p>
<p>CantView</p>
<p>Catchment</p>
<p>CatchmentLabeling</p>
<p>Fitting</p>
<p>FittingLabeling</p>
<p>PressureNetworkSection</p>
<p>&#0160;and many
more...</p>
<p>
Here is a screenshot
which shows the additional Types included in 2014 release for
SettingsObjectLayerType Enumeration -</p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0192abf990f9970d-pi" style="display: inline;"><img alt="SettingsObjectLayerType" class="asset  asset-image at-xid-6a0167607c2431970b0192abf990f9970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0192abf990f9970d-500wi" title="SettingsObjectLayerType" /></a></p>
<p>&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Using LINQ with AutoCAD and Civil 3D APIs
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: using-linq-with-autocad-and-civil-3d-apis
CATEGORY: .NET
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D 2014

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/07/using-linq-with-autocad-and-civil-3d-apis.html 
DATE: 07/05/2013 10:44:42 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>In a previous post, I showed an example of <a href="http://adndevblog.typepad.com/infrastructure/2012/05/using-linq-with-civil-3d-activex-objects.html" target="_blank">LINQ</a> with ActiveX object collection. Now, this sample is showing another sample with .NET objects.</p>  <p>This sample show an example where all the Arcs on the Model Space are selected, then we use LINQ to filter only the arcs close to the Alignment (distance from the center of the arc to the alignment smaller than a maximum). But more that that, it also order the arcs by its projected stations (imagine a line from the center of the arc to the alignment, then the station at that point). The result may be like the image below:</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01910418eb1c970c-pi"><img title="curve_number" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="curve_number" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01910418eb27970c-pi" width="477" height="347" /></a></p>  <p>As a learning point, LINQ have several interesting applications and it’s quite fast. </p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><font face="Courier New"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">Public</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#0000ff">Function</font></span><font color="#000000"> FindArcsByDistance(</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; alignId </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">ObjectId</font></span><font color="#000000">,</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; maxOffset </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">Double</font></span><font color="#000000">) </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#2b91af">ObjectIdCollection</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">' returning list</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Dim</font></span><font color="#000000"> curvesIds </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">New</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#2b91af">ObjectIdCollection</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Dim</font></span><font color="#000000"> db </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">Database</font></span><font color="#000000"> = alignId.Database</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Using</font></span><font color="#000000"> trans </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">Transaction</font></span><font color="#000000"> = db.TransactionManager.StartTransaction</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">' open the alignment</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Dim</font></span><font color="#000000"> align </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">Alignment</font></span><font color="#000000"> = trans.GetObject(</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; alignId, </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">OpenMode</font></span><font color="#000000">.ForRead)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">' open the current space through the Alignment owner</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Dim</font></span><font color="#000000"> mSpace </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">BlockTableRecord</font></span><font color="#000000"> = trans.GetObject(</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; align.OwnerId, </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">OpenMode</font></span><font color="#000000">.ForWrite)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">' get all Arc, regardless where</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">' you may consider add an aditional filter, e.g by layer</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Dim</font></span><font color="#000000"> curves </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">New</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#2b91af">DBObjectCollection</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">For</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">Each</font></span><font color="#000000"> entityId </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">ObjectId</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">In</font></span><font color="#000000"> mSpace</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Dim</font></span><font color="#000000"> curve </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">Arc</font></span><font color="#000000"> = </font><span style="color: "><font color="#0000ff">TryCast</font></span><font color="#000000">(</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; trans.GetObject(entityId, </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">OpenMode</font></span><font color="#000000">.ForRead), </font><span style="color: "><font color="#2b91af">Arc</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">If</font></span><font color="#000000"> (curve </font><span style="color: "><font color="#0000ff">Is</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">Nothing</font></span><font color="#000000">) </font><span style="color: "><font color="#0000ff">Then</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">Continue For</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">' not an Arc, next</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; curves.Add(curve)</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">Next</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">' use LINQ to filter and order the arcs</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">' some of the methods related to geometry are not implemented on </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">' the alignment object, so we need to workaround with </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">' GetClosestPointTo&#160; and GetDistAtPoint.</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Dim</font></span><font color="#000000"> curvesFiltered =</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">From</font></span><font color="#000000"> arc </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">Arc</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">In</font></span><font color="#000000"> curves</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Where</font></span><font color="#000000"> arc.Center.DistanceTo(</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; align.GetClosestPointTo(arc.Center, </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">False</font></span><font color="#000000">)) &lt; maxOffset</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Order</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">By</font></span><font color="#000000"> align.GetDistAtPoint(</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; align.GetClosestPointTo(arc.Center, </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">False</font></span><font color="#000000">))</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">' write a text along the curve</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Dim</font></span><font color="#000000"> cont </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">Integer</font></span><font color="#000000"> = 1</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">For</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">Each</font></span><font color="#000000"> curve </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">Arc</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">In</font></span><font color="#000000"> curvesFiltered</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">' return value</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; curvesIds.Add(curve.ObjectId)</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">' consider a line from the arc start point to end</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Dim</font></span><font color="#000000"> referenceLine </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">New</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">LineSegment3d</font></span><font color="#000000">(</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; curve.StartPoint, curve.EndPoint)</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">' draw a DBText aligned to this line</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Dim</font></span><font color="#000000"> curveLabel </font><span style="color: "><font color="#0000ff">As</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">New</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#2b91af">DBText</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; curveLabel.SetDatabaseDefaults()</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; curveLabel.TextString = </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">String</font></span><font color="#000000">.Format(</font><span style="color: "><font color="#a31515">&quot;Curve = {0}&quot;</font></span><font color="#000000">, cont)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; curveLabel.HorizontalMode = </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">TextHorizontalMode</font></span><font color="#000000">.TextCenter</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; curveLabel.AlignmentPoint = referenceLine.MidPoint</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; curveLabel.Rotation = referenceLine.Direction.</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; GetAngleTo(</font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">Vector3d</font></span><font color="#000000">.XAxis)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">' add to the model space</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; mSpace.AppendEntity(curveLabel)</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; trans.AddNewlyCreatedDBObject(curveLabel, </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">True</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; cont += 1</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">Next</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; trans.Commit()</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">Using</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">Return</font></span><font color="#000000"> curvesIds</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="color: "><font color="#0000ff"><font style="font-size: 8pt">End</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">Function</font></span></font></p> </div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: AutoCAD Civil 3D and Pressure Pipe .NET API, Part - I
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: autocad-civil-3d-and-pressure-pipe-net-api-part-i
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2014
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/06/autocad-civil-3d-and-pressure-pipe-net-api-part-i.html 
DATE: 06/19/2013 12:07:12 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>&#0160;</p>
<p>Pressure Pipe
is relatively a new Feature in AutoCAD Civil 3D which was introduced in
previous release. This is an evolving feature which was enhanced in the current
release and I see a scope of further enhancement in the coming days. Certain
objects and it&#39;s functionalities of Pressure Pipe is also exposed in .NET API
and it is packaged in its own assembly called &quot;<strong>AeccPressurePipesMgd.dll</strong>&quot;
and you <span style="text-decoration: underline;">need</span> to reference the same assembly to use Pressure Pipes .NET API
features.</p>
<p>&#0160;</p>
<p>In this
screenshot we can see currently available classes in <strong>AeccPressurePipesMgd.dll</strong> -</p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0192ab4b3e6d970d-pi" style="display: inline;"><img alt="Civil3D2014_PressurePipeAPI" class="asset  asset-image at-xid-6a0167607c2431970b0192ab4b3e6d970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0192ab4b3e6d970d-500wi" title="Civil3D2014_PressurePipeAPI" /></a><br /><br /></p>
<p>&#0160;</p>
<p><strong>CivilDocumentPressurePipesExtension</strong>
has a <em><strong>static</strong></em> method <em><strong>GetPressurePipeNetworkIds</strong></em>(CivilDocument document) which
will get us the <em><strong>ObjectIdCollection</strong></em> of the PressurePipeNetworks in the current
Civil 3D DWG file and that&#39;s going to be our access point. </p>
<p>&#0160;</p>
In the next post we
will explore more on Pressure PipeNetwork .NET API in Civil 3D 2014; till then,
don&#39;t hesitate to post your comment here on what you have explored so far, in
Pressure Pipe .NET API and what you would like to see in future release.
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: umar jikhad
EMAIL: alkaida@justkidding.com
IP: 188.226.60.14
URL: 
DATE: 06/25/2013 08:13:47 AM
without band types for profile views to get data (elevation etc) to profile footer table your "pressure networks" are NO USE AT ALL!
thanks for taking forever to do something decent for pressure networks engeneers.
-----
COMMENT:
AUTHOR: Pressure Pipe
EMAIL: plasticpipeshops@gmail.com
IP: 117.214.158.133
URL: http://www.plasticpipeshop.co.uk/
DATE: 06/25/2013 11:30:47 PM
Thanks for the sharing of such information. we will pass it on to our readers. This is a great reading. Thanking you

-----
COMMENT:
AUTHOR: Basha
EMAIL: basha_sk312@yahoo.com
IP: 78.100.87.194
URL: 
DATE: 07/04/2013 12:04:43 AM
Hi Partha, Thanks for the API for Pressure Pipe. Can you please guide me to the link where i can find all the Civil 3D objects that are exposed through API. 

Thanks,
Basha
-----
COMMENT:
AUTHOR: Basha
EMAIL: basha_sk312@yahoo.com
IP: 78.100.87.194
URL: 
DATE: 07/04/2013 12:33:32 AM
Thanks
-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 59.92.183.159
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 07/04/2013 03:02:43 AM
Hi Basha,

Pressure Pipe .NET API is at nascent stage. There is no official documentation available yet on Pressure Pipe .NET API. 

For all the Objects in Civil 3D .NET API you can get the API Reference doc as well as Develoer Guide link from my earlier blog post - 

http://adndevblog.typepad.com/infrastructure/2013/04/autocad-civil-3d-2014-developer-documents.html

Thanks,
Partha

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: How do I change the default styles of Points in AutoCAD Civil 3D using .NET API?
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: how-do-i-change-the-default-styles-of-points-in-autocad-civil-3d-using-net-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2012
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: AutoCAD Civil 3D 2014
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/06/how-do-i-change-the-default-styles-of-points-in-autocad-civil-3d-using-net-api.html 
DATE: 06/10/2013 10:44:56 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>In AutoCAD
Civil 3D ‘Create Points’ dialog, under Parameter if you expand the ‘Default
Styles’ collection, you will see the default ‘Point Style’ and ‘Point Label
Style’ field and their corresponding values in the ‘Value’ column as shown in
the screenshot below –</p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01901d3f73aa970b-pi" style="display: inline;"><img alt="Civil3D_Point_Default_Style" class="asset  asset-image at-xid-6a0167607c2431970b01901d3f73aa970b" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01901d3f73aa970b-500wi" title="Civil3D_Point_Default_Style" /></a><br /><br /></p>
<p>If you want to change these default style values using
Civil 3D .NET API, you need to get the <strong>SettingsPoint</strong> object first and then
update the Style and Label styles value as shown in the C# .NET code snippet
below –</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">Transaction</span><span style="line-height: 140%;"> trans = db.TransactionManager.StartTransaction())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// get the SettingsPoint object</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">SettingsPoint</span><span style="line-height: 140%;"> pointSettings = civilDoc.Settings.GetSettings&lt;</span><span style="color: #2b91af; line-height: 140%;">SettingsPoint</span><span style="line-height: 140%;">&gt;() </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">SettingsPoint</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// now set the value for default Style and Label Style</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// make sure the values exists in DWG file before you try to set them</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; pointSettings.Styles.Point.Value = </span><span style="color: #a31515; line-height: 140%;">&quot;Benchmark&quot;</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; pointSettings.Styles.PointLabel.Value = </span><span style="color: #a31515; line-height: 140%;">&quot;Elevation Only&quot;</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; trans.Commit();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
<p>&#0160;</p>
<p>Once you run your custom application the default style
and labels style value for Point object will be changed – </p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01901d3f74ff970b-pi" style="display: inline;"><img alt="Civil3D_Point_Default_Style_afterChange" class="asset  asset-image at-xid-6a0167607c2431970b01901d3f74ff970b" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01901d3f74ff970b-500wi" title="Civil3D_Point_Default_Style_afterChange" /></a><br /><br /></p>
<p>Hope this is useful to you!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:
Civil 3D, Points, Default Style, Label Style
-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Creating Offset Alignments using Civil 3D .NET API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: creating-offset-alignments-using-civil-3d-net-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: AutoCAD Civil 3D 2014

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/06/creating-offset-alignments-using-civil-3d-net-api.html 
DATE: 06/04/2013 10:52:57 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>In Civil 3D
.NET API, Alignment class has an overloaded method named
<strong>CreateOffsetAlignment()</strong> which allows us to create an offset Alignment. One of
the overloaded methods <em>Alignment.CreateOffsetAlignment (Double)</em> is now <span style="color: #ff0000;">obsolete</span>
[ 2013 &amp; 2014 release]. </p>
<p>&#0160;</p>
<p>There is a
code sample on how to create offset Alignment available at Civil 3D
installation folder :</p>
<p>&lt;Civil 3D
Installation Folder&gt;\<strong>Sample\Civil 3D API\DotNet\CSharp\OffsetAlignmentDemo&#0160;</strong></p>
<p>This sample
uses the following version of CreateOffsetAlignment() -</p>
<p><span style="color: #0000ff;">public
static ObjectId <strong>CreateOffsetAlignment</strong>(</span></p>
<p><span style="color: #0000ff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; string alignmentName,</span></p>
<p><span style="color: #0000ff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ObjectId parentAlignmentId,</span></p>
<p><span style="color: #0000ff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; double offset,</span></p>
<p><span style="color: #0000ff;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ObjectId styleId</span></p>
<p><span style="color: #0000ff;">)</span></p>
<p>&#0160;</p>
<p><span style="background-color: #ffff00; font-size: 10pt;"><span style="font-family: &#39;Courier New&#39;; color: #2b91af; line-height: 140%;">Alignment</span><span style="font-family: &#39;Courier New&#39;; line-height: 140%;">.CreateOffsetAlignment(</span><span style="font-family: &#39;Courier New&#39;; color: #2b91af; line-height: 140%;">String</span><span style="font-family: &#39;Courier New&#39;; line-height: 140%;">.Format(</span><span style="font-family: &#39;Courier New&#39;; color: #a31515; line-height: 140%;">&quot;Offset {0} Right&quot;</span><span style="font-family: &#39;Courier New&#39;; line-height: 140%;">, d), alignId, d, styleId);</span></span></p>
<p>In the Code
sample you will notice it tries to get the styleId for a specific Alignment
style and if that style object is not present in your test DWG file your
application will throw an error. So, you need to be careful to modify the
following line of the sample code as per your requirement -</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="font-size: 10pt;"><span style="color: blue; line-height: 140%;">var</span><span style="line-height: 140%;"> styleId = doc.Styles.AlignmentStyles[</span><span style="color: #a31515; line-height: 140%; background-color: #ffff00;">&quot;Offsets&quot;</span><span style="line-height: 140%;">];</span></span></p>
</div>
<p>&#0160;</p>
<p>And here is
the result you will see if you successfully run the same code sample in Civil
3D :</p>
<p>&#0160;</p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b019102f74ce3970c-pi" style="display: inline;"><img alt="Offset_Alignment" class="asset  asset-image at-xid-6a0167607c2431970b019102f74ce3970c" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b019102f74ce3970c-500wi" title="Offset_Alignment" /></a><br /><br /></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Is there a way to determine if a specific Style object is in-use?
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: is-there-a-way-to-determine-if-a-specific-style-object-is-in-use
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2014
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/05/is-there-a-way-to-determine-if-a-specific-style-object-is-in-use.html 
DATE: 05/22/2013 10:34:19 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>In Civil 3D
UI, if we expand the styles collection of a Civil 3D object, you will notice
the yellow triangle next to it which indicates this style is &#39;in-use&#39;, e.g. in
the screenshot we see the style collection of Surface styles which are in use -</p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0192aa37999e970d-pi" style="display: inline;"><img alt="Styles_01" class="asset  asset-image at-xid-6a0167607c2431970b0192aa37999e970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0192aa37999e970d-500wi" title="Styles_01" /></a></p>
<p>&#0160;</p>
<p>In Civil 3D
2014 .NET API, we have a very useful API <strong>StyleBase.IsUsed</strong> which will tell us if
a particular style is in-use. &#0160;Here is a
relevant C# code snippet :</p>
<p>&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">foreach</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> surfaceStyleId </span><span style="color: blue; line-height: 140%;">in</span><span style="line-height: 140%;"> civilDoc.Styles.SurfaceStyles)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">//&#0160; Open each style object to check if it is &quot;in-use&quot;&#0160; </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">SurfaceStyle</span><span style="line-height: 140%;"> csStyle = surfaceStyleId.GetObject(</span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForRead) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">SurfaceStyle</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (<span style="background-color: #ffff00;">csStyle.IsUsed</span>)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; surfaceStyleNameColl = surfaceStyleNameColl + </span><span style="color: #a31515; line-height: 140%;">&quot;\n &quot;</span><span style="line-height: 140%;"> + csStyle.Name.ToString();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0191026f2318970c-pi" style="display: inline;"><img alt="Styles_02" class="asset  asset-image at-xid-6a0167607c2431970b0191026f2318970c" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0191026f2318970c-500wi" title="Styles_02" /></a><br /></span></p>
<p style="margin: 0px;">&#0160;</p>
<p>&#0160;</p>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: AUTOCAD Civil 3D API Wishlist Survey, 2013
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: autocad-civil-3d-api-wishlist-survey-2013
CATEGORY: Announcement
CATEGORY: AutoCAD Civil 3D 2014
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/05/autocad-civil-3d-api-wishlist-survey-2013.html 
DATE: 05/17/2013 04:14:29 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>Each year we organize a survey to
find out what improvements you&#39;d like to see on the <strong>AutoCAD®
Civil 3D® API</strong> front. Here is your chance this year round to provide some
feedback: &#0160;<a href="https://www.surveymonkey.com/s/Civil3DAPIWishListSurveyY2013">Click here to take survey</a>
<strong></strong></p>
<p><strong>The survey is ending on the 15<sup>th</sup>
of June 2013.</strong></p>
<p>Don’t miss this opportunity to send
us your wish list. Thank you in advance! :)</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Creating a SectionView and setting its elevation range using .NET API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: creating-a-sectionview-and-setting-its-elevation-range-using-net-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2014
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/05/creating-a-sectionview-and-setting-its-elevation-range-using-net-api.html 
DATE: 05/14/2013 01:56:50 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>Civil 3D 2014 <a href="http://docs.autodesk.com/CIV3D/2014/ENU/API_Reference_Guide/index.html">.NET API</a> has a static method to create a new <strong>SectionView
</strong>which takes three parameters and adds a new&#0160;&#0160;<strong>SectionView - &#0160;&#0160;</strong>public static <strong>ObjectId</strong> Create(<strong>string</strong> <em>sectionViewName</em>,&#0160;&#0160;&#0160;&#0160;&#0160; <strong>ObjectId</strong> <em>sampleLineId</em>,&#0160;&#0160;&#0160; <strong>Point3d</strong> <em>location</em>)&#0160;</p>
<p>Once we add a new <strong>SectionView</strong>, next we
can set the maximum and minimum elevation using the following property :&#0160;</p>
<p><strong>SectionView.ElevationMax</strong> -&gt; Gets or
sets the maximum elevation of the section view.</p>
<p><strong>SectionView.ElevationMin</strong>&#0160; -&gt; Gets or sets the minimum elevation of
the section view. </p>
<p>&#0160;</p>
<p>When we add a new <strong>SectionView</strong> by
default the &#39;<strong>Elevation range</strong>&#39; is set to &quot;<strong>Automatic</strong>&quot;. If we want to
set it to &quot;<strong>User specified</strong>&quot; as shown in the screenshot below using the
API, then we need to set the <strong>IsElevationRangeAutomatic</strong> property to <em><strong>false</strong></em>.
Otherwise, trying to set the ElevationMin or ElevationMax will throw an exception
:&#0160;<em>The minimum elevation can&#39;t be set when
elevation range is selected to automatic</em>.</p>
<p>&#0160;</p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0191021de6b6970c-pi" style="display: inline;"><img alt="SV_02" class="asset  asset-image at-xid-6a0167607c2431970b0191021de6b6970c" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0191021de6b6970c-500wi" title="SV_02" /></a><br /><br /></p>
<p>&#0160;</p>
<p>Here is the relevant C# .NET code
snippet on how to create a new SectionView and set the Elevation Range :</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// get the Editor</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">Editor</span><span style="line-height: 140%;"> ed = </span><span style="color: #2b91af; line-height: 140%;">Application</span><span style="line-height: 140%;">.DocumentManager.MdiActiveDocument.Editor;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">//select a sampleline to add a SectionView</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">PromptEntityOptions</span><span style="line-height: 140%;"> selsampleline = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">PromptEntityOptions</span><span style="line-height: 140%;">(</span><span style="color: #a31515; line-height: 140%;">&quot;\nSelect a SampleLine Object: &quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">selsampleline.SetRejectMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nOnly Civil 3D SampleLine is allowed&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">selsampleline.AddAllowedClass(</span><span style="color: blue; line-height: 140%;">typeof</span><span style="line-height: 140%;">(</span><span style="color: #2b91af; line-height: 140%;">SampleLine</span><span style="line-height: 140%;">), </span><span style="color: blue; line-height: 140%;">true</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">PromptEntityResult</span><span style="line-height: 140%;"> resSL = ed.GetEntity(selsampleline);</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (resSL.Status != </span><span style="color: #2b91af; line-height: 140%;">PromptStatus</span><span style="line-height: 140%;">.OK) </span><span style="color: blue; line-height: 140%;">return</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> sampleLineId = resSL.ObjectId;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">Database</span><span style="line-height: 140%;"> db = </span><span style="color: #2b91af; line-height: 140%;">Application</span><span style="line-height: 140%;">.DocumentManager.MdiActiveDocument.Database;</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">CivilDocument</span><span style="line-height: 140%;"> civilDoc = </span><span style="color: #2b91af; line-height: 140%;">CivilApplication</span><span style="line-height: 140%;">.ActiveDocument;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">Transaction</span><span style="line-height: 140%;"> trans = db.TransactionManager.StartTransaction())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// public static ObjectId Create(string sectionViewName, ObjectId sampleLineId, Point3d location)&#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// lets select the location of the newly created section view</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">Point3d</span><span style="line-height: 140%;"> location ;</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">PromptPointResult</span><span style="line-height: 140%;"> ppr = ed.GetPoint(</span><span style="color: #a31515; line-height: 140%;">&quot;\nSelect a Location for the new SectionView:&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (ppr.Status != </span><span style="color: #2b91af; line-height: 140%;">PromptStatus</span><span style="line-height: 140%;">.OK)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">return</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">location = ppr.Value;&#0160; &#0160; &#0160;&#0160; </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// add the SectionView</span></p>
<p style="margin: 0px;"><span style="background-color: #ffff00;"><strong><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> sectionViewId = </span><span style="color: #2b91af; line-height: 140%;">SectionView</span><span style="line-height: 140%;">.Create(</span><span style="color: #a31515; line-height: 140%;">&quot;My_Test_SV&quot;</span><span style="line-height: 140%;">, sampleLineId, location);</span></strong></span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">SectionView</span><span style="line-height: 140%;"> sectionView = trans.GetObject(sectionViewId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForWrite) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">SectionView</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">SectionOverride</span><span style="line-height: 140%;"> overrideObj = sectionView.GraphOverrides[0];</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">overrideObj.Draw = </span><span style="color: blue; line-height: 140%;">true</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// When we add a new SectionView by default the &#39;Elevation range&#39; is set to &quot;Automatic&quot;. </span></p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// If we want to set it to &quot;User specified&quot; as shown in the screesnhot below using the API, </span></p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// then we need to set the IsElevationRangeAutomatic property to False. </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">sectionView.IsElevationRangeAutomatic = </span><span style="color: blue; line-height: 140%;">false</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Following values are specific to a Civil 3D sample DWG file&#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;"><span style="background-color: #ffff00;"><strong><span style="line-height: 140%;">sectionView.ElevationMin = 610.00;</span></strong></span></p>
<p style="margin: 0px;"><strong><span style="line-height: 140%;">sectionView.ElevationMax = 700.00;</span></strong></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">trans.Commit();</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0191021ded35970c-pi" style="display: inline;"><img alt="SV_01" class="asset  asset-image at-xid-6a0167607c2431970b0191021ded35970c" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0191021ded35970c-500wi" title="SV_01" /></a><br /><br /></span></p>
</div>
<p>I hope this is useful to you!&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Gopinath Taget
AUTHOR EMAIL: gopinath.taget@autodesk.com
TITLE: AutoCAD Map 3D API Training content: Part-6
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: autocad-map-3d-api-training-content-part-6
CATEGORY: .NET
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: FDO
CATEGORY: Gopinath Taget

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/05/autocad-map-3d-api-training-content-part-6.html 
DATE: 05/10/2013 12:28:00 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/gopinath-taget.html">Gopinath Taget</a></p>  <p>This is the final post in the series titled <strong>AutoCAD Map 3D API Training content.</strong> The previous posts are: <a href="http://adndevblog.typepad.com/infrastructure/2013/02/autocad-map-3d-api-training-content-part-1.html">Part-1</a> , <a href="http://adndevblog.typepad.com/infrastructure/2013/03/autocad-map-3d-api-training-content-part-2.html">Part 2</a>, <a href="http://adndevblog.typepad.com/infrastructure/2013/03/autocad-map-3d-api-training-content-part-3.html">Part-3</a>, <a href="http://adndevblog.typepad.com/infrastructure/2013/03/autocad-map-3d-api-training-content-part-4.html">Part-4</a> and <a href="http://adndevblog.typepad.com/infrastructure/2013/05/autocad-map-3d-api-training-content-part-5.html">Part-5</a>. In this post, I will talk about the API for creating and managing Map Layers. </p>  <p>There are two basic Map 3D .NET types that will help you manage your Map and Map Layers: <strong>AcMapMap</strong> and <strong>AcMapLayer</strong>. AcMapMap represents the conceptual container that contains your Map data. Put another way, it contains all the geospatial layers representing your map data. AcMapLayer represents the geospatial layer itself:</p>  <p>&#160;</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01901c01f287970b-pi"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01901c01f290970b-pi" width="348" height="608" /></a></p>  <p><a href="http://adndevblog.typepad.com/files/Chapter%206.pdf">This presentation</a> provides more details on the AcMapMap and AcMapLayer types. It specifically talks about important methods in AcMapMap and AcMapLayer that allow instances of these types to work with each other like accessing the Map and the Layer collection within the Map, searching for and finding a specific layer. It also talks about API for programmatically selecting and highlighting specific features on a layer. <a href="http://adndevblog.typepad.com/infrastructure/MapSamples/MapsAndLayers.zip">Here</a> is a sample that demonstrates this selection API. In order to use this sample, please first build, load and run the command “BuildMap” in the SDK sample MapSDK\Map Samples\Platform\BuildMap. Once the map is created, follow the following steps:</p>  <ul>   <li>Open <strong>MapsAndLayers.sln</strong> in Visual Studio 2010 and build it. </li>    <li>Load the assembly from step above into the Map session containing the map created using the BuildMap sample. </li>    <li>Enter the command “<strong>selftrs</strong>” to select and highlight features on the “signals” layer that fall inside the rectangle defined by the extents of the raster image on the “redding” layer. </li> </ul>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Madhukar Moogala
AUTHOR EMAIL: fpdtypepadadmin@autodesk.com
TITLE: API webcast archive
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: api
CATEGORY: DevTV
CATEGORY: Stephen Preston

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/05/api.html 
DATE: 05/09/2013 03:16:29 PM
-----
BODY:
<p>By<a href="http://adndevblog.typepad.com/autocad/stephen-preston.html"> Stephen Preston</a></p>
<p>As part of our <a href="http://www.autodesk.com/adnopen" target="_blank">ADN Open</a>
 work to move our API content to more accessible 
(search-engine-findable) locations, I&#39;m posting our webcast archive to 
DevBlog. Some of these recordings are&#0160; old now, but still contain useful
 information. And, being recordings of live webcasts, they are not as 
polished as our DevTV recordings. </p>
<p>Note that some recordings are in Chinese and some in English. </p>
<p>&#0160;</p>
<table border="0" cellpadding="0" cellspacing="0" width="489">
<tbody>
<tr>
<td valign="bottom" width="366">
<p><strong>Webcast</strong></p>
</td>
<td valign="bottom" width="67">
<p><strong>Language</strong></p>
</td>
<td valign="bottom" width="56">
<p><strong>Date</strong></p>
</td>
</tr>
<tr>
<td valign="bottom" width="366">
<p><span style="text-decoration: underline;"><a href="http://download.autodesk.com/media/adn/Civil3D2013APIWebcastChinese.zip">AutoCAD
  Civil 3D API</a></span></p>
</td>
<td valign="bottom" width="67">
<p>Chinese</p>
</td>
<td valign="bottom" width="56">
<p>30-Jul-12</p>
</td>
</tr>
<tr>
<td valign="bottom" width="366">
<p><span style="text-decoration: underline;"><a href="http://download.autodesk.com/media/adn/AutoCADCivil3D2013API_17July12.zip">AutoCAD
  Civil 3D API</a></span></p>
</td>
<td valign="bottom" width="67">
<p>English</p>
</td>
<td valign="bottom" width="56">
<p>17-Jul-12</p>
</td>
</tr>
<tr>
<td valign="bottom" width="366">
<p><span style="text-decoration: underline;"><a href="http://download.autodesk.com/media/adn/AIMS2013WebCastChinese.zip">AIMS
  API</a></span></p>
</td>
<td valign="bottom" width="67">
<p>Chinese</p>
</td>
<td valign="bottom" width="56">
<p>28-May-12</p>
</td>
</tr>
<tr>
<td valign="bottom" width="366">
<p><span style="text-decoration: underline;"><a href="http://download.autodesk.com/media/adn/AutoCAD_MAP_3D_2012_Webcast_Chinese.zip">AutoCAD
  MAP 3D Geospatial API</a></span></p>
</td>
<td valign="bottom" width="67">
<p>Chinese</p>
</td>
<td valign="bottom" width="56">
<p>23-Jun-11</p>
</td>
</tr>
<tr>
<td valign="bottom" width="366">
<p><span style="text-decoration: underline;"><a href="http://download.autodesk.com/media/adn/AutoCADMap3D2012APIWebcast.zip">AutoCAD
  MAP 3D Geospatial API</a></span></p>
</td>
<td valign="bottom" width="67">
<p>English</p>
</td>
<td valign="bottom" width="56">
<p>15-Jun-11</p>
</td>
</tr>
<tr>
<td valign="bottom" width="366">
<p><span style="text-decoration: underline;"><a href="http://download.autodesk.com/media/adn/AIMS2012_Webcast_Recording_Chinese.zip">Autodesk
  MapGuide Enterprise API</a></span></p>
</td>
<td valign="bottom" width="67">
<p>Chinese</p>
</td>
<td valign="bottom" width="56">
<p>30-May-11</p>
</td>
</tr>
<tr>
<td valign="bottom" width="366">
<p><span style="text-decoration: underline;"><a href="http://download.autodesk.com/media/adn/SurfaceNET2012_Webcast.zip">AutoCAD
  Civil 3D API</a></span></p>
</td>
<td valign="bottom" width="67">
<p>English</p>
</td>
<td valign="bottom" width="56">
<p>12-May-11</p>
</td>
</tr>
<tr>
<td valign="bottom" width="366">
<p><span style="text-decoration: underline;"><a href="http://download.autodesk.com/media/adn/MGE2011Webcast.zip">Autodesk
  MapGuide Enterprise API</a></span></p>
</td>
<td valign="bottom" width="67">
<p>English</p>
</td>
<td valign="bottom" width="56">
<p>14-Jul-10</p>
</td>
</tr>
<tr>
<td valign="bottom" width="366">
<p><span style="text-decoration: underline;"><a href="http://download.autodesk.com/media/adn/AutoCAD_Civil_3D_2011_API_Webcast_Chinese_20100709.zip">AutoCAD
  Civil 3D API</a></span></p>
</td>
<td valign="bottom" width="67">
<p>Chinese</p>
</td>
<td valign="bottom" width="56">
<p>9-Jul-10</p>
</td>
</tr>
<tr>
<td valign="bottom" width="366">
<p><span style="text-decoration: underline;"><a href="http://download.autodesk.com/media/adn/AutoCADMap3D_2011_API_Webcast_23June2010.zip">AutoCAD
  MAP 3D Geospatial API</a></span></p>
</td>
<td valign="bottom" width="67">
<p>Chinese</p>
</td>
<td valign="bottom" width="56">
<p>23-Jun-10</p>
</td>
</tr>
<tr>
<td valign="bottom" width="366">
<p><span style="text-decoration: underline;"><a href="http://download.autodesk.com/media/adn/AutoCADMap3D_16June2010.zip">AutoCAD
  MAP 3D Geospatial API</a></span></p>
</td>
<td valign="bottom" width="67">
<p>English</p>
</td>
<td valign="bottom" width="56">
<p>16-Jun-10</p>
</td>
</tr>
<tr>
<td valign="bottom" width="366">
<p><span style="text-decoration: underline;"><a href="http://download.autodesk.com/media/adn/MapGuideEnterprise2011Webcast_Chinese.zip">Autodesk
  MapGuide Enterprise API</a></span></p>
</td>
<td valign="bottom" width="67">
<p>Chinese</p>
</td>
<td valign="bottom" width="56">
<p>28-May-10</p>
</td>
</tr>
<tr>
<td valign="bottom" width="366">
<p><span style="text-decoration: underline;"><a href="http://download.autodesk.com/media/adn/AutoCAD_Civil_3D_2011_New_APIs.zip">AutoCAD
  Civil 3D API</a></span></p>
</td>
<td valign="bottom" width="67">
<p>English</p>
</td>
<td valign="bottom" width="56">
<p>12-May-10</p>
</td>
</tr>
<tr>
<td valign="bottom" width="366">
<p><span style="text-decoration: underline;"><a href="http://download.autodesk.com/media/adn/AutodeskMGEAPI_11Aug09.zip">Autodesk
  MapGuide Enterprise API</a></span></p>
</td>
<td valign="bottom" width="67">
<p>English</p>
</td>
<td valign="bottom" width="56">
<p>11-Aug-09</p>
</td>
</tr>
<tr>
<td valign="bottom" width="366">
<p><span style="text-decoration: underline;"><a href="http://download.autodesk.com/media/adn/Civil3D2010APIwebcast20090623CHS.zip">AutoCAD
  Civil 3D API</a></span></p>
</td>
<td valign="bottom" width="67">
<p>Chinese</p>
</td>
<td valign="bottom" width="56">
<p>23-Jun-09</p>
</td>
</tr>
<tr>
<td valign="bottom" width="366">
<p><span style="text-decoration: underline;"><a href="http://download.autodesk.com/media/adn/AutoCAD_MAP_3D_Geospatial_API_17Jun09.zip">AutoCAD
  MAP 3D Geospatial API</a></span></p>
</td>
<td valign="bottom" width="67">
<p>English</p>
</td>
<td valign="bottom" width="56">
<p>17-Jun-09</p>
</td>
</tr>
<tr>
<td valign="bottom" width="366">
<p><span style="text-decoration: underline;"><a href="http://download.autodesk.com/media/adn/MGE2010APIWebcast.zip">Autodesk
  MapGuide Enterprise API</a></span></p>
</td>
<td valign="bottom" width="67">
<p>Chinese</p>
</td>
<td valign="bottom" width="56">
<p>9-Jun-09</p>
</td>
</tr>
<tr>
<td valign="bottom" width="366">
<p><span style="text-decoration: underline;"><a href="http://download.autodesk.com/media/adn/Civil3D2010APIWebcast_12May2009.zip">AutoCAD
  Civil 3D API</a></span></p>
</td>
<td valign="bottom" width="67">
<p>English</p>
</td>
<td valign="bottom" width="56">
<p>12-May-09</p>
</td>
</tr>
<tr>
<td valign="bottom" width="366">
<p><span style="text-decoration: underline;"><a href="http://download.autodesk.com/media/adn/DeveloperDaysOnline_Civil3D2010.zip">Developer
  Days Online: Civil 3D</a></span></p>
</td>
<td valign="bottom" width="67">
<p>English</p>
</td>
<td valign="bottom" width="56">
<p>19-Feb-09</p>
</td>
</tr>
<tr>
<td valign="bottom" width="366">
<p><span style="text-decoration: underline;"><a href="http://download.autodesk.com/media/adn/DeveloperDaysOnline_Geospatial2010.zip">Developer
  Days Online: Geospatial</a></span></p>
</td>
<td valign="bottom" width="67">
<p>English</p>
</td>
<td valign="bottom" width="56">
<p>17-Feb-09</p>
</td>
</tr>
<tr>
<td valign="bottom" width="366">
<p><span style="text-decoration: underline;"><a href="http://download.autodesk.com/media/adn/MGEIntroductiontoFusionAPI.zip">MapGuide
  Enterprise: Introduction to Fusion API</a></span></p>
</td>
<td valign="bottom" width="67">
<p>English</p>
</td>
<td valign="bottom" width="56">
<p>13-Jun-08</p>
</td>
</tr>
<tr>
<td valign="bottom" width="366">
<p><span style="text-decoration: underline;"><a href="http://download.autodesk.com/largefiles/cn/ADN_training/Map3D_WebCast_20080521.zip">AutoCAD
  MAP 3D Geospatial API</a></span></p>
</td>
<td valign="bottom" width="67">
<p>Chinese</p>
</td>
<td valign="bottom" width="56">
<p>21-May-08</p>
</td>
</tr>
<tr>
<td valign="bottom" width="366">
<p><span style="text-decoration: underline;"><a href="http://download.autodesk.com/largefiles/cn/ADN_training/MapGuide_Webcast_20080514.zip">Autodesk
  MapGuide Enterprise API</a></span></p>
</td>
<td valign="bottom" width="67">
<p>Chinese</p>
</td>
<td valign="bottom" width="56">
<p>14-May-08</p>
</td>
</tr>
<tr>
<td valign="bottom" width="366">
<p><span style="text-decoration: underline;"><a href="http://download.autodesk.com/media/adn/ACADCivil3DAPIWebcast_01May08.zip">AutoCAD
  Civil 3D API</a></span></p>
</td>
<td valign="bottom" width="67">
<p>English</p>
</td>
<td valign="bottom" width="56">
<p>1-May-08</p>
</td>
</tr>
<tr>
<td valign="bottom" width="366">
<p><span style="text-decoration: underline;"><a href="http://download.autodesk.com/media/adn/ACADMAP3DGSAPIWebcast_30Apr08.zip">AutoCAD
  MAP 3D Geospatial API</a></span></p>
</td>
<td valign="bottom" width="67">
<p>English</p>
</td>
<td valign="bottom" width="56">
<p>30-Apr-08</p>
</td>
</tr>
<tr>
<td valign="bottom" width="366">
<p><span style="text-decoration: underline;"><a href="http://download.autodesk.com/largefiles/cn/ADN_training/Civil3D_Webcast_20080423.zip">AutoCAD
  Civil 3D API</a></span></p>
</td>
<td valign="bottom" width="67">
<p>Chinese</p>
</td>
<td valign="bottom" width="56">
<p>23-Apr-08</p>
</td>
</tr>
</tbody>
</table>
<p>&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Gopinath Taget
AUTHOR EMAIL: gopinath.taget@autodesk.com
TITLE: AutoCAD Map 3D API Training content: Part-5
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: autocad-map-3d-api-training-content-part-5
CATEGORY: .NET
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: FDO
CATEGORY: Gopinath Taget

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/05/autocad-map-3d-api-training-content-part-5.html 
DATE: 05/08/2013 10:18:30 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/gopinath-taget.html">Gopinath Taget</a></p>  <p>This is in continuation of <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html">Partha</a>’s earlier posts on <strong>AutoCAD Map 3D API Training content</strong>: <a href="http://adndevblog.typepad.com/infrastructure/2013/02/autocad-map-3d-api-training-content-part-1.html">Part-1</a> , <a href="http://adndevblog.typepad.com/infrastructure/2013/03/autocad-map-3d-api-training-content-part-2.html">Part 2</a>, <a href="http://adndevblog.typepad.com/infrastructure/2013/03/autocad-map-3d-api-training-content-part-3.html">Part-3</a> and <a href="http://adndevblog.typepad.com/infrastructure/2013/03/autocad-map-3d-api-training-content-part-4.html">Part-4</a>. In this post, I will talk about the Geospatial geometry API. To start with let me state that there have been a few changes to the API organization over the years and currently, you will find all the APIs used for this post in the following assemblies:</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01901bf030c4970b-pi"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b019101e63d96970c-pi" width="389" height="411" /></a></p>  <p>&#160;</p>  <p>All the selected assemblies above can be found in the Map 3D install folder or its subfolders.</p>  <p>Now, coming back to the API, the Geometry API is organized in a simple manner. There are two basic types. <strong>MgGeometry</strong> and <strong>MgGeometryComponent</strong>. MgGeometry is inherited by <strong>MgAggregateGeometry</strong>, <strong>MgCurve</strong>, <strong>MgPoint</strong> and <strong>MgRegion</strong>. MgGeometryComponent is inherited by <strong>MgCurveSegment </strong>and <strong>MgRing</strong>. In general as the names suggests, MgGeometry types represent the geometry itself and MgGeometryComponent types constitute (are contained by) the MgGeometry types:</p>  <p>&#160;</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017eeaedd801970d-pi"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b019101e63dc3970c-pi" width="288" height="567" /></a></p>  <p>The relationship between these types is explained in more detail in <a href="http://adndevblog.typepad.com/files/Chapter%205.pdf">this presentation</a>. A few points to note when using the geometry API:</p>  <ul>   <li>You should use the utility type MgGeometryFactory to create a MgGeometry object </li>    <li>In the MgLinearRing type, the first and last coordinates in the coordinate collection should be identical </li>    <li>When connecting segment types (base type MgCurveSegment) in segment collection, the last coordinate of a curve segment should be identical to the first segment of the next segment. </li>    <li>When forming closed rings(MgLinearRing, MgCurveRing) the direction of traversal of the points in the ring indicates if it is an exterior or interior ring. The direction of traversal is counterclockwise for exterior ring and clockwise for interior rings. </li> </ul>  <p>You will find additional details for creating specific geometries in the presentation I provided above.</p>  <p>In addition to the geometry types mentioned above, there are several utility API that form a part of the geometry API. The raw geometry data can be used in three specific forms in the geometry API: </p>  <ul>   <li>The text based Autodesk Geometry Format (AGF) which is a plain text format </li>    <li>The binary based AGF format </li>    <li>Internal representations in the MgGeometry types </li> </ul>  <p>Geometry API comes with utility functions to manage the above types of data. The other utility of APIs allow you to determine the spatial relationship between geometry objects (contains, crosses, touches etc) and create new geometry with boolean operations (union, intersection, difference, symmitric difference).</p>  <p>The coordinate systems supported by the geometry API are Arbitrary X-Y, Geographic and Projected.</p>  <p>Finally, the geometry API allows you to create <a href="http://wikihelp.autodesk.com/AutoCAD_Map_3D/enu/2014/Help/0006-AutoCAD_0/0044-Geometry44/0050-Creating50">buffer geometry</a> from existing geometry.</p>  <p><a href="http://adndevblog.typepad.com/infrastructure/MapSamples/Geometry.zip">Here</a> is a sample that demonstrates the usage of most of the API mentioned in this post. It implements two commands CRGEOM and CRBUFFER. CRGEOM demonstrates creation of geometry and CRBUFFER demonstrates creation of buffer geometry. In order to use the sample, do the following:</p>  <ul>   <li>Open Geometry.sln in Visual Studio 2010 and build the project. </li>    <li>Delete the SDF if it exists NewFile.sdf (if you have used this sample before) </li>    <li>Launch Map 3D and open a new drawing </li>    <li>Load the .NET assembly created in step #1 </li>    <li>Assign the a coordinate system to the new drawing </li>    <li>Draw one or more polyline entities in the drawing </li>    <li>Enter the command “crgeom” and select a polyline entity. A line string feature is created from it on the API_Poly_Objects layer and inserted into NewFile.sdf in the .\Data\SDF folder. If this file doesn’t exist, it is created. </li>    <li>Select a feature on the API_Poly_Objects layer and enter the command “crbuffer”. A buffer polygon is created round the feature. The buffer is created on the “Buffer_Objects” layer and inserted into Buffer.sdf in the.\Data\SDF folder </li> </ul>  <p><b>Note:</b> If you will be revisiting this exercise later, deleting NewFile.sdf and Buffer.sdf before starting would make things easier for you. This is to ensure that both SDFs are created fresh using the <u>same coordinate system</u>, otherwise buffer creation would fail. Also, the Path to the SDF folders are hard coded in the sample so please modify this path to a folder convenient to you before using the sample.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Snoop Civil 3D 2014 Database (.bundle format)
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: snoop-civil-3d-2014-database-bundle-format

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/05/snoop-civil-3d-2014-database-bundle-format.html 
DATE: 05/06/2013 06:32:54 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>
<p>Following some suggestions on my <a href="http://adndevblog.typepad.com/infrastructure/2013/04/snoop-civil-3d-2014-database.html">previous post</a>, here is a new version of the Snoop Civil 3D Database that is packed with the <a href="http://download.autodesk.com/media/adn/DevTV_Autoloader_Format_Explained/DevTV_Autoloader_Format_Explained.html">.bundle</a> format. Just extract it under <em><span style="text-decoration: underline;">C:\Users\&lt;your login&gt;\AppData\Roaming\Autodesk\ApplicationPlugins</span></em> folder and it will autoload on Civil 3D 2012, 2013 and 2014.</p>
<p>
<span class="asset  asset-generic at-xid-6a0167607c2431970b01901bdf4051970b"><a href="http://adndevblog.typepad.com/files/civil3dsnoopdb.bundle.zip">Download</a></span> the tool with source code.</p>
<p><strong><span style="text-decoration: underline;">Note</span></strong>: if you extract under <em><span style="text-decoration: underline;">C:\ProgramData\Autodesk\ApplicationPlugins</span></em> it will not load on 2012 version.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Creating Featureline using COM API IAeccLandFeatureLines:: AddFromPolyline()
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: creating-featureline-using-com-api-iaecclandfeaturelines-addfrompolyline
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2011
CATEGORY: AutoCAD Civil 3D 2012
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: AutoCAD Civil 3D 2014
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/04/creating-featureline-using-com-api-iaecclandfeaturelines-addfrompolyline.html 
DATE: 04/30/2013 12:00:11 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>Civil 3D .NET
API is yet to get the necessary functions to add / create featureline object. We
have a wish list logged for the same. Till we get the .NET API, let&#39;s see how
to use the existing COM API <strong>IAeccLandFeatureLines:: AddFromPolyline()</strong> in .NET
application using Interop.</p>
<p>&#0160;</p>
<p>Following
VB.NET code snippet demonstrates creation of a Featureline in AutoCAD Civil 3D
using COM API <strong>IAeccLandFeatureLines:: AddFromPolyline()</strong> -</p>
<p>&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">Using</span><span style="line-height: 140%;"> trans </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Transaction</span><span style="line-height: 140%;"> = </span><span style="color: #2b91af; line-height: 140%;">HostApplicationServices</span><span style="line-height: 140%;">.WorkingDatabase.TransactionManager.StartTransaction()</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">Try</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">If</span><span style="line-height: 140%;"> oAcadApp </span><span style="color: blue; line-height: 140%;">Is</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Nothing</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Then</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; oAcadApp = GetObject(, </span><span style="color: #a31515; line-height: 140%;">&quot;AutoCAD.Application&quot;</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">If</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">Catch</span><span style="line-height: 140%;"> ex </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Exception</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; ed.WriteMessage(ex.Message)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Try</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">Try</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; oAeccApp = oAcadApp.GetInterfaceObject(</span><span style="color: #a31515; line-height: 140%;">&quot;AeccXUiLand.AeccApplication.10.0&quot;</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; oAeccDoc = oAeccApp.ActiveDocument</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; oAeccDB = oAeccApp.ActiveDocument.Database</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">&#39; Select the 3D Polyline which you want to convert to Feature Line</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> promptEntOp </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">New</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">PromptEntityOptions</span><span style="line-height: 140%;">(vbCrLf + </span><span style="color: #a31515; line-height: 140%;">&quot;Select a 3D Polyline : &quot;</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> promptEntRs </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">PromptEntityResult</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; promptEntRs = ed.GetEntity(promptEntOp)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">If</span><span style="line-height: 140%;"> promptEntRs.Status &lt;&gt; </span><span style="color: #2b91af; line-height: 140%;">PromptStatus</span><span style="line-height: 140%;">.OK </span><span style="color: blue; line-height: 140%;">Then</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;Exiting! Try Again !&quot;</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Exit Sub</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">If</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> idEnt </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; idEnt = promptEntRs.ObjectId</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> oFtrLn </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">AeccLandFeatureLine</span><span style="line-height: 140%;"> = </span><span style="color: blue; line-height: 140%;">Nothing</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> oFtrLns </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">AeccLandFeatureLines</span><span style="line-height: 140%;"> = oAeccDoc.Sites.Item(0).FeatureLines</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> plineObjId </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Long</span><span style="line-height: 140%;"> = idEnt.OldIdPtr</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; oFtrLn = oFtrLns.AddFromPolyline(plineObjId, oAeccDB.FeatureLineStyles.Item(0))</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; trans.Commit()</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">Catch</span><span style="line-height: 140%;"> ex </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Exception</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;Error : &quot;</span><span style="line-height: 140%;">, ex.Message &amp; vbCrLf)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Try</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Using</span></p>
</div>
<p>&#0160;</p>
<p>Once you
build your application using above code snippet and run it in Civil 3D , you
would see a Featureline being created -</p>
<p>&#0160;
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01901bb43d4b970b-pi" style="display: inline;"><img alt="Add_featureline_COM" class="asset  asset-image at-xid-6a0167607c2431970b01901bb43d4b970b" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01901bb43d4b970b-500wi" title="Add_featureline_COM" /></a></p>
<p>&#0160;</p>
<p>Hope this is
useful to you!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Creating a Civil 3D Corridor object using .NET API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: creating-a-civil-3d-corridor-object-using-net-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2014
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/04/creating-a-civil-3d-corridor-object-using-net-api.html 
DATE: 04/25/2013 03:21:10 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>Civil 3D 2014 <a href="http://docs.autodesk.com/CIV3D/2014/ENU/API_Reference_Guide/index.html">.NET
API</a> has an overloaded <strong>Add()</strong> method in <strong>CorridorCollection</strong> class. In this
post let’s see how to build a Corridor using the <strong>CorridorCollection.Add</strong>(string
corridorName,</p>
<p>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; string
baselineName,</p>
<p>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ObjectId
alignmentId,</p>
<p>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ObjectId
profileId,</p>
<p>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; string
baselineRegionName,</p>
<p>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ObjectId
assemblyId &#0160;)</p>
<p>&#0160;</p>
<p>If you want to target the Existing ground surface in the
Target Mapping as shown in the screenshot below, then you need to do a trick :) . Thanks to my colleague (<strong>Paul Chen</strong>)
from engineering team for an important hint to achieve this. You need to find out <strong><em>TargetType</em></strong> for each of the <strong>SubassemblyTargetInfo
</strong>object and then set the&#0160;<strong>TargetIds</strong> to SurfaceIds as shown in the code
snippet below -</p>
<p>&#0160;
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01901b910f24970b-pi" style="display: inline;"><img alt="Corridor_Target_Mapping" class="asset  asset-image at-xid-6a0167607c2431970b01901b910f24970b" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01901b910f24970b-500wi" title="Corridor_Target_Mapping" /></a></p>
<p>&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Get the first alignment of this drawing</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> alignmentId = civilDoc.GetAlignmentIds()[0];</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">Alignment</span><span style="line-height: 140%;"> alignment = trans.GetObject(alignmentId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForRead) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Alignment</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Get the first profile of this alignment</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> profileId = alignment.GetProfileIds()[0];</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Get the first Assembly in the DWG</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> assemblyId = civilDoc.AssemblyCollection[0];</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Create a new Corridor</span></p>
<p style="margin: 0px;"><strong><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> newCorridorId = civilDoc.CorridorCollection.Add(</span><span style="color: #a31515; line-height: 140%;">&quot;Proposed Corridor&quot;</span><span style="line-height: 140%;">, </span><span style="color: #a31515; line-height: 140%;">&quot;Proposed Baseline&quot;</span><span style="line-height: 140%;">, alignmentId, profileId, </span><span style="color: #a31515; line-height: 140%;">&quot;Proposed BaselineRegion&quot;</span><span style="line-height: 140%;">, assemblyId);</span></strong></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">Corridor</span><span style="line-height: 140%;"> corridor = trans.GetObject(newCorridorId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForWrite) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Corridor</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Set the Target to existing surface</span></p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// GetTargets() Gets the targets information. </span></p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// The returned object can be modified and passed to SetTargets() </span></p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// to update a corridor&#39;s subassembly targets information.</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">SubassemblyTargetInfoCollection</span><span style="line-height: 140%;"> subtargetinfocoll = corridor.GetTargets();</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">for</span><span style="line-height: 140%;"> (</span><span style="color: blue; line-height: 140%;">int</span><span style="line-height: 140%;"> i = 0; i &lt; subtargetinfocoll.Count; i++)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{&#0160; &#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">SubassemblyTargetInfo</span><span style="line-height: 140%;"> subassemblytargetinfo = subtargetinfocoll[i];</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (subassemblytargetinfo.TargetType == </span><span style="color: #2b91af; line-height: 140%;">SubassemblyLogicalNameType</span><span style="line-height: 140%;">.Surface)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; subassemblytargetinfo.TargetIds = civilDoc.GetSurfaceIds();&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; }&#0160; &#0160; &#0160;&#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// update the target information</span></p>
<p style="margin: 0px;"><strong><span style="line-height: 140%;">corridor.SetTargets(subtargetinfocoll);</span></strong></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// now rebuild the corridor</span></p>
<p style="margin: 0px;"><strong><span style="line-height: 140%;">corridor.Rebuild();</span></strong></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">trans.Commit();</span></p>
</div>
<p>&#0160;</p>
<p>I used one of the Civil 3D Tutorials DWG file which has prerequisite
objects built in it to create the corridor using above code snippet. Hope this is useful to you !</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Adding / Removing BaselineRegion using .NET API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: adding-removing-baselineregion-using-net-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2014
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/04/adding-removing-baselineregion-using-net-api.html 
DATE: 04/23/2013 09:31:59 AM
-----
BODY:
<p><strong>BaselineRegion
</strong>class in Civil 3D represents a segment of a baseline, specified by alignment
stations for the start and end point. In a corridor, each baseline region uses
a single assembly type. </p>
<p>In AutoCAD
Civil 3D using UI tools we can add / remove BaselineRegion –</p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017eea815057970d-pi" style="display: inline;"><img alt="BaselineRegion01" class="asset  asset-image at-xid-6a0167607c2431970b017eea815057970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017eea815057970d-500wi" title="BaselineRegion01" /></a></p>
<p>&#0160;</p>
<p>New API
functions are exposed in this release to add, remove or access a <strong>BaselineRegion
</strong>in the class <strong>BaselineRegionCollection</strong>.</p>
<p>Here is a C#
.NET code snippet which shows how to add and remove BaselineRegion –</p>
<p>&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// BaselineRegionCollection.Add(string regionName, string assemblyName, double startStation, double endStation ) </span></p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Adds a region at the specified start and end station with the given name and assembly. </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Get the BaselineRegionCollection</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">BaselineRegionCollection</span><span style="line-height: 140%;"> baselineRegionColl = corridor.Baselines[0].BaselineRegions;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Add a new BaselineRegion</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">BaselineRegion</span><span style="line-height: 140%;"> baselineregion = baselineRegionColl.Add(</span><span style="color: #a31515; line-height: 140%;">&quot;My Added Region&quot;</span><span style="line-height: 140%;">, </span><span style="color: #a31515; line-height: 140%;">&quot;Assembly - (1)&quot;</span><span style="line-height: 140%;">, 506.00, 1110.00);&#0160; </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Remove a BaselineRegion with a given Name&#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">baselineRegionColl.Remove(</span><span style="color: #a31515; line-height: 140%;">&quot;Corridor Region (2)&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">//rebuild the corridor</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">corridor.Rebuild();</span></p>
</div>
<p>Once added
the newly created BaselineRegion will be shown under the Baseline -</p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017eea8151a5970d-pi" style="display: inline;"><img alt="BaselineRegion03" class="asset  asset-image at-xid-6a0167607c2431970b017eea8151a5970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017eea8151a5970d-500wi" title="BaselineRegion03" /></a><br /><br /></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Veli V.
EMAIL: veli.vaisanen@basepoint.fi
IP: 212.116.37.26
URL: 
DATE: 04/24/2013 01:14:43 AM
Hi,
I like to know how we can create whole corridor from scratch with .NET?
-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 203.202.234.243
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 04/24/2013 01:32:56 AM
Hi Veli,

In Civil 3D 2014, Corridor and related features are exposed in .NET API. We can create a corridor. Check this post - 

<a href="http://adndevblog.typepad.com/infrastructure/2013/03/create-a-corridor-with-civil3d-2014-api.html">http://adndevblog.typepad.com/infrastructure/2013/03/create-a-corridor-with-civil3d-2014-api.html</a>

I would post some more relevant sample codes in the coming days, so keep watching this space.

Thanks,
Partha
ADN
-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 59.92.172.110
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 04/25/2013 03:52:13 AM
Hi Veli,

I just posted this on Corridor creation - 

<a href="http://adndevblog.typepad.com/infrastructure/2013/04/creating-a-civil-3d-corridor-object-using-net-api.html">http://adndevblog.typepad.com/infrastructure/2013/04/creating-a-civil-3d-corridor-object-using-net-api.html</a>

Hope this helps !
Cheers,
Partha
-----
COMMENT:
AUTHOR: Veli V.
EMAIL: veli.vaisanen@basepoint.fi
IP: 212.116.37.26
URL: 
DATE: 04/25/2013 05:10:39 AM
Thank you. It help us to create corridor with .NET. We have used before COM API.
-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Adding / Removing Baseline using .NET API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: adding-removing-baseline-using-net-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2014
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/04/adding-removing-baseline-using-net-api.html 
DATE: 04/22/2013 10:07:59 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>AutoCAD Civil
3D UI tools allows us to add or remove Baseline in a Corridor object as shown
in the screenshot below -</p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017d4305dc0a970c-pi" style="display: inline;"><img alt="C3D_BaseLineAddRemove01" class="asset  asset-image at-xid-6a0167607c2431970b017d4305dc0a970c" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017d4305dc0a970c-500wi" title="C3D_BaseLineAddRemove01" /></a><br /><br /></p>
<p>&#0160;</p>
<p>In Civil 3D
2014 .NET API, BaselineCollection class has new functionality to add and remove
Baseline object as shown in the screenshot below and the relevant C# code
snippets -</p>
<p>&#0160;
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017d4305dd2c970c-pi" style="display: inline;"><img alt="C3D_BaseLineAddRemove02" class="asset  asset-image at-xid-6a0167607c2431970b017d4305dd2c970c" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017d4305dd2c970c-500wi" title="C3D_BaseLineAddRemove02" /></a></p>
<p>&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// BaselineCollection.Add() </span></p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Adds a baseline with the given baseline name, alignment Id and profile Id.</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Get the first alignment of this drawing</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> alignmentId = civilDoc.GetAlignmentIds()[0];</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">Alignment</span><span style="line-height: 140%;"> alignment = trans.GetObject(alignmentId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForRead) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Alignment</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Get the first profile of this alignment</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> profileId = alignment.GetProfileIds()[0];</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Add the baseline</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">Baseline</span><span style="line-height: 140%;"> baseline = corridor.Baselines.Add(</span><span style="color: #a31515; line-height: 140%;">&quot;My Added BaseLine&quot;</span><span style="line-height: 140%;">, alignmentId, profileId);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Remove baseline with a given Name&#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">corridor.Baselines.Remove(</span><span style="color: #a31515; line-height: 140%;">&quot;Baseline (1)&quot;</span><span style="line-height: 140%;">);</span></p>
</div>
<p>&#0160;</p>
<p>Hope this is
useful to you !</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: AUTOCAD CIVIL 3D 2014 Developer Documents
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: autocad-civil-3d-2014-developer-documents
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2014
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/04/autocad-civil-3d-2014-developer-documents.html 
DATE: 04/17/2013 01:30:00 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>This is
further to my <a href="http://adndevblog.typepad.com/infrastructure/2013/03/whats-new-in-autocad-civil-3d-2014-api.html">earlier
post</a> on what&#39;s new in API. 2014 version
of &quot;API Developer&#39;s Guide&quot; and &quot;API Reference Guide&quot; is now
available <a href="http://wikihelp.autodesk.com/AutoCAD_Civil_3D/enu/2014/Help/API_Developer&#39;s_Guide/0001-About_th1/0005-New_Feat5">online</a>.&#0160;</p>
<p>AUTOCAD CIVIL
3D 2014 <a href="http://wikihelp.autodesk.com/AutoCAD_Civil_3D/enu/2014/Help/API_Developer&#39;s_Guide/0001-About_th1/0005-New_Feat5">API
Developer&#39;s Guide</a>&#0160;</p>
<p>AUTOCAD CIVIL
3D 2014 <a href="http://docs.autodesk.com/CIV3D/2014/ENU/API_Reference_Guide/index.html">API
Reference Guide</a></p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017eea514a45970d-pi" style="display: inline;"><img alt="C3D2014_Api_Ref" class="asset  asset-image at-xid-6a0167607c2431970b017eea514a45970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017eea514a45970d-500wi" title="C3D2014_Api_Ref" /></a></p>
<p><br /><br /></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Savoy
EMAIL: Nigel.Peters@savoycomputing.com
IP: 81.174.229.137
URL: 
DATE: 05/28/2013 06:14:22 AM
Partha, the API reference does not work in IE10!

But good to see these are now live!
-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Get CogoPoint label text
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: get-cogopoint-label-text
CATEGORY: .NET
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D 2013

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/04/get-cogopoint-label-text.html 
DATE: 04/16/2013 07:04:36 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>The <strong>CogoPoint</strong> object on Civil 3D can hold labels with more information than the regular Description, which contains only part of the information (and sometimes not the same showed on the point).</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017eea4c20f9970d-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="point_description" border="0" alt="point_description" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017eea4c2114970d-pi" width="443" height="213" /></a></p>  <p>One alternative could be the <em>CogoPoint.GetLabelTextComponentOverride</em> method, passing the IDs obtained from. <u>Unfortunately this will output the format of the text</u>, as shown on the Text Component Editor, <u>not the actual value</u>. </p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017eea4c211f970d-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="point_label_component" border="0" alt="point_label_component" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017c38a8da16970b-pi" width="449" height="243" /></a></p>  <p>So one workaround, although not very elegant, can be explode the CogoPoint in memory, then explode again and again all the containing BlockReference and MText objects, to end up with DBText, which is the information we seek. The following code show the idea.</p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px">[<span style="color: #2b91af">CommandMethod</span>(<span style="color: #a31515">&quot;getPointText&quot;</span>)]</p>    <p style="margin: 0px"><span style="color: blue">public</span> <span style="color: blue">void</span> CmdGetPointText()</p>    <p style="margin: 0px">{</p>    <p style="margin: 0px">&#160; <span style="color: #2b91af">Editor</span> ed = <span style="color: #2b91af">Application</span>.DocumentManager.MdiActiveDocument.Editor;</p>    <p style="margin: 0px">&#160; <span style="color: #2b91af">PromptEntityResult</span> resPoint = ed.GetEntity(<span style="color: #a31515">&quot;Select point: &quot;</span>);</p>    <p style="margin: 0px">&#160; <span style="color: blue">if</span> (resPoint.Status != <span style="color: #2b91af">PromptStatus</span>.OK) <span style="color: blue">return</span>;</p>    <p style="margin: 0px">&#160; ed.WriteMessage(GetText(resPoint.ObjectId));</p>    <p style="margin: 0px">}</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">private</span> <span style="color: blue">string</span> GetText(<span style="color: #2b91af">ObjectId</span> id)</p>    <p style="margin: 0px">{</p>    <p style="margin: 0px">&#160; <span style="color: green">// store the DBTexts</span></p>    <p style="margin: 0px">&#160; <span style="color: #2b91af">StringBuilder</span> entityText = <span style="color: blue">new</span> <span style="color: #2b91af">StringBuilder</span>();</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: #2b91af">Database</span> db = <span style="color: #2b91af">Application</span>.DocumentManager.</p>    <p style="margin: 0px">&#160;&#160;&#160; MdiActiveDocument.Database;</p>    <p style="margin: 0px">&#160; <span style="color: blue">using</span> (<span style="color: #2b91af">Transaction</span> trans = db.</p>    <p style="margin: 0px">&#160;&#160;&#160; TransactionManager.StartTransaction())</p>    <p style="margin: 0px">&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">// open the entity</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #2b91af">Entity</span> point = trans.GetObject(id, </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">OpenMode</span>.ForRead) <span style="color: blue">as</span> <span style="color: #2b91af">Entity</span>;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">// do a full explode (considering explode again</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">// all BlockReferences and MText)</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #2b91af">List</span>&lt;<span style="color: #2b91af">DBObject</span>&gt; objs = FullExplode(point);</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">foreach</span> (<span style="color: #2b91af">Entity</span> ent <span style="color: blue">in</span> objs)</p>    <p style="margin: 0px">&#160;&#160;&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">// now get the text of each DBText</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> (ent.GetType() == <span style="color: blue">typeof</span>(<span style="color: #2b91af">DBText</span>))</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">DBText</span> text = ent <span style="color: blue">as</span> <span style="color: #2b91af">DBText</span>;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; entityText.AppendLine(text.TextString);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; }</p>    <p style="margin: 0px">&#160;&#160;&#160; }</p>    <p style="margin: 0px">&#160;&#160;&#160; trans.Commit();</p>    <p style="margin: 0px">&#160; }</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: blue">return</span> entityText.ToString();</p>    <p style="margin: 0px">}</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">private</span> <span style="color: #2b91af">List</span>&lt;<span style="color: #2b91af">DBObject</span>&gt; FullExplode(<span style="color: #2b91af">Entity</span> ent)</p>    <p style="margin: 0px">{</p>    <p style="margin: 0px">&#160; <span style="color: green">// final result</span></p>    <p style="margin: 0px">&#160; <span style="color: #2b91af">List</span>&lt;<span style="color: #2b91af">DBObject</span>&gt; fullList = <span style="color: blue">new</span> <span style="color: #2b91af">List</span>&lt;<span style="color: #2b91af">DBObject</span>&gt;();</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: green">// explode the entity</span></p>    <p style="margin: 0px">&#160; <span style="color: #2b91af">DBObjectCollection</span> explodedObjects = <span style="color: blue">new</span> <span style="color: #2b91af">DBObjectCollection</span>();</p>    <p style="margin: 0px">&#160; ent.Explode(explodedObjects);</p>    <p style="margin: 0px">&#160; <span style="color: blue">foreach</span> (<span style="color: #2b91af">Entity</span> explodedObj <span style="color: blue">in</span> explodedObjects)</p>    <p style="margin: 0px">&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">// if the exploded entity is a blockref or mtext</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">// then explode again</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">if</span> (explodedObj.GetType() == <span style="color: blue">typeof</span>(<span style="color: #2b91af">BlockReference</span>) ||</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; explodedObj.GetType() == <span style="color: blue">typeof</span>(<span style="color: #2b91af">MText</span>))</p>    <p style="margin: 0px">&#160;&#160;&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; fullList.AddRange(FullExplode(explodedObj));</p>    <p style="margin: 0px">&#160;&#160;&#160; }</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">else</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; fullList.Add(explodedObj);</p>    <p style="margin: 0px">&#160; }</p>    <p style="margin: 0px">&#160; <span style="color: blue">return</span> fullList;</p>    <p style="margin: 0px">}</p> </div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: BlackBox
EMAIL: 
IP: 173.171.0.201
URL: http://profile.typepad.com/6p017d4259d7c8970c
DATE: 05/04/2013 09:32:47 AM
Hi Augusto,

Only commenting on the conceptual aspect of this, would it not instead be simpler for the API Author to include a GetDisplayedTextString() Method?

Think similar to extracting the TextString Property of a Text entity which includes a Field reference... The evaluated result is returned, and not the FieldCode.

This Method (and it's overload(s)) would need to account for multiple components given the myriad ways a Point Label Style can be configured, of course, so it stands to reason that perhaps returning a List<string>, etc. would be required, and only apply to the COGO Point's current Style(s).

Again, just a quick, upper level thought... Obviously there would be a need to dig further to ensure no deal breakers were the API Author to consider the suggestion.

Cheers
-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 177.84.160.213
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 05/06/2013 05:51:48 AM
Hi, 

Thanks, sure that make sense and we're investigating it... the approach suggested here is a workaround if you need this feature right now.

Regards,
Augusto Goncalves
-----
COMMENT:
AUTHOR: Дмитрий Загорулькин
EMAIL: 
IP: 92.100.236.7
URL: http://profile.typepad.com/6p01bb07a2f342970d
DATE: 10/20/2016 12:46:52 PM
Maybe need call Dispose() for new objects after Explode()?
-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 189.103.218.153
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 10/21/2016 04:47:32 AM
That's a good point: indeed you should call .Dispose() if the Entity is not appended to the database. Thanks for pointing that out.
-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Where is the document for Autodesk Infrastructure Map Server 2014?
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: where-is-the-document-for-autodesk-infrastructure-map-server-2014

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/04/where-is-the-document-for-autodesk-infrastructure-map-server-2014.html 
DATE: 04/14/2013 11:50:21 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>Autodesk Infrastructure Map Server 2014 has been released, please refer to the <a href="http://www.autodesk.com/products/autodesk-infrastructure-map-server/overview">product page</a> to get an feature over view and get a <a href="http://www.autodesk.com/products/autodesk-infrastructure-map-server/free-trial">free trial</a>. So where is the document of AIMS 2014, like API reference and developer guide? In AIMS 2014, the documents are not on WikiHelp site like <a href="http://wikihelp.autodesk.com/Infr._Map_Server/enu/2013/Help">2013</a> and <a href="http://wikihelp.autodesk.com/Infr._Map_Server/enu/2012">2012</a>.&#160; They are published as HTML at <a title="http://docs.autodesk.com/AIMS/2014/ENU/index.html" href="http://docs.autodesk.com/AIMS/2014/ENU/index.html">http://docs.autodesk.com/AIMS/2014/ENU/index.html</a> , it includes the user’s guide, developer’s guide and some other documents. </p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017c389d1259970b-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017eea406308970d-pi" width="436" height="286" /></a></p>  <p>&#160;</p>  <p>As to the WebExtension API Reference, Ajax Viewer Reference, and Infrastructure Studio API Reference, they are available at AIMS <a href="http://usa.autodesk.com/adsk/servlet/index?siteID=123112&amp;id=13278101">Service and Support page</a>.&#160; Please go there or download it with the link below:</p>  <p><img align="absMiddle" src="https://images.autodesk.com/adsk/s127/images/files/zip.gif" width="16" height="16" /> <a href="http://images.autodesk.com/adsk/files/autodesk_infrastructure_map_server_2014_api_references.zip">Autodesk Infrastructure Map Server 2014 API References</a> <i>(zip - 22.8 Mb)</i></p>  <p><a href="http://docs.autodesk.com/AIMS/2014/ENU/index.html">Autodesk Infrastructure Map Server 2014 Online Help</a></p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017c389d128d970b-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017c389d129e970b-pi" width="427" height="52" /></a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Autodesk Infrastructure Map Server(AIMS) API Training content : Part-8
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: autodesk-infrastructure-map-serveraims-api-training-content-part-8
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: AIMS 2014
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/04/autodesk-infrastructure-map-serveraims-api-training-content-part-8.html 
DATE: 04/11/2013 07:38:20 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>
<p>We talked about Ajax Viewer, Fusion Viewer, actually Mobile Viewer is another important viewer, especially for those who want to view map data on mobile devices. The Mobile Viewer framework is a set of JavaScript classes, CSS files, images and icons designed to provide a compelling and intuitive interface for displaying Autodesk Infrastructure Map Server 2014 spatial content on the Apple iPhone, iPad, and iPod Touch. The OpenLayers mapping framework is used to handle many aspects of the map display and management. Several of the PHP scripts used by the Fusion framework are used unmodified in order to interact with the Infrastructure Map Server Web Tier API to perform such functions as session creation, map initialization, selection, and determination of feature properties. You do not need to download/install anything on your devices.&#0160; </p>
<p>In this chapter, we introduce Mobile Viewer itself and its API, we also talk about how to create a custom controls to extend the mobile viewer and how to debug, build and deploy it.&#0160; Please find the attached PPT and code samples, and <a href="http://docs.autodesk.com/AIMS/2014/ENU/files/GUID-5F5F2933-9E65-4B87-A5F1-2D0241DAB2F2.htm">Mobile Viewer Reference Guide</a> section of the AIMS <a href="http://docs.autodesk.com/AIMS/2014/ENU/index.html">documents</a> </p>
<p>
<span class="asset  asset-generic at-xid-6a0167607c2431970b017c388b615f970b"><a href="http://adndevblog.typepad.com/files/creating-a-custom-control-for-mobile-viewer.zip">Download Creating a Custom Control for Mobile Viewer</a></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt;"><span lang="EN-US" style="text-align: center;"><span style="font-family: Calibri;"><span style="font-size: 15pt; color: #000000;">How to setup and run Mobile Viewer Sample.</span></span></span></p>
<p class="MsoNormal" style="text-justify: inter-ideograph; line-height: normal; margin: 0cm 0cm 0pt;"><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify;"><span style="font-family: Calibri;"><span style="font-size: 10.5pt; color: #000000;">Please note that the samples just demo how to create custom control, they are not fully tested, and you need to do more work to use them in your project.</span></span></span></p>
<p class="MsoNormal" style="text-justify: inter-ideograph; line-height: normal; margin: 0cm 0cm 0pt;"><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify;"><span style="font-family: Calibri;"><span style="font-size: 10.5pt; color: #000000;">&#0160;</span></span></span></p>
<p class="MsoListParagraph" style="text-justify: inter-ideograph; line-height: normal; text-indent: -18pt; margin: 0cm 0cm 0pt 18pt; mso-char-indent-count: 0; mso-list: l0 level1 lfo1;"><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify; mso-fareast-font-family: calibri; mso-fareast-theme-font: minor-latin; mso-bidi-font-family: calibri; mso-bidi-theme-font: minor-latin;"><span style="text-justify: inter-ideograph; text-align: justify; mso-list: ignore;"><span style="color: #000000;"><span style="font-family: Calibri;"><span style="font-size: 10.5pt;">1.</span></span><span style="text-justify: inter-ideograph; text-align: justify; line-height: normal;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 7pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span></span></span><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify;"><span style="color: #000000; font-family: Calibri;"><span style="font-size: 10.5pt;">Install Apache Ant(</span></span><span style="font-size: 10.5pt;"><a href="http://ant.apache.org/" style="text-justify: inter-ideograph; text-align: justify;"><span style="color: #0000ff; font-family: Calibri;">http://ant.apache.org</span></a></span><span style="font-family: Calibri;"><span style="font-size: 10.5pt; color: #000000;">), and add to PATH environment variable.</span></span></span></p>
<p class="MsoListParagraph" style="text-justify: inter-ideograph; line-height: normal; text-indent: -18pt; margin: 0cm 0cm 0pt 18pt; mso-char-indent-count: 0; mso-list: l0 level1 lfo1;"><span style="color: #000000;"><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify; mso-fareast-font-family: calibri; mso-fareast-theme-font: minor-latin; mso-bidi-font-family: calibri; mso-bidi-theme-font: minor-latin;"><span style="text-justify: inter-ideograph; text-align: justify; mso-list: ignore;"><span style="font-family: Calibri;"><span style="font-size: 10.5pt;">2.</span></span><span style="text-justify: inter-ideograph; text-align: justify; line-height: normal;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 7pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span></span><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify;"><span style="font-family: Calibri;"><span style="font-size: 10.5pt;">Copy C:\Program Files\Autodesk\Autodesk Infrastructure Web Server Extension 2013\www\MobileViewer To C:\MobileViewer_Dev</span></span></span></span></p>
<p class="MsoListParagraph" style="text-justify: inter-ideograph; line-height: normal; text-indent: -18pt; margin: 0cm 0cm 0pt 18pt; mso-char-indent-count: 0; mso-list: l0 level1 lfo1;"><span style="color: #000000;"><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify; mso-fareast-font-family: calibri; mso-fareast-theme-font: minor-latin; mso-bidi-font-family: calibri; mso-bidi-theme-font: minor-latin;"><span style="text-justify: inter-ideograph; text-align: justify; mso-list: ignore;"><span style="font-family: Calibri;"><span style="font-size: 10.5pt;">3.</span></span><span style="text-justify: inter-ideograph; text-align: justify; line-height: normal;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 7pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span></span><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify;"><span style="font-family: Calibri;"><span style="font-size: 10.5pt;">Unpack MobileViewer2013.zip to<span style="text-justify: inter-ideograph; text-align: justify; mso-spacerun: yes;">&#0160; </span></span></span><span style="font-size: 10.5pt;"><a name="OLE_LINK2" style="text-justify: inter-ideograph; text-align: justify;"></a><a name="OLE_LINK1" style="text-justify: inter-ideograph; text-align: justify;"><span style="text-justify: inter-ideograph; text-align: justify; mso-bookmark: ole_link2;"><span style="text-decoration: initial; font-family: Calibri;">C:\MobileViewer_Dev</span></span></a></span><span style="font-family: Calibri;"><span style="font-size: 10.5pt;"> and merge the contents. Here is the folder structure after merging : </span></span></span></span></p>
<p class="MsoNormal" style="text-justify: inter-ideograph; line-height: normal; margin: 0cm 0cm 0pt;"><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify; mso-no-proof: yes;"><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017c388b5835970b-pi"><img alt="clip_image002" border="0" height="324" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017eea2ea1e5970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="clip_image002" width="447" /></a></span></p>
<p class="MsoListParagraph" style="text-justify: inter-ideograph; line-height: normal; text-indent: -18pt; margin: 0cm 0cm 0pt 18pt; mso-char-indent-count: 0; mso-list: l0 level1 lfo1;"><span style="color: #000000;"><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify; mso-fareast-font-family: calibri; mso-fareast-theme-font: minor-latin; mso-bidi-font-family: calibri; mso-bidi-theme-font: minor-latin;"><span style="text-justify: inter-ideograph; text-align: justify; mso-list: ignore;"><span style="font-family: Calibri;"><span style="font-size: 10.5pt;">4.</span></span><span style="text-justify: inter-ideograph; text-align: justify; line-height: normal;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 7pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span></span><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify;"><span style="font-family: Calibri;"><span style="font-size: 10.5pt;">Setup the server side logic. </span></span></span></span></p>
<p class="MsoListParagraph" style="text-justify: inter-ideograph; line-height: normal; text-indent: -21pt; margin: 0cm 0cm 0pt 42pt; mso-char-indent-count: 0; mso-list: l0 level2 lfo1;"><span style="color: #000000;"><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify; mso-fareast-font-family: calibri; mso-fareast-theme-font: minor-latin; mso-bidi-font-family: calibri; mso-bidi-theme-font: minor-latin;"><span style="text-justify: inter-ideograph; text-align: justify; mso-list: ignore;"><span style="font-family: Calibri;"><span style="font-size: 10.5pt;">a)</span></span><span style="text-justify: inter-ideograph; text-align: justify; line-height: normal;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 7pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span></span><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify;"><span style="font-family: Calibri;"><span style="font-size: 10.5pt;">Copy sample\ListSelectionAppDotnet to C:\Program Files\Autodesk\Autodesk Infrastructure Web Server Extension 2013\www\MobileViewer</span></span></span></span></p>
<p class="MsoListParagraph" style="text-justify: inter-ideograph; line-height: normal; text-indent: -21pt; margin: 0cm 0cm 0pt 42pt; mso-char-indent-count: 0; mso-list: l0 level2 lfo1;"><span style="color: #000000;"><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify; mso-fareast-font-family: calibri; mso-fareast-theme-font: minor-latin; mso-bidi-font-family: calibri; mso-bidi-theme-font: minor-latin;"><span style="text-justify: inter-ideograph; text-align: justify; mso-list: ignore;"><span style="font-family: Calibri;"><span style="font-size: 10.5pt;">b)</span></span><span style="text-justify: inter-ideograph; text-align: justify; line-height: normal;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 7pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span></span><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify;"><span style="font-family: Calibri;"><span style="font-size: 10.5pt;">Convert virtual directory to web application in IIS, please make sure to use ASP.NET 4.0, an easy way is to use MapServer2013AppPool as application pool:</span></span></span></span></p>
<p class="MsoNormal" style="text-justify: inter-ideograph; line-height: normal; text-indent: 18pt; margin: 0cm 0cm 0pt;"><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify; mso-no-proof: yes;"><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017c388b5865970b-pi"><img alt="clip_image004" border="0" height="341" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017d42ba68d1970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="clip_image004" width="404" /></a></span></p>
<p class="MsoNormal" style="text-justify: inter-ideograph; line-height: normal; text-indent: 18pt; margin: 0cm 0cm 0pt;"><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify; mso-no-proof: yes;"><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017c388b588c970b-pi"><img alt="clip_image006" border="0" height="315" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017c388b58a2970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="clip_image006" width="395" /></a></span></p>
<p class="MsoListParagraph" style="text-justify: inter-ideograph; line-height: normal; text-indent: 21pt; margin: 0cm 0cm 0pt;"><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify;"><span style="font-family: Calibri;"><span style="font-size: 10.5pt; color: #000000;">&#0160;</span></span></span></p>
<p class="MsoListParagraph" style="text-justify: inter-ideograph; line-height: normal; text-indent: -21pt; margin: 0cm 0cm 0pt 42pt; mso-char-indent-count: 0; mso-list: l0 level2 lfo1;"><span style="color: #000000;"><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify; mso-fareast-font-family: calibri; mso-fareast-theme-font: minor-latin; mso-bidi-font-family: calibri; mso-bidi-theme-font: minor-latin;"><span style="text-justify: inter-ideograph; text-align: justify; mso-list: ignore;"><span style="font-family: Calibri;"><span style="font-size: 10.5pt;">c)</span></span><span style="text-justify: inter-ideograph; text-align: justify; line-height: normal;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 7pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span></span><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify;"><span style="font-family: Calibri;"><span style="font-size: 10.5pt;">Copy all dlls from C:\Program Files\Autodesk\Autodesk Infrastructure Web Server Extension 2013\www\mapviewernet\bin To C:\Program Files\Autodesk\Autodesk Infrastructure Web Server Extension 2013\www\MobileViewer\ListSelectionAppDotnet\bin</span></span></span></span></p>
<p class="MsoListParagraph" style="text-justify: inter-ideograph; line-height: normal; text-indent: -21pt; margin: 0cm 0cm 0pt 42pt; mso-char-indent-count: 0; mso-list: l0 level2 lfo1;"><span style="color: #000000;"><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify; mso-fareast-font-family: calibri; mso-fareast-theme-font: minor-latin; mso-bidi-font-family: calibri; mso-bidi-theme-font: minor-latin;"><span style="text-justify: inter-ideograph; text-align: justify; mso-list: ignore;"><span style="font-family: Calibri;"><span style="font-size: 10.5pt;">d)</span></span><span style="text-justify: inter-ideograph; text-align: justify; line-height: normal;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 7pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span></span><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify;"><span style="font-family: Calibri;"><span style="font-size: 10.5pt;">Copy webconfig.ini from C:\Program Files\Autodesk\Autodesk Infrastructure Web Server Extension 2013\www<span style="text-justify: inter-ideograph; text-align: justify; mso-spacerun: yes;">&#0160; </span>to C:\Program Files\Autodesk\Autodesk Infrastructure Web Server Extension 2013\www\MobileViewer\ListSelectionAppDotnet</span></span></span></span></p>
<p class="MsoListParagraph" style="text-justify: inter-ideograph; line-height: normal; text-indent: 0cm; margin: 0cm 0cm 0pt 42pt; mso-char-indent-count: 0;"><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify;"><span style="font-family: Calibri;"><span style="font-size: 10.5pt; color: #000000;">&#0160;</span></span></span></p>
<p class="MsoListParagraph" style="text-justify: inter-ideograph; line-height: normal; text-indent: -18pt; margin: 0cm 0cm 0pt 18pt; mso-char-indent-count: 0; mso-list: l0 level1 lfo1;"><span style="color: #000000;"><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify; mso-fareast-font-family: calibri; mso-fareast-theme-font: minor-latin; mso-bidi-font-family: calibri; mso-bidi-theme-font: minor-latin;"><span style="text-justify: inter-ideograph; text-align: justify; mso-list: ignore;"><span style="font-family: Calibri;"><span style="font-size: 10.5pt;">5.</span></span><span style="text-justify: inter-ideograph; text-align: justify; line-height: normal;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 7pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span></span><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify;"><span style="font-family: Calibri;"><span style="font-size: 10.5pt;">Start-&gt; cmd to open command window:</span></span></span></span></p>
<p class="MsoListParagraph" style="text-justify: inter-ideograph; line-height: normal; text-indent: -21pt; margin: 0cm 0cm 0pt 42pt; mso-char-indent-count: 0; mso-list: l0 level2 lfo1;"><span style="color: #000000;"><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify; mso-fareast-font-family: calibri; mso-fareast-theme-font: minor-latin; mso-bidi-font-family: calibri; mso-bidi-theme-font: minor-latin;"><span style="text-justify: inter-ideograph; text-align: justify; mso-list: ignore;"><span style="font-family: Calibri;"><span style="font-size: 10.5pt;">a)</span></span><span style="text-justify: inter-ideograph; text-align: justify; line-height: normal;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 7pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span></span><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify;"><span style="font-family: Calibri;"><span style="font-size: 10.5pt;">cd C:\MobileViewer_Dev (the folder contains build.xml)</span></span></span></span></p>
<p class="MsoListParagraph" style="text-justify: inter-ideograph; line-height: normal; text-indent: -21pt; margin: 0cm 0cm 0pt 42pt; mso-char-indent-count: 0; mso-list: l0 level2 lfo1;"><span style="color: #000000;"><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify; mso-fareast-font-family: calibri; mso-fareast-theme-font: minor-latin; mso-bidi-font-family: calibri; mso-bidi-theme-font: minor-latin;"><span style="text-justify: inter-ideograph; text-align: justify; mso-list: ignore;"><span style="font-family: Calibri;"><span style="font-size: 10.5pt;">b)</span></span><span style="text-justify: inter-ideograph; text-align: justify; line-height: normal;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 7pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span></span><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify;"><span style="font-family: Calibri;"><span style="font-size: 10.5pt;">Ant </span></span></span></span></p>
<p class="MsoNormal" style="text-justify: inter-ideograph; line-height: normal; margin: 0cm 0cm 0pt 21pt;"><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify; mso-no-proof: yes;"><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017d42ba6913970c-pi"><img alt="clip_image008" border="0" height="360" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017c388b58c5970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="clip_image008" width="416" /></a></span></p>
<p class="MsoListParagraph" style="text-justify: inter-ideograph; line-height: normal; text-indent: -18pt; margin: 0cm 0cm 0pt 18pt; mso-char-indent-count: 0; mso-list: l0 level1 lfo1;"><span style="color: #000000;"><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify; mso-fareast-font-family: calibri; mso-fareast-theme-font: minor-latin; mso-bidi-font-family: calibri; mso-bidi-theme-font: minor-latin;"><span style="text-justify: inter-ideograph; text-align: justify; mso-list: ignore;"><span style="font-family: Calibri;"><span style="font-size: 10.5pt;">6.</span></span><span style="text-justify: inter-ideograph; text-align: justify; line-height: normal;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 7pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span></span><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify;"><span style="font-family: Calibri;"><span style="font-size: 10.5pt;">Open Mobile viewer and test</span></span></span></span></p>
<p class="MsoListParagraph" style="text-justify: inter-ideograph; line-height: normal; text-indent: -21pt; margin: 0cm 0cm 0pt 42pt; mso-char-indent-count: 0; mso-list: l0 level2 lfo1;"><span style="color: #000000;"><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify; mso-fareast-font-family: calibri; mso-fareast-theme-font: minor-latin; mso-bidi-font-family: calibri; mso-bidi-theme-font: minor-latin;"><span style="text-justify: inter-ideograph; text-align: justify; mso-list: ignore;"><span style="font-family: Calibri;"><span style="font-size: 10.5pt;">a)</span></span><span style="text-justify: inter-ideograph; text-align: justify; line-height: normal;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 7pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span></span><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify;"><span style="font-family: Calibri;"><span style="font-size: 10.5pt;">Open in browser</span></span></span></span></p>
<p class="MsoListParagraph" style="text-justify: inter-ideograph; line-height: normal; text-indent: -21pt; margin: 0cm 0cm 0pt 42pt; mso-char-indent-count: 0; mso-list: l0 level2 lfo1;"><span style="color: #000000;"><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify; mso-fareast-font-family: calibri; mso-fareast-theme-font: minor-latin; mso-bidi-font-family: calibri; mso-bidi-theme-font: minor-latin;"><span style="text-justify: inter-ideograph; text-align: justify; mso-list: ignore;"><span style="font-family: Calibri;"><span style="font-size: 10.5pt;">b)</span></span><span style="text-justify: inter-ideograph; text-align: justify; line-height: normal;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 7pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span></span><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify;"><span style="font-family: Calibri;"><span style="font-size: 10.5pt;">Click “DevCampHelloWorld” button, and click on map;</span></span></span></span></p>
<p class="MsoListParagraph" style="text-justify: inter-ideograph; line-height: normal; text-indent: -21pt; margin: 0cm 0cm 0pt 42pt; mso-char-indent-count: 0; mso-list: l0 level2 lfo1;"><span style="color: #000000;"><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify; mso-fareast-font-family: calibri; mso-fareast-theme-font: minor-latin; mso-bidi-font-family: calibri; mso-bidi-theme-font: minor-latin;"><span style="text-justify: inter-ideograph; text-align: justify; mso-list: ignore;"><span style="font-family: Calibri;"><span style="font-size: 10.5pt;">c)</span></span><span style="text-justify: inter-ideograph; text-align: justify; line-height: normal;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 7pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span></span><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify;"><span style="font-family: Calibri;"><span style="font-size: 10.5pt;">Click “DevCampShowMapInformation” button to show the map information</span></span></span></span></p>
<p class="MsoListParagraph" style="text-justify: inter-ideograph; line-height: normal; text-indent: -21pt; margin: 0cm 0cm 0pt 42pt; mso-char-indent-count: 0; mso-list: l0 level2 lfo1;"><span style="color: #000000;"><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify; mso-fareast-font-family: calibri; mso-fareast-theme-font: minor-latin; mso-bidi-font-family: calibri; mso-bidi-theme-font: minor-latin;"><span style="text-justify: inter-ideograph; text-align: justify; mso-list: ignore;"><span style="font-family: Calibri;"><span style="font-size: 10.5pt;">d)</span></span><span style="text-justify: inter-ideograph; text-align: justify; line-height: normal;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 7pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span></span><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify;"><span style="font-family: Calibri;"><span style="font-size: 10.5pt;">Zoom in and select some features with multi-selection tool</span></span></span></span></p>
<p class="MsoListParagraph" style="text-justify: inter-ideograph; line-height: normal; text-indent: -21pt; margin: 0cm 0cm 0pt 42pt; mso-char-indent-count: 0; mso-list: l0 level2 lfo1;"><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify; mso-fareast-font-family: calibri; mso-fareast-theme-font: minor-latin; mso-bidi-font-family: calibri; mso-bidi-theme-font: minor-latin;"><span style="text-justify: inter-ideograph; text-align: justify; mso-list: ignore;"><span style="color: #000000;"><span style="font-family: Calibri;"><span style="font-size: 10.5pt;">e)</span></span><span style="text-justify: inter-ideograph; text-align: justify; line-height: normal;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 7pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span></span></span><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify;"><span style="font-family: Calibri;"><span style="font-size: 10.5pt; color: #000000;">Click “ListSelection” button, to show the feature information of selected features.</span></span>       <br /><span style="text-justify: inter-ideograph; text-align: justify; mso-no-proof: yes;"><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017eea2ea250970d-pi"><img alt="clip_image010" border="0" height="311" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017c388b58e9970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="clip_image010" width="374" /></a></span></span></p>
<p class="MsoNormal" style="text-justify: inter-ideograph; line-height: normal; margin: 0cm 0cm 0pt 21pt;"><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify; mso-no-proof: yes;"><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017d42ba6958970c-pi"><img alt="clip_image012" border="0" height="280" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017d42ba6972970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="clip_image012" width="419" /></a></span></p>
<p class="MsoNormal" style="text-justify: inter-ideograph; line-height: normal; margin: 0cm 0cm 0pt 21pt;"><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify; mso-no-proof: yes;"><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017d42ba698d970c-pi"><img alt="clip_image014" border="0" height="334" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017c388b592f970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="clip_image014" width="418" /></a></span></p>
<p class="MsoNormal" style="text-justify: inter-ideograph; line-height: normal; margin: 0cm 0cm 0pt 21pt;"><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify; mso-no-proof: yes;"><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017c388b597b970b-pi"><img alt="clip_image016" border="0" height="303" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017eea2ea2e9970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="clip_image016" width="410" /></a></span></p>
<p class="MsoNormal" style="text-justify: inter-ideograph; line-height: normal; margin: 0cm 0cm 0pt 21pt;"><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify;"><span style="font-family: Calibri;"><span style="font-size: 10.5pt; color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="text-justify: inter-ideograph; line-height: normal; margin: 0cm 0cm 0pt 21pt;"><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify;"><span style="font-family: Calibri;"><span style="font-size: 10.5pt; color: #000000;">&#0160;</span></span></span></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: ODTables.Item(tableName) does not work on Windows7/Vista?
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: odtablesitemtablename-does-not-work-on-windows7vista
CATEGORY: AutoCAD Civil 3D 2011
CATEGORY: AutoCAD Civil 3D 2012
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: AutoCAD Civil 3D 2014
CATEGORY: AutoCAD Map 3D 2011
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: AutoCAD Map 3D 2014
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/04/odtablesitemtablename-does-not-work-on-windows7vista.html 
DATE: 04/10/2013 07:39:53 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p><b>Issue</b></p>  <p>I am migrating my Map 3D VBA application to .NET, but when I call ODTables.Item(strTableName), it always crashes AutoCAD on Windows 7/Vista, and it works well on WinXP.</p>  <p><b>Solution</b></p>  <p>You can use following workaround on Windows 7/Vista to solve this problem:</p>  <p>VB.NET:</p>  <pre><p>&lt;code_begin&gt;</p><p>&#160;&#160;&#160; Dim ODTbl As AutocadMAP.ODTable<br />&#160;&#160;&#160; ODTbl = Nothing</p><p>&#160;&#160;&#160; For index = 0 To ODTbls.Count - 1<br />&#160;&#160;&#160;&#160;&#160;&#160; Debug.WriteLine( ODTbls.Item(index).Name.ToString())<br />&#160;&#160;&#160;&#160;&#160;&#160; If (ODTbls.Item(index).Name.ToString() = TargetTable) Then<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ODTbl = ODTbls.Item(index)<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Exit For<br />&#160;&#160;&#160;&#160;&#160;&#160; End If<br />&#160;&#160;&#160; Next</p><p><br />&lt;code_end&gt;</p></pre>

<p>VBA code:</p>

<pre><p>&lt;code_begin&gt;</p><p>Public Sub GetMapApp()<br />Dim amap As AcadMap<br />Dim tbl As ODTable<br />Dim tbls As ODTables<br />Set amap = ThisDrawing.Application.GetInterfaceObject(&quot;AutoCADMap.Application&quot;)<br />Debug.Print amap.Projects.Count <br /><br />'' workaround<br />Set tbls = amap.Projects(ThisDrawing).ODTables<br /><br />If (tbls.Count) &gt; 0 Then<br />For Each tbl In tbls<br />If tbl.Name = &quot;Building&quot; Then ‘ set OD Table name here as per your data<br />Debug.Print tbl.Name<br />End If<br />Next<br />End If<br /><br />End Sub<br /><br /></p><p>&lt;code_end&gt;</p></pre>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Autodesk Infrastructure Map Server(AIMS) API Training content : Part-7
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: autodesk-infrastructure-map-serveraims-api-training-content-part-7
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: AIMS 2014
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/04/autodesk-infrastructure-map-serveraims-api-training-content-part-7.html 
DATE: 04/10/2013 12:48:24 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>
<p>We discussed Ajax Viewer API in <a href="http://adndevblog.typepad.com/infrastructure/2013/04/autodesk-infrastructure-map-serveraims-api-training-content-part-2.html">chapter2</a>, in this chapter, we will talk about Fusion Viewer API. Flexible web layouts are an alternative to the Ajax Viewer. Flexible web layouts make use of additional libraries and technologies for some functionality. At times it may be useful to refer to documentation for these libraries. See the following for more information:</p>
<ul>
<li>Fusion, the open source technology used by Flexible Web Layouts.      <br /><a href="http://trac.osgeo.org/fusion/wiki">http://trac.osgeo.org/fusion/wiki</a></li>
<li>OpenLayers, a JavaScript library for displaying map data in a browser.      <br /><a href="http://www.osgeo.org/openlayers">http://www.osgeo.org/openlayers</a></li>
<li>Jx, a JavaScript library for building UI components like dialogs.      <br /><a href="http://jxlib.org">http://jxlib.org</a></li>
</ul>
<p>In this chapter we will give you an introduction of fusion viewer, the components of fusion viewer, how it works and how to extend this fusion viewer. <a href="http://wikihelp.autodesk.com/Infr._Map_Server/enu/2013/Help/0005-Develope0/0094-Flexible94">This document on wikihelp</a> is very useful, I would suggestion you to go through it first and refer to our training materials below.&#0160; You may also find this <a href="http://download.autodesk.com/media/adn/FusionIntroductionDevTV.zip">DevTV</a> useful as well.</p>
<p>
<span class="asset  asset-generic at-xid-6a0167607c2431970b017eea20c14b970d"><a href="http://adndevblog.typepad.com/files/en_aims_api_chapter_7.pdf">Download EN_AIMS_API_Chapter_7</a></span></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Autodesk Infrastructure Map Server(AIMS) API Training content : Part-6
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: autodesk-infrastructure-map-serveraims-api-training-content-part-6
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: AIMS 2014
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/04/autodesk-infrastructure-map-serveraims-api-training-content-part-6.html 
DATE: 04/09/2013 02:59:17 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>
<p>This is second half of feature service, we will discuss updating, deleting and creating features with feature service. </p>
<p>A feature class contains one or more features. Each feature has a geometry that defines the spatial representation of the feature.Features will also generally have one or more properties that provide additional information. Feature class is a database-table-like structure, it contains properties corresponding to table columns. The properties can be geometry type, data type, raster type or object type. The most commonly used ones are geometry property and various data properties.&#0160; MgClass<strong>Definition</strong> or MgProperty<strong>Definition</strong> classes are used to describe the schema of feature class. </p>
<p>To create a feature class, we need to build up the schema first by creating a MgClassDefinition and populate the property definition collection and add them to a Mg<strong>PropertyDefinition</strong>Collection which can be get from MgClassDefinition.GetProperties() method, next step is to create and set up schema with MgFeatureSchema class and the physical storage format. In AIMS, we can create file based schema like SDF, SHP file or SQLite.</p>
<p>Once the schema of feature source is created, we can add/delete/update some records(features) into it with MgInsertFeatures/MgDeleteFeatures/MgUpdateFeatures commands.&#0160; These commands accept Mg<strong>Property</strong>Collection as parameter. MgPropertyCollection holds the property <strong>value</strong> used to update/insert a feature class. Finally we MUST call MgFeatureService.UpdateFeatures() to execute the commands(insert/delete/update) and commit the changes into feature source. </p>
<p>Let’s consider such a scenario, a user draws a feature(point, line or polygon)in browser with mouse and we’d like to save it into feature source. Firstly we need to get the coordinates of the feature, this process is called digitizing, it can be done with Ajax Viewer API or Fusion viewer API, please refer to <a href="http://www.cnblogs.com/junqilian/archive/2010/06/04/1751563.html">this post</a> for example of digitizing in fusion viewer.&#0160; After we getting the coordinate value of each vertex, we can create the geometry with MgGeometryFactory class. </p>
<p>If you examine the feature service API, you will notice that the constructor of MgGeometryProperty class need a parameter with MgByteReader type. In AIMS API, a geometry has 3 representations:</p>
<ol>
<li>MgGeometry and its subclasses, it can be&#0160; created with MgGeometryFactory;</li>
<li>MyByteReader, which is used by feature service API;</li>
<li>AGF(Autodesk Geometry Format) text, it is a superset of WKT(Well known text);</li>
</ol>
<p>The conversion between these 3 representations can be done by MgAgfReaderWriter or MgWktReaderWriter:</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017d42a68668970c-pi"><img alt="image" border="0" height="216" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017d42a68676970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="image" width="436" /></a></p>
<p>&#0160;</p>
<p>Following graph demos the process of inserting a feature into class, it can be found in Web Extension API reference. Please read this graph from bottom to top.</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017eea1abd62970d-pi"><img alt="image" border="0" height="242" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017c387778f9970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="image" width="451" /></a></p>
<p>&#0160;</p>
<p>OK, now please find the attached PPT for more information about this chapter.</p>
<p>
<span class="asset  asset-generic at-xid-6a0167607c2431970b017d42a68977970c"><a href="http://adndevblog.typepad.com/files/en_aims_api_chapter_6.pdf">Download EN_AIMS_API_Chapter_6</a></span></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Autodesk Infrastructure Map Server(AIMS) API Training content : Part-5
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: autodesk-infrastructure-map-serveraims-api-training-content-part-5
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: AIMS 2014
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/04/autodesk-infrastructure-map-serveraims-api-training-content-part-5.html 
DATE: 04/07/2013 01:02:57 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>
<p>Beginning from this chapter, we will discuss feature service and . It is so important and have so many stuff to say, we have to separate it into 2 chapters, this is the first part, we will discuss FDO Providers, Feature Query, and Feature Selection. </p>
<p>In AIMS WebExtension API, Feature service provides APIs to store and retrieve features, it is independent of the data storage technology by creating an abstraction layer, FDO (Feature Data Object) is used to construct this abstraction layer. FDO is intended to provide consistent access to feature data, whether it comes from a CAD-based data source, or from a relational data store that supports rich classification. A FDO provider is the software component that provides access to data in a particular data store. Some built-in FDO providers such as provider for SDF, SHP, SQL Server, Oracle are released with AIMS product, FDO is an open source project, you can also download other FDO providers from <a href="http://fdo.osgeo.org">fdo.osgeo.org</a>.&#0160; Different FDO provider has different capabilities. It is possible to get a provider’s capability programmatically. Please refer to <a href="http://adndevblog.typepad.com/infrastructure/2013/03/autocad-map-3d-api-training-content-part-3.html">AutoCAD Map 3D API Training content: Part-3</a> and FDO document for more information about FDO.&#0160; The FDO document can be found in <a href="http://usa.autodesk.com/adsk/servlet/index?siteID=123112&amp;id=868220">&lt;Map3D SDK&gt;</a>\Fdo\Docs. </p>
<p>In AIMS development, a common task is to query features from feature data. It is possible to list the features and its properties with API when user selects some features in viewer. Selections can be created programatically with the Web API as well. Basic filters or spatial filters are used to select features based on feature properties or their geometry. For example, you could use a basic filter to select all roads that have four or more lanes.Or you could use a spatial filter to select all roads that intersect a certain area.</p>
<p>Please find the attached PPT and the code sample solution 4, which can be downloaded <a href="http://adndevblog.typepad.com/infrastructure/2012/05/devtv-and-code-sample-create-temporary-layer-feature-editing-in-aims2012.html">here</a>.</p>
<p>
<span class="asset  asset-generic at-xid-6a0167607c2431970b017c38692270970b"><a href="http://adndevblog.typepad.com/files/en_aims_api_chapter_5.pdf">Download EN_AIMS_API_Chapter_5</a></span></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Snoop Civil 3D 2014 Database
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: snoop-civil-3d-2014-database
CATEGORY: .NET
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D 2014

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/04/snoop-civil-3d-2014-database.html 
DATE: 04/05/2013 01:58:15 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>
<p>After a <a href="http://civilizeddevelopment.typepad.com/civilized-development/2011/10/introducing-snoop-civil-3d-2012-database.html">first launch</a>, now it is time for a new version!</p>
<p>The good news is that his tool uses Reflection to inspect the objects, so all new properties will appear on the list without extra work, like the <a href="http://adndevblog.typepad.com/infrastructure/2013/03/corridor-api-2014-new-methods-and-properties.html">new properties</a> available on the Corridor 2014 related objects are already there. Additionally, the main list now includes <strong>Point Groups</strong>.</p>
<p>The main new feature is the ability to go from one entity to another: from one object, e.g. <strong>Baseline</strong>, if we click on the <strong>AlignmentId</strong> property, the tool will automatically open the Alignment and show its properties! That enable us to go from one Corridor Baseline to the respective Alignment very easily! Also work for all other ObjectId properties.</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017c38601dd8970b-pi"><img alt="objectid_property" border="0" height="407" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017d428f336c970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="objectid_property" width="492" /></a></p>
<p>Download the <span class="asset  asset-generic at-xid-6a0167607c2431970b017d42aa4e0d970c"><a href="http://adndevblog.typepad.com/files/snoopcivil3d_sourcecode-1.zip">source code</a></span> and&#0160;<span class="asset  asset-generic at-xid-6a0167607c2431970b017d42aa4e7b970c"><a href="http://adndevblog.typepad.com/files/snoopcivil3d_executable-1.zip">executable</a></span>, NETLOAD the <em>SnoopCivil3DObjects.dll</em> and run <strong>SNOOPCIVIL3DDB</strong> command. Enjoy!</p>
<p>Feel free to leave feedback :-)</p>
<p><strong>Update</strong>: after some feedback, I made some minor changes on the tools. This version is updated with the changes.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: BlackBox
EMAIL: 
IP: 173.171.0.201
URL: http://profile.typepad.com/6p017d4259d7c8970c
DATE: 04/20/2013 12:08:25 AM
Hi Augusto, I just wanted to say thanks for this utility... I'm a huge fan of the MgdDbg, and ArxDbg plug-ins already.

Will you also be adding similar functionality to this utility, such as what is provided by those mentioned above, such as Civil 3D-specific Events monitoring, etc.? 

This would be extremely valuable to Civil 3D Developers, and should be offered for each vertical to my mind.

Again, many thanks... Cheers
-----
COMMENT:
AUTHOR: BlackBox
EMAIL: 
IP: 173.171.0.201
URL: http://profile.typepad.com/6p017d4259d7c8970c
DATE: 04/20/2013 12:18:51 AM
Also, forgot to ask this above... In the spirit of Autoloader, will you be offering a pseudo-named 'MgdC3dDbg' plug-in .bundle?



I don't mind packaging one up and posting over at TheSwamp, but it would be helpful to know where I can find and include prior versions for 2010-2012, etc..

Cheers
-----
COMMENT:
AUTHOR: BlackBox
EMAIL: 
IP: 207.34.120.71
URL: http://profile.typepad.com/6p017d4259d7c8970c
DATE: 04/22/2013 08:19:59 AM
Augusto,

Could this plug-in be revised to allow one to open a Civil 3D model as a side Database instead of being relegated to the active Document?

Separately, it would also be nice if the form were modeless (perhaps even a dockable Tool Palette?), and updated following changes to the Database dynamically.

Cheers
-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 187.37.91.168
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 04/22/2013 05:17:09 PM
I'll look into the events feature.

Thanks for the suggestion.

Regards,
Augusto Goncalves
-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 187.37.91.168
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 04/22/2013 05:18:07 PM
Sure that can be done, I have the DLLs. Will post here.

Thanks,
Augusto Goncalves
-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 187.37.91.168
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 04/22/2013 05:21:02 PM
The side database may be possible, will look into it...but for now it may be easy to open a second instance of Civil3D.

Now a palette feature will be complicated due the transaction required to open the objects.

Thanks for all the suggestions.

Cheers,
Augusto Goncalves
-----
COMMENT:
AUTHOR: BlackBox
EMAIL: 
IP: 207.34.120.71
URL: http://profile.typepad.com/6p017d4259d7c8970c
DATE: 04/23/2013 01:47:37 PM
[Augusto] "Thanks for all the suggestions."

You're welcome; I look forward to the update(s).

Cheers
-----
COMMENT:
AUTHOR: emyr
EMAIL: emyr.isaac@autodesk.com
IP: 212.139.242.163
URL: 
DATE: 03/26/2014 02:55:06 AM
Cannot seem to load the file

Cannot load assembly. Error details: System.IO.FileLoadException: Could not load file or assembly 'file:///C:\Users\isaace\Documents\Autodesk\C3D\Dll's\SnoopCivil3DObjects.dll' or one of its dependencies. Operation is not supported. (Exception from HRESULT: 0x80131515)
File name: 'file:///C:\Users\isaace\Documents\Autodesk\C3D\Dll's\SnoopCivil3DObjects.dll' ---> System.NotSupportedException: An attempt was made to load an assembly from a network location which would have caused the assembly to be sandboxed in previous versions of the .NET Framework. This release of the .NET Framework does not enable CAS policy by default, so this load may be dangerous. If this load is not intended to sandbox the assembly, please enable the loadFromRemoteSources switch. See http://go.microsoft.com/fwlink/?LinkId=155569 for more information.
   at System.Reflection.RuntimeAssembly._nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, RuntimeAssembly locationHint, StackCrawlMark& stackMark, IntPtr pPrivHostBinder, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks)
   at System.Reflection.RuntimeAssembly.InternalLoadAssemblyName(AssemblyName assemblyRef, Evidence assemblySecurity, RuntimeAssembly reqAssembly, StackCrawlMark& stackMark, IntPtr pPrivHostBinder, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks)
   at System.Reflection.RuntimeAssembly.InternalLoadAssemblyName(AssemblyName assemblyRef, Evidence assemblySecurity, RuntimeAssembly reqAssembly, StackCrawlMark& stackMark, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks)
   at System.Reflection.RuntimeAssembly.InternalLoadFrom(String assemblyFile, Evidence securityEvidence, Byte[] hashValue, AssemblyHashAlgorithm hashAlgorithm, Boolean forIntrospection, Boolean suppressSecurityChecks, StackCrawlMark& stackMark)
   at System.Reflection.Assembly.LoadFrom(String assemblyFile)
   at Autodesk.AutoCAD.Runtime.ExtensionLoader.Load(String fileName)
   at loadmgd()
-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 03/26/2014 08:06:36 AM





Typepad HTML Email




Emyr,

The first think is make sure you are NETLOADing from a local drive. If still not working, check more at this post:

http://through-the-interface.typepad.com/through_the_interface/2011/07/loading-blocked-and-network-hosted-assemblies-with-net-4.html

Regards,
Augusto Goncalves

-----
COMMENT:
AUTHOR: makoykoy
EMAIL: makoychan@yahoo.com
IP: 67.83.174.201
URL: 
DATE: 01/21/2015 12:05:12 PM
Hi Augusto,

The apps you've created was great,but i do have a question. Is this possible to work if instead of using the activedocument, i would use

Database db = new Database(false,true)
db.readdwg(file)
CivilDocument cDocs =  CivilDocument.GetDocument(db)

I was able to read the dwg but i always get an error on the getting count of the of collection "Get Count Failed"

THanks

-----
COMMENT:
AUTHOR: makoykoy
EMAIL: makoychan@yahoo.com
IP: 67.83.174.201
URL: 
DATE: 01/21/2015 12:09:57 PM
How does the side db works if i do a db.readdwg and instead of using the .activedocument. I use the CivilDOcument.GetDocument(db).

When i reach on the collection object it throws an error of "Get count Failed"
-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 177.43.194.106
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 01/22/2015 04:29:51 AM
Hi Makoykoy

It should be possible, although I have not tested. The main reason is to support multiple versions (as this code was originally designed for C3D2012).

Not sure why you need to inspect the non-current document, but you need to make sure all pieces are calling over this document (such as transaction and other runtime objects).

Regards,
Augusto Goncalves
-----
--------
AUTHOR: Marat Mirgaleev
AUTHOR EMAIL: marat.mirgaleev@autodesk.com
TITLE: Civil 3D .NET API: COGO Point: How to read a User-Defined Property?
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: civil-3d-net-api-cogo-point-how-to-read-a-user-defined-property
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2013

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/04/civil-3d-net-api-cogo-point-how-to-read-a-user-defined-property.html 
DATE: 04/04/2013 08:55:44 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/marat-mirgaleev.html" target="_self">Marat Mirgaleev</a></p>  <p><strong>Issue</strong></p>  <p><em>I need to get the value of a User-Defined Property of a COGO point. Is there any API for this?</em></p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017c38579381970b-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017ee9faece6970d-pi" width="494" height="275" /></a></p>  <p>&#160;</p>  <p><strong>Solution</strong></p>  <p>Yes, there is the CogoPoint.GetUDPValue() method for it. But it requires a parameter of one of the following types: UDPBoolean, UDPDouble, UDPEnumeration, UDPInteger or UDPString.</p>  <p>All the User-Defined Properties (UDPs) for COGO points can be found in this collection: <span style="line-height: 140%; color: #2b91af">CivilApplication</span><span style="line-height: 140%">.ActiveDocument.PointUDPs. So, I’ve created a small function to find the respective UDP (called “MM1” on the screenshot) in this collection.</span></p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: green">' Reading a User-Defined Property of a COGO point.</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">&#160; '=================================================================</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: green">' Find the UDP amongst all the UDPs in the document</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">Private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Function</span><span style="line-height: 140%"> FindUDP( i_UDPname </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">String</span><span style="line-height: 140%"> ) </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">UDPString</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> foundUDP </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">UDPString</span><span style="line-height: 140%"> = </span><span style="line-height: 140%; color: blue">Nothing</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">For</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Each</span><span style="line-height: 140%"> UDP </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">UDP</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">In</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">CivilApplication</span><span style="line-height: 140%">.ActiveDocument.PointUDPs</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> UDP.Name = i_UDPname </span><span style="line-height: 140%; color: blue">Then</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; foundUDP = </span><span style="line-height: 140%; color: blue">TryCast</span><span style="line-height: 140%">(UDP, </span><span style="line-height: 140%; color: #2b91af">UDPString</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Exit For</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">If</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Next</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Return</span><span style="line-height: 140%"> foundUDP</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Function</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; &lt;</span><span style="line-height: 140%; color: #2b91af">CommandMethod</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: #a31515">&quot;RCCG&quot;</span><span style="line-height: 140%">)&gt; _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">Public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span><span style="line-height: 140%"> ReadUDPOfCoGoPoint()</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Try</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> ed </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Editor</span><span style="line-height: 140%"> = </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Application</span><span style="line-height: 140%">.DocumentManager.MdiActiveDocument.Editor</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">' Select a COGO point</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> selectPointsResult </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">PromptEntityResult</span><span style="line-height: 140%"> = </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.GetEntity(vbCrLf + </span><span style="line-height: 140%; color: #a31515">&quot;Select a COGO Point:&quot;</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> selectPointsResult.Status &lt;&gt; </span><span style="line-height: 140%; color: #2b91af">PromptStatus</span><span style="line-height: 140%">.OK </span><span style="line-height: 140%; color: blue">Then</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Return</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">If</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> db </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Database</span><span style="line-height: 140%"> = </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Application</span><span style="line-height: 140%">.DocumentManager.MdiActiveDocument.Database</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Using</span><span style="line-height: 140%"> tr </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Transaction</span><span style="line-height: 140%"> = </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; db.TransactionManager.StartTransaction()</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> dbObj </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> Autodesk.AutoCAD.DatabaseServices.</span><span style="line-height: 140%; color: #2b91af">DBObject</span><span style="line-height: 140%"> =</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; tr.GetObject(selectPointsResult.ObjectId, </span><span style="line-height: 140%; color: #2b91af">OpenMode</span><span style="line-height: 140%">.ForRead)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> pt </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">CogoPoint</span><span style="line-height: 140%"> = </span><span style="line-height: 140%; color: blue">TryCast</span><span style="line-height: 140%">(dbObj, </span><span style="line-height: 140%; color: #2b91af">CogoPoint</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Const</span><span style="line-height: 140%"> UDPname </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">String</span><span style="line-height: 140%">&#160; = </span><span style="line-height: 140%; color: #a31515">&quot;MM1&quot;</span><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: green">' The property we are </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">' looking for</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> UDP </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">UDPString</span><span style="line-height: 140%"> = FindUDP( UDPname ) </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">' See this function above</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">If</span><span style="line-height: 140%"> UDP </span><span style="line-height: 140%; color: blue">Is</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Nothing</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Then</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Return</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">If</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Dim</span><span style="line-height: 140%"> s </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">String</span><span style="line-height: 140%"> = pt.GetUDPValue(UDP)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage( </span><span style="line-height: 140%; color: blue">String</span><span style="line-height: 140%">.Format( vbCrLf+</span><span style="line-height: 140%; color: #a31515">&quot;MM1={0}&quot;</span><span style="line-height: 140%">, s ) )</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; tr.Commit()</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Using</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Catch</span><span style="line-height: 140%"> e </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> System.</span><span style="line-height: 140%; color: #2b91af">InvalidOperationException</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; System.Windows.Forms.</span><span style="line-height: 140%; color: #2b91af">MessageBox</span><span style="line-height: 140%">.Show( </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;Probably, this point does not have the MM1 property set&quot;</span><span style="line-height: 140%"> )</span></p>    <p style="margin: 0px"><span style="line-height: 140%"></span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">Catch</span><span style="line-height: 140%"> e </span><span style="line-height: 140%; color: blue">As</span><span style="line-height: 140%"> System.</span><span style="line-height: 140%; color: #2b91af">Exception</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; System.Windows.Forms.</span><span style="line-height: 140%; color: #2b91af">MessageBox</span><span style="line-height: 140%">.Show( </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;Exception in ReadUDPOfCoGoPoint():&quot;</span><span style="line-height: 140%"> _</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; + vbCrLf + e.Message)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Try</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160; </span><span style="line-height: 140%; color: blue">End</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">Sub</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: green">' ReadUDPOfCoGoPoint()</span></p> </div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Michael J. Smith
EMAIL: smittynchatt@gmail.com
IP: 152.85.8.38
URL: 
DATE: 06/10/2013 01:21:33 PM
Will this solution work on Civil 3D 2012?

-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 203.202.234.226
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 06/10/2013 10:59:41 PM
Hi Michael ,

I don't have Civil 3D 2012 currently installed in my machine to confirm, but I think it won't work in 2012 release as COGO point .NET API was not exposed in 2012 release. If you have 2012 installed in your machine, please check the Civil 3D .NET API assembly.

Thanks,
Partha
-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Autodesk Infrastructure Map Server(AIMS) API Training content : Part-4
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: autodesk-infrastructure-map-serveraims-api-training-content-part-4
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: AIMS 2014
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/04/autodesk-infrastructure-map-serveraims-api-training-content-part-4.html 
DATE: 04/04/2013 12:18:00 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>
<p>In this part, we will discuss displaying and plotting maps. After this class, you will have a better understanding layers, layer groups and map, and learn how to plot maps to plain images or DWF files.</p>
<p>A layer in MapGuide is an overlay on a drawing composed of a logical group of data with the same geometric type. A layer references a feature source or a drawing source. it contains styling and theming information, and a collection of scale ranges. layers are visual representation of feature source. The styles of features, theming information, scale range information are defined in layer definition. </p>
<p>To create a layer, a convenient way is to generate the layer definition from an exiting layer definition xml as template. You get this template layer definition xml from Infrastructure Studio with “save as xml” menu, or use resource service to get the resource content of a layer. We discussed resource service in <a href="http://adndevblog.typepad.com/infrastructure/2013/04/autodesk-infrastructure-map-serveraims-api-training-content-part-3.html">part 3</a>.</p>
<p>A map contains one or more layers/layer groups. To list the layers in a map, use theMgMap::GetLayers() method. This returns an MgLayerCollection object. To modify maps and layers, please read this part in <a href="http://wikihelp.autodesk.com/Infr._Map_Server/enu/2013/Help/0005-Develope0/0062-Modifyin62">developer’s guide</a> as well. </p>
<p>Finally you can plot your map into plain image or DWF with mapping service. </p>
<p>OK, please find the attached PDF of training material chapter 4.</p>
<p>
<span class="asset  asset-generic at-xid-6a0167607c2431970b017d427db3d6970c"><a href="http://adndevblog.typepad.com/files/en_aims_api_chapter_4.pdf">Download EN_AIMS_API_Chapter_4</a></span></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Autodesk Infrastructure Map Server(AIMS) API Training content : Part-3
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: autodesk-infrastructure-map-serveraims-api-training-content-part-3
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: Daniel Du
CATEGORY: MapGuide Enterprise 2011

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/04/autodesk-infrastructure-map-serveraims-api-training-content-part-3.html 
DATE: 04/03/2013 12:19:56 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>
<p>In this post, we discuss site service and resource service. As we talked in <a href="http://adndevblog.typepad.com/infrastructure/2013/04/autodesk-infrastructure-map-serveraims-api-training-content-part-2.html">part 2</a>, there are 7 services in MapGuide Web Extension API. Before a page can use a service, it must open a site connection and create an instance of the necessary service type. All other 6 services are created by site service from a site connection. You have to initialize web tier in every page with following code snippet: </p>
<p>MapGuideApi.MgInitializeWebTier(“webconfig.ini”)</p>
<p>webconfig.ini file is text file used to perform basic initialization when a session starts, it is read by MgInitializeWebTier(). It contains parameters required to connect to the site server: IP address, port numbers, map agent requests customization, e.g. pause time between successive request, passwords for OGC (WMS &amp; WFS) requests and etc. The values set in this file affect the performance of map server. In most cases, no need to change. If you have to, please check out <a href="http://trac.osgeo.org/mapguide/wiki/ServerconfigWebConfigIni">this document</a>.&#0160; </p>
<p>An Infrastructure Map Server <em>repository</em> is a database that stores and manages the data for the site. The repository stores all data except data that is stored in external databases. Data stored in a repository is a <em>resource</em>.&#0160; A resource can be persistent resource or temporary resource. Persistent resource that is available to all users is stored in the Library repository.In addition, each session has its own repository, which stores the run-time map state. It can also be used to store other data, like temporary layers that apply only to an individual session. For example, a temporary layer might be used to overlay map symbols indicating places of interest.</p>
<p>Resource service is used to manipulate these resources with API. To use a resource service, web page must open a site connection and create an instance of a resource service:</p>
<pre style="line-height: normal; background: white;"><span style="font-family: 新宋体;"><span style="color: #000000;"><span style="font-size: 7.8pt;">MgUserInformation userInfo = </span></span><span style="font-size: 7.8pt;"><span><span style="color: #0000ff;">new</span></span></span></span><span style="font-family: 新宋体;"><span style="font-size: 7.8pt;"><span style="color: #000000;"> MgUserInformation(sessionID); <br />siteConnection = </span><span><span style="color: #0000ff;">new</span></span><span style="color: #000000;"> MgSiteConnection(); siteConnection.Open(userInfo); <br />MgResourceService resourceService = (MgResourceService)siteConnection<br />&#0160;&#0160;&#0160; .CreateService(MgServiceType.ResourceService); </span></span></span></pre>
<p>Here are some commonly used methods of resource service, please find the complete method list from the <a href="http://images.autodesk.com/adsk/files/autodesk_infrastructure_map_server_2013_api_references.zip">AIMS API Reference</a>.</p>
<p>MgResourceService::EnumerateResources
  <br />MgResourceService::GetResourceContent
  <br />MgResourceService::SetResource</p>
<p>With these simple APIs, you can create very useful/powerful applications as long as you have deep understanding of the resource content, in most case they are xml. If you are not familiar with resource and resource service, please view the <a href="http://adndevblog.typepad.com/files/en_aims_api_chapter_3.pdf" target="_self">chapter 3</a> of AIMS API training materials first. The exercise code sample solution 3 can be downloaded <a href="http://adndevblog.typepad.com/infrastructure/2012/05/devtv-and-code-sample-create-temporary-layer-feature-editing-in-aims2012.html">here</a>. After that, you may want to check out this <a href="http://adndevblog.typepad.com/infrastructure/2012/09/intelligent-landing-page-for-aimsmapguide-ajax-viewer-1.html">intelligence landing page</a>, it is a good example of usage of resource service. Please look at the source code, I believe you will find it very interesting.&#0160;
</p>
<p><span class="asset  asset-generic at-xid-6a0167607c2431970b017ee9eb4181970d"><a href="http://adndevblog.typepad.com/files/en_aims_api_chapter_3.pdf">Download EN_AIMS_API_Chapter_3</a></span> </p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: KJ
EMAIL: kolbjorn@stracon.no
IP: 85.200.206.218
URL: 
DATE: 04/05/2013 04:23:55 AM
Do you have a way to control cover areas in infrastructure and hove they impact on existing ground. They should be controlled better so that the landscape can be molded better and more exact.
-----
COMMENT:
AUTHOR: Daniel Du
EMAIL: 
IP: 118.228.153.196
URL: http://profile.typepad.com/daniel_du
DATE: 04/07/2013 12:11:56 AM
Sorry but I do not understand your requirement. But it is possible to embed a base layer like Google Maps/Bing Map, etc to AIMS with flexible web layout. Not sure whether it is what your want to do...
-----
COMMENT:
AUTHOR: Dolf Despojo
EMAIL: rcdespojo@meralco.com.ph
IP: 63.243.144.7
URL: 
DATE: 09/03/2013 11:36:50 PM
Hi Daniel, how do we integrate Google Maps or Google Earth Enterprise to AIMS? We are an electric utility and currently migrating our electrical facilities data from Mapguide 6.3 to AIMS 2013. But there is a need to align the same facilities data to a new base map which in our case is possibly Google Maps or Google Earth Enterprise.
-----
COMMENT:
AUTHOR: Daniel Du
EMAIL: 
IP: 221.216.250.60
URL: http://profile.typepad.com/daniel_du
DATE: 09/11/2013 05:31:19 PM
Integration with Google Map/Bing Map/Yahoo Map is part of built-in functionalites of AIMS 2013, you can set it up in Infrastructure Studio, and you need to use flexible web layout.
-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Autodesk Infrastructure Map Server(AIMS) API Training content : Part-2
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: autodesk-infrastructure-map-serveraims-api-training-content-part-2
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/04/autodesk-infrastructure-map-serveraims-api-training-content-part-2.html 
DATE: 04/02/2013 12:38:10 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>
<p>This is <a href="http://adndevblog.typepad.com/en_aims_api_chapter_2.pdf">second part</a> of AIMS API training materials. This part will cover an overview of AIMS/MapGuide API including Server API and Viewer API. </p>
<p>In AIMS/MapGuide Server API, it contains 8 services, they are:</p>
<table border="0" cellpadding="2" cellspacing="0" width="400">
<tbody>
<tr>
<td valign="top" width="200">
<p>Site Service            <br />Resource Service             <br />Mapping Service             <br />Rendering Service             <br />Tile Service             <br />Drawing Service             <br />Feature Service<br />Profiling Service&#0160;</p>
</td>
<td valign="top" width="200"><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017ee9eae8fe970d-pi"><img alt="image" border="0" height="244" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017c384798c2970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="186" /></a></td>
</tr>
</tbody>
</table>
<blockquote>
<p>&#0160;</p>
</blockquote>
<p>The most commonly used services are Resource Service and Feature Service. Besides the services, there are some additional objects including Geometry, Coordinate related objects and other common objects.</p>
<p>A service performs a particular set of related functions. For example, a resource service manages data in the repository, a feature service provides access to feature data sources, and a mapping service provides visualization and plotting functions. Before a page can use a service, it must open a site connection and create an instance of the necessary service type. All other 6 services are created by site service from a site connection. The following php code creates a resource service and a feature service, please find the .net <a href="http://adndevblog.typepad.com/infrastructure/2012/05/devtv-and-code-sample-create-temporary-layer-feature-editing-in-aims2012.html">code samples here</a>:</p>
<pre>$userInfo = new MgUserInformation($mgSessionId);
$siteConnection = new MgSiteConnection();
$siteConnection-&gt;Open($userInfo);
 
$resourceService = $siteConnection-&gt;
   CreateService(MgServiceType::ResourceService);
$featureService = $siteConnection-&gt;
   CreateService(MgServiceType::FeatureService);</pre>
<p>&#0160;</p>
<p>At client side, you can use Ajax viewer(Basic web layout) or Fusion viewer(Flexible web layout)&#0160; on browser, or Mobile viewer on a mobile device. You are recommended to use fusion viewer if you are familiar with web programing as it give your more flexibility to extend/customize it to meet your need. The document can be found <a href="http://wikihelp.autodesk.com/Infr._Map_Server/enu/2013/Help/0005-Develope0/0094-Flexible94">here</a> and this <a href="http://download.autodesk.com/media/adn/FusionIntroductionDevTV.zip">DevTV</a> may also be helpful for you. Furthermore, all source code of fusion viewer is released with the product, you can dig into the source code if some APIs are not documented. Now please check out the <a href="http://adndevblog.typepad.com/en_aims_api_chapter_2.pdf">chapter 2</a> of training materials. The code sample of solution2 can be downloaded <a href="http://download.autodesk.com/media/adn/AIMS_Sample_DevTV_Solution_5_6/MapGuideSamples2012.zip">here</a>.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: How Green and Sustainable is my Civil 3D Infrastructure project?
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: how-green-and-sustainable-is-my-civil-3d-infrastructure-project
CATEGORY: .NET
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/04/how-green-and-sustainable-is-my-civil-3d-infrastructure-project.html 
DATE: 04/01/2013 02:30:00 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>This new
release of CIVIL 3D has a brand new API to evaluate how green and sustainable
is the new project which you are designing in Civil 3D. This Feature is
available only through .NET API. How do we use this API to evaluate my current
project ? </p>
<p>Here is a c#
code snippet -</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">Editor</span><span style="line-height: 140%;"> ed = </span><span style="color: #2b91af; line-height: 140%;">Application</span><span style="line-height: 140%;">.DocumentManager.MdiActiveDocument.Editor;</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">CivilDocument</span><span style="line-height: 140%;"> cDoc = </span><span style="color: #2b91af; line-height: 140%;">CivilApplication</span><span style="line-height: 140%;">.ActiveDocument;</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">Database</span><span style="line-height: 140%;"> db = </span><span style="color: #2b91af; line-height: 140%;">Application</span><span style="line-height: 140%;">.DocumentManager.MdiActiveDocument.Database;&#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">Transaction</span><span style="line-height: 140%;"> trans = db.TransactionManager.StartTransaction())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">try</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">GreenEvaluate</span><span style="line-height: 140%;"> checkGreenEvl = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">GreenEvaluate</span><span style="line-height: 140%;">();</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// Call GreenEvaluatation to compute the Green factor and</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// Sustainablility factor for the current CivilDocument</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; checkGreenEvl.GreenEvaluatation(cDoc);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// Check the Green factor and Sustainability factor</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nIs this Project Green ? :&quot;</span><span style="line-height: 140%;"> + checkGreenEvl.GreenFactor.ToString());</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nIs this Project Sustainable&#0160; :&quot;</span><span style="line-height: 140%;"> + checkGreenEvl.SustainableFactor.ToString());&#0160; &#0160; &#0160; &#0160;&#0160; </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; trans.Commit();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">catch</span><span style="line-height: 140%;"> (System.</span><span style="color: #2b91af; line-height: 140%;">Exception</span><span style="line-height: 140%;"> ex)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nException: &quot;</span><span style="line-height: 140%;"> + ex.Message);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; }&#0160; &#0160; &#0160;&#0160; </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
<p>&#0160;</p>
<p>
If you have any
questions on this particular API, let&#39;s come back on the <strong>same day</strong>&#0160;&#39;next year&#39; to
discuss about this!</p>
<p>Have a nice day! :)</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Create a Corridor with Civil3D 2014 API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: create-a-corridor-with-civil3d-2014-api
CATEGORY: .NET
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D 2014

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/03/create-a-corridor-with-civil3d-2014-api.html 
DATE: 03/28/2013 12:07:32 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>After the <a href="http://adndevblog.typepad.com/infrastructure/2013/03/corridor-api-2014-new-methods-and-properties.html">quick summary</a> of new Corridor APIs available on Civil 3D 2014, this post show how create a corridor and add a baseline with alignment and profile.</p>  <p>Unlike other previous APIs, like Alignment and Surface, where the Create method was at the class, with Alignment.Create and TinSurface.Create respectively, to create a corridor we need to access the collection under CivilDocument and then call Add method. Like other APIs, this method returns the ObjectId of the newly created Corridor.</p>  <p>The following quick sample demonstrate it. Note that the same idea applies to Baseline – access the collection and call its Add method.</p>  <div style="font-family: ; background: white">   <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">[</font></font><font style="font-size: 8pt"><span><font color="#2b91af">CommandMethod</font></span><font color="#000000">(</font><span><font color="#a31515">&quot;testCreateCorridor&quot;</font></span><font color="#000000">)]</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">public</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span><font color="#0000ff">static</font></span><font color="#000000"> </font><span><font color="#0000ff">void</font></span><font color="#000000"> CmdCreateCorridor()</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">{</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">Database</font></span><font color="#000000"> db = </font><span><font color="#2b91af">Application</font></span><font color="#000000">.DocumentManager.</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; MdiActiveDocument.Database;</font></font></p>    <p style="margin: 0px">     <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000"></font></font></p>   </p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">CivilDocument</font></span><font color="#000000"> civilDoc = </font><span><font color="#2b91af">CivilApplication</font></span><font color="#000000">.ActiveDocument;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">using</font></span><font color="#000000"> (</font><span><font color="#2b91af">Transaction</font></span><font color="#000000"> trans = db.</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; TransactionManager.StartTransaction())</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; {</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// Create a new Corridor</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">ObjectId</font></span><font color="#000000"> newCorridorId = civilDoc.</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; CorridorCollection.Add(</font></font><font style="font-size: 8pt"><span><font color="#a31515">&quot;Corridor 1&quot;</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">Corridor</font></span><font color="#000000"> corridor = trans.GetObject(</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; newCorridorId, </font></font><font style="font-size: 8pt"><span><font color="#2b91af">OpenMode</font></span><font color="#000000">.ForWrite) </font><span><font color="#0000ff">as</font></span><font color="#000000"> </font><span><font color="#2b91af">Corridor</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// Get the first alignment of this drawing</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">ObjectId</font></span><font color="#000000"> alignmentId = civilDoc.GetAlignmentIds()[0];</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">Alignment</font></span><font color="#000000"> alignment = trans.GetObject(</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; alignmentId, </font></font><font style="font-size: 8pt"><span><font color="#2b91af">OpenMode</font></span><font color="#000000">.ForRead) </font><span><font color="#0000ff">as</font></span><font color="#000000"> </font><span><font color="#2b91af">Alignment</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// Get the first profile of this alignment</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">ObjectId</font></span><font color="#000000"> profileId = alignment.GetProfileIds()[0];</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// Create the baseline </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">Baseline</font></span><font color="#000000"> baseline = corridor.Baselines.Add(</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#a31515">&quot;New Baseline&quot;</font></span><font color="#000000">, alignmentId, profileId);</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; }</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">}</font></font></p> </div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Arman
EMAIL: armanprestige@gmail.com
IP: 93.125.49.130
URL: 
DATE: 01/18/2016 08:05:46 AM
Hi. When I tried to use your code, I got this:

"Cannot convert type 'Autodesk.AutoCAD.DatabaseServices.DBObject' to 'Autodesk.Civil.DatabaseServices.Corridor' via a reference conversion, boxing conversion, unboxing conversion, wrapping conversion, or null type conversion"

Can you help me, please? Thank you so much.

-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 187.106.223.147
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 01/18/2016 08:10:19 AM
Hi Arman,

Not sure where it's failing for you... this code is quite simple and should work, so the problem may be on a different part of your code. Can you provide more details?

Regards,
Augusto Goncalves
-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Corridor API 2014: new methods and properties
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: corridor-api-2014-new-methods-and-properties
CATEGORY: .NET
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D 2014

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/03/corridor-api-2014-new-methods-and-properties.html 
DATE: 03/27/2013 01:44:06 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>As mentioned on our previous post on <a href="http://adndevblog.typepad.com/infrastructure/2013/03/whats-new-in-autocad-civil-3d-2014-api.html">What’s New</a>, now we can create and modify Corridor and its components, like Baselines, BaselineRegions, Assemblies and Subassemblies.</p>  <p>As several developers create reports based on the API, this post show some of the new methods and properties available:</p>  <ul>   <li>Corridor</li>    <ul>     <li>GetLinkPoints, GetPointCodes, GetShapeCode, RegionLockMode, SlopePatterns</li>   </ul>    <li>Baselines</li>    <ul>     <li>SetAlignmentAndProfile</li>   </ul>    <li>BaselineRegion</li>    <ul>     <li>AppliedAssemblySetting, GetOverriddenStations, Match, Merge, RemoveOverriddenStation, Split</li>   </ul>    <li>Assembly</li>    <ul>     <li>CodeSetStyleId, CodeSetStyleName, Groups, Location, OffsetAssemblies, Type (AssemblyType), AddSubassembly, CopySubassembly, Insert/Mirror/Replace Subassembly</li>   </ul>    <li>Subassembly</li>    <ul>     <li>PointIndexHookTo, OffsetAssemblyName</li>   </ul>    <li>Collection with ability to iterate, add/import and remove:</li>    <ul>     <li>BaselineCollection</li>      <li>BaselineRegionCollection</li>      <li>SubassemblyCollection</li>      <li>AssemblyCollection</li>   </ul> </ul>  <p>Some methods are now deprecate, when you build with the new references, a warning message should appear at the compiler output.</p>  <p>Hope this help you get a feel of the big improvements we did on this release. Next we’ll show some code samples. Stay tuned.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: What's new in AUTOCAD CIVIL 3D 2014 API?
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: whats-new-in-autocad-civil-3d-2014-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2014
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/03/whats-new-in-autocad-civil-3d-2014-api.html 
DATE: 03/27/2013 01:32:43 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>Along with
the <a href="http://www.autodesk.com/">new look</a>, AUTOCAD CIVIL 3D 2014 adds
some important .NET API to Corridors and it&#39;s constituents like Assembly,
Subassembly, BaseLines.</p>
<p>Now, we can add /
create <strong>Corridor</strong> using
<span style="color: #00407f;"><strong>Autodesk.Civil.DatabaseServices.CorridorCollection.Add(</strong>string corridorName<strong>)</strong></span> and
its overloaded methods.</p>
<p>We can
access/add/remove Baselines using the <span style="color: #00407f;">BaselineCollection</span> class as well as
modify Baseline properties.&#0160;</p>
<p>We can add
and remove a Subassembly as well as Import a Stock Subassembly
<span style="color: #00407f;">(ImportStockSubassembly()</span>) or Subassembly (<span style="color: #00407f;">ImportSubassembly()</span>) from an ATC
file.&#0160;</p>
<p>We can Add
Assembly and ImportAssembly as well.&#0160;</p>
<p>Apart from
Corridor, other API enhancements include features like Section View Groups,
SectionView, Sections etc.&#0160;</p>
<p>For all the
details on what&#39;s new in AUTOCAD CIVIL 3D 2014 .NET API, I would suggest you to
take a look into Civil 3D 2014 wikihelp&#39;s &quot;<strong><a href="http://wikihelp.autodesk.com/AutoCAD_Civil_3D/enu/2014/Help/API_Developer&#39;s_Guide/0001-About_th1/0005-New_Feat5">New
Features in the .NET API</a></strong>&quot; section.&#0160;</p>
<p>&#0160;</p>
<p>If you are
using <strong>COM API</strong>, please note the following update - </p>
<p>If you are
using the COM API, you need to <strong>update</strong> the object version to <span style="background-color: #ffff00;"><strong>10.3</strong></span> (from 10.0
used in AutoCAD Civil 3D 2013). The objects and interfaces exposed have
remained the same, but you should reference the new libraries, which are
installed by default to: &quot;C:\Program Files\Common Files\Autodesk
Shared\Civil Engineering 103&quot;. </p>
<p>&#0160;</p>
<p>Stay tuned for more
articles covering new API features in the coming days!</p>
<p>&#0160;</p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017c382349a7970b-pi" style="display: inline;">
</a><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017ee9c6716d970d-pi" style="display: inline;"><img alt="Autodesk-logo-rgb-color-logo-black-text-large" class="asset  asset-image at-xid-6a0167607c2431970b017ee9c6716d970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017ee9c6716d970d-320wi" title="Autodesk-logo-rgb-color-logo-black-text-large" /></a><br /><br /><br /></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: RasmusB
EMAIL: rfb@focus.no
IP: 46.9.227.216
URL: 
DATE: 04/13/2013 01:37:05 AM
Hi Partha,
Thanks for the update! It is quite troublesome to expose to the user, in the Toolpalette, assemblies and subassemblies that are stored in atc-files (and has associated dlls). It would be great if much of that work could be handled by the API. Initially I thought/hoped that the new importsubassembly/assembly-functionality would handle this, but having looked into it more in-depth, I understand that this is not the case? The new functionality just mimics what is done when the user selects an assembly or subassembly from the Toolpalette and put it into the drawing? (In my case though, Civil handles this for me since I already have my assemblies in the Toolpalette)
-----
COMMENT:
AUTHOR: Veli V.
EMAIL: veli.vaisanen@cad-q.fi
IP: 212.116.37.26
URL: 
DATE: 08/02/2013 01:27:01 AM
Hi,
why Visual Studio 2010 doesn´t show COM references:
 - AeccXLandLib
 - AeccXPipeLib
 - AeccXUILandLib

I select them one by one from "C:\Program Files\Common Files\Autodesk Shared\Civil Engineering 103" folder. Is there some COM registration proglem or something like that?

Cheers
Veli V.
-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 59.92.222.171
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 08/02/2013 02:31:28 AM
Hi Veli,

This is answered here :) 

http://adndevblog.typepad.com/infrastructure/2012/04/com-references-on-civil-3d-2013.html

HTH,
Partha 


-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: AutoCAD Map 3D API Training content: Part-4
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: autocad-map-3d-api-training-content-part-4
CATEGORY: .NET
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: FDO
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/03/autocad-map-3d-api-training-content-part-4.html 
DATE: 03/25/2013 03:18:47 AM
-----
BODY:
<p>By&#0160;<a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha
Sarkar</a></p>
<p>This is in continuation of my&#0160;earlier posts on <strong>AutoCAD Map 3D API Training content</strong>:&#0160;<a href="http://adndevblog.typepad.com/infrastructure/2013/02/autocad-map-3d-api-training-content-part-1.html">Part-1</a>&#0160;,&#0160;<a href="http://adndevblog.typepad.com/infrastructure/2013/03/autocad-map-3d-api-training-content-part-2.html">Part 2</a>&#0160;&amp; <a href="http://adndevblog.typepad.com/infrastructure/2013/03/autocad-map-3d-api-training-content-part-3.html">Part-3</a>
. In
this post I am going to share some insights of “Feature Service” in Geospatial
Platform API used by Map 3D and AIMS.&#0160;</p>
<p>The <strong>Feature Service</strong>
provides a data source agnostic API for the storage and retrieval
of feature data. We can use Feature Service API to determine which storage
technologies are available and their capabilities. For example, an Oracle
Spatial database will have more capabilities than an ODBC connection. Some
feature sources can have multiple schemas. Access to the data storage
technology is modeled as a connection. For example, you can connect to a file
and do simple insertions or connect to a relational database and do
transaction-based operations.</p>
<p>&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="font-size: 10pt;"><span style="color: blue; line-height: 140%;">public</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">class</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">AcMapFeatureService</span><span style="line-height: 140%;"> : </span><span style="color: #2b91af; line-height: 140%;">MgFeatureService&#0160;</span></span><span style="font-family: Arial, sans-serif; font-size: small;">is
part of <span style="color: #40a0ff;"><strong>Autodesk.Gis.Map.Platform</strong></span> namespace. Using <span style="color: #40a0ff;">AcMapServiceFactory.GetService()</span> method and by specifying the correct <strong><span style="color: #40a0ff;">MgServiceType</span></strong>[.</span><span style="color: #8080ff;"><em style="font-family: Arial, sans-serif; font-size: small;">FeatureService</em></span><span style="font-family: Arial, sans-serif; font-size: small;">] we
access AcMapFeatureService like the following code
snippet - </span><strong style="font-family: Arial, sans-serif; font-size: small;">&#0160;</strong></p>
<p style="margin: 0px;"><strong style="font-family: Arial, sans-serif; font-size: small;"><br /></strong></p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">static</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">AcMapFeatureService</span><span style="line-height: 140%;"> fs = </span><span style="color: #2b91af; line-height: 140%;">AcMapServiceFactory</span><span style="line-height: 140%;">.GetService(</span><span style="color: #2b91af; line-height: 140%;">MgServiceType</span><span style="line-height: 140%;">.FeatureService)&#0160; </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">AcMapFeatureService</span><span style="line-height: 140%;">;</span></p>
</div>
</div>
<p>The base <strong>MgFeatureService</strong> has very useful method to create / update / manipulate features
(FDO Features) in a particular data store. Some of the useful methods of MgFeatureService are -</p>
<p>&#0160;</p>
<p>Connection to a datastore. <span style="color: #4040ff;">MgFeatureService::GetFeatureProviders, MgFeatureService::GetConnectionPropertyValues, MgFeatureService::TestConnection
Method (CREFSTRING, CREFSTRING) , and MgFeatureService::TestConnection Method (MgResourceIdentifier*)</span> </p>
<p>Description of the capabilities of the FDO provider providing
access to the datastore.&#0160; <span style="color: #4040ff;">MgFeatureService::GetProviderCapabilities.</span></p>
<p>Insertion, deletion and update of feature data. <span style="color: #4040ff;">MgFeatureService::UpdateFeatures,
MgInsertFeatures, MgDeleteFeatures, and MgUpdateFeatures.</span></p>
<p>Selection of feature data. <span style="color: #4040ff;">MgFeatureService::SelectFeatures and MgFeatureService::SelectAggregate</span>.</p>
<p>Description of the schema used to store feature data.<span style="color: #4040ff;"> MgFeatureService::DescribeSchema,
MgFeatureService::DescribeSchemaAsXml, MgFeatureService::GetSchemas,
MgFeatureService::SchemaToXml, MgFeatureService::GetClasses and
MgFeatureService::GetClassDefinition</span>.</p>
<p>Creation of an SDF feature source to cache feature data from
other datastores.&#0160; <span style="color: #4040ff;">MgFeatureService::CreateFeatureSource</span>. Using the latter
requires describing the schema in the source datastore. Transporting the
features from the source datastore requires selecting them from the source and
inserting them in the target.</p>
<p>Execute SQL commands. <span style="color: #4040ff;">MgFeatureService::ExecuteSqlNonQuery
and MgFeatureService::ExecuteSqlQuery</span>.</p>
<p>Get
the spatial contexts contained in the datastore. <span style="color: #4040ff;">MgFeatureService::GetSpatialContexts</span>.&#0160;</p>
<p>&#0160;</p>
<p>Some of the previous blog posts show how to create / insert /
update / manipulate Feature Data in FDO data store - </p>
<p><a href="http://adndevblog.typepad.com/infrastructure/2012/05/how-to-create-fdo-feature-using-geospatial-platform-api-in-map-3d.html">How
to create FDO Feature using Geospatial Platform API in Map 3D?</a></p>
<p><a href="http://adndevblog.typepad.com/infrastructure/2012/05/read-fdo-features-using-map-3d-geospatial-platform-api.html">Read
FDO Features using Map 3D Geospatial Platform API</a></p>
<p><a href="http://adndevblog.typepad.com/infrastructure/2012/10/read-fdo-geometry-area-using-map-3d-geospatial-platform-api.html">Read
FDO Geometry Area using Map 3D Geospatial Platform API</a></p>
<p><a href="http://adndevblog.typepad.com/infrastructure/2012/05/how-to-modify-update-feature-attribute-using-api-in-map-3d.html">How
to modify / update Feature attribute using API in Map 3D?</a></p>
<p><a href="http://adndevblog.typepad.com/infrastructure/2012/08/using-fdo-api-to-select-features-from-fdo-data-source.html">Using
FDO API to select Features from FDO Data Source</a></p>
<p><a href="http://adndevblog.typepad.com/infrastructure/2012/07/selecting-fdo-features-inside-a-given-boundary-polygon.html">Selecting
FDO Features inside a given boundary (Polygon)</a></p>
<p><a href="http://adndevblog.typepad.com/infrastructure/2013/03/manipulate-non-feature-class-with-geospatial-platform-api-in-map-3d.html">Manipulate
non-feature class with Geospatial Platform API in Map 3D</a></p>
<p>&#0160;</p>
<p>AcMapFeatureService class also has a useful
set of FeatureService Events which occur when feature-related actions, such as
deletion, insertion or update are initiated, concluded or cancelled -</p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017d42460a4a970c-pi" style="display: inline;">
</a><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017ee9ba09ce970d-pi" style="display: inline;"><img alt="FS_events" class="asset  asset-image at-xid-6a0167607c2431970b017ee9ba09ce970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017ee9ba09ce970d-320wi" title="FS_events" /></a><br /><br /><br /></p>
<p>Attached&#0160;
<span class="asset  asset-generic at-xid-6a0167607c2431970b017c3816dee1970b"><a href="http://adndevblog.typepad.com/files/chapter-4.pdf">Chapter 4</a></span>&#0160;will help
you to understand working with &#39; FeatureService&#39; and associated APIs which you
would require in your application development using Geospatial Platform API and
AutoCAD Map 3D.</p>
<p>&#0160;</p>
I
hope this is useful to you!
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Gopinath Taget
AUTHOR EMAIL: gopinath.taget@autodesk.com
TITLE: Map 3D Samples: Annotation Sample
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: map-3d-samples-annotation-sample
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: C++
CATEGORY: Gopinath Taget

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/03/map-3d-samples-annotation-sample.html 
DATE: 03/22/2013 06:31:59 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/gopinath-taget.html">Gopinath Taget</a></p>  <p>I am in the reviewing Map 3D SDK samples and making sure that they work as they are documented to be. <a href="http://adndevblog.typepad.com/infrastructure/MapSamples/Annotation.zip">Here</a> is the first sample I am worked on that I modified and tested to be working in Map 3D 2013: The Annotation Sample (MapSDK\Map Samples\Annotation).</p>  <p>This sample makes use of 'AcMapAnnotationManager' class to    <br />customize the Annotation template functionality. How it works:</p>  <p><font color="#4f81bd">Load this arx application in Map.     <br />-&#160;&#160;&#160; Open any drawing file with OD data       <br />&#160;&#160;&#160; (This sample shows how to apply the OD field values       <br />&#160;&#160;&#160; as labels. Or just use attached TestAnno.dwg)      <br />-&#160;&#160;&#160; Run the command 'ANNOAPI'      <br />-&#160;&#160;&#160; Enter annotation template name      <br />-&#160;&#160;&#160; Select the OD table name from the       <br />&#160;&#160;&#160; 'Select OD Table' list box      <br />-&#160;&#160;&#160; Select one or more column names from       <br />&#160;&#160;&#160; 'Select Column Names' list box      <br />-&#160;&#160;&#160; Unless user completes the above three steps       <br />&#160;&#160;&#160; 'Create New' will not be enabled.      <br />-&#160;&#160;&#160; Once 'Create New' button is enabled, click on       <br />&#160;&#160;&#160; this button to create the new annotation template      <br />-&#160;&#160;&#160; If you want to show some descriptive text       <br />&#160;&#160;&#160; along with actual value (label) click on       <br />&#160;&#160;&#160; 'Show Field Names'. This will show the Field       <br />&#160;&#160;&#160; Name along with Filed Value      <br />-&#160;&#160;&#160; If the annotation template creation succeeds it also updates the       <br />&#160;&#160;&#160; 'Templates currently defined:' list box.      <br />&#160;&#160;&#160; <br />-&#160;&#160;&#160; Select the Template name from the 'Template currently       <br />&#160;&#160;&#160; defined' list box and click on      <br />&#160;&#160;&#160; - 'Remove' if you want to remove the annotation template       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Remove will succeed only if there are no references       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; of this template in the drawing      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160; - 'Show Info' if you want to see all the information       <br />&#160;&#160;&#160;&#160;&#160;&#160; pertaining to the annotation template.      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; This includes the Attribute static or expression       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; values such as Layer, Color, LineWeight, Style,      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; Height, Rotation, Justification, Attribute Tag       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; and Attribute Value.      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160; - 'Insert Annotation (OD)': To insert the annotation       <br />&#160;&#160;&#160;&#160;&#160; text on the selected objects.      <br />&#160;&#160;&#160; <br />&#160;&#160;&#160; - 'Insert using Override': This is same as 'Insert       <br />&#160;&#160;&#160;&#160;&#160; Annotation (OD)' except that it creates the annotation       <br />&#160;&#160;&#160;&#160;&#160; text with values defined in 'AnnotationOverrides'      <br />&#160;&#160;&#160;&#160;&#160; instead the values which are set during the       <br />&#160;&#160;&#160;&#160;&#160; 'AcMapAnnotationManager::CreateAnnotationText' </font></p>  <p>Questions welcome!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: AutoCAD Map 3D API Training content: Part-3
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: autocad-map-3d-api-training-content-part-3
CATEGORY: .NET
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: FDO
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/03/autocad-map-3d-api-training-content-part-3.html 
DATE: 03/21/2013 02:00:35 AM
-----
BODY:
<p>By&#0160;<a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha
Sarkar</a></p>
<p>This
is in continuation of my&#0160;earlier two
posts - <strong>AutoCAD Map 3D API Training
content</strong>: <a href="http://adndevblog.typepad.com/infrastructure/2013/02/autocad-map-3d-api-training-content-part-1.html">Part-1</a>
&amp; <a href="http://adndevblog.typepad.com/infrastructure/2013/03/autocad-map-3d-api-training-content-part-2.html">Part
2</a> . In this post I am going to introduce you to FDO API.&#0160;</p>
<p>Feature
Data Object (in short FDO) is essentially a Data Access Technology which is
based on a set of APIs used for storing, managing, and updating GIS /
Geospatial data regardless of where it is stored. FDO uses a provider-based model for
supporting a variety of geospatial data sources, where each provider typically
supports a particular data format or data store. FDO is <strong><a href="http://fdo.osgeo.org/">open
source</a></strong> software licensed under the <a href="http://fdo.osgeo.org/lgpl.html">LGPL</a>.</p>
<p>FDO provides a model for extending API interface to
additional data source technologies. The generic API is extensible and it is
possible to add custom commands to a particular provider. A FDO provider is a specific
implementation of the FDO API that provides access to date stored in a
particular data source technology. For example, the MySQL provider provides
access to <a class="zem_slink" href="http://en.wikipedia.org/wiki/Geographic_information_system" rel="wikipedia" target="_blank" title="Geographic information system">GIS data</a> stored in a MySQL database and the OSGeo FDO Provider for
SHP provides access to GIS data stored in a SHP file. The extent to which a
provider implements the FDO API is limited by the native capabilities of the
underlying data source technology.</p>
<p>A client application creates a connection to a provider
and then uses the connection object to create command objects for FDO actions
such as Select. The client uses the command object to set the command
parameters with the option of leaving some parameters with default values.
Where appropriate such as in the case of Select, execution of the command returns
a reader object containing the results of the command.</p>
<p>A client application can use the FDO Capabilities API to
determine what services a particular provider offers. For example, the OSGeo
FDO Provider for SDF supports the insertion of data, and the OSGeo FDO Provider
for WMS does not.</p>
<p>Comprehensive documentation on FDO Data Access Technology
is available at <strong><a href="http://fdo.osgeo.org/documentation.html">FDO OSGeo</a></strong> site as well
as Autodesk <a href="http://wikihelp.autodesk.com/AutoCAD_Map_3D/enu/2013/Help/0005-FDO_Deve0">WikiHelp</a>
page. There is a “<strong><a href="http://wikihelp.autodesk.com/AutoCAD_Map_3D/enu/2013/Help/0004-The_Esse0/0001-The_Esse1/0012-Getting_12">Getting
Started</a></strong>” chapter in “The Essential FDO” wikihelp page which will help
you to jump start using FDO API. “<a href="http://wikihelp.autodesk.com/AutoCAD_Map_3D/enu/2013/Help/0005-FDO_Deve0/0014-Developm14">Development
Practices</a>” and “<a href="http://wikihelp.autodesk.com/AutoCAD_Map_3D/enu/2013/Help/0005-FDO_Deve0/0078-FDO_Cook78">FDO
Cookbook</a>” are other two valuable chapters I would recommend to go through
if you plan to create a custom FDO provider.</p>
<p>This <span class="asset  asset-generic at-xid-6a0167607c2431970b017c37f973b0970b"><a href="http://adndevblog.typepad.com/files/chapter-3.pdf">Chapter 3</a></span>&#0160;will help
you to understand working with &#39;<strong>FDO
API</strong>&#39; and application development using Geospatial Platform API
for AutoCAD Map 3D and AIMS.</p>
<p>&#0160;</p>
<p>I hope this is useful to you!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Autodesk Infrastructure Map Server(AIMS) API Training content : Part-1
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: autodesk-infrastructure-map-serveraims-api-training-content-part-1
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: Daniel Du
CATEGORY: MapGuide Enterprise 2011

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/03/autodesk-infrastructure-map-serveraims-api-training-content-part-1.html 
DATE: 03/19/2013 03:33:27 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>
<p>Autodesk<sup>®</sup> Infrastructure Map Server is a software platform for distributing spatial data over the Internet or on an intranet. In this chapter, you will know the features of AMIS, understand the architecture and different components of Map Server.</p>
<p>Infrastructure Map Server consists of numerous separate components, including:    <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Autodesk<sup>®</sup> Infrastructure Map Server     <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Autodesk<sup>®</sup> Infrastructure Web Server Extension (for application development)     <br />&#0160;&#0160;&#0160;&#0160;&#0160; Autodesk<sup>®</sup> Infrastructure Studio (for map authoring)     <br />&#0160;&#0160;&#0160;&#0160;&#0160; Autodesk<sup>®</sup> Infrastructure Application Extension (works with Oracle/SQL Server)     <br />&#0160;&#0160;&#0160;&#0160;&#0160; Autodesk<sup>®</sup> Infrastructure Administrator&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160; Autodesk<sup>®</sup> Infrastructure Mobile Viewer Extension     <br />&#0160;&#0160;&#0160;&#0160;&#0160; Autodesk<sup>®</sup> Infrastructure GeoREST Extension </p>
<p>Infrastructure Studio and the Infrastructure Map Server viewers are client applications of Infrastructure Map Server. Requests coming from these clients, and from the other client applications that you develop using the API, go to the Web Server Extension by means of HTTP protocol. The WebAgent component of the Web Server Extension processes the requests and forwards them on to Infrastructure Map Server. When it receives a request, Infrastructure Map Server accesses the resources stored in the resource repository, builds and renders the map as a static image for the viewer, and returns it to the Web Extensions, which in turn send it back to the client.</p>
<p>Autodesk<sup>®</sup> Infrastructure Studio is an authoring environment that handles all aspects of collecting and preparing geospatial data for distribution on the Internet (except custom coding). You need to organize your data first before development. </p>
<p>Autodesk Infrastructure Map Server <a href="http://wikihelp.autodesk.com/Infr._Map_Server/enu/2013">Wikihelp</a> contains very useful document, please do check it out. In a series of blog posts in the coming days / months you will see most of the Infrastructure Map Server API training content (PDF) will be published here . This is <a href="http://adndevblog.typepad.com/files/en_aims_api_chapter_1.pdf" target="_self">chapter1</a>, hope it helpful for you. All of our sample code has be posted <a href="http://adndevblog.typepad.com/infrastructure/2012/05/devtv-and-code-sample-create-temporary-layer-feature-editing-in-aims2012.html">here</a>.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: TinSurfaceTriangle and its vertices direction in AutoCAD Civil 3D
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: tinsurfacetriangle-and-its-vertices-direction-in-autocad-civil-3d
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2012
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/03/tinsurfacetriangle-and-its-vertices-direction-in-autocad-civil-3d.html 
DATE: 03/19/2013 01:54:49 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>Recently I
was working on a project and I had to use <strong>TinSurfaceTriangle</strong> object
to access the Surface triangle vertices. You might be knowing already that <strong>TinSurfaceTriangle
</strong>class encapsulates a triangle in a TinSurface in AutoCAD Civil 3D.
TinSurfaceTriangle type exposes the following members - </p>
<p>&#0160;<strong>Vertex1</strong> - &gt; Gets the first vertex in the
triangle.&#0160; </p>
<p>&#0160;<strong>Vertex2</strong> - &gt; Gets the second vertex in the
triangle.&#0160; </p>
<p>&#0160;<strong>Vertex3</strong> - &gt; Gets the third vertex in the
triangle.</p>
<p>&#0160;</p>
<p>One question
came up during our discussion - in which direction (clock-wise or
anti-clockwise) these vertex points are counted. So, to figure out that I did a
quick test to iterate through the vertices and see which direction they are
returned by Civil 3D API. Here is the result which shows us the direction :</p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017ee989560c970d-pi" style="display: inline;"><img alt="SurfaceTriangle_Direction" class="asset  asset-image at-xid-6a0167607c2431970b017ee989560c970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017ee989560c970d-500wi" title="SurfaceTriangle_Direction" /></a><br /><br /></p>
<p>&#0160;</p>
<p>And the C# .NET code snippet I used :</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">Transaction</span><span style="line-height: 140%;"> trans = db.TransactionManager.StartTransaction())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">TinSurface</span><span style="line-height: 140%;"> surface = trans.GetObject(surfaceId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForRead) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">TinSurface</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">TinSurfaceTriangleCollection</span><span style="line-height: 140%;"> tinSurfTrianglColl = surface.GetTriangles(</span><span style="color: blue; line-height: 140%;">true</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (tinSurfTrianglColl.Count &gt; 0)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">foreach</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">TinSurfaceTriangle</span><span style="line-height: 140%;"> tinsurfTriangle </span><span style="color: blue; line-height: 140%;">in</span><span style="line-height: 140%;"> tinSurfTrianglColl)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: green; line-height: 140%;">// Vertex1</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">Point3d</span><span style="line-height: 140%;"> pnt3d = tinsurfTriangle.Vertex1.Location;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\n Vertex1 ::&#0160; X1 : &quot;</span><span style="line-height: 140%;"> + pnt3d.X.ToString() +</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: #a31515; line-height: 140%;">&quot;&#0160; Y1 : &quot;</span><span style="line-height: 140%;"> + pnt3d.Y.ToString() +</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: #a31515; line-height: 140%;">&quot;&#0160; Z1 : &quot;</span><span style="line-height: 140%;"> + pnt3d.Z.ToString());</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: green; line-height: 140%;">// Vertex2</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; pnt3d = tinsurfTriangle.Vertex2.Location;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\n Vertex2 ::&#0160; X1 : &quot;</span><span style="line-height: 140%;"> + pnt3d.X.ToString() +</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: #a31515; line-height: 140%;">&quot;&#0160; Y1 : &quot;</span><span style="line-height: 140%;"> + pnt3d.Y.ToString() +</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: #a31515; line-height: 140%;">&quot;&#0160; Z1 : &quot;</span><span style="line-height: 140%;"> + pnt3d.Z.ToString());</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: green; line-height: 140%;">// Vertex3</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; pnt3d = tinsurfTriangle.Vertex3.Location;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\n Vertex3 ::&#0160; X1 : &quot;</span><span style="line-height: 140%;"> + pnt3d.X.ToString() +</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: #a31515; line-height: 140%;">&quot;&#0160; Y1 : &quot;</span><span style="line-height: 140%;"> + pnt3d.Y.ToString() +</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: #a31515; line-height: 140%;">&quot;&#0160; Z1 : &quot;</span><span style="line-height: 140%;"> + pnt3d.Z.ToString());</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; }</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; }</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; trans.Commit();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
<p>&#0160;</p>
<p>Hope this is
useful to you!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Data sharing between AutoCAD Civil 3D and HTML5 application
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: data-sharing-between-autocad-civil-3d-and-html5-application
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2012
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Cloud
CATEGORY: HTML5
CATEGORY: Mobile
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/03/data-sharing-between-autocad-civil-3d-and-html5-application.html 
DATE: 03/13/2013 01:33:00 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>In the
process of exploring HTML5 canvas and draw geometries, I thought how about
‘creating a HTML5 application to show a Civil 3D Pipe Network geometry’.&#0160; </p>
<p>With this
goal in mind, I first approached to create a simple Civil 3D .NET application to
select a Pipe, get the Pipe Network and export the Pipe coordinates from the
selected network to an external file (TXT file). We can use the following Civil
3D .NET API to get the Pipe’s start and end points –</p>
<p><strong>Pipe.StartPoint</strong>
</p>
<p><strong>Pipe.EndPoint</strong></p>
<p>So, the first
part was easy to create a TXT file and store all the StartPoint and EndPoint of
the Pipes in a selected Pipe Network.</p>
<p>In the second
part, I wanted to read the TXT file with Pipe Geometry from Civil 3D. I found
the <a href="http://www.w3.org/TR/FileAPI/">FileReader</a>
in HTML5 which provides an API to select files and access their data.</p>
<p>After
accessing the data, I had to parse it and create an array in JavaScript. In the
next part, it was easy to get the HTML5 canvas and the context and loop through
the array storing the pipe network vertices and create line using HTML5 <strong>context.lineTo()</strong>
API</p>
<p><span style="font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 10px;">&#0160;if (cleanlineVertices.length &gt; 3)</span></p>
<pre>{<br />	context.beginPath();<br />	context.moveTo(cleanlineVertices[0], cleanlineVertices[1]);<br />	for (var i = 2; i &lt; (cleanlineVertices.length - 1); i+=2)<br />	{		<br />	 context.lineTo(cleanlineVertices[i], cleanlineVertices[i+1]);	<br />	}<br />		<br />	// Set Line width<br />	context.lineWidth = 5;<br />		<br />	// Set Line color<br />	context.strokeStyle = &#39;#fa00ff&#39;;<br />	context.stroke();<br />}</pre>
<p>&#0160;</p>
<p>In this video
you will see the workflow and a quick demo of this application.</p>
<p><iframe frameborder="0" height="281" src="http://www.youtube.com/embed/Lb62LTNfXSI?feature=oembed" width="500"></iframe>&#0160;</p>
So, we can share data from AutoCAD Civil 3D and a HTML5 can show us the
geometry in the actual project site and all the stakeholders can verify if the
network is passing through the desired location &#0160;:) !
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Manipulate non-feature class with Geospatial Platform API in Map 3D
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: manipulate-non-feature-class-with-geospatial-platform-api-in-map-3d
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Daniel Du
CATEGORY: FDO

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/03/manipulate-non-feature-class-with-geospatial-platform-api-in-map-3d.html 
DATE: 03/12/2013 01:23:09 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>Firstly what is feature class and non-feature class? Generally speaking, a Feature Class is a class with associated geometry, so that it is possible to create a layer in Map 3D or AIMS. A non-feature class just contains non-spatial data that can be used as a standalone or contained class has not geometry field. Geospatial Plat for API, which uses FDO, can manipulate both feature class and non feature class.</p>  <p>let’s say we have a feature schema as below, which is a SDF data source, there are two classes in the schema, one is feature class with Geometry field, another is non-feature class, just attribute fields.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017c37939c4a970b-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017c37939c9b970b-pi" width="484" height="430" /></a></p>  <p>&#160;</p>  <p>If you connect to this data source in Map 3D, you will notice that the non-feature class is gray out as it cannot be added to map as layer.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017c37939cbd970b-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017ee936c8b4970d-pi" width="499" height="392" /></a></p>  <p>&#160;</p>  <p>Now let’s add some data into this non-feature class with Geospatial platform API. The important thing is to get the resource identifier of the data source, since it is connected to Map 3D and add a layer, I use following code to demo how to get the resource ID:</p>  <pre style="line-height: normal; font-family: ; background: white; color: "><font face="新宋体"><font color="#000000"><font style="font-size: 7.8pt">[</font></font><font style="font-size: 7.8pt"><span style="color: "><font color="#2b91af">CommandMethod</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;InsertNonFeatureClass&quot;</font></span><font color="#000000">)]</font><br /><span style="color: "><font color="#0000ff">public</font></span><font color="#000000">&#160;</font><span style="color: "><font color="#0000ff">void</font></span></font></font><font style="font-size: 7.8pt"><font face="新宋体"><font color="#000000"> InsertNonFeatureClass()<br />{<br />&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">const</font></span><font color="#000000">&#160;</font><span style="color: "><font color="#0000ff">string</font></span><font color="#000000"> LAYERNAME = </font><span style="color: "><font color="#a31515">&quot;River&quot;</font></span></font><font face="新宋体"><font color="#000000">;<br />&#160;&#160;&#160; </font><span style="color: "><font color="#2b91af">MgFeatureService</font></span><font color="#000000"> featuerSvc = </font><span style="color: "><font color="#2b91af">AcMapServiceFactory</font></span><br /><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; .GetService(</font><span style="color: "><font color="#2b91af">MgServiceType</font></span></font><font face="新宋体"><font color="#000000">.FeatureService) <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">as</font></span><font color="#000000">&#160;</font><span style="color: "><font color="#2b91af">MgFeatureService</font></span></font><font face="新宋体"><font color="#000000">;<br /> <br />&#160;&#160;&#160; </font><span style="color: "><font color="#008000">//This is just for demonstration of the format of FeatureSourceId</font></span><br /><font color="#000000">&#160;&#160;&#160; </font><span style="color: "><font color="#2b91af">AcMapMap</font></span><font color="#000000"> currentMap = </font><span style="color: "><font color="#2b91af">AcMapMap</font></span></font><font face="新宋体"><font color="#000000">.GetCurrentMap();<br />&#160;&#160;&#160; </font><span style="color: "><font color="#2b91af">MgLayerBase</font></span><font color="#000000"> layer = </font><span style="color: "><font color="#0000ff">null</font></span></font><font face="新宋体"><font color="#000000">;<br />&#160;&#160;&#160; </font><span style="color: "><font color="#2b91af">MgLayerCollection</font></span></font><font face="新宋体"><font color="#000000"> allLayers = currentMap.GetLayers();<br />&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">foreach</font></span><font color="#000000"> (</font><span style="color: "><font color="#2b91af">MgLayerBase</font></span><font color="#000000"> lyr </font><span style="color: "><font color="#0000ff">in</font></span></font><font face="新宋体"><font color="#000000"> allLayers)<br />&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">if</font></span></font><font face="新宋体"><font color="#000000"> (lyr.Name == LAYERNAME)<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; layer = lyr;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">break</font></span></font><font face="新宋体"><font color="#000000">;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br />&#160;&#160;&#160; }<br />&#160;&#160;&#160; </font><span style="color: "><font color="#008000">//Just to demonstrate the format of FeatureSource</font></span><br /><font color="#000000">&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">string</font></span></font><font face="新宋体"><font color="#000000"> resId = layer.FeatureSourceId;<br />&#160;&#160;&#160; System.Windows.Forms.</font><span style="color: "><font color="#2b91af">MessageBox</font></span></font><font face="新宋体"><font color="#000000">.Show(resId);<br /> <br />&#160;&#160;&#160; </font><span style="color: "><font color="#008000">//---------------------------</font></span><br /><font color="#000000">&#160;&#160;&#160; </font><span style="color: "><font color="#008000">//Library://River.FeatureSource</font></span><br /><font color="#000000">&#160;&#160;&#160; </font><span style="color: "><font color="#008000">//---------------------------</font></span><br /><font color="#000000">&#160;&#160;&#160; </font><span style="color: "><font color="#008000">//OK&#160;&#160; </font></span><br /><font color="#000000">&#160;&#160;&#160; </font><span style="color: "><font color="#008000">//---------------------------</font></span><br /></font><font face="新宋体"><font color="#000000"> <br /> <br /> <br /> <br />&#160;&#160;&#160; </font><span style="color: "><font color="#008000">// Insert into non-feature class</font></span><br /><font color="#000000">&#160;&#160;&#160; </font><span style="color: "><font color="#2b91af">MgResourceIdentifier</font></span><font color="#000000"> featureSourceId = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000">&#160;</font><span style="color: "><font color="#2b91af">MgResourceIdentifier</font></span></font><font face="新宋体"><font color="#000000">(resId);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">string</font></span><font color="#000000"> className = </font><span style="color: "><font color="#a31515">&quot;DefaultSchema:RiverAttributes&quot;</font></span><font color="#000000">; </font><span style="color: "><font color="#008000">//feature class name</font></span><br /><font color="#000000">&#160;&#160;&#160; </font><span style="color: "><font color="#2b91af">MgPropertyCollection</font></span><font color="#000000"> properities = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000">&#160;</font><span style="color: "><font color="#2b91af">MgPropertyCollection</font></span></font><font face="新宋体"><font color="#000000">();<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160; </font><span style="color: "><font color="#008000">//ID is auto generated</font></span><br /></font><font face="新宋体"><font color="#000000">&#160;&#160;&#160; properities.Add(<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000">&#160;</font><span style="color: "><font color="#2b91af">MgStringProperty</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;Name&quot;</font></span></font><font face="新宋体"><font color="#000000">, <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#a31515">&quot;Yangzi River&quot;</font></span></font><font face="新宋体"><font color="#000000">));<br />&#160;&#160;&#160; properities.Add(<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000">&#160;</font><span style="color: "><font color="#2b91af">MgStringProperty</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;Desciption&quot;</font></span></font><font face="新宋体"><font color="#000000">, <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#a31515">&quot;The longest river in China&quot;</font></span></font><font face="新宋体"><font color="#000000">));<br />&#160;&#160;&#160; </font><span style="color: "><font color="#2b91af">MgInsertFeatures</font></span></font><font face="新宋体"><font color="#000000"> insFeature = <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000">&#160;</font><span style="color: "><font color="#2b91af">MgInsertFeatures</font></span></font><font face="新宋体"><font color="#000000">(className, properities);<br /> <br />&#160;&#160;&#160; </font><span style="color: "><font color="#2b91af">MgFeatureCommandCollection</font></span><font color="#000000"> commands = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000">&#160;</font><span style="color: "><font color="#2b91af">MgFeatureCommandCollection</font></span></font></font><font face="新宋体"><font style="font-size: 7.8pt"><font color="#000000">();<br />&#160;&#160;&#160; commands.Add(insFeature);<br /> <br />&#160;&#160;&#160; featuerSvc.UpdateFeatures(featureSourceId, commands, </font><span style="color: "><font color="#0000ff">false</font></span><font color="#000000">);<br /> <br />}</font></font></font></pre>

<p>&#160;</p>

<p>here is the result in Data table: </p>

<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017ee936c8cd970d-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017c37939cff970b-pi" width="535" height="119" /></a></p>

<p>&#160;</p>

<p>From the code snippet, it is exactly the same as operating a feature class, with feature service. Actually for a feature class has been added to map as layer, there is a simple way, that is ： 
  <br />&quot;Layer.UpdateFeatures() &quot;</p>

<p>This method actually call underlay feature service to update features. But if you want to update a non-feature class, that does not have a corresponding layer, you have to use the lower lever API - featureService.UpdateFeatures() as demoed in ditto code snippet. Please note that this concept also applies to AIMS as well, The code can be migrated to AIMS with only minor changes. </p>

<p>Hope this helps.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Pipe Network along water drop path
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: pipe-network-along-water-drop-path
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D 2013

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/03/pipe-network-along-water-drop-path.html 
DATE: 03/06/2013 11:04:20 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>In one of my regular Civil 3D API training the following discussion came up: how can we automate the creation of a pipe network? As you might already know, automate a process requires a very well defined rule for it, otherwise we cannot program it.</p>  <p>So, in this case, they just need to create a Pipe Network from one high point to another lower point. After some discussion, we agreed that a interesting first attempt could be along the water drop, which will give us a path with minimum cuts on the terrain.</p>  <p>This is not a ultimate solution, it still requires adjustments. For instance, the water drop path can circle around and give us a very long path, or reach a big slope, or many other issues… so please feel free to comment and suggest!</p>  <p>Sure we can do a similar with regular Water Drop features, creating an Alignment from the pline and using it to the network. But here we can define a distance between structs that may not follow the original path, align them and, of course, automate the whole process.</p>  <p>This sample requires a tin surface, a empty network already created (just to simplify) and a starting point. This first part of the sample will perform the operation.</p>  <div style="font-family: ; background: white">   <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">Private</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span><font color="#0000ff">Sub</font></span><font color="#000000"> CreateNetworkAlongWaterDropPath( _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; networkName </font></font><font style="font-size: 8pt"><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#0000ff">String</font></span><font color="#000000">, _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; surfaceId </font></font><font style="font-size: 8pt"><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">ObjectId</font></span><font color="#000000">, _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; initialPoint </font></font><font style="font-size: 8pt"><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">Point3d</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> db </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">Database</font></span><font color="#000000"> = </font><span><font color="#2b91af">Application</font></span><font color="#000000">. _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; DocumentManager.MdiActiveDocument.Database</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Using</font></span><font color="#000000"> trans </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">Transaction</font></span><font color="#000000"> = db. _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; TransactionManager.StartTransaction</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#0000ff">Try</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' abrir a superficie</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> surface </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">TinSurface</font></span><font color="#000000"> = trans.GetObject( _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; surfaceId, </font></font><font style="font-size: 8pt"><span><font color="#2b91af">OpenMode</font></span><font color="#000000">.ForRead)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' get the plines from the initial point</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> idPlines </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">ObjectIdCollection</font></span><font color="#000000"> = surface. _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; Analysis.CreateWaterdrop( _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; initialPoint.Convert2d(</font></font><font style="font-size: 8pt"><span><font color="#0000ff">New</font></span><font color="#000000"> </font><span><font color="#2b91af">Plane</font></span><font color="#000000">()), _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; Autodesk.Civil.</font></font><font style="font-size: 8pt"><span><font color="#2b91af">WaterdropObjectType</font></span><font color="#000000">.Polyline3D)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' open the pline that will be the path</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' here we'll simplify and get the first</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' pline of the collection, but keep in mind</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' that a water drop can return multiple</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> idPline </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">ObjectId</font></span><font color="#000000"> = idPlines.Item(0)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> pline </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">Polyline3d</font></span><font color="#000000"> = trans.GetObject( _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; idPline, </font></font><font style="font-size: 8pt"><span><font color="#2b91af">OpenMode</font></span><font color="#000000">.ForRead)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' get the network by name</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> rede </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">Network</font></span><font color="#000000"> = </font></font><span><font style="font-size: 8pt" color="#0000ff">Nothing</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> civilDoc </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">CivilDocument</font></span><font color="#000000"> = _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">CivilApplication</font></span><font color="#000000">.ActiveDocument</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">For</font></span><font color="#000000"> </font><span><font color="#0000ff">Each</font></span><font color="#000000"> idRede </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">ObjectId</font></span><font color="#000000"> </font><span><font color="#0000ff">In</font></span><font color="#000000"> _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; civilDoc.GetPipeNetworkIds()</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; rede = trans.GetObject(idRede, _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">OpenMode</font></span><font color="#000000">.ForRead)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">If</font></span><font color="#000000"> (rede.Name.Equals(networkName)) _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Then</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">Exit For</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#0000ff">Next</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' and upgrade to write</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; rede.UpgradeOpen()</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' get the part family and size for </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' pipes and structs</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> idStructFamily </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">ObjectId</font></span><font color="#000000"> = _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; SelectPartFamily( _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; rede.PartsListId, _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">DomainType</font></span><font color="#000000">.Structure)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> idStructSize </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">ObjectId</font></span><font color="#000000"> = _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; SelectPartSize(idStructFamily)</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> idPipeFamily </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">ObjectId</font></span><font color="#000000"> = _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; SelectPartFamily( _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; rede.PartsListId, _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">DomainType</font></span><font color="#000000">.Pipe)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> idPipeSize </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">ObjectId</font></span><font color="#000000"> = _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; SelectPartSize(idPipeFamily)</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' iterate through the pline</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> previousPoint </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">Point3d</font></span><font color="#000000"> = pline.GetPointAtDist(0)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> previousStructPoint </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">ObjectId</font></span><font color="#000000"> = </font><span><font color="#2b91af">ObjectId</font></span><font color="#000000">.Null</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> distanceBetweenStruct </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#0000ff">Double</font></span><font color="#000000"> = 100</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">For</font></span><font color="#000000"> distanceAtPline </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#0000ff">Double</font></span><font color="#000000"> = 0 </font><span><font color="#0000ff">To</font></span><font color="#000000"> pline.Length _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Step</font></span><font color="#000000"> distanceBetweenStruct</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' point at the current distance</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> currentPoint </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">Point3d</font></span><font color="#000000"> = _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; pline.GetPointAtDist(distanceAtPline)</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' let's align the struct with the pline</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> angle </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#0000ff">Double</font></span><font color="#000000"> = _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; pline.GetFirstDerivative(currentPoint). _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; AngleOnPlane(</font></font><font style="font-size: 8pt"><span><font color="#0000ff">New</font></span><font color="#000000"> </font><span><font color="#2b91af">Plane</font></span><font color="#000000">())</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> idStruct </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#2b91af">ObjectId</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; rede.AddStructure(idStructFamily, _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; idStructSize, _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; currentPoint,</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; angle,</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; idStruct, </font></font><font style="font-size: 8pt"><span><font color="#0000ff">True</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">If</font></span><font color="#000000"> (distanceAtPline &gt; 1) </font><span><font color="#0000ff">Then</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#008000">' skipt the first</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' create a line segment</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> pipeLineSegment </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#0000ff">New</font></span><font color="#000000"> </font><span><font color="#2b91af">LineSegment3d</font></span><font color="#000000">( _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; previousPoint, currentPoint)</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' create the pipe using the line segment</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> pipeId </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#2b91af">ObjectId</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; rede.AddLinePipe(idPipeFamily, _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; idPipeSize, pipeLineSegment, _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; pipeId, </font></font><font style="font-size: 8pt"><span><font color="#0000ff">True</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' open the pipe to connect to the structs</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> pipe </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">Pipe</font></span><font color="#000000"> = trans.GetObject(pipeId, _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">OpenMode</font></span><font color="#000000">.ForWrite)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' start struct</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; pipe.ConnectToStructure(</font></font><font style="font-size: 8pt"><span><font color="#2b91af">ConnectorPositionType</font></span><font color="#000000">.Start, _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; previousStructPoint, </font></font><font style="font-size: 8pt"><span><font color="#0000ff">True</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' end struct</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; pipe.ConnectToStructure(</font></font><font style="font-size: 8pt"><span><font color="#2b91af">ConnectorPositionType</font></span><font color="#000000">.End, _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; idStruct, </font></font><font style="font-size: 8pt"><span><font color="#0000ff">True</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">If</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; previousStructPoint = idStruct</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; previousPoint = currentPoint</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#0000ff">Next</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' erase the plines...</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">For</font></span><font color="#000000"> </font><span><font color="#0000ff">Each</font></span><font color="#000000"> id </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">ObjectId</font></span><font color="#000000"> </font><span><font color="#0000ff">In</font></span><font color="#000000"> idPlines</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; trans.GetObject(id, </font></font><font style="font-size: 8pt"><span><font color="#2b91af">OpenMode</font></span><font color="#000000">.ForWrite).Erase()</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#0000ff">Next</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' commit changes</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; trans.Commit()</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#0000ff">Catch</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' something went wrong...</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; trans.Abort()</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">Try</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">Using</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">End</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">Sub</font></span></font></p> </div>  <p>And the result is a network as shown below, with the structs aligned.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017c375ca62e970b-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="full_network" border="0" alt="full_network" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017d418bdefb970c-pi" width="452" height="402" /></a></p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017d418bdf06970c-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="network_detail" border="0" alt="network_detail" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017d418bdf10970c-pi" width="453" height="232" /></a></p>  <p>Now we need a code responsible for the user interface: selections. The following code sample do it.</p>  <div style="font-family: ; background: white">   <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&lt;</font></font><font style="font-size: 8pt"><span><font color="#2b91af">CommandMethod</font></span><font color="#000000">(</font><span><font color="#a31515">&quot;createNetworkAlongWaterDropPath&quot;</font></span><font color="#000000">)&gt; _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt"><span><font color="#0000ff">Public</font></span><font color="#000000"> </font><span><font color="#0000ff">Sub</font></span><font color="#000000"> CmdCreateNetworkAlongWaterDropPath()</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> ed </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">Editor</font></span><font color="#000000"> = </font><span><font color="#2b91af">Application</font></span><font color="#000000">. _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160; DocumentManager.MdiActiveDocument.Editor</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' ask the user for the network</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> networkName </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#0000ff">String</font></span><font color="#000000"> = SelectNetwork()</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">If</font></span><font color="#000000"> (</font><span><font color="#0000ff">String</font></span><font color="#000000">.IsNullOrWhiteSpace(networkName)) _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Then</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">Exit Sub</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' select the surface</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> opSelSurface </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#0000ff">New</font></span><font color="#000000">&#160; _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">PromptEntityOptions</font></span><font color="#000000">(</font><span><font color="#a31515">&quot;Select a TinSurface: &quot;</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160; opSelSurface.SetRejectMessage _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160; (</font></font><font style="font-size: 8pt"><span><font color="#a31515">&quot;Only TinSurface&quot;</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160; opSelSurface.AddAllowedClass _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160; (</font></font><font style="font-size: 8pt"><span><font color="#0000ff">GetType</font></span><font color="#000000">(</font><span><font color="#2b91af">TinSurface</font></span><font color="#000000">), </font><span><font color="#0000ff">True</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> resSurface </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">PromptEntityResult</font></span><font color="#000000"> = _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160; ed.GetEntity(opSelSurface)</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">If</font></span><font color="#000000"> (resSurface.Status &lt;&gt; </font><span><font color="#2b91af">PromptStatus</font></span><font color="#000000">.OK) _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Then</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">Exit Sub</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' select the initial point</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> resInitialPoint </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">PromptPointResult</font></span><font color="#000000"> = _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160; ed.GetPoint(</font></font><font style="font-size: 8pt"><span><font color="#a31515">&quot;Select initial point: &quot;</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">If</font></span><font color="#000000"> (resInitialPoint.Status &lt;&gt; </font><span><font color="#2b91af">PromptStatus</font></span><font color="#000000">.OK) _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Then</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">Exit Sub</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160; CreateNetworkAlongWaterDropPath( _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160; networkName, _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160; resSurface.ObjectId, _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160; resInitialPoint.Value)</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt"><span><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">Sub</font></span></font></p> </div>  <div style="font-family: ; background: white">   <p style="margin: 0px">This code requires some ‘utility’ functions for selections, which basically use a form to ask for information using a <a href="http://msdn.microsoft.com/en-us/library/system.windows.forms.combobox.aspx">Combo Box</a> list.</p> </div>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017ee8ffbb04970d-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="form" border="0" alt="form" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017c375ca652970b-pi" width="281" height="194" /></a></p>  <div style="font-family: ; background: white">   <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">Private</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span><font color="#0000ff">Function</font></span><font color="#000000"> SelectNetwork() </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">String</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> frm </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#0000ff">New</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#2b91af">FormSelect</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> db </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">Database</font></span><font color="#000000"> = </font><span><font color="#2b91af">Application</font></span><font color="#000000">.DocumentManager. _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; MdiActiveDocument.Database</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Using</font></span><font color="#000000"> trans </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">Transaction</font></span><font color="#000000"> = db.TransactionManager.StartTransaction</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> civilDoc </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">CivilDocument</font></span><font color="#000000"> = </font><span><font color="#2b91af">CivilApplication</font></span><font color="#000000">.ActiveDocument</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">For</font></span><font color="#000000"> </font><span><font color="#0000ff">Each</font></span><font color="#000000"> idRede </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">ObjectId</font></span><font color="#000000"> </font><span><font color="#0000ff">In</font></span><font color="#000000"> civilDoc.GetPipeNetworkIds()</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> rede </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">Network</font></span><font color="#000000"> = trans.GetObject(idRede, </font><span><font color="#2b91af">OpenMode</font></span><font color="#000000">.ForRead)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; frm.cboOptions.Items.Add(rede.Name)</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#0000ff">Next</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">Using</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">If</font></span><font color="#000000"> (frm.cboOptions.Items.Count = 0) </font></font><span><font style="font-size: 8pt" color="#0000ff">Then</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">Application</font></span><font color="#000000">.DocumentManager.MdiActiveDocument. _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; Editor.WriteMessage(</font></font><font style="font-size: 8pt"><span><font color="#a31515">&quot;No networks available&quot;</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Return</font></span><font color="#000000"> </font><span><font color="#0000ff">String</font></span><font color="#000000">.Empty</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">If</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; frm.cboOptions.SelectedIndex = 0</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">If</font></span><font color="#000000"> (</font><span><font color="#2b91af">Application</font></span><font color="#000000">.ShowModalDialog(frm) _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; &lt;&gt; Windows.Forms.</font></font><font style="font-size: 8pt"><span><font color="#2b91af">DialogResult</font></span><font color="#000000">.OK) _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#0000ff">Then</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Return</font></span><font color="#000000"> </font><span><font color="#0000ff">String</font></span><font color="#000000">.Empty</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">If</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Return</font></span><font color="#000000"> frm.cboOptions.SelectedItem</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">End</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">Function</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">Private</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span><font color="#0000ff">Function</font></span><font color="#000000"> SelectPartFamily(idPartList </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">ObjectId</font></span><font color="#000000">, _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; domainType </font></font><font style="font-size: 8pt"><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">DomainType</font></span><font color="#000000">) </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#2b91af">ObjectId</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> db </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">Database</font></span><font color="#000000"> = </font><span><font color="#2b91af">Application</font></span><font color="#000000">.DocumentManager. _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; MdiActiveDocument.Database</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Using</font></span><font color="#000000"> trans </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">Transaction</font></span><font color="#000000"> = db.TransactionManager.StartTransaction</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> partList </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">PartsList</font></span><font color="#000000"> = trans.GetObject(idPartList, _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">OpenMode</font></span><font color="#000000">.ForRead)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> idsPartFamily </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">ObjectIdCollection</font></span><font color="#000000"> = _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; partList.GetPartFamilyIdsByDomain(domainType)</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> frm </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#0000ff">New</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#2b91af">FormSelect</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">For</font></span><font color="#000000"> </font><span><font color="#0000ff">Each</font></span><font color="#000000"> partFamilyId </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">ObjectId</font></span><font color="#000000"> </font><span><font color="#0000ff">In</font></span><font color="#000000"> idsPartFamily</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> family </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">PartFamily</font></span><font color="#000000"> = trans.GetObject(partFamilyId, _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">OpenMode</font></span><font color="#000000">.ForRead)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; frm.cboOptions.Items.Add(family.Name)</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#0000ff">Next</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; frm.cboOptions.SelectedIndex = 0</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">Application</font></span><font color="#000000">.ShowModalDialog(frm)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> partFamName </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#0000ff">String</font></span><font color="#000000"> = frm.cboOptions.SelectedItem</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">For</font></span><font color="#000000"> </font><span><font color="#0000ff">Each</font></span><font color="#000000"> idFamilia </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">ObjectId</font></span><font color="#000000"> </font><span><font color="#0000ff">In</font></span><font color="#000000"> idsPartFamily</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> pFamily </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">PartFamily</font></span><font color="#000000"> = trans.GetObject(idFamilia, _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">OpenMode</font></span><font color="#000000">.ForRead)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">If</font></span><font color="#000000"> (partFamName.Equals(pFamily.Name)) </font><span><font color="#0000ff">Then</font></span><font color="#000000"> </font><span><font color="#0000ff">Return</font></span><font color="#000000"> idFamilia</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#0000ff">Next</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">Using</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">End</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">Function</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">Private</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span><font color="#0000ff">Function</font></span><font color="#000000"> SelectPartSize(idFamily </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">ObjectId</font></span><font color="#000000">) </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#2b91af">ObjectId</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> db </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">Database</font></span><font color="#000000"> = </font><span><font color="#2b91af">Application</font></span><font color="#000000">.DocumentManager. _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; MdiActiveDocument.Database</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Using</font></span><font color="#000000"> trans </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">Transaction</font></span><font color="#000000"> = db.TransactionManager.StartTransaction</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> frm </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#0000ff">New</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#2b91af">FormSelect</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> partFam </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">PartFamily</font></span><font color="#000000"> = trans.GetObject(idFamily, _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">OpenMode</font></span><font color="#000000">.ForRead)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">For</font></span><font color="#000000"> i </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#0000ff">Integer</font></span><font color="#000000"> = 0 </font><span><font color="#0000ff">To</font></span><font color="#000000"> partFam.PartSizeCount - 1</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> size </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">PartSize</font></span><font color="#000000"> = trans.GetObject(partFam.Item(i), _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">OpenMode</font></span><font color="#000000">.ForRead)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; frm.cboOptions.Items.Add(size.Name)</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#0000ff">Next</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; frm.cboOptions.SelectedIndex = 0</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">Application</font></span><font color="#000000">.ShowModalDialog(frm)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> selectedSize </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#0000ff">String</font></span><font color="#000000"> = frm.cboOptions.SelectedItem</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">For</font></span><font color="#000000"> i </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#0000ff">Integer</font></span><font color="#000000"> = 0 </font><span><font color="#0000ff">To</font></span><font color="#000000"> partFam.PartSizeCount - 1</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> size </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">PartSize</font></span><font color="#000000"> = trans.GetObject(partFam.Item(i), _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">OpenMode</font></span><font color="#000000">.ForRead)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">If</font></span><font color="#000000"> (size.Name.Equals(selectedSize)) </font><span><font color="#0000ff">Then</font></span><font color="#000000"> </font><span><font color="#0000ff">Return</font></span><font color="#000000"> size.ObjectId</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#0000ff">Next</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">Using</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">End</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">Function</font></span></font></p> </div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Malcolm
EMAIL: mfernandes@rand.com
IP: 24.108.117.131
URL: 
DATE: 09/25/2014 02:50:24 PM
looking at the code, you are iterate through the pline to create the network. In 2015 API is there a method to simply create a network from pline? if yes, are there any samples on how to create a pipe network from a pline in C#. Is there a list somewhere of all the methods, functions etc.
-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 177.43.194.106
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 10/06/2014 11:11:53 AM
Malcolm

In fact this code is not following the PLINE at every point, but only at specific parameters...

But if you need to follow the PLINE, use as shown at http://adndevblog.typepad.com/infrastructure/2012/06/do-you-want-to-programmatically-convert-polyline-to-civil-3d-alignment-object.html

Regards,
Augusto Goncalves
-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Running Industry Model Samples of AIMS
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: running-industry-model-samples-of-aims
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/03/running-industry-model-samples-of-aims.html 
DATE: 03/06/2013 01:53:36 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>Similar with Map 3D industry model, Autodesk Infrastructure Map Server includes industry model as well if you installed Infrastructure Application Extension. It provides APIs for customization as well, and more than 100 sample projects are released with the project, they can be found in C:\Program Files\Autodesk\Autodesk Infrastructure Web Server Extension 2013\www\AppExt\Development\Samples by default.</p>  <p>To run these samples, open CSSamples.sln in Visual Studio, this solution contains all sample projects in the folder, you can want to open specific one instead of opening them all. </p>  <p>Please not that some samples do not work for AIMS Application Extension(a.k.a Topobase Web or TBWeb), for example CSSample01. Let’s take a look at the tbp file. BTW, the tbp file is AutoCAD Map 3D/AIMS plugin definition file (identified by the .tbp extension), it should be copied to AppExt\Bin folder so that Map3D/AIMS knows about your plugin. </p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017c37597a48970b-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017ee8fc8b5a970d-pi" width="328" height="526" /></a></p>  <p>Let’s examine the tbp file:</p>  <pre style="line-height: normal; font-family: ; background: white; color: "><font face="新宋体"><span style="color: "><font color="#0000ff"><font style="font-size: 7.8pt">&lt;?</font></font></span><font style="font-size: 7.8pt"><span style="color: "><font color="#a31515">xml</font></span><span style="color: "><font color="#0000ff">&#160;</font></span><span style="color: "><font color="#ff0000">version</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">1.0</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">&#160;</font></span><span style="color: "><font color="#ff0000">encoding</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">utf-8</font></span><font color="#000000">&quot;</font></font></font><font face="新宋体"><font style="font-size: 7.8pt"><font color="#0000ff"><span style="color: ">?&gt;</span><br /><span style="color: ">&lt;</span></font><span style="color: "><font color="#a31515">PlugIn</font></span><span style="color: "><font color="#0000ff">&gt;</font></span><br /><font color="#000000"> </font><br /><span style="color: "><font color="#0000ff">	&lt;</font></span><span style="color: "><font color="#a31515">Default</font></span><br /><span style="color: "><font color="#0000ff">		</font></span><span style="color: "><font color="#ff0000">AssemblyName</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">CSSample01.dll</font></span><font color="#000000">&quot;</font><br /><span style="color: "><font color="#0000ff">		</font></span><span style="color: "><font color="#ff0000">Namespace</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">CSSample01</font></span><font color="#000000">&quot;</font><br /><span style="color: "><font color="#0000ff">		</font></span><span style="color: "><font color="#ff0000">DocumentKey</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;&quot;</font><br /><span style="color: "><font color="#0000ff">		</font></span><span style="color: "><font color="#ff0000">MapName</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;&quot;</font><br /><span style="color: "><font color="#0000ff">		</font></span><span style="color: "><font color="#ff0000">Priority</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">100</font></span><font color="#000000">&quot;</font><br /><span style="color: "><font color="#0000ff">		</font></span><strong><font style="background-color: #ffff00"><span style="color: "><font color="#ff0000">ExecutionTargetWeb</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">False</font></span><font color="#000000">&quot;</font></font></strong><br /><span style="color: "><font color="#0000ff">		</font></span><strong><font style="background-color: #ffff00"><span style="color: "><font color="#ff0000">ExecutionTargetDesktop</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">True</font></span><font color="#000000">&quot;</font></font></strong><br /><span style="color: "><font color="#0000ff">		</font></span><span style="color: "><font color="#ff0000">Company</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">Autodesk, Inc.</font></span><font color="#000000">&quot;</font><br /><span style="color: "><font color="#0000ff">		</font></span><span style="color: "><font color="#ff0000">Author</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">Map Engineering</font></span><font color="#000000">&quot;</font><br /><span style="color: "><font color="#0000ff">	/&gt;</font></span><br /><font color="#000000"> </font><br /><span style="color: "><font color="#0000ff">	&lt;</font></span><span style="color: "><font color="#a31515">ApplicationPlugIn</font></span><span style="color: "><font color="#0000ff">&#160;</font></span><span style="color: "><font color="#ff0000">ClassName</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">MyApplication</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">/&gt;</font></span><br /><font color="#000000"> </font><br /><span style="color: "><font color="#0000ff">&lt;/</font></span><span style="color: "><font color="#a31515">PlugIn</font></span></font><span style="color: "><font style="font-size: 7.8pt" color="#0000ff">&gt;</font></span></font></pre>

<p>ExecutionTargetWeb = False, that means it is not supposed to be running in AIMS, it only works in Map 3D desktop. If you open Form1.cs, you will notice that it is just a&#160; Windows Form, so that explains why it does not work for TBWeb.</p>

<pre style="line-height: normal; font-family: ; background: white; color: "><font face="新宋体"><span style="color: "><font color="#0000ff"><font style="font-size: 7.8pt">public</font></font></span><font style="font-size: 7.8pt"><font color="#000000">&#160;</font><span style="color: "><font color="#0000ff">class</font></span><font color="#000000">&#160;</font><span style="color: "><font color="#2b91af">Form1</font></span><font color="#000000"> : System.Windows.Forms.</font></font><span style="color: "><font style="font-size: 7.8pt" color="#2b91af">Form</font></span></font><br /></pre>

<p>&#160;</p>

<p>So here is the question, which samples are supposed to run in AIMS(TBWeb)? Well, actually development team did quite a lot of work to unify the form in both Map 3D desktop and AIMS web environment. If you want your form runs on both Map 3D desktop and AIMS, you will derive your form from <strong>Autodesk.Map.IM.Forms.ApplicationForm. </strong>Let’s take a look at CSSample100.</p>

<pre style="line-height: normal; font-family: ; background: white; color: "><span style="color: "><font color="#0000ff" face="新宋体"><font style="font-size: 7.8pt">namespace</font></font></span><font face="新宋体"><font style="font-size: 7.8pt"><font color="#000000"> CSSample100<br />{<br />&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">public</font></span><font color="#000000">&#160;</font><span style="color: "><font color="#0000ff">class</font></span><font color="#000000">&#160;</font><span style="color: "><font color="#2b91af">Form1</font></span><font color="#000000"> : <strong><font style="background-color: #ffff00">Autodesk.Map.IM.Forms.</font></strong></font><span style="color: "><font style="background-color: #ffff00" color="#2b91af"><strong>ApplicationForm</strong></font></span><br /><font color="#000000">&#160;&#160;&#160; {</font></font></font><br /></pre>

<p>…</p>

<p>And take a look at the tbp file of CSSample100:</p>

<pre style="line-height: normal; font-family: ; background: white; color: "><font face="新宋体"><span style="color: "><font color="#0000ff"><font style="font-size: 7.8pt">&lt;?</font></font></span><font style="font-size: 7.8pt"><span style="color: "><font color="#a31515">xml</font></span><span style="color: "><font color="#0000ff">&#160;</font></span><span style="color: "><font color="#ff0000">version</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">1.0</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">&#160;</font></span><span style="color: "><font color="#ff0000">encoding</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">utf-8</font></span><font color="#000000">&quot;</font></font></font><font face="新宋体"><font style="font-size: 7.8pt"><font color="#0000ff"><span style="color: ">?&gt;</span><br /><span style="color: ">&lt;</span></font><span style="color: "><font color="#a31515">PlugIn</font></span><span style="color: "><font color="#0000ff">&gt;</font></span><br /><font color="#000000"> </font><br /><span style="color: "><font color="#0000ff">	&lt;</font></span><span style="color: "><font color="#a31515">Default</font></span><br /><span style="color: "><font color="#0000ff">		</font></span><span style="color: "><font color="#ff0000">AssemblyName</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">CSSample100.dll</font></span><font color="#000000">&quot;</font><br /><span style="color: "><font color="#0000ff">		</font></span><span style="color: "><font color="#ff0000">Namespace</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">CSSample100</font></span><font color="#000000">&quot;</font><br /><span style="color: "><font color="#0000ff">		</font></span><span style="color: "><font color="#ff0000">DocumentKey</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;&quot;</font><br /><span style="color: "><font color="#0000ff">		</font></span><span style="color: "><font color="#ff0000">MapName</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;&quot;</font><br /><span style="color: "><font color="#0000ff">		</font></span><span style="color: "><font color="#ff0000">Priority</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">100</font></span><font color="#000000">&quot;</font><br /><span style="color: "><font color="#0000ff">		</font></span><strong><font style="background-color: #ffff00"><span style="color: "><font color="#ff0000">ExecutionTargetWeb</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">True</font></span><font color="#000000">&quot;</font></font></strong><br /><span style="color: "><font color="#0000ff">		</font></span><strong><font style="background-color: #ffff00"><span style="color: "><font color="#ff0000">ExecutionTargetDesktop</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">True</font></span><font color="#000000">&quot;</font></font></strong><br /><span style="color: "><font color="#0000ff">		</font></span><span style="color: "><font color="#ff0000">Company</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">Autodesk, Inc.</font></span><font color="#000000">&quot;</font><br /><span style="color: "><font color="#0000ff">		</font></span><span style="color: "><font color="#ff0000">Author</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">Map Engineering</font></span><font color="#000000">&quot;</font><br /><span style="color: "><font color="#0000ff">	/&gt;</font></span><br /><font color="#000000"> </font><br /><span style="color: "><font color="#0000ff">	&lt;</font></span><span style="color: "><font color="#a31515">ApplicationPlugIn</font></span><span style="color: "><font color="#0000ff">&#160;</font></span><span style="color: "><font color="#ff0000">ClassName</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">MyApplication</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">/&gt;</font></span><br /><font color="#000000"> </font><br /><span style="color: "><font color="#0000ff">&lt;/</font></span><span style="color: "><font color="#a31515">PlugIn</font></span></font><span style="color: "><font style="font-size: 7.8pt" color="#0000ff">&gt;</font></span></font><br /></pre>

<p>&#160;</p>

<p>This sample application works for Map 3D desktop and AIMS Web application as well.</p>

<p>&#160;</p>

<p>To run this sample on AIMS, please make sure that your output folder is set to C:\Program Files\Autodesk\Autodesk Infrastructure Web Server Extension 2013\www\AppExt\Bin: </p>

<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017c37597a5e970b-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017c37597a73970b-pi" width="457" height="91" /></a></p>

<p>And set “Copy to Output Directry” tp “Copy always” or “Copy if newer”. Once the project is built successfully and the necessary files (dll and tbp) are copied to AppExt\Bin folder, you can launch a browser to open&#160; your industry model (<a title="http://localhost/mapserver2013/appext/login.aspx" href="http://localhost/mapserver2013/appext/login.aspx">http://localhost/mapserver2013/appext/login.aspx</a> ), I am using SQL Server here, it should be similar for Oracle.</p>

<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017ee8fc8b7f970d-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017c37597a94970b-pi" width="443" height="460" /></a></p>

<p>Open the project: </p>





<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017d4188b2b4970c-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017ee8fc8bab970d-pi" width="469" height="118" /></a></p>

<p>A new button will appear in “Autodesk Industry Model Explorer”, and a web form will show up when clicking this button.</p>

<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017ee8fc8bd0970d-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017d4188b2fa970c-pi" width="429" height="376" /></a></p>





<p>Please turn off pop-up blocker of your browser. </p>

<p>There are quit a lot other samples in C:\Program Files\Autodesk\Autodesk Infrastructure Web Server Extension 2013\www\AppExt\Development\Samples, and the Map 3D document&#160; on <a href="http://wikihelp.autodesk.com/AutoCAD_Map_3D/enu/2013/Help/0003-Industry0/0043-Quick_Gu43/0044-Introduc44">Wikihlep</a> should be helpful to understand and run these sample.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Running Industry Model Samples of Map 3D
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: running-industry-model-samples-of-map-3d
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/03/running-industry-model-samples-of-map-3d.html 
DATE: 03/06/2013 12:19:54 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>AutoCAD Map 3D Industry Models,which was part of Topobase Client(old name), provides APIs for customization. Over 70 samples are provided in both C# and Visual Basic, located under &lt;Map 3D Install Directory&gt;\Development\Samples, which are documented in <a href="http://wikihelp.autodesk.com/AutoCAD_Map_3D/enu/2013/Help/0003-Industry0/0153-Develope153#GUID-D362ECEC-9D58-4C4F-B0C2-031A80534894">Developer Samples</a>.</p>  <p>A plugin for Map 3D industry model contains a class library (that is, a file with a “.dll” extension) and a <a name="GUID-A83380D1-75D7-4BA7-ADEE-FB3AA3A044FE"></a>AutoCAD Map 3D plugin definition file (identified by the .tbp extension) so that <a name="GUID-A83380D1-75D7-4BA7-ADEE-FB3AA3A044FE"></a>AutoCAD Map 3D knows about your plugin.&#160; </p>  <p>To test your plugin from Visual Studio, please make sure to set your output path to &lt;Map 3D Install Directory&gt;\Bin folder:</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017d41882193970c-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017c3758ea23970b-pi" width="466" height="123" /></a></p>  <p>And do not forget to copy the tbp file to output folder as well. You can set “Copy to Output Directry” tp “Copy always” or “Copy if newer”:</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017d418821b7970c-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017c3758ea48970b-pi" width="344" height="571" /></a></p>  <p>&#160;</p>  <p>For the first example C:\Program Files\Autodesk\AutoCAD Map 3D 2013\Development\Samples\CSharp\01_CreateStructure, a new button will be added into Industry Model Explorer. When clicking it, a custom form will show up.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017ee8fbfcb2970d-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017d418821e4970c-pi" width="520" height="278" /></a></p>  <p>&#160;</p>  <p>There are many other samples, and the document can be found in <a href="http://wikihelp.autodesk.com/AutoCAD_Map_3D/enu/2013/Help/0003-Industry0/0043-Quick_Gu43/0044-Introduc44">wikihelp</a>. </p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Autocad
EMAIL: dohko_deo@hotmail.com
IP: 190.23.58.192
URL: http://www.egeomate.com
DATE: 04/26/2013 06:42:25 PM
Now we have many apps to use with GPS and maps with Android apps and others, Technology facilitates humans to investigate and learn

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: AutoCAD Map 3D API Training content : Part-2
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: autocad-map-3d-api-training-content-part-2
CATEGORY: .NET
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/03/autocad-map-3d-api-training-content-part-2.html 
DATE: 03/04/2013 05:31:27 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>This is in
continuation of my <a href="http://adndevblog.typepad.com/infrastructure/2013/02/autocad-map-3d-api-training-content-part-1.html">previous</a>
post. In this post I am going to introduce you to Geospatial Platform API
&quot;Resources&quot; and highlight the differences in &quot;Resources&quot;
between AutoCAD Map 3D and Autodesk Infrastructure Map Server (AIMS) [or
MapGuide].&#0160;</p>
<p>&#0160;</p>
<p>In the
Geospatial Platform API, resources are the files and configuration information
which are essential part of creating Layers (in Map 3D it&#39;s the FDO layers in
DisplayManager and not the AutoCAD Layers) and Maps. There are some common types of resources available in
Map 3D and AIMS; AIMS (MapGuide ) has some additional types. Map 3D And AIMS
Developer&#39;s guide has the detailed list of resources supported in Map 3D and
AIMS. </p>
<p>&#0160;</p>
<p>Resources are
stored in a resource repository. The repository is structured like a directory,
with documents, folders, and subfolders. Each resource is stored as XML and has
a unique path in the repository. The resource’s extension must match one of the
types defined in MgResourceType, but the rest of the name and the path is
arbitrary. The root’s path is Library:// and the path of a typical resource
might be Library://MyProjects/Project1/Roads.LayerDefinition&#0160;</p>
<p>&#0160;</p>
<p>AutoCAD Map
3D has a single repository named Library. This repository is contained within
the DWG file.&#0160;</p>
<p>AIMS uses
multiple repositories. The Library repository contains persistent, site-wide
data. There is a single Library repository for each AIMS site. There are
multiple Session repositories, each one containing data from a single AIMS
session. Session repositories are unique to an individual session and cannot be
shared. All AIMS repositories are managed on the site server.&#0160;</p>
<p>Some
resources are self-sufficient and do not refer to any other resources or files.
And some resources reference other resources. For example, layers and feature
sources are stored as separate resources. A layer resource refers to the
resources for the feature sources that are used in that layer. </p>
<p>Resource
Service enables us to manipulate resources in Map 3D and AIMS. Though
Geospatial Platform API is very consistent between AutoCAD Map 3D and AIMS, but
there are some differences in the way they handle resources as AIMS need to
manage the resources in a Server-client environment. Allowable resource types
are defined as static members of the class <em><strong>MgResourceType</strong></em>. </p>
<p>&#0160;</p>
<p>&#0160;
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017d4178f90d970c-pi" style="display: inline;"><img alt="Resources" class="asset  asset-image at-xid-6a0167607c2431970b017d4178f90d970c" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017d4178f90d970c-500wi" title="Resources" /></a></p>
<p>&#0160;</p>
<p>Resource
Types which are common between AutoCAD Map 3D and AIMS - FeatureSource,
LayerDefinition, SymbolDefinition.</p>
<p>&#0160;</p>
<p>Following
Resources are applicable only to AIMS - ApplicationDefinition, DrawingSource,
Folder, LoadProcedure, Map, MapDefinition, PrintLayout, Selection,
SymbolLibrary, or WebLayout resources</p>
<p>AutoCAD Map
3D does not use resource headers. They are only used in AIMS / MapGuide to
control permissions in the site repository. In AutoCAD Map 3D, pass a NULL
parameter for methods that require a resource header, such as SetResource.</p>
<p>Session
repositories are not supported in AutoCAD Map 3D. All resources must be stored
in the Library repository.</p>
<p>We have a
nice video titled &#39;<strong>AutoCAD Map 3D Resource Explorer</strong>&#39; which explains working on Map
3D resources with associated code sample. You can <a href="http://download.autodesk.com/media/adn/MapResourceExplorerVideo/MapResourceExplorerIntroduction.html">view
the video online</a> or <a href="http://images.autodesk.com/adsk/files/toolandsourcecode.zip">download</a>
it along with the visual studio project.</p>
<p>&#0160;</p>
<p>Attached <span class="asset  asset-generic at-xid-6a0167607c2431970b017c3749dfe1970b"><a href="http://adndevblog.typepad.com/files/chapter-2.pdf">PDF</a>&#0160;</span>will help you to understand working with &#39;<strong>Resources</strong>&#39; and associated APIs which you would require in
your application development using Geospatial Platform API.</p>
<p>&#0160;</p>
<p>I hope this
is useful to you!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Enable Hyperlink in Selection panel of Fusion Viewer
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: enable-hyperlink-in-selection-panel-of-fusion-viewer
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/02/enable-hyperlink-in-selection-panel-of-fusion-viewer.html 
DATE: 02/26/2013 01:04:29 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>If you are migrating your application from Ajax Viewer(aka. Basic web layout) to Fusion Viewer(aka. Flexible web layout), you may notice that the hyperlink in selection panel does not work, it displays as raw HTML tags.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017d41491e76970c-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017d41491e90970c-pi" width="444" height="138" /></a></p>  <p>(In Fusion Viewer, not as expected )</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017ee8bd0e8e970d-pi"><img style="background-image: none; border-right-width: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017c3719e971970b-pi" width="436" height="107" /></a></p>  <p>(in Ajax Viewer, works well)</p>  <p>Here is the solution, you need to edit SelectionPanel.js in C:\Program Files\Autodesk\Autodesk Infrastructure Web Server Extension 2013\www\fusion\widgets. Search “renderFeature”(Around 384) and change code as below:</p>  <pre style="line-height: normal; font-family: ; background: white; color: "><font face="新宋体"><strong><font color="#000000"><font style="font-size: 7.8pt">htmlDecode:</font></font><font style="font-size: 7.8pt"><span style="color: "><font color="#0000ff">function</font></span></font></strong></font><font style="font-size: 7.8pt"><font face="新宋体"><strong><font color="#000000">(str){
	</font><span style="color: "><font color="#0000ff">var</font></span><font color="#000000"> s = </font><span style="color: "><font color="#800000">&quot;&quot;</font></span></strong></font><font face="新宋体"><strong><font color="#000000">;
	</font><span style="color: "><font color="#0000ff">if</font></span><font color="#000000">(str.length == 0) </font><span style="color: "><font color="#0000ff">return</font></span><font color="#000000">&#160;</font><span style="color: "><font color="#800000">&quot;&quot;</font></span></strong></font><font face="新宋体"><strong><font color="#000000">;
	s =&#160; str.replace(/&amp;gt;/g,&#160;&#160; </font><span style="color: "><font color="#800000">&quot;&gt;&quot;</font></span></strong></font><font face="新宋体"><strong><font color="#000000">);
	s =&#160; s.replace(/&amp;lt;/g,&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#800000">&quot;&lt;&quot;</font></span></strong></font><font face="新宋体"><strong><font color="#000000">);
	s =&#160; s.replace(/&amp;nbsp;/g,&#160;&#160; </font><span style="color: "><font color="#800000">&quot; &quot;</font></span></strong></font><font face="新宋体"><strong><font color="#000000">);
	s =&#160; s.replace(/'/g,&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#800000">&quot;\'&quot;</font></span></strong></font><font face="新宋体"><strong><font color="#000000">);
	s =&#160; s.replace(/&amp;quot;/g,&#160;&#160; </font><span style="color: "><font color="#800000">&quot;\&quot;&quot;</font></span></strong></font><font face="新宋体"><strong><font color="#000000">);
	s = s.replace(/&lt;br&gt;/g,&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#800000">&quot;\n&quot;</font></span></strong></font><font face="新宋体"><strong><font color="#000000">);
	</font><span style="color: "><font color="#0000ff">return</font></span></strong></font><font face="新宋体"><font color="#000000"><strong> s;
},</strong>

renderFeature: </font><span style="color: "><font color="#0000ff">function</font></span></font><font face="新宋体"><font color="#000000">() {
</font><span style="color: "><font color="#0000ff">var</font></span><font color="#000000"> layerIdx = </font><span style="color: "><font color="#0000ff">this</font></span></font><font face="新宋体"><font color="#000000">.layerList.selectedIndex;
</font><span style="color: "><font color="#0000ff">var</font></span><font color="#000000"> featureIdx = </font><span style="color: "><font color="#0000ff">this</font></span></font><font face="新宋体"><font color="#000000">.featureList.selectedIndex;
</font><span style="color: "><font color="#0000ff">var</font></span><font color="#000000"> layerObj = </font><span style="color: "><font color="#0000ff">this</font></span></font><font face="新宋体"><font color="#000000">.oSelection.getLayer(layerIdx);
</font><span style="color: "><font color="#0000ff">var</font></span></font><font face="新宋体"><font color="#000000"> nProperties = layerObj.getNumProperties();
</font><span style="color: "><font color="#0000ff">var</font></span></font><font face="新宋体"><font color="#000000"> aNames = layerObj.getPropertyNames();

</font><span style="color: "><font color="#0000ff">var</font></span><font color="#000000"> table = document.createElement(</font><span style="color: "><font color="#800000">'table'</font></span></font><font face="新宋体"><font color="#000000">);

</font><span style="color: "><font color="#0000ff">var</font></span><font color="#000000"> thead = document.createElement(</font><span style="color: "><font color="#800000">'thead'</font></span></font><font face="新宋体"><font color="#000000">);
</font><span style="color: "><font color="#0000ff">var</font></span><font color="#000000"> tr = document.createElement(</font><span style="color: "><font color="#800000">'tr'</font></span></font><font face="新宋体"><font color="#000000">);
</font><span style="color: "><font color="#0000ff">var</font></span><font color="#000000"> th = document.createElement(</font><span style="color: "><font color="#800000">'th'</font></span></font><font face="新宋体"><font color="#000000">);
th.innerHTML = OpenLayers.i18n(</font><span style="color: "><font color="#800000">'attribute'</font></span></font><font face="新宋体"><font color="#000000">);
tr.appendChild(th);
</font><span style="color: "><font color="#0000ff">var</font></span><font color="#000000"> th = document.createElement(</font><span style="color: "><font color="#800000">'th'</font></span></font><font face="新宋体"><font color="#000000">);
th.innerHTML = OpenLayers.i18n(</font><span style="color: "><font color="#800000">'value'</font></span></font><font face="新宋体"><font color="#000000">);
tr.appendChild(th);
thead.appendChild(tr);
table.appendChild(thead);

</font><span style="color: "><font color="#0000ff">var</font></span><font color="#000000"> tbody = document.createElement(</font><span style="color: "><font color="#800000">'tbody'</font></span></font><font face="新宋体"><font color="#000000">);
table.appendChild(tbody);
</font><span style="color: "><font color="#0000ff">for</font></span><font color="#000000"> (</font><span style="color: "><font color="#0000ff">var</font></span></font><font face="新宋体"><font color="#000000"> i=0; i&lt;nProperties; i++) {
	</font><span style="color: "><font color="#0000ff">var</font></span><font color="#000000"> tr = document.createElement(</font><span style="color: "><font color="#800000">'tr'</font></span></font><font face="新宋体"><font color="#000000">);
	</font><span style="color: "><font color="#0000ff">if</font></span></font><font face="新宋体"><font color="#000000"> (i%2) {
		tr.className = </font><span style="color: "><font color="#800000">'oddRow'</font></span></font><font face="新宋体"><font color="#000000">;
	}
	</font><span style="color: "><font color="#0000ff">var</font></span><font color="#000000"> th = document.createElement(</font><span style="color: "><font color="#800000">'th'</font></span></font><font face="新宋体"><font color="#000000">);
	th.innerHTML = aNames[i];
	</font><span style="color: "><font color="#0000ff">var</font></span><font color="#000000"> td = document.createElement(</font><span style="color: "><font color="#800000">'td'</font></span></font><font face="新宋体"><font color="#000000">);
	td.innerHTML <strong>= </strong></font><span style="color: "><font color="#0000ff"><strong>this</strong></font></span></font><font face="新宋体"><font color="#000000"><strong>.htmlDecode(layerObj.getElementValue(featureIdx, i));</strong>
			
	tr.appendChild(th);
	tr.appendChild(td);
	tbody.appendChild(tr);
}
</font><span style="color: "><font color="#0000ff">this</font></span><font color="#000000">.featureDiv.innerHTML = </font><span style="color: "><font color="#800000">''</font></span></font></font><font face="新宋体"><font style="font-size: 7.8pt"><font color="#000000">;
</font><span style="color: "><font color="#0000ff">this</font></span><font color="#000000">.featureDiv.appendChild(table);
}</font></font></font><br /></pre>

<p>The idea is to decode the string value so that it can be rendered correctly. Please pay attention to the comma at the end of the the htmlDecode() function. Of cause you may add this utility function somewhere else to make the whole fusion project more organized, I just add it into SelectionPanel.js for simplicity. </p>

<p>Finally, you need to change the Javascriipt reference to the fusion.js in your template index.html, for example, C:\Program Files\Autodesk\Autodesk Infrastructure Web Server Extension 2013\www\fusion\templates\mapguide\slate\index.html if you are using Slate template: </p>

<p>&lt;script type=&quot;text/javascript&quot; src=&quot;../../../lib/<strong>fusion.js</strong>&quot;&gt;&lt;/script&gt;</p>

<p>&#160;</p>

<p>Please refer to <a href="http://adndevblog.typepad.com/infrastructure/2012/04/debugging-fusion-viewer-or-mobile-viewer-of-aims-in-firebug.html">this post</a> for more information about debugging as well. </p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: TBBatch.exe throws an XmlConfigurator error in AutoCAD Map 3D 2012 Enterprise 
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: tbbatchexe-throws-an-xmlconfigurator-error-in-autocad-map-3d-2012-enterprise-
CATEGORY: .NET
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/02/tbbatchexe-throws-an-xmlconfigurator-error-in-autocad-map-3d-2012-enterprise-.html 
DATE: 02/26/2013 12:40:23 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>Some of you might have noticed an issue in using the TBBatch.exe in Map 3D 2012 Enterprise.
TBBatch.exe throws exceptions like the
following -&#0160;</p>
<pre>log4net:ERROR XmlConfigurator: Error while loading XML configuration <br />System.Xml.XmlException: Ungültiges Zeichen in der angegebenen Codierung. xxxx <br />58, Position 1. <br />in System.Xml.XmlTextReaderImpl.Throw(Exception e) <br />in System.Xml.XmlTextReaderImpl.Throw(String res, String arg) <br />in System.Xml.XmlTextReaderImpl.Throw(Int32 pos, String res) <br />in System.Xml.XmlTextReaderImpl.InvalidCharRecovery(Int32&amp; bytesCount, Int32 &amp; charsCount) <br />in System.Xml.XmlTextReaderImpl.GetChars(Int32 maxCharsCount) <br />in System.Xml.XmlTextReaderImpl.ReadData() <br />in System.Xml.XmlTextReaderImpl.EatWhitespaces(BufferBuilder sb) <br />in System.Xml.XmlTextReaderImpl.ParseRootLevelWhitespace() <br />in System.Xml.XmlTextReaderImpl.ParseDocumentContent() <br />in System.Xml.XmlTextReaderImpl.Read() <br />in System.Xml.XmlLoader.LoadDocSequence(XmlDocument parentDoc) <br />in System.Xml.XmlLoader.Load(XmlDocument doc, XmlReader reader, Boolean preserveWhitespace) <br />in System.Xml.XmlDocument.Load(XmlReader reader) <br />in log4net.Config.XmlConfigurator.Configure(ILoggerRepository repository, Stream configStream)</pre>
<p>&#0160;</p>
<p>To make TBBatch.exe functions correctly, unzip the attached <span class="asset  asset-generic at-xid-6a0167607c2431970b017d4148b77a970c"><span class="asset  asset-generic at-xid-6a0167607c2431970b017ee8bca809970d"><a href="http://adndevblog.typepad.com/files/app-1.zip">config</a></span></span>&#0160;file and
then try to copy the same file to the bin directory and rename the file to
‘TBBatch.exe.config’. This should help in resolving the above mentioned issue.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Accessing AutoCAD Civil 3D Alignment Design Speeds using .NET API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: accessing-autocad-civil-3d-alignment-design-speeds-using-net-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2012
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/02/accessing-autocad-civil-3d-alignment-design-speeds-using-net-api.html 
DATE: 02/25/2013 12:25:06 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>For a given
<strong>Alignment</strong> object in AutoCAD Civil 3D, we want to find out the all the
&#39;<em><strong>Station</strong></em>&#39; values and the corresponding &#39;<em><strong>Design Speed</strong></em>&#39; as shown in the
screenshot below -</p>
<p>&#0160;</p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017ee8b7d3e3970d-pi" style="display: inline;"><img alt="AlignmentDesignSpeed01" class="asset  asset-image at-xid-6a0167607c2431970b017ee8b7d3e3970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017ee8b7d3e3970d-500wi" title="AlignmentDesignSpeed01" /></a></p>
<p>We can access
these values using <strong>DesignSpeed</strong> class in Civil 3D .NET API. </p>
<p>Here is a relevant code snippet in C# -</p>
<p>&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">Alignment</span><span style="line-height: 140%;"> objAlignment = trans.GetObject(alignmentId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForRead) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Alignment</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">foreach</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">DesignSpeed</span><span style="line-height: 140%;"> objDS </span><span style="color: blue; line-height: 140%;">in</span><span style="line-height: 140%;"> objAlignment.DesignSpeeds)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\n\tDesign Speed Number :{0} -- Start Station: {1} --- Design Speed Value :{2}&quot;</span><span style="line-height: 140%;">, </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; objDS.SpeedNumber.ToString(), objDS.Station.ToString(), objDS.Value.ToString() );&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160;&#0160; </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017c3714ae3d970b-pi" style="display: inline;"><img alt="AlignmentDesignSpeed02" class="asset  asset-image at-xid-6a0167607c2431970b017c3714ae3d970b" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017c3714ae3d970b-500wi" title="AlignmentDesignSpeed02" /></a><br /><br /></p>
<p>Hope this is useful to you!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: AutoCAD Map 3D API Training content : Part-1
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: autocad-map-3d-api-training-content-part-1
CATEGORY: .NET
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: AutoLISP
CATEGORY: C++
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/02/autocad-map-3d-api-training-content-part-1.html 
DATE: 02/22/2013 02:55:50 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>Most of you
working on customizing and application development on AutoCAD Map 3D must be
aware of broad range of API support in Map 3D which includes ActiveX, AutoLISP,
ObjectARX, Geospatial Platform, Feature Data Objects (FDO) and Industry Data
Model (aka Topobase) API.&#0160;</p>
<p>&#0160;</p>
<p>Here is a
quick highlight of these APIs and their supported technology platform -&#0160;</p>
<p>ObjectARX and
FDO are exposed as C++ and also .NET.&#0160;</p>
<p>Geospatial
Platform is exposed as .NET only.&#0160;</p>
<p>Industry Data
Model (aka Topobase) API gives access to Industry Data Model (aka Topobase)
feature and functionalities in Map 3D using .NET.&#0160;</p>
<p>ActiveX and
AutoLISP cover Autodesk Data Extension functionality (ADE), which includes
drawing sets, queries, and object data.&#0160;</p>
<p>AutoLISP also
covers map plotting and topology.</p>
<p>&#0160;</p>
<p>AutoCAD <strong>Map
3D Wikihelp</strong> (<a href="http://wikihelp.autodesk.com/AutoCAD_Map_3D">http://wikihelp.autodesk.com/AutoCAD_Map_3D</a>
) contains online API reference documents and the related Developer&#39;s guide
which are very detailed and helpful in application development on Map 3D.</p>
<p>&#0160;</p>
<p>So, why am I
writing all these which are nothing new to Map 3D developers and developer community?
Ok, here is the reason - We have thought to publish the relevant Map 3D API
training content through our Infrastructure Modeling DevBlog (<a href="http://adndevblog.typepad.com/infrastructure/">http://adndevblog.typepad.com/infrastructure/</a>
). </p>
<p>In a series
of blog posts in the coming days / months you will see most of the Map 3D API
training content (PDF and code samples) will be published here. In today&#39;s post
I am attaching the Map 3D Geospatial Platform API Overview&#0160;<span class="asset  asset-generic at-xid-6a0167607c2431970b017d41366eb6970c"><a href="http://adndevblog.typepad.com/files/chapter-1.pdf">Chapter 1</a></span>.</p>
<p>&#0160;</p>
<p>Hope this is
useful to you!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Resolving Style conflicts in exporting Civil 3D Object styles using .NET API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: resolving-style-conflicts-in-exporting-styles-using-net-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2011
CATEGORY: AutoCAD Civil 3D 2012
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/02/resolving-style-conflicts-in-exporting-styles-using-net-api.html 
DATE: 02/20/2013 06:22:50 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p><strong>StyleConflictResolverType
</strong>Enumeration specifies how to resolve conflicts (the same name for an existing
style and a new imported style) when exporting styles to another drawing using
StyleBase::<em><strong>ExportTo()</strong></em>.&#0160;</p>
<p>Members
of&#0160; StyleConflictResolverType Enumeration
-&#0160;</p>
<pre>CancelRemaining<br />Rename<br />Ignore<br />Override</pre>
<p>Here is a C#
.NET code snippet which demonstrates how to use
Autodesk.Civil.<strong>StyleConflictResolverType</strong> in resolving conflicts -</p>
<p>&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">LabelStyleCollection</span><span style="line-height: 140%;"> lStyles = civilDoc.Styles.LabelStyles.PointLabelStyles.LabelStyles;</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">foreach</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> stId </span><span style="color: blue; line-height: 140%;">in</span><span style="line-height: 140%;"> lStyles)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">LabelStyle</span><span style="line-height: 140%;"> pSt = trans.GetObject(stId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForRead) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">LabelStyle</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// Export the style</span></p>
<p style="margin: 0px;"><span style="background-color: #ffff40;"><span style="line-height: 140%;">&#0160; pSt.ExportTo(outDb, Autodesk.Civil.</span><span style="color: #2b91af; line-height: 140%;">StyleConflictResolverType</span><span style="line-height: 140%;">.Override);</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// Now export its children</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">for</span><span style="line-height: 140%;"> (</span><span style="color: blue; line-height: 140%;">int</span><span style="line-height: 140%;"> i = 0; i &lt; pSt.ChildrenCount; i++)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">LabelStyle</span><span style="line-height: 140%;"> chSt = trans.GetObject(pSt[i], </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForRead) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">LabelStyle</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="background-color: #ffff40;"><span style="line-height: 140%;">&#0160; &#0160; chSt.ExportTo(outDb, Autodesk.Civil.</span><span style="color: #2b91af; line-height: 140%;">StyleConflictResolverType</span><span style="line-height: 140%;">.Override);</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
<p>Hope this is useful to you!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Is there a .NET equivalent for ade_projentityforward ?
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: is-there-a-net-equivalent-for-ade_projentityforward-
CATEGORY: .NET
CATEGORY: AutoCAD Map 3D 2011
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: AutoLISP
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/02/is-there-a-net-equivalent-for-ade_projentityforward-.html 
DATE: 02/14/2013 04:30:00 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p><strong>ade_*
</strong>functions are not exposed in the .NET API. We can work around this by defining a
LISP command and calling <strong>ade_*</strong> function in it and then in .NET application
invoke the command defined in LISP. See the bellow codes.</p>
<p>(defun
c:LispADE ()<br />
(setq cscode (ade_projgetwscode))<br />
(if (= cscode null)<br />
(progn<br />
(alert &quot;Error in getting current coordinate system!&quot;)<br />
(exit)<br />
)<br />
)<br />
(setq rt (ade_projsetsrc &quot;LL84&quot;))<br />
(if (/= rt t)<br />
(progn<br />
(alert &quot;Error in getting current coordinate system!&quot;)<br />
(exit)<br />
)<br />
)<br /><br />
(setq rt1 (ade_projsetdest cscode))<br />
(if (/= rt1 t)<br />
(progn<br />
(alert &quot;Error in setting destination coordinate system!&quot;)<br />
(exit)<br />
)<br />
)<br />
(setq entdata (car (entsel &quot;select entity:&quot;)))<br />
(setq rt2 (ade_projentityforward entdata))<br />
(if (/= rt2 t)<br />
(progn<br />
(alert<br />
&quot;Error in projecting entity to destination coordinate system!&quot;<br />
)<br />
(exit)<br />
)<br />
(alert &quot;ok&quot;)<br />
)<br /><br />
)<br /><br /></p>
<p>The .NET invoking code is here:</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="line-height: 140%;">[</span><span style="color: #2b91af; line-height: 140%;">CommandMethod</span><span style="line-height: 140%;">(</span><span style="color: #a31515; line-height: 140%;">&quot;MyADE&quot;</span><span style="line-height: 140%;">)]</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">public</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">void</span><span style="line-height: 140%;"> InvokeAdeFun()</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; Autodesk.AutoCAD.ApplicationServices.</span><span style="color: #2b91af; line-height: 140%;">Application</span><span style="line-height: 140%;">.DocumentManager.MdiActiveDocument.SendStringToExecute(</span><span style="color: #a31515; line-height: 140%;">&quot;LispADE&quot;</span><span style="line-height: 140%;">, </span><span style="color: blue; line-height: 140%;">false</span><span style="line-height: 140%;">, </span><span style="color: blue; line-height: 140%;">true</span><span style="line-height: 140%;">, </span><span style="color: blue; line-height: 140%;">false</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
<p>&#0160;</p>
<p>Hope this is useful to you!</p>
<p>&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: RasmusB
EMAIL: rfb@focus.no
IP: 195.18.137.50
URL: 
DATE: 02/15/2013 12:13:04 AM
What's wrong with, e.g.:
ResultBuffer buf = new ResultBuffer();

TypedValue tv = 
new TypedValue(5005, "ade_projentityforward");

buf.Add(tv);

ResultBuffer ans = Application.Invoke(buf);

//and so on...?
-----
COMMENT:
AUTHOR: RasmusB
EMAIL: rfb@focus.no
IP: 195.18.137.50
URL: 
DATE: 02/15/2013 12:17:47 AM
Sorry, for the first call, the TypedValue should be:

TypedValue tv = 
new TypedValue(5005, "ade_projgetwscode");
-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 203.202.234.243
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 02/18/2013 02:12:06 AM
Hi RasmusB,

ade_projentityforward is a LISP function not a command name.

Thanks,
Partha
-----
COMMENT:
AUTHOR: RasmusB
EMAIL: rfb@focus.no
IP: 195.18.137.50
URL: 
DATE: 02/21/2013 12:34:05 AM
So, every call but the last, ade_projentityforward, can be made in .NET by using Application.Invoke? At least, they all work for me, but invoking ade_projentityforward seems to be returning null as long as cscode != "".
-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Accessing Child Object Style using .NET API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: accessing-child-object-style-using-net-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2012
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/02/accessing-child-object-style-using-net-api.html 
DATE: 02/13/2013 08:51:02 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>In this
particular example we will see how to access Civil 3D Surface Spot Elevation
Child label style. Suppose there is a Surface Spot Elevation Child label style
named &quot;Foot Meter_Child&quot; in a Civil 3D DWG file and we try to use the
following VB.NET code snippet to find out the number of Spot Elevation label
style in the same DWG file, child label styles won&#39;t be shown or counted as
shown in the screenshot below -</p>
<p><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> surfaceSpotElevnLblStyle </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">LabelStyleCollection</span><span style="line-height: 140%;"> = civilDoc.Styles.LabelStyles.SurfaceLabelStyles.SpotElevationLabelStyles</span></p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="line-height: 140%;">MsgBox(</span><span style="color: #a31515; line-height: 140%;">&quot;This DWG File has : &quot;</span><span style="line-height: 140%;"> + <span style="background-color: #ffff40;">surfaceSpotElevnLblStyle.Count.ToString</span> + </span><span style="color: #a31515; line-height: 140%;">&quot; Surface Spot Elevn Label Styles !&quot;</span><span style="line-height: 140%;">)</span></p>
</div>
<p>&#0160;</p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017c36dcd36a970b-pi" style="display: inline;"><img alt="Child_Label_Style_01" class="asset  asset-image at-xid-6a0167607c2431970b017c36dcd36a970b" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017c36dcd36a970b-500wi" title="Child_Label_Style_01" /></a></p>
<p>&#0160;</p>
<p>Above code
snippet shows the count of &#39;Spot Elevation&#39; labels as two omitting the child label
style.&#0160; So how do we access Child
Object Style using .NET API ?</p>
<p>We can access
child label style from the parent label style&#39;s ObjectId using [index]. Here is
the relevant VB.NET code snippet -</p>
<p>&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">Try</span><span style="line-height: 140%;"> </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> surfaceSpotElevnLblStyle </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">LabelStyleCollection</span><span style="line-height: 140%;"> = civilDoc.Styles.LabelStyles.SurfaceLabelStyles.SpotElevationLabelStyles</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">&#39;MsgBox(&quot;This DWG File has : &quot; + surfaceSpotElevnLblStyle.Count.ToString + &quot; Surface Spot Elevn Label Styles !&quot;) </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> surfaceLblStyleId </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> = </span><span style="color: blue; line-height: 140%;">Nothing</span><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> osurfaceElevnLabelStyle </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">LabelStyle</span><span style="line-height: 140%;">&#0160; = </span><span style="color: blue; line-height: 140%;">Nothing</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">For</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Each</span><span style="line-height: 140%;"> surfaceLblStyleId </span><span style="color: blue; line-height: 140%;">In</span><span style="line-height: 140%;"> surfaceSpotElevnLblStyle </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; osurfaceElevnLabelStyle = trans.GetObject(surfaceLblStyleId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForRead) </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; MsgBox(</span><span style="color: #a31515; line-height: 140%;">&quot;Style Name : &quot;</span><span style="line-height: 140%;"> + osurfaceElevnLabelStyle.Name.ToString + </span><span style="color: #a31515; line-height: 140%;">&quot;&#0160; &quot;</span><span style="line-height: 140%;"> + </span><span style="color: #a31515; line-height: 140%;">&quot;Children Style Count : &quot;</span><span style="line-height: 140%;"> + osurfaceElevnLabelStyle.ChildrenCount.ToString) </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">If</span><span style="line-height: 140%;"> (osurfaceElevnLabelStyle.ChildrenCount &gt;0) </span><span style="color: blue; line-height: 140%;">then</span><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160;&#0160; </span></p>
<p style="margin: 0px;"><span style="background-color: #ffff40;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> childLblStyleId </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> =&#0160;&#0160; osurfaceElevnLabelStyle(0) </span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> childLblStyle </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">LabelStyle</span><span style="line-height: 140%;"> = trans.GetObject(childLblStyleId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForRead) </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; MsgBox(</span><span style="color: #a31515; line-height: 140%;">&quot;Child Style Name :&quot;</span><span style="line-height: 140%;"> + childLblStyle.Name.ToString)&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160;&#0160; </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">If</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Next</span><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160;&#0160; </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; trans.Commit()&#0160; &#0160; &#0160; &#0160;&#0160; </span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">Catch</span><span style="line-height: 140%;"> ex </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Exception</span><span style="line-height: 140%;"> </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;Exception Message is : &quot;</span><span style="line-height: 140%;"> + ex.Message.ToString()) </span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">Exit Sub</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Try</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;"><br /></span></p>
</div>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017ee87faf6f970d-pi" style="display: inline;"><img alt="Child_Label_Style_02" class="asset  asset-image at-xid-6a0167607c2431970b017ee87faf6f970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017ee87faf6f970d-500wi" title="Child_Label_Style_02" /></a><br /><br /></p>
<p>Hope this is
useful to you!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Steve Hill
EMAIL: stevenh0616@gmail.com
IP: 173.161.87.42
URL: http://www.beyondcivil3d.blogspot.com
DATE: 02/14/2013 05:57:13 AM
Thank you so much for posting this Partha!! Very Helpful as the child styles can be confusing, and not apparent as to where they can be found.
-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 59.92.134.24
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 02/14/2013 09:06:41 AM
You are welcome Steve !

Cheers,
Partha
ADN
-----
COMMENT:
AUTHOR: Erick C
EMAIL: econnerly@gmail.com
IP: 71.118.181.38
URL: 
DATE: 10/18/2013 10:11:40 PM
Does anyone know a way for a "find and replace" type routine for text manually added to labels? In this case I have over 100 note labels that I have to manually edit. These notes were street CL intersections that were Sta xx+xx.xx B Street. Now we have all the street names and need to change them. 
-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 59.92.135.96
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 10/21/2013 12:04:49 AM
Hi Erick -

You might have to iterate through the note labels and handle the replacement in your custom routine. 

Thanks,
Partha
-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Autodesk.Map.IM.Display.GraphicsGeneration.GraphicsGeneratorFactory is obsolete!
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: autodeskmapimdisplaygraphicsgenerationgraphicsgeneratorfactory-is-obsolete
CATEGORY: .NET
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/02/autodeskmapimdisplaygraphicsgenerationgraphicsgeneratorfactory-is-obsolete.html 
DATE: 02/08/2013 12:52:29 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>If you are
trying to create an instance of IGraphicsGenerator in Map 3D 2013 from
<em><strong>GraphicsGeneratorFactory.Instance</strong></em>, you might see the following compiler error -&#0160;</p>
<p><em>Autodesk.Map.IM.Display.GraphicsGeneration.GraphicsGeneratorFactory&#39;
is obsolete: &#39;No longer supported; the graphic generator is no longer a
singleton. It is a service instead, use
Application.Services.GetService&lt;IGraphicsGenerator&gt;().&#39;</em>&#0160;</p>
<p><em>Public Shared
ReadOnly Property Instance As
Autodesk.Map.IM.Display.GraphicsGeneration.IGraphicsGenerator&#39; is obsolete: &#39;No
longer supported; the graphic generator is no longer a singleton. It is a
service instead, use
Application.Services.GetService&lt;IGraphicsGenerator&gt;().</em></p>
<p>&#0160;</p>
<p>In Map 3D
2013 Industry Data Model API, you can access IGraphicsGenerator&#0160; like below :</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="background-color: #ffff00;"><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> gg </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">IGraphicsGenerator</span><span style="line-height: 140%;"> = </span></span></p>
<p style="margin: 0px;"><span style="background-color: #ffff00;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">Me</span><span style="line-height: 140%;">.Application.Services.GetService(</span><span style="color: blue; line-height: 140%;">Of</span><span style="line-height: 140%;"> Autodesk.Map.IM.Display.GraphicsGeneration.</span><span style="color: #2b91af; line-height: 140%;">IGraphicsGenerator</span><span style="line-height: 140%;">)()</span></span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">If</span><span style="line-height: 140%;"> gg </span><span style="color: blue; line-height: 140%;">Is</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Nothing</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Then</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Me</span><span style="line-height: 140%;">.Application.MsgBox(</span><span style="color: #a31515; line-height: 140%;">&quot;Graphic generator is not registered.&quot;</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Return</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">If</span></p>
<p style="margin: 0px;">&#0160;</p>
<p>Hope this is
useful to you!</p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;"><br /></span></p>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Creating Surface Spot Elevation Label using Civil 3D .NET API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: creating-surface-spot-elevation-label-using-civil-3d-net-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/02/creating-surface-spot-elevation-label-using-civil-3d-net-api.html 
DATE: 02/04/2013 10:24:19 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>In <a class="zem_slink" href="http://www.autodesk.com/autocad" rel="homepage" target="_blank" title="AutoCAD">AutoCAD
Civil 3D</a>, we can create different types of Labels for a Civil 3D Surface object.
In the screenshot below, we can see from Annotation Tab, using the Add Labels,
we can add a spot Elevation Label, Contour Label etc. for a Surface object.</p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017d40c6ebc0970c-pi" style="display: inline;"><img alt="Surface_Add_Label" class="asset  asset-image at-xid-6a0167607c2431970b017d40c6ebc0970c" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017d40c6ebc0970c-500wi" title="Surface_Add_Label" /></a><br /><br /></p>
<p>Civil 3D <a class="zem_slink" href="http://msdn.microsoft.com/netframework" rel="homepage" target="_blank" title=".NET Framework">.NET</a>
<a class="zem_slink" href="http://en.wikipedia.org/wiki/Application_programming_interface" rel="wikipedia" target="_blank" title="Application programming interface">API</a> has equivalent functions for creating Labels programmatically for many of
these options as shown in the above screenshot.</p>
<p>If you want
to create Surface Spot Elevation Label or Contour Label, you can use the
following API -</p>
<p><strong>SurfaceElevationLabel.Create()</strong>&#0160;</p>
<p><strong>SurfaceContourLabelGroup.Create()</strong>&#0160;</p>
<p>&#0160;</p>
<p>In this C#
.NET code snippet below, we can see how to create TIN surface spot elevation -</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">//select a surface</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">PromptEntityOptions</span><span style="line-height: 140%;"> selSurface = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">PromptEntityOptions</span><span style="line-height: 140%;">(</span><span style="color: #a31515; line-height: 140%;">&quot;\nSelect a Tin Surface: &quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">selSurface.SetRejectMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nOnly Tin Surface is allowed&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">selSurface.AddAllowedClass(</span><span style="color: blue; line-height: 140%;">typeof</span><span style="line-height: 140%;">(</span><span style="color: #2b91af; line-height: 140%;">TinSurface</span><span style="line-height: 140%;">), </span><span style="color: blue; line-height: 140%;">true</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">PromptEntityResult</span><span style="line-height: 140%;"> resSurface = ed.GetEntity(selSurface);</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (resSurface.Status != </span><span style="color: #2b91af; line-height: 140%;">PromptStatus</span><span style="line-height: 140%;">.OK) </span><span style="color: blue; line-height: 140%;">return</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> surfaceId = resSurface.ObjectId;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">//select a Point to Add Elevation Label</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">PromptPointOptions</span><span style="line-height: 140%;"> ppo = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">PromptPointOptions</span><span style="line-height: 140%;">(</span><span style="color: #a31515; line-height: 140%;">&quot;\nSelect a Point to Add Spot Elevation Label: &quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">PromptPointResult</span><span style="line-height: 140%;"> ppr = ed.GetPoint(ppo);</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (ppr.Status != </span><span style="color: #2b91af; line-height: 140%;">PromptStatus</span><span style="line-height: 140%;">.OK) </span><span style="color: blue; line-height: 140%;">return</span><span style="line-height: 140%;">;&#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Prepare the Elevation</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">double</span><span style="line-height: 140%;"> x = ppr.Value.X;</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">double</span><span style="line-height: 140%;"> y = ppr.Value.Y;</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">Point2d</span><span style="line-height: 140%;"> pnt2d = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Point2d</span><span style="line-height: 140%;">(x, y);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">Database</span><span style="line-height: 140%;"> db = </span><span style="color: #2b91af; line-height: 140%;">Application</span><span style="line-height: 140%;">.DocumentManager.MdiActiveDocument.Database;</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">Transaction</span><span style="line-height: 140%;"> trans = db.TransactionManager.StartTransaction())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">try</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; {</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// create the spot elevation using SurfaceElevationLabel.Create</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="background-color: #ffff00;"><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> surfaceElevnLblId = </span><span style="color: #2b91af; line-height: 140%;">SurfaceElevationLabel</span><span style="line-height: 140%;">.Create(surfaceId, pnt2d);</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">SurfaceElevationLabel</span><span style="line-height: 140%;"> label = surfaceElevnLblId.GetObject(</span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForRead) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">SurfaceElevationLabel</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nSurface Spot Elevation Label created and Style Name is :&quot;</span><span style="line-height: 140%;"> + label.StyleName.ToString());</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; trans.Commit();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; }</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">catch</span><span style="line-height: 140%;"> (Autodesk.AutoCAD.Runtime.</span><span style="color: #2b91af; line-height: 140%;">Exception</span><span style="line-height: 140%;"> ex)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\n Exception message :&quot;</span><span style="line-height: 140%;"> + ex.Message);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
<p>&#0160;</p>
<p>And here is
the result -</p>
<p>&#0160;</p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017ee83baedb970d-pi" style="display: inline;"><img alt="SurfaceElevationLabel" class="asset  asset-image at-xid-6a0167607c2431970b017ee83baedb970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017ee83baedb970d-500wi" title="SurfaceElevationLabel" /></a><br /><br /></p>
<p>&#0160;</p>
<p>Hope this is
useful to you!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:
.NET API, AutoCAD Civil 3D, Surface, Labels
-----
COMMENT:
AUTHOR: Steve
EMAIL: stevenh0616@gmail.com
IP: 173.161.87.42
URL: http://www.beyondcivil3d.blogspot.com
DATE: 02/05/2013 05:33:52 AM
Great post Partha, thanks!!

One question regarding surface labels...

If I wanted to add a selection for the style to be used and wanted to list all the styles for a spot elevation label, how can I get the child styles? I know how to get the parent styles through  Dim styles As ACD.Styles.LabelStyleCollection = CivilDoc.Styles.LabelStyles.SurfaceLabelStyles.SpotElevationLabelStyles, but the Child styles are stumping me.

I would suppose they would be a part of the parent style. So my thought was to check the children count on each style, and if > 0 then loop through the children.

Are child style stored under Item? If so, what else is stored under item, as it throws errors when I try to cast the each item to a LabelStyle type.

Thanks.
-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 203.202.234.243
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 02/05/2013 10:51:20 PM
Hi Steve,

You can access the Surface Spot Elevation Child label style from the parent label style through index or name like the following -

If (osurfaceElevnLabelStyle.ChildrenCount >0) then               
   Dim childLblStyleId As ObjectId =   osurfaceElevnLabelStyle(0)
End If

Let me post this in detail in another topic soon.

Thanks,
Partha
ADN

-----
COMMENT:
AUTHOR: Steve Hill
EMAIL: stevenh0616@gmail.com
IP: 173.161.87.42
URL: http://www.beyondcivil3d.blogspot.com
DATE: 07/15/2013 11:38:48 AM
Partha,

One additional question I ran into the other day is apply the surface labels to an XREF'd Drawing's surface. The Civil 3D command allows for this, and I've actually been able to do it with .NET as well. My issue is that when a surface label is applied to the ObjectID of a surface that resides in the XREF, the label is embedded into the XREF block in the current drawing. Thus leaving it unselectable or modifiable - and deceiving to other users as the label is not technically in the XREF drawing - just in the XREF block of the current drawing.

Can you point me in the right direction to make this work?

Thanks.

Steve
-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 203.202.234.243
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 07/17/2013 10:52:32 PM
Hi Steve,

There is no direct way to achieve it other than opening the Xref file and do the modifcation using .NET API. In ADN Knowledge base we have a devnote on "Editing Xref In-place" that lists the detailed steps using C++ / ObjectARX API.

Thanks,
Partha
-----
COMMENT:
AUTHOR: Steve Hill
EMAIL: stevenh0616@gmail.com
IP: 173.161.87.42
URL: http://www.beyondcivil3d.blogspot.com
DATE: 07/31/2013 02:02:25 PM
Thanks for the reply Partha.

Can you clarify a bit more with this, because I'm not looking to edit the XREF at all, just reference it. In Civil 3D it is possible to do add a surface label, select an XREF'd surface and place the label. The label resides in the current drawing, but the datasource surface is the XREF'd surface.

I have achieved this for the most part by searching through the block table for record entities that are of the Civil 3D surface type. Then I add a label referenced to the surface object. It does work, however the label is embedded in the XREF block of my current drawing. I want the label to be in the current drawing and reference the XREF surface.

Are you saying it's not possible to achieve because it's not available in the .NET API?

Thanks.
-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: FastCGI must be properly configured before attempting to connect to Map Server.
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: fastcgi-must-be-properly-configured-before-attempting-to-connect-to-map-server
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/01/fastcgi-must-be-properly-configured-before-attempting-to-connect-to-map-server.html 
DATE: 01/30/2013 07:31:22 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>You may run into this error when logging Autodesk Infrastructure Map Server with Infrastructure Studio:</p>  <p>---------------------------   <br />Unable to complete request to Site    <br />---------------------------    <br />FastCGI must be properly configured before attempting to connect to Map Server.</p>  <p>&#160;&#160;&#160; </p>  <p>Here are something you need to check:</p>  <p>1. To make sure CGI is installed in IIS. Open Control Panel\All Control Panel Items\Programs and Features –&gt; Turn Windows Features on or off, check <strong>CGI</strong>: </p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017d409fb46d970c-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017c3671351e970b-pi" width="352" height="306" /></a></p>  <p>2. Disable “<strong>ASP.NET Impersonation</strong>” in IIS manager for MapServer2013. Click mapserver2013, select Authentication to open authentication page, select “ASP.NET Impersonation” and click “Disable” from right.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017d409fb525970c-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017d409fb5e6970c-pi" width="388" height="348" /></a><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017c36713611970b-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017ee814773c970d-pi" width="385" height="199" /></a></p>  <p>Make sure that this web application(mapserver2013) in running in <strong>MapServer2013AppPool</strong>: </p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017ee814779d970d-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017c36713752970b-pi" width="382" height="306" /></a></p>  <p>3. Set the <strong>Enable 32bit applications </strong>to false. Click MapServer2013AppPool from Application Pools and click “Advanced Settings…” from right pane. Switch<strong> Enable 32bit applications</strong> to <strong>False</strong>.</p>      <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017ee81478c7970d-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017ee8147902970d-pi" width="425" height="302" /></a></p>    <p>&#160;</p>  <p>You may want to check out this <a href="http://adndevblog.typepad.com/infrastructure/2012/04/install-autodesk-infrastructure-map-server-2013-step-by-step.html">post</a> as well. </p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Johann
EMAIL: johannc@cf22.co.za
IP: 196.14.16.35
URL: 
DATE: 08/15/2013 03:54:36 AM
Switch from integrated to classic mode worked for me
-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Adding boundaries to Civil 3D Surface object using .NET API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: adding-boundaries-to-civil-3d-surface-object-using-net-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2012
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/01/adding-boundaries-to-civil-3d-surface-object-using-net-api.html 
DATE: 01/29/2013 09:56:29 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>We can add
boundaries to Civil 3D Surface object using the <strong>SurfaceDefinitionBoundaries
</strong>class; this class encapsulates the boundary operation list for a surface. Note
that, operations are stored in the order they are performed on the surface.
<strong>SurfaceDefinitionBoundaries</strong> class has overloaded function <strong>AddBoundaries()</strong>. In
the following example we will see how to add boundaries to a surface from a
collection of entity ObjectIds using SurfaceOperationAddBoundary
<strong>AddBoundaries<em>(ObjectIdCollection </em></strong><em>boundaryEntities</em><em>&#0160;</em><strong><em>, double </em></strong><em>midOrdinateDistance</em><strong><em>,  SurfaceBoundaryType </em></strong><em>boundaryType</em><strong><em>, bool
</em></strong><em>useNonDestructiveBreakline</em><strong><em> )</em></strong>&#0160;</p>
<p>There are few
important notes on this API mentioned in Civil 3D .NET API Reference document
which I am highlighting below -&#0160;</p>
<ol>
<li>The parameter
useNonDestructiveBreakline is ignored for a GridVolumeSurface or TinSurface
with a DataClip boundary type.</li>
<li>When creating
the DataClip/Outer boundary, the first ObjectId in boundaryEntities is used,
and any other ObjectIds in the collection are ignored.</li>
<li>The first
boundary in the boundaryEntities should be closed when creating a DataClip
boundary.</li>
</ol>
<p>&#0160;</p>
<p>And here is a
C# .NET code snippet on usage of this API -&#0160;</p>
<p>&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">try</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">TinSurface</span><span style="line-height: 140%;"> surface = trans.GetObject(surfaceId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForWrite) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">TinSurface</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// Add the selected polyline&#39;s ObjectId to a collection</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">ObjectIdCollection</span><span style="line-height: 140%;"> boundaryEntities = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">ObjectIdCollection</span><span style="line-height: 140%;">();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; boundaryEntities.Add(plineId);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// Access the BoundariesDefinition object from the surface object</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="background-color: #ffff00;"><span style="color: #2b91af; line-height: 140%;">SurfaceDefinitionBoundaries</span><span style="line-height: 140%;"> surfaceBoundaries = surface.BoundariesDefinition;</span></span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// now add the boundary to the surface</span></p>
<p style="margin: 0px;"><span style="background-color: #ffff40;"><span style="line-height: 140%;">&#0160; surfaceBoundaries.AddBoundaries(boundaryEntities, 1.0, </span><span style="color: #2b91af; line-height: 140%;">SurfaceBoundaryType</span><span style="line-height: 140%;">.Outer, </span><span style="color: blue; line-height: 140%;">true</span><span style="line-height: 140%;">);</span></span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; trans.Commit();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
<p>&#0160;</p>
<p>Hope this is useful to you!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Setting minimum and maximum scale for AIMS/MapGuide viewer
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: setting-minimum-and-maximum-scale-for-aims-viewer
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/01/setting-minimum-and-maximum-scale-for-aims-viewer.html 
DATE: 01/29/2013 09:43:17 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>In the Ajax Viewer, you can force the minimum and maximum scale zoom available for the user by modifying the following values in the file ..\WebServerExtensions\www\viewerfiles\ajaxmappane.templ :</p>  <p><i>var minScale = 1000, maxScale = 100000000;</i></p>  <p>The minimum scale zoom in this example is 1:1000 and the maximum scale zoom 1:100000000</p>  <p>In Fusion Viewer you can modify the minscale value (about line 338) in the LoadMap.php in the fusion\layers\MapGuide\php folder and this appears to do the trick. The line number may be different in different releases. Please note that there are 2 LoadMap.php in AIMS, you need to to edit the one in </p>  <p>C:\Program Files\Autodesk\Autodesk Infrastructure Web Server Extension 2013\www\fusion\layers\<strong>MapGuide</strong>\php\LoadMap.php: </p>  <p>$minScale = &quot;0&quot;;&#160; //Edit this value</p>  <p>$maxScale = 'infinity'; // as MDF's VectorScaleRange::MAX_MAP_SCALE</p>  <p>&#160;</p>  <p>Please note that this is a global setting, it applies to all layers even all web applications hosted in this MapServer. If you just want to change one specific layer, you can edit the layer definition: </p>  <p>&lt;VectorScaleRange&gt;   <br /> &lt;&lt;MinScale&gt;500&lt;/MinScale&gt;     <br /> &lt;&lt;MaxScale&gt;10000&lt;/MaxScale&gt;&#160; <br />...</p>  <p> &lt;/VectorScaleRange&gt;</p>  <p>It can be set in MapGuide Studio layer editor.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017d40a00950970c-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017ee814d847970d-pi" width="451" height="119" /></a></p>  <p>It can be done by API as well, using resource service. And further more, you can even make it user-specific by applying it to a temporary layer. Please refer the sample solution for a demo of resource resource(sokution3) and demo of temp layer(solution 5/6),they can be download from <a href="http://adndevblog.typepad.com/infrastructure/2012/05/devtv-and-code-sample-create-temporary-layer-feature-editing-in-aims2012.html">here</a>.</p>  <p>Hope this helps. </p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Import DEM to Create Surface in Civil 3D with COM API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: import-dem-to-create-surface-in-civil-3d-with-com-api
CATEGORY: AutoCAD Civil 3D 2012
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/01/import-dem-to-create-surface-in-civil-3d-with-com-api.html 
DATE: 01/28/2013 07:58:11 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>Civil 3D provides .NET API and COM API, you are recommended to use .NET API if it is available, although this post will demo how to import DEM with COM API.</p>  <p>To use COM API, you need to add some references with interop, it is convenient to use <a href="http://adndevblog.typepad.com/infrastructure/2012/05/autocad-net-wizard-support-map-3d-civil-3d-autocad-architecture-and-autocad-mep-now.html">AutoCAD .net wizard</a>, it supports Civil 3D as well as other AutoCAD vertical products. Please check following references with wizard, and please note that you may add other references if some are missing. </p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017d408b92f6970c-pi"><img style="background-image: none; border-right-width: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017c365d3130970b-pi" width="244" height="210" /></a><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017ee80031fc970d-pi"><img style="background-image: none; border-right-width: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017d408b9390970c-pi" width="244" height="213" /></a></p>  <p>The code snippet goes as below: </p>  <pre style="line-height: normal; text-indent: 0pt; font-family: ; background: white; word-break: normal"><font face="新宋体"><font color="#008000"><span style="line-height: normal; color: ">// (C) Copyright 2013 by Autodesk </span><br /><span style="line-height: normal; color: ">//</span></font><br /><span style="line-height: normal; color: "><font color="#0000ff">using</font></span><font color="#000000"> System;</font><br /><span style="line-height: normal; color: "><font color="#0000ff">using</font></span><font color="#000000"> Autodesk.AutoCAD.Runtime;</font><br /><span style="line-height: normal; color: "><font color="#0000ff">using</font></span><font color="#000000"> Autodesk.AutoCAD.ApplicationServices;</font><br /><span style="line-height: normal; color: "><font color="#0000ff">using</font></span><font color="#000000"> Autodesk.AutoCAD.DatabaseServices;</font><br /><span style="line-height: normal; color: "><font color="#0000ff">using</font></span><font color="#000000"> Autodesk.AutoCAD.Geometry;</font><br /><span style="line-height: normal; color: "><font color="#0000ff">using</font></span><font color="#000000"> Autodesk.AutoCAD.EditorInput;</font><br /><span style="line-height: normal; color: "><font color="#0000ff">using</font></span><font color="#000000"> System.Windows.Forms;</font><br /><span style="line-height: normal; color: "><font color="#0000ff">using</font></span><font color="#000000"> Autodesk.AECC.Interop.UiLand;</font><br /><span style="line-height: normal; color: "><font color="#0000ff">using</font></span><font color="#000000"> Autodesk.AutoCAD.Interop;</font><br /><span style="line-height: normal; color: "><font color="#0000ff">using</font></span></font><font face="新宋体"><font color="#000000"> Autodesk.Civil.ApplicationServices;<br /> <br /> </font><br /><span style="line-height: normal; color: "><font color="#008000">// This line is not mandatory, but improves loading performances</font></span><br /><font color="#000000">[</font><span style="line-height: normal; color: "><font color="#0000ff">assembly</font></span><font color="#000000">: </font><span style="line-height: normal; color: "><font color="#2b91af">CommandClass</font></span><font color="#000000">(</font><span style="line-height: normal; color: "><font color="#0000ff">typeof</font></span><font color="#000000">(LoadDEM_demo.</font><span style="line-height: normal; color: "><font color="#2b91af">MyCommands</font></span></font><font face="新宋体"><font color="#000000">))]<br /> </font><br /><span style="line-height: normal; color: "><font color="#0000ff">namespace</font></span></font><font face="新宋体"><font color="#000000"> LoadDEM_demo<br />{<br /> <br /> <br />&#160;&#160;&#160; </font><span style="line-height: normal; color: "><font color="#0000ff">public</font></span><font color="#000000">&#160;</font><span style="line-height: normal; color: "><font color="#0000ff">class</font></span><font color="#000000">&#160;</font><span style="line-height: normal; color: "><font color="#2b91af">MyCommands</font></span><br /></font><font face="新宋体"><font color="#000000">&#160;&#160;&#160; {<br />&#160;<br /> <br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="line-height: normal; color: "><font color="#008000">// COM objects:</font></span><br /><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="line-height: normal; color: "><font color="#0000ff">private</font></span><font color="#000000"> Autodesk.AutoCAD.Interop.</font><span style="line-height: normal; color: "><font color="#2b91af">IAcadApplication</font></span><font color="#000000"> m_oAcadApp = </font><span style="line-height: normal; color: "><font color="#0000ff">null</font></span></font><font face="新宋体"><font color="#000000">;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="line-height: normal; color: "><font color="#0000ff">private</font></span><font color="#000000"> Autodesk.AECC.Interop.UiLand.</font><span style="line-height: normal; color: "><font color="#2b91af">IAeccApplication</font></span><font color="#000000"> m_oAeccApp = </font><span style="line-height: normal; color: "><font color="#0000ff">null</font></span></font><font face="新宋体"><font color="#000000">;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="line-height: normal; color: "><font color="#0000ff">private</font></span><font color="#000000"> Autodesk.AECC.Interop.UiLand.</font><span style="line-height: normal; color: "><font color="#2b91af">IAeccDocument</font></span><font color="#000000"> m_oAeccDoc = </font><span style="line-height: normal; color: "><font color="#0000ff">null</font></span></font><font face="新宋体"><font color="#000000">;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="line-height: normal; color: "><font color="#0000ff">private</font></span><font color="#000000"> Autodesk.AECC.Interop.Land.</font><span style="line-height: normal; color: "><font color="#2b91af">IAeccDatabase</font></span><font color="#000000"> m_oAeccDb = </font><span style="line-height: normal; color: "><font color="#0000ff">null</font></span></font><font face="新宋体"><font color="#000000">;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="line-height: normal; color: "><font color="#0000ff">string</font></span><font color="#000000"> m_sAcadProdID = </font><span style="line-height: normal; color: "><font color="#a31515">&quot;AutoCAD.Application&quot;</font></span></font><font face="新宋体"><font color="#000000">;<br />        </font></font><span style="line-height: normal; color: "><font color="#008000">//Civil 3D 2013</font></span><font face="新宋体"><font color="#000000"><br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="line-height: normal; color: "><font color="#0000ff">string</font></span><font color="#000000"> m_sAeccAppProgId = </font><span style="line-height: normal; color: "><font color="#a31515">&quot;AeccXUiLand.AeccApplication.10.0&quot;</font></span><font color="#000000">;<br />        //Civil 3D 2012 </font><br /><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="line-height: normal; color: "><font color="#008000">//string m_sAeccAppProgId = &quot;AeccXUiLand.AeccApplication.9.0&quot;; </font></span><br /><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="line-height: normal; color: "><font color="#0000ff">private</font></span><font color="#000000">&#160;</font><span style="line-height: normal; color: "><font color="#0000ff">string</font></span><font color="#000000"> m_sMessage = </font><span style="line-height: normal; color: "><font color="#a31515">&quot;&quot;</font></span></font><font face="新宋体"><font color="#000000">;<br /> <br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; [</font><span style="line-height: normal; color: "><font color="#2b91af">CommandMethod</font></span><font color="#000000">(</font><span style="line-height: normal; color: "><font color="#a31515">&quot;LoadDemSurfaceop&quot;</font></span></font><font face="新宋体"><font color="#000000">)]<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="line-height: normal; color: "><font color="#0000ff">public</font></span><font color="#000000">&#160;</font><span style="line-height: normal; color: "><font color="#0000ff">void</font></span></font><font face="新宋体"><font color="#000000"> LoadDemSurface()<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="line-height: normal; color: "><font color="#0000ff">try</font></span><br /></font><font face="新宋体"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="line-height: normal; color: "><font color="#2b91af">OpenFileDialog</font></span><font color="#000000"> ofd = </font><span style="line-height: normal; color: "><font color="#0000ff">new</font></span><font color="#000000">&#160;</font><span style="line-height: normal; color: "><font color="#2b91af">OpenFileDialog</font></span></font><font face="新宋体"><font color="#000000">();<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ofd.Filter = </font><span style="line-height: normal; color: "><font color="#a31515">&quot;USGS DEM( *.DEM) |*.dem&quot;</font></span></font><font face="新宋体"><font color="#000000">;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ofd.FilterIndex = 0;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="line-height: normal; color: "><font color="#0000ff">if</font></span><font color="#000000"> (ofd.ShowDialog() == </font><span style="line-height: normal; color: "><font color="#2b91af">DialogResult</font></span></font><font face="新宋体"><font color="#000000">.OK)<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="line-height: normal; color: "><font color="#008000">//use COM</font></span><br /><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_oAcadApp = (</font><span style="line-height: normal; color: "><font color="#2b91af">IAcadApplication</font></span><font color="#000000">)System.Runtime.InteropServices<br />                                  .</font><span style="line-height: normal; color: "><font color="#2b91af">Marshal</font></span></font><font face="新宋体"><font color="#000000">.GetActiveObject(m_sAcadProdID);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="line-height: normal; color: "><font color="#0000ff">if</font></span><font color="#000000"> (m_oAcadApp != </font><span style="line-height: normal; color: "><font color="#0000ff">null</font></span></font><font face="新宋体"><font color="#000000">)<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_oAeccApp = (</font><span style="line-height: normal; color: "><font color="#2b91af">IAeccApplication</font></span></font><font face="新宋体"><font color="#000000">)m_oAcadApp<br />                                         .GetInterfaceObject(m_sAeccAppProgId);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_oAeccDoc = (</font><span style="line-height: normal; color: "><font color="#2b91af">IAeccDocument</font></span></font><font face="新宋体"><font color="#000000">)m_oAeccApp.ActiveDocument;<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_oAeccDoc.Surfaces.ImportDEM(ofd.FileName);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_oAeccDoc.Regen(Autodesk.AutoCAD.Interop.Common<br />                                      .</font><span style="line-height: normal; color: "><font color="#2b91af">AcRegenType</font></span></font><font face="新宋体"><font color="#000000">.acActiveViewport);<br /> <br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="line-height: normal; color: "><font color="#0000ff">else</font></span><br /></font><font face="新宋体"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="line-height: normal; color: "><font color="#0000ff">catch</font></span><font color="#000000"> (System.</font><span style="line-height: normal; color: "><font color="#2b91af">Exception</font></span></font><font face="新宋体"><font color="#000000"> e)<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="line-height: normal; color: "><font color="#2b91af">MessageBox</font></span></font><font face="新宋体"><font color="#000000">.Show(e.Message);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="line-height: normal; color: "><font color="#0000ff">finally</font></span><br /><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br />&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160; <br /> <br /> <br />&#160;&#160;&#160; }<br /> <br />}</font></font><br /></pre>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Convert Civil 3D SurveyFigure to Polyline object
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: convert-civil-3d-surveyfigure-to-polyline-object
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2012
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/01/convert-civil-3d-surveyfigure-to-polyline-object.html 
DATE: 01/21/2013 11:16:39 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>In some of the projects requirement, you may want to convert
the Civil 3D <strong>SurveyFigure</strong> objects to AutoCAD geometric object like polyline and
retain the curves, bulges etc. When you select a Civil 3D <strong>SurveyFigure</strong> object
and call the LIST command in Civil 3D, you would see each segment type and
associated details like the following screenshot.</p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017c3620587c970b-pi" style="display: inline;"><img alt="Survey_Fig-01" class="asset  asset-image at-xid-6a0167607c2431970b017c3620587c970b" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017c3620587c970b-500wi" title="Survey_Fig-01" /></a></p>
<p>&#0160;</p>
<p>From the Civil 3D SurveyFigure object we can access&#0160;<em><strong>BaseCurve</strong></em> to get the base geometry which we can then append to Civil
3D Model space. Here is the relevant code snippet :</p>
<p>&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">try</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">SurveyFigure</span><span style="line-height: 140%;"> survFig = trans.GetObject(survFigId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForWrite) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">SurveyFigure</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// get the projected curve from SurveyFigure</span><span style="line-height: 140%; font-size: 8pt;">&#0160;&#0160;</span></p>
<p style="margin: 0px;"><span style="background-color: #ffff40;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">Curve</span><span style="line-height: 140%;"> baseCurve = survFig.BaseCurve;</span></span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// Now append the curve to db</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">BlockTable</span><span style="line-height: 140%;"> table = trans.GetObject(db.BlockTableId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForRead) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">BlockTable</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">BlockTableRecord</span><span style="line-height: 140%;"> model = trans.GetObject(table[</span><span style="color: #2b91af; line-height: 140%;">BlockTableRecord</span><span style="line-height: 140%;">.ModelSpace], </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForWrite) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">BlockTableRecord</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; model.AppendEntity(baseCurve);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; trans.AddNewlyCreatedDBObject(baseCurve, </span><span style="color: blue; line-height: 140%;">true</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// Remove the SurveyFigure</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; survFig.Erase();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; trans.Commit();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
<p>&#0160;</p>
<p>&#0160;</p>
<p>And result of converting the SurveyFigure to Polyline object
:</p>
<p>&#0160;</p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017d404f5c6c970c-pi" style="display: inline;"><img alt="Survey_Fig-02" class="asset  asset-image at-xid-6a0167607c2431970b017d404f5c6c970c" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017d404f5c6c970c-500wi" title="Survey_Fig-02" /></a><br />
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Mark P.
EMAIL: mrp@coredesigninc.com
IP: 50.125.99.122
URL: 
DATE: 01/22/2013 08:04:40 AM
Great code Partha!

As a side note, I don't believe there is a need to call GetProjectedCurve() unless you want to project the baseCurve to a plane other than world.

Also, if the survey figure has different elevations at each vertex the curve information will be represented as 3d line segments.  In order for the curve data to come across in that situation, you would need to flatten the figure first.

-Mark P.
-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 203.202.234.243
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 01/22/2013 08:48:58 PM
Thanks Mark ! You are right. GetProjectedCurve() is redundant here, unless someone want to project the baseCurve to a plane other than world. To retain the curves as it is we can simple get the BaseCurve and add that to DWG database using AddNewlyCreatedDBObject(). I have updated the original code snippet above to make it simpler.

Cheers,
Partha
ADN
-----
COMMENT:
AUTHOR: Anton Huizinga
EMAIL: a.huizinga@gmail.com
IP: 82.95.108.202
URL: 
DATE: 01/24/2013 11:27:54 AM
You forgot to change the line: 

model.AppendEntity(projectedCurve);

That should be the baseCurve.
-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 203.202.234.243
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 01/24/2013 08:29:51 PM
Thanks Anton ! Corrected now :)

Cheers,
Partha
ADN
-----
COMMENT:
AUTHOR: jim haglund
EMAIL: jim@kpg.com
IP: 63.235.80.142
URL: 
DATE: 01/29/2013 03:16:00 PM
Love what your code does.  How can I load and use this code in Civil 3d drawings?

Thanks
Jim
-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 203.202.234.243
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 02/06/2013 12:54:17 AM
Hi Jim,

You need to build a simple .NET plug-in app using this code and Civil 3D .NET API assembly. Then netload your application in Civil 3D and call your custom command. In the following link you will see useful resource like DevTV to build your plugin for Civil 3D or AutoCAD.

<a href="http://usa.autodesk.com/adsk/servlet/index?id=1911627&siteID=123112">http://usa.autodesk.com/adsk/servlet/index?id=1911627&siteID=123112</a>

<a href="http://usa.autodesk.com/adsk/servlet/index?siteID=123112&id=8007696">http://usa.autodesk.com/adsk/servlet/index?siteID=123112&id=8007696</a>

Thanks,
Partha
-----
COMMENT:
AUTHOR: BlackBox
EMAIL: 
IP: 207.34.120.71
URL: http://profile.typepad.com/6p017d4259d7c8970c
DATE: 10/16/2013 03:37:38 PM
Hi Partha - 

Silly question, but how does one go about converting SurveyFigure to Polyline2d to retain the 'intelligent' arcs, etc.?

Do we need to 'flatten' the SurveyFigure first, to allow for BaseCurve to yield Polyline2d (with arcs, etc.)?

Cheers
-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 59.92.135.96
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 10/21/2013 12:10:36 AM
Hi BlackBox -

No need to flatten. We can get the base curve as shown in the above code sample - 

Curve baseCurve = survFig.BaseCurve;

If you want Polyline2d, you can use the curve geometry to create a Polyline2d out of it.

Thanks,
Partha
-----
COMMENT:
AUTHOR: joantopo
EMAIL: joantopo@hotmail.com
IP: 88.7.218.117
URL: 
DATE: 11/11/2013 10:23:07 AM
Hi.
That code snippet is the same for Feature Lines to convert to polylines?

Can I get Id of polyline after this:?
" trans.AddNewlyCreatedDBObject(baseCurve, true);"

I would like to get a ObjectIdCollection of news polylines for erase later.

Thank you.
-----
COMMENT:
AUTHOR: Stacy
EMAIL: stacy_dunn_@hotmail.com
IP: 64.251.230.39
URL: 
DATE: 11/15/2013 01:03:47 PM
Partha,
I have tried .basecurve, .GetProjectedCurve and .GetOrthoProjectedCurve to generate a 2d polyline, but each method will not generate a polyline with arc segments.  They are the only approximated curves with line segments.

The only way I can get a polyline with curves is to flatten the figure to a dummy surface first.

Is there another method or is there a way to programatically flatten the figure to the same elevation?

Thank you,
Stacy
-----
COMMENT:
AUTHOR: Stacy
EMAIL: 
IP: 64.251.230.39
URL: http://profile.typepad.com/6p019b01250f3d970c
DATE: 11/15/2013 01:15:31 PM
Partha,
You said that there is no need to flatten, but each method I have tried does not produce a polyline with curves.

I tried:
survfig.BaseCurve
survfig.GetProjectedCurve
survig.GetOrthoprojectedCurve

If if manually flatten the figure using a dummy suface and the AeccFeatureElevsFromSurf command, the polyline derived from survfig.BaseCurve will then have actual arc segments.

Is there another method or a way to flatten the figure programatically first?

Thank you,
Stacy
-----
COMMENT:
AUTHOR: Stacy
EMAIL: 
IP: 64.251.230.39
URL: http://profile.typepad.com/6p019b01250f3d970c
DATE: 11/15/2013 01:16:24 PM
Partha,
You said that there is no need to flatten, but each method I have tried does not produce a polyline with curves.

I tried:
survfig.BaseCurve
survfig.GetProjectedCurve
survig.GetOrthoprojectedCurve

If if manually flatten the figure using a dummy suface and the AeccFeatureElevsFromSurf command, the polyline derived from survfig.BaseCurve will then have actual arc segments.

Is there another method or a way to flatten the figure programatically first?

Thank you,
Stacy
-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 203.202.234.243
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 11/18/2013 02:27:10 AM
Hi Stacy,

I don't see any API to flatten the SurveyFigure.

You can try projecting the BaseCurve from SurveyFigure to a specific plane using the following - 

Curve projectedCurve = survFig.BaseCurve.GetProjectedCurve(plane, dir);

Thanks,
Partha
ADN

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Updating a Profile mode using Profile.UpdateMode
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: updating-a-profile-mode-using-profileupdatemode
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2012
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2013/01/updating-a-profile-mode-using-profileupdatemode.html 
DATE: 01/07/2013 12:59:23 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>AutoCAD Civil
3D <strong>Profile</strong> type has a property named <em><strong>UpdateMode</strong></em> which can be used to get or set
the update mode of the profile.</p>
<p>Here is a
note from the Civil 3D API reference document help file on Profile.UpdateMode property
which I would like to draw your attention -&#0160;</p>
<p><span style="color: #bf5f00;">Gets for
Superimposed, EG, CorridorFeature only. <strong>Sets for surface profiles only</strong>.
Specifies whether the profile updates automatically to reflect changes in
surface elevation. </span></p>
<p><span style="color: #bf5f00;">System.InvalidOperationException
is thrown when setting the UpdataMode which profile&#39;s type is not EG.</span> </p>
<p>&#0160;</p>
<p>Here is a C#
code snippet which demonstrates the usage of this API -</p>
<p>&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">Profile</span><span style="line-height: 140%;"> profile = trans.GetObject(profileId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForRead) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Profile</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (profile.ProfileType == </span><span style="color: #2b91af; line-height: 140%;">ProfileType</span><span style="line-height: 140%;">.EG)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nSelected Profile is of Type : &quot;</span><span style="line-height: 140%;"> + profile.ProfileType.ToString());</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nUpdateMode Before Change :&quot;</span><span style="line-height: 140%;"> + profile.UpdateMode.ToString());</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// update using Profile.UpdateMode</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// Gets for Superimposed, EG, CorridorFeature only. </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// Sets for surface profiles only. </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; profile.UpgradeOpen();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; profile.UpdateMode = </span><span style="color: #2b91af; line-height: 140%;">ProfileUpdateType</span><span style="line-height: 140%;">.Dynamic;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nUpdateMode After Change :&quot;</span><span style="line-height: 140%;"> + profile.UpdateMode.ToString());</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">else</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nSelected Profile is of Type : &quot;</span><span style="line-height: 140%;"> + profile.ProfileType.ToString() + </span><span style="color: #a31515; line-height: 140%;">&quot;&#0160; Can not update the Mode&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><br /></span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017c356417aa970b-pi" style="display: inline;"><img alt="Profile_Update" class="asset  asset-image at-xid-6a0167607c2431970b017c356417aa970b" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017c356417aa970b-500wi" title="Profile_Update" /></a><br /><br /></span></p>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Creating your first Android App to view Map from Autodesk Infrastructure Map Server(AIMS)
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: creating-your-first-android-app-to-view-map-from-infrastructure-map-serveraims
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: Android
CATEGORY: Cloud
CATEGORY: Mobile
CATEGORY: Partha Sarkar
CATEGORY: Web

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/12/creating-your-first-android-app-to-view-map-from-infrastructure-map-serveraims.html 
DATE: 12/13/2012 02:26:51 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>The very
first step is setting up the development environment with SDK, Tools and
configuring them correctly. I think, <a href="http://developer.android.com/training/basics/firstapp/index.html">Building
Your First App</a> is the first place you need to go to understand what SDK,
Tools are required and how to configure them. </p>
<p>&#0160;</p>
<p>Once you have
completed your &quot;Hello World&quot; app and some of the tutorial android
apps, you are almost ready to see how you can create a simple mapping
application to view Map served from Autodesk Infrastructure Map Server.</p>
<p>&#0160;</p>
<p>In this
example I used <a href="http://developer.android.com/reference/android/webkit/WebView.html">WebView</a>
class from Android <a class="zem_slink" href="http://en.wikipedia.org/wiki/Application_programming_interface" rel="wikipedia" target="_blank" title="Application programming interface">APIs</a>. Here is the code snippet :</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="line-height: 140%;">import android.app.Activity;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">import android.os.Bundle;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">import android.webkit.WebView;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">import android.webkit.WebViewClient;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">public</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">class</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">AIMSWebViewActivity</span><span style="line-height: 140%;"> extends Activity {</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;WebView mWebView;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;@Override</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;</span><span style="color: blue; line-height: 140%;">public</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">void</span><span style="line-height: 140%;"> onCreate(Bundle savedInstanceState) {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; super.onCreate(savedInstanceState);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; setContentView(R.layout.main);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// This initializes the member WebView</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// with the one from the Activity layout;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// requests a WebSettings object with getSettings();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// and enables JavaScript for the WebView with</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// setJavaScriptEnabled(boolean).</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// Finally, an initial web page is loaded with loadUrl(String).</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; mWebView = (WebView) findViewById(R.id.webview);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; mWebView.getSettings().setJavaScriptEnabled(</span><span style="color: blue; line-height: 140%;">true</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; mWebView.getSettings().setBuiltInZoomControls(</span><span style="color: blue; line-height: 140%;">true</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; mWebView.loadUrl(</span><span style="color: #a31515; line-height: 140%;">&quot;http://www.MyAIMSSite.com/MapView/&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// setContentView(mWebView); // this works too</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; mWebView.setWebViewClient(</span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">HelloWebViewClient</span><span style="line-height: 140%;">());</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;}</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;</span><span style="color: blue; line-height: 140%;">private</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">class</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">HelloWebViewClient</span><span style="line-height: 140%;"> extends WebViewClient {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; @Override</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">public</span><span style="line-height: 140%;"> boolean shouldOverrideUrlLoading(WebView view, String url) {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160; view.loadUrl(url);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160; </span><span style="color: blue; line-height: 140%;">return</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">true</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;}</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
<p>&#0160;</p>
<p>Screenshot of
Android AIMS Map View application :</p>
<p>&#0160;
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017d3ec00d15970c-pi" style="display: inline;"><img alt="AIMS_Android_webview" class="asset  asset-image at-xid-6a0167607c2431970b017d3ec00d15970c" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017d3ec00d15970c-320wi" title="AIMS_Android_webview" /></a>&#0160;</p>
<p>&#0160;</p>
<p>And here is a
short video of the same running in Emulator.</p>
<p><iframe frameborder="0" height="344" src="http://www.youtube.com/embed/hbbiBKAvfc8?fs=1&amp;feature=oembed" width="459"></iframe>&#0160;</p>
<p>I hope this
is useful to you!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: wiria
EMAIL: 
IP: 202.67.36.31
URL: 
DATE: 11/27/2013 08:19:37 AM
there a lot interesting android app on play store, and the app based map with gps features is one of most download for its usability. 
-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Accessing the 'Object Layers' using Civil 3D .NET API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: accessing-the-object-layers-using-civil-3d-net-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/12/accessing-the-object-layers-using-civil-3d-net-api.html 
DATE: 12/10/2012 01:06:05 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>Civil 3D COM
API <strong>IAeccSettingsObjectLayer:: Layer</strong>
gives us access to get or set the layer name on which the object is drawn.
However, if we take a closer look into the Object list in the &#39;Object Layers&#39;
tab under &quot;Drawing Settings&quot; dialog box in Civil 3D, we will find
there are some objects which are not covered by <strong>IAeccSettingsObjectLayers</strong>. Most likely they were added later stage
by the time we shifted focus to .NET API in Civil 3D. And the good news is, most
of those objects are accessible through .NET API. Here is an example:</p>
<p>&#0160;</p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017ee61ae5ee970d-pi" style="display: inline;"><img alt="Object_Layers" class="asset  asset-image at-xid-6a0167607c2431970b017ee61ae5ee970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017ee61ae5ee970d-500wi" title="Object_Layers" /></a></p>
<p>&#0160;</p>
<p>In the above screenshot, we see Objects like &quot;Pipe&quot;,
&quot;Pipe-Labeling&quot;. They are not accessible through COM API <strong>IAeccSettingsObjectLayers</strong>. However, we
can use .NET API and access them and know the Layer name. Here is a c# code snippet:</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">CivilDocument</span><span style="line-height: 140%;"> civilDoc = </span><span style="color: #2b91af; line-height: 140%;">CivilApplication</span><span style="line-height: 140%;">.ActiveDocument;</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">Transaction</span><span style="line-height: 140%;"> ts = </span><span style="color: #2b91af; line-height: 140%;">Application</span><span style="line-height: 140%;">.DocumentManager.MdiActiveDocument.Database</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; .TransactionManager.StartTransaction())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">SettingsDrawing</span><span style="line-height: 140%;"> settingsDWG = civilDoc.Settings.DrawingSettings;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">String</span><span style="line-height: 140%;"> layerName = settingsDWG.ObjectLayerSettings</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; .GetObjectLayerSetting(</span><span style="color: #2b91af; line-height: 140%;">SettingsObjectLayerType</span><span style="line-height: 140%;">.Pipe).LayerName.ToString();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nDrawing Settings - Object Layers - Pipe Layer Name : &quot;</span><span style="line-height: 140%;"> + layerName);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; ts.Commit();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
<p>&#0160;</p>
<p>And Result in
Civil 3D 2013:</p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017ee61aea18970d-pi" style="display: inline;"><img alt="DWG_Settings_Pipe_ObjLayer" class="asset  asset-image at-xid-6a0167607c2431970b017ee61aea18970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017ee61aea18970d-500wi" title="DWG_Settings_Pipe_ObjLayer" /></a></p>
<p>&#0160;</p>
<p>Hope this is
useful to you!</p>
<p>&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Duplicated Add-ins tab on Civil 3D
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: duplicated-add-ins-tab-on-civil-3d
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D 2013

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/12/duplicated-add-ins-tab-on-civil-3d.html 
DATE: 12/07/2012 09:13:37 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>With the <a href="http://apps.exchange.autodesk.com/CIV3D/Home/Index">Autodesk Exchange Store for AutoCAD Civil 3D 2013</a> we (and the users of our apps) can download and quickly use several apps! Nice! But you may notice that the ‘Add-ins’ tab is appearing duplicated, like below.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017ee6054124970d-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="duplicated" border="0" alt="duplicated" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017d3e908a9e970c-pi" width="467" height="95" /></a></p>  <p>To fix it, run CUI command, (1) select ‘C3D.cuix’, then (2) select ‘Civil 3D Default’ and finally (3) click on ‘Customize Workspace’. See below.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017c3461b224970b-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="setps1" border="0" alt="setps1" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017ee6054153970d-pi" width="471" height="150" /></a></p>  <p>Now (4) expand the ‘Ribbon’ list and select ‘Civil 3D Add-ins’ and finally (5) click ‘Done’. Click OK to confirm the changes.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017c3461b259970b-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="steps2" border="0" alt="steps2" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017ee6054196970d-pi" width="471" height="253" /></a></p>  <p>That should do it.</p>  <p>If still having problems, it may be required uninstall the apps and install again to force AutoCAD Civil 3D to rebuild the CUIx.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Connecting Cloud and Mobile with Civil 3D
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: connecting-cloud-and-mobile-with-civil-3d
CATEGORY: .NET
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D 2013

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/12/connecting-cloud-and-mobile-with-civil-3d.html 
DATE: 12/06/2012 11:26:07 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>
<p>The class at Autodesk University Las Vegas was “From Mobile and Through the Cloud to AutoCAD® Civil 3D®”. The main idea was how collect coordinate points using Mobile with GPS enabled devices running Android or iOS, then store and merge those at the Cloud to finally generate Civil 3D objects, like surfaces, alignments or parcels. The case study will use Android phone equipped GPS and camera, using Windows Azure as cloud service to generate AutoCAD Civil 3D Cogo points.</p>
<p>If you haven’t the change to visit us at AU, not problem, get the <span class="asset  asset-generic at-xid-6a0167607c2431970b017c345832ff970b"><a href="http://adndevblog.typepad.com/files/cp3325-handout.pdf">handout</a></span> and&#0160;<span class="asset  asset-generic at-xid-6a0167607c2431970b017ee5fbd074970d"><a href="http://adndevblog.typepad.com/files/cp3325-presentation.pdf">presentation</a></span> and start it! Then get the full&#0160;<span class="asset  asset-generic at-xid-6a0167607c2431970b017d3e871386970c"><a href="http://adndevblog.typepad.com/files/cp3325-samples.zip">source code</a></span> and try yourself. I&#39;ll be talking about the details on future post, here and at <a href="http://adndevblog.typepad.com/cloud_and_mobile/" target="_self">Cloud and Mobile</a> blog.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Get the LandXML from Cloud to create a TIN Surface in Civil 3D
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: get-the-landxml-from-cloud-to-create-a-tin-surface-in-civil-3d
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2011
CATEGORY: AutoCAD Civil 3D 2012
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Cloud
CATEGORY: Mobile
CATEGORY: Partha Sarkar
CATEGORY: Web

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/12/get-the-landxml-from-cloud-to-create-a-tin-surface-in-civil-3d.html 
DATE: 12/05/2012 01:01:30 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>In my
previous <a href="http://adndevblog.typepad.com/infrastructure/2012/12/storing-landxml-in-cloud-.html">blog
post</a> we saw how quickly and easily we can upload and store a LandXML file
in Windows Azure Cloud storage. In this post we will see how we can access our
LandXML files stored in Cloud and use the same to create a TIN Surface in Civil
3D.</p>
<p>Here is the
C# code snippet with minimal error handlers :</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">public</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">static</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">void</span><span style="line-height: 140%;"> LandXMLDownLoadFromCloudStorage()</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Get the AutoCAD Editor</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">Editor</span><span style="line-height: 140%;"> ed = </span><span style="color: #2b91af; line-height: 140%;">Application</span><span style="line-height: 140%;">.DocumentManager.MdiActiveDocument.Editor;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">try</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// declare the Windows Azure storage account connection string</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">//string connStr = &quot;DefaultEndpointsProtocol=https; &quot; +</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">//&#0160; &quot; AccountName=your_storage_account_name; &quot; +</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">//&#0160; &quot;AccountKey=your_storage_account_key&quot;;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">string</span><span style="line-height: 140%;"> connStr = </span><span style="color: #a31515; line-height: 140%;">&quot;DefaultEndpointsProtocol=https; &quot;</span><span style="line-height: 140%;"> +</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: #a31515; line-height: 140%;">&quot; AccountName=your_storage_account_name; &quot;</span><span style="line-height: 140%;"> +</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: #a31515; line-height: 140%;">&quot;AccountKey=your_storage_account_key&quot;</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// get the Storage account&#0160; &#0160; &#0160;&#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">CloudStorageAccount</span><span style="line-height: 140%;"> cloudStorageAccount = </span><span style="color: #2b91af; line-height: 140%;">CloudStorageAccount</span><span style="line-height: 140%;">.Parse(connStr);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// Create the blob client that provides authenticated access to the Blob service.</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">CloudBlobClient</span><span style="line-height: 140%;"> blobClient = cloudStorageAccount.CreateCloudBlobClient();</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// Get the container reference.&#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">CloudBlobContainer</span><span style="line-height: 140%;"> blobContainer = blobClient.GetContainerReference(</span><span style="color: #a31515; line-height: 140%;">&quot;c3dlandxmlsurface&quot;</span><span style="line-height: 140%;">);&#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// Get a reference to the blob.</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">CloudBlob</span><span style="line-height: 140%;"> blob = blobContainer.GetBlobReference(</span><span style="color: #a31515; line-height: 140%;">&quot;Civil3DLand.xml&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// Download the file to local system</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">string</span><span style="line-height: 140%;"> downloadedLandXmlFile = </span><span style="color: #a31515; line-height: 140%;">@&quot;c:\Temp\Civil3DLandXMLSurface.xml&quot;</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; blob.DownloadToFile(downloadedLandXmlFile);&#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// Call Civil 3D Function to Import the LandXML</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// We need to use Civil 3D COM API IAeccSurfaces:: ImportXML() to Import a LandXML</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">File</span><span style="line-height: 140%;">.Exists(downloadedLandXmlFile))</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; Civil3DImportLandXML(downloadedLandXmlFile);&#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; }&#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">catch</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">StorageClientException</span><span style="line-height: 140%;"> e)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;Storage Client Error : &quot;</span><span style="line-height: 140%;"> + e.Message);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// Exit here ?</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">catch</span><span style="line-height: 140%;"> (Autodesk.AutoCAD.Runtime.</span><span style="color: #2b91af; line-height: 140%;">Exception</span><span style="line-height: 140%;"> ex)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;Error encountered: &quot;</span><span style="line-height: 140%;"> + ex.Message);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
<p>&#0160;</p>
<p>For the implementation of <strong>Civil3DImportLandXML</strong>(filename)function,
refer to my previous blog post topic <a href="http://adndevblog.typepad.com/infrastructure/2012/12/creating-a-tin-surface-from-landxml-file.html">Creating
a TIN surface from LandXML file</a></p>
<p>&#0160;</p>
<p>Hope this is
useful to you.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Storing LandXML in Cloud 
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: storing-landxml-in-cloud-
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2011
CATEGORY: AutoCAD Civil 3D 2012
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Cloud
CATEGORY: Mobile
CATEGORY: Partha Sarkar
CATEGORY: Web

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/12/storing-landxml-in-cloud-.html 
DATE: 12/04/2012 01:01:33 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>In my
previous <a href="http://adndevblog.typepad.com/infrastructure/2012/12/creating-a-tin-surface-from-landxml-file.html">blog
post</a> I indicated to experiment with storing LandXML files in Cloud so that
we can access the same anytime and anywhere. I thought of trying to use Windows
Azure Blob storage. If you are in the learning phase of Cloud services and want
to quickly build a sample to understand how it works, the following could be a
good starting point <a href="http://www.windowsazure.com/en-us/develop/net/how-to-guides/blob-storage/">How
to use the Windows Azure Blob Storage Service in .NET</a>. This how-to-guide
gives you step by step detail on how to build an application using Windows
Azure Blob Storage Service in .NET, hence I am not writing down each steps
here, instead let’s see how we can extend this learning to create a simple .NET
application for Civil 3D to upload a LandXML to cloud and in the later part we
will see how to access and get the same LandXML in Civil 3D and create a TIN
surface.</p>
<p>Here is a screenshot
of the assemblies I added to my C3DLandXMLCloudStorageSample project –</p>
<p>&#0160;</p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017c344242ea970b-pi" style="display: inline;"><img alt="C3DLandXML_Cloud01" class="asset  asset-image at-xid-6a0167607c2431970b017c344242ea970b" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017c344242ea970b-500wi" title="C3DLandXML_Cloud01" /></a></p>
<p>And here is
the C# code snippet with minimal error handlers :</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">public</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">static</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">void</span><span style="line-height: 140%;"> LandXMLUpload2CloudStorage()</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// Get the AutoCAD Editor</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">Editor</span><span style="line-height: 140%;"> ed = </span><span style="color: #2b91af; line-height: 140%;">Application</span><span style="line-height: 140%;">.DocumentManager.MdiActiveDocument.Editor;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">try</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// declare the Windows Azure storage account connection string&#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">//string connStr = &quot;DefaultEndpointsProtocol=https; &quot; +</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">//&#0160; &quot; AccountName=your_storage_account_name; &quot; +</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">//&#0160; &quot;AccountKey=your_storage_account_key&quot;;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">string</span><span style="line-height: 140%;"> connStr = </span><span style="color: #a31515; line-height: 140%;">&quot;DefaultEndpointsProtocol=https; &quot;</span><span style="line-height: 140%;"> +</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: #a31515; line-height: 140%;">&quot; AccountName=your_storage_account_name; &quot;</span><span style="line-height: 140%;"> +</span><span style="line-height: 140%;">&#0160; &#0160; &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</span><span style="color: #a31515; line-height: 140%;">&quot;AccountKey=your_storage_account_key&quot;</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: green; line-height: 140%;">// get the Storage account</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">CloudStorageAccount</span><span style="line-height: 140%;"> cloudStorageAccount = </span><span style="color: #2b91af; line-height: 140%;">CloudStorageAccount</span><span style="line-height: 140%;">.Parse(connStr);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// Create the blob client that provides authenticated access to the Blob service.</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">CloudBlobClient</span><span style="line-height: 140%;"> blobClient = cloudStorageAccount.CreateCloudBlobClient();</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// Get the container reference.</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// All letters in a container name must be lowercase.</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// http://msdn.microsoft.com/en-us/library/dd135715.aspx</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">CloudBlobContainer</span><span style="line-height: 140%;"> blobContainer = blobClient.GetContainerReference(</span><span style="color: #a31515; line-height: 140%;">&quot;c3dlandxmlsurface&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// Create the container if it does not exist.</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; blobContainer.CreateIfNotExist();</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// Set permissions on the container.</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">BlobContainerPermissions</span><span style="line-height: 140%;"> containerPermissions = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">BlobContainerPermissions</span><span style="line-height: 140%;">();</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// In this sample, I am using a public access for the blob. </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// However, your application may need a different permisson. </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; containerPermissions.PublicAccess = </span><span style="color: #2b91af; line-height: 140%;">BlobContainerPublicAccessType</span><span style="line-height: 140%;">.Blob;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; blobContainer.SetPermissions(containerPermissions);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// Get a reference to the blob.</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">CloudBlob</span><span style="line-height: 140%;"> blob = blobContainer.GetBlobReference(</span><span style="color: #a31515; line-height: 140%;">&quot;Civil3DLand.xml&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// Upload a file from the local system to the blob.</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nStarting to upload the LandXML file...&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; blob.UploadFile(</span><span style="color: #a31515; line-height: 140%;">@&quot;c:\Temp\Existing Ground Surface.xml&quot;</span><span style="line-height: 140%;">);&#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nCivil 3D Surface LandXML file is uploaded to Cloud Storage :&#0160; &quot;</span><span style="line-height: 140%;"> + blob.Uri);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">catch</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">StorageClientException</span><span style="line-height: 140%;"> e)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; {</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;Storage Client Error : &quot;</span><span style="line-height: 140%;"> + e.Message);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// Exit here ?</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">catch</span><span style="line-height: 140%;"> (Autodesk.AutoCAD.Runtime.</span><span style="color: #2b91af; line-height: 140%;">Exception</span><span style="line-height: 140%;"> ex)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;Error encountered: &quot;</span><span style="line-height: 140%;"> + ex.Message);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; }</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
<p>&#0160;</p>
<p>Next we will
see how to access this LandXML from cloud and get it in Civil 3D to create a
TIN surface.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Sean Carter
EMAIL: infoabound@yahoo.com
IP: 4.31.71.37
URL: http://www.sungardas.com/Solutions/Cloud/Overview/Pages/CloudOverview.aspx
DATE: 01/17/2013 08:53:47 AM
some very handy tips, I am finding cloud services to be more and more useful than I ever thought they would be. Really glad to have this is my arsenal now.
-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Creating a TIN surface from LandXML file
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: creating-a-tin-surface-from-landxml-file
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2011
CATEGORY: AutoCAD Civil 3D 2012
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Cloud
CATEGORY: Mobile
CATEGORY: Partha Sarkar
CATEGORY: Web

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/12/creating-a-tin-surface-from-landxml-file.html 
DATE: 12/03/2012 12:30:15 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>In AutoCAD
Civil 3D we can use the <strong>LANDXMLIN</strong> command and import a LandXML file to create
Civil 3D objects like Surface, Alignment, Pipe Network etc. Sometime ago, a
Civil 3D application developer asked me about how do I create a Surface from a
LandXML file using API ? </p>
<p>Civil 3D has
the following COM API to create a Surface from LandXML -</p>
<p><em><strong>IAeccSurfaces::ImportXML()</strong></em> -&gt; <em>Given the specified surface name and XML file,
it creates a new surface from the imported XML data, adds it to the collection,
and returns an instance of the new object.</em> </p>
<p>.NET equivalent of this COM API is not yet available (in the
current release), however, we can use COM Interop and create a .NET
application. Here is a relevant C# code snippet -</p>
<p>&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">public</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">static</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">void</span><span style="line-height: 140%;"> Civil3DImportLandXML(</span><span style="color: #2b91af; line-height: 140%;">String</span><span style="line-height: 140%;"> filelocation)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">//get editor and database </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">Editor</span><span style="line-height: 140%;"> ed = </span><span style="color: #2b91af; line-height: 140%;">Application</span><span style="line-height: 140%;">.DocumentManager.MdiActiveDocument.Editor;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">Database</span><span style="line-height: 140%;"> db = </span><span style="color: #2b91af; line-height: 140%;">Application</span><span style="line-height: 140%;">.DocumentManager.MdiActiveDocument.Database;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">//start a transaction </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">Transaction</span><span style="line-height: 140%;"> trans = db.TransactionManager.StartTransaction())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">AcadApplication</span><span style="line-height: 140%;"> oApp = (</span><span style="color: #2b91af; line-height: 140%;">AcadApplication</span><span style="line-height: 140%;">)</span><span style="color: #2b91af; line-height: 140%;">Application</span><span style="line-height: 140%;">.AcadApplication;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">string</span><span style="line-height: 140%;"> sAppName = </span><span style="color: #a31515; line-height: 140%;">&quot;AeccXUiLand.AeccApplication.10.0&quot;</span><span style="line-height: 140%;">; <span style="color: #60bf00;">// Civil 3D 2013</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">AeccApplication</span><span style="line-height: 140%;"> aeccApp = (</span><span style="color: #2b91af; line-height: 140%;">AeccApplication</span><span style="line-height: 140%;">)oApp.GetInterfaceObject(sAppName);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">AeccDocument</span><span style="line-height: 140%;"> aeccDoc = (</span><span style="color: #2b91af; line-height: 140%;">AeccDocument</span><span style="line-height: 140%;">)aeccApp.ActiveDocument;&#0160; &#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// Get the AeccSurfaces object</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; Autodesk.AECC.Interop.Land.</span><span style="color: #2b91af; line-height: 140%;">AeccSurfaces</span><span style="line-height: 140%;"> oAeccSurfaces = aeccDoc.Surfaces;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">String</span><span style="line-height: 140%;"> landxmlFile = filelocation;&#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;"><strong><span style="line-height: 140%;">&#0160; &#0160; oAeccSurfaces.ImportXML(landxmlFile);</span></strong></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// Call AutoCAD COM API ZoomExtents to see the Surface object </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; oApp.ZoomExtents();</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; trans.Commit();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; }</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span><span style="color: gray; line-height: 140%;">///</span></p>
</div>
<p>Here is the
result of calling the above function in Civil 3D 2013 [I used Civil 3D tutorial
dataset here] -</p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017ee5dafe0e970d-pi" style="display: inline;"><img alt="LandXML_Imported" class="asset  asset-image at-xid-6a0167607c2431970b017ee5dafe0e970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017ee5dafe0e970d-500wi" title="LandXML_Imported" /></a><br /><br /></p>
<p>While trying
this in Civil 3D, I was thinking how about keeping my LandXML in Cloud storage
and using it from anywhere, anytime ? Does it sound interesting ? I will
continue this to see how we can store Civil 3D LandXML files in cloud and use
them whenever and wherever I want to create a TIN surface.</p>
<br />
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: AutoCAD® WS is now supporting AutoCAD® Civil 3D Object Model
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 0
ALLOW PINGS: 0
BASENAME: autocad-ws-is-now-supporting-autocad-civil-3d-object-model
CATEGORY: Cloud
CATEGORY: Partha Sarkar
CATEGORY: Web

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/11/autocad-ws-is-now-supporting-autocad-civil-3d-object-model.html 
DATE: 11/25/2012 11:16:12 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>

<p><a href="http://www.autocadws.com/blog/autocad-civil-3d-drawings-now-supported-on-autocad-ws/">AutoCAD
Civil 3D Drawings are now supported on AutoCAD WS</a> and some of you might
have already seen this news in <a href="http://www.autocadws.com/blog">AutoCAD
WS Blog</a> page. I just played with some of the Civil 3D tutorial DWG files
containing Civil 3D objects like TIN Surface, Alignment, Corridor, Pipe Network
etc. </p>
<p>
<a class="asset-img-link" style="display: inline;" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017d3e2acd56970c-pi"><img class="asset  asset-image at-xid-6a0167607c2431970b017d3e2acd56970c" title="WS_Link_C3D" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017d3e2acd56970c-500wi" alt="WS_Link_C3D" /></a></p>
<p>If you want
to embed a link of a particular Civil 3D DWG file using <span style="background-color: #ffffff;">&lt;ifram&gt; in yout HTML code or in &nbsp;HTM5 application</span>, it's
easy -</p>
<pre><br /><span style="background-color: #ffff00;">&lt;iframe src="https://www.autocadws.com/main/publish?link=S0NGTGtwNkY1S2pqcEJ2"</span> <br />	width="1000" <br />	height="700"&gt;<br />&lt;p&gt;Your browser does not support iframes.&lt;/p&gt;<br /><span style="background-color: #ffff40;">&lt;/iframe&gt;</span><br /><br /></pre>
<p>You might
ask, how do I generate the link for my Civil 3D DWG file? Here are the steps -</p>
<p>1. Log-in to
your AutoCADWS account and upload a Civil 3D DWG file.</p>
<p>2. Navigate
to "Share" tab in the Ribbon and use the "Get link to
Share" button as shown in the screenshot below - </p>
<p>
<a class="asset-img-link" style="display: inline;" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017d3e2ad07a970c-pi"><img class="asset  asset-image at-xid-6a0167607c2431970b017d3e2ad07a970c" title="WS_Link" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017d3e2ad07a970c-500wi" alt="WS_Link" /></a></p>
<p>You can use
the same URL in your src attribute of &lt;iframe&gt; tag.</p>
<p>&nbsp;</p>
<p>Cheers</p>
<p>Partha Sarkar</p>
<p>&nbsp;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Live streaming sessions from AU 2012
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: live-streaming-sessions-from-au-2012
CATEGORY: Events
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/11/live-streaming-sessions-from-au-2012.html 
DATE: 11/17/2012 03:23:19 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>AU Virtual
will deliver live streaming sessions from AU 2012 in Las Vegas, plus more than
250 on-demand technical classes on the newest releases of Autodesk products and
classes on the latest trends and challenges facing the design industry—right to
your desktop.&#0160;</p>
<p>Check the
&quot;<a href="http://au.autodesk.com/?nd=webcast_schedule">Live from AU
Schedule</a>&quot; and &#39;add to Calendar&#39; the ones you feel interesting for U!</p>
<p>Full details
here: http://Autodesk.com/auv&#0160;</p>
<p>&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Running Flexible Web Layouts Examples
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: running-flexible-web-layouts-examples
CATEGORY: AIMS 2013
CATEGORY: Daniel Du
CATEGORY: Web

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/11/running-flexible-web-layouts-examples.html 
DATE: 11/12/2012 10:06:02 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>I am following the “Flexible Web Layouts Examples” on MapServer 2013 <a href="http://wikihelp.autodesk.com/Infr._Map_Server/enu/2013/Help/0005-Develope0/0105-Flexible105">wikihelp</a>, and found that this wiki page is a little out-dated. I do not have time to fix them all, so I am just trying to blog how I make some of the examples running. In case you don’t know, the source code of these examples is available on the installation DVD in Samples\FlexibleWebLayoutsSamples. </p>  <p>&#160;</p>  <p>The zip file, FlexibleWebLayoutsExamples.zip, contains source files. Unzip this into the<em>installDir</em>\WebServerExtensions\www folder with “Use folder names” selected in WinZip. It installs the following files:</p>  <p><a name="WS1A9193826455F5FF-6507591011913E8F4B8-470D"></a></p>  <ul>   <li>fusion\templates\mapguide\examples\* </li>    <li>fusion\widgets\Example*.js </li>    <li>fusion\widgets\widgetinfo\example*.xml </li>    <li>fusion\widgets\example*\* </li> </ul>  <p>&#160;</p>  <p>Run Example 1:</p>  <p>Example 1 demos how to create the simplest widget. After installing the code, you will find a new widget name “Example1” available in flexible web layout editor.</p>  <p>1. Create a new flexible web layout in Infrastructure Studio 2013 by c, select a template, I am using slate. Of cause, please make sure MapServer is running first.</p>  <p>2. Assign a map for the Map Tab, I am using the Sheboygan dataset.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017d3d95e8b5970c-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017c33675e09970b-pi" width="415" height="158" /></a></p>  <p>3. I would like to add my test widget into “Toobar(Main Menu)”, you can also put it into other menu if you’d like to, so I switch to “Toobar(Main Menu)” tab, and click “New” in components available in this layout section: </p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017c33675f3d970b-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017c33675f98970b-pi" width="442" height="114" /></a></p>  <p>4. You should see a mater type names as “Example1”, if not, try refresh. If it does not appear even after refreshing, then your probably made some mistakes at installation, a common problem is to install the JS/xml files into wrong folder, so please make sure you have same folder structure with the existing widgets. Select “Example1” as master type then click OK button.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017c33676014970b-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017ee50b079c970d-pi" width="433" height="315" /></a></p>  <p>5. Now I have a new component in the flexible web layout, you can change the ID as you will, I am using the default ID “Example1”:</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017d3d95ebb6970c-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017d3d95ec1c970c-pi" width="443" height="213" /></a></p>  <p>6. Add this component into layout UI, dragging “Example1” into the window left side, a new button is created in main menu toolbar:</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017d3d95ed7c970c-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017d3d95ee18970c-pi" width="451" height="146" /></a></p>  <p>7. view in browser, and click “Example1” button in main menu toolbar, the “hello word” message shows up:</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017d3d95efdb970c-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017d3d95f0ab970c-pi" width="460" height="205" /></a></p>  <p>&#160;</p>  <p>Running Example2</p>  <p>Example 1 is pretty simple, I will move next to Example2. Example 2 is a widget that is designed to be called as a command from a menu, it output the information of selected feature. It requires Mozilla<sup>®</sup> Firefox<sup>®</sup> 3.6 or higher and the Firebug extension because it writes to the <strong>Firebug console</strong>.</p>  <p>I am following the same process as example1 to add a new button into main menu toolbar, and browse it in Firefox this time. To run this example, I need to select some features first, then click&#160; the “Example2 ” button.</p>  <p>Oops! I got an error message:</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017ee50b1009970d-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017ee50b127e970d-pi" width="473" height="158" /></a></p>  <p><font size="1">Fusion Error:      <br />WARNING: Exception occurred in AJAX callback.       <br />Message: <font style="background-color: #ffff00"><strong>theMap.getMapName is not a function</strong></font>       <br />Location: </font><a href="http://localhost/mapserver2013/fusion/widgets/Example2.js"><font size="1">http://localhost/mapserver2013/fusion/widgets/Example2.js</font></a><font size="1"> (47)      <br />Response: {&quot;layers&quot;:[&quot;Parcels&quot;],&quot;extents&quot;:{&quot;minx&quot;:-87.739602320342,&quot;miny&quot;:43.765720296224,&quot;maxx&quot;:-87.737804056497,&quot;maxy&quot;:43.766709329904},&quot;Parcels&quot;:{&quot;propertynames&quot;:[&quot;RLDESCR1&quot;,&quot;RTYPE&quot;,&quot;RACRE&quot;,&quot;RLOT&quot;,&quot;RNAME&quot;,&quot;RLDESCR2&quot;,&quot;RLDESCR3&quot;,&quot;RBILAD&quot;,&quot;RSQFT&quot;,&quot;RLDESCR4&quot;],&quot;propertyvalues&quot;:[&quot;Description1&quot;,&quot;Zone&quot;,&quot;Acreage&quot;,&quot;Lot Dimensions&quot;,&quot;Owner&quot;,&quot;Description2&quot;,&quot;Description3&quot;,&quot;Billing Address&quot;,&quot;Lot Size (SqFt)&quot;,&quot;Description4&quot;],&quot;propertytypes&quot;:[9,9,9,9,9,9,9,9,7,9],&quot;metadatanames&quot;:[&quot;dimension&quot;,&quot;bbox&quot;,&quot;center&quot;,&quot;area&quot;,&quot;length&quot;],&quot;numelements&quot;:15,&quot;values&quot;:[[&quot;BRAND SUBD&quot;,&quot;RES&quot;,&quot;0.17&quot;,&quot;60X124&quot;,&quot;THIEME, ELAINE M&quot;,&quot;LOT 11 BLK 3&quot;,&quot;&quot;,&quot;2008 N. 25TH ST.&quot;,&quot;7440&quot;,&quot;&quot;],[&quot;BRAND SUBD&quot;,&quot;RES&quot;,&quot;0.25&quot;,&quot;80X135&quot;,&quot;RAFFEL, JAMES E&quot;,&quot;LOT 3 &amp;amp; THE N 20\\' OF LOT 4&quot;,&quot;BLK 2&quot;,&quot;2006 N. 24TH ST.&quot;,&quot;10800&quot;,&quot;&quot;],[&quot;BRAND SUBD&quot;,&quot;RES&quot;,&quot;0.25&quot;,&quot;80X135&quot;,&quot;FUERST, ROBERT O&quot;,&quot;N 30\\' OF LOT 23 &amp;amp; S 50\\' OF&quot;,&quot;LOT 24 BLK 2&quot;,&quot;2005 N. 25TH ST.&quot;,&quot;10800&quot;,&quot;&quot;],[&quot;BRAND SUBD&quot;,&quot;RES&quot;,&quot;0.17&quot;,&quot;60X124&quot;,&quot;TUPPER, ANSEL JR&quot;,&quot;LOT 12 BLK 3&quot;,&quot;&quot;,&quot;2002 N. 25TH ST.&quot;,&quot;7440&quot;,&quot;&quot;],[&quot;BRAND SUBD&quot;,&quot;RES&quot;,&quot;0.22&quot;,&quot;70X135&quot;,&quot;YANG, SHOUA PAO&quot;,&quot;THE S 40\\' OF LOT 4 &amp;amp; THE N&quot;,&quot;30\\' OF LOT 5 BLK 2&quot;,&quot;2002 N. 24TH ST.&quot;,&quot;9450&quot;,&quot;&quot;],[&quot;BRAND SUBD&quot;,&quot;RES&quot;,&quot;0.23&quot;,&quot;75X135&quot;,&quot;RAKOW, GLEN J.&quot;,&quot;N 45\\' OF LOT 22 &amp;amp; S 30\\' OF&quot;,&quot;LOT 23 BLK 2&quot;,&quot;1919 N. 25TH ST.&quot;,&quot;10125&quot;,&quot;&quot;],[&quot;BRAND SUBD&quot;,&quot;RES&quot;,&quot;0.17&quot;,&quot;60X124&quot;,&quot;MATELKO, RICHARD A.&quot;,&quot;LOT 13 BLK 3&quot;,&quot;&quot;,&quot;1918 N. 25TH ST.&quot;,&quot;7440&quot;,&quot;&quot;],[&quot;BRAND SUBD&quot;,&quot;RES&quot;,&quot;0.28&quot;,&quot;90X135&quot;,&quot;CASTELLAN, MARY&quot;,&quot;THE S 30\\' OF LOT 5 &amp;amp; ALL OF&quot;,&quot;LOT 6 BLK 2&quot;,&quot;1914 N. 24TH ST.&quot;,&quot;12150&quot;,&quot;&quot;],[&quot;BRAND SUBD&quot;,&quot;RES&quot;,&quot;0.23&quot;,&quot;75X135&quot;,&quot;ROERDINK, JAMES P.&quot;,&quot;LOT 21 &amp;amp; S 15\\' OF LOT 22 BLK&quot;,&quot;2&quot;,&quot;1913 N. 25TH ST.&quot;,&quot;10125&quot;,&quot;&quot;],[&quot;BRAND SUBD&quot;,&quot;RES&quot;,&quot;0.22&quot;,&quot;75X125&quot;,&quot;PIONTKOWSKI, JOHN A.&quot;,&quot;S 45\\' OF LOT 15 &amp;amp; N 30\\' OF&quot;,&quot;LOT 16 BLK 3&quot;,&quot;1904 N. 25TH ST.&quot;,&quot;9375&quot;,&quot;&quot;],[&quot;BRAND SUBD&quot;,&quot;RES&quot;,&quot;0.19&quot;,&quot;60X135&quot;,&quot;HAMER, MARGARET J&quot;,&quot;LOT 19 BLK 2&quot;,&quot;&quot;,&quot;1849 N. 25TH ST.&quot;,&quot;8100&quot;,&quot;&quot;],[&quot;BRAND SUBD&quot;,&quot;RES&quot;,&quot;0.19&quot;,&quot;60X135&quot;,&quot;BOPHA, DAVID &amp;amp; MANYP&quot;,&quot;LOT 8 BLK 2&quot;,&quot;&quot;,&quot;1850 N. 24TH ST.&quot;,&quot;8100&quot;,&quot;&quot;],[&quot;BRAND SUBD&quot;,&quot;RES&quot;,&quot;0.22&quot;,&quot;75X125&quot;,&quot;HORWITZ, DONALD&quot;,&quot;LOT 14 &amp;amp; THE N 15\\' OF LOT 15&quot;,&quot;BLK 3&quot;,&quot;1912 N. 25TH ST.&quot;,&quot;9375&quot;,&quot;&quot;],[&quot;BRAND SUBD&quot;,&quot;RES&quot;,&quot;0.19&quot;,&quot;60X135&quot;,&quot;ABRAHAM, ROBERT A.&quot;,&quot;LOT 20 BLK 2&quot;,&quot;&quot;,&quot;1905 N. 25TH ST.&quot;,&quot;8100&quot;,&quot;&quot;],[&quot;BRAND SUBD&quot;,&quot;RES&quot;,&quot;0.19&quot;,&quot;60X135&quot;,&quot;LAMB, DANIEL F&quot;,&quot;LOT 7 BLK 2&quot;,&quot;&quot;,&quot;1906 N. 24TH ST.&quot;,&quot;8100&quot;,&quot;&quot;]],&quot;metadata&quot;:[[&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;],[&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;],[&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;],[&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;],[&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;],[&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;],[&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;],[&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;],[&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;],[&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;],[&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;],[&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;],[&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;],[&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;],[&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;]]}}</font></p>  <p>&#160;</p>  <p>You may get scared with such a long error message at first glance, To be frankly, I got a high blood pressure as well when I saw this first time <img style="border-bottom-style: none; border-left-style: none; border-top-style: none; border-right-style: none" class="wlEmoticon wlEmoticon-smile" alt="Smile" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017d3d95f49c970c-pi" />. But let’s clam down and looked into the error again, I highlighted and marked it as bold. Message: <font style="background-color: #ffff00"><strong>theMap.getMapName is not a function</strong></font> , it seems that theMap object does not have a method “getMapName”. So I looked into the source code of map widget, which is C:\Program Files\Autodesk\Autodesk Infrastructure Web Server Extension 2013\www\fusion\lib\Map.js by default. Yes, that’s the reason, getMapName method is missing, so I went ahead to add this method as below, around line 1247:</p>  <p>&#160;</p>  <p>//Added by Daniel 2012/11/01    <br />getMapName: function() {     <br />&#160;&#160;&#160; return this.aMaps[0]._sMapname;     <br />},</p>  <p>&#160;</p>  <p>It is pretty simple one.&#160; </p>  <p>As I said earlier, I am using Slate as my template when testing these examples, and the slate template is referring to a compressed single file of fusion library. To apply my changes, I need to edit the JavaScript reference in C:\Program Files\Autodesk\Autodesk Infrastructure Web Server Extension 2013\www\fusion\templates\mapguide\slate\index.html, please refer to <a href="http://adndevblog.typepad.com/infrastructure/2012/04/debugging-fusion-viewer-or-mobile-viewer-of-aims-in-firebug.html">this blog post</a> for more information about this:</p>  <p>&lt;script type=&quot;text/javascript&quot; src=&quot;../../../lib/<strong>fusion.js</strong>&quot;&gt;&lt;/script&gt;</p>  <p>Now let’s refresh the page and test again, the information about the selection has been written to the firebug console:</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017ee50b14d5970d-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017ee50b15ae970d-pi" width="475" height="220" /></a></p>  <p>Look at it closer:</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017c33676dab970b-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017c33676e23970b-pi" width="476" height="371" /></a></p>  <p>&#160;</p>  <p>Okay, I would like to stop here since I am busy with other stuff and do not have time to try the others examples, you may want to keep trying the following examples yourself. I found Example3 does not work as expected, and this has been reported to engineering team, they will take care of it in future. If you are interested in investigating more, you can debug it yourself with help of Firebug, as introduced <a href="http://adndevblog.typepad.com/infrastructure/2012/04/debugging-fusion-viewer-or-mobile-viewer-of-aims-in-firebug.html">in this post</a>. All source code of fusion is released with the product(C:\Program Files\Autodesk\Autodesk Infrastructure Web Server Extension 2013\www\fusion). Hopefully you can work them out yourself. </p>  <p>&#160;</p>  <p>Good luck!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Vote for Visual Studio x64 Edit-and-Continue
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: vote-for-visual-studio-x64-edit-and-continue
CATEGORY: .NET
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/11/vote-for-visual-studio-x64-edit-and-continue.html 
DATE: 11/06/2012 09:00:53 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>I&#39;m
cross-referencing this blog post titled “<strong><a href="http://adndevblog.typepad.com/autocad/2012/11/vote-for-visual-studio-x64-edit-and-continue.html">Vote
for Visual Studio <span style="background-color: #ffff00;">x64 Edit-and-Continue</span></a></strong> “ by <a href="http://adndevblog.typepad.com/autocad/stephen-preston.html">Stephen
Preston</a> as I think it&#39;s a very useful feature and developers would love
this in VS x64. </p>
<p>Please go ahead and cast your vote :)</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Editing Station property of a Sampleline using AeccSampleLine.Station API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: editing-station-property-of-a-sampleline-using-aeccsamplelinestation-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2011
CATEGORY: AutoCAD Civil 3D 2012
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/11/editing-station-property-of-a-sampleline-using-aeccsamplelinestation-api.html 
DATE: 11/05/2012 10:48:02 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>This VB.NET
code snippet demonstrates how to add a Civil 3D SampleLine using COM API
<strong>IAeccSampleLines:: AddByPolyline()</strong> method and then check whether the sample
line is locked to the station using &#0160;<strong>IAeccSampleLine:: LockToStation</strong>,&#0160;before updating it&#39;s Station value using COM API
<strong>IAeccSampleLine:: Station</strong> Property.</p>
<p>&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">&#39;idEnt is Polyline ObjectId</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> pLineEntity </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> Autodesk.AutoCAD.DatabaseServices.</span><span style="color: #2b91af; line-height: 140%;">Entity</span><span style="line-height: 140%;"> = _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">DirectCast</span><span style="line-height: 140%;">(trans.GetObject(idEnt, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForWrite), Autodesk.AutoCAD.DatabaseServices.</span><span style="color: #2b91af; line-height: 140%;">Entity</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">&#39;idEnt1 is Alignment ObjectId</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> alignmentEntity </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> Autodesk.AutoCAD.DatabaseServices.</span><span style="color: #2b91af; line-height: 140%;">Entity</span><span style="line-height: 140%;"> = _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">DirectCast</span><span style="line-height: 140%;">(trans.GetObject(idEnt1, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForWrite), Autodesk.AutoCAD.DatabaseServices.</span><span style="color: #2b91af; line-height: 140%;">Entity</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> pline </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> Autodesk.AutoCAD.Interop.Common.</span><span style="color: #2b91af; line-height: 140%;">AcadLWPolyline</span><span style="line-height: 140%;"> = _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">DirectCast</span><span style="line-height: 140%;">(pLineEntity.AcadObject, Autodesk.AutoCAD.Interop.Common.</span><span style="color: #2b91af; line-height: 140%;">AcadLWPolyline</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> oAlignment </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> Autodesk.AECC.Interop.Land.</span><span style="color: #2b91af; line-height: 140%;">AeccAlignment</span><span style="line-height: 140%;"> = _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">DirectCast</span><span style="line-height: 140%;">(alignmentEntity.AcadObject, Autodesk.AECC.Interop.Land.</span><span style="color: #2b91af; line-height: 140%;">AeccAlignment</span><span style="line-height: 140%;">)&#0160; &#0160; &#0160; &#0160; &#0160;&#0160; </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> oSampleLine </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> Autodesk.AECC.Interop.Land.</span><span style="color: #2b91af; line-height: 140%;">AeccSampleLine</span><span style="line-height: 140%;"> = _</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="background-color: #ffff00;">&#0160; oAlignment.SampleLineGroups.Item(0).SampleLines.AddByPolyline</span>(</span><span style="color: #a31515; line-height: 140%;">&quot;My_SampleLine&quot;</span><span style="line-height: 140%;">, pline, </span><span style="color: blue; line-height: 140%;">False</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">&#39;&#39; IAeccSampleLine:: Station Property</span></p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">&#39;&#39; Gets or sets the alignment station for this sample line.</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">ed.WriteMessage(vbCrLf + </span><span style="color: #a31515; line-height: 140%;">&quot;Station Value :&quot;</span><span style="line-height: 140%;"> + oSampleLine.Station.ToString())</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">&#39; Check whether the sample line is locked to the station</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">If</span><span style="line-height: 140%;">(oSampleLine.LockToStation)</span></p>
<p style="margin: 0px;"><span style="background-color: #ffff00;"><span style="line-height: 140%;">&#0160; oSampleLine.LockToStation = </span><span style="color: blue; line-height: 140%;">False</span></span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">If</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">&#39;&#39; Now Change the Station Value</span></p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">&#39;&#39; Following hardcoded value is applicable to Civil 3D Sample DWG - &quot;Sections-Views-Create.dwg&quot;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; background-color: #ffff00;">oSampleLine.Station = 550.50</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">ed.WriteMessage(vbCrLf + </span><span style="color: #a31515; line-height: 140%;">&quot;Station Value After Change:&quot;</span><span style="line-height: 140%;"> + oSampleLine.Station.ToString())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">trans.Commit()</span></p>
</div>
<p>&#0160;</p>
<p>Here is the Result :</p>
<p>&#0160;</p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017ee4cad13a970d-pi" style="display: inline;"><img alt="SampleLine_Update" class="asset  asset-image at-xid-6a0167607c2431970b017ee4cad13a970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017ee4cad13a970d-500wi" title="SampleLine_Update" /></a><br /><br /></p>
<p>&#0160;</p>
<p>Hope this is useful to you!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: APPHACK @ AU
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: apphack-au
CATEGORY: Events
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/11/apphack-au.html 
DATE: 11/02/2012 03:56:35 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>I&#39;m
cross-referencing this blog post titled <a href="http://adndevblog.typepad.com/autocad/2012/11/apphack-au.html">APPHACK @
AU </a>&#0160;in case you haven&#39;t seen this
yet...</p>
<p><em>Here’s a
chance to win US$5000 (and a lot of publicity) for your next great idea for an
AutoCAD app.</em></p>
<p><em>APPHACK @ AU
is a virtual code-fest to produce apps/plugins for AutoCAD using the ObjectARX
and/or .NET APIs, and it&#39;s open to any ADN member who can produce a working
app/plugin for AutoCAD. The event culminates in a live demo at Autodesk
University in Las Vegas on November 26, 2012.&#0160;
Simply submit your app and a demo video and you&#39;re in the running for
some nice prizes. But hurry - the deadline for submissions is 11:59pm Pacific
on Wednesday, 14 November, 2012.</em></p>
<p>&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Failed to load the resource file &quot;Resources/mapguide_en.res&quot; for locale &quot;en&quot;
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: failed-to-load-the-resource-file-resourcesmapguide_enres-for-locale-en
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: Daniel Du
CATEGORY: MapGuide Enterprise 2011

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/10/failed-to-load-the-resource-file-resourcesmapguide_enres-for-locale-en.html 
DATE: 10/29/2012 11:06:40 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>I noticed that quite a few customers run into this problem on Autodesk Infrastructure Map Server. The error message on yellow page is something like below: </p>  <blockquote>   <p><font size="1">Server Error in '/MgViewerExtention_2012' Application.</font></p>    <p><font size="1"><strong>Failed to load the resource file &quot;Resources/mapguide_en.res&quot; for locale &quot;en&quot;.</strong></font></p>    <p><font size="1">Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. </font></p>    <p><font size="1">Exception Details: OSGeo.MapGuide.MgResourcesLoadFailedException: Failed to load the resource file &quot;Resources/mapguide_en.res&quot; for locale &quot;en&quot;.</font></p>    <p><font size="1">Source Error: </font></p>    <p>     <br /><font size="1">Line 22:&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; string realPath = Request.ServerVariables[&quot;APPL_PHYSICAL_PATH&quot;];        <br />Line 23:&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; String configPath = realPath + &quot;../webconfig.ini&quot;;         <br />Line 24:&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; MapGuideApi.MgInitializeWebTier(configPath);         <br />Line 25:&#160;&#160;&#160;&#160; }         <br />Line 26: </font></p>    <p><font size="1">Source File: C:\Work\CodeSamples\MgViewerExtention_2012\MgViewerExtention\Utility.cs&#160;&#160;&#160; Line: 24 </font></p>    <p><font size="1">Stack Trace: </font></p>    <p>     <br /><font size="1">[MgResourcesLoadFailedException: Failed to load the resource file &quot;Resources/mapguide_en.res&quot; for locale &quot;en&quot;.]        <br />&#160;&#160; OSGeo.MapGuide.SWIGExceptionHelper.ThrowCustomException(String className, IntPtr cptr) +648         <br />&#160;&#160; OSGeo.MapGuide.MapGuideApiPINVOKE.MgInitializeWebTier(String jarg1) +0         <br />&#160;&#160; Utility.InitializeWebTier(HttpRequest Request) in C:\Work\CodeSamples\MgViewerExtention_2012\MgViewerExtention\Utility.cs:24         <br />&#160;&#160; MgViewerExtention.Default.Page_Load(Object sender, EventArgs e) in C:\Work\CodeSamples\MgViewerExtention_2012\MgViewerExtention\Default.aspx.cs:35         <br />&#160;&#160; System.Web.Util.CalliHelper.EventArgFunctionCaller(IntPtr fp, Object o, Object t, EventArgs e) +25         <br />&#160;&#160; System.Web.Util.CalliEventHandlerDelegateProxy.Callback(Object sender, EventArgs e) +42         <br />&#160;&#160; System.Web.UI.Control.OnLoad(EventArgs e) +132         <br />&#160;&#160; System.Web.UI.Control.LoadRecursive() +66         <br />&#160;&#160; System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +2428</font></p>    <p><font size="1">Version Information: Microsoft .NET Framework Version:2.0.50727.4971; ASP.NET Version:2.0.50727.4971</font></p> </blockquote>  <p>I myself came across this problem as well, how did I fix it? Simple, just repair MapGuide WebExtension from Control Panel, the original installation media is needed.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017c32ed00a0970b-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017d3d1b846d970c-pi" width="480" height="175" /></a></p>  <p>I know it is not like a way of technical geek, but it works and it is easy.&#160; <img style="border-bottom-style: none; border-left-style: none; border-top-style: none; border-right-style: none" class="wlEmoticon wlEmoticon-smile" alt="Smile" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017d3d1b8483970c-pi" /></p>  <p>&#160;</p>  <p>[Updated : 2012/11/13]</p>  <p>Someone is saying that repair does not work for him, so I Google with this error message and seems <a href="http://osgeo-org.1560.n6.nabble.com/Failed-to-load-the-resource-file-quot-Resources-mapguide-en-res-quot-td5014758.html">this link</a> is related: one of the reasons may be permission problem. And <a href="http://osgeo-org.1560.n6.nabble.com/NET-64-BIT-can-t-load-Resources-mapguide-en-res-td4184787.html">this one</a>, another reason may be install order of mapguide and .net. I also hear from others that they get this error if they happened to miss up the 32bit/64bit, that means they are trying to install 32bit of AIMS on a 64bit OS or verse visa.&#160; </p>  <p>Anyway, it depends, you may need to check more if you do not want to reinstall or it does not work for you. </p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: James Maeding
EMAIL: jmaeding@hunsaker.com
IP: 24.249.247.46
URL: 
DATE: 11/01/2012 09:07:59 AM
can someone from the adesk AIM team start watching the DG chapter set up for AIM?
I asked if anyone was seeing decent publish speeds for AIM 360, and heard nothing.
Does not Autodesk relize that just me asking that question implies the launch of AIM 360 may be a failure for practical reasons?
-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 59.92.137.109
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 11/26/2012 04:55:54 AM
Hi James,

Do you mean Autodesk Infrastructure Modeler (AIM) here ?


Thanks,
Partha
ADN
-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Civil 3D SurfaceBoundary Properties
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: civil-3d-surfaceboundary-properties
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/10/civil-3d-surfaceboundary-properties.html 
DATE: 10/29/2012 02:14:32 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>This is
further to my previous post ‘<a href="http://adndevblog.typepad.com/infrastructure/2012/10/accessing-surface-boundary-vertices-using-civil-3d-net-api.html">Accessing
Surface Boundary vertices using Civil 3D .NET API</a>’. When we try to add a
boundary object in Civil 3D using UI tools, we get to see the following UI
window :</p>
<p>&#0160;</p>
<p>&#0160;
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017ee48a8a18970d-pi" style="display: inline;"><img alt="Boundary_Prop" class="asset  asset-image at-xid-6a0167607c2431970b017ee48a8a18970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017ee48a8a18970d-500wi" title="Boundary_Prop" /></a></p>
<p>&#0160;</p>
<p>In this post
I will explain what are the equivalent APIs available currently (in release
2013) corresponding to boundary properties we see in the above UI dialog box.</p>
<p>&#39;<em><strong>Name</strong></em>&#39; is accessible through
<strong>BoundariesDefinition.Item(i).Name</strong></p>
<p>&#39;<em><strong>Type</strong></em>&#39; is accessible through
<strong>SurfaceBoundary.BoundaryType</strong> </p>
<p><strong>SurfaceBoundaryType</strong> Enumeration -</p>
<p>&#0160;<em><strong>Show&#0160; </strong></em></p>
<p><em><strong>&#0160;DataClip&#0160;
</strong></em></p>
<p><em><strong>&#0160;Outer&#0160;&#0160; </strong></em></p>
<p><em><strong>&#0160;Hide</strong></em> </p>
<p>&#0160;</p>
<p>&#39;<em><strong>Non-Destructive breakline</strong></em>&#39; is same as
<strong>IsTrimmed</strong> [BoundariesDefinition.Item(i).IsTrimmed ]&#0160; </p>
<p>&#0160;</p>
<p>&#39;<em><strong>Mid-ordinate
distance</strong></em>&#39; is not exposed yet; we have a wish list logged for the same. Let me
know if this is useful to you, I can assign an appropriate priority based on
number of responses I see here.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Jeff Mishler
EMAIL: miff@sonic.net
IP: 99.105.62.248
URL: http://www.quuxsoft.com
DATE: 11/11/2012 09:31:08 AM
I, for one, would like to see the mid-ordinate distance property exposed.
-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 59.92.207.129
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 11/12/2012 12:02:13 AM
Thanks Jeff !
It's already added to our API wish list item and hopefully we see it exposed sooner :)

Thanks,
Partha
-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Accessing Surface Boundary vertices using Civil 3D .NET API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: accessing-surface-boundary-vertices-using-civil-3d-net-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/10/accessing-surface-boundary-vertices-using-civil-3d-net-api.html 
DATE: 10/26/2012 05:38:29 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>If you are looking for a way to read the Vertices of Civil 3D Surface boundary object, here is the .NET API which facilitates the same.&#0160;</p>
<p><strong>SurfaceBoundary.Vertices</strong>
Property - &gt; Gets a collection of vertices that make up the boundary. </p>
<p>&#0160;</p>
<p>And here is a
VB.NET code snippet which demonstrates the usage of the same -</p>
<p>&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> tSurface </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> Autodesk.Civil.DatabaseServices.</span><span style="color: #2b91af; line-height: 140%;">TinSurface</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">tSurface = trans.GetObject(idEnt, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForRead)</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">If</span><span style="line-height: 140%;"> tSurface.BoundariesDefinition.Count &gt; 0 </span><span style="color: blue; line-height: 140%;">Then</span><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">For</span><span style="line-height: 140%;"> i </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Integer</span><span style="line-height: 140%;"> = 0 </span><span style="color: blue; line-height: 140%;">to</span><span style="line-height: 140%;"> tSurface.BoundariesDefinition.Count -1</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> boundaryName </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">String</span><span style="line-height: 140%;"> = tSurface.BoundariesDefinition.Item(i).Name.ToString() </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> surfaceBoundary </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">SurfaceBoundary</span><span style="line-height: 140%;"> = tSurface.BoundariesDefinition.Item(i).Item(0)&#0160; &#0160; </span></p>
<p style="margin: 0px;"><span style="background-color: #ffff00;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> boundaryVerticesPointColl </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Point3dCollection</span><span style="line-height: 140%;"> = surfaceBoundary.Vertices</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; ed.WriteMessage(vbCrLf + </span><span style="color: #a31515; line-height: 140%;">&quot;Boundary Name :&quot;</span><span style="line-height: 140%;"> + boundaryName )</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">For</span><span style="line-height: 140%;"> j </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Integer</span><span style="line-height: 140%;"> = 0 </span><span style="color: blue; line-height: 140%;">to</span><span style="line-height: 140%;"> boundaryVerticesPointColl.Count -1</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; ed.WriteMessage(vbCrLf + </span><span style="color: #a31515; line-height: 140%;">&quot;Boundary Vertices :&quot;</span><span style="line-height: 140%;"> + boundaryVerticesPointColl.Item(j).ToString() )</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Next</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">Next</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">If</span></p>
</div>
<p>&#0160;</p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017ee4765cb0970d-pi" style="display: inline;"><img alt="Boundary_Vertices" class="asset  asset-image at-xid-6a0167607c2431970b017ee4765cb0970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017ee4765cb0970d-500wi" title="Boundary_Vertices" /></a></p>
<p>Hope this is
useful to you!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Creating an AutoCAD Selection set from the Map 3D Platform Selection set (MgSelectionBase)
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: creating-an-autocad-selection-set-from-the-map-3d-platform-selection-set-mgselectionbase
CATEGORY: .NET
CATEGORY: AutoCAD Map 3D 2011
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: FDO
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/10/creating-an-autocad-selection-set-from-the-map-3d-platform-selection-set-mgselectionbase.html 
DATE: 10/25/2012 11:32:23 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>I am trying
to use the <strong>_MAPExtractFeatureGeometry</strong> from <strong>SendStringToExecute()</strong> function and I
want to pass in a selection set containing a Feature.</p>
<p>I have used
Geospatial Platform API and <em><strong>MgSelectionBase</strong></em> to create a selection set of
features which works fine as I could highlight the selected feature. But
subsequently when I use&#0160;
<strong>_MAPExtractFeatureGeometry</strong> from <strong>SendStringToExecute()</strong>, I get a response
&#39;there is no selection set&#39;. I am trying to avoid the user intervention to
select a feature on screen. How do I create an AutoCAD selection set from the Map
3D Platform Selection set (<em><strong>MgSelectionBase</strong></em>) ?</p>
<p>&#0160;</p>
<p>Here is a C# .NET code snippet demonstrating the same –</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Select using API</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">AcMapMap</span><span style="line-height: 140%;"> currentMap = </span><span style="color: #2b91af; line-height: 140%;">AcMapMap</span><span style="line-height: 140%;">.GetCurrentMap();</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">MgLayerCollection</span><span style="line-height: 140%;"> layers = currentMap.GetLayers();</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">MgLayerBase</span><span style="line-height: 140%;"> layer = layers.GetItem(</span><span style="color: #a31515; line-height: 140%;">&quot;Parcels&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">MgFeatureService</span><span style="line-height: 140%;"> fs = </span><span style="color: #2b91af; line-height: 140%;">AcMapServiceFactory</span><span style="line-height: 140%;">.GetService(</span><span style="color: #2b91af; line-height: 140%;">MgServiceType</span><span style="line-height: 140%;">.FeatureService) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">MgFeatureService</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">string</span><span style="line-height: 140%;"> fsId = layer.GetFeatureSourceId();</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">string</span><span style="line-height: 140%;"> className = layer.GetFeatureClassName();</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">MgFeatureQueryOptions</span><span style="line-height: 140%;"> query = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">MgFeatureQueryOptions</span><span style="line-height: 140%;">();</span></p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Parcels.shp file is used</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">query.SetFilter(</span><span style="color: #a31515; line-height: 140%;">&quot;FeatId = 166&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">MgResourceIdentifier</span><span style="line-height: 140%;"> resId = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">MgResourceIdentifier</span><span style="line-height: 140%;">(fsId);</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">MgFeatureReader</span><span style="line-height: 140%;"> featureReader = fs.SelectFeatures(resId, className, query);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">MgSelectionBase</span><span style="line-height: 140%;"> selectionSet = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">MgSelectionBase</span><span style="line-height: 140%;">(currentMap);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">//Add all features in the feature reader to the newly constructed selection set</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">selectionSet.AddFeatures(layer, featureReader, 0);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">AcMapFeatureEntityService</span><span style="line-height: 140%;">.HighlightFeatures(selectionSet);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// create an AutoCAD selection</span></p>
<p style="margin: 0px;"><span style="background-color: #ffff00;"><span style="color: #2b91af; line-height: 140%;">SelectionSet</span><span style="line-height: 140%;"> acadSelSet = </span><span style="color: #2b91af; line-height: 140%;">AcMapFeatureEntityService</span><span style="line-height: 140%;">.AddFeaturesToSelectionSet(</span><span style="color: blue; line-height: 140%;">null</span><span style="line-height: 140%;">, selectionSet);</span></span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// force this selection to be the implied selection</span></p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;"><br /></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">Autodesk.AutoCAD.ApplicationServices.</span><span style="color: #2b91af; line-height: 140%;">Application</span><span style="line-height: 140%;">.DocumentManager.MdiActiveDocument</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">.Editor.<span style="background-color: #ffff00;">SetImpliedSelection(acadSelSet);</span></span><span style="font-size: 8pt;">&#0160;</span><span style="font-size: 8pt;">&#0160;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">Autodesk.AutoCAD.ApplicationServices.</span><span style="color: #2b91af; line-height: 140%;">Application</span><span style="line-height: 140%;">.DocumentManager.MdiActiveDocument</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">.SendStringToExecute(</span><span style="color: #a31515; line-height: 140%;">&quot;_MAPExtractFeatureGeometry &quot;</span><span style="line-height: 140%;">, </span><span style="color: blue; line-height: 140%;">true</span><span style="line-height: 140%;">, </span><span style="color: blue; line-height: 140%;">false</span><span style="line-height: 140%;">, </span><span style="color: blue; line-height: 140%;">true</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">featureReader.Close();&#0160; &#0160; &#0160; &#0160;&#0160; </span></p>
<p style="margin: 0px;">&#0160;</p>
</div>
<p>Hope this is useful to you!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Convert coordinates from GPS (LL84) to Civil 3D active project settings
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: convert-coordinates-from-gps-ll84-to-civil-3d-active-project-settings
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D 2013

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/10/convert-coordinates-from-gps-ll84-to-civil-3d-active-project-settings.html 
DATE: 10/19/2012 11:36:48 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/manufacturing/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>In preparation for my class at AU 2012 Las Vegas, <a href="https://www.autodeskuniversity2012.com/connect/sessionDetail.ww?SESSION_ID=3325">From Mobile and Through the Cloud to AutoCAD Civil 3D</a>, I needed to convert the coordinates of a point captured with my phone to active project coordinate system. This is required to place the photo (taken with the phone camera) at the correct project location.</p>  <p>The basic code came from this <a href="http://adndevblog.typepad.com/infrastructure/2012/09/how-to-apply-coordinate-system-transformation-using-api-.html">blog post</a>, but you may notice that this applies to Map 3D and do not work for Civil 3D. So below is the modified version. Note this requires some additional references not commonly used on Civil 3D development.</p>  <div style="font-family: ; background: white">   <p style="margin: 0px"><font face="Courier New"><span><font color="#808080"><font style="font-size: 10pt">///</font></font></span><font style="font-size: 10pt"><span><font color="#008000"> </font></span></font><span><font style="font-size: 10pt" color="#808080">&lt;summary&gt;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#808080"><font style="font-size: 10pt">///</font></font></span><span><font style="font-size: 10pt" color="#008000"> Convert the point from LL84 (GPS Coordinate System) into </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#808080"><font style="font-size: 10pt">///</font></font></span><span><font style="font-size: 10pt" color="#008000"> Civil 3D active document coordinate system</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#808080"><font style="font-size: 10pt">///</font></font></span><font style="font-size: 10pt"><span><font color="#008000"> </font></span></font><span><font style="font-size: 10pt" color="#808080">&lt;/summary&gt;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#808080"><font style="font-size: 10pt">///</font></font></span><font style="font-size: 10pt"><span><font color="#008000"> </font></span></font><span><font style="font-size: 10pt" color="#808080">&lt;remarks&gt;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#808080"><font style="font-size: 10pt">///</font></font></span><span><font style="font-size: 10pt" color="#008000"> Requires C:\Program Files\Autodesk\</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#808080"><font style="font-size: 10pt">///</font></font></span><span><font style="font-size: 10pt" color="#008000"> AutoCAD Civil 3D 2013\OSGeo.MapGuide.Geometry.dll</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#808080"><font style="font-size: 10pt">///</font></font></span><span><font style="font-size: 10pt" color="#008000"> Requires C:\Program Files\Autodesk\</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#808080"><font style="font-size: 10pt">///</font></font></span><span><font style="font-size: 10pt" color="#008000"> AutoCAD Civil 3D 2013\OSGeo.MapGuide.Foundation.dll</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#808080"><font style="font-size: 10pt">///</font></font></span><font style="font-size: 10pt"><span><font color="#008000"> </font></span></font><span><font style="font-size: 10pt" color="#808080">&lt;/remarks&gt;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 10pt">public</font></font></span><font style="font-size: 10pt"><font color="#000000"> </font><span><font color="#0000ff">static</font></span><font color="#000000"> </font><span><font color="#2b91af">Point3d</font></span><font color="#000000"> ConvertPointCoordinate(</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#2b91af">Point3d</font></span><font color="#000000"> point_LL84)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">{</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#2b91af">MgCoordinate</font></span><font color="#000000"> coord = </font><span><font color="#0000ff">null</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">if</font></span><font color="#000000"> (CSTransform != </font><span><font color="#0000ff">null</font></span><font color="#000000"> &amp;&amp;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; !</font></font><font style="font-size: 10pt"><span><font color="#0000ff">double</font></span><font color="#000000">.IsNaN(point_LL84.Z))</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;&#160;&#160; coord = CSTransform.Transform(</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;&#160;&#160;&#160;&#160; point_LL84.X, point_LL84.Y, point_LL84.Z);</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><span><font style="font-size: 10pt" color="#0000ff">else</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;&#160;&#160; coord = CSTransform.Transform(</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;&#160;&#160;&#160;&#160; point_LL84.X, point_LL84.Y);</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">return</font></span><font color="#000000"> </font><span><font color="#0000ff">new</font></span><font color="#000000"> </font><span><font color="#2b91af">Point3d</font></span><font color="#000000">(</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;&#160;&#160; coord.X, coord.Y, coord.Z);</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">}</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 10pt">private</font></font></span><font style="font-size: 10pt"><font color="#000000"> </font><span><font color="#0000ff">static</font></span><font color="#000000"> </font><span><font color="#2b91af">MgCoordinateSystemTransform</font></span><font color="#000000"> </font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; _cstransform = </font><span><font color="#0000ff">null</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#808080"><font style="font-size: 10pt">///</font></font></span><font style="font-size: 10pt"><span><font color="#008000"> </font></span></font><span><font style="font-size: 10pt" color="#808080">&lt;summary&gt;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#808080"><font style="font-size: 10pt">///</font></font></span><span><font style="font-size: 10pt" color="#008000"> Get the Coordinate System Transform.</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#808080"><font style="font-size: 10pt">///</font></font></span><font style="font-size: 10pt"><span><font color="#008000"> </font></span></font><span><font style="font-size: 10pt" color="#808080">&lt;/summary&gt;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 10pt">private</font></font></span><font style="font-size: 10pt"><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#0000ff">static</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><span><font style="font-size: 10pt" color="#2b91af">MgCoordinateSystemTransform</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160; CSTransform</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">{</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><span><font style="font-size: 10pt" color="#0000ff">get</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160; {</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">if</font></span><font color="#000000"> (_cstransform != </font><span><font color="#0000ff">null</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">return</font></span><font color="#000000"> _cstransform;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 10pt" color="#008000">// get Civil3D current coordinate system</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#2b91af">CivilDocument</font></span><font color="#000000"> civilDoc = </font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#2b91af">CivilApplication</font></span><font color="#000000">.ActiveDocument;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">string</font></span><font color="#000000"> code = civilDoc.Settings.</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;&#160;&#160;&#160;&#160; DrawingSettings.UnitZoneSettings.</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;&#160;&#160;&#160;&#160; CoordinateSystemCode;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 10pt" color="#008000">// get the transformation </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#2b91af">MgCoordinateSystemFactory</font></span><font color="#000000"> coordSysFactory </font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160; = </font></font><font style="font-size: 10pt"><span><font color="#0000ff">new</font></span><font color="#000000"> </font><span><font color="#2b91af">MgCoordinateSystemFactory</font></span><font color="#000000">();</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#2b91af">MgCoordinateSystem</font></span><font color="#000000"> coordSys = </font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;&#160;&#160;&#160;&#160; coordSysFactory.CreateFromCode(code);</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#2b91af">MgCoordinateSystem</font></span><font color="#000000"> wgs84Sys =</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160; coordSysFactory.Create(</font></font><font style="font-size: 10pt"><span><font color="#a31515">&quot;LL84&quot;</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 10pt" color="#008000">// convert the coordinates</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;&#160;&#160; _cstransform = coordSysFactory.</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;&#160;&#160;&#160;&#160; GetTransform(wgs84Sys, coordSys);</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">return</font></span><font color="#000000"> _cstransform;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160; }</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">}</font></font></p> </div>  <p>See you in Las Vegas!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: How to update/change Civil 3D Corridor subassembly Parameter values?
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: how-to-updatechange-civil-3d-corridor-subassembly-parameter-values
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2011
CATEGORY: AutoCAD Civil 3D 2012
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/10/how-to-updatechange-civil-3d-corridor-subassembly-parameter-values.html 
DATE: 10/16/2012 10:53:49 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>If you want
to change / update a subassembly parameter e.g. &quot;Slope&quot;, you can
currently use Civil 3D COM API as .NET API in the current release (Civil 3D
2013) doesn&#39;t support this.&#0160;</p>
<p>Here is a C#
.NET code snippet demonstrating usage of <strong>AeccSubassembly</strong> COM API and how to
change &quot;Slope&quot; parameter value.</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">AeccRoadwayApplication</span><span style="line-height: 140%;"> roadwayApp = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">AeccRoadwayApplication</span><span style="line-height: 140%;">();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">roadwayApp.Init((</span><span style="color: #2b91af; line-height: 140%;">AcadApplication</span><span style="line-height: 140%;">)Autodesk.AutoCAD.ApplicationServices.</span><span style="color: #2b91af; line-height: 140%;">Application</span><span style="line-height: 140%;">.AcadApplication);</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">AeccRoadwayDocument</span><span style="line-height: 140%;"> roadwayDoc = roadwayApp.ActiveDocument </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">AeccRoadwayDocument</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">AeccRoadwayDatabase</span><span style="line-height: 140%;"> roadwayDb = roadwayDoc.Database </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">AeccRoadwayDatabase</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">AeccSubassembly</span><span style="line-height: 140%;"> subassembly = roadwayDb.Subassemblies.Item(0);</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">IAeccParamsDouble</span><span style="line-height: 140%;"> paramsDouble = subassembly.ParamsDouble;</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">IAeccParamDouble</span><span style="line-height: 140%;"> slopeParam = paramsDouble.Item(</span><span style="color: #a31515; line-height: 140%;">&quot;Slope&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\n Subassembly Slope parameter Before Change : &quot;</span><span style="line-height: 140%;"> + slopeParam.Value.ToString());</span></p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Change the slopeParam Value&#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">slopeParam.Value = -0.01;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\n Subassembly Slope parameter After Change : &quot;</span><span style="line-height: 140%;"> + slopeParam.Value.ToString());</span></p>
</div>
<p>&#0160;</p>
Hope this is useful to you!
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Failed to add FS to collection at ResourceService.SetResource in Map 3D 2013
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: failed-to-add-fs-to-collection-at-resourceservicesetresource-in-map-3d-2013
CATEGORY: AutoCAD Map 3D 2013

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/10/failed-to-add-fs-to-collection-at-resourceservicesetresource-in-map-3d-2013.html 
DATE: 10/15/2012 03:38:50 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>If you are migrating your application to Map 3D 2013 and run into this problem, this post may be helpful for you. Let’s say you have a custom command to add resource with Resource Service,for example, you are connecting to a feature source, like the implementation in the “BuildMap” sample of SDK. If you happen to run your custom command in session context:</p>  <p>&lt;CommandMethod(&quot;MyCommand&quot;, <font style="background-color: #ffff00">CommandFlags.Session</font>&gt; _    <br />or </p>  <p>[CommandMethod(&quot;MyCommand&quot;,<font style="background-color: #ffff00"> CommandFlags.Session</font>)]</p>  <p>or trying to add FDO connection from a pallet set.</p>  <p>You may get the error message at ResourceService.SetResource(): </p>  <p align="center">“Failed to add FS to collection“</p>  <p>The solution is to add DocumentLock before setting resource. Here is a pseudo code snippet:</p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; [</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">CommandMethod</font></span><span style="line-height: 11pt"><font color="#000000">(</font></span><span style="line-height: 11pt; color: "><font color="#a31515">&quot;MyCommand&quot;</font></span><span style="line-height: 11pt"><font color="#000000">, </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">CommandFlags</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.Session)]</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">public</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">void</font></span><span style="line-height: 11pt"><font color="#000000"> MyCommand() </font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">// This method can have any name</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">Document</font></span><span style="line-height: 11pt"><font color="#000000"> doc = </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">Application</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.DocumentManager.MdiActiveDocument;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">// You must lock the document in Map 3D 2013</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">using</font></span><span style="line-height: 11pt"><font color="#000000"> (</font></span><span style="line-height: 11pt; color: "><font color="#2b91af">DocumentLock</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> docLock = doc.LockDocument())</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">// ...</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; ResourceService.SetResource(...);</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//...</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></span></p> </div>  <p>And here is the explanation:<em> </em></p>  <p><em>In Map 3D 2012, the Resource Manager was not an AcDbObject – so you did not need to have a DB Lock to access it.&#160; Thus, it was OK to run the custom command in Session context.</em></p>  <p><i></i></p>  <p><i>In Map 3D 2013, the Resource Manager is moved into the Database, so you are now required to have a Document Lock to access it.&#160; Therefore, the custom command can no longer be run in Session context. </i></p>  <p>Hope this helps.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Getting Civil 3D Land FeatureLine Vertices
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: getting-civil-3d-land-featureline-vertices
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2011
CATEGORY: AutoCAD Civil 3D 2012
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/10/getting-civil-3d-land-featureline-vertices.html 
DATE: 10/12/2012 03:01:32 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>Civil 3D .NET
API has <strong>FeatureLine</strong> class, but not many functionalities are exposed in the
current release (Civil 3D 2013). On the other hand Civil 3D COM API has
<strong>AeccLandFeatureLine</strong> Object and it has some useful functions exposed. I am
aware, some of our Civil 3D application developers want to access the Land
FeatureLine Vertices and in the absence of equivalent .NET API, I would suggest
to use COM API <strong>IAeccLandFeatureLine:: GetPoints()</strong></p>
<p>&#0160;</p>
<p>Here is a
VB.NET code snippet which demonstrates how to get the Civil 3D Land FeatureLine
Vertices –</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> idEnt </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> = promptEntRs.ObjectId&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> ent </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> Autodesk.AutoCAD.DatabaseServices.</span><span style="color: #2b91af; line-height: 140%;">Entity</span><span style="line-height: 140%;"> = </span><span style="color: blue; line-height: 140%;">DirectCast</span><span style="line-height: 140%;">(trans.GetObject(idEnt, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForWrite), Autodesk.AutoCAD.DatabaseServices.</span><span style="color: #2b91af; line-height: 140%;">Entity</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> oFtrLn </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">AeccLandFeatureLine</span><span style="line-height: 140%;"> =&#0160; </span><span style="color: blue; line-height: 140%;">DirectCast</span><span style="line-height: 140%;">(ent.AcadObject, Autodesk.AECC.Interop.Land.</span><span style="color: #2b91af; line-height: 140%;">AeccLandFeatureLine</span><span style="line-height: 140%;">) </span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> output </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">String</span><span style="line-height: 140%;"> = </span><span style="color: #a31515; line-height: 140%;">&quot;&quot;</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> points() </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Double</span><span style="line-height: 140%;"> = oFtrLn.GetPoints()</span></p>
<p style="margin: 0px;"><span style="background-color: #ffff00;"><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> varArraySurfacePoints </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Object</span><span style="line-height: 140%;"> = oFtrLn.GetPoints()&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span></span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> iPvertices </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Long</span><span style="line-height: 140%;"> </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">For</span><span style="line-height: 140%;"> iPvertices = 0 </span><span style="color: blue; line-height: 140%;">To</span><span style="line-height: 140%;"> (oFtrLn.PointsCount * 3 - 1)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; output = output &amp; </span><span style="color: #a31515; line-height: 140%;">&quot;Coordinate Values&#0160; :&#0160; &quot;</span><span style="line-height: 140%;"> &amp; points(iPvertices) &amp; vbCrLf &amp; vbLf</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">Next</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">ed.WriteMessage(vbCrLf + </span><span style="color: #a31515; line-height: 140%;">&quot;Vertices of Selected Land Feature Line : &quot;</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">ed.WriteMessage(vbCrLf + output)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><br /></span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017ee41e167f970d-pi" style="display: inline;"><img alt="LandFeatureLine" class="asset  asset-image at-xid-6a0167607c2431970b017ee41e167f970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017ee41e167f970d-500wi" title="LandFeatureLine" /></a><br /><br /></span></p>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Using "SwapPartFamilyAndSize" in late-binding .NET application
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: using-swappartfamilyandsize-in-late-binding-net-application
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2011
CATEGORY: AutoCAD Civil 3D 2012
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/10/using-swappartfamilyandsize-in-late-binding-net-application.html 
DATE: 10/11/2012 02:18:56 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>AeccPipeNetworkPart::<strong>SwapPartFamilyAndSize()</strong>&#0160; is a Civil 3D COM API which swaps the part
family. It doesn&#39;t have a .NET version yet (2013 release of Civil 3D). If you
are trying to avoid any COM references and opting a late binding approach and
not sure about how to prepare the input argument for the SwapPartFamilyAndSize,
here is a relevant code snippet :&#0160;</p>
<p>&#0160;</p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017d3ca2b98f970c-pi" style="display: inline;"><img alt="Pipe_Part_1" class="asset  asset-image at-xid-6a0167607c2431970b017d3ca2b98f970c" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017d3ca2b98f970c-500wi" title="Pipe_Part_1" /></a></p>
<p>&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">Transaction</span><span style="line-height: 140%;"> ts = </span><span style="color: #2b91af; line-height: 140%;">Application</span><span style="line-height: 140%;">.DocumentManager.MdiActiveDocument.Database.TransactionManager.StartTransaction())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">Part</span><span style="line-height: 140%;"> part = (</span><span style="color: #2b91af; line-height: 140%;">Part</span><span style="line-height: 140%;">)ts.GetObject(res.ObjectId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForRead);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">object</span><span style="line-height: 140%;"> acadpart = part.AcadObject;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">object</span><span style="line-height: 140%;"> partfam = acadpart.GetType().InvokeMember(</span><span style="color: #a31515; line-height: 140%;">&quot;PartFamily&quot;</span><span style="line-height: 140%;">, System.Reflection.</span><span style="color: #2b91af; line-height: 140%;">BindingFlags</span><span style="line-height: 140%;">.GetProperty, </span><span style="color: blue; line-height: 140%;">null</span><span style="line-height: 140%;">, acadpart, </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">object</span><span style="line-height: 140%;">[0]);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> prtfamId = Autodesk.AutoCAD.DatabaseServices.</span><span style="color: #2b91af; line-height: 140%;">DBObject</span><span style="line-height: 140%;">.FromAcadObject(partfam);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">PartFamily</span><span style="line-height: 140%;"> partfamily = (</span><span style="color: #2b91af; line-height: 140%;">PartFamily</span><span style="line-height: 140%;">)ts.GetObject(prtfamId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForRead);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">object</span><span style="line-height: 140%;">[] dataArry = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">object</span><span style="line-height: 140%;">[2];</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; dataArry[0] = partfamily.GUID;&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> partSizeId = partfamily[0];</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">PartSize</span><span style="line-height: 140%;"> partSize = ts.GetObject(partSizeId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForRead) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">PartSize</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; dataArry[1] = partSize.AcadObject;</span></p>
<p style="margin: 0px;"><span style="background-color: #ffff00;"><span style="line-height: 140%;">&#0160; acadpart.GetType().InvokeMember(</span><span style="color: #a31515; line-height: 140%;">&quot;SwapPartFamilyAndSize&quot;</span><span style="line-height: 140%;">, System.Reflection.</span><span style="color: #2b91af; line-height: 140%;">BindingFlags</span><span style="line-height: 140%;">.InvokeMethod, </span><span style="color: blue; line-height: 140%;">null</span><span style="line-height: 140%;">, acadpart, dataArry);</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; ts.Commit();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;"><br /></span></p>
</div>
Hope this is useful to you!
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Geurt
EMAIL: geurt@kariwa.co.za
IP: 41.146.62.41
URL: 
DATE: 11/16/2012 02:41:05 AM
Partha
Is this also usable to access "Flow Rate"? I need to access "Flow Rate" to use in a Excel spreadsheet.

Geurt
-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 59.92.137.109
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 11/26/2012 04:48:57 AM
Hi Geurt,

"Flow Rate" is not exposed. I am logging a wish list to expose it and other two - "Junction Loss", "Return Period" in future release of Civil 3D.

Thanks,
Partha
-----
COMMENT:
AUTHOR: Neyton
EMAIL: neyton@yahoo.com
IP: 187.60.121.62
URL: http://tbn2.blogspot.com
DATE: 11/28/2012 12:00:27 PM
Dim o As Part '...
Dim pf as PartFamily '...
dim ps as PartSize '...

o.AcadObject.SwapPartFamilyAndSize(pf.GUID, ps.AcadObject)

directly, problem?

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Read FDO Geometry Area using Map 3D Geospatial Platform API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: read-fdo-geometry-area-using-map-3d-geospatial-platform-api
CATEGORY: .NET
CATEGORY: AutoCAD Map 3D 2011
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: FDO
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/10/read-fdo-geometry-area-using-map-3d-geospatial-platform-api.html 
DATE: 10/08/2012 11:07:35 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>This blog
post is in continuation of my previous post on “<a href="http://adndevblog.typepad.com/infrastructure/2012/05/read-fdo-features-using-map-3d-geospatial-platform-api.html">Read
FDO Features using Map 3D Geospatial Platform API</a> “.&#0160; If FDO data has an attribute like “AREA” as shown
in the screenshot below, we can access the same using –</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">String</span><span style="line-height: 140%;"> ftrArea = ftrRdr.GetString(</span><span style="color: #a31515; line-height: 140%;">&quot;AREA&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><br /></span></p>
</div>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017ee40cc12b970d-pi" style="display: inline;"><img alt="FDO_Area_01" class="asset  asset-image at-xid-6a0167607c2431970b017ee40cc12b970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017ee40cc12b970d-500wi" title="FDO_Area_01" /></a><br /><br /></p>
<p>However, if
there is no such attribute or data field in the FDO data, in that case we can
use the following approach to access the FDO Geometry and then read it’s Area property
as shown in the code snippet below :</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">//this is just an example; change this according to your FDO data field &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160;&#0160;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">Int32</span><span style="line-height: 140%;"> ftrID = ftrRdr.GetInt32(</span><span style="color: #a31515; line-height: 140%;">&quot;Autogenerated_SDF_ID&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">String</span><span style="line-height: 140%;"> geomName = mapLayer.GetFeatureGeometryName();</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">MgByteReader</span><span style="line-height: 140%;"> reader = ftrRdr.GetGeometry(geomName);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Convert the AGF binary data to MgGeometry. </span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">MgAgfReaderWriter</span><span style="line-height: 140%;"> agfReaderWriter = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">MgAgfReaderWriter</span><span style="line-height: 140%;">();</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">MgGeometry</span><span style="line-height: 140%;"> ftrGeometry = agfReaderWriter.Read(reader);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\n Feature ID :&quot;</span><span style="line-height: 140%;"> + ftrID.ToString() + </span><span style="color: #a31515; line-height: 140%;">&quot;&#0160;&#0160; &quot;</span><span style="line-height: 140%;"> + </span><span style="color: #a31515; line-height: 140%;">&quot;Area&#0160; : &quot;</span><span style="line-height: 140%;"> + ftrGeometry.Area.ToString());&#0160;&#0160; </span></p>
</div>
<p>&#0160;</p>
<p>Hope this is
useful to you!&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Accessing Civil 3D Abbreviation settings
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: accessing-civil-3d-abbreviation-settings
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D 2013

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/10/accessing-civil-3d-abbreviation-settings.html 
DATE: 10/03/2012 08:22:58 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>Under the Drawing Settings we have a list of abbreviations that Civil 3D will use on its reports, for instance. It is possible access that information from the CivilDocument Settings properties. The following code show, first, how list all abbreviations for Alignment Geometry Point Text and, second, access a specific one from the enumeration list. To change a abbreviation, simply use <strong><u>Set</u></strong>AlignmentAbbreviation instead.</p>  <div style="font-family: ; background: white">   <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&lt;</font></font><font style="font-size: 10pt"><span><font color="#2b91af">CommandMethod</font></span><font color="#000000">(</font><span><font color="#a31515">&quot;listAbbrev&quot;</font></span><font color="#000000">)&gt; _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 10pt">Public</font></font></span><font style="font-size: 10pt"><font color="#000000"> </font><span><font color="#0000ff">Sub</font></span><font color="#000000"> CmdListAbbreviations()</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> ed </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">Editor</font></span><font color="#000000"> = </font><span><font color="#2b91af">Application</font></span><font color="#000000">. _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;&#160;&#160; DocumentManager.MdiActiveDocument.Editor</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> civilDoc </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">CivilDocument</font></span><font color="#000000"> = _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#2b91af">CivilApplication</font></span><font color="#000000">.ActiveDocument</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> abbrev </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">SettingsAbbreviationAlignment</font></span><font color="#000000"> = _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;&#160;&#160; civilDoc.Settings.DrawingSettings. _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;&#160;&#160; AbbreviationsSettings.AlignmentGeoPointText</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><span><font style="font-size: 10pt" color="#008000">' list all abbreviations for </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><span><font style="font-size: 10pt" color="#008000">' Alignment Geometry Point Text</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> tpAbbrev </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">Type</font></span><font color="#000000"> = </font><span><font color="#0000ff">GetType</font></span><font color="#000000">(</font><span><font color="#2b91af">AbbreviationAlignmentType</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> typesAbbrev </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">Array</font></span><font color="#000000"> = </font><span><font color="#2b91af">[Enum]</font></span><font color="#000000">.GetValues(tpAbbrev)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">For</font></span><font color="#000000"> </font><span><font color="#0000ff">Each</font></span><font color="#000000"> tp </font><span><font color="#0000ff">In</font></span><font color="#000000"> typesAbbrev</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> value </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#0000ff">String</font></span><font color="#000000"> = abbrev.GetAlignmentAbbreviation(tp)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; ed.WriteMessage(</font></font><font style="font-size: 10pt"><span><font color="#a31515">&quot;{0}{1}: {2}&quot;</font></span><font color="#000000">, _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; vbNewLine, _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#2b91af">[Enum]</font></span><font color="#000000">.GetName(tpAbbrev, tp), _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; value)</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><span><font style="font-size: 10pt" color="#0000ff">Next</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><span><font style="font-size: 10pt" color="#008000">' so to access a specific one, let's</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><span><font style="font-size: 10pt" color="#008000">' say TangentSpiralIntersect, use:</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> tsi </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#0000ff">String</font></span><font color="#000000"> = abbrev.GetAlignmentAbbreviation( _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#2b91af">AbbreviationAlignmentType</font></span><font color="#000000">.TangentSpiralIntersect)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 10pt">End</font></font></span><font style="font-size: 10pt"><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#0000ff">Sub</font></span></font></p> </div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Rod Wing
EMAIL: rod@envisioncad.com
IP: 69.130.248.66
URL: 
DATE: 07/08/2014 01:01:09 PM
I am using Civil 3D 2014 and trying to use the SetAlignmentAbbreviation method. On the first run through it works fine. On subsequent runs I get a Null Exception using the method. On checking both arguments they are valid, non-null, values.

I have included my code below.

Any ideas?
Thanks.
Rod

Private Function UpdateAbbreviationSettings(ByRef civDoc As Autodesk.Civil.ApplicationServices.CivilDocument) As Boolean
        Dim i As Integer
        Dim iStart As Integer
        Dim iEnd As Integer
        Dim strValue As String

        UpdateAbbreviationSettings = False

        Try
            Dim abAlgET() As Autodesk.Civil.Settings.AbbreviationAlignmentEnhancedType
            abAlgET = {Autodesk.Civil.Settings.AbbreviationAlignmentEnhancedType.AlignmentBeginningPoint, _
                   Autodesk.Civil.Settings.AbbreviationAlignmentEnhancedType.AlignmentEndPoint, _
                   Autodesk.Civil.Settings.AbbreviationAlignmentEnhancedType.CompoundSpiralLargeRadiusAtBeginning, _
                   Autodesk.Civil.Settings.AbbreviationAlignmentEnhancedType.CompoundSpiralLargeRadiusAtEnd, _
                   Autodesk.Civil.Settings.AbbreviationAlignmentEnhancedType.CompoundSpiralSmallRadiusAtBeginning, _
                   Autodesk.Civil.Settings.AbbreviationAlignmentEnhancedType.CompoundSpiralSmallRadiusAtEnd, _
                   Autodesk.Civil.Settings.AbbreviationAlignmentEnhancedType.CurveBeginning, _
                   Autodesk.Civil.Settings.AbbreviationAlignmentEnhancedType.CurveEnd, _
                   Autodesk.Civil.Settings.AbbreviationAlignmentEnhancedType.LineBeginning, _
                   Autodesk.Civil.Settings.AbbreviationAlignmentEnhancedType.LineEnd, _
                   Autodesk.Civil.Settings.AbbreviationAlignmentEnhancedType.SimpleSpiralLargeRadiusAtBeginning, _
                   Autodesk.Civil.Settings.AbbreviationAlignmentEnhancedType.SimpleSpiralLargeRadiusAtEnd, _
                   Autodesk.Civil.Settings.AbbreviationAlignmentEnhancedType.SimpleSpiralSmallRadiusAtBeginning, _
                   Autodesk.Civil.Settings.AbbreviationAlignmentEnhancedType.SimpleSpiralSmallRadiusAtEnd _
                  }
            iStart = LBound(abAlgET)
            iEnd = UBound(abAlgET)
            For i = iStart To iEnd
                strValue = civDoc.Settings.DrawingSettings.AbbreviationsSettings.AlignmentGeoPointEntityData.GetAlignmentEnhancedAbbreviation(abAlgET(i))
                civDoc.Settings.DrawingSettings.AbbreviationsSettings.AlignmentGeoPointEntityData.SetAlignmentEnhancedAbbreviation(abAlgET(i), strValue & "ABC")
            Next

            UpdateAbbreviationSettings = True
        Catch ex As Exception

        End Try
End Function
-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 177.43.194.106
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 07/15/2014 09:44:20 AM
Hi Rod, 

I tried the code and worked fine... maybe the problem is somewhere else. 

My suggestion is remove the 'ByRef' on the parameter, this is not needed in this case.

Regards,
Augusto Goncalves
-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Intelligent landing page for AIMS/MapGuide Ajax viewer
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: intelligent-landing-page-for-aimsmapguide-ajax-viewer-1
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: Daniel Du
CATEGORY: MapGuide Enterprise 2011
CATEGORY: Web

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/09/intelligent-landing-page-for-aimsmapguide-ajax-viewer-1.html 
DATE: 09/27/2012 08:45:25 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>You may come across the <a href="http://trac.osgeo.org/mapguide/wiki/CodeSamples/PHP/InitialMapView">InitialMapView</a> sample page in php, It expects the values to be passed to the script as query string parameters, and zoom to specified view port when loading the map. Here is an intelligent landing page MapGuide Viewer in .NET, and with more extended functionalities. </p>  <p>&#0160;</p>  <h4>What is the function of this sample application?</h4>  <p>1. Zoom to specified view port by initial x, y and scale, the URL is expected as below: <a href="http://serverName/MgViewerExtention/Default.aspx?X=-87.723233&amp;Y=43.754561&amp;scale=5000">http://serverName/MgViewerExtention/Default.aspx?X=-87.723233&amp;Y=43.754561&amp;scale=5000</a>     <br />It works by taking a copy of the <em><a>WebLayout</a></em> stored in the <em>Library repository</em> and changing the &lt;CenterX/&gt;, &lt;CenterY/&gt; and &lt;Scale/&gt; elements. The updated XML is written into the <em>Session</em> and is used as the target when the page is ultimately loaded.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017c322fe1d9970b-pi"><img alt="image" border="0" height="357" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017d3c5e143c970c-pi" style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" width="470" /></a></p>  <p>&#0160;</p>  <p>2. Query, zoom to and highlight by filter string. It accepts layer name, keyFieldID and id value, for following URL, map viewer zooms to the objects corresponding to “Autogenerated_SDF_ID in (1812,1813)” in the layer Parcels, highlighted if “highlight=1”.</p>  <p><a href="http://localhost/MgViewerExtention/Default.aspx?Layer=Parcels&amp;KeyField=Autogenerated_SDF_ID&amp;ListId=1812,1813&amp;highlight=1" title="http://localhost/MgViewerExtention/Default.aspx?Layer=Parcels&amp;KeyField=Autogenerated_SDF_ID&amp;ListId=1812,1813&amp;highlight=1">http://localhost/MgViewerExtention/Default.aspx?Layer=Parcels&amp;KeyField=Autogenerated_SDF_ID&amp;ListId=1812,1813&amp;highlight=1</a></p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017d3c5e144d970c-pi"><img alt="image" border="0" height="361" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017ee3d37a56970d-pi" style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" width="475" /></a></p>  <p>&#0160;</p>  <p>3. Filter features shown on map. You may have thousands even millions of features in a data source, but sometime you do not need to show all of them on map. With a filter string in URL, you can filter the features in MapGuide viewer when the viewer shows up. With following URL, I only show the parcels which Autogenerated_SDF_ID great than 1000:</p>  <p><a href="http://localhost/MgViewerExtention/Default.aspx?Layer=Parcels&amp;layerfilter=Autogenerated_SDF_ID">http://localhost/MgViewerExtention/Default.aspx?Layer=Parcels&amp;layerfilter=Autogenerated_SDF_ID</a> &gt; 10000</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017c322fe20c970b-pi"><img alt="image" border="0" height="404" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017ee3d37a79970d-pi" style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" width="459" /></a></p>  <p>&#0160;</p>  <p>The sample project can be downloaded<a href="http://adndevblog.typepad.com/files/mgviewerextention.zip" target="_self"> here</a>, it is based on AIMS 2013, but it could be easy to apply it to other version of AIMS/MapGuide. If you are interested in how it is implemented in detail, please download and read the code. Hope it helps.</p>  <p><a href="http://adndevblog.typepad.com/files/mgviewerextention.zip">Download MgViewerExtention</a></p>  <p>&#0160;</p>  <p><font color="#ff0000">[Updated: October, 26, 2012]</font></p>  <h4>How to install this sample application?</h4>  <p>I am often asked how to install/use this sample application, here is the detailed steps:</p>  <p>1. unzip the sample application to a folder of your web server where Map Server Extension is installed. Let’s say: C:\Work\CodeSamples\MgViewerExtention</p>  <p>2. Copy all dlls from “C:\Program Files\Autodesk\Autodesk Infrastructure Web Server Extension 2013\www\mapviewernet\bin” to “C:\Work\CodeSamples\MgViewerExtention\MgViewerExtention\bin”</p>  <p>3. Copy “WebConfig.ini” from “C:\Program Files\Autodesk\Autodesk Infrastructure Web Server Extension 2013\www” to “C:\Work\CodeSamples\MgViewerExtention\MgViewerExtention”</p>  <p>4. Since I am using web application as visual studio project, you need to rebuild the project. Open the “MgViewerExtention.sln” file in Visual Studio 2010, add references to OSGeo.MapGuide.* from MgViewerExtention\bin folder and set “CopyLocal” to FALSE. Then Build and fix any outstanding problems. </p>  <p>5. Open Internet Information Services(IIS) Manager by typing “inetmgr” in Start –&gt; Run</p>  <p>6. Add a application in IIS. Right click “Default Web Site” and select “Add Application”, input alias as “MgViewerExtension”, please note that the URL to access this web application will be http://localhost/&lt;yourAliasName&gt;, for me it is <a href="http://localhost/MgViewer/Extension">http://localhost/MgViewer/Extension</a>.&#0160; It is recommend to select &quot;MapServer2013App” as application pool. You will notice that it is using .net Framework 4.0 for AIMS2013.&#0160; The physical path refers to the folder which contains the ASPX web page, for me, it is C:\Work\CodeSamples\MgViewerExtention\MgViewerExtention.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017d3cfea3b8970c-pi"><img alt="image" border="0" height="350" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017d3cfea3db970c-pi" style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" width="439" /></a></p>  <p>7. Give it a run and test, refer to the top of this post for test URLs.</p>  <h4>&#0160;</h4>  <h4>How to Debug and Extend this further? </h4>  <p>1. Open the “MgViewerExtention.sln” solution is Visual Studio 2010, set an break points at somewhere. </p>  <p>2. Launch the browser to the MgViewerExtension.</p>  <p>3. Attach to process from Debug menu, attach to “w3wp”, please note the username should be “MapServer2013App” as it may have more than one “w3wp” process. </p>  <p>4. Refresh the webpage, your break point will be hit.</p>  <p>Please refer to this video at <a href="http://autodesk.com/developmapguide">MapServer Developer Center</a>, it is for AIMS 2012 x64, but it still applies to AIMS 2013 as well.</p>  <p><b>Video : Autodesk® Infrastructure Map Server 2012 API Webcast      <br /></b>Recorded version of the Autodesk® Infrastructure Map Server 2012 API webcast     <br /><a href="http://download.autodesk.com/media/adn/AIMS2012_Webcast_English/AIMS2012_Webcast_English.html">View Online</a> | <a href="http://download.autodesk.com/media/adn/AIMS2012_Webcast_English.zip">Download</a></p>  <p>&#0160;</p>  <p>It should be easy to use it for AIMS 2012 as well, Here are some critical point to be noticed: </p>  <p>1. Using the correct Dlls/References of AIMS2012</p>  <p>2. Change Target Framework to .NET Framework 3.5 in Visual Studio.</p>    <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017d3d1b6ccb970c-pi"><img alt="image" border="0" height="268" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017d3d1b6ce6970c-pi" style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" width="450" /></a></p>  <p>3. Change the url of viewer path: </p>  <pre>&#0160;&#0160;&#0160;&#0160; string viewerPathSchema = @&quot;/mapserver<strong>2012</strong>/mapviewerajax/<br />       ajaxviewer.aspx?Weblayout={1}&amp;SESSION={0}&quot;;</pre>

<p>4.&#0160; Rebuild and fix any outstanding problems.</p>

<p>5.&#0160; Select an application pool with .NET Framework 2.0(ASP.NET 2.0) when creating Applications in IIS:</p>

<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017d3d1b6d0b970c-pi"><img alt="image" border="0" height="334" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017c32ecea06970b-pi" style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" width="473" /></a></p>

<p>&#0160;</p>

<p>Hope this helps.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Coordinate Transformation using Map LISP API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: coordinate-transformation-using-map-lisp-api
CATEGORY: AutoCAD Map 3D 2011
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: AutoLISP
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/09/coordinate-transformation-using-map-lisp-api.html 
DATE: 09/25/2012 11:40:21 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>How to use
Map LISP function <strong>ade_projptforward</strong> to achieve coordinate transformation?</p>
<pre>&#0160;</pre>
<p>Here is a
LISP code snippet which demonstrates the same :</p>
<p><span style="line-height: 120%; font-family: &#39;courier new&#39;, courier; font-size: 8pt;">
</span></p>
<p><span style="line-height: 120%; font-family: &#39;courier new&#39;, courier; font-size: 8pt;"><br />
<span style="background-color: #e6e6e6; color: #800080;">;<span style="background-color: #e6e6e6; color: #800080;">;Coordinate&#0160;transform&#0160;with&#0160;LISP.<br /></span></span>
<br />
<span style="color: #ff0000;">(</span><span style="color: #0000ff;">defun</span>&#0160;c:test&#0160;<span style="color: #ff0000;">(</span><span style="color: #0000ff;">/</span>&#0160;result&#0160;pt<span style="color: #ff0000;">)</span><br />
<span style="color: #ff0000;">(</span>ade_projsetsrc&#0160;<span style="color: #ff00ff;">&quot;LL&quot;</span><span style="color: #ff0000;">)</span><br />
<span style="color: #ff0000;">(</span>ade_projsetdest&#0160;<span style="color: #ff00ff;">&quot;ITALY-W-ROME&quot;</span><span style="color: #ff0000;">)</span><br />
<span style="color: #ff0000;">(</span><span style="color: #0000ff;">setq</span>&#0160;result<span style="color: #ff0000;">(</span>ade_projptforward&#0160;&#39;<span style="color: #ff0000;">(</span>10.0&#0160;20.0&#0160;0.0<span style="color: #ff0000;">)</span><span style="color: #ff0000;">)</span><span style="color: #ff0000;">)</span><br />
<span style="color: #ff0000;">(</span><span style="color: #0000ff;">if</span><span style="color: #ff0000;">(</span>null&#0160;result<span style="color: #ff0000;">)</span><br />
<span style="color: #ff0000;">(</span>prompt&#0160;<span style="color: #ff00ff;">&quot;\nError&#0160;in Transformation &quot;</span><span style="color: #ff0000;">)</span><br />
<span style="color: #ff0000;">)</span><br />
<span style="color: #ff0000;">(</span><span style="color: #0000ff;">princ</span>&#0160;result<span style="color: #ff0000;">)</span><br />
<span style="color: #ff0000;">)</span><span style="background-color: #e6e6e6; color: #800080;">;</span></span></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: How to set Pipe Network Part's Data Fields (PartDataField)?
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: how-to-set-pipe-network-parts-data-fields-partdatafield
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2012
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/09/how-to-set-pipe-network-parts-data-fields-partdatafield.html 
DATE: 09/24/2012 02:56:11 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p><em>I am trying
to use Civil 3D .NET API to set the Pipe Object&#39;s PartDataField e.g. Pipe&#39;s
Manning Coefficient. Could you help me with a code snippet to do this?</em></p>
<p>&#0160;</p>
<p>Civil 3D .NET
API allows us to set / edit the <strong>PartDataField</strong> value. First you need to open the
Part (Pipe or Structure) for write, get a reference to the Part object&#39;s
PartData property (type <strong>PartDataRecord</strong>), modify the <strong>PartDatafield</strong> value, and
then re-set the Part&#39;s PartData. </p>
<p>&#0160;</p>
<p>Here is a C#
code snippet which demonstrates updating Pipe&#39;s Part Data values (Manning
Coefficient):</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">Transaction</span><span style="line-height: 140%;"> ts = </span><span style="color: #2b91af; line-height: 140%;">Application</span><span style="line-height: 140%;">.DocumentManager.MdiActiveDocument.Database.TransactionManager.StartTransaction())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">Pipe</span><span style="line-height: 140%;"> PipeEle = ts.GetObject(pipeID, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForWrite) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Pipe</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">PartDataRecord</span><span style="line-height: 140%;"> record = PipeEle.PartData;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">PartDataField</span><span style="line-height: 140%;"> PartDataFld = record.GetDataFieldBy(</span><span style="color: #2b91af; line-height: 140%;">PartContextType</span><span style="line-height: 140%;">.FlowAnalysisManning);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nManning Coefficient Value Before Change : &quot;</span><span style="line-height: 140%;"> + PartDataFld.Value.ToString());</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// Change the inner data of the copy:</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; PartDataFld.Value = 0.014;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// Re-set the PartData property.&#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">//The data will not be updated without this </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; PipeEle.PartData = record;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nManning Coefficient Value After Change : &quot;</span><span style="line-height: 140%;"> + PartDataFld.Value.ToString());</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; ts.Commit();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017ee3bce214970d-pi" style="display: inline;"><img alt="Pipe_PartDataUpdate" class="asset  asset-image at-xid-6a0167607c2431970b017ee3bce214970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017ee3bce214970d-500wi" title="Pipe_PartDataUpdate" /></a><br /><br /></span></p>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: How to apply Coordinate system Transformation using API ?
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: how-to-apply-coordinate-system-transformation-using-api-
CATEGORY: .NET
CATEGORY: AutoCAD Map 3D 2011
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/09/how-to-apply-coordinate-system-transformation-using-api-.html 
DATE: 09/22/2012 04:30:35 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>Coordinate transformation is converting a coordinate value in one coordinate system into its equivalent in another coordinate system.</p>
<p>&#0160;</p>
<p>Here is a code snippet which demonstrates how to apply Coordinate system Transformation :</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">string</span><span style="line-height: 140%;"> mapSRS = </span><span style="color: #2b91af; line-height: 140%;">AcMapMap</span><span style="line-height: 140%;">.GetCurrentMap().GetMapSRS();</span></p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// create MgCoordinateSystemFactory</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">MgCoordinateSystemFactory</span><span style="line-height: 140%;"> coordSysFactory = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">MgCoordinateSystemFactory</span><span style="line-height: 140%;">();</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">MgCoordinateSystem</span><span style="line-height: 140%;"> coordSys = coordSysFactory.Create(mapSRS);</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">MgCoordinateSystem</span><span style="line-height: 140%;"> wgs84Sys = coordSysFactory.Create(</span><span style="color: #a31515; line-height: 140%;">&quot;LL84&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">MgCoordinateSystemTransform</span><span style="line-height: 140%;"> transform = </span><span style="color: blue; line-height: 140%;">null</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">transform = coordSysFactory.GetTransform(wgs84Sys, coordSys);</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">MgCoordinate</span><span style="line-height: 140%;"> coord = </span><span style="color: blue; line-height: 140%;">null</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (transform != </span><span style="color: blue; line-height: 140%;">null</span><span style="line-height: 140%;"> &amp;&amp; !</span><span style="color: blue; line-height: 140%;">double</span><span style="line-height: 140%;">.IsNaN(pnt.Z))</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; coord = transform.Transform(pnt.Z, pnt.Y, pnt.Z);</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">else</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; coord = transform.Transform(pnt.X, pnt.Y);&#0160; &#0160; </span></p>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Peter Kolbe
EMAIL: 
IP: 84.58.13.68
URL: http://profile.typepad.com/peterkolbe
DATE: 09/28/2012 09:19:41 AM
Dear Partha,
using your sample "How to extract all of the coordinate system..." I can enumerate them and will get "XY-M" and "LL84".
When I call the coordSysFactory.GetTransform() method I get an 
org.osgeo.mapguide.MgCoordinateSystemInitializationFailedException.
Do you know the reason? Is there something missing?
I'm using IMS2012. 
Below my coding. Thank you for your response!
Regards,
Peter

MgCoordinateSystemFactory coordSysFactory = new MgCoordinateSystemFactory();
MgCoordinateSystemCatalog csCatalog = coordSysFactory.GetCatalog();
MgCoordinateSystemDictionary csDict = csCatalog.GetCoordinateSystemDictionary();
MgCoordinateSystem coordSys = csDict.GetCoordinateSystem("XY-M");
MgCoordinateSystem wgs84Sys = csDict.GetCoordinateSystem("LL84");
MgCoordinateSystemTransform transform = coordSysFactory.GetTransform(wgs84Sys, coordSys);
-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: How to extract all of the coordinate system names from the coordinate system dictionary and check their types?
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: how-to-extract-all-of-the-coordinate-system-names-from-the-coordinate-system-dictionary-and-check-th
CATEGORY: .NET
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: AutoCAD Map 3D 2011
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: MapGuide Enterprise 2011
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/09/how-to-extract-all-of-the-coordinate-system-names-from-the-coordinate-system-dictionary-and-check-th.html 
DATE: 09/20/2012 12:59:53 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>The
<strong>OSGeo.MapGuide</strong> namespace contains a set of classes which provide access to the
CS-Map coordinate system functionality in both the AutoCAD Map 3D and AIMS
environments.</p>
<p> <strong>MgCoordinateSystemFactory</strong> is used to get the coordinate system
categories and the coordinate system catalog. <strong>MgCoordinateSystemCatalog</strong> is used
to get the various dictionaries. <strong>MgCoordinateSystemDictionary
</strong>contains definitions for earth-based and Euclidean coordinate systems.</p>
<p>&#0160;</p>
<p>The following code extracts all of the coordinate system names from the coordinate system dictionary, uses those names to get all of the coordinate system definitions from the dictionary and determines the type (projected, geographic, or
arbitrary) of the coordinate system from its definition, and stores the name of
the coordinate system in a list according to its type.&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">//MgCoordinateSystemFactory coordSysFactory = new MgCoordinateSystemFactory();</span></p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">//MgCoordinateSystemCatalog csCatalog = coordSysFactory.GetCatalog();</span></p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">//MgCoordinateSystemDictionary csDict = csCatalog.GetCoordinateSystemDictionary();</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">List</span><span style="line-height: 140%;">&lt;</span><span style="color: blue; line-height: 140%;">string</span><span style="line-height: 140%;">&gt; arbitraryCs = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">List</span><span style="line-height: 140%;">&lt;</span><span style="color: blue; line-height: 140%;">string</span><span style="line-height: 140%;">&gt;();</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">List</span><span style="line-height: 140%;">&lt;</span><span style="color: blue; line-height: 140%;">string</span><span style="line-height: 140%;">&gt; geographicCs = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">List</span><span style="line-height: 140%;">&lt;</span><span style="color: blue; line-height: 140%;">string</span><span style="line-height: 140%;">&gt;();</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">List</span><span style="line-height: 140%;">&lt;</span><span style="color: blue; line-height: 140%;">string</span><span style="line-height: 140%;">&gt; projectedCs = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">List</span><span style="line-height: 140%;">&lt;</span><span style="color: blue; line-height: 140%;">string</span><span style="line-height: 140%;">&gt;();</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">MgCoordinateSystemEnum</span><span style="line-height: 140%;"> csDictEnum = csDict.GetEnum();</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// the following line gets all of the names in the dictionary</span></p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// uses those names to get the coordinate </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">int</span><span style="line-height: 140%;"> csCount = csDict.GetSize();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nCoordinate System Count : &quot;</span><span style="line-height: 140%;"> + csCount.ToString());</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\n-------------------------------------------------&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">MgStringCollection</span><span style="line-height: 140%;"> csNames = csDictEnum.NextName(csCount);</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">string</span><span style="line-height: 140%;"> csName = </span><span style="color: blue; line-height: 140%;">null</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">MgCoordinateSystem</span><span style="line-height: 140%;"> cs = </span><span style="color: blue; line-height: 140%;">null</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">int</span><span style="line-height: 140%;"> csType = 0;</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">for</span><span style="line-height: 140%;"> (</span><span style="color: blue; line-height: 140%;">int</span><span style="line-height: 140%;"> i = 0; i &lt; csCount; i++)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;csName = csNames.GetItem(i);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;cs = csDict.GetCoordinateSystem(csName);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;csType = cs.GetType();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;</span><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (csType == </span><span style="color: #2b91af; line-height: 140%;">MgCoordinateSystemType</span><span style="line-height: 140%;">.Arbitrary)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; arbitraryCs.Add(csName);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;}</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;</span><span style="color: blue; line-height: 140%;">else</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (csType == </span><span style="color: #2b91af; line-height: 140%;">MgCoordinateSystemType</span><span style="line-height: 140%;">.Geographic)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; geographicCs.Add(csName);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;}</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;</span><span style="color: blue; line-height: 140%;">else</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (csType == </span><span style="color: #2b91af; line-height: 140%;">MgCoordinateSystemType</span><span style="line-height: 140%;">.Projected)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; projectedCs.Add(csName);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;}&#0160; &#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nCoordinate System Name : &quot;</span><span style="line-height: 140%;"> + csName.ToString());</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017c32002232970b-pi" style="display: inline;"><img alt="CS_Name" class="asset  asset-image at-xid-6a0167607c2431970b017c32002232970b" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017c32002232970b-500wi" title="CS_Name" /></a><br /><br /></p>
<p>Hope this is useful to you !</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: test
STATUS: Draft
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: test

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/09/test.html 
DATE: 09/11/2012 09:38:10 PM
-----
BODY:
<p>this is a test</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Autodesk.Civil.DatabaseServices.PointGroupQueryParserException: Invalid value for property !
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: autodeskcivildatabaseservicespointgroupqueryparserexception-invalid-value-for-property-
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/09/autodeskcivildatabaseservicespointgroupqueryparserexception-invalid-value-for-property-.html 
DATE: 09/11/2012 02:00:54 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>While
creating a custom Point Group query using <strong>CustomPointGroupQuery</strong> class, when you
call the SetQuery() function with your custom query string sometimes you may
see the following exception message : <em><strong>&#0160;Invalid value
for property !</strong></em></p>
<p>Most likely
cause of this exception is improper query string formation. I will give you an example
here.</p>
<p>&#0160;</p>
<p>If we build a
<strong>StandardPointGroupQuery</strong> object, we can set a condition like the following and
all works fine :</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">StandardPointGroupQuery</span><span style="line-height: 140%;"> standardPointGrpQry = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">StandardPointGroupQuery</span><span style="line-height: 140%;">();&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">standardPointGrpQry.IncludeNumbers = </span><span style="color: #a31515; line-height: 140%;">&quot;550-560, 565-572&quot;</span><span style="line-height: 140%;">;</span></p>
</div>
<p>&#0160;</p>
<p>However, when
we build a <strong>CustomPointGroupQuery</strong>, and we try build a query string like the
following :&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">CustomPointGroupQuery</span><span style="line-height: 140%;"> customPointGrpQry = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">CustomPointGroupQuery</span><span style="line-height: 140%;">();</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">string</span><span style="line-height: 140%;"> queryString = </span><span style="color: #a31515; line-height: 140%;">&quot;(RawDescription=&#39;TO*&#39;) AND (<span style="background-color: #ffff00;">PointNumber=&#39;600-1000&#39;</span>)&quot;</span><span style="line-height: 140%;">; </span><span style="color: green; line-height: 140%;">// Doesn&#39;t work</span></p>
</div>
<p>&#0160;</p>
<p>You would see
the excpetion message - &quot;<em><strong>Invalid value for property</strong></em> !&quot; when you try to
execute SetQuery(customPointGrpQry).</p>
<p>To include a
range of Points, you need to build query string like the following :&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">CustomPointGroupQuery</span><span style="line-height: 140%;"> customPointGrpQry = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">CustomPointGroupQuery</span><span style="line-height: 140%;">();</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">string</span><span style="line-height: 140%;"> queryString = </span><span style="color: #a31515; line-height: 140%;">&quot;(RawDescription=&#39;TO*&#39;) AND (<span style="background-color: #80ff00;">PointNumber&gt;=600 AND PointNumber&lt;=1000</span>) &quot;</span><span style="line-height: 140%;">; </span><span style="color: green; line-height: 140%;">// this works</span></p>
</div>
<p>&#0160;</p>
<p>Hope this is
useful to you !</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: How do I turn off the "Map Base" Layer using API ?
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: how-do-i-turn-off-the-map-base-layer-using-api-
CATEGORY: .NET
CATEGORY: AutoCAD Map 3D 2011
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/09/how-do-i-turn-off-the-map-base-layer-using-api-.html 
DATE: 09/10/2012 01:38:00 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>I want to switch
off the &quot;Map Base&quot; Layer using Map 3D API.</p>
<p>&#0160;</p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017d3bf1d1ec970c-pi" style="display: inline;"><img alt="Map_Base" class="asset  asset-image at-xid-6a0167607c2431970b017d3bf1d1ec970c" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017d3bf1d1ec970c-500wi" title="Map_Base" /></a></p>
<p>&#0160;</p>
<p>Here is the C# code snippet to switch off the &quot;Map Base&quot; Layer using Map 3D
managed API :</p>
<p>&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">Transaction</span><span style="line-height: 140%;"> trans = transManager.StartTransaction())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> managerId = </span><span style="color: #2b91af; line-height: 140%;">DisplayManager</span><span style="line-height: 140%;">.Create(proj).MapManagerId(proj, </span><span style="color: blue; line-height: 140%;">true</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">MapManager</span><span style="line-height: 140%;"> manager = trans.GetObject(managerId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForRead) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">MapManager</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (manager != </span><span style="color: blue; line-height: 140%;">null</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; currentmapId = manager.CurrentMapId;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">Map</span><span style="line-height: 140%;"> currentMap = trans.GetObject(currentmapId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForWrite) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Map</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">IEnumerator</span><span style="line-height: 140%;"> iterator = currentMap.NewIterator(</span><span style="color: blue; line-height: 140%;">true</span><span style="line-height: 140%;">, </span><span style="color: blue; line-height: 140%;">true</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">Type</span><span style="line-height: 140%;"> groupType = </span><span style="color: blue; line-height: 140%;">typeof</span><span style="line-height: 140%;">(Autodesk.Gis.Map.DisplayManagement.</span><span style="color: #2b91af; line-height: 140%;">Group</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">while</span><span style="line-height: 140%;"> (iterator.MoveNext())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> objId = (</span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;">)iterator.Current;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">Object</span><span style="line-height: 140%;"> obj = trans.GetObject(objId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForWrite);&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (obj.GetType().ToString() == </span><span style="color: #a31515; line-height: 140%;">&quot;Autodesk.Gis.Map.DisplayManagement.BaseElement&quot;</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; Autodesk.Gis.Map.DisplayManagement.</span><span style="color: #2b91af; line-height: 140%;">BaseElement</span><span style="line-height: 140%;"> baseElement = obj </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> Autodesk.Gis.Map.DisplayManagement.</span><span style="color: #2b91af; line-height: 140%;">BaseElement</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; baseElement.SetVisible(0, </span><span style="color: blue; line-height: 140%;">false</span><span style="line-height: 140%;">);&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; trans.Commit();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: heianqishiding
EMAIL: 
IP: 219.140.164.90
URL: http://profile.typepad.com/6p017ee9c73ceb970d
DATE: 03/27/2013 04:46:13 AM
Hi, Partha,
I'd like to get the selected FDO layer or layer group from task pane using AutoCAD .net, how can I do that?
-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 203.202.234.243
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 03/27/2013 04:50:41 AM
Hi,

Did you check this post - 

<a href="http://adndevblog.typepad.com/infrastructure/2012/05/accessing-layer-names-from-the-selected-fdo-features.html">http://adndevblog.typepad.com/infrastructure/2012/05/accessing-layer-names-from-the-selected-fdo-features.html</a>

Does it help ?

Thanks,
Partha
ADN
-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Change Alignment Curve Label style to General Curve Label Styles using Civil 3D .NET API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: change-alignment-curve-label-style-to-general-curve-label-styles-using-civil-3d-net-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/09/change-alignment-curve-label-style-to-general-curve-label-styles-using-civil-3d-net-api.html 
DATE: 09/05/2012 11:22:21 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>In Civil 3D UI when we use the Change Label Style command (<strong>LabelStyleEdit</strong>) on Alignment
Curve Label, we get the option of selecting a Label Style from Alignment -&gt;
Label Styles -&gt; Curve -&gt; Label Styles collection&#0160; as well as General Curve Label Styles (Styles
listed under General -&gt; Multipurpose Styles&#0160;
-&gt; Curve). And we can change the label style to one from the General
Curve Label Styles.</p>
<p>&#0160;</p>
<p>Screenshot
below explains the situation described above:</p>
<p>&#0160;</p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017c31ad9b35970b-pi" style="display: inline;"><img alt="Alignment_Curve_Label" class="asset  asset-image at-xid-6a0167607c2431970b017c31ad9b35970b" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017c31ad9b35970b-500wi" title="Alignment_Curve_Label" /></a></p>
<p>&#0160;</p>
<p>Here is a C#
code snippet which demonstrates how to achieve the same using Civil 3D .NET
API:</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">try</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">AlignmentCurveLabel</span><span style="line-height: 140%;"> alignCurveLbl = (</span><span style="color: #2b91af; line-height: 140%;">AlignmentCurveLabel</span><span style="line-height: 140%;">)tr.GetObject(pres.ObjectId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForWrite);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nAlignment Curve Label Style Name (before Change) : &quot;</span><span style="line-height: 140%;"> + alignCurveLbl.StyleName.ToString());&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">CivilDocument</span><span style="line-height: 140%;"> curDoc = </span><span style="color: #2b91af; line-height: 140%;">CivilApplication</span><span style="line-height: 140%;">.ActiveDocument;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">LabelStyleCollection</span><span style="line-height: 140%;"> lStyles = curDoc.Styles.LabelStyles.GeneralCurveLabelStyles;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// The following Style Name is specific to Tutorial DWG file - &quot;Labels-6a.dwg&quot;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">string</span><span style="line-height: 140%;"> stylesFound = </span><span style="color: #a31515; line-height: 140%;">&quot;Distance-Radius and Delta&quot;</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">foreach</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> stId </span><span style="color: blue; line-height: 140%;">in</span><span style="line-height: 140%;"> lStyles)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">LabelStyle</span><span style="line-height: 140%;"> generalCurveLblStyl = tr.GetObject(stId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForRead) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">LabelStyle</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (generalCurveLblStyl.Name.ToString() == stylesFound)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; alignCurveLbl.StyleId = generalCurveLblStyl.Id;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">break</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; }&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nAlignment Curve Label Style Name (after Change) : &quot;</span><span style="line-height: 140%;"> + alignCurveLbl.StyleName.ToString());&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
<p>&#0160;</p>
<p>Hope this is
useful to you!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Get or Set DisplayStyles for MassHaulViewStyle using .NET API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 0
ALLOW PINGS: 0
BASENAME: get-or-set-displaystyles-for-masshaulviewstyle-using-net-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/09/get-or-set-displaystyles-for-masshaulviewstyle-using-net-api.html 
DATE: 09/04/2012 11:59:12 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>In Civil 3D 2012 and earlier releases there were some issues in accessing some of the display styles (listed below) for a MassHaulViewStyle object:</p>
<p>&nbsp;</p>
<p>MassHaulViewDisplayStyleType.MiddleAxis</p>
<p>MassHaulViewDisplayStyleType.MiddleAxisTitle</p>
<p>MassHaulViewDisplayStyleType.MiddleAxisAnnotationMajor</p>
<p>MassHaulViewDisplayStyleType.MiddleAxisAnnotationMinor</p>
<p>MassHaulViewDisplayStyleType.MiddleAxisTicksMajor</p>
<p>MassHaulViewDisplayStyleType.MiddleAxisTicksMinor</p>
<p>MassHaulViewDisplayStyleType.GridAtSampleLineStations</p>
<p>&nbsp;</p>
<p>In 2013
release of Civil 3D .NET API, this issue is fixed and you can now access and
set these displayStyles for a <strong>MassHaulViewStyle</strong> using .NET API.</p>
<p>&nbsp;</p>
<p>Here is a C# code snippet :</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">Transaction</span><span style="line-height: 140%;"> tr = db.TransactionManager.StartTransaction())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: #2b91af; line-height: 140%;">MassHaulViewStyle</span><span style="line-height: 140%;"> style = tr.GetObject(oId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForWrite) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">MassHaulViewStyle</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: #2b91af; line-height: 140%;">DisplayStyle</span><span style="line-height: 140%;"> displayStyleMiddleAxis = </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; style.GetDisplayStylePlan(Autodesk.Civil.</span><span style="color: #2b91af; line-height: 140%;">MassHaulViewDisplayStyleType</span><span style="line-height: 140%;">.MiddleAxis);</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: #2b91af; line-height: 140%;">DisplayStyle</span><span style="line-height: 140%;"> displayStyleMiddleAxisTitle = </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; style.GetDisplayStylePlan(Autodesk.Civil.</span><span style="color: #2b91af; line-height: 140%;">MassHaulViewDisplayStyleType</span><span style="line-height: 140%;">.MiddleAxisTitle);</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: #2b91af; line-height: 140%;">DisplayStyle</span><span style="line-height: 140%;"> displayStyleMiddleAxisAnnotationMajor = </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; style.GetDisplayStylePlan(Autodesk.Civil.</span><span style="color: #2b91af; line-height: 140%;">MassHaulViewDisplayStyleType</span><span style="line-height: 140%;">.MiddleAxisAnnotationMajor);</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: #2b91af; line-height: 140%;">DisplayStyle</span><span style="line-height: 140%;"> displayStyleMiddleAxisAnnotationMinor = </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; style.GetDisplayStylePlan(Autodesk.Civil.</span><span style="color: #2b91af; line-height: 140%;">MassHaulViewDisplayStyleType</span><span style="line-height: 140%;">.MiddleAxisAnnotationMinor);</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: #2b91af; line-height: 140%;">DisplayStyle</span><span style="line-height: 140%;"> displayStyleMiddleAxisTicksMajor = </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; style.GetDisplayStylePlan(Autodesk.Civil.</span><span style="color: #2b91af; line-height: 140%;">MassHaulViewDisplayStyleType</span><span style="line-height: 140%;">.MiddleAxisTicksMajor);</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: green; line-height: 140%;">// Works fine in Civil 3D 2013</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: blue; line-height: 140%;">try</span><span style="line-height: 140%;"> </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; { </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">"\n"</span><span style="line-height: 140%;"> + displayStyleMiddleAxis.Layer);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; displayStyleMiddleAxis.Layer = </span><span style="color: #a31515; line-height: 140%;">"0"</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: blue; line-height: 140%;">catch</span><span style="line-height: 140%;"> (System.</span><span style="color: #2b91af; line-height: 140%;">Exception</span><span style="line-height: 140%;"> ex) </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; { </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">"\n"</span><span style="line-height: 140%;"> + ex.Message); </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; }</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: blue; line-height: 140%;">try</span><span style="line-height: 140%;"> </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; { </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">"\n"</span><span style="line-height: 140%;"> + displayStyleMiddleAxisTitle.Layer);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; displayStyleMiddleAxisTitle.Layer = </span><span style="color: #a31515; line-height: 140%;">"0"</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: blue; line-height: 140%;">catch</span><span style="line-height: 140%;"> (System.</span><span style="color: #2b91af; line-height: 140%;">Exception</span><span style="line-height: 140%;"> ex) </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; { </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">"\n"</span><span style="line-height: 140%;"> + ex.Message); </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; }</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: green; line-height: 140%;">// Similar way we can access or set other DisplayStyle properties of MassHaulViewStyle&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: green; line-height: 140%;">//...</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; tr.Commit();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><br /></span></p>
</div>
<p>
<a class="asset-img-link" style="display: inline;" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017d3bd6f4de970c-pi"><img class="asset  asset-image at-xid-6a0167607c2431970b017d3bd6f4de970c" title="Mass_Haul_View_Style" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017d3bd6f4de970c-500wi" alt="Mass_Haul_View_Style" /></a><br /><br /></p>
<p>&nbsp;</p>
<p>Hope this is
useful to you!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Mikako Harada
AUTHOR EMAIL: mikako.harada@autodesk.com
TITLE: Adding Notes to an entity programmatically 
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: adding-notes-to-an-entity-programmatically-
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2011
CATEGORY: AutoCAD Civil 3D 2012
CATEGORY: AutoCAD Civil 3D 2013

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/08/adding-notes-to-an-entity-programmatically-.html 
DATE: 08/31/2012 12:29:43 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/aec/mikako-harada.html" target="_self" title="Mikako Harada">Mikako Harada</a></p>
<p>Civil 3D and AutoCAD Architecture/MEP share the&#0160;common base module called AecBaseMgd.dll. Notes, which appear on the Extended Data tab of Property Palette,&#0160;is&#0160;exposed in this module. I just published one blog post about adding Notes to an entity on our AEC DevBlog. I&#39;m cross-referencing <a href="http://adndevblog.typepad.com/aec/2012/08/adding-notes-to-an-entity-programmatically.html" target="_self" title="TextNote">here</a>&#0160;in case C3D API&#0160;audience finds it useful someday. </p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Changing size and feature of new window in Fusion viewer &ldquo;invoke URL&rdquo;
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: changing-size-and-feature-of-new-window-in-fusion-viewer-invoke-url
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: Daniel Du
CATEGORY: MapGuide Enterprise 2011
CATEGORY: Web

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/08/changing-size-and-feature-of-new-window-in-fusion-viewer-invoke-url.html 
DATE: 08/30/2012 11:44:20 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>If you use “invoke URL” command of fusion viewer and select “New Window” as target to open a new browser window, you may find this window is fixed, not resizable, no memubar, no status bar, and no location bar. </p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017617882f99970c-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017617882fae970c-pi" width="457" height="332" /></a></p>  <p>If you want to change the features of this window, please keep reading. </p>  <p>Actually it is hard-coded in fusion viewer, you can edit the source code, please open C:\Program Files\Autodesk\Autodesk Infrastructure Web Server Extension 2013\www\fusion\widgets\InvokeURL.js in your favorite text editor, refer to around line 40: </p>  <div style="font-family: ; background: #eeefe6; color: ">   <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">…</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">Fusion.Widget.InvokeURL = OpenLayers.Class(Fusion.Widget, {</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; uiClass: Jx.Button,</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; <strong> sFeatures: </strong></font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515"><strong>'menubar=no,location=no,resizable=no,status=no'</strong></font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">,</font></span></font></p>    <p style="margin: 0px"><font color="#000000" face="Courier New"><span style="line-height: 11pt">…</span></font></p> </div>  <p>and also refer to line 124 for the usage of it:</p>  <div style="font-family: ; background: #eeefe6; color: ">   <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">… </font></font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">var</font></span><span style="line-height: 11pt"><font color="#000000"> pageElement = $(</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">this</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.sTarget);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">if</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> ( pageElement ) {</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; pageElement.src = url;</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt"> } </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">else</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> {</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; <strong> window.open(url, </strong></font></font></span><strong><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">this</font></span><span style="line-height: 11pt"><font color="#000000">.sTarget, </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">this</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.sFeatures);</font></span></strong></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; }</font></font></span></p> </div>  <p>It is a parameter passed to JavaScript function window.open, please refer to <a href="http://www.w3schools.com/jsref/met_win_open.asp">this link</a> for detailed information to set suitable value you need.</p>  <p>Finally, to apply your changes, you need to switch to debug mode by editing the script reference in template html page. As I said in <a href="http://adndevblog.typepad.com/infrastructure/2012/04/debugging-fusion-viewer-or-mobile-viewer-of-aims-in-firebug.html">previous post</a>, for Fusion Viewer, let’s say you are using the “slate” template, please open C:\Program Files\Autodesk\Autodesk Infrastructure Web Server Extension 2013\www\fusion\templates\mapguide\slate\index.html with your favorite text editor, I am using notepad++, change following code:</p>  <pre>&lt;script type=&quot;text/javascript&quot; <br />src=&quot;../../../lib/fusionSF-compressed.js&quot;&gt;&lt;/script&gt;</pre>

<p>to</p>

<pre>&lt;script type=&quot;text/javascript&quot; <br />src=&quot;../../../lib/fusion.js&quot;&gt;&lt;/script&gt;</pre>



<p>Of cause you can also re-compress all JavaScript files with your changes using tools like YUI compressor to improve performance, I will not cover how to use YUI compressor in this blog, please search yourself, I bet you can get many resources about that topic, and <a href="http://adndevblog.typepad.com/infrastructure/2012/06/creating-custom-control-for-mobile-viewer-of-aims.html">this post</a> may be helpful as well.</p>

<p>Hope this helps.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: zac spitzer
EMAIL: zac.spitzer@gmail.com
IP: 124.148.190.63
URL: 
DATE: 08/31/2012 07:50:45 PM
hmmm, it would be a good patch to allow these to be passed via the application definition?
-----
COMMENT:
AUTHOR: Daniel Du
EMAIL: 
IP: 125.98.160.4
URL: http://profile.typepad.com/daniel_du
DATE: 09/03/2012 10:56:35 PM
Yes, I agree with you Zac, I have logged a wishlist about this, please free feel to issue a ticket from Open Source community as well  :)
-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Counting the active session number and tune up concurrent performance of MapGuide/AIMS
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: counting-the-number-of-sessions-that-are-active-and-tune-up-concurrent-performance-of-mapguideaims
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: Daniel Du
CATEGORY: MapGuide Enterprise 2011

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/08/counting-the-number-of-sessions-that-are-active-and-tune-up-concurrent-performance-of-mapguideaims.html 
DATE: 08/29/2012 10:46:23 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>I was asked how to count the number of active sessions in AIMS, unfortunately there is no public API to do that. But I came across <a href="http://themapguyde.blogspot.com/2012/06/thoughts-on-mapguide-scalability.html">Jackie’s blog post</a> (Jackie is an active contributor of MapGuide Open Source), in which he exposed a method, it is pretty interesting, I would like to share with you:</p>  <p>&quot;You can actually count the number of sessions that are active by looking at the Repositories/Session folder of your MapGuide Server install directory. Each session takes 2 files (a .db file and a .dbxml file), so the math is not rocket science.”</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017c318c451e970b-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017c318c4539970b-pi" width="463" height="329" /></a></p>  <p>In this blog post, Jackie also demonstrate the performance capability of MapGuide and provide suggestions how to tune it up. If you have performance problem with MapGuide, especially when you have many concurrent user, <a href="http://themapguyde.blogspot.com/2012/06/thoughts-on-mapguide-scalability.html">this blog</a> will definitely help you. </p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Madhukar Moogala
AUTHOR EMAIL: fpdtypepadadmin@autodesk.com
TITLE: Introducing ADN Open
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: introducing-adn-open

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/08/introducing-adn-open.html 
DATE: 08/29/2012 03:36:36 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/autocad/stephen-preston.html">Stephen Preston</a></p>
<p>(Cross posted across all ADN DevBlogs)</p>
<p>Those of you who have been watching carefully will have noticed that the ADN DevTech team has been doing a few things differently recently:</p>
<ul>
<li>We’ve <a href="http://adndevblog.typepad.com/autocad/2012/02/welcome.html" target="_blank">launched these DevBlogs</a> , and have been <a href="http://adndevblog.typepad.com/autocad/2012/05/devnote-migration.html" target="_blank">steadily moving technical content</a> (a.k.a. DevNotes) from the members-only ADN website to here, along with posting new content. </li>
<li>We’ve been increasing our presence in the <a href="http://forums.autodesk.com" target="_blank">Autodesk discussion groups</a> that cover our product APIs. </li>
<li>We’ve revamped our <a href="http://www.autodesk.com/developer" target="_blank">Developer Centers</a> to update and (hopefully) more clearly document the resources available to developers who want to use Autodesk technology as part of their software solutions. That includes our recent ‘My First Plug-in’ tutorials for <a href="http://usa.autodesk.com/adsk/servlet/index?id=18162650&amp;siteID=123112" target="_blank">AutoCAD</a>, <a href="http://usa.autodesk.com/adsk/servlet/index?siteID=123112&amp;id=16777469" target="_blank">Revit</a> and <a href="http://usa.autodesk.com/adsk/servlet/index?siteID=123112&amp;id=17324828" target="_blank">Inventor</a>. </li>
</ul>
<p><em>This is all part of our master plan to hold the world to ransom for <strong>ONE MILLION DOLLARS</strong>! …</em></p>
<p><a href="http://en.wikipedia.org/wiki/Dr._Evil" target="_blank"><img alt="" height="207" src="http://upload.wikimedia.org/wikipedia/en/1/16/Drevil_million_dollars.jpg" style="display: block; float: none; margin-left: auto; margin-right: auto;" width="195" /></a></p>
<p><em>Oops – hang on – that was my other plan. Try again …</em></p>
<p>This is all part of our plan to make information on Autodesk technology more accessible to people who can’t afford the fee for full ADN membership, and/or who are evaluating the best technology to use to implement a new solution and want to be able to quickly find the best tools for the job via a simple web search. All of these changes have been our putting the pieces in place so that we can formally announce <a href="http://www.autodesk.com/adnopen" target="_blank"><strong>ADN Open</strong></a>. </p>
<p>So that’s the basics. You can quickly browse <a href="http://www.autodesk.com/adnopen"><strong>www.autodesk.com/adnopen</strong></a><strong> </strong>and stop reading here if you like. But if you want more information, read on (if you’re an <a href="http://www.autodesk.com/joinadn" target="_blank">ADN Standard or ADN Professional</a> member, you should have received similar information on this via the ADN DevNews newsletter) …</p>
<p>&#0160;</p>
<p><strong><span style="font-size: small;">What is Changing?</span></strong></p>
<p>Along with the two existing types of ADN membership – Standard and Professional – we now have <a href="http://www.autodesk.com/adnopen">ADN Open</a><strong>&#0160;</strong>.&#0160; ADN Open consists of software developer focused blogs, moderated discussion groups (forums), training materials, and more - that are available to everyone and anyone for free. The two most noteworthy changes are:</p>
<p>&#0160;</p>
<p><strong>We are migrating all non-confidential software development information previously available through the password protected ADN website to ADN Open DevBlogs.</strong></p>
<p>This means that a simple Google search – something most of you already do to look for solutions to your problems - will now include crawling the thousands of DevNotes that Autodesk DevTech engineers have published.&#0160; We believe this change will result in your getting better answers to your problems faster, using the same search technology you already use every day. </p>
<p><em>We expect to complete this migration task within the next few months, and we’re posting new information to the blogs at the same time.</em></p>
<p>&#0160;</p>
<p><strong>Participation in the Autodesk public API discussion groups (forums) will increase.</strong></p>
<p>We will be offering ADN Standard and Professional members the option to either ask their question in private (as they have always done), or to ask their questions on the forums. The DevTech team will be monitoring the forums to ensure that these questions are answered. While we’re there, we’ll also help out with other questions. We anticipate that our involvement, and the increased involvement from ADN members who previously asked questions in private, will further enhance these already thriving communities.</p>
<p>Check out the ADN Open web site – <a href="http://www.autodesk.com/adnopen"><strong>www.autodesk.com/adnopen</strong></a> - for a current list of Autodesk technology now being actively supported through public DevBlogs and API discussion groups.</p>
<p><em>If you’re an ADN Standard or Professional member, please read your ADN DevNews newsletter for more information on this.</em></p>
<p><em></em><strong></strong></p>
<p>&#0160;</p>
<p><strong><span style="font-size: small;">Why do we still offer Standard and Professional ADN membership?</span></strong></p>
<p>There are additional benefits to ADN Standard and Professional membership.&#0160; You’ll want to maintain your ADN Standard or Professional membership if you:</p>
<ul>
<li>Need access to Autodesk desktop products – easy download and perpetual license through the ADN extranet </li>
<li>Access to Autodesk beta software. </li>
<li>Want an Autodesk engineer to help you with a confidential issue/question. </li>
<li>Need API support for the few Autodesk technologies not supported through ADN Open – only the forums listed on <a href="http://www.autodesk.com/adnopen"><strong>www.autodesk.com/adnopen</strong></a> will be supported by the DevTech team. </li>
<li>Want your product, services and company information visible to hundreds of thousands of Autodesk customers on <a href="http://www.autodesk.com/partnerproducts"><strong>www.autodesk.com/partnerproducts</strong></a>. </li>
</ul>
<p>Please visit <a href="http://www.autodesk.com/joinadn"><strong>www.autodesk.com/joinadn</strong></a> if you’re interested in upgrading from ADN Open to ADN Standard or Professional to take advantage of these additional benefits.</p>
<p>&#0160;</p>
<p><strong><span style="font-size: small;">Why the Change?</span></strong></p>
<p>The Autodesk Developer Network was designed during a time of a rapidly expanding market for desktop design, engineering and entertainment software.&#0160; This was a time of growing sales of heavy desktop software, never enough computing power, and limited connectivity.&#0160; The investment to start and grow a software company was significant.&#0160;&#0160;&#0160;&#0160; </p>
<p>The software industry is now undergoing a period of rapid change and innovation driven by cloud enabled, limitless, low cost computing power; rapidly expanding near ubiquitous connectivity through the internet and mobile devices and cross-platform support for key web technologies including HTML5 and Java.&#0160; Cloud and mobile technologies - along with the increasingly social behavior of software entrepreneurs and programmers - is changing the software industry, our personal and business lives, and the world we live in.</p>
<p>By modernizing the ADN program to better fit with these technology driven changes, we believe we can significantly improve the service we provide to software developers who choose ADN Professional or Standard membership levels, provide much better assistance to software developers who don’t need the additional ADN benefits, and make it easier for a new generation of innovators to discover and evaluate our technology.</p>
<p>&#0160;</p>
<p><strong><span style="font-size: small;">Questions?</span></strong></p>
<p>If you have any questions about this, then you’re welcome to comment on this blog post or email me directly.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Listing Pressure Pipe Styles
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: listing-pressure-pipe-styles
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D 2013

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/08/listing-pressure-pipe-styles.html 
DATE: 08/29/2012 08:03:51 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>On Civil 3D 2013 we have the ability to create Pressure Pipe Networks. At a first look we cannot see any pressure pipe related API under <strong>AeccDbMgd</strong>, but a deeper investigation at <strong>AeccPressurePipeMgd</strong> assembly show some features.</p>  <p>This post will show how access the list of Pressure Pipe styles, also Fitting and Appurtenance styles available at the document. Will come back later with more.</p>  <div style="font-family: ; background: white">   <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&lt;</font></font><font style="font-size: 8pt"><span><font color="#2b91af">CommandMethod</font></span><font color="#000000">(</font><span><font color="#a31515">&quot;pressurePipeStyles&quot;</font></span><font color="#000000">)&gt; _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">Public</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span><font color="#0000ff">Sub</font></span><font color="#000000"> CmdPressurePipeStyles()</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' access civil 3d document</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> civilDoc </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">CivilDocument</font></span><font color="#000000"> = </font><span><font color="#2b91af">CivilApplication</font></span><font color="#000000">. _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; ActiveDocument</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> db </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">Database</font></span><font color="#000000"> = </font><span><font color="#2b91af">Application</font></span><font color="#000000">.DocumentManager. _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; MdiActiveDocument.Database</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Using</font></span><font color="#000000"> trans </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">Transaction</font></span><font color="#000000"> = db.TransactionManager. _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; StartTransaction()</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' ****************************</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' list Pressure Pipe styles</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> pressurePipeStyleCollection </font><span><font color="#0000ff">As</font></span><font color="#000000">&#160; _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">PressurePipeStyleCollection</font></span><font color="#000000"> = _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">StylesRootPressurePipesExtension</font></span><font color="#000000">. _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; GetPressurePipeStyles(civilDoc.Styles)</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' for the collection of PressurePipeStyle</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; ShowStyleCollectionNames( _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; trans, _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; pressurePipeStyleCollection)</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' ****************************</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' list Pressure Fitting styles</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> fittingStyleCollection </font><span><font color="#0000ff">As</font></span><font color="#000000">&#160; _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">PressureFittingStyleCollection</font></span><font color="#000000"> = _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">StylesRootPressurePipesExtension</font></span><font color="#000000">. _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; GetPressureFittingStyles(civilDoc.Styles)</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' for each PressureFittingStyle</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; ShowStyleCollectionNames( _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; trans, _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; fittingStyleCollection)</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000"></font></font></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' ****************************</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' list Pressure Appurtenance styles</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> appurtenanceStyleCollection </font><span><font color="#0000ff">As</font></span><font color="#000000">&#160; _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">PressureAppurtenanceStyleCollection</font></span><font color="#000000"> = _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">StylesRootPressurePipesExtension</font></span><font color="#000000">. _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; GetPressureAppurtenanceStyles(civilDoc.Styles)</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' for each PressureAppurtenanceStyle</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; ShowStyleCollectionNames( _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; trans, _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; appurtenanceStyleCollection)</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; trans.Commit()</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">Using</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">End</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">Sub</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">Private</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span><font color="#0000ff">Sub</font></span><font color="#000000"> ShowStyleCollectionNames( _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">ByVal</font></span><font color="#000000"> trans </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">Transaction</font></span><font color="#000000">, _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">ByVal</font></span><font color="#000000"> collection </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">StyleCollectionBase</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' get the editor</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> ed </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">Editor</font></span><font color="#000000"> = </font><span><font color="#2b91af">Application</font></span><font color="#000000">.DocumentManager. _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; MdiActiveDocument.Editor</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' show the collection name</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; ed.WriteMessage(</font></font><font style="font-size: 8pt"><span><font color="#a31515">&quot;{0}{0}Collection of {1}&quot;</font></span><font color="#000000">, _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">Environment</font></span><font color="#000000">.NewLine, _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; collection.GetType().Name)</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">For</font></span><font color="#000000"> </font><span><font color="#0000ff">Each</font></span><font color="#000000"> styleId </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">ObjectId</font></span><font color="#000000"> </font><span><font color="#0000ff">In</font></span><font color="#000000"> collection</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' open each style... </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> style </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">StyleBase</font></span><font color="#000000"> = trans.GetObject( _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; styleId, </font></font><font style="font-size: 8pt"><span><font color="#2b91af">OpenMode</font></span><font color="#000000">.ForRead)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' and show its name</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; ed.WriteMessage(</font></font><font style="font-size: 8pt"><span><font color="#a31515">&quot;{0}{1}&quot;</font></span><font color="#000000">, _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">Environment</font></span><font color="#000000">.NewLine, _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; style.Name)</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#0000ff">Next</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">End</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">Sub</font></span></font></p> </div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: 'Geographic Location' & changing the Up direction (Z) using API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: geographic-location-changing-the-up-direction-z-using-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2012
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/08/geographic-location-changing-the-up-direction-z-using-api.html 
DATE: 08/27/2012 02:03:22 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>Using
&quot;<strong>GEOGRAPHICLOCATION</strong>&quot; command you could bring up the &quot;Geographic
Location&quot; window and there you will find the &quot;Up direction&quot;
drop-down to set the &quot;Z&quot; value. If you want to set / change the &quot;Up direction&quot; in GEOGRAPHICLOCATION settings through API, you can use
<strong>GeoLocationData.UpDirection</strong></p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01761775a14a970c-pi" style="display: inline;"><img alt="GeoLocation" class="asset  asset-image at-xid-6a0167607c2431970b01761775a14a970c" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01761775a14a970c-500wi" title="GeoLocation" /></a></p>
<p>&#0160;</p>
<p><strong>GeoLocationData
</strong>Class is available in AutoCAD .NET API
-&#0160;<strong>Autodesk.AutoCAD.DatabaseServices.GeoLocationData</strong>&#0160;</p>
<p>&#0160;</p>
<p>Here is a C#
code snippet which demonstrates how to change &quot;Up direction&quot; using :</p>
<p>&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Access GeoLocationData</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> geoDataId = db.GeoDataObject;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">//start a transaction </span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">Transaction</span><span style="line-height: 140%;"> trans = db.TransactionManager.StartTransaction())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">GeoLocationData</span><span style="line-height: 140%;"> geoLocdata = trans.GetObject(geoDataId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForWrite) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">GeoLocationData</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// Set the UpDirection</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">Vector3d</span><span style="line-height: 140%;"> vec3d = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Vector3d</span><span style="line-height: 140%;">(0.0, 0.0, 1.00);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; geoLocdata.UpDirection = vec3d;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; trans.Commit();</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
<p>&#0160;</p>
<p>Hope this is useful to you!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: AU 2012 Class catalog goes Live!
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: au-2012-class-catalog-goes-live
CATEGORY: Events
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/08/au-2012-class-catalog-goes-live.html 
DATE: 08/23/2012 02:13:12 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<table border="0" cellpadding="0" cellspacing="0" width="570">
<tbody>
<tr>
<td>
<p>The preview version of the Autodesk University 2012 <strong>class catalog</strong>
  is now available. </p>
<p>This will help you in planning your AU schedule. </p>
<table border="0" cellpadding="0" cellspacing="0" summary="Call to Action Button">
<tbody>
<tr>
<td width="172">
<p><a href="http://click.icptrack.com/icp/relay.php?r=39855277&amp;msgid=590768&amp;act=UBR5&amp;c=513232&amp;destination=https%3A%2F%2Fwww.autodeskuniversity2012.com%2Fconnect%2FpublicDashboard.ww"><strong>View the Catalog Now</strong></a></p>
</td>
<td valign="top" width="18">
<p>&#0160;</p>
</td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr>
<td>&#0160;</td>
</tr>
<tr>
<td>
<p>Highlights for AU 2012 include: </p>
<ul>
<li>New classes on topics such as: 
<ul>
<li>Advanced features and workflows</li>
<li>Cloud, mobile technologies, and visualization</li>
<li>Autodesk Certification preparation</li>
</ul>
</li>
<li><strong>New! </strong>Educator
       Summit</li>
<li>Innovation Forums</li>
<li>Media &amp; Entertainment Developer Network
       Conference</li>
</ul>
</td>
</tr>
</tbody>
</table>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Customize Fusion Viewer with JxLib
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: customize-fusion-viewer-with-jxlib
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: Daniel Du
CATEGORY: MapGuide Enterprise 2011

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/08/customize-fusion-viewer-with-jxlib.html 
DATE: 08/22/2012 04:45:37 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>Flexible web layout(aka Fusion Viewer) provides 5 templates with different styles. You can choose your favorite when embedding fusion viewer into your web application. And you may also customize the existing template or even create your own flexible web layout template yourself, here is a hint for your reference. </p>  <p>Fusion Viewer is based on <a href="http://openlayers.org/" target="_blank">OpenLayers</a> and <a href="http://jxlib.org/" target="_blank">JxLib</a>, so you can use JxLib to create your layout. I will not cover all details of JxLib in this post, you can find more examples and documents in JixLib website. I will make very quick sample, to add a panel into Slate template to show you how to get started.</p>  <p>Before we start, this is a screen-shot what I have done: </p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01761762e72d970c-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0177444956b4970d-pi" width="467" height="371" /></a></p>  <p>Now, let’s do it. Open the slate template in text editor firstly, it locates at C:\Program Files\Autodesk\Autodesk Infrastructure Web Server Extension 2013\www\fusion\templates\mapguide\slate\index.html by default. </p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><span style="line-height: 11pt"><font color="#000000" face="Courier New">…</font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; panel3 = </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> Jx.Panel({</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; label: OpenLayers.i18n(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#800000">'taskPaneTitle'</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">),</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; collapse: </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">true</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">,</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; maximize: </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">true</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">,</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; contentId: </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#800000">'TaskPane'</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; });</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><strong><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; panel4 = </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> Jx.Panel({</font></span></strong></font></p>    <p style="margin: 0px"><font face="Courier New"><strong><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; label: </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#800000">'mytest'</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">,</font></span></strong></font></p>    <p style="margin: 0px"><font face="Courier New"><strong><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; collapse : </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">true</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">,</font></span></strong></font></p>    <p style="margin: 0px"><font face="Courier New"><strong><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; maximize : </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">true</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">,</font></span></strong></font></p>    <p style="margin: 0px"><font face="Courier New"><strong><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; contentId : </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#800000">'mytest'</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">,</font></span></strong></font></p>    <p style="margin: 0px"><font face="Courier New"><strong><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; content : </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#800000">'your content here'</font></span></strong></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000"><strong>&#160;&#160;&#160; });</strong></font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; panelman = </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> Jx.PanelSet({</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; parent: splitter.elements[0],</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; panels: [panel1, panel2, panel3,<strong>panel4</strong>]</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; });</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font color="#000000" face="Courier New">…</font></span></p> </div>  <p>Please note the code in bold, which is added to create a new panel and add it to the template. Hope this helps and please refer to <a href="http://jxlib.org/" target="_blank">JxLib</a> website if you want to know more. You may also want to check out this DevTV: </p>  <p><b>DevTV: MapGuide Fusion Technology Introduction</b>    <br />A self-paced video tutorial on how to build a web-based mapping application using the Fusion Viewer Technology and MapGuide Enterprise.    <br /><a href="http://download.autodesk.com/media/adn/DevTV_Fusion_Introduction/FusionIntroductionDevTV.html">View Online</a> | <a href="http://download.autodesk.com/media/adn/FusionIntroductionDevTV.zip">Download</a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Saurabh
EMAIL: saurabh-g@hcl.com
IP: 121.245.68.41
URL: 
DATE: 11/15/2012 10:42:22 PM
This is good idea to modify existing index.html page of any template....

What if i want to add same panel to right side of slate???? How to achieve this, can you please let me know???


-----
COMMENT:
AUTHOR: C# Development
EMAIL: pr.biztech@gmail.com
IP: 115.252.78.107
URL: http://www.biztechconsultancy.com/c-sharp-development.htm
DATE: 12/24/2012 04:31:00 AM
Thank you for your post, I look for such article along time, today I find it finally. This post give me lots of advise it is very useful for me.

-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: List Corridor Target Mapping
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: list-corridor-target-mapping
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D 2013

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/08/list-corridor-target-mapping.html 
DATE: 08/22/2012 10:46:40 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>At the Corridor Properties window, under Parameters tab, it is possible see access the targets mapping of the corridor, as shown at the image below How can we access that using APIs?</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017c316a9294970b-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="target_mapping_corridor" border="0" alt="target_mapping_corridor" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017c316a92a4970b-pi" width="452" height="416" /></a></p>  <p>The following code sample opens the corridor and list its target mapping. But this is the first level. For each baseline we can also see find targets, so the second step of this sample iterate through the collection of baselines and list its targets.</p>  <p>Moving forward, SubassemblyTargetInfo.TargetIds collection accepts Add and Remove methods for editing.</p>  <div style="font-family: ; background: white">   <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&lt;</font></font><font style="font-size: 8pt"><span><font color="#2b91af">CommandMethod</font></span><font color="#000000">(</font><span><font color="#a31515">&quot;listCorridorTargetProperties&quot;</font></span><font color="#000000">)&gt; _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">Public</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span><font color="#0000ff">Shared</font></span><font color="#000000"> </font><span><font color="#0000ff">Sub</font></span><font color="#000000"> CmdListCorridorTargets()</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' acess Civil 3D Document and Editor</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> ed </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">Editor</font></span><font color="#000000"> = </font><span><font color="#2b91af">Application</font></span><font color="#000000">.DocumentManager. _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; MdiActiveDocument.Editor</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> civilDoc </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">CivilDocument</font></span><font color="#000000"> = _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">CivilApplication</font></span><font color="#000000">.ActiveDocument</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' select the corridor</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> opCorridor </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#0000ff">New</font></span><font color="#000000"> </font><span><font color="#2b91af">PromptEntityOptions</font></span><font color="#000000">( _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#a31515">&quot;Select a corridor: &quot;</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; opCorridor.SetRejectMessage( _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#a31515">&quot;Only corridor allowed&quot;</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; opCorridor.AddAllowedClass( _ </font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">GetType</font></span><font color="#000000">(</font><span><font color="#2b91af">Corridor</font></span><font color="#000000">), </font><span><font color="#0000ff">True</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> resCorridor </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">PromptEntityResult</font></span><font color="#000000"> = _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; ed.GetEntity(opCorridor)</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">If</font></span><font color="#000000"> (resCorridor.Status &lt;&gt; _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">PromptStatus</font></span><font color="#000000">.OK) </font><span><font color="#0000ff">Then</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">Return</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' get the list</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> listOfTargets </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#0000ff">String</font></span><font color="#000000"> = _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; ListCorridorTargets(resCorridor.ObjectId)</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' print</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; ed.WriteMessage(listOfTargets)</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">End</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">Sub</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">Private</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span><font color="#0000ff">Shared</font></span><font color="#000000"> </font><span><font color="#0000ff">Function</font></span><font color="#000000"> ListCorridorTargets( _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">ByVal</font></span><font color="#000000"> corridorId </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">ObjectId</font></span><font color="#000000">) </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">String</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> list </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#0000ff">New</font></span><font color="#000000"> System.Text.</font></font><span><font style="font-size: 8pt" color="#2b91af">StringBuilder</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' get the database and start a transaction</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> db </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">Database</font></span><font color="#000000"> = corridorId.Database</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Using</font></span><font color="#000000"> trans </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">Transaction</font></span><font color="#000000"> = db. _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; TransactionManager.StartTransaction()</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' open corridor</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> corr </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">Corridor</font></span><font color="#000000"> = trans.GetObject( _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; corridorId, </font></font><font style="font-size: 8pt"><span><font color="#2b91af">OpenMode</font></span><font color="#000000">.ForRead)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' list targets of the corridor</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; list.Append(ListTargets(trans, corr.GetTargets()))</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' now append each baseline</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">For</font></span><font color="#000000"> </font><span><font color="#0000ff">Each</font></span><font color="#000000"> bline </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">Baseline</font></span><font color="#000000"> </font><span><font color="#0000ff">In</font></span><font color="#000000"> corr.Baselines</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; list.AppendFormat(</font></font><font style="font-size: 8pt"><span><font color="#a31515">&quot;{0}{0}{1}&quot;</font></span><font color="#000000">, _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">Environment</font></span><font color="#000000">.NewLine, _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; bline.Name)</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; list.Append( _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; ListTargets( _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; trans, _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; bline.GetTargets()))</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#0000ff">Next</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; trans.Commit()</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">Using</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Return</font></span><font color="#000000"> list.ToString()</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">End</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">Function</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">Private</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span><font color="#0000ff">Shared</font></span><font color="#000000"> </font><span><font color="#0000ff">Function</font></span><font color="#000000"> ListTargets( _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">ByVal</font></span><font color="#000000"> trans </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">Transaction</font></span><font color="#000000">, _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">ByVal</font></span><font color="#000000"> targets </font><span><font color="#0000ff">As</font></span><font color="#000000">&#160; _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">SubassemblyTargetInfoCollection</font></span><font color="#000000">) _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">String</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> list </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#0000ff">New</font></span><font color="#000000"> System.Text.</font></font><span><font style="font-size: 8pt" color="#2b91af">StringBuilder</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' list targets</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">For</font></span><font color="#000000"> </font><span><font color="#0000ff">Each</font></span><font color="#000000"> target </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">SubassemblyTargetInfo</font></span><font color="#000000"> </font><span><font color="#0000ff">In</font></span><font color="#000000"> targets</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; list.AppendFormat(</font></font><font style="font-size: 8pt"><span><font color="#a31515">&quot;{0}{1}&quot;</font></span><font color="#000000">, _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">Environment</font></span><font color="#000000">.NewLine, _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; target.DisplayName)</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' list targets names</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' it must be done with Civil 3D Entity object, as the </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' generic AutoCAD Entity don’t have the Name we want</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' <strong><font style="background-color: #ffff00">Autodesk.Civil.DatabaseServices.Entity</font></strong></font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">For</font></span><font color="#000000"> </font><span><font color="#0000ff">Each</font></span><font color="#000000"> itemTargetId </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">ObjectId</font></span><font color="#000000"> </font><span><font color="#0000ff">In</font></span><font color="#000000"> _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; target.TargetIds</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> itemTarget </font><span><font color="#0000ff">As</font></span><font color="#000000"> Autodesk.Civil. _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; DatabaseServices.</font></font><font style="font-size: 8pt"><span><font color="#2b91af">Entity</font></span><font color="#000000"> = _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; trans.GetObject(itemTargetId, _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">OpenMode</font></span><font color="#000000">.ForRead)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; list.AppendFormat(</font></font><font style="font-size: 8pt"><span><font color="#a31515">&quot;{0}{1}{2}&quot;</font></span><font color="#000000">, _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">Environment</font></span><font color="#000000">.NewLine, _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">ControlChars</font></span><font color="#000000">.Tab, _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; itemTarget.Name)</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#0000ff">Next</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#0000ff">Next</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Return</font></span><font color="#000000"> list.ToString()</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">End</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">Function</font></span></font></p> </div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Set Parcel UserDefined Property using Civil 3D API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: set-parcel-userdefined-property-from-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2011
CATEGORY: AutoCAD Civil 3D 2012
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/08/set-parcel-userdefined-property-from-api.html 
DATE: 08/22/2012 03:25:21 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>One of our
valued Civil 3D customer and application developer had asked the following question:</p>
<p><span style="font-family: tahoma, arial, helvetica, sans-serif;"><em>I am trying to set the value of the existing userdefine​d
property &quot;Address&quot; of Parcels using the com method SetUserDefinedPropertyValue
but have had no luck.....</em></span></p>
<p>&#0160;</p>
<p>If you have the same question and looking for a solution
using the <strong>SetUserDefinedPropertyValue()</strong> API, here you go :</p>
<p>&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">//start a transaction </span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">Transaction</span><span style="line-height: 140%;"> trans = db.TransactionManager.StartTransaction())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">//get the list of properties</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; Autodesk.AECC.Interop.Land.</span><span style="color: #2b91af; line-height: 140%;">AeccUserDefinedPropertyClassification</span><span style="line-height: 140%;"> parcelUDPClass =</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; aeccDb.ParcelUserDefinedPropertyClassifications.Item(0);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">//get one property - create or access</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; Autodesk.AECC.Interop.Land.</span><span style="color: #2b91af; line-height: 140%;">AeccUserDefinedProperty</span><span style="line-height: 140%;"> propItem;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (parcelUDPClass.UserDefinedProperties.Count == 0)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">//create a new property</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; propItem = propItem = parcelUDPClass.UserDefinedProperties.Add(</span><span style="color: #a31515; line-height: 140%;">&quot;Address&quot;</span><span style="line-height: 140%;">, </span><span style="color: #a31515; line-height: 140%;">&quot;DESC&quot;</span><span style="line-height: 140%;">,</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; Autodesk.AECC.Interop.Land.</span><span style="color: #2b91af; line-height: 140%;">AeccUDPPropertyFieldType</span><span style="line-height: 140%;">.aeccUDPPropertyFieldTypeInteger,</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">true</span><span style="line-height: 140%;">, </span><span style="color: blue; line-height: 140%;">false</span><span style="line-height: 140%;">, 10, </span><span style="color: blue; line-height: 140%;">true</span><span style="line-height: 140%;">, </span><span style="color: blue; line-height: 140%;">false</span><span style="line-height: 140%;">, 20, </span><span style="color: blue; line-height: 140%;">true</span><span style="line-height: 140%;">, 15, </span><span style="color: blue; line-height: 140%;">null</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">else</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">//or access an existing one</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; propItem = parcelUDPClass.UserDefinedProperties.Item(0);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">//apply classification changes</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; aeccDb.Sites.Item(0).Parcels.Properties.SetUserDefinedPropertyClassification(</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; Autodesk.AECC.Interop.Land.</span><span style="color: #2b91af; line-height: 140%;">AeccUDPClassificationApplyWay</span><span style="line-height: 140%;">.aeccUDPClassificationApplyAll, </span><span style="color: #a31515; line-height: 140%;">&quot;Unclassified&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">//assuming the drawing contain at least one site, with at least one parcel</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (aeccDb.Sites.Item(0).Parcels.Count &gt; 0)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; Autodesk.AECC.Interop.Land.</span><span style="color: #2b91af; line-height: 140%;">AeccParcel</span><span style="line-height: 140%;"> parcel = aeccDb.Sites.Item(0).Parcels.Item(0);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">//get the property by name</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">object</span><span style="line-height: 140%;"> value = parcel.GetUserDefinedPropertyValue(propItem.Name);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">//also the SET the value</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; parcel.SetUserDefinedPropertyValue(propItem.Name, 13);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; }</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; trans.Commit();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
<p>&#0160;</p>
<p>Here is the result of running the above code snippet:</p>
<p>&#0160;</p>
<p>
<a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0176175fdeaf970c-pi" style="display: inline;"><img alt="Parcel_UDP" class="asset  asset-image at-xid-6a0167607c2431970b0176175fdeaf970c" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0176175fdeaf970c-500wi" title="Parcel_UDP" /></a><br /><br /></p>
<p>&#0160;</p>
<p>Hope this helps!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: RasmusB
EMAIL: rfb@focus.no
IP: 195.18.137.50
URL: 
DATE: 02/07/2013 07:16:37 AM
Thanks! Helped a lot! Couldn't figure out why Parcel.SetUserDefinedPropertyValue was failing..
-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: To Implement ZoomToSelection in Fusion Viewer of AIMS or MapGuide Enterprise
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: to-implement-zoomtoselection-in-fusion-viewer-of-aims-or-mapguide-enterprise
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: Daniel Du
CATEGORY: MapGuide Enterprise 2011

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/08/to-implement-zoomtoselection-in-fusion-viewer-of-aims-or-mapguide-enterprise.html 
DATE: 08/16/2012 11:35:00 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>
<p>I blogged about this topic on my personal blog in English, so I just leave a link here, if you are interested in this topic, please refer to <a href="http://www.cnblogs.com/junqilian/archive/2010/06/04/1751679.html" target="_blank">this post</a>. It was written based on MapGuide Enterprise 2011, but it applies to AIMS 2012/2013 as well with minor changes.</p>
<p>Hope this helps.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Setting the center of map programmatically
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: setting-the-center-of-map-programmatically
CATEGORY: AutoCAD Map 3D 2011
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/08/setting-the-center-of-map-programmatically.html 
DATE: 08/16/2012 08:57:00 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>
<p>Q:</p>
<p>I want to zoom a map to screen center without changing the scale, how can I do it?</p>
<p>A:</p>
<p>In Map 3D, if you have connected to FDO data sources and added them to map, you can call AcMapMap.ZoomToExtent() to set the new extent of map. It accepts a parameter of MgEnvelope type. If you do not have any FDO data source, you have to use AutoCAD APIs.</p>
<p>Here is the code snippet:</p>
<div style="background: white;">
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">[</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">CommandMethod</span></span><span style="line-height: 11pt;"><span style="color: #000000;">(</span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;ZoomCenter&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">)]</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">public</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">void</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> ZoomCenter()</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">{</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">Document</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> doc = </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Application</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.DocumentManager.MdiActiveDocument;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">Database</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> db = doc.Database;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">Editor</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> ed = doc.Editor;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">Point3d</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> centerPt;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">PromptPointOptions</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> ppo = </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">new</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">PromptPointOptions</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">(</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;Click on map to zoom center:&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">PromptPointResult</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> ppr = ed.GetPoint(ppo);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">if</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> (ppr.Status == </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">PromptStatus</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.OK)</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160; {</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160; centerPt = ppr.Value;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">AcMapMap</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> map = </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">AcMapMap</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.GetCurrentMap();</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">MgEnvelope</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> mapExtent = map.GetMapExtent();</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">//There are some FDO feature source connected </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">if</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> (!mapExtent.IsNull())</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160; {</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">double</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> centerX = mapExtent.LowerLeftCoordinate.X </span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; + mapExtent.Width / 2;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">double</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> centerY = mapExtent.LowerLeftCoordinate.Y </span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; + mapExtent.Height / 2;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160; ed.WriteMessage(</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;center:&quot;</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> + centerX.ToString() + </span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;,&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; + centerY.ToString() + </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;\n&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">MgEnvelope</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> newExtent = </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">new</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">MgEnvelope</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">(</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; centerPt.X - mapExtent.Width&#0160; / 2,</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; centerPt.Y - mapExtent.Height / 2,</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; centerPt.X + mapExtent.Width&#0160; / 2,</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; centerPt.Y + mapExtent.Height / 2);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; map.ZoomToExtent(newExtent);</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160; }</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #0000ff;">else</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160; {</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">//no FDO data source, use AutoCAD API</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">using</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> (</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Transaction</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> Tx = db.TransactionManager.StartTransaction())</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; {</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ed.UpdateTiledViewportsInDatabase();</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">ViewportTableRecord</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> viewportTableRec = Tx.GetObject(</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ed.ActiveViewportId, </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">OpenMode</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">.ForWrite) </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">as</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">ViewportTableRecord</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; viewportTableRec.CenterPoint = </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">new</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Point2d</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">(centerPt.X, centerPt.Y);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ed.UpdateTiledViewportsFromDatabase();</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Tx.Commit();</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; }</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160; }</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160; }</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">}</span></span></span></p>
</div>
<p>Hope this helps.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Steve Finch
EMAIL: 
IP: 98.190.206.213
URL: http://profile.typepad.com/stevefinch
DATE: 01/07/2013 11:25:29 AM
Daniel,

Thanks very much for this function.  It helped me greatly. I created a modified version of this function to zoom to a specific point on a map at a specific scale.  I need for the zoom to occur when called from the click event handler of a button on a modal form.

The problem is that the zoom does not occur until the user closes the modal form.  I've tried everything I can think of and posted on the boards.

Any ideas?  Thanks again!

Steve
-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Computing distance in Map 3D using .net API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: computing-distance-in-map-3d-using-net-api
CATEGORY: AutoCAD Map 3D 2011
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/08/computing-distance-in-map-3d-using-net-api.html 
DATE: 08/15/2012 08:52:27 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>Q: </p>  <p>I'd like to know how to compute the distance of two points using map 3D .net API</p>  <p>A:</p>  <p>Here is the sample code to do the same:</p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">[</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">CommandMethod</font></span><span style="line-height: 11pt"><font color="#000000">(</font></span><span style="line-height: 11pt; color: "><font color="#a31515">&quot;ComputeDistance&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">)]</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">public</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">void</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> ComputeDistance()</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">{</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//I am using LL84 coordinate system for this sample</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//As an example, this is longtitue/Latitue of two points</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">double</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> x1 = -87.7104750022991;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">double</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> y1 = 43.7017449116101;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">double</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> x2 = -87.703061972587;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">double</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> y2 = 43.7016702994388;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">Editor</font></span><span style="line-height: 11pt"><font color="#000000"> ed = </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">Application</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.DocumentManager.MdiActiveDocument.Editor;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//Get coordinate system of current map</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">AcMapMap</font></span><span style="line-height: 11pt"><font color="#000000"> currentMap = </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">AcMapMap</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.GetCurrentMap();</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">string</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> srsWkt = currentMap.GetMapSRS();</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//ed.WriteMessage(&quot;srs = &quot; + srsWkt + &quot;\n&quot;);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgCoordinateSystemFactory</font></span><span style="line-height: 11pt"><font color="#000000"> coordSysFactory = </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MgCoordinateSystemFactory</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">();</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgCoordinateSystem</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> coordSys = coordSysFactory.Create(srsWkt);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//compute gread circle distance</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">double</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> distance = coordSys.MeasureGreatCircleDistance(x1, y1, x2, y2);</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; distance = coordSys.ConvertCoordinateSystemUnitsToMeters(distance);</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; ed.WriteMessage(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">&quot;gread circle dist = &quot;</font></span><span style="line-height: 11pt"><font color="#000000"> + distance.ToString() + </font></span><span style="line-height: 11pt; color: "><font color="#a31515">&quot;\n&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//compute Euclidean distance</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; distance = coordSys.MeasureEuclideanDistance(x1, y1, x2, y2);</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; distance = coordSys.ConvertCoordinateSystemUnitsToMeters(distance);</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; ed.WriteMessage(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">&quot;Euclidean distance = &quot;</font></span><span style="line-height: 11pt"><font color="#000000"> + distance.ToString() + </font></span><span style="line-height: 11pt; color: "><font color="#a31515">&quot;\n&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//Another method, compute the distance from Newyork to Boston</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgCoordinateSystemMeasure</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> coordSysMeasure = coordSys.GetMeasure();</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">double</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> dist = coordSysMeasure.GetDistance(-74.806394, 40.714169, -71.061342, 42.355892);</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; dist = coordSys.ConvertCoordinateSystemUnitsToMeters(dist);</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; ed.WriteMessage(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">&quot;distance from Newyork to Boston is &quot;</font></span><span style="line-height: 11pt"><font color="#000000"> + dist.ToString() + </font></span><span style="line-height: 11pt; color: "><font color="#a31515">&quot; meters\n&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">}</font></font></span></p> </div>  <p>Hope this helps.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Madhukar Moogala
AUTHOR EMAIL: fpdtypepadadmin@autodesk.com
TITLE: About this Blog
STATUS: Publish
ALLOW COMMENTS: 0
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: about-this-blog

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/about-this-blog.html 
DATE: 08/15/2012 03:46:04 PM
-----
BODY:
<p>Welcome to ADN DevBlog. These blogs are maintained by the Developer Technical Services (DevTech) team - the worldwide team of API gurus providing technical services through the Autodesk Developer Network.&nbsp;<br /><br />Whenever any of us comes across some information on programming for Autodesk technology that we think you’ll be interested in, then you can expect it to be posted here. That will be technical (how-to) solutions derived from answering questions from ADN partners and from Autodesk forum users, sample projects, white papers, screencasts, conference presentation material, and other information derived from our work. This blog is a vehicle to quickly put lots of information in one place so you can easily find what you need to solve your programming problems. Don’t expect poetry and prose – just good, old-fashioned hard facts.<br /><br />Every member of the DevTech team will be posting information here – and lots of it. Follow us on Twitter, RSS, or just visit us when you need to browse or search for specific information. You’re very welcome to post additional information on topics or ask questions in the comments section for any blog post you’re interested in.</p>
<p>Much of the code posted here is derived from answers to questions from our ADN members, and has not been formally reviewed by a QA engineer. That means it will often be derived from existing sample code and could contain some code elements that are superfluous to the task in hand. Suggestions for improving code samples or any posted information are always welcome, but we ask that you maintain a constructive tone when commenting. Any comments that are deemed rude or aggressive may be deleted or edited at our discretion.</p>
<p><br /><strong>Disclaimer</strong><br />If you need an official Autodesk company response or a contact for press related activities please contact<a href="http://www.autodesk.com/pressroom"> Autodesk Public Relations.</a></p>
<p>If you need support for our products, please visit Autodesk's <a href="http://support.autodesk.com/">support website</a>, use our <a href="http://discussion.autodesk.com/">discussion groups</a> or post a question via your reseller.</p>
<p>For API questions, please use our <a href="http://discussion.autodesk.com/">discussion groups</a>. Or if you are a member of Autodesk Developer Network, please use the <a href="http://adn.autodesk.com/">Autodesk Developer Network website</a>. You can also find an ample of learning materials on our <a href="http://usa.autodesk.com/adsk/servlet/index?siteID=123112&amp;id=19118898">Autodesk Developer Network Open</a> site, which is open to public. If you are currently not a member and interested in becoming one, please visit <a href="http://www.autodesk.com/joinadn">Autodesk Developer Network</a> site for more information.</p>
<p>The contents of this site are the personal opinions of the contributors and do not represent our employer's view in any way. In addition, our thoughts and opinions often change. As a weblog is intended to provide a semi-permanent point-in-time snapshot, you should not consider out-of-date posts to reflect our current thoughts and opinions.</p>
<p>The code provided in this blog is provided "as is" and with all faults.&nbsp;We (and our employer) specifically disclaim any implied warranty of merchantability or fitness for a particular use. The operation of the code provided is not warranted to be uninterrupted or error free.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Digitizing with Fusion Viewer API in AIMS or MapGuide
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: digitizing-with-fusion-viewer-api-in-aims-or-mapguide
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: Daniel Du
CATEGORY: MapGuide Enterprise 2011

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/08/digitizing-with-fusion-viewer-api-in-aims-or-mapguide.html 
DATE: 08/15/2012 03:22:00 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>
<p>I have published a blog about digitizing with Fusion Viewer API of MapGuide on <a href="http://www.cnblogs.com/junqilian/" target="_blank">my Chinese personal blog</a>, but this post is in English. So I will just leave a link here, if you are interested in this topic, please refer to <a href="http://www.cnblogs.com/junqilian/archive/2010/06/04/1751563.html" target="_blank">this post</a>.</p>
<p>It is based on MapGuide Enterprise 2011, but it still applies to AIMS 2012/2013 with minor changes.</p>
<p>hope this helps.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Mimic OnCheckIn Event in Map 3D
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: mimic-oncheckin-event-in-map-3d
CATEGORY: AutoCAD Map 3D 2011
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/08/mimic-oncheckin-event-in-map-3d.html 
DATE: 08/14/2012 08:53:30 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>Have you ever run into such scenario that value of one field is computed from other fields? For example we can calculate the total land price from land price per unit and area. Most RDBMS can do this with stored procedure or similar, but for file based data source like SDF or SHP file, we have to do this ourselves by code. A good chance to do the calculation is when the modification on features are checked in, it would be better if Map 3D API provides an event like OnCheckIn, unfortunately, there is no such events in Geospatial Platform API. </p>  <p>But it can be done by a combination of serials events, they are FeatureInserted, FeatureUpdated, and FeatureDeleted of AcMapFeatureService.</p>  <p>Following code snippet domos how to use FeatureUpdated event, you can implement the other two to mimic OnCheckIn event is Map 3D. I blogged this topic a few years ago on my personal blog, if you prefer to read Chinese, please go to this <a href="http://www.cnblogs.com/junqilian/archive/2010/01/29/1659160.html" target="_blank">link</a>.</p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><span style="line-height: 11pt; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">// (C) Copyright 2012 by Autodesk </font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">//</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> System;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> Autodesk.AutoCAD.Runtime;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> Autodesk.AutoCAD.ApplicationServices;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> Autodesk.AutoCAD.DatabaseServices;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> Autodesk.AutoCAD.Geometry;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> Autodesk.AutoCAD.EditorInput;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> Autodesk.Gis.Map.Platform;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> OSGeo.MapGuide;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">// This line is not mandatory, but improves loading performances</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">[</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">assembly</font></span><span style="line-height: 11pt"><font color="#000000">: </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">CommandClass</font></span><span style="line-height: 11pt"><font color="#000000">(</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">typeof</font></span><span style="line-height: 11pt"><font color="#000000">(MapOnCheckIn.</font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MyCommands</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">))]</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">namespace</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> MapOnCheckIn</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">{</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">// This class is instantiated by AutoCAD for each document when</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">// a command is called by the user the first time in the context</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">// of a given document. In other words, non static data in this class</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">// is implicitly per-document!</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">public</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">class</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#2b91af">MyCommands</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">Editor</font></span><span style="line-height: 11pt"><font color="#000000"> ed = </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">Application</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.DocumentManager.MdiActiveDocument.Editor;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//Following code sample demos how to mimic the OnCheckIn event</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//when features are updated using fs.FeatureUpdated,</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//You will need to implement FeatureDeleted&#160; and FeatureInserted yourself</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; [</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">CommandMethod</font></span><span style="line-height: 11pt"><font color="#000000">(</font></span><span style="line-height: 11pt; color: "><font color="#a31515">&quot;AddFsEvents&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">)]</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">public</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">void</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> AddFeatureServicesEvents()</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">AcMapFeatureService</font></span><span style="line-height: 11pt"><font color="#000000"> fs = </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">AcMapServiceFactory</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.GetService(</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgServiceType</font></span><span style="line-height: 11pt"><font color="#000000">.FeatureService) </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">as</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">AcMapFeatureService</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; fs.FeatureUpdated += </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">FeatureUpdatedHandler</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">(fs_FeatureUpdated);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">AcMapMap</font></span><span style="line-height: 11pt"><font color="#000000"> currentMap = </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">AcMapMap</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.GetCurrentMap();</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; currentMap.FeatureInstanceModified += </font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">FeatureInstanceModifiedHandler</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">(currentMap_FeatureInstanceModified);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">// Triggered at once when the feature is updated, even it is not checked,</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">// This is not what we want.</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">void</font></span><span style="line-height: 11pt"><font color="#000000"> currentMap_FeatureInstanceModified(</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">object</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> sender, </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">FeatureInstanceModifiedEventArgs</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> args)</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">&quot;FeatureInstanceModified fired!\n&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">);</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//Triggered&#160; when the feature is updated and checked in,</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//This is the one we are looking for, it only triggered when checked in</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//We can get the feature which is being checked in by Args.GetFeature()</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//if more than one feature are updated, it will be fired more times</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//so you can catch this even to handle each of them.</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">void</font></span><span style="line-height: 11pt"><font color="#000000"> fs_FeatureUpdated(</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">object</font></span><span style="line-height: 11pt"><font color="#000000"> sender, </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">AcMapFeatureEventArgs</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> args)</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">&quot;FeatureUpdated fired! \n&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">&quot;--------------------------------------\n&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">&quot;PropertyName \t Value \n&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgPropertyCollection</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> props = args.GetFeature().GetProperties();</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">int</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> propCount = props.Count;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">for</font></span><span style="line-height: 11pt"><font color="#000000"> (</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">int</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> i = 0; i &lt; propCount; i++)</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">string</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> propName = props[i].Name;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">string</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> valueString;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">switch</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> (props[i].GetPropertyType())</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">case</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MgPropertyType</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.Int32:</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; valueString = (props[i] </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">as</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MgInt32Property</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">).GetValue().ToString();</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">break</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">case</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MgPropertyType</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.String:</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; valueString = (props[i] </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">as</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MgStringProperty</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">).GetValue().ToString();</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">break</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">default</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">:</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; valueString = </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">&quot;&lt;***&gt;&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">break</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(propName + </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">&quot;\t&quot;</font></span><span style="line-height: 11pt"><font color="#000000"> + valueString + </font></span><span style="line-height: 11pt; color: "><font color="#a31515">&quot;\n&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">&quot;------------------------------------\n&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">}</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p> </div>  <p>Hope this helps.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Getting Fusion object in flexible web layout
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: getting-fusion-object-in-flexible-web-layout
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: Daniel Du
CATEGORY: MapGuide Enterprise 2011

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/08/getting-fusion-object-in-flexible-web-layout.html 
DATE: 08/14/2012 03:12:00 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>
<p>When developing with flexible web layout, we always need to get the global object Fusion. Sometimes you may get error message: &#39; Fusion is undefined&#39; if you do not get it correctly.</p>
<p>Actually, how to get the Fusion object depends on how you embed the fusion viewer into your webpage and where you call your JavaScript to get it. Generally speaking, if you are not using &lt;frame&gt; or &lt;iframe&gt; when embedding fusion viewer, following code snippet should work for you.</p>
<div style="background: white;">
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">var</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> MainFusionWindow = GetFusionWindow();</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">var</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> OpenLayers = MainFusionWindow.OpenLayers;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">var</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> Fusion = MainFusionWindow.Fusion;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">alert(Fusion);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #006400;">/* locate the Fusion window */</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">function</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> GetFusionWindow() {</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">var</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> curWindow = window;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">while</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> (!curWindow.Fusion) {</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">if</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> (curWindow.parent &amp;&amp; curWindow != curWindow.parent) {</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; curWindow = curWindow.parent;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; } </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">else</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">if</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> (curWindow.opener) {</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; curWindow = curWindow.opener;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; } </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">else</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> {</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; alert(</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #800000;">&#39;Could not find Fusion instance&#39;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">break</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">;</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160; }</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">return</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> curWindow;</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">} </span></span></span></p>
</div>
<p>Hope this helps.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Arrianne
EMAIL: arrguzman@indracompany.com
IP: 122.52.41.211
URL: 
DATE: 09/06/2012 08:22:36 PM
Hi,

How do you properly set fusion's config.json? We are currently implementing flexible web layout but we're having issues in utilizing FUSION's API because of the current setup  defined in config.json. We're getting an error message "Error loading configuration file, initialization aborted. Make sure you have copied config_dist.json to config.json and have configured the settings for your system."

Note: config_dist.json is already named as config.json 

Hope to hear from you soon. Thank you very much.
-----
COMMENT:
AUTHOR: Daniel Du
EMAIL: 
IP: 125.98.160.4
URL: http://profile.typepad.com/daniel_du
DATE: 09/06/2012 08:46:51 PM
Hi Arrianne,

I did not do anything with config.json, just using the default one which is installed by installer. I don't think it is necessary to  modify this file except you have particular needs.
-----
COMMENT:
AUTHOR: Arrianne
EMAIL: arrguzman@indracompany.com
IP: 122.52.41.211
URL: 
DATE: 09/06/2012 10:54:35 PM
Hi Daniel, 

Thank you very much for the quick reply. I imported fusion.js and when I try to run the application, I'm getting the error message "Error loading configuration file, initialization aborted. Make sure you have copied config_dist.json to config.json and have configured the settings for your system." What may be the possible cause for having such kind of error? 

Again, thank you very much.
-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Run MapClean Profile Programmatically
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: run-mapclean-profile-programmatically
CATEGORY: AutoCAD Map 3D 2011
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/08/run-mapclean-profile-programmatically.html 
DATE: 08/13/2012 03:03:00 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>I am asked about this question: I know how to run MapClean in Map 3D UI, and create/load profile to run the mapclean process repeatedly. but is it possible to run MapClean programmatically? The answer is yes, we can create a custom application to run MapClean programmatically. Here is the code snippet, please note that we need add reference to ManagedMapApi.dll, which can be found in Map 3D installation folder.</p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">[</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">CommandMethod</font></span><span style="line-height: 11pt"><font color="#000000">(</font></span><span style="line-height: 11pt; color: "><font color="#a31515">&quot;clean&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">)]</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">public</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">void</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> DrawingCleanUp()</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">{</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; Autodesk.Gis.Map.Topology.</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">Variable</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> cadAction </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; = </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> Autodesk.Gis.Map.Topology.</font></span><span style="line-height: 11pt; color: "><font color="#2b91af">Variable</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">();</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//Load a dpf script file, it can be generated by Map 3D UI</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; cadAction.LoadProfile(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">@&quot;C:\Work\mapcleandemo\myclean.dpf&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//The instance of this class should be released by explicitly </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//calling Dispose() in order to avoid memory leak.</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//See also 'using' keyword in C# and VB.Net.</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">using</font></span><span style="line-height: 11pt"><font color="#000000"> (Autodesk.Gis.Map.Topology.</font></span><span style="line-height: 11pt; color: "><font color="#2b91af">TopologyClean</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> cadCleanobj </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; = </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> Autodesk.Gis.Map.Topology.</font></span><span style="line-height: 11pt; color: "><font color="#2b91af">TopologyClean</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">())</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//Open a file first to avoid MapTopologyException</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; cadCleanobj.Init(cadAction, </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">null</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; cadCleanobj.Start();</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; cadCleanobj.GroupNext();</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">while</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> (!cadCleanobj.Completed)</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; cadCleanobj.GroupFix();</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; cadCleanobj.GroupNext();</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//Commit the changes</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; cadCleanobj.End();</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">}</font></font></span></p> </div>  <p>&#160;</p>  <p>Hope this helps!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Robert
EMAIL: r.zrnc@trafficon.hr
IP: 89.164.252.183
URL: 
DATE: 12/05/2012 01:18:11 AM
Hello Mr. Daniel. I have problem with TopologyClean.Init(action, IdCollection). If I use ObjectIdCollection, or if I use null, I have same result. "All" object are cleaning, not only this in my ObjectIdCollection. What I doing wrong?
Thanks.

Robert
-----
COMMENT:
AUTHOR: Daniel
EMAIL: daniel.du@autodesk.com
IP: 118.228.153.194
URL: 
DATE: 07/28/2014 01:51:07 AM
Hi Robert,

I have noticed this issue, and logged a change request about this. Sorry for the inconvenience.
-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Replacing Alignment Entities
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: replacing-alignment-entities
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D 2013

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/08/replacing-alignment-entities.html 
DATE: 08/13/2012 12:43:18 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>During one of my <a href="http://www.adskconsulting.com/adn/cs/api_course_sched.php" target="_blank">API trainings</a>, a question came up: is it possible replace an alignment entity, let’s say an Arc, with a Spiral-Curve-Spiral? This can be interesting if we want to ‘validate’ the alignment against some localized standards. </p>  <p>The alignment object of Civil 3D .NET API has the Entities property, which is enumerable, but this may not return the items on the correct order. So we need to use its <strong>GetEntityByOrder</strong> method. Also, as the list is not indexed by its logical order, we have to use the proper <strong>Remove</strong> override that receives the entity (and not the index).</p>  <p>The following code show the basic idea: it searches for Arc entities with Radius smaller than 600 and replaces with Spiral-Curve-Spiral.</p>  <div style="font-family: ; background: white">   <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">Private</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span><font color="#0000ff">Sub</font></span><font color="#000000"> ValidadeAlignment(</font><span><font color="#0000ff">ByVal</font></span><font color="#000000"> align </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">Alignment</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' go through the alignment entities</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' following the order</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> entCount </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#0000ff">Integer</font></span><font color="#000000"> = align.Entities.Count</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">For</font></span><font color="#000000"> i </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#0000ff">Integer</font></span><font color="#000000"> = 0 </font><span><font color="#0000ff">To</font></span><font color="#000000"> entCount - 1</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' access each alignment segment</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> alignEnt </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">AlignmentEntity</font></span><font color="#000000"> = _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; align.Entities.GetEntityByOrder(i)</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' on this sample, we're looking for simple </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' arc entities to be replaces</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Select</font></span><font color="#000000"> </font><span><font color="#0000ff">Case</font></span><font color="#000000"> alignEnt.EntityType</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Case</font></span><font color="#000000"> </font><span><font color="#2b91af">AlignmentEntityType</font></span><font color="#000000">.Arc</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' downcast to Align Arc type</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> arcEnt </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">AlignmentArc</font></span><font color="#000000"> = alignEnt</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' on this sample, let's focus on </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' arcs with radius smaller than 600</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">If</font></span><font color="#000000"> (arcEnt.Radius &lt; 600) </font></font><span><font style="font-size: 8pt" color="#0000ff">Then</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' as the entity will be removed, </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' we need to store its data now</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> previousEnt </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#0000ff">Integer</font></span><font color="#000000"> = arcEnt.EntityBefore</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> nextEnt </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#0000ff">Integer</font></span><font color="#000000"> = arcEnt.EntityAfter</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> radius </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#0000ff">Double</font></span><font color="#000000"> = arcEnt.Radius</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' ok, now remove the entity</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; align.Entities.Remove(arcEnt)</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' and to replace with </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' an SCS (spiral-curve-spiral) entity,</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' first we need to calculate the parameters</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' of the spirals, but let's assume a value here</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> spiral1Param </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#0000ff">Double</font></span><font color="#000000"> = 20</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> spiral2Param </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#0000ff">Double</font></span><font color="#000000"> = 20</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' and notice that both previous and next </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' entities are used here</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; align.Entities. _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; AddFreeSCS(previousEnt, _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; nextEnt, _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; spiral1Param, _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; spiral2Param, _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">SpiralParamType</font></span><font color="#000000">.Length, _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; radius, _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">False</font></span><font color="#000000">, _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">SpiralType</font></span><font color="#000000">.Clothoid)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">If</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">Select</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#0000ff">Next</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">Sub</font></span></font></p> </div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: joantopo
EMAIL: joantopo@hotmail.com
IP: 88.25.47.114
URL: 
DATE: 06/30/2016 12:22:09 AM
After this line:
"For i As Integer = 0 To entCount - 1"

you should start with "Try{..."

Because the "GetEntityByOrder" could throw an exception due to:
This function behaves like the GUI in that disconnected alignment entities are not considered.
-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 189.103.246.22
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 06/30/2016 05:59:55 AM
You're right, we just prefer to avoid error checking to keep code clean/small for blog posts, but glad you pointed out.

Cheers,
Augusto Goncalves
-----
COMMENT:
AUTHOR: joantopo
EMAIL: joantopo@hotmail.com
IP: 88.9.44.129
URL: 
DATE: 07/31/2016 09:53:17 AM
I have a question about replacing alignment entities.
I know that we can retain the ObjectId in AutoCAD API if we remove it and we replace it to another object, but the ID of the alignment entities is an Integer value. 
Can we stablish an old Id entity to a new alignment entity?

-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 187.106.202.86
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 08/01/2016 07:39:12 AM
Hi, 

I don't believe you can change this ID, it's read-only and not a parameter while creating the align entity. That's where this approach comes in: remove and replace ensuring the previous and next remains. 

Regards,
Augusto Goncalves
-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Retrieve the maps or web layouts from AIMS/MGE repository
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: retrieve-the-maps-or-web-layouts-from-aimsmge-repository
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: Daniel Du
CATEGORY: MapGuide Enterprise 2011

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/08/retrieve-the-maps-or-web-layouts-from-aimsmge-repository.html 
DATE: 08/12/2012 11:51:54 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>
<p>I am asked how to get the list of maps from MapGuide repository. In this post, I will show you how to do it with code, actually it is possible to get a list of resource with specified type, it can be feature source, layer, map or web layout.</p>
<p>The resources can be retrieved by resource service. Here is the help information about EnumerateResources method:</p>
<p><a href="http://adn.autodesk.com/d8/d50/class_mg_byte_reader.htm">MgByteReader</a>* MgResourceService::EnumerateResources     <br />(     <br /><a href="http://adn.autodesk.com/d6/d80/class_mg_resource_identifier.htm">MgResourceIdentifier</a> * resource,     <br /><a href="http://adn.autodesk.com/d2/d04/_foundation_defs_8h_0cb58e7e6f0bad369840a52e54a56ae0.htm#0cb58e7e6f0bad369840a52e54a56ae0">INT32</a> depth,     <br /><a href="http://adn.autodesk.com/d2/d04/_foundation_defs_8h_2697935ae7be4121104b37ff513b810b.htm#2697935ae7be4121104b37ff513b810b">CREFSTRING</a> type     <br />)</p>
<p>Enumerates the resources in the specified repository.</p>
<p>Remarks:</p>
<p>You can enumerate all types or just a selected type. You can also choose what depth in the repository to examine. This method only works on &quot;Library&quot; repository. If you specify a repository that is not supported, this method will throw an MgInvalidRepositoryType exception.</p>
<p>Parameters:</p>
<p><em>resource</em></p>
<p>(<a href="http://adn.autodesk.com/d6/d80/class_mg_resource_identifier.htm">MgResourceIdentifier</a>) Resource identifier specifying the resource to enumerate. This can be a document or a folder.     <br />If it is a folder, you must include the trailing slash in the identifier.</p>
<p><em>depth</em></p>
<p>(int) Recursion depth, relative to the specified resource.</p>
<ul>
<li>If the resource is a document, depth must be set to 0. </li>
<li>If the resource is a folder:      
<ul>
<li>If the depth is equal to 0, only information about the specified folder is returned. </li>
<li>If the depth is greater than 0, information about the folder and its descendants up to the specified depth are returned. </li>
</ul>
</li>
<li>If the depth is -1, information about the folder and all its descendants is returned. </li>
</ul>
<p><em>type</em></p>
<p>(String/string) Type of the resource to be enumerated. (Case sensitive.) See<a href="http://adn.autodesk.com/d0/d19/class_mg_resource_type.htm">MgResourceType </a>for valid types.     <br />Or, this can be set to null, in which case information about all resource types is returned.</p>
<p>Returns:</p>
<p>Returns an <a href="http://adn.autodesk.com/d8/d50/class_mg_byte_reader.htm">MgByteReader</a> object containing a description of the resources in XML format using the <a href="http://adn.autodesk.com/de/daa/group___resource_list__schema.htm">ResourceList </a>schema.</p>
<p>The resource type can be specified by member of MgResourceType.</p>
<p>&#0160;</p>
<p>For your information, following the implementation of MgResourceType, it is included in MapGuide WebExtension API, you DO NOT need to implement it yourself.</p>
<div style="background: white;">
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">class</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #2b91af;">MgResourceType</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160; {</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">// For flexible weblayout</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">const</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">string</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> ApplicationDefinition = </span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;ApplicationDefinition&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">;&#0160; </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">const</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">string</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> DrawingSource = </span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;DrawingSource&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">const</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">string</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> FeatureSource = </span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;FeatureSource&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">const</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">string</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> Folder = </span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;Folder&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">const</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">string</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> LayerDefinition = </span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;LayerDefinition&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">const</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">string</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> LoadProcedure = </span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;LoadProcedure&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">// For runtime map</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">const</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">string</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> Map = </span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;Map&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">// For map definition&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">const</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">string</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> MapDefinition = </span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;MapDefinition&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">const</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">string</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> PrintLayout = </span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;PrintLayout&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">const</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">string</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> Selection = </span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;Selection&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">const</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">string</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> SymbolDefinition = </span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;SymbolDefinition&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">const</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">string</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> SymbolLibrary = </span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;SymbolLibrary&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">// For basic weblayout&#0160; </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">const</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">string</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> WebLayout = </span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;WebLayout&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> MgResourceType();</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160; }</span></span></span></p>
</div>
<p>Following code snippet demonstrates how to get all maps, you make some minior changes to retrieve other type of resources very easily:</p>
<div style="background: white;">
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #808080;"><span style="font-size: 8pt;">///</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #008000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #808080;">&lt;summary&gt;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #808080;"><span style="font-size: 8pt;">///</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">&#0160; enumberate all the map definitions in the </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #808080;"><span style="font-size: 8pt;">///</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #008000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #808080;">&lt;/summary&gt;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #808080;"><span style="font-size: 8pt;">///</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #008000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #808080;">&lt;param name=&quot;resId&quot;&gt;&lt;/param&gt;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #808080;"><span style="font-size: 8pt;">///</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #008000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #808080;">&lt;returns&gt;&lt;/returns&gt;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">public</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;"> Dictionary&lt;</span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">string</span></span><span style="line-height: 11pt;"><span style="color: #000000;">, </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">string</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">&gt; GetAllMaps(MgResourceIdentifier resId)</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">{</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; Dictionary&lt;</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">string</span></span><span style="line-height: 11pt;"><span style="color: #000000;">, </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">string</span></span><span style="line-height: 11pt;"><span style="color: #000000;">&gt; mapList = </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">new</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> Dictionary&lt;</span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">string</span></span><span style="line-height: 11pt;"><span style="color: #000000;">, </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">string</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">&gt;();</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160; MgResourceService resSvc = siteConnection.CreateService</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; (MgServiceType.ResourceService) </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">as</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> MgResourceService;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">// Get all map def resources</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">// MgResourceType.WebLayout for basic weblayout and </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">// MgResourceType.ApplicationDefinition for flexible weblayout</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160; MgByteReader byteRdr = resSvc.EnumerateResources(resId, -1, </span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; MgResourceType.MapDefinition);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">//Convert to string </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">String</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> MapResStr = byteRdr.ToString();</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">//Load into XML document so we can parse and get the names of the maps</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; XmlDocument doc = </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">new</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> XmlDocument();</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160; doc.LoadXml(MapResStr);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">//let&#39;s extract the map names and list them&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160; XmlNodeList MapResIdNodeList;</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160; XmlElement root = doc.DocumentElement;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; MapResIdNodeList = root.SelectNodes(</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;//ResourceId&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">int</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> nRes = MapResIdNodeList.Count;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">for</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> (</span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">int</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> i = 0; i &lt; nRes; i++)</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160; {</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160; XmlNode MapResIdNode = MapResIdNodeList.Item(i);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">String</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> MapRes = MapResIdNode.InnerText;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">int</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> index1 = MapRes.LastIndexOf(</span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&#39;/&#39;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">) + 1;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">int</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> index2 = MapRes.IndexOf(</span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;MapDefinition&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">) - 2;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">int</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> length = index2 - index1 + 1;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">string</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> mapName = MapRes.Substring(index1, length);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">if</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> (!mapList.ContainsKey(mapName))</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160; {</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; mapList.Add(mapName, MapRes);</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160; }</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160; }</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">return</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> mapList;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">}</span></span></span></p>
</div>
<p>Hope this helps.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Wilson Herrera
EMAIL: wherrera@pccadpanama.com
IP: 201.226.162.66
URL: 
DATE: 10/30/2012 08:37:01 AM
Hi, i was looking at this code, and found that if i copy/paste resources between folders, this new maps are not listed.

to solve this, i had to copy the maps again inside the folder.

do you know how can i avoid this issue?

thanks a lot
-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Change the name of the current map in the Display Manager
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: change-the-name-of-the-current-map-in-the-display-manager
CATEGORY: AutoCAD Map 3D 2011
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/08/change-the-name-of-the-current-map-in-the-display-manager.html 
DATE: 08/12/2012 08:59:17 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>If you are trying to change the name of current map in display manager from “Default”? Here is the solution. To change the map name in the Display Manager, you need to get the map Id and use this map ID to get the map object, then assign a new value to the &quot;Name&quot; property of the map object. You will be using the Display Manager API for this.</p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><span style="line-height: 11pt; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">// (C) Copyright 2012 by Autodesk </font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">//</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> System;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> Autodesk.AutoCAD.Runtime;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> Autodesk.AutoCAD.ApplicationServices;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> Autodesk.AutoCAD.DatabaseServices;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> Autodesk.AutoCAD.Geometry;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> Autodesk.AutoCAD.EditorInput;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> Autodesk.Gis.Map;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> Autodesk.Gis.Map.Project;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> Autodesk.Gis.Map.DisplayManagement;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">// This line is not mandatory, but improves loading performances</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">[</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">assembly</font></span><span style="line-height: 11pt"><font color="#000000">: </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">CommandClass</font></span><span style="line-height: 11pt"><font color="#000000">(</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">typeof</font></span><span style="line-height: 11pt"><font color="#000000">(ChangeMapNameInDM.</font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MyCommands</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">))]</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">namespace</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> ChangeMapNameInDM</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">{</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">// This class is instantiated by AutoCAD for each document when</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">// a command is called by the user the first time in the context</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">// of a given document. In other words, non static data in this class</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">// is implicitly per-document!</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">public</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">class</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#2b91af">MyCommands</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">Editor</font></span><span style="line-height: 11pt"><font color="#000000"> ed = </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">Application</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.DocumentManager.MdiActiveDocument.Editor;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MapApplication</font></span><span style="line-height: 11pt"><font color="#000000"> app = </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">HostMapApplicationServices</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.Application;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; [Autodesk.AutoCAD.Runtime.</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">CommandMethodAttribute</font></span><span style="line-height: 11pt"><font color="#000000">(</font></span><span style="line-height: 11pt; color: "><font color="#a31515">&quot;CHGMAPNAME&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">)]</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">public</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">void</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> ChangeMapName()</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">try</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">string</font></span><span style="line-height: 11pt"><font color="#000000"> mapName = </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">null</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">PromptResult</font></span><span style="line-height: 11pt"><font color="#000000"> stringPromptResult = </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">null</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">bool</font></span><span style="line-height: 11pt"><font color="#000000"> succeeded = </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">false</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; stringPromptResult = ed.GetString(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">&quot;\nEnter the new Map name:&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; mapName = stringPromptResult.StringResult.Trim();</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">if</font></span><span style="line-height: 11pt"><font color="#000000"> (stringPromptResult.Status == </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">PromptStatus</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.OK </font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &amp;&amp; mapName.Length &gt; 0)</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; succeeded = changeMapName(mapName);</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">else</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">&quot;\nERROR: Invalid Map name&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">);</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">if</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> (!succeeded)</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">&quot;\nERROR: Name change failure&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">);</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">catch</font></span><span style="line-height: 11pt"><font color="#000000"> (System.</font></span><span style="line-height: 11pt; color: "><font color="#2b91af">Exception</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> err)</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(err.Message);</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">private</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">bool</font></span><span style="line-height: 11pt"><font color="#000000"> FindCurrentMapId(</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">ref</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">ObjectId</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> currentMapId)</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">bool</font></span><span style="line-height: 11pt"><font color="#000000"> isFound = </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">false</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">// Get the project associated with the current AutoCAD document</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">ProjectModel</font></span><span style="line-height: 11pt"><font color="#000000"> project = </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">null</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; Autodesk.AutoCAD.DatabaseServices.</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">TransactionManager</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> TM </font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; = app.ActiveProject.Database.TransactionManager;</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; project = app.ActiveProject;</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">try</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">using</font></span><span style="line-height: 11pt"><font color="#000000"> (</font></span><span style="line-height: 11pt; color: "><font color="#2b91af">Transaction</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> trans = TM.StartTransaction())</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">ObjectId</font></span><span style="line-height: 11pt"><font color="#000000"> managerId = </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">DisplayManager</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.Create(project)</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; .MapManagerId(project, </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">true</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MapManager</font></span><span style="line-height: 11pt"><font color="#000000"> manager = trans.GetObject(managerId, </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">OpenMode</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.ForRead) </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">as</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MapManager</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">if</font></span><span style="line-height: 11pt"><font color="#000000"> (</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">null</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> != manager)</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; currentMapId = manager.CurrentMapId;</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; isFound = </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">true</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; trans.Commit();</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">catch</font></span><span style="line-height: 11pt"><font color="#000000"> (Autodesk.AutoCAD.Runtime.</font></span><span style="line-height: 11pt; color: "><font color="#2b91af">Exception</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">)</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">&quot;\nUnable to get the current Map's Object ID.&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">);</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">return</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> isFound;</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">public</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">bool</font></span><span style="line-height: 11pt"><font color="#000000"> changeMapName(</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">string</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> name)</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">// Get the Object Id for the current Map</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">ObjectId</font></span><span style="line-height: 11pt"><font color="#000000"> currentMapId = </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">ObjectId</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">();</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">string</font></span><span style="line-height: 11pt"><font color="#000000"> message = </font></span><span style="line-height: 11pt; color: "><font color="#a31515">&quot;&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; Autodesk.AutoCAD.DatabaseServices.</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">TransactionManager</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> TM </font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; = app.ActiveProject.Database.TransactionManager;</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">if</font></span><span style="line-height: 11pt"><font color="#000000"> (!FindCurrentMapId(</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">ref</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> currentMapId))</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">return</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">false</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">try</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">using</font></span><span style="line-height: 11pt"><font color="#000000"> (</font></span><span style="line-height: 11pt; color: "><font color="#2b91af">Transaction</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> trans = TM.StartTransaction())</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">Map</font></span><span style="line-height: 11pt"><font color="#000000"> currentMap = (</font></span><span style="line-height: 11pt; color: "><font color="#2b91af">Map</font></span><span style="line-height: 11pt"><font color="#000000">)trans.GetObject(currentMapId, </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">OpenMode</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.ForWrite);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">// Change the name</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; currentMap.Name = name;</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; trans.Commit();</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">catch</font></span><span style="line-height: 11pt"><font color="#000000"> (Autodesk.AutoCAD.Runtime.</font></span><span style="line-height: 11pt; color: "><font color="#2b91af">Exception</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> ex)</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; message = </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">string</font></span><span style="line-height: 11pt"><font color="#000000">.Format(</font></span><span style="line-height: 11pt; color: "><font color="#a31515">&quot;\nUnable to change name, msg:{0}&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">,</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ex.Message);</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(message);</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">return</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">true</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; }</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">}</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000"></font></font></p> Please note that this method does not work for Map 3D 2013, it throws an exception with error message “eCreateInvalidName”, a change request have been logged, I will update this blog if there are some new information about this.     </div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Get and Set AcMapLayer order using Map 3D Platform API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: get-and-set-acmaplayer-order-using-map-3d-platform-api
CATEGORY: .NET
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/08/get-and-set-acmaplayer-order-using-map-3d-platform-api.html 
DATE: 08/07/2012 10:04:29 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>I am modifying this post with updated details on how to set a FDO Layer Order in Display Manager. Thanks to one of our ADN Partners who pointed out that when we use SetOrder(int value) it is setting the Layer Order as seen under “Groups” but if we active the “Draw Order”, you will find the layer order is unchanged. Let me explain it with some screenshots and how we can actually set the Layer Order which will change the visual display order.</p>
<p>public virtual int <strong>GetOrder()</strong> -&gt; &#0160; &#0160;Member of Autodesk.Gis.Map.Platform.<strong>AcMapLayer</strong></p>
<p>public virtual void <strong>SetOrder(int value)</strong> -&gt; &#0160; &#0160; Member of Autodesk.Gis.Map.Platform.<strong>AcMapLayer</strong></p>
<p><strong><br /></strong></p>
<p>Let&#39;s assume we have three FDO layers as seen in the following screenshot:</p>
<p>&#0160;</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017743fd021e970d-pi" style="display: inline;"><img alt="Layer_Order_1" class="asset  asset-image at-xid-6a0167607c2431970b017743fd021e970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017743fd021e970d-500wi" title="Layer_Order_1" /></a><br /><br /></p>
<p>If you build your application using the following C# code snippet, and run your custom command, you will see the Layer Order is changed under &quot;Groups&quot; -</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (layer.Name == </span><span style="color: #a31515; line-height: 140%;">&quot;City_Boundary&quot;</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// Set Layer Order</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; layer.SetOrder(4);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">msg += </span><span style="color: #a31515; line-height: 140%;">&quot;Layer Name : &quot;</span><span style="line-height: 140%;"> + layer.Name + </span><span style="color: #a31515; line-height: 140%;">&quot;&#0160; &#0160;&#0160; &quot;</span><span style="line-height: 140%;"> + </span><span style="color: #a31515; line-height: 140%;">&quot;Layer Order: &quot;</span><span style="line-height: 140%;"> + layer.GetOrder().ToString() + </span><span style="color: #a31515; line-height: 140%;">&quot;\n&quot;</span><span style="line-height: 140%;">;</span></p>
</div>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01676921efbe970b-pi" style="display: inline;"><img alt="Layer_Order_2" class="asset  asset-image at-xid-6a0167607c2431970b01676921efbe970b" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01676921efbe970b-500wi" title="Layer_Order_2" /></a></p>
<p style="margin: 0px;">&#0160;</p>
<p>&#0160;</p>
<p><span style="font-family: arial, helvetica, sans-serif; font-size: 10pt;">but it&#39;s unchanged when you move to &quot;Draw Order&quot; tab:</span></p>
<p><span style="font-family: arial, helvetica, sans-serif; font-size: 10pt;"><br /></span></p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01761716f38f970c-pi" style="display: inline;"><img alt="Layer_Order_3" class="asset  asset-image at-xid-6a0167607c2431970b01761716f38f970c" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01761716f38f970c-500wi" title="Layer_Order_3" /></a></p>
<p>&#0160;</p>
<p><span style="font-family: arial, helvetica, sans-serif; font-size: 10pt;">Now the question is, how do I change the Draw Order to see the &quot;City_Boundary&quot; goes below and &quot;Roads&quot; come up ? To modify the draw order of a layer, we have to remove it from the layer collection and insert it at the desired index. Here is a relevant code snippet :</span></p>
<p>&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Get the Map Object</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">AcMapMap</span><span style="line-height: 140%;"> currentMap = </span><span style="color: #2b91af; line-height: 140%;">AcMapMap</span><span style="line-height: 140%;">.GetCurrentMap();&#0160; &#0160; &#0160; &#0160;&#0160; </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">//Get layer to Change the Order</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">var</span><span style="line-height: 140%;"> layers = currentMap.GetLayers();</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">var</span><span style="line-height: 140%;"> myLayer = layers.GetItem(</span><span style="color: #a31515; line-height: 140%;">&quot;City_Boundary&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (layers.Remove(myLayer))</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// Int index value should be correct w.r.t number of Layers in Display Manager</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// Otherwise you would see an message &quot; Index is out of range.&quot;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// And the Layer won&#39;t be inserted</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; layers.Insert(2, myLayer);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
<p>&#0160;</p>
<p><span style="font-family: arial, helvetica, sans-serif; font-size: 10pt;">And expected result :</span></p>
<p><span style="font-family: arial, helvetica, sans-serif; font-size: 10pt;"><br /></span></p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01761716f8dc970c-pi" style="display: inline;"><img alt="Layer_Order_4" class="asset  asset-image at-xid-6a0167607c2431970b01761716f8dc970c" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01761716f8dc970c-500wi" title="Layer_Order_4" /></a><br /><br /></p>
<p>&#0160;</p>
<p><span style="font-family: arial, helvetica, sans-serif; font-size: 10pt;">Hope this is useful to you!</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;</p>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Using FDO API to select Features from FDO Data Source
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: using-fdo-api-to-select-features-from-fdo-data-source
CATEGORY: .NET
CATEGORY: AutoCAD Map 3D 2011
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: FDO
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/08/using-fdo-api-to-select-features-from-fdo-data-source.html 
DATE: 08/07/2012 06:41:33 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>Following code snippet demonstrates how to establish a connection using a specific FDO provider (in this case it&#39;s SDF Provider) and then use <strong>FDO.Filter</strong> to query a set of FDO Features based on a specific query condition.</p>
<p>&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="line-height: 140%;">OSGeo.FDO.</span><span style="color: #2b91af; line-height: 140%;">IConnectionManager</span><span style="line-height: 140%;"> connManager = </span><span style="color: #2b91af; line-height: 140%;">FeatureAccessManager</span><span style="line-height: 140%;">.GetConnectionManager();</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">IConnection</span><span style="line-height: 140%;"> conn = connManager.CreateConnection(</span><span style="color: #a31515; line-height: 140%;">&quot;OSGeo.SDF.3.7&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">conn.ConnectionInfo.ConnectionProperties.SetProperty(</span><span style="color: #a31515; line-height: 140%;">&quot;ReadOnly&quot;</span><span style="line-height: 140%;">, </span><span style="color: blue; line-height: 140%;">false</span><span style="line-height: 140%;">.ToString());&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">string</span><span style="line-height: 140%;"> fileName = </span><span style="color: #a31515; line-height: 140%;">@&quot;C:\2013_Release\Map3D_2013\2013_API_Samples\Platform_API\Data\SDF\Roads.sdf&quot;</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">conn.ConnectionInfo.ConnectionProperties.SetProperty(</span><span style="color: #a31515; line-height: 140%;">&quot;File&quot;</span><span style="line-height: 140%;">, fileName);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">conn.Open();</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Create the selection command</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">ISelect</span><span style="line-height: 140%;"> selCmd = (</span><span style="color: #2b91af; line-height: 140%;">ISelect</span><span style="line-height: 140%;">)conn.CreateCommand(</span><span style="color: #2b91af; line-height: 140%;">CommandType</span><span style="line-height: 140%;">.CommandType_Select);&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">Identifier</span><span style="line-height: 140%;"> id = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Identifier</span><span style="line-height: 140%;">(</span><span style="color: #a31515; line-height: 140%;">&quot;Roads&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">selCmd.FeatureClassName = id;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Set a Filter to Select road Lengths greater than 6000 meter</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">OSGeo.FDO.Filter.</span><span style="color: #2b91af; line-height: 140%;">Filter</span><span style="line-height: 140%;"> filter = OSGeo.FDO.Filter.</span><span style="color: #2b91af; line-height: 140%;">Filter</span><span style="line-height: 140%;">.Parse(</span><span style="color: #a31515; line-height: 140%;">&quot;LENGTH &gt; 6000&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">selCmd.Filter = filter;</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">IFeatureReader</span><span style="line-height: 140%;"> ftrRdr = selCmd.Execute();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nStreet name&#0160;&#0160; ---------------&#0160; Length \n&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">while</span><span style="line-height: 140%;"> (ftrRdr.ReadNext())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">string</span><span style="line-height: 140%;"> streetName =&#0160; ftrRdr.GetString(</span><span style="color: #a31515; line-height: 140%;">&quot;ST_NAME&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">double</span><span style="line-height: 140%;"> length = ftrRdr.GetDouble(</span><span style="color: #a31515; line-height: 140%;">&quot;LENGTH&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; ed.WriteMessage(streetName + </span><span style="color: #a31515; line-height: 140%;">&quot;&#0160; &#0160;&#0160; &quot;</span><span style="line-height: 140%;"> + length + </span><span style="color: #a31515; line-height: 140%;">&quot;\n&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">conn.Close();</span></p>
</div>
<p>&#0160;</p>
<p>Hope this is useful to you!</p>
<p>&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Tom DiVittis
EMAIL: tdivittis@cecinc.com
IP: 72.43.34.114
URL: 
DATE: 08/14/2012 01:47:03 PM
Could one of you guys please do a simple example of something like the above, but to an existing connection?
-----
COMMENT:
AUTHOR: Partha
EMAIL: partha.sarkar@autodesk.com
IP: 59.92.145.212
URL: 
DATE: 08/22/2012 07:02:52 AM
Hi Tom,

Please take a look into this :

<a href="http://adndevblog.typepad.com/infrastructure/2012/05/read-fdo-features-using-map-3d-geospatial-platform-api.html">http://adndevblog.typepad.com/infrastructure/2012/05/read-fdo-features-using-map-3d-geospatial-platform-api.html</a>

Thanks,
Partha
-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Remove the Discrepancy Between ArcView/ArcGIS and Map 3D When Deleting Features
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: remove-the-discrepancy-between-arcviewarcgis-and-map-3d-when-deleting-features
CATEGORY: AutoCAD Map 3D 2011
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/08/remove-the-discrepancy-between-arcviewarcgis-and-map-3d-when-deleting-features.html 
DATE: 08/06/2012 01:37:28 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>In last post, I introduced how to d<a href="http://adndevblog.typepad.com/infrastructure/2012/08/deleting-selected-features-in-map-3d-using-apis.html">elete selected features in Map 3D using APIs</a>, some users argue that there is a discrepancy for SHP files when examining the file in ArcGIS, the deleted features in Map 3D still appear in ArcGIS when FDO connection in Map 3D is still open. </p>  <p>To better understand this problem, let’s examine the modification date of files firstly. Following screen-shot is the shp files before deleting in Map 3D:</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017743f24d9f970d-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017743f24db6970d-pi" width="490" height="194" /></a></p>  <p>And following is another screen-shot when the features are deleted in Map 3D using the custom command we introduced in <a href="http://adndevblog.typepad.com/infrastructure/2012/08/deleting-selected-features-in-map-3d-using-apis.html" target="_blank">last post</a>.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017743f24dd2970d-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0167691727d0970b-pi" width="495" height="211" /></a></p>  <p>You may notice that only the *.dbf file is modified, while *.shp does not. </p>  <p>Is this a bug of Map 3D? First, here are some background regarding SHP files and the FDO SHP provider:</p>  <p>· A&#160; DBF record holds the attributes + a Delete flag. When a geometry is deleted <b>this flag is set.</b> The geometry is still in the SHP file but marked for deletion in DBF. If you are interested in the DBF specification, please refer to this <a href="http://www.dbf2002.com/dbf-file-format.html" target="_blank">doc</a>.</p>  <p>· The weird aspect of this flag is that while it is part of the ESRI SHP specification <b>it is ignored</b> by applications like ArcGIS or TatukGis Viewer. </p>  <p>In the past development team made a significant deal of effort to address this issue. They ended up by <b>compressing</b> (i.e. effectively deleting the records) the SHP files (.dbx, .shx, .shp) when the last connection is closed. This is because, obviously, it is non-performant to compress the files for every single deleted feature (these files can be extremely large). o it is as designed, shp file is only compressed when the connection is closed. </p>  <p>But for some reason, customer may want to sync the changes between Map 3D and ArcGIS more frequently, is there any a way to compress the shp explicitly? Unfortunately, there is no such APIs in Map 3D, but since it will be compressed when the connection is closed, how about to close the connection programmatically? Yes, that is the solution. </p>  <p>If you examine the <strong>BuidMap</strong> sample in <a href="http://usa.autodesk.com/adsk/servlet/index?siteID=123112&amp;id=868220" target="_blank">Map 3D ObjectARX SDK</a>, you will understand that the process of creating a connection to FDO datasource and adding layer to map is actually a process of create feature source and layer definition using resource service. So we of cause can disconnect by deleting these resources.</p>  <p>Here is the code snippet: </p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">[</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">CommandMethod</font></span><span style="line-height: 11pt"><font color="#000000">(</font></span><span style="line-height: 11pt; color: "><font color="#a31515">&quot;CloseConnection&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">)]</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">public</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">void</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> CloseConnectionForLayer()</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">{</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">RemoveLayer(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">&quot;Layer1&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">);</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">}</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">public</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">void</font></span><span style="line-height: 11pt"><font color="#000000"> RemoveLayer(</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">string</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> layerName)</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">{</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#2b91af"><font style="font-size: 8pt">Document</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#000000"> doc = </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">Application</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.DocumentManager.MdiActiveDocument;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#2b91af"><font style="font-size: 8pt">Editor</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> ed = doc.Editor;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#2b91af"><font style="font-size: 8pt">Database</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> db = doc.Database;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#2b91af"><font style="font-size: 8pt">AcMapMap</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#000000"> map = </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">AcMapMap</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.GetCurrentMap();</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">// remove the layer</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">var</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> layers = map.GetLayers();</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">if</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> (!layers.Contains(layerName))</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">{</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; ed.WriteMessage(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">&quot;\nLayer does not exist: &quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> + layerName);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">return</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">}</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#2b91af"><font style="font-size: 8pt">MgLayerBase</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> layer = layers.GetItem(layerName);</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">layers.Remove(layer);</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">// remove the layer resource</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#2b91af"><font style="font-size: 8pt">MgResourceIdentifier</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> identifier = layer.LayerDefinition;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#2b91af"><font style="font-size: 8pt">MgResourceService</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> resourceService</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; = </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">AcMapServiceFactory</font></span><span style="line-height: 11pt"><font color="#000000">.GetService(</font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MgServiceType</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.ResourceService)</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">as</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MgResourceService</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">if</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> (resourceService.ResourceExists(identifier))</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; resourceService.DeleteResource(identifier);</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">// remove the feature source</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">identifier = </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MgResourceIdentifier</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">(layer.FeatureSourceId);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">if</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> (resourceService.ResourceExists(identifier))</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; resourceService.DeleteResource(identifier);</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">}</font></font></span></p> </div>  <p>&#160;</p>  <p>By this way, the SHP layer is removed from map and FDO connection is closed, let’s examine the modification data again, the SHP files (.dbx, .shx, .shp) are modified. The result will be synced with ArcGIS now. </p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017743f24e09970d-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0167691727fd970b-pi" width="466" height="206" /></a></p>  <p>If you need to keep working the SHP file in Map 3D, you need to re-create the connection using the way introduced in BuildMap Sample. As you can imagine, this workaround may cause performance issue if you do that very frequently, so please apply it only when necessary. </p>  <p>Hope this helps.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Deleting Selected Features in Map 3D using APIs
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: deleting-selected-features-in-map-3d-using-apis
CATEGORY: AutoCAD Map 3D 2011
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/08/deleting-selected-features-in-map-3d-using-apis.html 
DATE: 08/06/2012 12:55:18 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>Feature editing is probably the most common operation in Map 3D. In this blog I will show you how to delete selected features in Map 3D. Let's dive into the code directly, as the code is pretty self-explanatory. Just please note that you need to commit the changes using aclayer.SaveFeatureChanges(opt):</p>  <p>Here is the code snippet:</p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; [</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">CommandMethod</font></span><span style="line-height: 11pt"><font color="#000000">(</font></span><span style="line-height: 11pt; color: "><font color="#a31515">&quot;DeleteSelectedFeatures&quot;</font></span><span style="line-height: 11pt"><font color="#000000">, </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">CommandFlags</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.UsePickSet</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; | </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">CommandFlags</font></span><span style="line-height: 11pt"><font color="#000000">.Modal | </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">CommandFlags</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.Redraw)]</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">public</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">void</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> DeleteSelectedFeatures()</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">Editor</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> ed = Autodesk.AutoCAD.ApplicationServices</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; .</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">Application</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.DocumentManager.MdiActiveDocument.Editor;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgFeatureService</font></span><span style="line-height: 11pt"><font color="#000000"> _featureService = </font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#2b91af">AcMapServiceFactory</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; .GetService(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgServiceType</font></span><span style="line-height: 11pt"><font color="#000000">.FeatureService) </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">as</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MgFeatureService</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">PromptSelectionResult</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> res = ed.SelectImplied();</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">if</font></span><span style="line-height: 11pt"><font color="#000000"> (</font></span><span style="line-height: 11pt; color: "><font color="#2b91af">PromptStatus</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.OK == res.Status)</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">// Convert the SelectionSet to MgSelectionBase </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">// using AcMapFeatureEntityService. </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">Debug</font></span><span style="line-height: 11pt"><font color="#000000">.Assert(res.Value != </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">null</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">ObjectId</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> entityID = res.Value[0].ObjectId;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">int</font></span><span style="line-height: 11pt"><font color="#000000"> entitytype = </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">AcMapFeatureEntityService</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.GetEntityType(entityID);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">if</font></span><span style="line-height: 11pt"><font color="#000000"> (entitytype == </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">EntityType</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.BulkEntity)</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgSelectionBase</font></span><span style="line-height: 11pt"><font color="#000000"> curSelection = </font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#2b91af">AcMapFeatureEntityService</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; .GetSelection(res.Value);</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">foreach</font></span><span style="line-height: 11pt"><font color="#000000"> (</font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MgLayerBase</font></span><span style="line-height: 11pt"><font color="#000000"> layer </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">in</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> curSelection.GetLayers())</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">string</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> filter = curSelection</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; .GenerateFilter(layer, layer.FeatureClassName);</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">if</font></span><span style="line-height: 11pt"><font color="#000000"> (filter != </font></span><span style="line-height: 11pt; color: "><font color="#a31515">&quot;&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">)</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgFeatureCommandCollection</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> featCommands =</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MgFeatureCommandCollection</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">();</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">string</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> strclassName = layer.FeatureClassName;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgDeleteFeatures</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> delFeat =</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MgDeleteFeatures</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">(strclassName, filter);</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; featCommands.Add(delFeat);</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">try</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">AcMapLayer</font></span><span style="line-height: 11pt"><font color="#000000"> aclayer = layer </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">as</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">AcMapLayer</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgPropertyCollection</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> pProps = aclayer</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; .UpdateFeatures(featCommands);</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">// save and update the layer, commite the changes</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgFeatureQueryOptions</font></span><span style="line-height: 11pt"><font color="#000000"> opt = </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MgFeatureQueryOptions</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">();</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">// build the filter string, this is required for </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">// data source such as Sql Server/Oracle...</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">String</font></span><span style="line-height: 11pt"><font color="#000000"> commitFilter = </font></span><span style="line-height: 11pt; color: "><font color="#a31515">&quot;&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">if</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> (aclayer.IsCached()</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &amp;&amp; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">EditMode</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.EditSet == aclayer.EditMode)</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; commitFilter = </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">ClassSystemProperties</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.FeatureStatus</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; + </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#a31515">&quot; = &quot;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; + </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">ClassSystemProperties</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.FeatureStatusDeleted;</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; opt.SetFilter(commitFilter);</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//This is a must</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; aclayer.SaveFeatureChanges(opt);</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; aclayer.ForceRefresh();</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">catch</font></span><span style="line-height: 11pt"><font color="#000000"> (Autodesk.AutoCAD.Runtime.</font></span><span style="line-height: 11pt; color: "><font color="#2b91af">Exception</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> ex)</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(ex.Message);</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//remove the highlight </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">AcMapFeatureEntityService</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.UnhighlightFeatures(curSelection);</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></span></p> </div>  <p>Here is the screen-shot of running this custom command, user should select some features to be deleted firstly: </p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017743f21e3d970d-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0176170bce72970c-pi" width="441" height="357" /></a></p>  <p>Once the command is executed, the selected feature is deleted: </p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017743f21e72970d-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b016769170049970b-pi" width="437" height="408" /></a></p>  <p>Hope this helps!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Delete Map 3D Object Data Table using ActiveX Automation API 
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: delete-map-3d-object-data-table-using-activex-automation-api-
CATEGORY: AutoCAD Map 3D 2011
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/08/delete-map-3d-object-data-table-using-activex-automation-api-.html 
DATE: 08/06/2012 12:28:31 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>Currently there is no method exposed through Map 3D ActiveX Automation API to delete the Object Data table. We can use the following MAP LISP API functions as a workaround (<strong>ade_oddeletetab </strong><em>tabname</em>)</p>
<p>This function deletes the specified table. You can use <strong>SendCommand</strong> method of document object to invoke this function. The following example shows how to remove a OD Table in Map 3D -&#0160;</p>
<p>&#0160;</p>
<p>Sub f_deleteOdtable(ps_odTableName As String)</p>
<p>&#0160; ThisDrawing.SendCommand (&quot;(ade_oddeletetab &quot;&quot;&quot; &amp; ps_odTableName &amp; &quot;&quot;&quot;) &quot;)</p>
<p>End Sub&#0160;</p>
<p>&#0160;</p>
<p>Sub f_test()</p>
<p>&#0160; Call f_deleteOdtable(&quot;test&quot;)</p>
<p>&#0160; &#39;you must have an object data table by name &quot;test&quot;</p>
<p>End Sub</p>
<p>&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Extract Surface Contours using Civil 3D .NET API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: extract-surface-contours-using-civil-3d-net-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/08/extract-surface-contours-using-civil-3d-net-api.html 
DATE: 08/03/2012 03:31:30 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p><strong>ExtractContours</strong>(double<em> interval</em>) is now available in Civil 3D .NET API and this function extracts the surface contour information from the terrain surface at a specified elevation interval.</p>
<p>Overloaded method <strong>ExtractContours</strong>(<em>double interval, ContourSmoothingType smoothType, int smoothFactor</em>) takes additional inputs - <em>ContourSmoothingType&#0160;</em> that Defines how surface contours are smoothed and smoothFactor;&#0160;<em>smoothFactor</em> should be in the range [0, 10]. A value of 10 generates the smoothest contours.&#0160;</p>
<p>Here is a C# code snippet which demonstrates how to extract contours from a TinSurface in Civil 3D :</p>
<p><span style="color: #2b91af; line-height: 140%;">TinSurface</span><span style="line-height: 140%;"> surface = trans.GetObject(surfaceId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForRead) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">TinSurface</span><span style="line-height: 140%;">;</span></p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Extract contours from the TinSurface</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">ObjectIdCollection</span><span style="line-height: 140%;"> contourIds;</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">double</span><span style="line-height: 140%;"> contourInterval = 10.0;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">contourIds = surface.ExtractContours(contourInterval);</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">for</span><span style="line-height: 140%;"> (</span><span style="color: blue; line-height: 140%;">int</span><span style="line-height: 140%;"> i = 0; i &lt; contourIds.Count; i++)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> contourId = contourIds[i];</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// Contours are lightweight Polyline objects:</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">Polyline</span><span style="line-height: 140%;"> contour = contourId.GetObject(</span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForWrite) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Polyline</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// Let&#39;s set a color and highlight the extracted polylines</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; contour.ColorIndex = i + 1;&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; contour.Highlight();&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">}&#0160; &#0160;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;"> <a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017743e0a122970d-pi" style="display: inline;"><img alt="Contour" class="asset  asset-image at-xid-6a0167607c2431970b017743e0a122970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017743e0a122970d-500wi" title="Contour" /></a><br />&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span></p>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Overrule Civil 3D entities &ndash; Alignment sample
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: using-overrule-with-civil-3d-entities
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D 2013

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/08/using-overrule-with-civil-3d-entities.html 
DATE: 08/02/2012 07:32:16 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>On Civil 3D C++ APIs, we use to have the Custom Draw API to change how some entities were drawn on screen. But that is restrictive and require some Libs (e.g. AeccCustomDraw.lib) not available for every entity. Now starting on AutoCAD 2010, there is a Overrule .NET API that can be implemented to Civil 3D in a very easy way.</p>  <div style="font-family: ; background: white">   <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">' AutoCAD required namespaces</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">Imports</font></font></span><font style="font-size: 8pt" color="#000000"> Autodesk.AutoCAD.GraphicsInterface</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">Imports</font></font></span><font style="font-size: 8pt" color="#000000"> Autodesk.AutoCAD.Geometry</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">Imports</font></font></span><font style="font-size: 8pt" color="#000000"> Autodesk.AutoCAD.DatabaseServices</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">Imports</font></font></span><font style="font-size: 8pt" color="#000000"> Autodesk.AutoCAD.Runtime</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">Imports</font></font></span><font style="font-size: 8pt" color="#000000"> Autodesk.AutoCAD.ApplicationServices</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">' Civil 3D required namespaces</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">Imports</font></font></span><font style="font-size: 8pt" color="#000000"> Autodesk.Civil.DatabaseServices</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">Public</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span><font color="#0000ff">Class</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#2b91af">OverrulePIAlignment</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Inherits</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#2b91af">DrawableOverrule</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Public</font></span><font color="#000000"> </font><span><font color="#0000ff">Overrides</font></span><font color="#000000"> </font><span><font color="#0000ff">Function</font></span><font color="#000000"> WorldDraw( _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">ByVal</font></span><font color="#000000"> drawable </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">Drawable</font></span><font color="#000000">, _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">ByVal</font></span><font color="#000000"> wd </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">WorldDraw</font></span><font color="#000000">) _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">Boolean</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' access the entity as alignment</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> align </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">Alignment</font></span><font color="#000000"> = </font><span><font color="#0000ff">TryCast</font></span><font color="#000000">(drawable, </font><span><font color="#2b91af">Alignment</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' redudant test as the overrule should be applied</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' only to alignments, but for safety if someone else</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' use this routine</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">If</font></span><font color="#000000"> (align </font><span><font color="#0000ff">IsNot</font></span><font color="#000000"> </font><span><font color="#0000ff">Nothing</font></span><font color="#000000">) </font></font><span><font style="font-size: 8pt" color="#0000ff">Then</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> line1 </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">AlignmentLine</font></span><font color="#000000"> = </font></font><span><font style="font-size: 8pt" color="#0000ff">Nothing</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> line2 </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">AlignmentLine</font></span><font color="#000000"> = </font></font><span><font style="font-size: 8pt" color="#0000ff">Nothing</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' use 'old-school' for as we want the entities</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' in order, and the foreach may not work here</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">For</font></span><font color="#000000"> i </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#0000ff">Integer</font></span><font color="#000000"> = 0 </font><span><font color="#0000ff">To</font></span><font color="#000000"> align.Entities.Count - 1</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' get the entity and check if is Line</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> ent </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">AlignmentEntity</font></span><font color="#000000"> = align.Entities. _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; GetEntityByOrder(i)</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">If</font></span><font color="#000000"> (ent.EntityType &lt;&gt; </font><span><font color="#2b91af">AlignmentEntityType</font></span><font color="#000000">.Line) </font></font><span><font style="font-size: 8pt" color="#0000ff">Then</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Continue For</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#008000">' next alignment segment</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">If</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' logic to get 2 line segments</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">If</font></span><font color="#000000"> (line1 </font><span><font color="#0000ff">Is</font></span><font color="#000000"> </font><span><font color="#0000ff">Nothing</font></span><font color="#000000">) </font></font><span><font style="font-size: 8pt" color="#0000ff">Then</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; line1 = ent</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#0000ff">Continue For</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">If</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; line2 = ent</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' ok, now we have two line segments of this alignment</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' as this is a Civil 3D entity, we cannot use geometry</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' methods on it, so create Geometry.Line2d segments</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> l1 </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#0000ff">New</font></span><font color="#000000"> </font><span><font color="#2b91af">Line2d</font></span><font color="#000000">(line1.StartPoint, line1.EndPoint)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> l2 </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#0000ff">New</font></span><font color="#000000"> </font><span><font color="#2b91af">Line2d</font></span><font color="#000000">(line2.StartPoint, line2.EndPoint)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> intersectPoints </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">Point2d</font></span><font color="#000000">() = l1.IntersectWith(l2)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">If</font></span><font color="#000000"> (intersectPoints </font><span><font color="#0000ff">IsNot</font></span><font color="#000000"> </font><span><font color="#0000ff">Nothing</font></span><font color="#000000">) </font></font><span><font style="font-size: 8pt" color="#0000ff">Then</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">If</font></span><font color="#000000"> (intersectPoints.Length = 1) </font></font><span><font style="font-size: 8pt" color="#0000ff">Then</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> center </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#0000ff">New</font></span><font color="#000000"> </font><span><font color="#2b91af">Point3d</font></span><font color="#000000">(intersectPoints(0).X, _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; intersectPoints(0).Y, _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 0) </font></font><span><font style="font-size: 8pt" color="#008000">' 2d only, so Z = 0</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' finally draw a circle on the PI with</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' fixed radius of 5 units</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; wd.Geometry.Circle(center, 5, </font></font><font style="font-size: 8pt"><span><font color="#2b91af">Vector3d</font></span><font color="#000000">.ZAxis)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">If</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">If</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' finally reset the control variables </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; line1 = line2</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; line2 = </font></font><span><font style="font-size: 8pt" color="#0000ff">Nothing</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#0000ff">Next</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">If</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Return</font></span><font color="#000000"> </font><span><font color="#0000ff">MyBase</font></span><font color="#000000">.WorldDraw(drawable, wd)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">Function</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' create this variable as shared in order</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' to avoid duplicates</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Private</font></span><font color="#000000"> </font><span><font color="#0000ff">Shared</font></span><font color="#000000"> _overrulePIAlign </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#2b91af">OverrulePIAlignment</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' the command to turn on and off</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; &lt;</font></font><font style="font-size: 8pt"><span><font color="#2b91af">CommandMethod</font></span><font color="#000000">(</font><span><font color="#a31515">&quot;showPI&quot;</font></span><font color="#000000">)&gt; _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Public</font></span><font color="#000000"> </font><span><font color="#0000ff">Sub</font></span><font color="#000000"> CmdMostrarPIAlinhamento()</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">If</font></span><font color="#000000"> (_overrulePIAlign </font><span><font color="#0000ff">Is</font></span><font color="#000000"> </font><span><font color="#0000ff">Nothing</font></span><font color="#000000">) </font></font><span><font style="font-size: 8pt" color="#0000ff">Then</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' create the overrule</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; _overrulePIAlign = </font></font><font style="font-size: 8pt"><span><font color="#0000ff">New</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#2b91af">OverrulePIAlignment</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">Overrule</font></span><font color="#000000">.AddOverrule( _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">RXClass</font></span><font color="#000000">.GetClass(</font><span><font color="#0000ff">GetType</font></span><font color="#000000">(</font><span><font color="#2b91af">Alignment</font></span><font color="#000000">)), _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; _overrulePIAlign, </font></font><font style="font-size: 8pt"><span><font color="#0000ff">True</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#0000ff">Else</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' remove the overrule</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">Overrule</font></span><font color="#000000">.RemoveOverrule( _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">RXClass</font></span><font color="#000000">.GetClass(</font><span><font color="#0000ff">GetType</font></span><font color="#000000">(</font><span><font color="#2b91af">Alignment</font></span><font color="#000000">)), _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; _overrulePIAlign)</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; _overrulePIAlign = </font></font><span><font style="font-size: 8pt" color="#0000ff">Nothing</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">If</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' regenerate the document in order to apply</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' the changes. This will force and world draw</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">Application</font></span><font color="#000000">.DocumentManager. _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; MdiActiveDocument.Editor.Regen()</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">Sub</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">End</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">Class</font></span></font></p> </div>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b016769007e65970b-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="overrule_alignment" border="0" alt="overrule_alignment" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017616f542eb970c-pi" width="448" height="305" /></a></p>  <p>Notice that the circle at the PI appears even while the Alignment is being dragged/moved, so keep an eye on performance and avoid extreme calculations inside this overrule.</p>  <p>Another interesting point is that this Overrule API also applies to other behaviors, like Explode or GripPoints, and it can be implemented on the same way, such as a custom explode for specific Civil 3D entities.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Sergey Makarov
EMAIL: sergey_a_makarov@mail.ru
IP: 89.223.5.154
URL: 
DATE: 12/28/2012 01:06:15 AM
Hello Augusto!
I have a Large Problem with GripOverrule of Alignment - Fatal Error.

When I start move the mouse after hover on a grip point which created by GripDataCollection.Add(myGripData) in GetGripPoints(Entity entity, GripDataCollection grips, ...) appears Fatal Error: Unhandled e0434353h Exception at fdbebccdh.
 
I try Overrule GripPoints for Alignment. For FeatureLine it works.
Possible, the reason is that Alignment is AlignmentEntityCollection and different approach is required.
 
Please help me to solve the problem.

public class GripVectorOverrule : GripOverrule
{
    static public GripVectorOverrule theOverrule =
        new GripVectorOverrule();
 
    public override void GetGripPoints(
        Entity entity, 
        GripDataCollection grips,
        double curViewUnitSize,
        int gripSize,
        Vector3d curViewDir,
        GetGripPointsFlags bitFlags)
    {
        myGripData data = new myGripData();
        data.GripPoint = newPoint3d(0.0, 0.0, 0.0);
        grips.Add(data);
    }
}
 
public class myGripData  :  GripData
{
    public bool result;
 
    public myGripData()
    {
        result = false;
        base.DrawAtDragImageGripPoint = true;
        base.RubberBandLineDisabled = true;
    }

    //try change AutoDelete to false
    public new bool AutoDelete
    {
        get { return result; }
    }
}
 
[CommandMethod("Test")]
public void OverruleStart()
{
    ObjectOverrule.AddOverrule(
        RXClass.GetClass(typeof(Alignment)),
        GripVectorOverrule.theOverrule, true);
}
-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 200.57.88.172
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 01/30/2013 03:34:18 AM
Hi Makarov,

As we discussed on the forum, this is not supported due Civil3D way to implement its grips points. 

<a href="http://forums.autodesk.com/t5/AutoCAD-Civil-3D-Customization/Alignment-GripOverrule-Fatal-Error/td-p/3743082">http://forums.autodesk.com/t5/AutoCAD-Civil-3D-Customization/Alignment-GripOverrule-Fatal-Error/td-p/3743082</a>

Regards,
Augusto Goncalves
-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: 'Add' is not a member of 'Autodesk.AutoCAD.ApplicationServices.DocumentCollection'
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: add-is-not-a-member-of-autodeskautocadapplicationservicesdocumentcollection
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/08/add-is-not-a-member-of-autodeskautocadapplicationservicesdocumentcollection.html 
DATE: 08/01/2012 10:58:44 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>If you are migrating your application from 2012/2011/2010 or older releases to 2013 release and in your application you use acDocMgr.<strong>Add</strong>(strTemplatePath) Or doc.<strong>CloseAndSave</strong>() as given in the example code snippet in AutoCAD Civil 3D 2013 <a href="http://docs.autodesk.com/CIV3D/2013/ENU/index.html?url=filesACD/GUID-330A8DCB-626F-4271-8B89-9773A7631D87.htm,topicNumber=ACDd30e702843" target="_self">online documentation</a>, you might have notice Visual Studio shows error like :&#0160;</p>
<p>&#39;Add&#39; is not a member of &#39;Autodesk.AutoCAD.ApplicationServices.DocumentCollection&#39;.&#0160;</p>
<p>&#39;CloseAndSave&#39; is not a member of &#39;Autodesk.AutoCAD.ApplicationServices.Document&#39;.&#0160;</p>
<p>In 2013 release, there are some changes in AutoCAD .NET; we have added some namespaces to house extension methods like- DocumentExtension, DocumentCollectionExtension etc. Details are available in ObjectARX for AutoCAD 2013 Docs: Managed Class Reference -&gt; Migration Guide-&gt;.NET Migration Guide.</p>
<p>&#0160;</p>
<p>To resolve above mentioned errors in Visual Studio, simply add the following namespaces to your project (VB.NET).</p>
<p>&#0160;</p>
<p>Imports <strong>Autodesk.AutoCAD.ApplicationServices.DocumentCollectionExtension</strong></p>
<p>Imports <strong>Autodesk.AutoCAD.ApplicationServices.DocumentExtension</strong></p>
<p>&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Dan
EMAIL: daniel.butch@emerson.com
IP: 144.191.148.3
URL: 
DATE: 08/08/2012 09:43:54 AM
Thanks
-----
COMMENT:
AUTHOR: Partha
EMAIL: partha.sarkar@autodesk.com
IP: 59.92.145.212
URL: 
DATE: 08/22/2012 07:27:38 AM
You are welcome Dan !

Cheers,
Partha
-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Get Character while Pressing Shift Key using JavaScript
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: get-character-while-pressing-shift-key-using-javascript
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: Daniel Du
CATEGORY: MapGuide Enterprise 2011
CATEGORY: Web

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/07/get-character-while-pressing-shift-key-using-javascript.html 
DATE: 07/31/2012 10:30:05 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>I am asked how to get the character using JavaScript when pressing Shift key, String.fromCharCode() does not take into account the shift modifier, you can only get the number “5” but actually you want to get the special character “%&quot;. </p>  <p>This is much be a very common request for web developers like developers working on AIMS, and I searched a little and find <a href="http://stackoverflow.com/questions/3337188/get-key-char-value-from-keycode-with-shift-modifier" target="_blank">this page</a> is very helpful. One customer argues that it does not work for Safari, I did a test, it does work for Safari and other browsers, including Firefox, Chrome and IE. </p>  <p>Here is my test code: </p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">&lt;</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#800000">html</font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">&lt;</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#800000">head</font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">&lt;</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#800000">title</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">&gt;</font></span><span style="line-height: 11pt"><font color="#000000">mapKeyPressToActualCharacter test</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">&lt;/</font></span><span style="line-height: 11pt; color: "><font color="#800000">title</font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">&lt;</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#800000">script</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#ff0000">language</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">=&quot;javascript&quot;</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#ff0000">type</font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">=&quot;text/javascript&quot;&gt;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">function</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> onKeyPress() {</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">var</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> e = window.event || e;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">var</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> keyCode = e.keyCode;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">if</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> (keyCode == 8) {</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">this</font></span><span style="line-height: 11pt"><font color="#000000">.criteria.value = </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">this</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.criteria.value.substring(</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 0, </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">this</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.criteria.value.length - 1);</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">else</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> {</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">this</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.criteria.value </font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; += mapKeyPressToActualCharacter(event.shiftKey, keyCode);</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">function</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> mapKeyPressToActualCharacter(isShiftKey, characterCode) {</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">if</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> (characterCode === 27</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; || characterCode === 8</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; || characterCode === 9</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; || characterCode === 20</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; || characterCode === 16</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; || characterCode === 17</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; || characterCode === 91</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; || characterCode === 13</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; || characterCode === 92 </font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; || characterCode === 18) {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">return</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">false</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">if</font></span><span style="line-height: 11pt"><font color="#000000"> (</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">typeof</font></span><span style="line-height: 11pt"><font color="#000000"> isShiftKey != </font></span><span style="line-height: 11pt; color: "><font color="#800000">&quot;boolean&quot;</font></span><span style="line-height: 11pt"><font color="#000000"> || </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">typeof</font></span><span style="line-height: 11pt"><font color="#000000"> characterCode != </font></span><span style="line-height: 11pt; color: "><font color="#800000">&quot;number&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">) {</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">return</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">false</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">var</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> characterMap = [];</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; characterMap[192] = </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#800000">&quot;~&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; characterMap[49] = </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#800000">&quot;!&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; characterMap[50] = </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#800000">&quot;@&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; characterMap[51] = </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#800000">&quot;#&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; characterMap[52] = </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#800000">&quot;$&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; characterMap[53] = </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#800000">&quot;%&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; characterMap[54] = </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#800000">&quot;^&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; characterMap[55] = </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#800000">&quot;&amp;&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; characterMap[56] = </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#800000">&quot;*&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; characterMap[57] = </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#800000">&quot;(&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; characterMap[48] = </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#800000">&quot;)&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; characterMap[109] = </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#800000">&quot;_&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; characterMap[107] = </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#800000">&quot;+&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; characterMap[219] = </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#800000">&quot;{&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; characterMap[221] = </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#800000">&quot;}&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; characterMap[220] = </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#800000">&quot;|&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; characterMap[59] = </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#800000">&quot;:&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; characterMap[222] = </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#800000">&quot;\&quot;&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; characterMap[188] = </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#800000">&quot;&lt;&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; characterMap[190] = </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#800000">&quot;&gt;&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; characterMap[191] = </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#800000">&quot;?&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; characterMap[32] = </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#800000">&quot; &quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">var</font></span><span style="line-height: 11pt"><font color="#000000"> character = </font></span><span style="line-height: 11pt; color: "><font color="#800000">&quot;&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">if</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> (isShiftKey) {</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">if</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> (characterCode &gt;= 65 &amp;&amp; characterCode &lt;= 90) {</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; character = String.fromCharCode(characterCode);</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; } </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">else</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> {</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; character = characterMap[characterCode];</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; } </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">else</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> {</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">if</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> (characterCode &gt;= 65 &amp;&amp; characterCode &lt;= 90) {</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; character = String.fromCharCode(characterCode).toLowerCase();</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; } </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">else</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> {</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; character = String.fromCharCode(characterCode);</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">return</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> character;</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">&lt;/</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#800000">script</font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">&lt;/</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#800000">head</font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">&lt;</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#800000">body</font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">&lt;</font></span><span style="line-height: 11pt; color: "><font color="#800000">input</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#ff0000">name</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">=&quot;test&quot;</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#ff0000">type</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">=&quot;text&quot;</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#ff0000">onkeypress</font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">=&quot;onKeyPress();&quot;/&gt;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">&lt;/</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#800000">body</font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">&lt;/</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#800000">html</font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font></p> </div>  <p>&#160;</p>  <p>And here is my test result:</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017616ecbc84970c-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="TestResult" border="0" alt="TestResult" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017743d32789970d-pi" width="529" height="429" /></a></p>  <p>&#160;</p>  <p>Hope this helps.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Installing Autodesk Infrastructure Map Server 2013 step by step on Windows Server 2008
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: installing-autodesk-infrastructure-map-server-2013-step-by-step-on-windows-server-2008
CATEGORY: AIMS 2013
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/07/installing-autodesk-infrastructure-map-server-2013-step-by-step-on-windows-server-2008.html 
DATE: 07/31/2012 02:50:21 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>A few months ago, I blogged an post about “<a href="http://adndevblog.typepad.com/infrastructure/2012/04/install-autodesk-infrastructure-map-server-2013-step-by-step.html">Install Autodesk Infrastructure Map Server 2013 step by step</a>” on Windows 7, and someone argues that Windows 7 is not officially supported OS for AIMS. Yes, he is right, so in this post, I will show you how to install AIMS 2013 in Windows Server 2008.</p>  <p>&#160;</p>  <h2>Before Installation</h2>  <p>Before you start, please read the “Installation Help”,&quot;System Requirement&quot; and &quot;ReadMe&quot; first. Documentation is accessible from links at the lower left corner of the installer: </p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b016768f2ad99970b-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b016768f2ada2970b-pi" width="404" height="66" /></a></p>  <p>Ensure that your user name has Administrator permissions to install applications on the computer or network.</p>  <p>AIMS 2013 supports both Windows and Linux. Since you come across this blog, you are probably using Windows. For the Infrastructure Map Server Extension, you can use both PHP and .NET on Windows, but if you are going to use Infrastructure Application Extension, .NET is the only option.&#160; Here is a table about development language and web server extension configuration. </p>  <p>Language&#160;&#160;&#160; OS&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Web Server Extension</p>  <p>-----------------------------------------------------------------------------</p>  <p>.net&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Windows&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; IIS Configuration with .net</p>  <p>php&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Windows&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; IIS Configuration with php</p>  <p>php&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Linux&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Apache with php</p>  <p>Java&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Windows&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Apache/Tomcat with Java</p>  <p>Java&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Linux&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Apache/Tomcat with Java</p>  <p>------------------------------------------------------------------------------</p>  <p>In this post, I will use Windows(IIS) + .NET configuration. </p>  <p>Firstly, please add “Web Server(IIS)” role in Server Manager if you have not done that, make sure all Application Development role services are installed: </p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017616e77a3c970c-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b016768f2adb0970b-pi" width="490" height="395" /></a></p>  <p>&#160;</p>  <h2>Start Installation</h2>  <p>Now let’s begin, you will see this screen after the setup is launched, please do take some time reading the Installation Help, System Requirement and Readme. Click “Install” to continue.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b016768f2adc3970b-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017616e77a77970c-pi" width="446" height="343" /></a></p>  <p>Read and accept the license agreement:</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0163038c1702970d-pi"><img title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0163038c1714970d-pi" width="448" height="369" /></a></p>  <p>Input your serial number and product key if you have one, otherwise you can select the first option to try this product for 30 days.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0163038c171f970d-pi"><img title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0163038c1729970d-pi" width="448" height="369" /></a></p>  <p><strong>Caution</strong>! Do not go too fast in this page. You need to click each item to open the configuration page, otherwise it will install with default configuration.</p>    <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0168e9822f42970c-pi">     <br /><img title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0168e9822f4b970c-pi" width="459" height="377" /></a></p>  <p>Click “Autodesk Infrastructure Map Server 2013” to open the server configuration page as below. You can install Map Server and Web Extension on same machine or separate machines.</p>  <p><img title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0163038c1784970d-pi" width="466" height="383" /></p>  <p>For “Autodesk Infrastructure Web Server Extension 2013”, as discussed earlier, I am going to use IIS Configuration with .NET Development Environment:</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017616e77a82970c-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017743cdcfde970d-pi" width="465" height="359" /></a></p>  <p>You can install “Autodesk Infrastructure Studio 2013” in next page. In this case, I will skep Infrastructure Studio as I am planning to author my map data from another client PC, not from the Server itself.&#160; You can also install “Autodesk Infrastructure Application Extension 2013” and “Autodesk Infrastructure Administrator 2013” if you are going to use industry model.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017616e77aa2970c-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017616e77ab8970c-pi" width="471" height="366" /></a></p>  <p>Now it is all set, you can sit back to have a cup of coffee now.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017616e77acb970c-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b016768f2ae3c970b-pi" width="469" height="362" /></a></p>  <p>A few minutes latter, the product will be installed successfully.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017616e77aec970c-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b016768f2ae66970b-pi" width="471" height="366" /></a></p>  <p>&#160;</p>              <h2>License Activation</h2>  <p>Unlike other Autodesk products, Autodesk Infrastructure Map Server 2013 does not start the activation process when you launch the program for the first time. You must manually activate Infrastructure Map Server by clicking Start <a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0163038c1863970d-pi"><img title="ac.menuaro" border="0" alt="ac.menuaro" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01676480f211970b-pi" width="17" height="11" /></a> Programs (or All Programs) <a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0168e9823033970c-pi"><img title="ac.menuaro[1]" border="0" alt="ac.menuaro[1]" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0163038c1876970d-pi" width="17" height="11" /></a> Autodesk <a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0168e9823038970c-pi"><img title="ac.menuaro[2]" border="0" alt="ac.menuaro[2]" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0168e9823042970c-pi" width="17" height="11" /></a> Autodesk Infrastructure Map Server 2013 <a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01676480f221970b-pi"><img title="ac.menuaro[3]" border="0" alt="ac.menuaro[3]" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0163038c188b970d-pi" width="17" height="11" /></a> Autodesk Infrastructure Map Server 2013 Licensing Activator.</p>  <p><a name="GUID-5B0CE3B1-1733-4C55-BD0B-FCBDF39957C0"></a>The Autodesk Licensing wizard is started where you can follow the on-screen instructions to activate your Autodesk Infrastructure Map Server 2013 license.</p>  <p>&#160;</p>  <h2>Verifying the Configuration</h2>  <p>You can run some simple tests to ensure that the Map Agent and Web Server Extensions are configured properly.</p>  <h6>Testing the Map Agent</h6>  <p>Ensure that the Infrastructure Map Server is running. The installer configures Infrastructure Map Server as a service. Open Services Management Console by typing “Services.msc” in Start—&gt;Run, check that the service status is Started.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017616e77b0c970c-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017743cdd084970d-pi" width="458" height="223" /></a></p>  <p>Open a web browser and go to the following URL. If the Web Server Extensions are not running on your local machine, replace localhost with the name or IP address of your server.</p>  <p><a name="GUID-6DA14D45-775E-4AAF-B10F-9891DEB26C43"></a></p>  <p><a href="http://localhost/mapserver2013/mapagent/index.html(IIS">http://localhost/mapserver2013/mapagent/index.html(IIS</a>)</p>  <p>Click one test method, for example, “Features” in Service API, then “GetFeatureProviders”, it will get all register FDO providers. Enter Administrator for the user id and admin for the password. Both are case-sensitive.</p>  <p><a name="WS73099CC142F487551259E26112442A7ABB526"></a>If the Map Agent is running properly, you will get an XML document describing the resources in the repository.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01676480f276970b-pi"><img title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01676480f28a970b-pi" width="525" height="323" /></a></p>  <h6>Testing the Site Administrator</h6>  <p>Ensure that the Map Server is running. Open a web browser and go to the following URL.</p>  <p><a name="GUID-EA57710D-ABFF-4729-A524-A031730AFC9E"></a></p>  <p><a href="http://localhost/mapserver2013/mapadmin/login.php(IIS">http://localhost/mapserver2013/mapadmin/login.php(IIS</a>)</p>  <p>Enter Administrator for the user id and admin for the password. Both are case-sensitive.</p>  <p><a name="WS73099CC142F487551259E26112442A7ABB52C"></a>If the Site Administrator is configured properly, you will get a Manage Servers page which lists all the servers configured in the Map Server Site.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0168e9823077970c-pi"><img title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0163038c18c3970d-pi" width="452" height="359" /></a></p>      <p>&#160;</p>  <h2>Common Errors/Problems:</h2>  <p>This part is same as “<a href="http://adndevblog.typepad.com/infrastructure/2012/04/install-autodesk-infrastructure-map-server-2013-step-by-step.html">Install Autodesk Infrastructure Map Server 2013 step by step</a>”, here is a screen-shot of IIS setting which works fine for me: </p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017616e77b24970c-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017743cdd09a970d-pi" width="460" height="219" /></a></p>  <p>&#160;</p>  <h2>Publish Map to Map Server from Map 3D</h2>  <p>It is possible to publish maps, including native DWG files to Infrastructure Map Server from Map 3D very easily, just open the map in Map 3D, and select “Publish to Infrastructure Map Server…” in Maps menu.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b016768f2aea0970b-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b016768f2aeab970b-pi" width="344" height="318" /></a></p>  <p>Specify the site of Map Server 2013:</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017616e77b4b970c-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017616e77b58970c-pi" width="478" height="350" /></a></p>  <p>Here is notification saying that I have successfully published 1 DWG and some other data.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017616e77b64970c-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b016768f2aecb970b-pi" width="442" height="173" /></a></p>  <h2>&#160;</h2>  <h2>Connect to Map Server from Infrastructure Studio 2013</h2>  <p>I did not install Infrastructure Studio on Windows Server 2008, as I an going to do the authoring work from my laptop. Now I can connect to the Map Server from Infrastructure Studio 2013, which is installed separately. From Infrastructure Studio, I can see the data which I just published from Map 3D:</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017743cdd0e3970d-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017743cdd0f6970d-pi" width="498" height="330" /></a></p>  <p>&#160;</p>  <p>And here is the screen-shot of map in browser: </p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017743cdd122970d-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017743cdd138970d-pi" width="492" height="348" /></a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Download Autodesk Infrastructure Map Server API training material
STATUS: Draft
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: download-autodesk-infrastructure-map-server-api-training-material
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: Daniel Du
CATEGORY: MapGuide Enterprise 2011

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/07/download-autodesk-infrastructure-map-server-api-training-material.html 
DATE: 07/30/2012 08:24:27 PM
-----
BODY:
<p>By&#0160;<a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>
<p>If you are interested in Autodesk Infrastructure Map server API development and what to know more, your first stop should be <a href="http://www.autodesk.com/developmapguide" target="_blank">Autodesk developer center</a>, where you can find DevTVs, webcasts, samples and documentation. You will also want to check our training schedule and archived list of webcasts at <a href="http://www.adskconsulting.com/adn/cs/api_course_webcast_archive.php" title="http://www.adskconsulting.com/adn/cs/api_course_webcast_archive.php">http://www.adskconsulting.com/adn/cs/api_course_webcast_archive.php</a>&#0160;</p>
<p>Beside the resources on developer center, here are some other resources, including the PPTs we were using when delivering classroom training, and code samples, they are based on AIMS2012, but still applied to AIMS2013.</p>
<p><a href="http://download.autodesk.com/media/adn/AIMS_Sample_DevTV_Solution_5_6/MapGuideSamples2012.zip">MapGuide Samples 2012</a> <em>(zip - 22.5 MB)</em></p>
<p><a href="http://download.autodesk.com/media/adn/AIMS_Sample_DevTV_Solution_5_6/AIMSSample_DevTV_Solution5.zip">AIMS Sample DevTV Solution 5</a> <em>(zip - 17.1 MB)</em></p>
<p><a href="http://download.autodesk.com/media/adn/AIMS_Sample_DevTV_Solution_5_6/AIMSSample_DevTV_Solution6.zip">AIMS Sample DevTV Solution 6</a> <em>(zip - 21.7 MB)</em></p>
<p><em><a href="http://adndevblog.typepad.com/files/en_mge_api_2012_complete.pptx"> <span class="asset  asset-generic at-xid-6a0167607c2431970b017616ba452f970c">Download traning PPT :&#0160; <span class="asset  asset-generic at-xid-6a0167607c2431970b016768f11f54970b">EN_AIMS_API_2012_complete&#0160;</span></span></a>&#0160;(zip -- 18.5MB)<br /></em></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Verify if a FDO feature attribute is 'empty' using Map 3D API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: verify-if-a-fdo-feature-attribute-is-empty-using-map-3d-api
CATEGORY: .NET
CATEGORY: AutoCAD Map 3D 2011
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/07/verify-if-a-fdo-feature-attribute-is-empty-using-map-3d-api.html 
DATE: 07/27/2012 06:57:23 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>In the screenshot below, we can see the Name attribute of two features are Empty. In my FDO data set I have hundreds of thousands of features and I would like to find out if any attribute is empty (i.e. there is no Value) for selected features in Map 3D using API.</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017743adcc88970d-pi" style="display: inline;"><img alt="FDO_1" class="asset  asset-image at-xid-6a0167607c2431970b017743adcc88970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017743adcc88970d-500wi" title="FDO_1" /></a><br /><br />&#0160;</p>
<p>&#0160;</p>
<p>Here is a relevant C# code snippet in Map 3D which will check if the “Name” attribute of any selected Feature is Empty and if it is Empty, it will show the Feature ID and a message that “Name Attribute is Empty “ at the Map 3D command Line.</p>
<p>&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">AcMapMap</span><span style="line-height: 140%;"> currentMap = </span><span style="color: #2b91af; line-height: 140%;">AcMapMap</span><span style="line-height: 140%;">.GetCurrentMap();</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">MgLayerCollection</span><span style="line-height: 140%;"> layers = currentMap.GetLayers();</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">PromptSelectionResult</span><span style="line-height: 140%;"> selResult = ed.GetSelection();</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (selResult.Status == </span><span style="color: #2b91af; line-height: 140%;">PromptStatus</span><span style="line-height: 140%;">.OK)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">SelectionSet</span><span style="line-height: 140%;"> selSet = selResult.Value;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">MgSelectionBase</span><span style="line-height: 140%;"> selectionBase = </span><span style="color: #2b91af; line-height: 140%;">AcMapFeatureEntityService</span><span style="line-height: 140%;">.GetSelection(selSet);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">//Ensure user selected a feature</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">MgLayerBase</span><span style="line-height: 140%;"> myLayer = </span><span style="color: blue; line-height: 140%;">null</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">foreach</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">MgLayerBase</span><span style="line-height: 140%;"> layer </span><span style="color: blue; line-height: 140%;">in</span><span style="line-height: 140%;"> selectionBase.GetLayers())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (layer.Name == </span><span style="color: #a31515; line-height: 140%;">&quot;API_Poly_Objects&quot;</span><span style="line-height: 140%;">)&#0160;&#0160; </span><span style="color: green; line-height: 140%;">// change to your own layer name</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; myLayer = layer;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">break</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (myLayer == </span><span style="color: blue; line-height: 140%;">null</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;No Feature is selected from the designated Layer ! &quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">return</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; }</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">//get the properties </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">MgFeatureReader</span><span style="line-height: 140%;"> reader = selectionBase.GetSelectedFeatures(myLayer, myLayer.FeatureClassName, </span><span style="color: blue; line-height: 140%;">false</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">try</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">while</span><span style="line-height: 140%;"> (reader.ReadNext())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">string</span><span style="line-height: 140%;"> featureName = reader.GetString(</span><span style="color: #a31515; line-height: 140%;">&quot;Name&quot;</span><span style="line-height: 140%;">);&#0160; </span><span style="color: green; line-height: 140%;">// this this just a demo, change this according to your data field</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (featureName == </span><span style="color: #a31515; line-height: 140%;">&quot;&quot;</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">Int32</span><span style="line-height: 140%;"> FeatureID = reader.GetInt32(</span><span style="color: #a31515; line-height: 140%;">&quot;ID&quot;</span><span style="line-height: 140%;">);&#0160; </span><span style="color: green; line-height: 140%;">// this this just a demo, change this according to your data field</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\n Feature ID :&quot;</span><span style="line-height: 140%;"> + FeatureID.ToString() + </span><span style="color: #a31515; line-height: 140%;">&quot; Name Attribute is Empty &quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">finally</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; reader.Close();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
<p>&#0160;</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017743adcbf3970d-pi" style="display: inline;"><img alt="FDO_2" class="asset  asset-image at-xid-6a0167607c2431970b017743adcbf3970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017743adcbf3970d-500wi" title="FDO_2" /></a></p>
<p>Hope this is useful to you!</p>
<p>&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: How do we set the FDO feature attribute value to NULL <Null> using Map 3D API ?
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: how-do-we-set-the-fdo-feature-attribute-value-to-null-using-map-3d-api-
CATEGORY: .NET
CATEGORY: AutoCAD Map 3D 2011
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/07/how-do-we-set-the-fdo-feature-attribute-value-to-null-using-map-3d-api-.html 
DATE: 07/27/2012 02:43:29 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>In AutoCAD Map 3D UI, when we open the &quot;Data Table&quot; corresponding to a FDO feature layer and delete an attribute value for a FDO feature, it is set to <strong>&lt;Null&gt;</strong> as shown in the screenshot below.</p>
<p>&#0160;</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b016768d0ad0f970b-pi" style="display: inline;"><img alt="FDO_Set_Null_01" class="asset  asset-image at-xid-6a0167607c2431970b016768d0ad0f970b" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b016768d0ad0f970b-500wi" title="FDO_Set_Null_01" /></a></p>
<p>&#0160;</p>
<p>&#0160;</p>
<p>Using the Map 3D Platform API&#0160; <strong>SetNull(</strong><em>bIsNull As <strong>Boolean</strong></em><strong>)</strong> we can &#0160;achieve the same.</p>
<p>Here is a relevant code snippet :</p>
<p>&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">&#39; Create a new Property colleaction Object</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> propColl </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">MgPropertyCollection</span><span style="line-height: 140%;"> = </span><span style="color: blue; line-height: 140%;">New</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">MgPropertyCollection</span><span style="line-height: 140%;">()</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">&#39; Here the Length Prop is specific to a Data Set</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> lengthProp </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">MgDoubleProperty</span><span style="line-height: 140%;"> = </span><span style="color: blue; line-height: 140%;">New</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">MgDoubleProperty</span><span style="line-height: 140%;">(</span><span style="color: #a31515; line-height: 140%;">&quot;Length&quot;</span><span style="line-height: 140%;">, </span><span style="color: blue; line-height: 140%;">Nothing</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">&#39; To set the attribute value to &lt;Null&gt; we need to use the following method</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">lengthProp.SetNull(</span><span style="color: blue; line-height: 140%;">True</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">&#39;Add the length property to property collection</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">propColl.Add(lengthProp)</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">&#39; Define a filter to get the object whose property we want to update</span></p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">&#39;&#39; Feature ID = 10 is specific a FDO data set</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> filterText </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">String</span><span style="line-height: 140%;"> = </span><span style="color: #a31515; line-height: 140%;">&quot;ID=10&quot;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">&#39;Create the UpdateFeatures object for the update</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> updateFeatures </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">MgUpdateFeatures</span><span style="line-height: 140%;"> = </span><span style="color: blue; line-height: 140%;">New</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">MgUpdateFeatures</span><span style="line-height: 140%;">(layer.FeatureClassName, propColl, filterText)</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">&#39; Create a command collection for the update</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> commands </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">MgFeatureCommandCollection</span><span style="line-height: 140%;"> = </span><span style="color: blue; line-height: 140%;">New</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">MgFeatureCommandCollection</span><span style="line-height: 140%;">()</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">commands.Add(updateFeatures)</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">&#39; Commit the Update</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">fs.UpdateFeatures(resId, commands, </span><span style="color: blue; line-height: 140%;">True</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">layer.ForceRefresh()</span></p>
</div>
<p>&#0160;</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017616c59a20970c-pi" style="display: inline;"><img alt="FDO_Set_Null_02" class="asset  asset-image at-xid-6a0167607c2431970b017616c59a20970c" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017616c59a20970c-500wi" title="FDO_Set_Null_02" /></a></p>
<p>&#0160;</p>
<p>Hope this is useful to you!</p>
<p>&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Autodesk Infrastructure Map Server 2013 &ndash;New Features &amp; API Recording
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: autodesk-infrastructure-map-server-2013-new-features-api-recording
CATEGORY: AIMS 2013
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/07/autodesk-infrastructure-map-server-2013-new-features-api-recording.html 
DATE: 07/26/2012 06:50:34 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>We completed the recording of new features and APIs of AIMS 2013. We are not hosting a separate &quot;Live Q &amp; A&quot; session on AIMS 2013 API; you can use the comment section here to ask your question on AIMS 2013 API, alternatively you can use <a href="http://forums.autodesk.com/t5/Autodesk-MapGuide-Enterprise/bd-p/234" target="_blank">Autodesk MapGuide Enterprise Developer discussion forum</a> to post your question. Those who have access to <a href="https://partnercenter.autodesk.com/siebel/prmportal_enu_eidm/">Partner Center</a>, please use the same to ask your question and we will respond to that.</p>  <p>Here is the link to download :&#160; <a href="http://download.autodesk.com/media/adn/AIMS2013_Webcast_English.zip" target="_blank">AIMS 2013 New Features &amp; APIs recording.</a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Localization of Ajax viewer of MapGuide Enterprise/AIMS
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: localization-of-ajax-viewer-of-mapguide-enterpriseaims
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: Daniel Du
CATEGORY: MapGuide Enterprise 2011

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/07/localization-of-ajax-viewer-of-mapguide-enterpriseaims.html 
DATE: 07/26/2012 12:18:29 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>Many developers are trying to localize viewer of MapGuide or AIMS to make it more user-friendly. Here are the basic steps to localize MapGuide Enterprise, This blog is based on MapGuide Enterprise 2011, it applies to AIMS as well with minor changes.</p>  <p>1. Prepare the resource file, which locates at C:\Program Files\Autodesk\MapGuideEnterprise2011\WebServerExtensions\www\localized by default.</p>  <p>2. Copy the file en to a new one named as zh for Chinese, fr for France, for example. Put it into the same directory. Please be note that this is NO extension for this file.</p>  <p>3. Open the copied resource file and translate the message into local language.</p>  <p>4. Save the file, please save it using Unicode if needed, especially for East Asian language.</p>  <p>5. Pass the locale parameter to the Ajax viewer.</p>  <p>&lt;frameset rows=&quot;0,*&quot; border=&quot;0&quot; framespacing=&quot;0&quot;&gt;    <br />&lt;frame /&gt;     <br />&lt;frame src=&quot;/mapguide2011/mapviewernet/ajaxviewer.aspx?SESSION=&lt;%= sessionId %&gt;&amp;WEBLAYOUT=&lt;%= webLayout %<b>&gt;&amp;Locale=zh</b>&quot; name=&quot;ViewerFrame&quot; /&gt;     <br />&lt;/frameset&gt;</p>  <p>6. For these build-in commands, it can be localized by substitute the built-in commands by “Add –&gt; Built-In Command” and localizing the display name and tooltip in MapGuide Studio.</p>  <p>Add Build-in Commands in MapGuide Studio</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0177439f87cf970d-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b016768c44cdf970b-pi" width="444" height="319" /></a></p>  <p>Localize display name and tooltip</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017616b93184970c-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017616b9319d970c-pi" width="438" height="457" /></a></p>  <p>That's it, now your interface is localized!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Setting coordinate system for map using .net API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: setting-coordinate-system-for-map-using-net-api
CATEGORY: AutoCAD Map 3D 2011
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/07/setting-coordinate-system-for-map-using-net-api.html 
DATE: 07/23/2012 03:25:02 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p><b>Issue</b></p>  <p>Using GetMapSRS() API we can get the coordinate system of map, but I am not finding any API to assign a coordinate system to the <i>AcMapMap</i> object. Am I missing something or is it not allowed to assign a CS to <i>AcMapMap</i> ?</p>  <p><a name="section2"></a></p>  <p><b>Solution</b></p>  <p>There is no API to set a coordinate system using AcMapMap.&#160; The only way you can set the coordinate system is via ProjectModel. The GetSRS method on AcMapMap only reflects what’s set on the map project.</p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> System;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> Autodesk.AutoCAD.Runtime;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> Autodesk.AutoCAD.ApplicationServices;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> Autodesk.AutoCAD.DatabaseServices;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> Autodesk.AutoCAD.Geometry;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> Autodesk.AutoCAD.EditorInput;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> Autodesk.Gis.Map.Platform;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> OSGeo.MapGuide;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt; color: "><font face="Courier New"><font style="font-size: 8pt" color="#008000">// This line is not mandatory, but improves loading performances</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">[</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">assembly</font></span><span style="line-height: 11pt"><font color="#000000">: </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">CommandClass</font></span><span style="line-height: 11pt"><font color="#000000">(</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">typeof</font></span><span style="line-height: 11pt"><font color="#000000">(SetMapSRS.</font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MyCommands</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">))]</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">namespace</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> SetMapSRS</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">{</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">// This class is instantiated by AutoCAD for each document when</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">// a command is called by the user the first time in the context</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">// of a given document. In other words, non static data in this class</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">// is implicitly per-document!</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">public</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">class</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#2b91af">MyCommands</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; [</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">CommandMethod</font></span><span style="line-height: 11pt"><font color="#000000">(</font></span><span style="line-height: 11pt; color: "><font color="#a31515">&quot;SetMapCoordinateSystem&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">)]</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">public</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">void</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> SetMapCoordinateSystem()</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//the parameter is coordinate system code</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; SetMapSRS(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">&quot;CA-I&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//checking </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">string</font></span><span style="line-height: 11pt"><font color="#000000"> wkt = </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">AcMapMap</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.GetCurrentMap().GetMapSRS();</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">Editor</font></span><span style="line-height: 11pt"><font color="#000000"> ed = Autodesk.AutoCAD.ApplicationServices.</font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#2b91af">Application</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; .DocumentManager.MdiActiveDocument.Editor;</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgCoordinateSystemFactory</font></span><span style="line-height: 11pt"><font color="#000000"> coordSysFac = </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MgCoordinateSystemFactory</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">();</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">string</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> code = coordSysFac.ConvertWktToCoordinateSystemCode(wkt);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">&quot;\n MapSRS is Changed to: &quot;</font></span><span style="line-height: 11pt"><font color="#000000"> + code + </font></span><span style="line-height: 11pt; color: "><font color="#a31515">&quot;\n&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">public</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">void</font></span><span style="line-height: 11pt"><font color="#000000"> SetMapSRS(</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">string</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> srsCode)</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; Autodesk.Gis.Map.</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MapApplication</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> mapApp = Autodesk.Gis.Map</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; .</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">HostMapApplicationServices</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.Application;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; Autodesk.Gis.Map.Project.</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">ProjectModel</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> projModel = mapApp.ActiveProject;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; projModel.Projection = srsCode;</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">}</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p> </div>  <p>Hope this helps.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: iftikhar
EMAIL: ifarooqi@chalgeo.com
IP: 66.11.80.129
URL: 
DATE: 09/21/2012 03:15:23 PM
Autodesk.Gis.Map.Project.ProjectModel required ManagedMapApi.dll as reference in VB.Net 2010 but it is producing following error.

Attempt was made to load an assembly with an incorrect format: C:\Program Files\Autodesk\AutoCAD Civil 3D 2013\ManagedMapApi.dll.
-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: AutoCAD Map 3D 2013 - API Recording
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: autocad-map-3d-2013-api-recording
CATEGORY: .NET
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Events
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/07/autocad-map-3d-2013-api-recording.html 
DATE: 07/23/2012 01:13:40 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>We are in the process of recording a DevTV on &quot;<strong>AutoCAD Map 3D 2013</strong> - new Features and API&quot; which we are going to upload this week. We are not hosting a separate &quot;Live Q &amp; A&quot; session on Map 3D API; you can use the comment section here to ask your question on Map 3D 2013 API, alternatively you can use <a href="http://forums.autodesk.com/t5/AutoCAD-Map-3D-Developer/bd-p/84">Map 3D Developer discussion Forum</a> to post your question. Those who have access to <a href="https://partnercenter.autodesk.com/siebel/prmportal_enu_eidm/">Partner Center</a>, please use the same to ask your question and we will respond to that.</p>
<p>&#0160;</p>
<p>Here is the link to download : &#0160;<strong><a href="http://download.autodesk.com/media/adn/AutoCADMap3D2013API.zip" target="_self">AutoCAD Map 3D 2013 API Webcast Recording</a></strong></p>
<p>&#0160;</p>
<p>Thanks,</p>
<p>Partha Sarkar</p>
<p>&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: AutoCAD Map 3D 2013 API Changes
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: autocad-map-3d-2013-api-changes
CATEGORY: .NET
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/07/autocad-map-3d-2013-api-changes.html 
DATE: 07/20/2012 01:42:31 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>In Map 3D 2012 release, we have seen the beginning of the merger of Topobase functionalities within Map 3D. In 2013, I see a big milestone achieved in that direction which influenced lots of API changes within Map and Topobase assemblies. Lots of API functions are renamed to reflect a generic name to be relevant for extended Industry Data Model support in Map 3D 2013. Some of the APIs have become obsolete, however, you would find a replaced API for the same or there is a particular reason for that API to become obsolete in Map 3D 2013.</p>
<p>AutoCAD Map 3D <strong>Wikihelp</strong> (I have shared the link below) has a complete list of the API Changes in Map 3D 2013.</p>
<p><a href="http://wikihelp.autodesk.com/AutoCAD_Map_3D/enu/2013/Help/0000-AutoCAD_0/0001-About_th1/0004-Updated_4/0008-API_Chan8">http://wikihelp.autodesk.com/AutoCAD_Map_3D/enu/2013/Help/0000-AutoCAD_0/0001-About_th1/0004-Updated_4/0008-API_Chan8</a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Renamed executable files in AutoCAD Map 3D 2013
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: renamed-executable-files-in-autocad-map-3d-2013
CATEGORY: .NET
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/07/renamed-executable-files-in-autocad-map-3d-2013.html 
DATE: 07/19/2012 01:52:36 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>Some of the executable (*.exe files) which had a prefix Topobase / TB in Map 3D 2012 or earlier release have been renamed in AutoCAD Map 3D 2013, e.g. TBBatch.exe is renamed to IMBatch.exe in Map 3D 2013.&#0160;</p>
<p>Here is the Map 3D wikihelp link that lists the renamed executable files in Map 3D 2013 :&#0160;</p>
<p><a href="http://wikihelp.autodesk.com/AutoCAD_Map_3D/enu/2013/Help/0000-AutoCAD_0/0001-About_th1/0004-Updated_4/0005-Renamed_5">http://wikihelp.autodesk.com/AutoCAD_Map_3D/enu/2013/Help/0000-AutoCAD_0/0001-About_th1/0004-Updated_4/0005-Renamed_5</a></p>
<p>&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Using AcMapMapManagementService::DuplicateMap() to create a duplicate Map
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: using-acmapmapmanagementserviceduplicatemap-to-create-a-duplicate-map
CATEGORY: .NET
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/07/using-acmapmapmanagementserviceduplicatemap-to-create-a-duplicate-map.html 
DATE: 07/19/2012 01:22:17 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>In AutoCAD Map 3D 2013 Platform API, we have added <strong>AcMapMapManagementService::DuplicateMap()</strong> to create a duplicate map.</p>
<p>Here is a C# code snippet which demonstrates how to create a duplicate map using this new API :</p>
<p>&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Get an Instance of AcMapMapManagementService</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">AcMapMapManagementService</span><span style="line-height: 140%;"> mapMgServ = </span><span style="color: #2b91af; line-height: 140%;">AcMapMapManagementService</span><span style="line-height: 140%;">.GetInstance(</span><span style="color: #2b91af; line-height: 140%;">HostApplicationServices</span><span style="line-height: 140%;">.WorkingDatabase);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Create a Duplicate Map</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">AcMapMap</span><span style="line-height: 140%;"> duplicateMap = mapMgServ.DuplicateMap(mapMgServ.CurrentMap);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Set the Map Name</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">duplicateMap.SetName(</span><span style="color: #a31515; line-height: 140%;">&quot;MyDuplicate_Map&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Set the Duplicate Map as current</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">mapMgServ.SetCurrentMap(duplicateMap);&#0160;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;</p>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Set a FDO Layer to ReadOnly using Map 3D Geospatial Platform API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: set-a-fdo-layer-to-readonly-using-map-3d-geospatial-platform-api
CATEGORY: .NET
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/07/set-a-fdo-layer-to-readonly-using-map-3d-geospatial-platform-api.html 
DATE: 07/18/2012 10:53:44 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>Using <strong>Autodesk.Gis.Map.Platform.AcMapLayer.IsLayerReadOnly()</strong> API, we can now check if a FDO layer shown in Display Manger is ReadOnly.</p>
<p>We can even set it to ReadOnly using <strong>AcMapLayer.SetLayerReadOnly()</strong> API, which is new in 2013 release.</p>
<p>Here is a C# code snippet on how to use it :</p>
<p>&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (!layer.IsLayerReadOnly())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; layer.SetLayerReadOnly();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Changes of AcMapMap.GroupModified and AcMapMap.LayerModified event args
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: changes-of-acmapmapgroupmodified-and-acmapmaplayermodified-event-args
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/07/changes-of-acmapmapgroupmodified-and-acmapmaplayermodified-event-args.html 
DATE: 07/17/2012 06:13:46 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>In Map 3D 2013 Geospatial platform API, the argument type of the AcMapMap.GroupModified and AcMapMap.LayerModified event handlers has been changed from AcMapMappingEventArgs to AcMapMapObjectModifiedEventArgs, because the latter contains the Modification property, which let us know what we have changed.</p>  <p>The Modification property is a bit field of the properties that changed during a layer or group modified event, as follows:</p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#808080">///</font></span><span style="line-height: 11pt; color: "><font color="#008000"> </font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#808080">&lt;summary&gt;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#808080">///</font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000"> Name property changed during the event.</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#808080">///&lt;/summary&gt;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">static</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">const</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> INT32 Name&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; = 1;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#808080">///</font></span><span style="line-height: 11pt; color: "><font color="#008000"> </font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#808080">&lt;summary&gt;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#808080">///</font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000"> Visibility changed during the event.</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#808080">///&lt;/summary&gt;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">static</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">const</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> INT32 Visibility&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; = 2;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#808080">///</font></span><span style="line-height: 11pt; color: "><font color="#008000"> </font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#808080">&lt;summary&gt;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#808080">///</font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000"> Layer selectability during the event.</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#808080">///&lt;/summary&gt;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">static</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">const</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> INT32 LayerSelectability = 4;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#808080">///</font></span><span style="line-height: 11pt; color: "><font color="#008000"> </font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#808080">&lt;summary&gt;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#808080">///</font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000"> Parent changed during the event.</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#808080">///&lt;/summary&gt;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">static</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">const</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> INT32 ParentChanged&#160;&#160;&#160;&#160;&#160; = 8;</font></span></font></p>    <p style="margin: 0px"><font color="#000000" face="Courier New"><span style="line-height: 11pt"></span></font></p>    <p style="margin: 0px"><font color="#000000" face="Courier New"><span style="line-height: 11pt"></span></font></p>    <p style="margin: 0px"><font color="#000000"><span style="line-height: 11pt"></span></font></p>    <p style="margin: 0px"><font color="#000000"><span style="line-height: 11pt">Here is a sample code snippet to demo how to use it: </span></font></p>    <p style="margin: 0px"><font color="#000000"><span style="line-height: 11pt"></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000"></font></font></p>    <div style="font-family: ; background: white; color: ">     <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt"></font></font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">[</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">CommandMethod</font></span><span style="line-height: 11pt"><font color="#000000">(</font></span><span style="line-height: 11pt; color: "><font color="#a31515">&quot;ListenToLayerChange&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">)]</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">public</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">void</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> ListenToLayerChange()</font></span></font></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">{</font></font></span></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">AcMapMap</font></span><span style="line-height: 11pt"><font color="#000000"> currentMap = </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">AcMapMap</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.GetCurrentMap();</font></span></font></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; currentMap.GroupModified += </font></font></span></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">GroupModifiedHandler</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">(currentMap_GroupModified);</font></span></font></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; currentMap.LayerModified += </font></font></span></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">LayerModifiedHandler</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">(currentMap_LayerModified);</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">}</font></font></span></p>      <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">void</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#000000"> currentMap_LayerModified(</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">object</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> sender, </font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">AcMapMapObjectModifiedEventArgs</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> args)</font></span></font></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">{</font></font></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; OutputChanges(args.Modification);</font></font></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">}</font></font></span></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">void</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#000000"> currentMap_GroupModified(</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">object</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> sender, </font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">AcMapMapObjectModifiedEventArgs</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> args)</font></span></font></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">{</font></font></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; OutputChanges(args.Modification);</font></font></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">}</font></font></span></p>      <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">private</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">static</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">void</font></span><span style="line-height: 11pt"><font color="#000000"> OutputChanges(</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">int</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> modification)</font></span></font></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">{</font></font></span></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">Editor</font></span><span style="line-height: 11pt"><font color="#000000"> ed = Autodesk.AutoCAD.ApplicationServices.</font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#2b91af">Application</font></span></font></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; .DocumentManager.MdiActiveDocument.Editor;</font></font></span></p>      <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">///// &lt;summary&gt;</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">///// Name property changed during the event.</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">/////&lt;/summary&gt;</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//static const INT32 Name&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; = 1;</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">///// &lt;summary&gt;</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">///// Visibility changed during the event.</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">/////&lt;/summary&gt;</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//static const INT32 Visibility&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; = 2;</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">///// &lt;summary&gt;</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">///// Layer selectability during the event.</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">/////&lt;/summary&gt;</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//static const INT32 LayerSelectability = 4;</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">///// &lt;summary&gt;</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">///// Parent changed during the event.</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">/////&lt;/summary&gt;</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//static const INT32 ParentChanged&#160;&#160;&#160;&#160;&#160; = 8;</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">switch</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> (modification)</font></span></font></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; {</font></font></span></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">case</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> 1:</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">&quot;\n Layer or LayerGroup name is changed.&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">);</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">break</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">case</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> 2:</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">&quot; \nLayer or LayerGroup Visibility&#160; is changed.&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">);</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">break</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">case</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> 4:</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">&quot; \nLayer or LayerGroup LayerSelectability is changed.&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">);</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">break</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">case</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> 8:</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">&quot; \nLayer or LayerGroup Parent is changed.&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">);</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">break</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">default</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">:</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">break</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; }</font></font></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">}</font></font></span></p>   </div>    <p style="margin: 0px"><font color="#000000" face="Courier New"><span style="line-height: 11pt"></span></font></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">when I change the name of layer in task pane of Map 3D, the LayerModified event is trigger, with “args.Modification”, I know that it is the layer’s name is changed. Similarly, when I turn on/off a layer, I get a notification of the changes of visibility of layer. And when I drag one layer from one layer group to another, I get a notification saying that the parent of layer is changed.</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">The result output is as below:</p>    <p style="margin: 0px">-------------------------------------</p>    <p style="margin: 0px">Command:      <br />Command: netload       <br />Command: LISTENTOLAYERCHANGE       <br />Layer or LayerGroup name is changed.       <br />Layer or LayerGroup Visibility&#160; is changed       <br />Layer or LayerGroup Parent is changed.       <br />Command:       <br /></p> </div>  <p>-------------------------------------</p>  <p>Hope this helps.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: How to set a 'View Scale' in Map 3D using API?
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: how-set-a-view-scale-in-map-3d-using-api
CATEGORY: .NET
CATEGORY: AutoCAD Map 3D 2011
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/07/how-set-a-view-scale-in-map-3d-using-api.html 
DATE: 07/16/2012 01:13:39 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>In AutoCAD Map 3D UI, we can easily change / set the <strong>View Scale</strong> by specifying a new / custom scale value using the dropdown button next to the &quot;View Scale&quot; as shown in the screenshot below -</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0176167e18ee970c-pi" style="display: inline;"><img alt="ViewScale_01" class="asset  asset-image at-xid-6a0167607c2431970b0176167e18ee970c" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0176167e18ee970c-500wi" title="ViewScale_01" /></a></p>
<p>&#0160;</p>
<p>You can achieve the same using Map 3D Platform API <strong>AcMapMap.SetViewScale(double scale)</strong>. Here is a .NET code snippet which demonstrates the same :</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Get the Map Object</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">AcMapMap</span><span style="line-height: 140%;"> currentMap = </span><span style="color: #2b91af; line-height: 140%;">AcMapMap</span><span style="line-height: 140%;">.GetCurrentMap();</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">Double</span><span style="line-height: 140%;"> viewScale = currentMap.GetViewScale();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;ViewScale Before Change : &quot;</span><span style="line-height: 140%;"> + viewScale.ToString());</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// set the ViewScale</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">viewScale = (viewScale / 100);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">currentMap.SetViewScale(viewScale);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;ViewScale After Change : &quot;</span><span style="line-height: 140%;"> + viewScale.ToString());</span></p>
</div>
<p>&#0160;</p>
<p>And the result you would see after running in the above code snippet :</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017743643c0c970d-pi" style="display: inline;"><img alt="ViewScale_02" class="asset  asset-image at-xid-6a0167607c2431970b017743643c0c970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017743643c0c970d-500wi" title="ViewScale_02" /></a></p>
<p>Hope this is useful to you!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Selecting FDO Features inside a given boundary (Polygon)
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: selecting-fdo-features-inside-a-given-boundary-polygon
CATEGORY: .NET
CATEGORY: AutoCAD Map 3D 2011
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/07/selecting-fdo-features-inside-a-given-boundary-polygon.html 
DATE: 07/14/2012 09:56:13 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>Another question I have come across: How do I select FDO Features inside a given boundary (polygon) using API?</p>
<p>&#0160;</p>
<p>Following C# code snippet demonstrates usage of <strong>MgFeatureQueryOptions.SetFilter()</strong> to select features inside a given boundary (polygon) :</p>
<p>&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">//spatial relationship inside a basic filter</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">MgFeatureQueryOptions</span><span style="line-height: 140%;"> query = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">MgFeatureQueryOptions</span><span style="line-height: 140%;">();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; query.SetFilter(</span><span style="color: #a31515; line-height: 140%;">&quot;Geometry INTERSECTS GeomFromText(&#39;POLYGON ((135450.170691914 176714.481673732, 136292.021019111 176121.027356537, 135961.299875354 175651.879698467, 135119.449548157 176245.334015662, 135450.170691914 176714.481673732))&#39;) &quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">//Get the features </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">MgResourceIdentifier</span><span style="line-height: 140%;"> resId = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">MgResourceIdentifier</span><span style="line-height: 140%;">(fsId);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">MgFeatureReader</span><span style="line-height: 140%;"> ftrRdr = fs.SelectFeatures(resId, className, query);</span></p>
</div>
<p>&#0160;</p>
<p>Hope this is useful to you!</p>
<p>&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: juan perez
EMAIL: jperez5522@gmail.com
IP: 200.83.2.5
URL: 
DATE: 03/18/2013 11:42:22 AM
Hello Partha Sarkar, I am new to this, and I get the message: MgFeatureQueryOptions type not defined
-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 203.202.234.243
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 03/19/2013 11:13:58 PM
Hi Juan,

MgFeatureQueryOptions is part of OSGeo.MapGuide.PlatformBase.dll assembly in Map 3D 2013. 

Did you add a reference to the same DLL  in your project ?

This should help in resolving the missing Type issue.

Thanks,
Partha
ADN
-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Using New Profiling API to Analyze Performance of AIMS 2013
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: using-new-profiling-api-to-analyze-performance-of-aims-2013
CATEGORY: AIMS 2013
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/07/using-new-profiling-api-to-analyze-performance-of-aims-2013.html 
DATE: 07/13/2012 03:07:00 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>In <a href="http://adndevblog.typepad.com/infrastructure/2012/07/understanding-the-performance-report-of-aims2013.html" target="_blank">previous post</a>, I introduce how to understand the result of performance report. In this post, I will introduce how to use the new profiling API, which makes it possible to create you own performance report.</p>  <p>In AIMS 2013 API, a new service is added, which is MgProfilingService, it is used to profile existing MapGuide APIs.</p>  <p>Here are two methods of MgProfilingService:</p>  <p>virtual MgByteReader *&#160;&#160;&#160;&#160; ProfileRenderDynamicOverlay (    <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; MgMap *map,     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; MgSelection *selection,&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; MgRenderingOptions *options)=0</p>  <p>Profile the process of rendering all dynamic layers in the specified MgMap to a dynamic overlay image with a transparent background.   <br />    <br />virtual MgByteReader *&#160;&#160;&#160;&#160; ProfileRenderMap (     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; MgMap *map,     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; MgSelection *selection,     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; MgCoordinate *center,     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; double scale,     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; INT32 width, INT32 height,     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; MgColor *backgroundColor,     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; CREFSTRING format,     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; bool bKeepSelection)=0</p>  <p>Profile the process of rendering a MgMap to the requested image format with specified center point and scale. </p>  <p>Now let's look at how to use these APIs to get detailed performance report information. AIMS API can be used in Java, PHP or .NET, I would like to use .NET here. Firstly create a AIMS custom WebApplication, and create a custom command to invoke an URL, which is an ASP.NET web page. Here is the source code of web page: </p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> System;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> System.Collections.Generic;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> System.Linq;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> System.Web;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> System.Web.UI;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> System.Web.UI.WebControls;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> OSGeo.MapGuide;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">namespace</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> HelloAIMS2013</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">{</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">public</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">partial</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">class</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">ProfilingAPI</font></span><span style="line-height: 11pt"><font color="#000000"> : System.Web.UI.</font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#2b91af">Page</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">protected</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">void</font></span><span style="line-height: 11pt"><font color="#000000"> Page_Load(</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">object</font></span><span style="line-height: 11pt"><font color="#000000"> sender, </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">EventArgs</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> e)</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">UtilityClass</font></span><span style="line-height: 11pt"><font color="#000000"> util = </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">UtilityClass</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">();</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; util.InitializeWebTier(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">HttpContext</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.Current.Request);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">String</font></span><span style="line-height: 11pt"><font color="#000000"> sessionId = Request[</font></span><span style="line-height: 11pt; color: "><font color="#a31515">&quot;SESSION&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">].ToString();</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; util.ConnectToServer(sessionId);</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgSiteConnection</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> siteConn = util.GetSiteConnection();</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgResourceService</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> resourceService = siteConn</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; .CreateService(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgServiceType</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.ResourceService) </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">as</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MgResourceService</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//Create MgProfilingService instance</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgProfilingService</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> profilingService = siteConn</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; .CreateService(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgServiceType</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.ProfilingService) </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">as</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MgProfilingService</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//open current map</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgMap</font></span><span style="line-height: 11pt"><font color="#000000"> map = </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MgMap</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">();</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">if</font></span><span style="line-height: 11pt"><font color="#000000"> (Request[</font></span><span style="line-height: 11pt; color: "><font color="#a31515">&quot;mapname&quot;</font></span><span style="line-height: 11pt"><font color="#000000">] != </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">null</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">)</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">string</font></span><span style="line-height: 11pt"><font color="#000000"> mapName = Request[</font></span><span style="line-height: 11pt; color: "><font color="#a31515">&quot;mapname&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">].ToString();</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; map.Open(resourceService, mapName);</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//remove base layer, profiling API doesn't apply to base layers</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">for</font></span><span style="line-height: 11pt"><font color="#000000"> (</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">int</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> i = 0; i &lt; map.GetLayers().Count; i++)</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgLayerBase</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> lyr = map.GetLayers().GetItem(i);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">if</font></span><span style="line-height: 11pt"><font color="#000000"> (lyr.LayerType == </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MgLayerType</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.BaseMap)</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; map.GetLayers().Remove(lyr);</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; map.Save(resourceService);</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; #region</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> sample 1, dome of ProfileRenderDynamicOverlay()</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">string</font></span><span style="line-height: 11pt"><font color="#000000"> format = </font></span><span style="line-height: 11pt; color: "><font color="#a31515">&quot;PNG&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">// enum&#160;&#160;&#160; { RenderSelection = 1, RenderLayers = 2, KeepSelection = 4 }</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">// Rendering behavior values. </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//RenderSelection - Renders the selected feature(s). </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//RenderLayers - Renders the features on the map. </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//KeepSelection - Renders the selected feature(s) even if they are outside the current scale.</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">int</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> behavior = 2;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgColor</font></span><span style="line-height: 11pt"><font color="#000000"> selectionColor = </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MgColor</font></span><span style="line-height: 11pt"><font color="#000000">(System.Drawing.</font></span><span style="line-height: 11pt; color: "><font color="#2b91af">Color</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.Blue);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgRenderingOptions</font></span><span style="line-height: 11pt"><font color="#000000"> renderingOptions = </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MgRenderingOptions</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">(format,behavior, selectionColor);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgByteReader</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> byteReader = profilingService.ProfileRenderDynamicOverlay(</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; map, </font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">null</font></span><span style="line-height: 11pt"><font color="#000000">, </font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//MgSelection, do not have selection here</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; renderingOptions);</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//Store in a file</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgByteSink</font></span><span style="line-height: 11pt"><font color="#000000"> byteSink = </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MgByteSink</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">(byteReader);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; byteSink.ToFile(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">@&quot;c:\delete\profilingResult.txt&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; Response.Write(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">@&quot;write result to c:\delete\profilingResult.txt &lt;br/&gt;&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt; color: "><font face="Courier New"><font style="font-size: 8pt" color="#0000ff">&#160;&#160;&#160;&#160;&#160;&#160;&#160; #endregion</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; #region</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> Sample 2, demo of ProfileRenderMap</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgCoordinate</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> center = map.ViewCenter.Coordinate;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">double</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> scale = map.ViewScale;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">int</font></span><span style="line-height: 11pt"><font color="#000000"> width = </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">Convert</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.ToInt32(map.GetDisplayWidth());</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">int</font></span><span style="line-height: 11pt"><font color="#000000"> height = </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">Convert</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.ToInt32(map.GetDisplayHeight());</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgColor</font></span><span style="line-height: 11pt"><font color="#000000"> backgroundColor = </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MgColor</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">(map.GetBackgroundColor());</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">string</font></span><span style="line-height: 11pt"><font color="#000000"> format2 = </font></span><span style="line-height: 11pt; color: "><font color="#a31515">&quot;PNG&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">bool</font></span><span style="line-height: 11pt"><font color="#000000"> bKeepSelection = </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">true</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgByteReader</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> byteReader2 = profilingService.ProfileRenderMap(</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; map,</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">null</font></span><span style="line-height: 11pt"><font color="#000000">,</font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//MgSelection</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; center,</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; scale,</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; width,</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; height,</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; backgroundColor,</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; format2,</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; bKeepSelection);</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//Store in a file</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgByteSink</font></span><span style="line-height: 11pt"><font color="#000000"> byteSink2 = </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MgByteSink</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">(byteReader2);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; byteSink2.ToFile(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">@&quot;c:\delete\profilingResult2.txt&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; Response.Write(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">@&quot;write result to c:\delete\profilingResult2.txt&lt;br/&gt;&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt; color: "><font face="Courier New"><font style="font-size: 8pt" color="#0000ff">&#160;&#160;&#160;&#160;&#160;&#160;&#160; #endregion</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; }</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">}</font></font></span></p> </div>  <p>The code is selfexplanatory, it does performance report based on current map extent and current scale, and write the performance report result into a text file in XML format. These XML files include detailed information of performance. For example, you can find the total rendering time and time cost of each layer:</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01774351ef75970d-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01774351ef87970d-pi" width="470" height="739" /></a></p>  <p>With these detailed information, you can implement your own performance report yourself. </p>  <p>If you want to know more about the performance report of AIMS Site Administrator, it is in PHP, all source code is released with the product, you can find then at &lt;Infrastructure Web Server Extension 2013&gt;\www\mapadmin.</p>  <p>OK, with that I draw an end to this post, do you think the profiling API is useful? You are welcome to leave us a comment below about your thought. We are always eager to hear from you.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Creating AutoCAD SelectionSet from FDO Features
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: creating-autocad-selectionset-from-fdo-features
CATEGORY: .NET
CATEGORY: AutoCAD Map 3D 2011
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/07/creating-autocad-selectionset-from-fdo-features.html 
DATE: 07/13/2012 02:47:33 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>Many a times I have come across a question : How do I create an AutoCAD selection set from the Geospatial Platform selection set (MgSelectionBase) containing FDO features ?</p>
<p>&#0160;</p>
<p>Here is a C# code snippet demonstrating the steps -&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">AcMapMap</span><span style="line-height: 140%;"> currentMap = </span><span style="color: #2b91af; line-height: 140%;">AcMapMap</span><span style="line-height: 140%;">.GetCurrentMap();</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">MgLayerCollection</span><span style="line-height: 140%;"> layers = currentMap.GetLayers();</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">MgLayerBase</span><span style="line-height: 140%;"> layer = layers.GetItem(</span><span style="color: #a31515; line-height: 140%;">&quot;Parcels&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">MgFeatureService</span><span style="line-height: 140%;"> fs = </span><span style="color: #2b91af; line-height: 140%;">AcMapServiceFactory</span><span style="line-height: 140%;">.GetService(</span><span style="color: #2b91af; line-height: 140%;">MgServiceType</span><span style="line-height: 140%;">.FeatureService) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">MgFeatureService</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">string</span><span style="line-height: 140%;"> fsId = layer.GetFeatureSourceId();</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">string</span><span style="line-height: 140%;"> className = layer.GetFeatureClassName();</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">MgFeatureQueryOptions</span><span style="line-height: 140%;"> query = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">MgFeatureQueryOptions</span><span style="line-height: 140%;">();</span></p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Parcels.shp file is used</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">query.SetFilter(</span><span style="color: #a31515; line-height: 140%;">&quot;FeatId = 166&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">MgResourceIdentifier</span><span style="line-height: 140%;"> resId = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">MgResourceIdentifier</span><span style="line-height: 140%;">(fsId);</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">MgFeatureReader</span><span style="line-height: 140%;"> featureReader = fs.SelectFeatures(resId, className, query);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">MgSelectionBase</span><span style="line-height: 140%;"> selectionSet = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">MgSelectionBase</span><span style="line-height: 140%;">(currentMap);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">//Add all features in the feature reader to the newly constructed selection set</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">selectionSet.AddFeatures(layer, featureReader, 0);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">AcMapFeatureEntityService</span><span style="line-height: 140%;">.HighlightFeatures(selectionSet);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// create an AutoCAD selection</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">SelectionSet</span><span style="line-height: 140%;"> acadSelSet = </span><span style="color: #2b91af; line-height: 140%;">AcMapFeatureEntityService</span><span style="line-height: 140%;">.AddFeaturesToSelectionSet(</span><span style="color: blue; line-height: 140%;">null</span><span style="line-height: 140%;">, selectionSet);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><br /></span></p>
</div>
<p>Hope this is useful to you!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Tom DiVittis
EMAIL: tdivittis@cecinc.com
IP: 72.43.34.114
URL: 
DATE: 08/14/2012 01:59:06 PM
Where is the MgFeatureService?!?
-----
COMMENT:
AUTHOR: Partha
EMAIL: partha.sarkar@autodesk.com
IP: 115.112.233.72
URL: 
DATE: 08/23/2012 02:31:14 AM
Hi Tom,

MgFeatureService is part of OSGeo.MapGuide namespace in OSGeo.MapGuide.PlatformBase.dll

Thanks,
Partha
-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: "Live Q & A" session on AutoCAD Civil 3D API 
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: live-q-a-session-on-autocad-civil-3d-api-
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2011
CATEGORY: AutoCAD Civil 3D 2012
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Events
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/07/live-q-a-session-on-autocad-civil-3d-api-.html 
DATE: 07/12/2012 10:25:02 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>Those who have already <a href="http://www.adskconsulting.com/adn/cs/api_course_sched.php">registered</a> for AutoCAD Civil 3D 2013 .NET API webcast must have received an earlier communication from ADN team about our intention to upload the recoded DevTV on what’s new in 2013 release of AutoCAD Civil 3D API followed by a &quot;Live Q &amp; A&quot; on July 17 2012, starting at 9:30 am PDT.</p>
<p>&#0160;</p>
<p>Participation in &quot;Live Q &amp; A&quot; session on AutoCAD Civil 3D API is open and free for all. If you haven’t registered for it yet, I suggest you to complete the <a href="http://usa.autodesk.com/adsk/servlet/item?id=10417086&amp;siteID=123112&amp;cname=AutoCAD%20Civil 3D API, Webcast, Jul 17 2012, 201249" target="_self">registration</a> process now.</p>
<p>&#0160;</p>
<p>Here is the link to download :</p>
<p><strong><a href="http://download.autodesk.com/media/adn/AutoCADCivil3D2013API_17July12.zip">AutoCAD Civil 3D API Recording</a></strong>&#0160;</p>
<p><strong>Join us for &quot;Live Q &amp; A&quot; session on AutoCAD Civil 3D API, on July 17 2012, starting at 9:30 am PDT. (Duration 45 min)</strong>.&#0160;</p>
<p>Thanks,&#0160;</p>
<p>Partha Sarkar</p>
<p>Team ADN</p>
<p>&#0160;</p>
<p>&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Understanding the Performance Report of AIMS2013
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: understanding-the-performance-report-of-aims2013
CATEGORY: AIMS 2013
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/07/understanding-the-performance-report-of-aims2013.html 
DATE: 07/12/2012 03:16:05 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>In AIMS 2013, a new performance report tool is introduced in Map Administrator(<a href="http://&lt;machinename/mapserver2013/mapadmin/login.php">http://&lt;machinename/mapserver2013/mapadmin/login.php</a>). This tool can be used to analyze the performance of your map server to find out the performance bottle neck. BTW, if your performance report does not work for you, <a href="http://adndevblog.typepad.com/infrastructure/2012/07/performance-report-getting-frozen-in-aims-2013.html" target="_blank">this post</a> may be helpful for you.</p>  <p>Before we start, here is some background knowledge, every time we view a map in AIMS, actually we see a part of the map, it is a image which size is a little bigger than your visible area in the browser. Different part of the map and different zoom level of the map will cost different time to render it. That ‘s why we need to specify an area and also the zoom level to get the performance report when running this tool.</p>  <p>This is a performance report of my test data:</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0167686e260f970b-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01761662fbf5970c-pi" width="475" height="357" /></a></p>  <p>The tag “Layers” means the time spent on layer rendering, including FDO connection, feature query and layer stylization; </p>  <p>Tag “Images” means the time spent on image creation, in other words, compress imagebuffer to a bytesstream in given format (PNG, JPG); </p>  <p>Tag “Other” includes other time spent on map rendering except layers rendering, selection rendering, watermarks rendering, label rendering and image creation. For example, create a Renderer in memory, create the map’s coordinate system, etc..</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01761662fbff970c-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017743492099970d-pi" width="487" height="62" /></a></p>  <p>For my performance report, it seems that my rendering performance is pretty good, the “Layers” tag is only a small percentage, because I have only 4 layers to render. Detailed rendering time cost for each layer is listed below:</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0167686e263f970b-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01761662fc2e970c-pi" width="490" height="93" /></a></p>  <p>If you have many layers to rendering, you probably want to find which ones are the bottle neck, then try to tune them up accordingly. </p>  <p>Do you think this tool useful? In next post, I will introduce how to use profiling API, which makes it possible to create your own performance report tool. Stay tuned!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: proforov
EMAIL: proforov@neolant.ru
IP: 212.59.100.26
URL: 
DATE: 11/14/2014 05:52:34 AM
Since Windows Server 2008 SP2 IIS uses "ApplicationPoolIdentity" identity for application pool process (not the NetworkService such at was early). 
So we need to grant access to the folder to user "AppPool\%app_pool_name%. For me it was IIS "AppPool\MapServer2014AppPool".
-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Mixing Civil 3D .NET and COM APIs
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: mixing-civil-3d-net-and-com-apis
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D 2011

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/07/mixing-civil-3d-net-and-com-apis.html 
DATE: 07/10/2012 12:42:45 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>On each new version, Civil 3D includes more and more .NET coverage, but a few features still missing or maybe not available on older versions. This article how go from COM to .NET and back.</p>  <p>Every time any Aecc-object is used, the code will require COM objects to be loaded. A common practice is to add reference to those objects (either from COM registered objects prior 2012 or from <a href="http://adndevblog.typepad.com/infrastructure/2012/04/com-references-on-civil-3d-2013.html">Interop namespaces</a> on 2013), but that makes the plug-in version dependent. One alternative is to use Late-binding, where no COM reference is added, so the code is binary version independent, but the bad side is that we have no ‘auto-complete’ feature while writing code. If the project have references, declare objects <strong><em>As Aecc-something</em></strong>,<strong><em> </em></strong>like on the sample below, otherwise declare them <strong><em>As Object</em></strong> (late binding).</p>  <p>Several Civil 3D .NET objects have an AcadObject property, which will return the equivalent COM object type. One small consideration is to use <strong><em>TryCast</em></strong> (VB.NET) or the <em><strong>as</strong></em> operation (C#), instead of making the direct cast, which can avoid some casting problems when you are not sure about the conversion. </p>  <div style="font-family: ; background: white">   <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">'the .NET Corridor object</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">Dim</font></font></span><font style="font-size: 8pt"><font color="#000000"> oCorridor </font><span><font color="#0000ff">As</font></span><font color="#000000"> Autodesk.Civil.Roadway.DatabaseServices.</font></font><span><font style="font-size: 8pt" color="#2b91af">Corridor</font></span></font></p>    <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">'...</font></font></span></p>    <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">'initialize the .NET corridor object somehow...</font></font></span></p>    <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">'...</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">'now let's cast to COM</font></font></span></p>    <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">'first create the COM Corridor object</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">Dim</font></font></span><font style="font-size: 8pt"><font color="#000000"> oAeccCorridor </font><span><font color="#0000ff">As</font></span><font color="#000000"> Autodesk.AECC.Interop.Roadway.AeccCorridor</font></font></font></p>    <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">'second try cast, which will return Nothing case it is impossible</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">oAeccCorridor = </font></font><font style="font-size: 8pt"><span><font color="#0000ff">TryCast</font></span><font color="#000000">(oCorridor.AcadObject, AeccCorridor)</font></font></font></p>    <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">'cast succeeded?</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">If</font></font></span><font style="font-size: 8pt"><font color="#000000"> (oAeccCorridor </font><span><font color="#0000ff">Is</font></span><font color="#000000"> </font><span><font color="#0000ff">Nothing</font></span><font color="#000000">) </font></font><span><font style="font-size: 8pt" color="#0000ff">Then</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">'yes! it is valid!</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">'do something here</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">End</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">If</font></span></font></p> </div>  <p>Now, how do we cast from COM to .NET? The AcadObject property is read-only and there is no property available to cast to the .NET equivalent of the same object. One solution is to open the object using the ObjectId from the COM object. The following code shows the typical, basic coding for accessing an object for read, in this case a Corridor object.</p>  <div style="font-family: ; background: white">   <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">'the COM Corridor object</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">Dim</font></font></span><font style="font-size: 8pt"><font color="#000000"> oAeccCorridor </font><span><font color="#0000ff">As</font></span><font color="#000000"> Autodesk.AECC.Interop.Roadway.AeccCorridor</font></font></font></p>    <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">'...</font></font></span></p>    <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">'initialize the COM corridor object somehow...</font></font></span></p>    <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">'...</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">'get the .NET Database object</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">Dim</font></font></span><font style="font-size: 8pt"><font color="#000000"> db </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">Database</font></span><font color="#000000"> = Autodesk.AutoCAD.ApplicationServices. _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; ApplicationDocumentManager.MdiActiveDocument.Database</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">'start a transation with &quot;using&quot; keyword</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">Using</font></font></span><font style="font-size: 8pt"><font color="#000000"> trans </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">Transaction</font></span><font color="#000000"> = db.TransactionManager.StartTransaction</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">'create the .NET corridor object</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> oCorridor </font><span><font color="#0000ff">As</font></span><font color="#000000"> Autodesk.Civil.Roadway.DatabaseServices.</font></font><span><font style="font-size: 8pt" color="#2b91af">Corridor</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">'open it using the transaction, for READ or for WRITE</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">'like from COM to .NET, try cast before use it</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> corridorId </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">ObjectId</font></span><font color="#000000"> = </font><span><font color="#0000ff">New</font></span><font color="#000000"> </font><span><font color="#2b91af">ObjectId</font></span><font color="#000000">(</font><span><font color="#0000ff">New</font></span><font color="#000000"> </font><span><font color="#2b91af">IntPtr</font></span><font color="#000000">( _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oAeccCorridor.ObjectID))</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; oCorridor = </font></font><font style="font-size: 8pt"><span><font color="#0000ff">TryCast</font></span><font color="#000000">(trans.GetObject(corridorId, _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">OpenMode</font></span><font color="#000000">.ForRead), </font><span><font color="#2b91af">Corridor</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">'cast succeeded?</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">If</font></span><font color="#000000"> </font><span><font color="#0000ff">Not</font></span><font color="#000000"> (oCorridor </font><span><font color="#0000ff">Is</font></span><font color="#000000"> </font><span><font color="#0000ff">Nothing</font></span><font color="#000000">) </font></font><span><font style="font-size: 8pt" color="#0000ff">Then</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">'yes! it is valid!</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">'do something here</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">If</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">End</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span><font color="#0000ff">Using</font></span><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#008000">'this will Dispose the transaction object</font></span></font></p> </div>  <p>This code was demonstrated with Corridor and AeccCorridor objects, but the same will work for any other object with AcadObject or ObjectId.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: James Maeding
EMAIL: jmaeding@hunsaker.com
IP: 24.249.247.46
URL: 
DATE: 07/11/2012 07:02:09 AM
Its very hard to make non-version independent add-ons in my experience. I have to split out portions of code where the .net api is different between versions. This leads to one .net project per acad version, which is annoying. I have several "helper" projects too, so its a lot of stuff.
I wish I could see more posts on real life project organization and what impacts it has, as that is what is hard about .net.
-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 200.57.88.172
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 07/11/2012 07:11:04 AM
Hi James, I'll be glad to investigate issues you're facing and try post something on that subject. If you can, please email me a few issues so I can research what can be done to improve version compatibility for Civil 3D. My email is first dot last_name at autodesk.com
-----
COMMENT:
AUTHOR: steve
EMAIL: prisimage@yahoo.com
IP: 172.250.251.24
URL: 
DATE: 09/11/2014 01:57:59 AM
"'second try cast, which will return Nothing case it is impossible

oAeccCorridor = TryCast(oCorridor.AcadObject, AeccCorridor)

'cast succeeded?

If (oAeccCorridor Is Nothing) Then"


could you elaborate on your comment please, specifically "case it is impossible"?

& shouldn't the IF statement be testing thatoAeccCorridor is NOT nothing?
-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 132.188.64.149
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 09/11/2014 09:00:26 AM
Steve,

About #1, the cast should always be possible. But if you have the wrong references, then the cast may not happen... that's why we have this TryCast

Now #2 you are right, but the code is checking 'If NOT (oCorridor Is Nothing) Then' because the 'is not' will not compile...

Regards,
Augusto Goncalves

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Performance Report getting frozen in AIMS 2013?
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: performance-report-getting-frozen-in-aims-2013
CATEGORY: AIMS 2013
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/07/performance-report-getting-frozen-in-aims-2013.html 
DATE: 07/10/2012 03:55:29 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>In AIMS 2013, an outstanding feature is the performance report, which enables user to analyze the performance of your Map Server. Using this tool, users can examine the rendering time of each layer to find out the performance bottle neck, then tune it up accordingly. </p>  <p>Here is a screen-shot of AIMS2013 performance report:</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01774333c071970d-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0176164d9baa970c-pi" width="446" height="330" /></a></p>  <p>&#160;</p>  <p>For unknown reason, the performance report tool did not work on my laptop, it just got frozen after clicking the “Run” button. I checked with Firebug, which is an add-on of Firefox browser,&#160; I get following error message: </p>  <p>--------------------------------------------------------------------</p>  <p>HTTP Error 500.0 - Internal Server Error</p>  <p>Module    <br />FastCgiModule     <br />    <br />ExecuteRequestHandler</p>  <p>Handler    <br />PHP via FastCGI</p>  <p>Error code</p>  <p>0x00000000</p>  <p>Requested URL    <br />http://localhost:80/mapserver2013/mapadmin/performanceReport_GetResult.php?scale=118665.7185&amp;centerPoint=-9.77e%2B6*5.40e%2B6&amp;mapDefinition=Library%3A%2F%2FSamples%2FSheboygan%2FMaps%2FSheboygan.MapDefinition&amp;imageWidth=1659&amp;imageHeight=664&amp;sid=0.2957984344722354</p>  <p>…</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0176164d9bbf970c-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01774333c0dc970d-pi" width="451" height="281" /></a></p>  <p>The reason is due to permission problem of &lt;Infrastructure Web Server Extension 2013&gt;\www\mapadmin\profilingmapxml folder. MapServer need to write file into this folder when performance report is running, so we need to enable “modify” for &lt;machineName&gt;\IIS_IUSRS.</p>  <p>Here is how to do it:</p>  <p>1. Run inetgmr in Start—&gt;Run to open IIS Manager,</p>  <p>2. Right click mapserver2013-&gt;mapadmin-&gt;profilingmapxml&#160; and select “Edit permissions”, then switch to “Security” tab:</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01774333c0f9970d-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0176164d9c24970c-pi" width="446" height="337" /></a></p>  <p>3. Click “edit” then click “Add” button to add user</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0176164d9c4b970c-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0176164d9c56970c-pi" width="447" height="368" /></a></p>  <p>4. Input &lt;machineName&gt;\IIS_IUSRS then click “Check names” to make sure the user name is correct. Please make sure to change location to your local machine if you are in a domain.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01676858c7cd970b-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0176164d9c7f970c-pi" width="432" height="220" /></a></p>  <p>5. Enable “Modify” permission for &lt;machineName&gt;\IIS_IUSRS, then click “OK” or “Apply”</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01676858c7eb970b-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01676858c806970b-pi" width="371" height="415" /></a></p>  <p>&#160;</p>  <p>Now, go back to Map Server Administrator, and run performance report, it works fine for me now! <img style="border-bottom-style: none; border-left-style: none; border-top-style: none; border-right-style: none" class="wlEmoticon wlEmoticon-smile" alt="Smile" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01676858c80b970b-pi" /></p>  <p>Hope this helpful for you if you run into this issue as me.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: James Maeding
EMAIL: jmaeding@hunsaker.com
IP: 24.249.247.46
URL: 
DATE: 07/11/2012 07:08:09 AM
this kind of tool would be invaluable for autocad.
If I could get more info on what it was spending time doing, even if it slowed things down a bunch. I commonly get the open dialog hanging one moment, then not another. More runtime info would be great.
-----
COMMENT:
AUTHOR: Daniel Du
EMAIL: Daniel.Du@autodesk.com
IP: 125.98.160.4
URL: http://adndevblog.typepad.com/autocad/daniel-du/
DATE: 07/11/2012 07:03:43 PM
Thanks you for the comment, but I have to say that this performance report tool is for Infrastructure Map Server(as know as MapGuide), which is web based application, pretty different from AutoCAD :) 
-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Creating stacked and multiple Profile Views using ProfileView.Create()
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: creating-stacked-and-multiple-profile-views-using-profileviewcreate
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/07/creating-stacked-and-multiple-profile-views-using-profileviewcreate.html 
DATE: 07/09/2012 02:08:31 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>Stacked profile views are a collection of related profiles that are drawn in separate, vertically arranged profile views.&#0160;</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017616446ed4970c-pi" style="display: inline;"><img alt="Stacked_PV" class="asset  asset-image at-xid-6a0167607c2431970b017616446ed4970c" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017616446ed4970c-500wi" title="Stacked_PV" /></a><br /><br /></p>
<p>In Civil 3D, <strong>ProfileView</strong> manages the graphic display of profile data objects within a drawing. A ProfileView is used to display one or more profiles for a horizontal alignment. You can configure data bands and profile annotations in a ProfileView to make it clearer or more informative for the user.</p>
<p>Civil 3D 2013 .NET API allows us to create stacked and multiple profile views using <strong>ProfileView.Create().&#0160;</strong>Here is a C# code snippet which demonstrates creation of stacked, multiple Profile views :</p>
<p>&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// select an alignment </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">PromptEntityOptions</span><span style="line-height: 140%;"> prOpt = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">PromptEntityOptions</span><span style="line-height: 140%;">(</span><span style="color: #a31515; line-height: 140%;">&quot;\nSelect an Alignment :&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; prOpt.SetRejectMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nObject must be an Alignment!\n&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; prOpt.AddAllowedClass(</span><span style="color: blue; line-height: 140%;">typeof</span><span style="line-height: 140%;">(</span><span style="color: #2b91af; line-height: 140%;">Alignment</span><span style="line-height: 140%;">), </span><span style="color: blue; line-height: 140%;">false</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> alignID = ed.GetEntity(prOpt).ObjectId;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// Select the location to insert the ProfileView in the DWG file</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">PromptPointOptions</span><span style="line-height: 140%;"> ppo = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">PromptPointOptions</span><span style="line-height: 140%;">(</span><span style="color: #a31515; line-height: 140%;">&quot;\nSelect the location to Insert the Profile View :&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">PromptPointResult</span><span style="line-height: 140%;"> ppr = ed.GetPoint(ppo);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (ppr.Status != </span><span style="color: #2b91af; line-height: 140%;">PromptStatus</span><span style="line-height: 140%;">.OK)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">return</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">Point3d</span><span style="line-height: 140%;"> insertPosition = ppr.Value;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">String</span><span style="line-height: 140%;"> profileViewName = </span><span style="color: #a31515; line-height: 140%;">&quot;ADN_DEMO_Stacked_ProfileView&quot;</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// Get profile view band set style ID:</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> profileViewBandSetId = civilDoc.Styles.ProfileViewBandSetStyles[</span><span style="color: #a31515; line-height: 140%;">&quot;Standard&quot;</span><span style="line-height: 140%;">];</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// If this doesn&#39;t exist, get the first style in the collection</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (profileViewBandSetId == </span><span style="color: blue; line-height: 140%;">null</span><span style="line-height: 140%;">) profileViewBandSetId = civilDoc.Styles.ProfileViewBandSetStyles[0];</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// StackedProfileViewsCreationOptions stackedOptions</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> topViewStyleId = civilDoc.Styles.ProfileViewStyles[</span><span style="color: #a31515; line-height: 140%;">&quot;Stacked - Top&quot;</span><span style="line-height: 140%;">];</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> middleViewStyleId = civilDoc.Styles.ProfileViewStyles[</span><span style="color: #a31515; line-height: 140%;">&quot;Stacked - Middle&quot;</span><span style="line-height: 140%;">];</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> bottomViewStyleId = civilDoc.Styles.ProfileViewStyles[</span><span style="color: #a31515; line-height: 140%;">&quot;Stacked - Bottom&quot;</span><span style="line-height: 140%;">];</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">StackedProfileViewsCreationOptions</span><span style="line-height: 140%;"> stackPVOptions = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">StackedProfileViewsCreationOptions</span><span style="line-height: 140%;">(topViewStyleId, middleViewStyleId, bottomViewStyleId);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// Set number of Views</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; stackPVOptions.NumberOfViews = 3;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// ProfileView.Create(ObjectId alignmentId, Point3d insertPosition, string profileViewName, </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// ObjectId profileViewBandSetId,&#0160; StackedProfileViewsCreationOptions stackedOptions )</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">ProfileView</span><span style="line-height: 140%;">.Create(alignID, insertPosition, profileViewName, profileViewBandSetId, stackPVOptions);</span></p>
</div>
<p>&#0160;</p>
<p>Hope this is useful to you!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: zeus
EMAIL: 
IP: 78.154.241.71
URL: http://profile.typepad.com/6p0105370f258c970b
DATE: 08/07/2012 12:23:27 AM
Hello Partha, I just want to ask if it is possible in VB.NET to replace the source baseline alignment of a certain Profile View and Profile? Just like we have in corridor? 
-----
COMMENT:
AUTHOR: Partha
EMAIL: partha.sarkar@autodesk.com
IP: 59.92.222.43
URL: 
DATE: 08/07/2012 07:03:02 AM
Hi Zeus,

I am not very clear about your requirement here. Can you replace the source baseline alignment of a certain Profile View and Profile using Civil 3D UI ? Do we see this option in any of the Civil 3D UI dialog ? 

Thanks,
Partha
-----
COMMENT:
AUTHOR: zeus
EMAIL: 
IP: 178.61.3.73
URL: http://profile.typepad.com/6p0105370f258c970b
DATE: 08/07/2012 11:13:45 AM
Yes, I mean to do that particular stuff inside Civil 3D UI? :-)Thanks!


-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Find closest point on TinSurface
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: find-closest-point-on-tinsurface
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D 2012

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/07/find-closest-point-on-tinsurface.html 
DATE: 07/06/2012 09:04:46 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastrucuture/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>A question came up on how find a point XY on a surface. Actually this is quite easy and direct if the XY coordinate is inside the surface borders, just call <strong>TinSurface</strong> methods to <strong>Find</strong>[<em>Edge/Vertex/Triangle</em>]<strong>AtXY</strong> at a given coordinate, but this method throw an exception when the point is outside its borders.</p>  <p>One idea can be based on <a href="http://en.wikipedia.org/wiki/Brute-force">brute-force</a> algorithm. Of course this can be implemented in many different (and improved) ways, so below is one possible alternative. This also shows how use AutoCAD Geometry classes and methods. The following <strong>FindClosestEdgeAtXY</strong> sample method iterate through the edges and to find the closest from a given point.</p>  <div style="font-family: ; background: white">   <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">private</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span><font color="#0000ff">static</font></span><font color="#000000"> </font><span><font color="#2b91af">TinSurfaceEdge</font></span><font color="#000000"> FindClosestEdgeAtXY(</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">TinSurface</font></span><font color="#000000"> surface, </font><span><font color="#2b91af">Point3d</font></span><font color="#000000"> point)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">{</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">//in case the point is inside the surface</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">try</font></span><font color="#000000"> { </font><span><font color="#0000ff">return</font></span><font color="#000000"> surface.FindEdgeAtXY(point.X, point.Y); }</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">catch</font></span><font color="#000000"> { }</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">double</font></span><font color="#000000"> closestDistance = </font><span><font color="#0000ff">double</font></span><font color="#000000">.MaxValue;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">TinSurfaceEdge</font></span><font color="#000000"> closestEdge = </font><span><font color="#0000ff">null</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">foreach</font></span><font color="#000000"> (</font><span><font color="#2b91af">TinSurfaceTriangle</font></span><font color="#000000"> </font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; triangle </font></font><font style="font-size: 8pt"><span><font color="#0000ff">in</font></span><font color="#000000"> surface.Triangles)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; {</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">TinSurfaceEdge</font></span><font color="#000000"> edge = </font><span><font color="#0000ff">null</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">double</font></span><font color="#000000"> distance = </font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; ClosestEdgeOfTriangle(triangle,</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; point, </font></font><font style="font-size: 8pt"><span><font color="#0000ff">ref</font></span><font color="#000000"> edge);</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">if</font></span><font color="#000000"> (distance &lt; closestDistance)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; closestDistance = distance;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; closestEdge = edge;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; }</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">return</font></span><font color="#000000"> closestEdge;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">}</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">private</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span><font color="#0000ff">static</font></span><font color="#000000"> </font><span><font color="#0000ff">double</font></span><font color="#000000"> ClosestEdgeOfTriangle(</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">TinSurfaceTriangle</font></span><font color="#000000"> triangle, </font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">Point3d</font></span><font color="#000000"> point, </font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">ref</font></span><font color="#000000"> </font><span><font color="#2b91af">TinSurfaceEdge</font></span><font color="#000000"> edge)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">{</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// closest point on each edge</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">Point3d</font></span><font color="#000000"> e1 = ClosestPointOnEdge(triangle.Edge1, point);</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">Point3d</font></span><font color="#000000"> e2 = ClosestPointOnEdge(triangle.Edge2, point);</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">Point3d</font></span><font color="#000000"> e3 = ClosestPointOnEdge(triangle.Edge3, point);</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// closest of the three points</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">double</font></span><font color="#000000"> d1 = e1.DistanceTo(point);</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">double</font></span><font color="#000000"> d2 = e2.DistanceTo(point);</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">double</font></span><font color="#000000"> d3 = e3.DistanceTo(point);</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">if</font></span><font color="#000000"> (d1 &lt; d2)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">if</font></span><font color="#000000"> (d1 &lt; d3)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; edge = triangle.Edge1;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">return</font></span><font color="#000000"> d1;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#0000ff">else</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; edge = triangle.Edge3;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">return</font></span><font color="#000000"> d3;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#0000ff">else</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; {</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; edge = triangle.Edge2;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">return</font></span><font color="#000000"> d2;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; }</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">}</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">private</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span><font color="#0000ff">static</font></span><font color="#000000"> </font><span><font color="#2b91af">Point3d</font></span><font color="#000000"> ClosestPointOnEdge(</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">TinSurfaceEdge</font></span><font color="#000000"> edge, </font><span><font color="#2b91af">Point3d</font></span><font color="#000000"> point)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">{</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">using</font></span><font color="#000000"> (</font><span><font color="#2b91af">LineSegment3d</font></span><font color="#000000"> lineOverEdge = </font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">new</font></span><font color="#000000"> </font><span><font color="#2b91af">LineSegment3d</font></span><font color="#000000">(</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; edge.Vertex1.Location, edge.Vertex2.Location))</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; {</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">using</font></span><font color="#000000"> (</font><span><font color="#2b91af">PointOnCurve3d</font></span><font color="#000000"> closestPointOnCurve =</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; lineOverEdge.GetClosestPointTo(point))</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">return</font></span><font color="#000000"> closestPointOnCurve.Point;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; }</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">}</font></font></p> </div>  <p>As this will return a <strong>TinSurfaceEdge</strong> object, the next step is find the closest point coordinate on that edge. Sure this is duplicated as the method already did that, but the following command sample find this point and append a AutoCAD <strong>DBPoint</strong> so it is visible on the drawing.</p>  <div style="font-family: ; background: white">   <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">[</font></font><font style="font-size: 8pt"><span><font color="#2b91af">CommandMethod</font></span><font color="#000000">(</font><span><font color="#a31515">&quot;findClosestEdge&quot;</font></span><font color="#000000">)]</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">public</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span><font color="#0000ff">static</font></span><font color="#000000"> </font><span><font color="#0000ff">void</font></span><font color="#000000"> CmdFindClosestEdge()</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">{</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">Editor</font></span><font color="#000000"> ed = </font><span><font color="#2b91af">Application</font></span><font color="#000000">.DocumentManager.</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; MdiActiveDocument.Editor;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// select the surface</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">PromptEntityOptions</font></span><font color="#000000"> peoSurface = </font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">new</font></span><font color="#000000"> </font><span><font color="#2b91af">PromptEntityOptions</font></span><font color="#000000">(</font><span><font color="#a31515">&quot;Select the surface: &quot;</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; peoSurface.SetRejectMessage(</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#a31515">&quot;\nOnly tin surfaces are allowed&quot;</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; peoSurface.AddAllowedClass(</font></font><font style="font-size: 8pt"><span><font color="#0000ff">typeof</font></span><font color="#000000">(</font><span><font color="#2b91af">TinSurface</font></span><font color="#000000">), </font><span><font color="#0000ff">true</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">PromptEntityResult</font></span><font color="#000000"> perSurface = ed.GetEntity(peoSurface);</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">if</font></span><font color="#000000"> (perSurface.Status != </font><span><font color="#2b91af">PromptStatus</font></span><font color="#000000">.OK) </font><span><font color="#0000ff">return</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// specify the point</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">PromptPointResult</font></span><font color="#000000"> pprPoint = </font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; ed.GetPoint(</font></font><font style="font-size: 8pt"><span><font color="#a31515">&quot;Specify the point: &quot;</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">if</font></span><font color="#000000"> (pprPoint.Status != </font><span><font color="#2b91af">PromptStatus</font></span><font color="#000000">.OK) </font><span><font color="#0000ff">return</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">Point3d</font></span><font color="#000000"> point = pprPoint.Value;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">Database</font></span><font color="#000000"> db = </font><span><font color="#2b91af">Application</font></span><font color="#000000">.DocumentManager.</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; MdiActiveDocument.Database;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">using</font></span><font color="#000000"> (</font><span><font color="#2b91af">Transaction</font></span><font color="#000000"> trans = </font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; db.TransactionManager.StartTransaction())</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; {</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// open the surface</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">TinSurface</font></span><font color="#000000"> surface = trans.GetObject(</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; perSurface.ObjectId, </font></font><font style="font-size: 8pt"><span><font color="#2b91af">OpenMode</font></span><font color="#000000">.ForRead) </font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">as</font></span><font color="#000000"> </font><span><font color="#2b91af">TinSurface</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// find the closest edge</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">TinSurfaceEdge</font></span><font color="#000000"> closestEdge = FindClosestEdgeAtXY(</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; surface, point);</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// now (duplicated) find the closest point over the edge</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">using</font></span><font color="#000000"> (</font><span><font color="#2b91af">LineSegment3d</font></span><font color="#000000"> lineOverEdge = </font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">new</font></span><font color="#000000"> </font><span><font color="#2b91af">LineSegment3d</font></span><font color="#000000">(closestEdge.Vertex1.Location,</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; closestEdge.Vertex2.Location))</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">using</font></span><font color="#000000"> (</font><span><font color="#2b91af">PointOnCurve3d</font></span><font color="#000000"> closestPointOnCurve = </font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; lineOverEdge.GetClosestPointTo(point))</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; {</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// get the point</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">Point3d</font></span><font color="#000000"> closestPoint = closestPointOnCurve.Point;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// draw a point for debug</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">BlockTableRecord</font></span><font color="#000000"> curSpace = trans.GetObject(</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; db.CurrentSpaceId, </font></font><font style="font-size: 8pt"><span><font color="#2b91af">OpenMode</font></span><font color="#000000">.ForWrite) </font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">as</font></span><font color="#000000"> </font><span><font color="#2b91af">BlockTableRecord</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">DBPoint</font></span><font color="#000000"> newPoint = </font><span><font color="#0000ff">new</font></span><font color="#000000"> </font><span><font color="#2b91af">DBPoint</font></span><font color="#000000">(closestPoint);</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; curSpace.AppendEntity(newPoint);</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; trans.AddNewlyCreatedDBObject(newPoint, </font></font><font style="font-size: 8pt"><span><font color="#0000ff">true</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; }</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; trans.Commit();</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; }</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">}</font></font></p> </div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Using CustomPointGroupQuery object to build a PointGroup
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: using-custompointgroupquery-object-to-build-a-pointgroup
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/07/using-custompointgroupquery-object-to-build-a-pointgroup.html 
DATE: 07/06/2012 03:13:18 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>This is in continuation to my <a href="http://adndevblog.typepad.com/infrastructure/2012/07/using-standardpointgroupquery-object-to-build-a-cogo-pointgroup.html">previous</a> post on <strong>StandardPointGroupQuery</strong>. In this post I am trying to show a simple way to build a PointGroup using <strong>CustomPointGroupQuery</strong>. The CustomPointGroupQuery lets you specify a query string directly. This method of query creation allows you to create nested queries that cannot be specified using the StandardPointGroupQuery object.</p>
<p>Here is a C# code snippet which demonstrates how to create a PointGroup using CustomPointGroupQuery object.&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Check if the pointGrpName already exists before trying to add it</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> pointGrpId = civilDoc.PointGroups.Add(pointGrpName);</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">PointGroup</span><span style="line-height: 140%;"> pointGrp = pointGrpId.GetObject(</span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForWrite) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">PointGroup</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Build a quesry using CustomPointGroupQuery object</span></p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Query conditions used below are specific to Civil 3D Tutorial DWG file &quot;Points-3.dwg&quot;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">CustomPointGroupQuery</span><span style="line-height: 140%;"> customPointGrpQry = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">CustomPointGroupQuery</span><span style="line-height: 140%;">();</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">string</span><span style="line-height: 140%;"> queryString = </span><span style="color: #a31515; line-height: 140%;">&quot;(RawDescription=&#39;TO*&#39;) AND (PointNumber&gt;=600 AND PointNumber&lt;=1000) AND PointElevation&gt;=100.00 &quot;</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">customPointGrpQry.QueryString = queryString;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">pointGrp.SetQuery(customPointGrpQry);&#0160; &#0160; &#0160;&#0160; </span></p>
</div>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017743090a43970d-pi" style="display: inline;"><img alt="CustomQ1" class="asset  asset-image at-xid-6a0167607c2431970b017743090a43970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017743090a43970d-500wi" title="CustomQ1" /></a></p>
<p>&#0160;</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017743090ace970d-pi" style="display: inline;"><img alt="CustomQ2" class="asset  asset-image at-xid-6a0167607c2431970b017743090ace970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017743090ace970d-500wi" title="CustomQ2" /></a></p>
<p>Hope this is useful to you!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: plus.google.com/101657301277207565703
EMAIL: 
IP: 157.208.128.5
URL: http://profile.typepad.com/6p019b00cd21fa970c
DATE: 11/07/2013 11:37:04 PM
Hi,
I've been having a hard time trying to use the UDP Names as QueryString using CustomPointGroupQuery.
Something like:
pGrp.UseCustomClassification(cls);
...
CustomPointGroupQuery qry = new CustomPointGroupQuery();
...
qry.QueryString = "(Title='" & sTitle & "' AND HoleType='" & sBHtype & " AND Location='" & sLocation) & "')";
pGrp.SetQuery(qry); ---> this part crashes with :PointGroupQueryParserException: Unsupported property name found

Where Title, HoleType and Location are UPD Names created under Classification.


Any help is greatly appreciated...

Thanks,
Eugene Suarez
ADN Active Member
Nested.Objeks Solutions
-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 203.202.234.246
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 11/12/2013 11:21:55 PM
Hi Eugene,

It seems currently, Civil 3D .NET API doesn't support the UDP property names in CustomPointGroupQuery.
 
I have logged an API wish list for the same. 
 
Thanks,
Partha



-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Select Features to Delete in Map 3D Using Geospatial Platform API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: select-features-to-delete-in-map-3d-using-geospatial-platform-api
CATEGORY: AutoCAD Map 3D 2011
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/07/select-features-to-delete-in-map-3d-using-geospatial-platform-api.html 
DATE: 07/06/2012 02:08:27 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>This code snippet demonstrates how to select some feature to delete in Map 3D, it includes how to handle the AutoCAD SelectionSet and MgSelectionBase, please refer the to code itself for more information: </p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">[</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">CommandMethod</font></span><span style="line-height: 11pt"><font color="#000000">(</font></span><span style="line-height: 11pt; color: "><font color="#a31515">&quot;FeatureDelete&quot;</font></span><span style="line-height: 11pt"><font color="#000000">, </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">CommandFlags</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.UsePickSet</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; | </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">CommandFlags</font></span><span style="line-height: 11pt"><font color="#000000">.Modal | </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">CommandFlags</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.Redraw)]</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">public</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">void</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> FeatureDelete()</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">{</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">Editor</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> ed = Autodesk.AutoCAD.ApplicationServices</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; .</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">Application</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.DocumentManager.MdiActiveDocument.Editor;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgFeatureService</font></span><span style="line-height: 11pt"><font color="#000000"> _featureService = </font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#2b91af">AcMapServiceFactory</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; .GetService(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgServiceType</font></span><span style="line-height: 11pt"><font color="#000000">.FeatureService) </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">as</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MgFeatureService</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">PromptSelectionResult</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> res = ed.SelectImplied();</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">if</font></span><span style="line-height: 11pt"><font color="#000000"> (</font></span><span style="line-height: 11pt; color: "><font color="#2b91af">PromptStatus</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.OK == res.Status)</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">// Convert the SelectionSet to MgSelectionBase </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">// using AcMapFeatureEntityService. </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">Debug</font></span><span style="line-height: 11pt"><font color="#000000">.Assert(res.Value != </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">null</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">ObjectId</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> entityID = res.Value[0].ObjectId;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">int</font></span><span style="line-height: 11pt"><font color="#000000"> entitytype = </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">AcMapFeatureEntityService</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.GetEntityType(entityID);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">if</font></span><span style="line-height: 11pt"><font color="#000000"> (entitytype == </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">EntityType</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.BulkEntity)</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgSelectionBase</font></span><span style="line-height: 11pt"><font color="#000000"> curSelection = </font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#2b91af">AcMapFeatureEntityService</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; .GetSelection(res.Value);</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">foreach</font></span><span style="line-height: 11pt"><font color="#000000"> (</font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MgLayerBase</font></span><span style="line-height: 11pt"><font color="#000000"> layer </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">in</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> curSelection.GetLayers())</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">string</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> filter = curSelection</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; .GenerateFilter(layer, layer.FeatureClassName);</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">if</font></span><span style="line-height: 11pt"><font color="#000000"> (filter != </font></span><span style="line-height: 11pt; color: "><font color="#a31515">&quot;&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">)</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgFeatureCommandCollection</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> featCommands =</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MgFeatureCommandCollection</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">();</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">string</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> strclassName = layer.FeatureClassName;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgDeleteFeatures</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> delFeat =</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MgDeleteFeatures</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">(strclassName, filter);</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; featCommands.Add(delFeat);</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">try</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">AcMapLayer</font></span><span style="line-height: 11pt"><font color="#000000"> aclayer = layer </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">as</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">AcMapLayer</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgPropertyCollection</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> pProps = aclayer</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; .UpdateFeatures(featCommands);</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">// save and update the layer, commite the changes</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgFeatureQueryOptions</font></span><span style="line-height: 11pt"><font color="#000000"> opt = </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MgFeatureQueryOptions</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">();</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">// build the filter string, this is required for </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">// data source such as Sql Server/Oracle...</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">String</font></span><span style="line-height: 11pt"><font color="#000000"> commitFilter = </font></span><span style="line-height: 11pt; color: "><font color="#a31515">&quot;&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">if</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> (aclayer.IsCached()</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &amp;&amp; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">EditMode</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.EditSet == aclayer.EditMode)</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; commitFilter = </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">ClassSystemProperties</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.FeatureStatus </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; + </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#a31515">&quot; = &quot;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; + </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">ClassSystemProperties</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.FeatureStatusDeleted;</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; opt.SetFilter(commitFilter);</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//This is a must</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; aclayer.SaveFeatureChanges(opt);</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; aclayer.ForceRefresh();</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">catch</font></span><span style="line-height: 11pt"><font color="#000000"> (Autodesk.AutoCAD.Runtime.</font></span><span style="line-height: 11pt; color: "><font color="#2b91af">Exception</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> ex)</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(ex.Message);</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//remove the highlight </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">AcMapFeatureEntityService</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.UnhighlightFeatures(curSelection);</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; }</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">}</font></font></span></p> </div>  <p>Hope this helps!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Using StandardPointGroupQuery object to build a PointGroup
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: using-standardpointgroupquery-object-to-build-a-cogo-pointgroup
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/07/using-standardpointgroupquery-object-to-build-a-cogo-pointgroup.html 
DATE: 07/05/2012 01:30:50 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>In AutoCAD Civil 3D, Points can be selected and added to a PointGroup using either a standard (<strong>StandardPointGroupQuery</strong> object) or custom (<strong>CustomPointGroupQuery</strong> object) query. Both of these classes inherit from the <strong>PointGroupQuery</strong> base class.</p>
<p>Here is a C# code snippet which demonstrates how to create a PointGroup using <strong>StandardPointGroupQuery</strong> object.</p>
<p>&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">//start a transaction </span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">Transaction</span><span style="line-height: 140%;"> trans = db.TransactionManager.StartTransaction())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// Check if the pointGrpName already exists before trying to add it</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> pointGrpId = civilDoc.PointGroups.Add(pointGrpName);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">PointGroup</span><span style="line-height: 140%;"> pointGrp = pointGrpId.GetObject(</span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForWrite) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">PointGroup</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// Build a quesry using StandardPointGroupQuery object</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// Query conditions used below are specific to Civil 3D Tutorial DWG file &quot;Points-3.dwg&quot;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">StandardPointGroupQuery</span><span style="line-height: 140%;"> standardPointGrpQry = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">StandardPointGroupQuery</span><span style="line-height: 140%;">();</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// One thing to note here :</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// All of the Include* properties are OR-ed together, </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// and all the Exclude* properties are OR- ed together </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; standardPointGrpQry.IncludeNumbers = </span><span style="color: #a31515; line-height: 140%;">&quot;550-560, 565-572&quot;</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; standardPointGrpQry.ExcludeElevations = </span><span style="color: #a31515; line-height: 140%;">&quot;&gt;100.00&quot;</span><span style="line-height: 140%;">;&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">//This method sets the query object in the point group</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; pointGrp.SetQuery(standardPointGrpQry);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; trans.Commit();&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0177430825ab970d-pi" style="display: inline;"><img alt="PointGroup_StandardQ" class="asset  asset-image at-xid-6a0167607c2431970b0177430825ab970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0177430825ab970d-500wi" title="PointGroup_StandardQ" /></a><br /><br /></p>
<p>Hope this is useful to you!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Export Civil 3D Corridor Feature Lines to Polyline using.NET API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: export-civil-3d-corridor-feature-lines-to-polyline-usingnet-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2011
CATEGORY: AutoCAD Civil 3D 2012
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/07/export-civil-3d-corridor-feature-lines-to-polyline-usingnet-api.html 
DATE: 07/04/2012 02:23:37 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>If you are looking for a way to export Civil 3D Corridor Feature Lines to Polyline using .NET API, you are at the right place! :)&#0160;</p>
<p>Following code snippet demonstrates how to export corridor Feature Lines to Polyline using Civil 3D .NET API :</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">Using</span><span style="line-height: 140%;"> (trans)</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">&#39;&#39; get the Corridor Object. </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">&#39;&#39; In this Case I am getting a specific Corridor from Civil 3D Tutorial DWG - &quot;Corridor-5c.dwg&quot;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; corridor = trans.GetObject(civilDoc.CorridorCollection.Item(</span><span style="color: #a31515; line-height: 140%;">&quot;Corridor - (1)&quot;</span><span style="line-height: 140%;">), </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForRead, </span><span style="color: blue; line-height: 140%;">True</span><span style="line-height: 140%;">, </span><span style="color: blue; line-height: 140%;">True</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">For</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Each</span><span style="line-height: 140%;"> bLine </span><span style="color: blue; line-height: 140%;">In</span><span style="line-height: 140%;"> corridor.Baselines</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; fTLCollMap = bLine.MainBaselineFeatureLines.FeatureLineCollectionMap</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">For</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Each</span><span style="line-height: 140%;"> fTLColl </span><span style="color: blue; line-height: 140%;">In</span><span style="line-height: 140%;"> fTLCollMap</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">For</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Each</span><span style="line-height: 140%;"> corFTL </span><span style="color: blue; line-height: 140%;">In</span><span style="line-height: 140%;"> fTLColl</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; fTLPointColl = corFTL.FeatureLinePoints</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">ReDim</span><span style="line-height: 140%;"> fTLPArray(0 </span><span style="color: blue; line-height: 140%;">To</span><span style="line-height: 140%;"> fTLPointColl.Count * 3 - 1)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">For</span><span style="line-height: 140%;"> i = 0 </span><span style="color: blue; line-height: 140%;">To</span><span style="line-height: 140%;"> fTLPointColl.Count - 1</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; fTLPoint = fTLPointColl.Item(i)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; pt3d = fTLPoint.XYZ</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; fTLPArray(i * 3) = pt3d.X</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; fTLPArray(i * 3 + 1) = pt3d.Y</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; fTLPArray(i * 3 + 2) = pt3d.Z&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Next</span><span style="line-height: 140%;"> i</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; </span><span style="color: green; line-height: 140%;">&#39; Draw the Polyline line</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; pline = acadDoc.ModelSpace.AddPolyline(fTLPArray)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; pline.LinetypeGeneration = </span><span style="color: blue; line-height: 140%;">True</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; pline.Lineweight = </span><span style="color: #2b91af; line-height: 140%;">ACAD_LWEIGHT</span><span style="line-height: 140%;">.acLnWt050</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> col </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">AcadAcCmColor</span><span style="line-height: 140%;"> = </span><span style="color: blue; line-height: 140%;">New</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">AcadAcCmColor</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; col.ColorIndex = </span><span style="color: #2b91af; line-height: 140%;">AcColor</span><span style="line-height: 140%;">.acCyan</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; pline.TrueColor = col</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; pline.Update()</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; pline.Highlight(</span><span style="color: blue; line-height: 140%;">True</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Next</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Next</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">Next</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; trans.Commit()</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Using</span></p>
</div>
<p>&#0160;</p>
<p>Hope this is useful to you!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Vitezslav Peka
EMAIL: vitezslav.peka@cadstudio.cz
IP: 194.228.205.74
URL: 
DATE: 07/20/2012 03:50:53 AM
Hi,

thanks for post, i would like to ask you how to solve the problem when the featureline is cut in the corridor. When i try your example it generated line which copy the corridor but than the line is cut so to the next point ,where the line started again, i see straight line across the corridor.

thanks for advice
-----
COMMENT:
AUTHOR: Partha
EMAIL: partha.sarkar@autodesk.com
IP: 59.92.165.169
URL: 
DATE: 07/20/2012 05:14:44 AM
Hi Vitezslav Peka,

Could you send me screenshots of this result / scenario vs. what you are expecting here ? You might have to handle this with your own logic to identify the cut.

Thanks,
Partha
-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Disable Coordinate Label when Plotting in Ajax Viewer
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: disable-coordinate-label-when-plotting-in-ajax-viewer
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/07/disable-coordinate-label-when-plotting-in-ajax-viewer.html 
DATE: 07/03/2012 08:27:48 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>When plotting in Ajax viewer with QuickPlot, the coordinate labels of left-upper corner and bottom-right corner always show up as screen-shot below:</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017743001272970d-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0176161a130b970c-pi" width="469" height="300" /></a></p>  <p>I got a request to disable this coordinate label. After some investigation, here is the solution for your reference.</p>  <p>The simplest way is to change the CSS of coordinate label div, please refer to C:\Program Files\Autodesk\Autodesk Infrastructure Web Server Extension 2012\www\viewerfiles\quickplot.js and seach &quot;createCoordinateLabel&quot;, edit the value of label.style.cssText to &quot;display:none;&quot;</p>  <pre class="csharpcode">        <span class="kwrd">var</span> label = <span class="kwrd">this</span>.innerDoc.createElement(<span class="str">&quot;div&quot;</span>);
        container.appendChild(label);
        label.id  = id;
        label.style.cssText = <span class="str">&quot;</span><span class="str">display:none;&quot;</span>;
        label.innerHTML     = <span class="str">&quot;X: &quot;</span> + cX + <span class="str">&quot; Y: &quot;</span> + cY;</pre>
<style type="text/css">

.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }</style>

<p>&#160;</p>

<p>Here is the screen-shot after modification, the coordinate label is disabled now.</p>

<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0176161a131c970c-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017743001293970d-pi" width="462" height="291" /></a></p>





<p>This solution applies to AIMS 2013 as well.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Alex
EMAIL: alexhv@hotmail.com
IP: 190.41.120.216
URL: 
DATE: 07/31/2012 10:02:06 AM
Hello Daniel du as I have a question I put a statistical chart on a map or in a thematic map cast in autocad 2013.
-----
COMMENT:
AUTHOR: Daniel Du
EMAIL: 
IP: 
URL: http://profile.typepad.com/daniel_du
DATE: 07/31/2012 05:46:04 PM





TypePad HTML Email




Hi Alex,

Sorry but I am clear about your meaning, are you trying to add a chart in AIMS? Would you please refer to this post to check whether it is helpful?
<a href="http://adndevblog.typepad.com/infrastructure/2012/04/make-full-use-of-tooltip-in-autodesk-infrastructure-map-serveraims-or-mapguide-open-source.html">http://adndevblog.typepad.com/infrastructure/2012/04/make-full-use-of-tooltip-in-autodesk-infrastructure-map-serveraims-or-mapguide-open-source.html</a>


Thanks,
Daniel 

-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Interoperability between Civil 3D and Inventor
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: interoperability-between-civil-3d-and-inventor
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D 2012

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/07/interoperability-between-civil-3d-and-inventor.html 
DATE: 07/03/2012 10:46:44 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html" target="_blank">Augusto Goncalves</a></p>
<p>This article is based on a case study presented at <a href="http://adndevblog.typepad.com/infrastructure/2012/04/aec-devcamp-2012.html" target="_blank">ADN DevCamp 2012</a> on how improve interoperability between Civil 3D and Inventor. The image below is a summary of what was done and presented: read Corridor data at Civil 3D to create a spline at a Inventor sketch. It is required some Inventor API knowledge, so if you now familiar with it, please visit the <a href="http://www.autodesk.com/developinventor" target="_blank">Inventor Developer Center</a>.</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0167682133ba970b-pi"><img alt="c3d_inventor" border="0" height="190" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017742fc3834970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="c3d_inventor" width="422" /></a></p>
<p>The idea was to use Inventor out-of-process COM API from Civil 3D in-process .NET API based plug-in as the main architecture. This approach allow us direct access to the objects without use of any intermediate file, which is also a common practice, but can result in a lot of extra work. One disadvantage is that both application must be installed and running (although we can launch automatically).</p>
<p>Below is a very simplified version of the plug-in to demonstrate the idea, but you can  <span class="asset  asset-generic at-xid-6a0167607c2431970b017742fc43d0970d"><a href="http://adndevblog.typepad.com/files/c3dalignment2invsketch.zip">download the full version here</a></span>. For a given Civil 3D Corridor Feature Line, get all AutoCAD Geometry Points, then create a Inventor 3D Sketch, where the 3D Spline will be drawn. Like AutoCAD Civil 3D, Inventor has a type of geometry entities called Transient Geometry, so the code creates Inventor Transient Points based on the AutoCAD Geometry Points XYZ coordinates, which are then used to create Inventor Sketch Points that compose the Inventor Sketch Spline.</p>
<div style="background: white;">
<p style="margin: 0px;"><span><span style="font-family: Courier New;"><span style="font-size: 8pt; color: #008000;">// Get the feature line collection of Acad geometry points</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span><span style="color: #2b91af;"><span style="font-size: 8pt;">Point3dCollection</span></span></span><span style="font-size: 8pt;"><span style="color: #000000;"> points = </span><span><span style="color: #0000ff;">new</span></span><span style="color: #000000;"> </span><span><span style="color: #2b91af;">Point3dCollection</span></span><span style="color: #000000;">();</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span><span style="font-family: Courier New;"><span style="font-size: 8pt; color: #008000;">// Iterate through the collection of feature points</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span><span style="color: #0000ff;"><span style="font-size: 8pt;">foreach</span></span></span><span style="font-size: 8pt;"><span style="color: #000000;"> (</span><span><span style="color: #2b91af;">FeatureLinePoint</span></span><span style="color: #000000;"> flPoint </span><span><span style="color: #0000ff;">in</span></span><span style="color: #000000;"> featureLine.FeatureLinePoints)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="font-size: 8pt; color: #000000;">{</span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; </span></span><span><span style="font-size: 8pt; color: #008000;">// If is between the margin we seek</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; </span></span><span style="font-size: 8pt;"><span><span style="color: #0000ff;">if</span></span><span style="color: #000000;"> (flPoint.Station &gt; startStation &amp;&amp; flPoint.Station &lt; endStation)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="font-size: 8pt; color: #000000;">&#0160; {</span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span><span><span style="font-size: 8pt; color: #008000;">// Add to the collection</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160; points.Add(flPoint.XYZ);</span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="font-size: 8pt; color: #000000;">&#0160; }</span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="font-size: 8pt; color: #000000;">}</span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span><span style="font-family: Courier New;"><span style="font-size: 8pt; color: #008000;">// Get running Inventor and its open document (Part Doc)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="color: #000000;"><span style="font-size: 8pt;">Inventor.</span></span><span style="font-size: 8pt;"><span><span style="color: #2b91af;">Application</span></span><span style="color: #000000;"> app = GetApplication();</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="color: #000000;"><span style="font-size: 8pt;">Inventor.</span></span><span style="font-size: 8pt;"><span><span style="color: #2b91af;">PartDocument</span></span><span style="color: #000000;"> partDoc = </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; app.ActiveDocument </span></span><span style="font-size: 8pt;"><span><span style="color: #0000ff;">as</span></span><span style="color: #000000;"> Inventor.</span><span><span style="color: #2b91af;">PartDocument</span></span><span style="color: #000000;">;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span><span style="font-family: Courier New;"><span style="font-size: 8pt; color: #008000;">// Create a new sketch</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="color: #000000;"><span style="font-size: 8pt;">Inventor.</span></span><span style="font-size: 8pt;"><span><span style="color: #2b91af;">Sketch3D</span></span><span style="color: #000000;"> sketch = </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="font-size: 8pt; color: #000000;">&#0160; partDoc.ComponentDefinition.Sketches3D.Add();</span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span><span style="font-family: Courier New;"><span style="font-size: 8pt; color: #008000;">// Access Inventor Transient Geometry object, </span></span></span></p>
<p style="margin: 0px;"><span><span style="font-family: Courier New;"><span style="font-size: 8pt; color: #008000;">// used to create non-visual (in memory geometry) objects</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="color: #000000;"><span style="font-size: 8pt;">Inventor.</span></span><span style="font-size: 8pt;"><span><span style="color: #2b91af;">TransientGeometry</span></span><span style="color: #000000;"> tg = app.TransientGeometry;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span><span style="font-family: Courier New;"><span style="font-size: 8pt; color: #008000;">// Create a collection of points</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="color: #000000;"><span style="font-size: 8pt;">Inventor.</span></span><span style="font-size: 8pt;"><span><span style="color: #2b91af;">ObjectCollection</span></span><span style="color: #000000;"> pointForInventor = </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="font-size: 8pt; color: #000000;">&#0160; app.TransientObjects.CreateObjectCollection();</span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span><span style="font-family: Courier New;"><span style="font-size: 8pt; color: #008000;">// Convert each Acad Geometry point into Inventor Geometry points</span></span></span></p>
<p style="margin: 0px;"><span><span style="font-family: Courier New;"><span style="font-size: 8pt; color: #008000;">// and store into the collection</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span><span style="color: #0000ff;"><span style="font-size: 8pt;">foreach</span></span></span><span style="font-size: 8pt;"><span style="color: #000000;"> (</span><span><span style="color: #2b91af;">Point3d</span></span><span style="color: #000000;"> acadPt </span><span><span style="color: #0000ff;">in</span></span><span style="color: #000000;"> points)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="font-size: 8pt; color: #000000;">{</span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="font-size: 8pt; color: #000000;">&#0160; pointForInventor.Add(</span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160; sketch.SketchPoints3D.Add(</span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160; tg.CreatePoint(acadPt.X, acadPt.Y, acadPt.Z)));</span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="font-size: 8pt; color: #000000;">}</span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span><span style="font-family: Courier New;"><span style="font-size: 8pt; color: #008000;">// Finally use the collection of points to create the </span></span></span></p>
<p style="margin: 0px;"><span><span style="font-family: Courier New;"><span style="font-size: 8pt; color: #008000;">// new spline at the new sketch</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="color: #000000;"><span style="font-size: 8pt;">Inventor.</span></span><span style="font-size: 8pt;"><span><span style="color: #2b91af;">SketchSpline3D</span></span><span style="color: #000000;"> spline = sketch.SketchSplines3D.Add(</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="font-size: 8pt; color: #000000;">&#0160; pointForInventor);</span></span></p>
</div>
<p>It is possible to note here that the raw data, basically coordinates as double values, is immediately transferred without any lost or intermediate conversion. For a approach like that it is required to go deep enough (i.e. from Civil 3D Corridor, to Feature Line, to Geometry Points) and then back (i.e. from Inventor Transient Point, to Sketch Point, to Sketch Spline) so it’s possible to base the execution only on raw data.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Using AcMapFeatureEntityService.GetSelection() to access FDO feature data
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: using-acmapfeatureentityservicegetselection-to-access-fdo-feature-data
CATEGORY: .NET
CATEGORY: AutoCAD Map 3D 2011
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/07/using-acmapfeatureentityservicegetselection-to-access-fdo-feature-data.html 
DATE: 07/03/2012 02:29:26 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p><strong>AcMapFeatureEntityService</strong> class in <strong>Autodesk.Gis.Map.Platform.Interop</strong> namespace has a function <strong>GetSelection(</strong>SelectionSet <em>acadSel</em><strong>)</strong> which takes a AutoCAD SelectionSet object. Here is an example command implemented in C# that gets all the features in the pick first set and output the unique ID for each of the selected FDO features.</p>
<p>&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="line-height: 140%;">[</span><span style="color: #2b91af; line-height: 140%;">CommandMethod</span><span style="line-height: 140%;">(</span><span style="color: #a31515; line-height: 140%;">&quot;FDOSel&quot;</span><span style="line-height: 140%;">, </span><span style="color: #2b91af; line-height: 140%;">CommandFlags</span><span style="line-height: 140%;">.UsePickSet)]</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">public</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">void</span><span style="line-height: 140%;"> FDOFeatureSelectionTest()</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">PromptSelectionResult</span><span style="line-height: 140%;"> res = ed.SelectImplied();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (res.Status.Equals(</span><span style="color: #2b91af; line-height: 140%;">PromptStatus</span><span style="line-height: 140%;">.OK))</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">AcMapSelection</span><span style="line-height: 140%;"> sel = (</span><span style="color: #2b91af; line-height: 140%;">AcMapSelection</span><span style="line-height: 140%;">)</span><span style="color: #2b91af; line-height: 140%;">AcMapFeatureEntityService</span><span style="line-height: 140%;">.GetSelection(res.Value);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">AcMapMap</span><span style="line-height: 140%;"> currentMap = </span><span style="color: #2b91af; line-height: 140%;">AcMapMap</span><span style="line-height: 140%;">.GetCurrentMap();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">MgLayerCollection</span><span style="line-height: 140%;"> layers = currentMap.GetLayers();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">foreach</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">MgLayerBase</span><span style="line-height: 140%;"> lyr </span><span style="color: blue; line-height: 140%;">in</span><span style="line-height: 140%;"> layers)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nSelected Count(&quot;</span><span style="line-height: 140%;"> + lyr.Name + </span><span style="color: #a31515; line-height: 140%;">&quot;): &quot;</span><span style="line-height: 140%;"> + sel.GetSelectedFeaturesCount(lyr, lyr.FeatureClassName));</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">MgFeatureReader</span><span style="line-height: 140%;"> reader = sel.GetSelectedFeatures(lyr, lyr.FeatureClassName, </span><span style="color: blue; line-height: 140%;">false</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">while</span><span style="line-height: 140%;"> (reader.ReadNext())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; </span><span style="color: green; line-height: 140%;">// Tested with sample sdf data C:\Program Files\Autodesk\AutoCAD Map 3D 2013\Sample\Maps\SDF\buildings.sdf</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; </span><span style="color: green; line-height: 140%;">// in the data set, there is a column named PRIMARYINDEX</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nPRIMARYINDEX: &quot;</span><span style="line-height: 140%;"> + reader.GetInt32(</span><span style="color: #a31515; line-height: 140%;">&quot;PRIMARYINDEX&quot;</span><span style="line-height: 140%;">));</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
<p>&#0160;</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017742ef116a970d-pi" style="display: inline;"><img alt="Map_selection" class="asset  asset-image at-xid-6a0167607c2431970b017742ef116a970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017742ef116a970d-500wi" title="Map_selection" /></a></p>
<p>Hope this is useful to you!</p>
<p>&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: What controls the radius of the curves when we create Alignment?
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: what-controls-the-radius-of-the-curves-when-we-create-alignment
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2011
CATEGORY: AutoCAD Civil 3D 2012
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/07/what-controls-the-radius-of-the-curves-when-we-create-alignment.html 
DATE: 07/02/2012 12:59:39 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>In <a href="http://adndevblog.typepad.com/infrastructure/2012/06/do-you-want-to-programmatically-convert-polyline-to-civil-3d-alignment-object.html">&#39;Do you want to programmatically convert polyline to Civil 3D Alignment object?</a>&#39; I showed how to convert a Polyline to a Civil 3D Alignment object. Christopher of <a href="http://blog.civil3dreminders.com/">CIVIL 3D REMINDERS</a> asked about what controls the radius of the curves? I thought I will take a quick look into this and share my findings with you all.</p>
<p>Radius of the curve is determined by the value set for &quot;<strong>Default radius</strong>&quot; under &#39;<strong>Create from Entities</strong>&#39; in &quot;<strong>Edit Command Settings - CreateAlignmentEntities</strong>&quot; dialog box as shown in the screenshot below.</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01676812deda970b-pi" style="display: inline;"><img alt="Alignment_Radius" class="asset  asset-image at-xid-6a0167607c2431970b01676812deda970b" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01676812deda970b-500wi" title="Alignment_Radius" /></a><br /><br /></p>
<p>And this value can be accessed using following code snippet -</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> settingsCmdCrAlignmentEnt </span><span style="color: blue; line-height: 140%;">As</span><span style="background-color: #ffff00;"><span style="line-height: 140%;"> Autodesk.Civil.Settings.</span><span style="color: #2b91af; line-height: 140%;">SettingsCmdCreateAlignmentEntities</span></span><span style="line-height: 140%;"> = civilDoc.Settings.GetSettings(</span><span style="color: blue; line-height: 140%;">Of</span><span style="line-height: 140%;"> Autodesk.Civil.Settings.</span><span style="color: #2b91af; line-height: 140%;">SettingsCmdCreateAlignmentEntities</span><span style="line-height: 140%;">)()</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">ed.WriteMessage(vbCrLf + </span><span style="color: #a31515; line-height: 140%;">&quot;SettingsCmdCreateAlignmentEntities.SettingsCmdCreateFromEntities.Radius =&#0160; :&#0160; &quot;</span><span style="line-height: 140%;"> + settingsCmdCrAlignmentEnt.CreateFromEntities.Radius.Value.ToString())&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;">&#0160;</p>
</div>
<p>Hope this helps !</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: AU Virtual 2012 Call for Proposals Is Open 
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: au-virtual-2012-call-for-proposals-is-open-
CATEGORY: Events
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/06/au-virtual-2012-call-for-proposals-is-open-.html 
DATE: 06/29/2012 09:36:00 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>Would you like to teach a class at AU Virtual 2012? Now is the time to submit your ideas.&#0160;</p>
<p>Becoming an instructor at AU Virtual gives you the opportunity to share your knowledge with thousands of users from around the world without leaving your office. More than 35,000 customers from around the world are expected to attend AU Virtual this year.&#0160;</p>
<p>Submit your ideas now and join this prestigious group of experts for AU Virtual 2012. Virtual class proposals will be <span style="text-decoration: underline;">accepted</span> <strong>till August 3, 2012</strong>.&#0160;</p>
<p>To learn more about presenting at AU Virtual, visit the <a href="http://click.icptrack.com/icp/relay.php?r=39855277&amp;msgid=579501&amp;act=UBR5&amp;c=513232&amp;destination=http%3A%2F%2Fau.autodesk.com%2F%3Fnd%3Dsv_call_for_proposals">Call for Proposals</a> website.</p>
<p><span style="font-size: small;"><br /></span></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Using CogoPointCollection.ImportPoints() to Import Points in a drawing file
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: using-cogopointcollectionimportpoints-to-import-points-in-a-drawing-file
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/06/using-cogopointcollectionimportpoints-to-import-points-in-a-drawing-file.html 
DATE: 06/29/2012 03:23:15 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>While navigating through an array of new functionalities provided in COGO Point .NET API, I stopped at <strong>CogoPointCollection.ImportPoints()</strong> and thought, let me show a simple code snippet on how to use this API to import point data in Civil 3D.&#0160;</p>
<p><strong>CogoPointCollection</strong> class in Civil 3D 2013 .NET API, has overloaded method <em><strong>ImportPoints()</strong></em> which we can use to import COGO Points in a DWG file. In this example, we will explore how to use <strong>CogoPointCollection.ImportPoints (</strong><em>String, PointFileFormat</em><strong>)</strong> that takes a <strong>string</strong> <em>pointFileFullName</em> and <strong>PointFileFormat</strong> <em>fileFormat</em>.</p>
<p>While trying to execute my C# code sample to import points from a point file using CogoPointCollection.ImportPoints() I stumbled upon an issue. I was trying to import Point data in an <span style="text-decoration: underline;">empty</span> DWG file from a Civil 3D tutorial text data file and I found CogoPointCollection.ImportPoints() call throws an exception -&quot;<em>No Points were transferred from the source</em>&quot;. After a discussion with a colleague from Civil 3D engineering team we found there is an issue in .NET version of ImportPoints(). Since we have spotted this issue now, we will work on fixing it ASAP; in the meantime, simple workaround is just adding a single COGO point in the drawing which you can delete later. If there is any existing COGO point object in the Civil 3D drawing file then you will find ImportPoints() function call brings in all the point from the desired data source without any issue.</p>
<p>BTW – You will also see the “Duplicate Point Number” dialog box while trying to import the points to resolve the duplicate point number conflicts. I find Isaac already mentioned about this in his blog post on <a href="http://civilizeddevelopment.typepad.com/civilized-development/2012/05/21wojp-week-6-fun-renumbering-points.html" target="_self">COGO Points Renumbering</a>.</p>
<p>&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// This point file is included as a sample for Civil 3D tutorials:</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">string</span><span style="line-height: 140%;"> pointFilePath = </span><span style="color: #a31515; line-height: 140%;">@&quot;C:\Program Files\Autodesk\AutoCAD Civil 3D 2013\Help\Civil Tutorials\&quot;</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">string</span><span style="line-height: 140%;"> pointFileName = pointFilePath + </span><span style="color: #a31515; line-height: 140%;">&quot;Existing Ground Points - PENZD.txt&quot;</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">//The 2nd parameter is the file format for the point file </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// of type Autodesk.Civil.DatabaseServices.PointFileFormat.</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">string</span><span style="line-height: 140%;"> pointFileFormatName = </span><span style="color: #a31515; line-height: 140%;">&quot;PENZD (space delimited)&quot;</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">PointFileFormat</span><span style="line-height: 140%;"> pointFileFormat = </span><span style="color: #2b91af; line-height: 140%;">PointFileFormatCollection</span><span style="line-height: 140%;">.GetPointFileFormats(db)[pointFileFormatName];</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">CogoPointCollection</span><span style="line-height: 140%;">.ImportPoints(pointFileName, pointFileFormat);</span></p>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Maqsood
EMAIL: maqsoodamc@yahoo.com
IP: 39.55.208.228
URL: 
DATE: 01/02/2014 04:02:34 AM
I am contractor employ kindly guide me about my problem which I face in Autocad civil 3D 2012.
1. When we start a new project as contractor 1st of all our surveyor take jointly level N.S.L (natural surface level) with the consultant surveyor.
2. Horizontal alignment data and vertical data were given on working drawing which provided by the consultant to the contractor.
My question is how I can import the N.S.L in autocad civil 3d 2012 for making surface, cross sections and other question is how I can draw the horizontal data and vertical data which is provided in hard copy as mentioned in working drawing.

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: AEC DevCamp 2012 – Class materials
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: aec-devcamp-2012-class-materials
CATEGORY: .NET
CATEGORY: AIMS 2013
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Events
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/06/aec-devcamp-2012-class-materials.html 
DATE: 06/28/2012 10:30:52 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p><a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self"></a>Two days of intense technical sessions in <a href="http://adndevblog.typepad.com/infrastructure/2012/04/aec-devcamp-2012.html">AEC DevCamp 2012</a> followed by an ever busy DevLab in our Waltham office was successfully ended on 8<sup>th</sup> June. The materials from the recent AEC DevCamp 2012 are finally posted to the following locations:</p>
<ul>
<li>ADN extranet &gt;&gt; Events      &gt;&gt;&#0160;<a href="http://adn.autodesk.com/adn/servlet/item?siteID=4814862&amp;id=19908969" target="_self" title="DevCamps 2012">Autodesk      DevCamps 2012</a>&#0160;(members only access)</li>
<li>Autodesk Developer Network Open      site &gt;&gt;&#0160;<a href="http://download.autodesk.com/media/adn/Autodesk_AEC_DevCamp_2012.zip" target="_self" title="AEC DevCamp 2012 materials">API      Training Archive section</a>&#0160;(public)</li>
</ul>
<p>These links provide one zip for the ease of download.&#0160;Classes are divided in five tracks:</p>
<ol>
<li>Revit Beginners</li>
<li>Revit Advanced</li>
<li>Infrastructure (includes –      <span style="background-color: #ffff00;">Civil 3D, Map 3D and AIMS</span>)</li>
<li>Cloud and Mobile, and other      Autodesk AEC technologies</li>
<li>Business</li>
</ol>
<p>For the complete list of classes and course description, please take a look at&#0160;<a href="http://adndevblog.typepad.com/files/aec-devcamp-2012---list-of-classes-final2-1.pdf">AEC DevCamp 2012 - List Of Classes</a>.</p>
<p>Once again, many thanks to&#0160;those who have participated in the event and made it successful! We truly enjoyed meeting you in person.&#0160; For those who&#0160;could not join, we hope you will find&#0160;those materials useful for your future&#0160;customization work.&#0160;&#0160;</p>
<p>(Please note that DevCamp 2012 project site on Buzzsaw which we have used during the event will be closed on July 2nd.)</p>
<p>&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Creating a new "Point Description Key sets" using Civil 3D .Net API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: creating-a-new-point-description-key-sets-using-civil-3d-net-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/06/creating-a-new-point-description-key-sets-using-civil-3d-net-api.html 
DATE: 06/27/2012 03:13:16 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>In this post, I will show you how to create a new &quot;Point Description Key sets&quot; and add Point code using wildcards &quot;*&quot;.</p>
<p>&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">//start a transaction </span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">Transaction</span><span style="line-height: 140%;"> trans = db.TransactionManager.StartTransaction())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// Access the collection of all&#0160; Description key sets in a document&#0160; &#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">PointDescriptionKeySetCollection</span><span style="line-height: 140%;"> pointDescKeySetColl = </span><span style="color: #2b91af; line-height: 140%;">PointDescriptionKeySetCollection</span><span style="line-height: 140%;">.GetPointDescriptionKeySets(db);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// Add a new Descp. Key Sets</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> PointDescKeySetsId = pointDescKeySetColl.Add(</span><span style="color: #a31515; line-height: 140%;">&quot;ADN_Point_Desc_Key&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">PointDescriptionKeySet</span><span style="line-height: 140%;"> pointDescKeySet = trans.GetObject(PointDescKeySetsId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForWrite) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">PointDescriptionKeySet</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// Create a new key in the set with code = &quot;TR*&quot; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// The wildcards “?” and “*” are allowed in the code. </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> pointDescKeyId = pointDescKeySet.Add(</span><span style="color: #a31515; line-height: 140%;">&quot;TR*&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">PointDescriptionKey</span><span style="line-height: 140%;"> pointDescKey = trans.GetObject(pointDescKeyId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForWrite) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">PointDescriptionKey</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// set a specific Style and Label style</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// in the following line we are presuming a Point Style named &quot;Tree&quot; exists in the DWG file&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; pointDescKey.StyleId = civilDoc.Styles.PointStyles[</span><span style="color: #a31515; line-height: 140%;">&quot;Tree&quot;</span><span style="line-height: 140%;">];</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; pointDescKey.ApplyStyleId = </span><span style="color: blue; line-height: 140%;">true</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// in the following line we are presuming a Point Label Style </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// named &quot;Point#-Elevation-Description&quot; exists in the DWG file</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; pointDescKey.LabelStyleId = civilDoc.Styles.LabelStyles.PointLabelStyles.LabelStyles[</span><span style="color: #a31515; line-height: 140%;">&quot;Point#-Elevation-Description&quot;</span><span style="line-height: 140%;">];</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; pointDescKey.ApplyLabelStyleId = </span><span style="color: blue; line-height: 140%;">true</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; trans.Commit();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
<p>&#0160;</p>
<p>Once you build your application using the above code snippet and run the custom command in Civil 3D 2013, you should see a new Point Description Key sets added to the collection like the screenshot shown below -</p>
<p>&#0160;</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017742c305f5970d-pi" style="display: inline;"><img alt="Point_Desc_Key" class="asset  asset-image at-xid-6a0167607c2431970b017742c305f5970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017742c305f5970d-500wi" title="Point_Desc_Key" /></a></p>
<p>&#0160;</p>
<p>Hope this helps!</p>
<p>&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Using CogoPoint.ApplyDescriptionKeys() to apply DescriptionKeys to a CogoPoint
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: using-cogopointapplydescriptionkeys-to-apply-descriptionkeys-to-a-cogopoint
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/06/using-cogopointapplydescriptionkeys-to-apply-descriptionkeys-to-a-cogopoint.html 
DATE: 06/26/2012 11:31:49 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>As you know, we can use description keys to automatically control point appearance and some point properties when creating or importing a point into a drawing.</p>
<p>We use description keys to automatically control some drawing point properties, such as the appearance of a point in the drawing at the time of import points or when we create point in the drawing. Before you create drawing points using description keys, create a series of description keys. Then, when you create or import a drawing point, the <strong>raw description</strong> for the point specifies which description key is used to create the point in the drawing. The properties defined for that description key are applied to the point as it is added to the drawing.</p>
<p>AutoCAD Civil 3D provides a nice UI tool &quot;<strong>Apply Description Keys</strong>&quot; to apply&#0160; description keys to a single point or a collection of points.</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017615dc2dec970c-pi" style="display: inline;"><img alt="Apply_Desc1" class="asset  asset-image at-xid-6a0167607c2431970b017615dc2dec970c" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017615dc2dec970c-500wi" title="Apply_Desc1" /></a><br /><br /></p>
<p>&#0160;</p>
<p>The following C# code snippet demonstrates how to apply description keys to a selected point after updating it&#39;s RawDescription value.</p>
<p>&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">//start a transaction </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">Transaction</span><span style="line-height: 140%;"> trans = db.TransactionManager.StartTransaction())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; {</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">//open the COGO Point </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">CogoPoint</span><span style="line-height: 140%;"> cogoPoint = trans.GetObject(per.ObjectId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForRead) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">CogoPoint</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// Change it&#39;s RawDescription</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; cogoPoint.RawDescription = </span><span style="color: #a31515; line-height: 140%;">&quot;TREE&quot;</span><span style="line-height: 140%;">;&#0160; &#0160; &#0160; &#0160; &#0160; &#0160;&#0160; </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// ApplyDescriptionKeys() to apply DescriptionKeys to a CogoPoint</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; cogoPoint.ApplyDescriptionKeys();</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; trans.Commit();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; }</span></p>
</div>
<p>&#0160;</p>
<p>Once you build your application using the above code snippet and run the custom command in Civil 3D 2013, you should see the Point appearance changed(like below ) :</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b016767e6fe65970b-pi" style="display: inline;"><img alt="Desc_applied" class="asset  asset-image at-xid-6a0167607c2431970b016767e6fe65970b" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b016767e6fe65970b-500wi" title="Desc_applied" /></a><br /><br /></p>
<p>Hope this helps!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Gopinath Taget
AUTHOR EMAIL: gopinath.taget@autodesk.com
TITLE: Introducing the Cloud and Mobile DevBlog
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: introducing-the-cloud-and-mobile-devblog

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/06/introducing-the-cloud-and-mobile-devblog.html 
DATE: 06/26/2012 03:29:18 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/gopinath-taget.html" target="_blank">Gopinath Taget</a></p>  <p>We’re pleased to announce the launch of another ADN DevBlog which is focused on using or hooking up Autodesk technologies with cloud and mobile platforms. Click on the image below to go take a look:</p>  <p><a href="http://adndevblog.typepad.com/cloud_and_mobile/"><img title="CandM" border="0" alt="CandM" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017615d96c97970c-pi" width="453" height="101" /></a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Setting coordinate system for map using .net API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: setting-coordinate-system-for-map-using-net-api
CATEGORY: AutoCAD Map 3D 2011
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/06/setting-coordinate-system-for-map-using-net-api.html 
DATE: 06/24/2012 08:51:47 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>You probably have already known that we can get the current coordinate system of map with following code snippet: </p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; [</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">CommandMethod</font></span><span style="line-height: 11pt"><font color="#000000">(</font></span><span style="line-height: 11pt; color: "><font color="#a31515">&quot;GetMapCoordinateSystem&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">)]</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">public</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">void</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> GetMapCoordinateSystem()</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">AcMapMap</font></span><span style="line-height: 11pt"><font color="#000000"> currentMap = </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">AcMapMap</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.GetCurrentMap();</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">string</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> srs = currentMap.GetMapSRS();</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">Editor</font></span><span style="line-height: 11pt"><font color="#000000"> ed = Autodesk.AutoCAD.ApplicationServices.</font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#2b91af">Application</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; .DocumentManager.MdiActiveDocument.Editor;</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">&quot;current coordinate system is : &quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> + srs);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></span></p> </div>  <p>And I have been asked many times, how to set a coordinate system to a map? Here is the solution: </p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; [</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">CommandMethod</font></span><span style="line-height: 11pt"><font color="#000000">(</font></span><span style="line-height: 11pt; color: "><font color="#a31515">&quot;SetMapCoordinateSystem&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">)]</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">public</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">void</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> SetMapCoordinateSystem()</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//the parameter is coordinate system code</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; SetMapSRS(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">&quot;CA-I&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">string</font></span><span style="line-height: 11pt"><font color="#000000"> wkt = </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">AcMapMap</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.GetCurrentMap().GetMapSRS();</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">Editor</font></span><span style="line-height: 11pt"><font color="#000000"> ed = Autodesk.AutoCAD.ApplicationServices.</font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#2b91af">Application</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; .DocumentManager.MdiActiveDocument.Editor;</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgCoordinateSystemFactory</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> coordSysFac = </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MgCoordinateSystemFactory</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">();</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">string</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> code = coordSysFac.ConvertWktToCoordinateSystemCode(wkt);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">&quot;\n MapSRS is Changed to: &quot;</font></span><span style="line-height: 11pt"><font color="#000000"> + code + </font></span><span style="line-height: 11pt; color: "><font color="#a31515">&quot;\n&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">);</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">public</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">void</font></span><span style="line-height: 11pt"><font color="#000000"> SetMapSRS(</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">string</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> srsCode)</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; Autodesk.Gis.Map.</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MapApplication</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> mapApp = Autodesk.Gis.Map</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; .</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">HostMapApplicationServices</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.Application;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; Autodesk.Gis.Map.Project.</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">ProjectModel</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> projModel </font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; = mapApp.ActiveProject;</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; projModel.Projection = srsCode;</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font color="#000000" face="Courier New"></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font color="#000000">Hope this helps.</font></span></p> </div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Mohammad
EMAIL: hseyyed@gmail.com
IP: 31.7.56.30
URL: 
DATE: 06/25/2012 10:05:33 AM
hi, How can I extract ground sampled section in civil3d to a text file containing Station(Kilometer),offset and elevation.

-----
COMMENT:
AUTHOR: Daniel Du
EMAIL: 
IP: 223.166.58.156
URL: http://profile.typepad.com/daniel_du
DATE: 06/26/2012 10:55:09 PM
Hi Mohammad,

To make the blog more readable, we only answer questions related to the post itself. If you have any other questions, would you please ask through ADN site(if you are an ADN member) or ask in autodesk discussion group?

Thank you for your understanding. 
-----
COMMENT:
AUTHOR: Mohammad
EMAIL: hseyyed@gmail.com
IP: 31.7.56.30
URL: 
DATE: 06/26/2012 11:08:57 PM
thanks. No I', not a member. I 'll ask it in discussion group.
-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Is this COGO Point a Survey Point or Project Point?
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: is-this-cogo-point-a-survey-point-or-project-point
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/06/is-this-cogo-point-a-survey-point-or-project-point.html 
DATE: 06/22/2012 01:22:46 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>When you select a COGO Point in Civil 3D Model space and look into the Properties dialog, under &quot;Data&quot; node, there is &quot;<strong>Survey Point</strong>&quot; property and with a value True or False. If the COGO Point is part of Survey Database, it will be shown as &#39;True&#39; -</p>
<p>&#0160;</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b016767ba063b970b-pi" style="display: inline;"><img alt="COGO_02" class="asset  asset-image at-xid-6a0167607c2431970b016767ba063b970b" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b016767ba063b970b-500wi" title="COGO_02" /></a></p>
<p>&#0160;</p>
<p>Similarly, if the COGO Point is from Vault Project Points, You would see associated &#39;Project version&#39; in OPM window -</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017615af739d970c-pi" style="display: inline;"><img alt="COGO_03" class="asset  asset-image at-xid-6a0167607c2431970b017615af739d970c" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b017615af739d970c-500wi" title="COGO_03" /></a></p>
<p>We can use the following CogoPoint properties to find out if it is Survey Point, project point or normal COGO point object created in the Civil 3D drawing file.&#0160;</p>
<p><strong>CogoPoint.IsSurveyPoint</strong> property indicates whether this Cogo Point is a <span style="text-decoration: underline;">Survey Point</span>.</p>
<p><strong>CogoPoint.IsProjectPoint</strong> property indicates whether the CogoPoint is a <span style="text-decoration: underline;">project point</span>.</p>
<p>&#0160;</p>
<p>Here is the relevant C# code snippet :&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">//open the COGO Point </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">CogoPoint</span><span style="line-height: 140%;"> cogoPoint = trans.GetObject(per.ObjectId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForRead) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">CogoPoint</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// Access COGO Point Properties</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// CogoPoint.IsSurveyPoint property indicates whether this Cogo Point is a Survey Point</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (cogoPoint.IsSurveyPoint)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// DO your stuff</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nSelected COGO Point is a Survey Point&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; }</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">//&#0160; CogoPoint.IsProjectPoint property indicates whether the CogoPoint is a project point</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">//&#0160; i.e. if the COGO point is from Vault Project Points</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">else</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (cogoPoint.IsProjectPoint)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// DO your stuff</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nSelected COGO Point is a Project Point&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// normal COGO point object created in the Civil 3D drawing file</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">else</span><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// DO your stuff</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nSelected COGO Point is neither Survey nor Project Point&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; } </span></p>
</div>
<p>Hope this is useful to you!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Creating custom control for Mobile Viewer of AIMS
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: creating-custom-control-for-mobile-viewer-of-aims
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: Daniel Du
CATEGORY: Mobile

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/06/creating-custom-control-for-mobile-viewer-of-aims.html 
DATE: 06/21/2012 01:20:13 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>Do you browse maps on mobile devices such as iPad, iPhone or iPod Touch? Do you use the Mobile Viewer on your mobile devices to browse MapGuide maps?&#160; The Mobile Viewer was introduced in Autodesk Infrastructure Map Server 2012, enabling you to browse your map on the go.&#160; </p>  <p>I just delivered a presentation&#160; during our biannual event – DevCamp in Waltham. This class shows you how to create a simple custom control for the Mobile Viewer, helping you getting started turning the Mobile Viewer into an efficient task specific tool. Please <a href="http://download.autodesk.com/media/adn/Autodesk_AEC_DevCamp_2012.zip" target="_blank">click here</a> to download the PPT and samples of all materials for DevCamp,&#160; this class can be found in 3 Infrastructure –&gt; 3.6 Creating a Custom Control for Mobile Viewer.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: kb
EMAIL: kbowman@cityofgp.com
IP: 204.209.122.250
URL: http://map.gpgis.com
DATE: 06/26/2012 12:16:06 PM
Hi,

I've been searching for info on how to best create a mobile version of our AIMS site.  The mobile version that comes with MG has a lot of issues so I was hoping to just develop a standard one from jqueryMobile and openlayers.  

I came across your blog and thought there might be a different way to accomplish this instead and was going to read your PPT but the file is not accessable.  It seems to be missing from the Buzz network.

Do you have a different location for this document or perhaps some samples of how to better achive creating a mobile version using more standarized libraries such as jquerymobile?

thanks.
-----
COMMENT:
AUTHOR: Daniel Du
EMAIL: 
IP: 223.166.58.156
URL: http://profile.typepad.com/daniel_du
DATE: 06/26/2012 10:43:15 PM
Thank you for the comment, the link is fixed now.
-----
COMMENT:
AUTHOR: Maurizio
EMAIL: scipione@digitecno.it
IP: 31.197.135.212
URL: 
DATE: 03/08/2014 01:09:51 AM
Thank you for your example, I would like to understand how an application. NET can make a selection on the map through SetSelectionXML
-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Creating a Civil 3D COGO Point using .NET API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: creating-a-civil-3d-cogo-point-using-net-api
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/06/creating-a-civil-3d-cogo-point-using-net-api.html 
DATE: 06/21/2012 12:25:22 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>AutoCAD Civil 3D 2013 .NET API has exposed the COGO Points (<strong>CogoPoint</strong>) and associated functionalities which enables us creating, updating or removing COGO Points. In next few series of posts I am going to share some basics of COGO Points and related .NET API which are new in Civil 3D 2013. In this post we will see how to create a Civil 3D COGO Point at a specified location.</p>
<p>For those, who didn&#39;t have to deal with <strong>COGO</strong> Points earlier, some basics of COGO Points : COGO is short form of &quot;Coordinate Geometry&quot;. COGO Points in Civil 3D are more complex than AutoCAD points, which have only coordinate data. A CogoPoint object, in addition to a location, also has properties such as a unique ID number, name, raw (field) description, and full (expanded) description.</p>
<p>Here is a C# code snippet which demonstrates creation of Civil 3D COGO Point at a specified location :</p>
<p>&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// Select the location for COGO Point</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">PromptPointOptions</span><span style="line-height: 140%;"> ppo = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">PromptPointOptions</span><span style="line-height: 140%;">(</span><span style="color: #a31515; line-height: 140%;">&quot;\nSelect the location to Create a COGO Point :&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">PromptPointResult</span><span style="line-height: 140%;"> ppr = ed.GetPoint(ppo);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (ppr.Status != </span><span style="color: #2b91af; line-height: 140%;">PromptStatus</span><span style="line-height: 140%;">.OK)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">return</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">Point3d</span><span style="line-height: 140%;"> location = ppr.Value;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">//start a transaction </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">Transaction</span><span style="line-height: 140%;"> trans = db.TransactionManager.StartTransaction())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; {</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// All points in a document are held in a CogoPointCollection object </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// We can access CogoPointCollection through the CivilDocument.CogoPoints property</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">CogoPointCollection</span><span style="line-height: 140%;"> cogoPoints = </span><span style="color: #2b91af; line-height: 140%;">CivilApplication</span><span style="line-height: 140%;">.ActiveDocument.CogoPoints;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// Adds a new CogoPoint at the given location with the specified description information</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> pointId = cogoPoints.Add(location, </span><span style="color: #a31515; line-height: 140%;">&quot;Survey Point&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">CogoPoint</span><span style="line-height: 140%;"> cogoPoint = pointId.GetObject(</span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForWrite) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">CogoPoint</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// Set Some Properties</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; cogoPoint.PointName = </span><span style="color: #a31515; line-height: 140%;">&quot;Survey_Base_Point&quot;</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; cogoPoint.RawDescription = </span><span style="color: #a31515; line-height: 140%;">&quot;This is Survey Base Point&quot;</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; trans.Commit();</span></p>
<p style="margin: 0px;">&#0160;</p>
<p>Hope this helps!</p>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Do you want to programmatically convert polyline to Civil 3D Alignment object?
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: do-you-want-to-programmatically-convert-polyline-to-civil-3d-alignment-object
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2011
CATEGORY: AutoCAD Civil 3D 2012
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/06/do-you-want-to-programmatically-convert-polyline-to-civil-3d-alignment-object.html 
DATE: 06/20/2012 01:32:37 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>If you have a requirement to convert polyline to Civil 3D Alignment object programmatically i.e. using Civil 3D API, you are at the right place :)&#0160;</p>
<p>This VB.NET code snippet demonstrates how to create (or convert) a Polyline to a Civil 3D Alignment object.&#0160;</p>
<p>&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">&#39; Select the Polyline</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> promptEntOp </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">New</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">PromptEntityOptions</span><span style="line-height: 140%;">(vbCrLf + </span><span style="color: #a31515; line-height: 140%;">&quot;Select a Polyline : &quot;</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> promptEntRs </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">PromptEntityResult</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; promptEntRs = ed.GetEntity(promptEntOp)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">If</span><span style="line-height: 140%;"> promptEntRs.Status &lt;&gt; </span><span style="color: #2b91af; line-height: 140%;">PromptStatus</span><span style="line-height: 140%;">.OK </span><span style="color: blue; line-height: 140%;">Then</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;Exiting! Try Again !&quot;</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Exit Sub</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">If</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> idEnt </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> = promptEntRs.ObjectId&#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">Try</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> poptions </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> Autodesk.Civil.DatabaseServices.</span><span style="color: #2b91af; line-height: 140%;">PolylineOptions</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; poptions.AddCurvesBetweenTangents = </span><span style="color: blue; line-height: 140%;">True</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; poptions.EraseExistingEntities = </span><span style="color: blue; line-height: 140%;">True</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; poptions.PlineId = idEnt</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: green; line-height: 140%;">&#39; Check the Alignment Style Name and labelSetName </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: green; line-height: 140%;">&#39; To use the following default names you can use the &quot;Align-6A.dwg &quot; from Help\Civil Tutorials\Drawings\</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: green; line-height: 140%;">&#39; and make sure to create a empty Site named &quot;Site 1&quot;(if it is already not there in the DWG file), also draw a polyline to convert it to Alignment.</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> alignId </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> = </span><span style="color: blue; line-height: 140%;">Nothing</span></p>
<p style="margin: 0px;"><strong><span style="line-height: 140%;">&#0160; &#0160; &#0160; alignId = </span><span style="color: #2b91af; line-height: 140%;">Alignment</span><span style="line-height: 140%;">.<span style="background-color: #ffff00;">Create</span>(civilDoc, poptions, </span><span style="color: #a31515; line-height: 140%;">&quot;Test_Alignment&quot;</span><span style="line-height: 140%;">, </span><span style="color: #a31515; line-height: 140%;">&quot;Site 1&quot;</span><span style="line-height: 140%;">, </span><span style="color: #a31515; line-height: 140%;">&quot;0&quot;</span><span style="line-height: 140%;">, </span><span style="color: #a31515; line-height: 140%;">&quot;Design Style&quot;</span><span style="line-height: 140%;">, </span><span style="color: #a31515; line-height: 140%;">&quot;All Labels&quot;</span><span style="line-height: 140%;">)</span></strong></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; trans.Commit()</span></p>
</div>
<p>Once you build your application using the above code snippet and run the custom command in Civil 3D 2013, you should see the Alignment created (like below ) :</p>
<p>&#0160;</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b016306bf0669970d-pi" style="display: inline;"><img alt="Alignment" class="asset  asset-image at-xid-6a0167607c2431970b016306bf0669970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b016306bf0669970d-500wi" title="Alignment" /></a></p>
<p>&#0160;</p>
<p>Hope this helps!</p>
<p>&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Christopher
EMAIL: Christopher@Civil3DReminders.com
IP: 64.134.235.183
URL: http://blog.civil3dreminders.com/
DATE: 07/01/2012 09:19:07 AM
What controls the radius of the curves? I was thinking it should come from the SettingsCmdCreateAlignmentEntities values, but it appears to apply a random radius to the polyline. 
alignmentCreateSettings.CreateFromEntities.Radius.Value
-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 115.112.233.72
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 07/02/2012 01:21:24 AM
Hi Chris,

I did a quick test and I find Radius of the curve is determined by the value set for "Default radius" under 'Create from Entities' in "Edit Command Settings - CreateAlignmentEntities".

I have just posted the following with more details - 
<a href="http://adndevblog.typepad.com/infrastructure/2012/07/what-controls-the-radius-of-the-curves-when-we-create-alignment.html">http://adndevblog.typepad.com/infrastructure/2012/07/what-controls-the-radius-of-the-curves-when-we-create-alignment.html</a> 

Does it help ?

Thanks,
Partha

-----
COMMENT:
AUTHOR: ven
EMAIL: 150145399@qq.com
IP: 218.104.207.163
URL: 
DATE: 04/07/2013 05:47:32 AM
HI, how to pick up a station on a alignment by api? thanks.
-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 203.202.234.243
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 04/15/2013 05:04:27 AM
Hi Ven,

You can use the following API :

Alignment.StationOffset 
Alignment.GetStationSet


Does it help ?

Thanks,
Partha 
A D N
-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Creating an Alignment Style Object using .NET API 
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: creating-an-alignment-style-object-using-net-api-
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/06/creating-an-alignment-style-object-using-net-api-.html 
DATE: 06/19/2012 04:02:47 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>This sample Demonstrates creating Alignment Style using the new .NET API in AutoCAD Civil 3D 2013</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> oAlignmentSTName </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">String</span><span style="line-height: 140%;"> = </span><span style="color: #a31515; line-height: 140%;">&quot;Demo_Alignment_Style&quot;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> oAlignmentStyle </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> Autodesk.Civil.DatabaseServices.Styles.</span><span style="color: #2b91af; line-height: 140%;">AlignmentStyle</span><span style="line-height: 140%;"> = </span><span style="color: blue; line-height: 140%;">Nothing</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> alignmentStyleId </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">&#39; Check if a style by this name already exists.&#0160; </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">Try</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; alignmentStyleId = civilDoc.Styles.AlignmentStyles.Item(oAlignmentSTName)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">If</span><span style="line-height: 140%;"> (alignmentStyleId.IsValid) </span><span style="color: blue; line-height: 140%;">Then</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; MsgBox(</span><span style="color: #a31515; line-height: 140%;">&quot;Style : &quot;</span><span style="line-height: 140%;"> + oAlignmentSTName.ToString + </span><span style="color: #a31515; line-height: 140%;">&quot; &quot;</span><span style="line-height: 140%;"> + </span><span style="color: #a31515; line-height: 140%;">&quot;Already exists in thsi Dwg !&quot;</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Exit Sub</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">If</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">Catch</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; alignmentStyleId = Autodesk.AutoCAD.DatabaseServices.</span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;">.Null</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Try</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">If</span><span style="line-height: 140%;"> (alignmentStyleId.IsNull) </span><span style="color: blue; line-height: 140%;">Then</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; alignmentStyleId = civilDoc.Styles.AlignmentStyles.Add(oAlignmentSTName)</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">If</span><span style="line-height: 140%;"> (alignmentStyleId = </span><span style="color: blue; line-height: 140%;">Nothing</span><span style="line-height: 140%;">) </span><span style="color: blue; line-height: 140%;">Then</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; MsgBox(</span><span style="color: #a31515; line-height: 140%;">&quot;Error setting an Alignment Style: &quot;</span><span style="line-height: 140%;"> &amp; Err.Description)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">If</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">If</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; oAlignmentStyle = trans.GetObject(alignmentStyleId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForWrite)</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">&#39; Getting and setting style attributes for StyleBase objects </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">&#39;requires using a GetDisplayStyle*() method rather than a property.</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; oAlignmentStyle.GetDisplayStyleModel(</span><span style="color: #2b91af; line-height: 140%;">AlignmentDisplayStyleType</span><span style="line-height: 140%;">.Arrow).Visible = </span><span style="color: blue; line-height: 140%;">False</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; oAlignmentStyle.GetDisplayStylePlan(</span><span style="color: #2b91af; line-height: 140%;">AlignmentDisplayStyleType</span><span style="line-height: 140%;">.Arrow).Visible = </span><span style="color: blue; line-height: 140%;">False</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">&#39; Display curves using a green color </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; oAlignmentStyle.GetDisplayStyleModel(</span><span style="color: #2b91af; line-height: 140%;">AlignmentDisplayStyleType</span><span style="line-height: 140%;">.Curve).Color = Autodesk.AutoCAD.Colors.</span><span style="color: #2b91af; line-height: 140%;">Color</span><span style="line-height: 140%;">.FromRgb(58, 191, 13)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; oAlignmentStyle.GetDisplayStylePlan(</span><span style="color: #2b91af; line-height: 140%;">AlignmentDisplayStyleType</span><span style="line-height: 140%;">.Curve).Color = Autodesk.AutoCAD.Colors.</span><span style="color: #2b91af; line-height: 140%;">Color</span><span style="line-height: 140%;">.FromRgb(58, 191, 13)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; oAlignmentStyle.GetDisplayStyleModel(</span><span style="color: #2b91af; line-height: 140%;">AlignmentDisplayStyleType</span><span style="line-height: 140%;">.Curve).Visible = </span><span style="color: blue; line-height: 140%;">True</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; oAlignmentStyle.GetDisplayStylePlan(</span><span style="color: #2b91af; line-height: 140%;">AlignmentDisplayStyleType</span><span style="line-height: 140%;">.Curve).Visible = </span><span style="color: blue; line-height: 140%;">True</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">&#39; Display straight sections in blue.</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; oAlignmentStyle.GetDisplayStyleModel(</span><span style="color: #2b91af; line-height: 140%;">AlignmentDisplayStyleType</span><span style="line-height: 140%;">.Line).Color = Autodesk.AutoCAD.Colors.</span><span style="color: #2b91af; line-height: 140%;">Color</span><span style="line-height: 140%;">.FromRgb(0, 0, 255) </span><span style="color: green; line-height: 140%;">&#39; blue</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; oAlignmentStyle.GetDisplayStylePlan(</span><span style="color: #2b91af; line-height: 140%;">AlignmentDisplayStyleType</span><span style="line-height: 140%;">.Line).Color = Autodesk.AutoCAD.Colors.</span><span style="color: #2b91af; line-height: 140%;">Color</span><span style="line-height: 140%;">.FromRgb(0, 0, 255) </span><span style="color: green; line-height: 140%;">&#39; blue</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; oAlignmentStyle.GetDisplayStyleModel(</span><span style="color: #2b91af; line-height: 140%;">AlignmentDisplayStyleType</span><span style="line-height: 140%;">.Line).Visible = </span><span style="color: blue; line-height: 140%;">True</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; oAlignmentStyle.GetDisplayStylePlan(</span><span style="color: #2b91af; line-height: 140%;">AlignmentDisplayStyleType</span><span style="line-height: 140%;">.Line).Visible = </span><span style="color: blue; line-height: 140%;">True</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; oAlignmentStyle.EnableRadiusSnap = </span><span style="color: blue; line-height: 140%;">True</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; oAlignmentStyle.RadiusSnapValue = 0.05 </span><span style="color: green; line-height: 140%;">&#39; set a Radius Snap Value</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; trans.Commit()</span></p>
</div>
<p>&#0160;</p>
<p>Once you build your application using the above code snippet and run the custom command in Civil 3D 2013, you should see the Alignment Style create (like below ) :</p>
<p>&#0160;</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b016767ad41c9970b-pi" style="display: inline;"><img alt="Alignment_Style" class="asset  asset-image at-xid-6a0167607c2431970b016767ad41c9970b" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b016767ad41c9970b-500wi" title="Alignment_Style" /></a><br /><br /></p>
<p>Hope this helps!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Using Draw property of ProfileOverride object to control the Draw-ability
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: using-draw-property-of-profileoverride-object-to-control-the-draw-ability
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2012
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/06/using-draw-property-of-profileoverride-object-to-control-the-draw-ability.html 
DATE: 06/15/2012 01:49:19 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p><strong>ProfileOverride</strong> object represents an individual profile in a profile view. It&#39;s <strong>Draw</strong> property gives us the control whether this entity will be drawn in the graph. Using this Draw property we can hide or show a specific Profile in a Profile view.&#0160;</p>
<p>Here is a C# code snippet which demonstrates the same :</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">//start a transaction </span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">Transaction</span><span style="line-height: 140%;"> trans = db.TransactionManager.StartTransaction())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">//open the profile view </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">ProfileView</span><span style="line-height: 140%;"> pv = trans.GetObject(per.ObjectId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForWrite) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">ProfileView</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">//for each profile </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nProfiles of this profile view:&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">foreach</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">ProfileOverride</span><span style="line-height: 140%;"> profOverride </span><span style="color: blue; line-height: 140%;">in</span><span style="line-height: 140%;"> pv.GraphOverrides)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">//print all profiles names and if is set as draw </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">Profile</span><span style="line-height: 140%;"> prof = trans.GetObject(profOverride.ProfileId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForRead) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Profile</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\n\t{0} - Draw: {1}&quot;</span><span style="line-height: 140%;">, prof.Name, profOverride.Draw);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// To hide the Profiles, set Draw Property to False</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (profOverride.Draw)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; profOverride.Draw = </span><span style="color: blue; line-height: 140%;">false</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; }</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; }</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// commit the Transaction</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; trans.Commit();</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;"><br /></span></p>
</div>
<p>Here is a Profile View which shows the Profiles in it :</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0167678b62ca970b-pi" style="display: inline;"><img alt="PV-01" class="asset  asset-image at-xid-6a0167607c2431970b0167678b62ca970b" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0167678b62ca970b-500wi" title="PV-01" /></a><br /><br /></p>
<p>And after running the above code snippet all the Profiles are now hidden in the same Profile View :</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01630697ca96970d-pi" style="display: inline;"><img alt="PV-02" class="asset  asset-image at-xid-6a0167607c2431970b01630697ca96970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01630697ca96970d-500wi" title="PV-02" /></a><br /><br /></p>
<p>Hope this helps !</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Want to Add a SuperelevationCriticalStation using Civil 3D .NET API ?
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: want-to-add-a-superelevationcriticalstation-using-civil-3d-net-api-
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2012
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/06/want-to-add-a-superelevationcriticalstation-using-civil-3d-net-api-.html 
DATE: 06/14/2012 02:32:44 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>In AutoCAD Civil 3D, <strong>SuperelevationCriticalStation</strong> class represents a super-elevation critical station on an <strong>Alignment</strong> object. And <strong>SuperelevationCriticalStationCollection</strong> class represents a collection of SuperelevationCriticalStation objects. <em><strong>SuperelevationCriticalStationCollection.Add()</strong></em> method adds a SuperelevationCriticalStation of the specified transition type at the specified station. For the list of SuperelevationCriticalStationType members, take a look into the SuperelevationCriticalStationType Enumeration in Civil 3D .NET API Reference document.&#0160;</p>
<p>Here is a C# &#0160;code snippet which demonstrates how to add a new critical station at a specified station value (double) with a <strong>SuperelevationCriticalStationType</strong> of <em><strong>BeginNormalCrown</strong></em> :</p>
<p><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">Transaction</span><span style="line-height: 140%;"> trans = db.TransactionManager.StartTransaction())</span></p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; {</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">Alignment</span><span style="line-height: 140%;"> align = trans.GetObject(alignmentId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForWrite) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Alignment</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// get the critical station collection on the aligment.</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">SuperelevationCriticalStationCollection</span><span style="line-height: 140%;"> criteriaStationColl = align.SuperelevationCriticalStations;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// add a new critical station at the station 1000.00 with a type BeginNormalCrown.</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">// values used below can be tested using Civil 3D Tutorial sample DWG file - &quot;Align-Superelevation-1.dwg &quot; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; criteriaStationColl.Add(1000.00, </span><span style="color: #2b91af; line-height: 140%;">SuperelevationCriticalStationType</span><span style="line-height: 140%;">.BeginNormalCrown);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: green; line-height: 140%;">// get the critical station at the station 1000.00.</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">SuperelevationCriticalStation</span><span style="line-height: 140%;"> scs1000 = criteriaStationColl.GetCriticalStationAt(1000.00, 0.01);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; scs1000.SetSlope(</span><span style="color: #2b91af; line-height: 140%;">SuperelevationCrossSegmentType</span><span style="line-height: 140%;">.LeftOutLaneCrossSlope, 0.05);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: green; line-height: 140%;">//....</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; trans.Commit();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
<p>&#0160;</p>
<p>And you are expected to see a result similar to this :</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0163068ec2d8970d-pi" style="display: inline;"><img alt="SuperElevn" class="asset  asset-image at-xid-6a0167607c2431970b0163068ec2d8970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0163068ec2d8970d-500wi" title="SuperElevn" /></a></p>
<p>Hope this helps !</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: joantopo
EMAIL: joantopo@hotmail.com
IP: 88.7.221.6
URL: 
DATE: 09/28/2013 07:50:32 AM
Hi.

I´m trying to do the same but SuperelevationCriticalStationType= BeginAlignment.

BeginAlingment station=0

// get the critical station at the station 0.000
      SuperelevationCriticalStation scs1000 = criteriaStationColl.GetCriticalStationAt(0, 0.01);
      scs1000.SetSlope(SuperelevationCrossSegmentType.LeftOutLaneCrossSlope, -0.02);

But I Civil 3D doesn´t change slopes for BeginAlingment.

If I edit a superelevations *.csv file (for the first row-->beginalignment slopes) and then export again the file, I neither change slopes.

Help me, pleease.
-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 59.92.205.254
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 10/03/2013 02:45:30 AM
Hi joantopo,

It seems to be working fine for me. I checked in Civil 3D 2014 (Win 7, 64 bit) and I could set the Slope for BeginAlignment.

Could you check the slope value before you try to set it ?
double getSlopeValue = scsStartStn.GetSlope(SuperelevationCrossSegmentType.LeftOutLaneCrossSlope);

For me this worked fine - 

scsStartStn.SetSlope(SuperelevationCrossSegmentType.LeftOutLaneCrossSlope, -0.04);

Thanks,
Partha Sarkar
ADN
-----
COMMENT:
AUTHOR: Martin
EMAIL: martin.folber@cadstudio.cz
IP: 194.228.205.74
URL: http://www.cadstudio.cz
DATE: 01/06/2014 01:47:27 AM
Hi guys, we have very first snippet code, what we already tried… to set superelevation values in editor table. The problem is, that Critical superelevation stations and its values are somehow disordered. Can you help me, why?

CivilDocument doc = CivilApplication.ActiveDocument;

using (Transaction tr = Autodesk.AutoCAD.ApplicationServices.Application.DocumentManager.MdiActiveDocument.TransactionManager.StartTransaction())
{
foreach (ObjectId aligmentID in doc.GetAlignmentIds())
{
Alignment al = aligmentID.GetObject(OpenMode.ForWrite) as Alignment;

SuperelevationCriticalStationCollection criteriaStationColl = al.SuperelevationCriticalStations;

al.SuperelevationCriticalStations.Add(10, Autodesk.Civil.SuperelevationCriticalStationType.EndNormalCrown);
SuperelevationCriticalStation st = criteriaStationColl.GetCriticalStationAt(10, 0.01);
st.SetSlope(Autodesk.Civil.SuperelevationCrossSegmentType.LeftOutLaneCrossSlope, -0.025);
st.SetSlope(Autodesk.Civil.SuperelevationCrossSegmentType.RightOutLaneCrossSlope, -0.025);

al.SuperelevationCriticalStations.Add(30, Autodesk.Civil.SuperelevationCriticalStationType.LevelCrown);
st = criteriaStationColl.GetCriticalStationAt(30, 0.01);
st.SetSlope(Autodesk.Civil.SuperelevationCrossSegmentType.LeftOutLaneCrossSlope, 0);
st.SetSlope(Autodesk.Civil.SuperelevationCrossSegmentType.RightOutLaneCrossSlope, -0.025);

al.SuperelevationCriticalStations.Add(50, Autodesk.Civil.SuperelevationCriticalStationType.ReverseCrown);
st = criteriaStationColl.GetCriticalStationAt(50, 0.01);
st.SetSlope(Autodesk.Civil.SuperelevationCrossSegmentType.LeftOutLaneCrossSlope, 0.025);
st.SetSlope(Autodesk.Civil.SuperelevationCrossSegmentType.RightOutLaneCrossSlope, -0.025);

al.SuperelevationCriticalStations.Add(70, Autodesk.Civil.SuperelevationCriticalStationType.BeginFullSuper);
st = criteriaStationColl.GetCriticalStationAt(70, 0.01);
st.SetSlope(Autodesk.Civil.SuperelevationCrossSegmentType.LeftOutLaneCrossSlope, 0.07);
st.SetSlope(Autodesk.Civil.SuperelevationCrossSegmentType.RightOutLaneCrossSlope, -0.07);

al.SuperelevationCriticalStations.Add(110, Autodesk.Civil.SuperelevationCriticalStationType.EndFullSuper);
st = criteriaStationColl.GetCriticalStationAt(110, 0.01);
st.SetSlope(Autodesk.Civil.SuperelevationCrossSegmentType.LeftOutLaneCrossSlope, 0.07);
st.SetSlope(Autodesk.Civil.SuperelevationCrossSegmentType.RightOutLaneCrossSlope, -0.05);

al.SuperelevationCriticalStations.Add(130, Autodesk.Civil.SuperelevationCriticalStationType.ReverseCrown);
st = criteriaStationColl.GetCriticalStationAt(130, 0.01);
st.SetSlope(Autodesk.Civil.SuperelevationCrossSegmentType.LeftOutLaneCrossSlope, 0.025);
st.SetSlope(Autodesk.Civil.SuperelevationCrossSegmentType.RightOutLaneCrossSlope, -0.025);

al.SuperelevationCriticalStations.Add(150, Autodesk.Civil.SuperelevationCriticalStationType.LevelCrown);
st = criteriaStationColl.GetCriticalStationAt(150, 0.01);
st.SetSlope(Autodesk.Civil.SuperelevationCrossSegmentType.LeftOutLaneCrossSlope, 0);
st.SetSlope(Autodesk.Civil.SuperelevationCrossSegmentType.RightOutLaneCrossSlope, -0.025);

al.SuperelevationCriticalStations.Add(170, Autodesk.Civil.SuperelevationCriticalStationType.BeginNormalCrown);
st = criteriaStationColl.GetCriticalStationAt(170, 0.01);
st.SetSlope(Autodesk.Civil.SuperelevationCrossSegmentType.LeftOutLaneCrossSlope, -0.025);
st.SetSlope(Autodesk.Civil.SuperelevationCrossSegmentType.RightOutLaneCrossSlope, -0.025);

}
tr.Commit();
}


Thanks
Martin
-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Cropping a Civil 3D TinSurface using .NET API TinSurface.CreateByCropping()
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: cropping-a-civil-3d-tinsurface-using-net-api-tinsurfacecreatebycropping
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2012
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/06/cropping-a-civil-3d-tinsurface-using-net-api-tinsurfacecreatebycropping.html 
DATE: 06/14/2012 01:22:24 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>Using <strong>CreateByCropping( Database </strong><em>destDatabase</em><strong>, string </strong><em>surfaceName</em><strong>, ObjectId </strong><em>srcSurfaceId</em><strong>, Point2dCollection </strong><em>points</em><strong> )</strong> method we can create a new <strong>TinSurface</strong> by cropping from an existing source TinSurface. One important point to note here - You must specify the cropped area with at least 3 points.</p>
<p>Here is a C#.NET code snippet that demonstrates cropping a TinSurface :</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">Editor</span><span style="line-height: 140%;"> ed = </span><span style="color: #2b91af; line-height: 140%;">Application</span><span style="line-height: 140%;">.DocumentManager.MdiActiveDocument.Editor;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// select a&#0160; TIN surface</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">PromptEntityOptions</span><span style="line-height: 140%;"> opSelSurface = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">PromptEntityOptions</span><span style="line-height: 140%;">(</span><span style="color: #a31515; line-height: 140%;">&quot;\nSelect a TIN Surface: &quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; opSelSurface.SetRejectMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nOnly TIN Surface is allowed&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; opSelSurface.AddAllowedClass(</span><span style="color: blue; line-height: 140%;">typeof</span><span style="line-height: 140%;">(</span><span style="color: #2b91af; line-height: 140%;">TinSurface</span><span style="line-height: 140%;">), </span><span style="color: blue; line-height: 140%;">true</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; opSelSurface.AppendKeywordsToMessage = </span><span style="color: blue; line-height: 140%;">true</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">PromptEntityResult</span><span style="line-height: 140%;"> resSelSurface = ed.GetEntity(opSelSurface);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> surfaceId = resSelSurface.ObjectId;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// select a polyline boundary</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">PromptEntityOptions</span><span style="line-height: 140%;"> opSelPolyline = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">PromptEntityOptions</span><span style="line-height: 140%;">(</span><span style="color: #a31515; line-height: 140%;">&quot;\nSelect a boundary curve: &quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; opSelPolyline.SetRejectMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nOnly polylines allowed&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; opSelPolyline.AddAllowedClass(</span><span style="color: blue; line-height: 140%;">typeof</span><span style="line-height: 140%;">(</span><span style="color: #2b91af; line-height: 140%;">Polyline</span><span style="line-height: 140%;">), </span><span style="color: blue; line-height: 140%;">false</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; opSelPolyline.AppendKeywordsToMessage = </span><span style="color: blue; line-height: 140%;">true</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">PromptEntityResult</span><span style="line-height: 140%;"> resSelPolyline = ed.GetEntity(opSelPolyline);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> polylineId = resSelPolyline.ObjectId;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// We will use the area2d to access the cropped surface 2d area</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">double</span><span style="line-height: 140%;"> area2d = 0.0; </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">Database</span><span style="line-height: 140%;"> destDb = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Database</span><span style="line-height: 140%;">(</span><span style="color: blue; line-height: 140%;">true</span><span style="line-height: 140%;">, </span><span style="color: blue; line-height: 140%;">true</span><span style="line-height: 140%;">))</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">Database</span><span style="line-height: 140%;"> db = </span><span style="color: #2b91af; line-height: 140%;">Application</span><span style="line-height: 140%;">.DocumentManager.MdiActiveDocument.Database;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">Transaction</span><span style="line-height: 140%;"> transSrc = db.TransactionManager.StartTransaction())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">Transaction</span><span style="line-height: 140%;"> transDest = destDb.TransactionManager.StartTransaction())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">Polyline</span><span style="line-height: 140%;"> pline = transSrc.GetObject(polylineId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForRead) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Polyline</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">Point2dCollection</span><span style="line-height: 140%;"> points = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Point2dCollection</span><span style="line-height: 140%;">();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">for</span><span style="line-height: 140%;"> (</span><span style="color: blue; line-height: 140%;">int</span><span style="line-height: 140%;"> i = 0, size = pline.NumberOfVertices; i &lt; size; i++)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; points.Add(pline.GetPoint2dAt(i));</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">HostApplicationServices</span><span style="line-height: 140%;">.WorkingDatabase = destDb;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> newSurfaceId = </span><span style="color: #2b91af; line-height: 140%;">TinSurface</span><span style="line-height: 140%;">.CreateByCropping(destDb, </span><span style="color: #a31515; line-height: 140%;">&quot;Surface&lt;[Next Counter(CP)]&gt;&quot;</span><span style="line-height: 140%;">, surfaceId, points);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">TinSurface</span><span style="line-height: 140%;"> newSurface = transDest.GetObject(newSurfaceId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForRead) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">TinSurface</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; </span><span style="color: green; line-height: 140%;">// Get the area 2d of the cropped surface</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">TerrainSurfaceProperties</span><span style="line-height: 140%;"> props = newSurface.GetTerrainProperties();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; area2d = props.SurfaceArea2D;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">HostApplicationServices</span><span style="line-height: 140%;">.WorkingDatabase = db;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; }</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nArea 2D of cropped Surface : &quot;</span><span style="line-height: 140%;"> + area2d.ToString());</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">} </span></p>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Project does not compile after applying SP1/SP2 for Map 3D 2012
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: project-does-not-compile-after-applying-sp1-for-map-3d-2012
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/06/project-does-not-compile-after-applying-sp1-for-map-3d-2012.html 
DATE: 06/13/2012 04:24:28 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>You may find your .net project does not compile any more after installing Service Pack 1 or Service pack 2 for Map 3D 2012, the error message is similar like below: </p>  <p>For SP1:    <br />------------------------</p>  <p>Error 1 The project currently contains references to more than one version of OSGeo.MapGuide.PlatformBase, a direct reference to version 2.3.0.5080 and an indirect reference (through 'Autodesk.Gis.Map.Platform.AcMapMap') to version 2.3.0.5084. Change the direct reference to use version 2.3.0.5084 (or higher) of OSGeo.MapGuide.PlatformBase.</p>  <p>&#160;</p>  <p>For SP2:   <br />------------------------</p>  <p>Error 1 The project currently contains references to more than one version of OSGeo.MapGuide.PlatformBase, a direct reference to version 2.3.0.5080 and an indirect reference (through 'Autodesk.Gis.Map.Platform.Interop.AcMapFeatureEntityService') to version 2.3.0.5086. Change the direct reference to use version 2.3.0.5086 (or higher) of OSGeo.MapGuide.PlatformBase. </p>  <p>&#160;</p>  <p>This is a known issue caused by Map 3D 2012 Service Pack, here is the workaround to solved this problem: </p>  <p>1. Uninstall Map 3D 2012 completely if you have already applied SP1;</p>  <p>2. Install Map 3D 2012 RTM version;</p>  <p>3. Rename following dlls in both the locations -</p>  <p>C:\Program Files\Autodesk\AutoCAD Map 3D 2012    <br />C:\Program Files\Autodesk\AutoCAD Map 3D 2012\bin\GisPlatform     <br /><strong>OSGeo.MapGuide.Foundation.dll</strong> to&#160; OSGeo.MapGuide.Foundation_bak.dll</p>  <p><strong>OSGeo.MapGuide.Geometry.dll</strong>&#160; to OSGeo.MapGuide.Geometry_bak.dll</p>  <p><strong>OSGeo.MapGuide.PlatformBase.dll</strong> to OSGeo.MapGuide.PlatformBase_bak.dll     <br />4.&#160;&#160;&#160;&#160;&#160; Apply Map 3D 2012 SP1</p>  <p>5.&#160;&#160;&#160;&#160;&#160; Create VB.net/C# project, add reference and test. It should work fine.</p>  <p>&#160;</p>  <p>If you are using Map 3D SP2, <a href="http://usa.autodesk.com/adsk/servlet/ps/dl/item?siteID=123112&amp;id=20044797&amp;linkID=9240858" target="_blank">here is a hotfix</a>. Hope this helps.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Set a negative Elevation value using ProfilePVI::Elevation
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: set-a-negative-elevation-value-using-profilepvielevation
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/06/set-a-negative-elevation-value-using-profilepvielevation.html 
DATE: 06/13/2012 02:23:21 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>AutoCAD Civil 3D .NET API <strong>ProfilePVI.Elevation</strong> allows us to get or set the elevation value of the PVI. There was some issue around setting a negative elevation value using ProfilePVI.Elevation API in Civil 3D 2012 and the same is addressed now in Civil 3D 2013 .NET API.</p>
<p>Here is a VB.NET code snippet which demonstrates how to set a negative elevation value to a PVI object in AutoCAD Civil 3D 2013:</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">Using</span><span style="line-height: 140%;"> (trans)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">&#39; Select the Profile</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> promptEntOp </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">New</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">PromptEntityOptions</span><span style="line-height: 140%;">(vbCrLf + </span><span style="color: #a31515; line-height: 140%;">&quot;Select a Profile : &quot;</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> promptEntRs </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">PromptEntityResult</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; promptEntRs = ed.GetEntity(promptEntOp)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">If</span><span style="line-height: 140%;"> promptEntRs.Status &lt;&gt; </span><span style="color: #2b91af; line-height: 140%;">PromptStatus</span><span style="line-height: 140%;">.OK </span><span style="color: blue; line-height: 140%;">Then</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;Exiting! Try Again !&quot;</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Exit Sub</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">If</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> idEnt </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> = promptEntRs.ObjectId</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">&#39;&#39; Get the Profile object</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> profile </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Profile</span><span style="line-height: 140%;"> = trans.GetObject(idEnt, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForRead)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> o_PVI </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">ProfilePVI</span><span style="line-height: 140%;"> = profile.PVIs.Item(1)</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; ed.WriteMessage(vbCrLf + </span><span style="color: #a31515; line-height: 140%;">&quot;PVI Station : &quot;</span><span style="line-height: 140%;"> + o_PVI.Station.ToString() + </span><span style="color: #a31515; line-height: 140%;">&quot;&#0160;&#0160; &quot;</span><span style="line-height: 140%;"> + </span><span style="color: #a31515; line-height: 140%;">&quot;PVI Elevation : &quot;</span><span style="line-height: 140%;"> + o_PVI.Elevation.ToString())</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: green; line-height: 140%;">&#39; Try chnaging the PVI Elevation value now </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Try</span><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; o_PVI.Elevation = -3.0 </span><span style="color: green; line-height: 140%;">&#39;&#39; This value is specific to a test DWG file </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; ed.WriteMessage(vbCrLf + </span><span style="color: #a31515; line-height: 140%;">&quot;PVI Elevation after Change&#0160; : &quot;</span><span style="line-height: 140%;"> + o_PVI.Elevation.ToString())</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Catch</span><span style="line-height: 140%;"> ex </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Exception</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; MsgBox(ex.Message, </span><span style="color: #2b91af; line-height: 140%;">MsgBoxStyle</span><span style="line-height: 140%;">.Critical, )</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Exit Sub</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; </span><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Try</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Using</span></p>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:
ProfilePVI, Elevation, Civil 3D, .NET API
-----
COMMENT:
AUTHOR: TyroneK
EMAIL: tkarapita@urbansystems.ca
IP: 139.142.80.97
URL: 
DATE: 06/14/2012 10:10:13 AM
My thanks to the C3D crew for fixing this. Could you share with us why this was broken prior to 2013?
-----
COMMENT:
AUTHOR: Partha
EMAIL: partha.sarkar@autodesk.com
IP: 115.112.233.72
URL: 
DATE: 06/19/2012 11:16:07 PM
Glad to know that you are happy about it now :)

Somehow it slipped through the cracks in previous release. Got it fixed now.

Thanks,
Partha
-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Extract Civil 3D Surface border using .NET API ExtractBorder() - Part II 
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: extract-civil-3d-surface-border-using-net-api-extractborder-part-ii-
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/06/extract-civil-3d-surface-border-using-net-api-extractborder-part-ii-.html 
DATE: 06/12/2012 02:47:32 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>In <a href="http://adndevblog.typepad.com/infrastructure/2012/06/extract-civil-3d-surface-border-using-net-api-extractborder.html" target="_self">previous post</a> I shared a C# .NET code snippet on usage of ExtractBorder(). Interestingly, the extracted entities from the <strong>ExtractBorder()</strong> function can be Polyline, Polyline3d, or Face. In this post we will explore various situations which will return Polyline, Polyline3d, or Face.</p>
<p>Here is a situation when <strong>ExtractBorder()</strong> will return <em><strong>Polyline3d</strong></em> :&#0160;If Surface “Border Display Mode” is set to “Use Surface Elevation” Or “Exaggerate Elevation” then the Extracted entity using the ExtractBorder() .NET API is of type Polyline3d. &#0160;</p>
<p>&#0160;</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0167676547eb970b-pi" style="display: inline;"><img alt="Surface_Border_01" class="asset  asset-image at-xid-6a0167607c2431970b0167676547eb970b" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0167676547eb970b-500wi" title="Surface_Border_01" /></a></p>
<p>&#0160;</p>
<p>Here is a situation when <strong>ExtractBorder()</strong> will return <em><strong>Polyline</strong></em> : &#0160;If Surface “Border Display Mode” is set to “Flatten Elevations” then the Extracted entity using the ExtractBorder() .NET API is of type Polyline.</p>
<p>&#0160;</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0176155ac538970c-pi" style="display: inline;"><img alt="Surface_Border_02" class="asset  asset-image at-xid-6a0167607c2431970b0176155ac538970c" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0176155ac538970c-500wi" title="Surface_Border_02" /></a></p>
<p>&#0160;</p>
<p>Here is a situation when <strong>ExtractBorder()</strong> will return <em><strong>Face</strong></em> : If Surface “Border Display Mode” is set to “Use Surface Elevation” and ‘Datum’ options are set to “Use Datum’ = True and ‘Project Grid to Datum’ = True,&#0160; then the Extracted entities will include 3D Face.</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b016306719223970d-pi" style="display: inline;"><img alt="Surface_Border_03" class="asset  asset-image at-xid-6a0167607c2431970b016306719223970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b016306719223970d-500wi" title="Surface_Border_03" /></a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Extract Civil 3D Surface border using .NET API ExtractBorder()  - Part I
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: extract-civil-3d-surface-border-using-net-api-extractborder
CATEGORY: .NET
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/06/extract-civil-3d-surface-border-using-net-api-extractborder.html 
DATE: 06/11/2012 05:14:22 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>In AutoCAD Civil 3D 2013 .NET API, <strong>ExtractBorder(</strong>SurfaceExtractionSettingsType&#0160;&#0160; <em>settingsType</em><strong>)</strong> is a new addition which extracts the surface border from the terrain surface.</p>
<p>You need to specify <em><strong>SurfaceExtractionSettingsType.Plan</strong></em> to extract the border information using the plan visual style settings, or <em><strong>SurfaceExtractionSettingsType.Model</strong></em> to use the model settings.</p>
<p>The extracted entities can be Polyline, Polyline3d, or Face. If the surface has no border information, this method returns an empty ObjectIdCollection.</p>
<p>Here is C# .NET code snippet which demonstrates usage of ExtractBorder() :</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">TinSurface</span><span style="line-height: 140%;"> surface = trans.GetObject(surfaceId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForRead) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">TinSurface</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// Extract Border from the TinSurface</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: green; line-height: 140%;">// The extracted entities can be Polyline, Polyline3d, or Face.</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: #2b91af; line-height: 140%;">ObjectIdCollection</span><span style="line-height: 140%;"> entityIds;&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; entityIds = surface.ExtractBorder(Autodesk.Civil.</span><span style="color: #2b91af; line-height: 140%;">SurfaceExtractionSettingsType</span><span style="line-height: 140%;">.Plan);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">for</span><span style="line-height: 140%;"> (</span><span style="color: blue; line-height: 140%;">int</span><span style="line-height: 140%;"> i = 0; i &lt; entityIds.Count; i++)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> entityId = entityIds[i];</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (entityId.ObjectClass == </span><span style="color: #2b91af; line-height: 140%;">RXClass</span><span style="line-height: 140%;">.GetClass(</span><span style="color: blue; line-height: 140%;">typeof</span><span style="line-height: 140%;">(</span><span style="color: #2b91af; line-height: 140%;">Polyline3d</span><span style="line-height: 140%;">)))</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: #2b91af; line-height: 140%;">Polyline3d</span><span style="line-height: 140%;"> border = entityId.GetObject(</span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForWrite) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Polyline3d</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: green; line-height: 140%;">// Do what you want with the extrated 3d-polyline</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; }</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; }</span></p>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Changing the format of measure result of fusion viewer
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: changing-the-format-of-measure-result-of-fusion-viewer
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: MapGuide Enterprise 2011

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/06/changing-the-format-of-measure-result-of-fusion-viewer.html 
DATE: 06/03/2012 08:49:47 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>If you are using measure widget of Fusion viewer, you will notice that the measure result if in exponential format, like 4.91e+5m. Is it possible to the change the format? </p>  <p>Measure widget of fusion viewer uses following JavaScript code snippet to handle the output result:</p>  <p>C:\Program Files\Autodesk\Autodesk Infrastructure Web Server Extension 2012\www\fusion\widgets\Measure.js , around line 583:</p>  <p><font style="background-color: #ffff00">value = value.toPrecision(this.areaPrecision);</font></p>  <p>You can change this code to show the result as your preferred format. To make your changes take effect, you need to change the template file, for example, it is C:\Program Files\Autodesk\Autodesk Infrastructure Web Server Extension 2012\www\fusion\templates\mapguide\slate\index.html for Slate template: </p>  <p>Change from:</p>  <p>&lt;script type=&quot;text/javascript&quot; src=&quot;../../../lib/fusionSF-compressed.js&quot;&gt;&lt;/script&gt;</p>  <p>To:</p>  <p>&lt;script type=&quot;text/javascript&quot; src=&quot;../../../lib/fusion.js&quot;&gt;&lt;/script&gt;</p>  <p>You may also want to check out this blog - <a href="http://adndevblog.typepad.com/infrastructure/2012/04/debugging-fusion-viewer-or-mobile-viewer-of-aims-in-firebug.html" target="_blank">Debugging Fusion Viewer or Mobile Viewer of AIMS in Firebug</a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Removing Object Data from an Entity using Map 3D API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: removing-all-object-data-from-an-entity-using-map-3d-api
CATEGORY: .NET
CATEGORY: AutoCAD Map 3D 2011
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/06/removing-all-object-data-from-an-entity-using-map-3d-api.html 
DATE: 06/01/2012 01:19:53 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>Often I come across the following question: <em>I want to remove Object Data from an entity in a DWG file and I have hundreds of such entities in that file. Is there an easy way using API I could do this?</em></p>
<p>Answer is &#39;<strong>Yes</strong>&#39; and we need to use <strong>Autodesk.Gis.Map.ObjectData.Records.RemoveRecord()</strong> to do this.&#0160;<br />Here is a <a class="zem_slink" href="http://en.wikipedia.org/wiki/Visual_Basic_.NET" rel="wikipedia" target="_blank" title="Visual Basic .NET">VB.NET</a> code snippet which shows how to remove Object Data from a selected entity in AutoCAD Map 3D:</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">Try</span><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> ed </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Editor</span><span style="line-height: 140%;"> = </span><span style="color: #2b91af; line-height: 140%;">Application</span><span style="line-height: 140%;">.DocumentManager.MdiActiveDocument.Editor</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> opSelect </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">New</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">PromptSelectionOptions</span><span style="line-height: 140%;">()</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> rsSelect </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">PromptSelectionResult</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> dbObj </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">DBObject</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; rsSelect = ed.GetSelection(opSelect)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">If</span><span style="line-height: 140%;"> rsSelect.Status &lt;&gt; </span><span style="color: #2b91af; line-height: 140%;">PromptStatus</span><span style="line-height: 140%;">.OK </span><span style="color: blue; line-height: 140%;">Then</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; MsgBox(</span><span style="color: #a31515; line-height: 140%;">&quot;fail&quot;</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Exit Sub</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">If</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> idCols </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">New</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">ObjectIdCollection</span><span style="line-height: 140%;">(rsSelect.Value.GetObjectIds())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> id </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">For</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Each</span><span style="line-height: 140%;"> id </span><span style="color: blue; line-height: 140%;">In</span><span style="line-height: 140%;"> idCols</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; dbObj = trans.GetObject(id, Autodesk.AutoCAD.DatabaseServices.</span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForWrite)</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: green; line-height: 140%;">&#39;&#39; Presuming OD Table &quot;MyTestODTable&quot; exist in the DWG file&#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> myTable </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> Autodesk.Gis.Map.ObjectData.</span><span style="color: #2b91af; line-height: 140%;">Table</span><span style="line-height: 140%;">&#0160; = odTables(</span><span style="color: #a31515; line-height: 140%;">&quot;MyTestODTable&quot;</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Using</span><span style="line-height: 140%;"> recs </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Records</span><span style="line-height: 140%;"> = myTable.GetObjectTableRecords(0, dbObj, Constants.</span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.OpenForWrite, </span><span style="color: blue; line-height: 140%;">True</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> ie </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">IEnumerator</span><span style="line-height: 140%;"> = recs.GetEnumerator()</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Do</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">While</span><span style="line-height: 140%;"> ie.MoveNext()</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; recs.RemoveRecord()</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Loop</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Using</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Next</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; trans.Commit()</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">Catch</span><span style="line-height: 140%;"> exc </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> Autodesk.Gis.Map.</span><span style="color: #2b91af; line-height: 140%;">MapException</span><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160;&#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; MsgBox(</span><span style="color: #a31515; line-height: 140%;">&quot;Error : &quot;</span><span style="line-height: 140%;"> + exc.Message.ToString())&#0160;&#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; </span><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Try</span></p>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Countdown begins for 'AEC DevCamp 2012' 
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: countdown-begins-for-aec-devcamp-2012-
CATEGORY: Events
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/05/countdown-begins-for-aec-devcamp-2012-.html 
DATE: 05/31/2012 02:56:05 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>In &#39;<a href="http://adndevblog.typepad.com/infrastructure/2012/04/aec-devcamp-2012.html" target="_self">AEC DevCamp 2012</a>&#39; post on 27-April-2012, we shared with you about the details of AEC DevCamp 2012. Time flies by; it&#39;s not even a week&#39;s wait now. Many of our DevTech team members are flying to Boston to participate and deliver some interesting API sessions in AEC DevCamp 2012. Some of our colleagues from engineering team are also joining us. Looking forward to a great week to meet you all in Boston!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Adding Object Data Records to Entity using Map 3D API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: adding-object-data-records-to-entity-using-map-3d-api
CATEGORY: AutoCAD Map 3D 2011
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/05/adding-object-data-records-to-entity-using-map-3d-api.html 
DATE: 05/31/2012 02:17:13 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>Many a times you want to add Object Data to entities in DWG file using Map 3D API. Using Map 3D C++ API or .NET API we can add object data to entities. Here is a VB.NET code snippet which shows how to add Object Data to a selected entity in AutoCAD Map 3D. One thing to note here - when you use <strong>AddRecord</strong><em>(record As Autodesk.Gis.Map.ObjectData.Record, dbObj As Autodesk.AutoCAD.DatabaseServices.DBObject)</em> make sure that&#0160;<strong>DBObject </strong>is <span style="text-decoration: underline;">open for write</span>, otherwise you are likely to see an exception message.</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Try</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> ed </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Editor</span><span style="line-height: 140%;"> = Autodesk.AutoCAD.ApplicationServices.</span><span style="color: #2b91af; line-height: 140%;">Application</span><span style="line-height: 140%;">.DocumentManager.MdiActiveDocument.Editor</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> prompt_result </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">PromptEntityResult</span><span style="line-height: 140%;"> = ed.GetEntity(vbCrLf + </span><span style="color: #a31515; line-height: 140%;">&quot;Select the object...&quot;</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; id = prompt_result.ObjectId</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> dbObj </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">DBObject</span><span style="line-height: 140%;"> = trans.GetObject(id, Autodesk.AutoCAD.DatabaseServices.</span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForWrite)</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: green; line-height: 140%;">&#39;&#39; Presuming OD Table &quot;MyTestODTable&quot; exist in the DWG file&#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; odTable = odTables.Item(</span><span style="color: #a31515; line-height: 140%;">&quot;MyTestODTable&quot;</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> odrecords </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> ObjectData.</span><span style="color: #2b91af; line-height: 140%;">Records</span><span style="line-height: 140%;"> = odTable.GetObjectTableRecords(</span><span style="color: #2b91af; line-height: 140%;">Convert</span><span style="line-height: 140%;">.ToUInt32(0), id, Constants.</span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.OpenForRead, </span><span style="color: blue; line-height: 140%;">False</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> odRecord </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> ObjectData.</span><span style="color: #2b91af; line-height: 140%;">Record</span><span style="line-height: 140%;"> = odrecords.Item(0)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; odRecord = Autodesk.Gis.Map.ObjectData.</span><span style="color: #2b91af; line-height: 140%;">Record</span><span style="line-height: 140%;">.Create()</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; odTable.InitRecord(odRecord)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> mapVal </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> Autodesk.Gis.Map.Utilities.</span><span style="color: #2b91af; line-height: 140%;">MapValue</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: green; line-height: 140%;">&#39;&#39; Add a Record and assign a value to it</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; mapVal = odRecord(0)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; mapVal.Assign(</span><span style="color: #a31515; line-height: 140%;">&quot;Test&quot;</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; mapVal = odRecord(1)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; mapVal.Assign(22)</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: green; line-height: 140%;">&#39; dbObj should be opened for Write, otherwise </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; odTable.AddRecord(odRecord, dbObj)&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; odRecord.Dispose()</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; odrecords.Dispose()</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; trans.Commit()</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">Catch</span><span style="line-height: 140%;"> exc </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> Autodesk.Gis.Map.</span><span style="color: #2b91af; line-height: 140%;">MapException</span><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160;&#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; MsgBox(</span><span style="color: #a31515; line-height: 140%;">&quot;Error : &quot;</span><span style="line-height: 140%;"> + exc.Message.ToString())&#0160;&#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160; &#0160; &#0160; &#0160; </span><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Try</span></p>
</div>
<p><br /><br />And here is the result :</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0168ebf8daf6970c-pi" style="display: inline;"><img alt="AddOD" class="asset  asset-image at-xid-6a0167607c2431970b0168ebf8daf6970c" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0168ebf8daf6970c-500wi" title="AddOD" /></a><br /><br /><br /></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Chuck
EMAIL: chuckwilbur@spatialnet.net
IP: 68.191.200.106
URL: 
DATE: 07/10/2012 11:47:49 AM
Where is the step where you get the odTables object? I don't see it Dimmed or set anywhere in your sample.
-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 115.112.233.72
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 07/10/2012 08:56:10 PM
Here you go :

  Dim db As Database = Application.DocumentManager.MdiActiveDocument.Database        
  Dim mapApp As MapApplication = Autodesk.Gis.Map.HostMapApplicationServices.Application
  Dim projModel As ProjectModel = mapApp.ActiveProject
  Dim odTable As ObjectData.Table
  Dim odTables As ObjectData.Tables = projModel.ODTables
  Dim id As ObjectId


Thanks for asking this,

Cheers,
Partha
-----
COMMENT:
AUTHOR: Anton Huizinga
EMAIL: a.huizinga@gmail.com
IP: 82.95.108.202
URL: 
DATE: 11/01/2012 12:45:02 AM
Is it possible to expand the FieldDefinitions in an existing Table? If I use the function myTable.FieldDefinitions.AddColumn(FieldDefinition.Create(...)) and debug it, the code does not generate an exception, it seems to run well, but the field does not exist in the table.



-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 203.202.234.243
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 11/01/2012 08:03:32 AM
Hi Anton,

Did you try calling Tables:: UpdateTable -> Updates the object data table in the project and all its active attached drawings. 

Does it help ?

Thanks,
Partha
-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Disposing COM objects
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: disposing-com-objects
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D 2011

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/05/disposing-com-objects.html 
DATE: 05/30/2012 12:21:07 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/autocad/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>While programming with Civil 3D COM objects, it is very common create <strong>AeccXxxx</strong> variables as class variables (modifiers <strong><em>shared</em></strong> in VB.NET or <strong><em>static</em></strong> in C#), like in the code below. This makes like easier, but leaves the Aecc reference longer than required, which can result in problems.</p>  <p>One way to improve that is call <strong>ReleaseComObject</strong> for each variable declared with this modifier. This is not required for variables declared inside methods, which are automatically disposed when the method ends. Also, as the <strong>AcadApplication</strong> is the host, there is no need to manually release it either.</p>  <div style="font-family: ; background: white">   <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">Private</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span><font color="#0000ff">Shared</font></span><font color="#000000"> _acadApp </font><span><font color="#0000ff">As</font></span><font color="#000000"> AcadApplication</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">Private</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span><font color="#0000ff">Shared</font></span><font color="#000000"> _aeccApp </font><span><font color="#0000ff">As</font></span><font color="#000000"> AeccApplication</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">Private</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span><font color="#0000ff">Sub</font></span><font color="#000000"> GetCivilObjects()</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' get Acad App</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; _acadApp = </font></font><font style="font-size: 8pt"><span><font color="#2b91af">Application</font></span><font color="#000000">.AcadApplication</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' get Aecc App</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; _aeccApp = _acadApp.GetInterfaceObject( _</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#a31515">&quot;AeccXUiLand.AeccApplication.10.0&quot;</font></span><font color="#000000">)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">End</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">Sub</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">' in the end (before exit) </font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">Private</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span><font color="#0000ff">Sub</font></span><font color="#000000"> ReleaseCivilObjects()</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' then release/dispose Aecc App</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; System.Runtime.InteropServices.</font></font><font style="font-size: 8pt"><span><font color="#2b91af">Marshal</font></span><font color="#000000">.ReleaseComObject(_aeccApp)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; _aeccApp = </font></font><span><font style="font-size: 8pt" color="#0000ff">Nothing</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">' call garbage collector (suggested only once at the end)</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; System.</font></font><font style="font-size: 8pt"><span><font color="#2b91af">GC</font></span><font color="#000000">.WaitForPendingFinalizers()</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; System.</font></font><font style="font-size: 8pt"><span><font color="#2b91af">GC</font></span><font color="#000000">.Collect()</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">End</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">Sub</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">Public</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font><span><font color="#0000ff">Sub</font></span><font color="#000000"> MyRoutine()</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; GetCivilObjects()</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">'use aeccApp the variable</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">'...</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">'...</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; ReleaseCivilObjects()</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">End</font></font></span><font style="font-size: 8pt"><font color="#000000"> </font></font><span><font style="font-size: 8pt" color="#0000ff">Sub</font></span></font></p> </div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Cannot build Civil 3D 2012 COM with .NET code after apply SP1
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: cannot-build-civil-3d-2012-com-with-net-code-after-apply-sp1
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D 2012

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/05/cannot-build-civil-3d-2012-com-with-net-code-after-apply-sp1.html 
DATE: 05/29/2012 11:42:43 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/autocad/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>After install <a href="http://usa.autodesk.com/adsk/servlet/ps/dl/item?siteID=123112&amp;id=18133124&amp;linkID=9240698">AutoCAD Civil 3D 2012 Update 1</a> you code may not compile COM based plug-ins due some registry number not properly set.</p>  <p>This registry fix file actually only modify the AEC’s COM version to 6.7.<strong>49</strong>.0 from 6.7.<strong>107</strong>.0, including 3 AEC type libraries: AEC Base, AEC UI Base, and AEC Details. It is required only on development machines, not on production (end-user) machines.</p>  <p><strong>Steps</strong>: copy the content below, according to your system platform (32 or 64 bit), paste new text document (e.g. using Notepad), save the file as .reg, then finally double click. Windows will apply the changes to the registry.</p>  <p>For 64 bit operation system</p>  <p><font color="#a5a5a5" size="1">Windows Registry Editor Version 5.00</font></p>  <p><font color="#a5a5a5" size="1">[HKEY_CLASSES_ROOT\TypeLib\{E8BEE100-BF69-431B-9153-1FF0DEF8F613}\6.7]     <br />&quot;PrimaryInteropAssemblyName&quot;=&quot;Autodesk.AEC.Interop.UIBase, Version=6.7.49.0, Culture=neutral, PublicKeyToken=d672471c03b2c408&quot;      <br />@=&quot;AEC Base 6.7 Application Library&quot;</font></p>  <p><font color="#a5a5a5" size="1">[HKEY_CLASSES_ROOT\TypeLib\{E8BEE300-BF69-431B-9153-1FF0DEF8F613}\6.7]     <br />&quot;PrimaryInteropAssemblyName&quot;=&quot;Autodesk.AEC.Interop.Base, Version=6.7.49.0, Culture=neutral, PublicKeyToken=d672471c03b2c408&quot;      <br />@=&quot;AEC Base 6.7 Object Library&quot;</font></p>  <p><font color="#a5a5a5" size="1">[HKEY_CLASSES_ROOT\TypeLib\{E8BEE900-BF69-431B-9153-1FF0DEF8F613}\6.7]     <br />&quot;PrimaryInteropAssemblyName&quot;=&quot;Autodesk.AEC.Interop.Details, Version=6.7.49.0, Culture=neutral, PublicKeyToken=d672471c03b2c408&quot;      <br />@=&quot;AEC Details 6.7 Object Library&quot;      <br /></font></p>  <p>For 32 bit operation system</p>  <p><font color="#a5a5a5" size="1">Windows Registry Editor Version 5.00</font></p>  <p><font color="#a5a5a5" size="1">[HKEY_CLASSES_ROOT\TypeLib\{E7BEE100-BF69-431B-9153-1FF0DEF8F613}\6.7]     <br />&quot;PrimaryInteropAssemblyName&quot;=&quot;Autodesk.AEC.Interop.UIBase, Version=6.7.49.0, Culture=neutral, PublicKeyToken=d672471c03b2c408&quot;      <br />@=&quot;AEC Base 6.7 Application Library&quot;</font></p>  <p><font color="#a5a5a5" size="1">[HKEY_CLASSES_ROOT\TypeLib\{E7BEE300-BF69-431B-9153-1FF0DEF8F613}\6.7]     <br />&quot;PrimaryInteropAssemblyName&quot;=&quot;Autodesk.AEC.Interop.Base, Version=6.7.49.0, Culture=neutral, PublicKeyToken=d672471c03b2c408&quot;      <br />@=&quot;AEC Base 6.7 Object Library&quot;</font></p>  <p><font color="#a5a5a5" size="1">[HKEY_CLASSES_ROOT\TypeLib\{E7BEE900-BF69-431B-9153-1FF0DEF8F613}\6.7]     <br />&quot;PrimaryInteropAssemblyName&quot;=&quot;Autodesk.AEC.Interop.Details, Version=6.7.49.0, Culture=neutral, PublicKeyToken=d672471c03b2c408&quot;      <br />@=&quot;AEC Details 6.7 Object Library&quot;      <br /></font></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Inserting FDO features into SQL Server using Geospatial Platform API in Map 3D
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 0
ALLOW PINGS: 0
BASENAME: inserting-fdo-features-into-sql-server-using-geospatial-platform-api-in-map-3d
CATEGORY: AutoCAD Map 3D 2011
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/05/inserting-fdo-features-into-sql-server-using-geospatial-platform-api-in-map-3d.html 
DATE: 05/29/2012 03:25:19 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>In this post, I will introduce how to insert FDO Features to SQL Server Spatial, but it also applies to other data source with minor or no changes. </p>  <p>Firstly, let’s look at some background knowledge. In Map 3D, There are two different modes for updates to features:</p>  <ul>   <li>Edit set </li>    <li>Direct update </li> </ul>  <p>Note: Some FDO providers, including the file-based providers SDF, SHP, and raster, do not support edit set mode.</p>  <p><a name="WS73099cc142f487555c552f11049cc4168-5fc6"></a>Updates made using edit set mode are made to the working copy inside the AutoCAD Map 3D application, but are not committed to the feature source. Edits made using direct update are changed in the feature source immediately.</p>  <p>There are two methods for updating features:</p>  <ul>   <li><a name="WS1a9193826455f5ff164958d1107793a39f-7ea"></a>AcMapLayer.UpdateFeatures() </li>    <li>MgFeatureService.UpdateFeatures() </li> </ul>  <p>AcMapLayer.UpdateFeatures() works directly with features in the map layer. This is the preferred method when working in edit set mode.</p>  <p><a name="WS1a9193826455f5ff164958d1107793a39f-7e9"></a>MgFeatureService.UpdateFeatures() updates the features in the feature source. This method can be used when the feature source is not being displayed in a layer. For example, an AutoCAD Map 3D application could create an SDF file containing result data without ever having to display the data.</p>  <p>To set the update mode for a layer, call AcMapLayer.SetEditSetMode().</p>  <p><a name="WS73099cc142f487551d88ee311015deade5-7c4"></a>To commit changes made in edit set mode, call AcMapLayer.SaveFeatureChanges(). This updates the feature source. To discard the changes, call AcMapLayer.DiscardFeatureChanges().</p>  <p>Here is a code sample to demonstrate how to insert FDO features into SQL Server spatial.</p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> System;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> System.Collections.Generic;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> System.Linq;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> System.Text;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> Autodesk.AutoCAD.ApplicationServices;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> Autodesk.AutoCAD.DatabaseServices;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> Autodesk.AutoCAD.Runtime;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> Autodesk.Gis.Map.Platform;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> OSGeo.MapGuide;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">namespace</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> CreateFeatureInSqlServer</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">{</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">public</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">class</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#2b91af">Class1</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; [</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">CommandMethod</font></span><span style="line-height: 11pt"><font color="#000000">(</font></span><span style="line-height: 11pt; color: "><font color="#a31515">&quot;InsertSqlServer&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">)]</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">public</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">void</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> InsertIntoSqlServer()</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">using</font></span><span style="line-height: 11pt"><font color="#000000"> (</font></span><span style="line-height: 11pt; color: "><font color="#2b91af">Transaction</font></span><span style="line-height: 11pt"><font color="#000000"> tr = </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">Application</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.DocumentManager</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; .MdiActiveDocument.Database.TransactionManager</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; .StartTransaction())</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">try</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">AcMapLayer</font></span><span style="line-height: 11pt"><font color="#000000"> layer = GetLayerByName(</font></span><span style="line-height: 11pt; color: "><font color="#a31515">&quot;FeatureClass1&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">if</font></span><span style="line-height: 11pt"><font color="#000000"> (layer != </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">null</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">)</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">Random</font></span><span style="line-height: 11pt"><font color="#000000"> rand = </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">Random</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">();</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">double</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> x = rand.NextDouble() * 180;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">double</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> y = rand.NextDouble() * 90;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">int</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> featId = rand.Next(100);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgGeometryFactory</font></span><span style="line-height: 11pt"><font color="#000000"> factory = </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MgGeometryFactory</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">();</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgCoordinate</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> mgCoord = factory.CreateCoordinateXY(x, y);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgPoint</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> mgPoint = factory.CreatePoint(mgCoord);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgAgfReaderWriter</font></span><span style="line-height: 11pt"><font color="#000000"> agf = </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MgAgfReaderWriter</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">();</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgByteReader</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> reader = agf.Write(mgPoint);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">// build up new property data</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">// our geometry plus the required table key (an integer)</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgPropertyCollection</font></span><span style="line-height: 11pt"><font color="#000000"> propCol = </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MgPropertyCollection</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">();</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">string</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> strGeomName = layer.GetFeatureGeometryName();</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgGeometryProperty</font></span><span style="line-height: 11pt"><font color="#000000"> prop = </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MgGeometryProperty</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">(</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; strGeomName, reader);</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; propCol.Add(prop);</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgInt32Property</font></span><span style="line-height: 11pt"><font color="#000000"> prop2 = </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MgInt32Property</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">(</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">&quot;featId&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">, featId);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; propCol.Add(prop2);</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">// insert the new feature into the layer</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; OSGeo.MapGuide.</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgFeatureCommandCollection</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> commands </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; = </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MgFeatureCommandCollection</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">();</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">string</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> strClassName = layer.GetFeatureClassName();</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgInsertFeatures</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> feature = </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MgInsertFeatures</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">(strClassName, propCol);</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; commands.Add(feature);</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; layer.UpdateFeatures(commands);</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">// save and update the layer</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgFeatureQueryOptions</font></span><span style="line-height: 11pt"><font color="#000000"> opt = </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MgFeatureQueryOptions</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">();</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">// build the filter string, this is required for </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">// data source such as Sql Server/Oracle...</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">String</font></span><span style="line-height: 11pt"><font color="#000000"> filter = </font></span><span style="line-height: 11pt; color: "><font color="#a31515">&quot;&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">if</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> (layer.IsCached()</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &amp;&amp; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">EditMode</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.EditSet == layer.EditMode)</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; filter = </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">ClassSystemProperties</font></span><span style="line-height: 11pt"><font color="#000000">.FeatureStatus + </font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#a31515">&quot; = &quot;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; + </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">ClassSystemProperties</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.FeatureStatusNew;</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; opt.SetFilter(filter);</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//This is a must</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; layer.SaveFeatureChanges(opt);</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; layer.ForceRefresh();</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; tr.Commit();</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">catch</font></span><span style="line-height: 11pt"><font color="#000000"> (System.</font></span><span style="line-height: 11pt; color: "><font color="#2b91af">Exception</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> ex)</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">Application</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.ShowAlertDialog(ex.Message);</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">private</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">static</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">AcMapLayer</font></span><span style="line-height: 11pt"><font color="#000000"> GetLayerByName(</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">string</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> layerName)</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">// get correct layer from current map</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">AcMapMap</font></span><span style="line-height: 11pt"><font color="#000000"> map = </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">AcMapMap</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.GetCurrentMap();</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgLayerCollection</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> layers = map.GetLayers();</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">AcMapLayer</font></span><span style="line-height: 11pt"><font color="#000000"> layer = </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">null</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">foreach</font></span><span style="line-height: 11pt"><font color="#000000"> (</font></span><span style="line-height: 11pt; color: "><font color="#2b91af">AcMapLayer</font></span><span style="line-height: 11pt"><font color="#000000"> layerLoop </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">in</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> layers)</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">string</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> strLayer = layerLoop.Name;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">if</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> (strLayer.Equals(layerName))</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; layer = layerLoop;</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">break</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">return</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> layer;</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; }</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">}</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p> </div>  <p>The definition of ClassSystemProperties is as following, you can use other members to build the filter string when modifying or deleting features.</p>  <div style="font-family: ; background: white; color: ">   <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">public</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">class</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#2b91af">ClassSystemProperties</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">{</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">// Fields</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">public</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">const</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">string</font></span><span style="line-height: 11pt"><font color="#000000"> FeatureLockStatus = </font></span><span style="line-height: 11pt; color: "><font color="#a31515">&quot;GwsLockMode&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">public</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">const</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">string</font></span><span style="line-height: 11pt"><font color="#000000"> FeatureStatus = </font></span><span style="line-height: 11pt; color: "><font color="#a31515">&quot;GwsStatus&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">public</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">const</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">int</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> FeatureStatusDeleted = 4;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">public</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">const</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">int</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> FeatureStatusModified = 2;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">public</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">const</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">int</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> FeatureStatusNew = 1;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">public</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">const</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">string</font></span><span style="line-height: 11pt"><font color="#000000"> SessionId = </font></span><span style="line-height: 11pt; color: "><font color="#a31515">&quot;GwsId&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">}</font></font></span></p> </div>  <pre><p>&#160;</p></pre>

<p>Another suggestion is to use FeatureService directly. please note that for data source support transaction, for example, SQL server or Oracle, you need to use transaction to update features, fs.UpdateFeatures(resId, commands,true); otherwise, it will not commit to data source immediately.</p>

<div style="font-family: ; background: white; color: ">
  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; [</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">CommandMethod</font></span><span style="line-height: 11pt"><font color="#000000">(</font></span><span style="line-height: 11pt; color: "><font color="#a31515">&quot;SQLInsert&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">)]</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">public</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">void</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> SqlServerUpdate()</font></span></font></p>

  <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></span></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgFeatureService</font></span><span style="line-height: 11pt"><font color="#000000"> fs = </font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#2b91af">AcMapServiceFactory</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; .GetService(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgServiceType</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.FeatureService) </font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">as</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MgFeatureService</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgResourceIdentifier</font></span><span style="line-height: 11pt"><font color="#000000"> resId = </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MgResourceIdentifier</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">(</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">&quot;Library://SqlServer_1.FeatureSource&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">);</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgGeometryFactory</font></span><span style="line-height: 11pt"><font color="#000000"> factory = </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MgGeometryFactory</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">();</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgGeometry</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> mgGeom = factory.CreatePoint(</font></span></font></p>

  <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; factory.CreateCoordinateXY(5, 5));</font></font></span></p>

  <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgAgfReaderWriter</font></span><span style="line-height: 11pt"><font color="#000000"> agfReadWrite = </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MgAgfReaderWriter</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">();</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgPropertyCollection</font></span><span style="line-height: 11pt"><font color="#000000"> propColl = </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MgPropertyCollection</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">();</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; propColl.Add(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MgInt32Property</font></span><span style="line-height: 11pt"><font color="#000000">(</font></span><span style="line-height: 11pt; color: "><font color="#a31515">&quot;Num&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">, 9));</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; propColl.Add(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MgGeometryProperty</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">(</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">&quot;Geometry&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">, </font></span></font></p>

  <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; agfReadWrite.Write(mgGeom)));</font></font></span></p>

  <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">string</font></span><span style="line-height: 11pt"><font color="#000000"> className = </font></span><span style="line-height: 11pt; color: "><font color="#a31515">&quot;Schema1:FeatureClass1&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgFeatureCommandCollection</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> commands = </font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MgFeatureCommandCollection</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">();</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">MgInsertFeatures</font></span><span style="line-height: 11pt"><font color="#000000"> ins = </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MgInsertFeatures</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">(</font></span></font></p>

  <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; className, propColl);</font></font></span></p>

  <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>

  <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; commands.Add(ins);</font></font></span></p>

  <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; fs.UpdateFeatures(resId, commands, </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">true</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">);</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>

  <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></span></p>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Firexoulz
EMAIL: fremorx_07@yahoo.com
IP: 112.202.20.50
URL: 
DATE: 05/31/2012 05:18:09 PM
Hello sir.. Thanks for this blog you've made. It's help someone like me who are just a beginner in this area of programming.. Can you please translate this in vb.net because I am just a vb.net programmer not  a C. It will be a great help for me and I will forever be thankful to you. Thank you sir.
-----
COMMENT:
AUTHOR: Daniel Du
EMAIL: 
IP: 125.98.160.4
URL: http://profile.typepad.com/daniel_du
DATE: 05/31/2012 06:54:13 PM
Hi Firexoulz,

you can use this tool to convert C# code to VB.NET

<a href="http://www.developerfusion.com/tools/convert/csharp-to-vb/">http://www.developerfusion.com/tools/convert/csharp-to-vb/</a>

Thanks,
Daniel 
-----
COMMENT:
AUTHOR: Santosh Suryawanshi
EMAIL: santosh_s01@infosys.com
IP: 115.114.135.249
URL: 
DATE: 10/16/2013 05:48:09 AM
Hi Daniel,

I am trying to insert a polygon geometry in Oracle Spatial Database (Oracle). I am getting “Invalid Argument(s)” error with StackTrace          "- FeatureUtils::FillFdoPropertyCollection line 568 file .\\AcMapFeatureUtils.cpp\n" string”

I have only three fields in Oracle. ID(integer), NAME (string) and GEOM (SDO_GEOMETRY). Spatial Index is defined of GEOM field. 

Error is coming on execution of UpdateFeatures function. 

MgLinearRing ring = geoFac.CreateLinearRing(coordCollection);
                    MgGeometry geom = geoFac.CreatePolygon(ring, null);

MgPropertyCollection propcol = new MgPropertyCollection();
                    propcol.Add(new MgInt32Property("ID", 31));
                    propcol.Add(new MgStringProperty("NAME", "Polygon_31"));
                    propcol.Add(new MgGeometryProperty("GEOM", agfReadWrite.Write(geom1)));
                     
                    MgFeatureCommandCollection commands = new MgFeatureCommandCollection();
                    MgInsertFeatures insertFeature = new MgInsertFeatures(className, propcol);
                    
                    commands.Add(insertFeature);
                    //featureService.
                    
                    featureService.UpdateFeatures(rsid, commands, true);

If you can help me or give some pointer on this it would be great.

-----
COMMENT:
AUTHOR: Santosh Suryawanshi
EMAIL: santosh_s01@infosys.com
IP: 115.114.135.249
URL: 
DATE: 10/16/2013 08:57:24 PM
Hi Daniel,

I am getting error “Invalid Argument(s)” error with StackTrace          "- FeatureUtils::FillFdoPropertyCollection line 568 file .\\AcMapFeatureUtils.cpp\n" string” when executng fs.UpdateFeatures(resId, commands, true);

MgPropertyCollection propcol = new MgPropertyCollection();
                    propcol.Add(new MgInt32Property("ID", 31));
                    propcol.Add(new MgStringProperty("NAME", "Polygon_31"));
                    propcol.Add(new MgGeometryProperty("GEOM", agfReadWrite.Write(geom1)));
                     
                    MgFeatureCommandCollection commands = new MgFeatureCommandCollection();
                    MgInsertFeatures insertFeature = new MgInsertFeatures(className, propcol);
                    
                    commands.Add(insertFeature);
                    //featureService.
                    
                    featureService.UpdateFeatures(rsid, commands, true);

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Creating a Profile object using Civil 3D .NET API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: creating-a-profile-object-using-civil-3d-net-api
CATEGORY: AutoCAD Civil 3D 2011
CATEGORY: AutoCAD Civil 3D 2012
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/05/creating-a-profile-object-using-civil-3d-net-api.html 
DATE: 05/28/2012 05:15:39 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>Profile object in Civil 3D is a 3D geometric object which joins the Surface elevations along a horizontal Alignment. Profiles are used to visualize the terrain along a route of interest, such as a proposed road, or simply to show how the elevation changes across a particular region.</p>
<p><br /><strong>Profile.CreateFromSurface()</strong> method creates a new profile and derives its elevation information from the specified surface along the alignment. Following C# code snippet demonstrates creating a Civil 3D Profile object using .NET API :</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Get the AutoCAD Editor</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">Editor</span><span style="line-height: 140%;"> ed = </span><span style="color: #2b91af; line-height: 140%;">Application</span><span style="line-height: 140%;">.DocumentManager.MdiActiveDocument.Editor;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">//select an Alignment which we will use to create a Profile</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">PromptEntityOptions</span><span style="line-height: 140%;"> selalignment = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">PromptEntityOptions</span><span style="line-height: 140%;">(</span><span style="color: #a31515; line-height: 140%;">&quot;\nSelect an Alignment Object: &quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">selalignment.SetRejectMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nOnly Alignment Object is allowed&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">selalignment.AddAllowedClass(</span><span style="color: blue; line-height: 140%;">typeof</span><span style="line-height: 140%;">(</span><span style="color: #2b91af; line-height: 140%;">Alignment</span><span style="line-height: 140%;">), </span><span style="color: blue; line-height: 140%;">true</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">PromptEntityResult</span><span style="line-height: 140%;"> resalignment = ed.GetEntity(selalignment);</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (resalignment.Status != </span><span style="color: #2b91af; line-height: 140%;">PromptStatus</span><span style="line-height: 140%;">.OK) </span><span style="color: blue; line-height: 140%;">return</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> alignmentId = resalignment.ObjectId;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">Database</span><span style="line-height: 140%;"> db = </span><span style="color: #2b91af; line-height: 140%;">Application</span><span style="line-height: 140%;">.DocumentManager.MdiActiveDocument.Database;</span></p>
<p style="margin: 0px;"><span style="color: #2b91af; line-height: 140%;">CivilDocument</span><span style="line-height: 140%;"> civilDoc = </span><span style="color: #2b91af; line-height: 140%;">CivilApplication</span><span style="line-height: 140%;">.ActiveDocument;</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">Transaction</span><span style="line-height: 140%;"> trans = db.TransactionManager.StartTransaction())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="color: blue; line-height: 140%;">try</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; </span><span style="color: #2b91af; line-height: 140%;">Alignment</span><span style="line-height: 140%;"> alignment = trans.GetObject(alignmentId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForRead) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Alignment</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; </span><span style="color: green; line-height: 140%;">// Profile.CreateFromSurface() has 4 overloaded versions</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; </span><span style="color: green; line-height: 140%;">// In this code snippet we will use - public static ObjectId CreateFromSurface(string profileName,&#0160;&#0160;&#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; </span><span style="color: green; line-height: 140%;">// ObjectId alignmentId, ObjectId surfaceId, ObjectId layerId, ObjectId styleId, ObjectId labelSetId )</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; </span><span style="color: green; line-height: 140%;">// prepare the input parameters</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> layerId = alignment.LayerId;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; </span><span style="color: green; line-height: 140%;">// let&#39;s get the 1st Surface object in the DWG file </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> surfaceId = civilDoc.GetSurfaceIds()[0];</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; </span><span style="color: green; line-height: 140%;">// let&#39;s get the 1st Profile style object in the DWG file</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> styleId = civilDoc.Styles.ProfileStyles[0];</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; </span><span style="color: green; line-height: 140%;">// let&#39;s get the 1st ProfileLabelSetStyle object in the DWG file </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> labelSetId = civilDoc.Styles.LabelSetStyles.ProfileLabelSetStyles[0];</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; </span><span style="color: green; line-height: 140%;">// Create the Profile Object</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> profileId = </span><span style="color: #2b91af; line-height: 140%;">Profile</span><span style="line-height: 140%;">.CreateFromSurface(</span><span style="color: #a31515; line-height: 140%;">&quot;Profile_Created_using_API&quot;</span><span style="line-height: 140%;">, alignmentId, surfaceId, layerId, styleId, labelSetId); </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; trans.Commit();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; }</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="color: blue; line-height: 140%;">catch</span><span style="line-height: 140%;"> (Autodesk.AutoCAD.Runtime.</span><span style="color: #2b91af; line-height: 140%;">Exception</span><span style="line-height: 140%;"> ex)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;/n Exception message :&quot;</span><span style="line-height: 140%;"> + ex.Message);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; }</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
<p><br />As a result of running the custom command containing above code snippet, you would see a new profile (like the following) being added to Civil 3D’s Profiles collection node :</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0168ebe45609970c-pi" style="display: inline;"><img alt="Profile" class="asset  asset-image at-xid-6a0167607c2431970b0168ebe45609970c" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0168ebe45609970c-500wi" title="Profile" /></a><br /><br /></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Ulrikw
EMAIL: 
IP: 90.230.94.62
URL: http://profile.typepad.com/ulrikw
DATE: 10/05/2012 04:10:59 AM
Interesting article! Is the method for creating a QuickProfiles almost the same? I have tried this for some time but didn't succeed. Maybe you can help?
-----
COMMENT:
AUTHOR: surajit biswas
EMAIL: surajit.biswas1984@gmail.com
IP: 101.210.246.146
URL: 
DATE: 12/30/2012 06:11:41 AM
sir how i creat profile from file in autocad civil3d
-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 203.202.234.246
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 01/01/2013 11:02:57 PM
Hi Surajit,

I don't see any public API available at moment to create a Profile from a file which is equivalent of the UI command _AeccCreateProfileFromFile, sorry. I am logging a wish list to address this in future release of Civil 3D.

Thanks,
Partha Sarkar
Autodesk Developer Network
-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 203.202.234.246
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 01/01/2013 11:18:33 PM
Hi Ulrikw,

My apologies for missing your comment earlier :(

If you are referring to the CREATEQUICKPROFILE command which draws temporary profiles along line, arc, polyline, lot line, feature line etc., then I find the direct or equivalent public API is missing in the current release. However, Profile.CreateFromFeatureLine() would help in creating a Profile from a corridor feature line.
For a quick Profile, we should be able to work-around with few extra steps (though I haven't tried yet), however, an equivalent API to UI command CREATEQUICKPROFILE or _AeccCreateQuickProfile would be a better option. I am logging a wish list for the same to expose a .NET API equivalent for CREATEQUICKPROFILE or _AeccCreateQuickProfile.


Thanks,
Partha Sarkar
Autodesk Developer Network

-----
COMMENT:
AUTHOR: steve
EMAIL: prisimage@yahoo.com
IP: 24.149.102.0
URL: 
DATE: 01/04/2013 07:08:35 AM
I'm using VB.net & would like to delete a profile with a given name so that I can create a new profile (from surface) with the same name. 

I've tried using the erase method of the profile object, but when it is time the create the new profile, I get an error due to the name already existing. I don't want to get into any profile name management algorithms. The reason to delete it is because it is static and it should be replaced with a dynamic one.

Ok, I just tried to make it dyanamic (instead of trying to delete it) via:

TempProfile.UpdateMode = ProfileUpdateType.Dynamic

that doesn't work either (no errors)(transaction is committed). the profile in the drawing remains static.
-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 203.202.234.243
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 01/07/2013 01:07:32 AM
Hi Steve,

Deleting a Profile using Erase() works fine. I tried the following code snippet which works fine in my testing in Civil 3D 2013 on Win7 64 bit.

Profile profile = trans.GetObject(profileId, OpenMode.ForWrite) as Profile;
profile.Erase(true);
trans.Commit();


Regarding Profile update using UpdateMode, it would work on Surface Profile only. That's what mentioned in the Civil 3D API Ref document. I have published a blog post on the same - 

<a href="http://adndevblog.typepad.com/infrastructure/2013/01/updating-a-profile-mode-using-profileupdatemode.html">http://adndevblog.typepad.com/infrastructure/2013/01/updating-a-profile-mode-using-profileupdatemode.html</a>

Hope this helps.

Thanks,
Partha Sarkar
ADN
-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Compile error when developing on AIMS 2012 64bit
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: compile-error-when-developing-on-aims-2012-64bit
CATEGORY: AIMS 2012
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/05/compile-error-when-developing-on-aims-2012-64bit.html 
DATE: 05/25/2012 01:06:00 AM
-----
BODY:
<p>I am always asked questions like below:</p>
<p><br />I am working with Autodesk Infrastructure Map Server 2012 64bit, but I always get a compile error “could not load file or assembly”, there is not problem when running.</p>
<p>The error message could be:</p>
<p>Could not load file or assembly &#39;OSGeo.MapGuide.Foundation, Version=2.3.0.4202, Culture=neutral, PublicKeyToken=null&#39; or one of its dependencies. An attempt was made to load a program with an incorrect format.</p>
<p>Could not load file or assembly &#39;MapGuideDotNetApi&#39; or one of its dependencies.</p>
<p>&#0160;</p>
<p>How could we solve this problem?</p>
<p>Firstly, we should copy *all* the files from MapGuide WebExtension folder(C:\Program Files\Autodesk\Autodesk Infrastructure Web Server Extension 2012\www\mapviewernet\bin) to &lt;yourApp&gt;\bin folder.</p>
<p>Secondly, for AIMS2012 64bit, we can use WebApplication instead of Website when creating project in Visual Studio, and create web application in local IIS, then use “attach to process” to debug. For more information, please refer to the webcast, we have a live demonstration about how to create a AIMS2012 64bit based web application and how to debug.</p>
<p><strong>Video : Autodesk® Infrastructure Map Server 2012 API Webcast      <br /></strong>Recorded version of the Autodesk® Infrastructure Map Server 2012 API webcast     <br /><a href="http://download.autodesk.com/media/adn/AIMS2012_Webcast_English/AIMS2012_Webcast_English.html">View online</a> | <a href="http://download.autodesk.com/media/adn/AIMS2012_Webcast_English.zip">Download</a></p>
<p>&#0160;</p>
<p>Hope this helps.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Adding a DEM file to AutoCAD Civil 3D TIN Surface
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: adding-a-dem-file-to-autocad-civil-3d-tin-surface
CATEGORY: AutoCAD Civil 3D 2012
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/05/adding-a-dem-file-to-autocad-civil-3d-tin-surface.html 
DATE: 05/24/2012 02:25:20 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p><strong>SurfaceDefinitionDEMFiles.AddDEMFile(</strong><strong>)</strong> allows us to add DEM data to a Civil 3D Surface. This function has few overloaded method. In this example we will explore the simplest one of using a DEM file to create a TIN Surface in AutoCAD Civil 3D. Here is the relevant C# .NET code snippet :</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">try</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="color: green; line-height: 140%;">// Select a Surface style to use </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> styleId = civilDoc.Styles.SurfaceStyles[0];</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="color: green; line-height: 140%;">// Create an empty TIN Surface</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> surfaceId = </span><span style="color: #2b91af; line-height: 140%;">TinSurface</span><span style="line-height: 140%;">.Create(</span><span style="color: #a31515; line-height: 140%;">&quot;DEM_Surface&quot;</span><span style="line-height: 140%;">, styleId);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="color: #2b91af; line-height: 140%;">TinSurface</span><span style="line-height: 140%;"> surface = trans.GetObject(surfaceId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForWrite) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">TinSurface</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="color: green; line-height: 140%;">// Path of the DEM file</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="color: #2b91af; line-height: 140%;">String</span><span style="line-height: 140%;"> demFilePath = </span><span style="color: #a31515; line-height: 140%;">@&quot;C:\Civil3D_Data\DEMs\Munich.dem&quot;</span><span style="line-height: 140%;">;&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; &#0160;&#0160;&#0160; &#0160;&#0160;&#0160; &#0160;&#0160;&#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; surface.DEMFilesDefinition.AddDEMFile(demFilePath);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; surface.Description = </span><span style="color: #a31515; line-height: 140%;">&quot;Created from DEM File&quot;</span><span style="line-height: 140%;">;&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; &#0160;&#0160;&#0160; &#0160;&#0160;&#0160; &#0160;&#0160;&#0160; </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; trans.Commit(); </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: How to change the delay of tooltip in fusion viewer of AIMS
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 0
ALLOW PINGS: 0
BASENAME: how-to-change-the-delay-of-tooltip-in-fusion-viewer-of-aims
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: Daniel Du
CATEGORY: MapGuide Enterprise 2011

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/05/how-to-change-the-delay-of-tooltip-in-fusion-viewer-of-aims.html 
DATE: 05/24/2012 01:23:00 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>I set up tooltip for some layers, but it seems that it is too slow to show up when cursor is hovering over the feature. Is it possible to make it a little faster?</p>  <p>For fusion viewer (flexible web layout), the configuration of map tip time of delay is stored in the application definition (flexible web layout) which is stored in repository.</p>  <p>You can edit the ApplicationDefinition resource in repository directly. It can be done by Resource Service API(MgResourceService:GetResourceContent and MgResourceService.SetResource), or by MapAgent,or <a href="http://trac.osgeo.org/mapguide/wiki/maestro" target="_blank">Maestro</a>, which is an open source tool and not supported by DevTech.</p>  <p>Here is a snippet of application definition resource content, you can increase the value of &lt;Delay&gt; tag of MapTip :</p>  <div style="font-family: ; color: ">   <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">&lt;</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">Widget</font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">&lt;</font></span><span style="line-height: 11pt; color: "><font color="#a31515">Name</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">&gt;</font></span><span style="line-height: 11pt"><font color="#000000">Maptip</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">&lt;/</font></span><span style="line-height: 11pt; color: "><font color="#a31515">Name</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">&gt;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">&lt;</font></span><span style="line-height: 11pt; color: "><font color="#a31515">Type</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">&gt;</font></span><span style="line-height: 11pt"><font color="#000000">Maptip</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">&lt;/</font></span><span style="line-height: 11pt; color: "><font color="#a31515">Type</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">&gt;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">&lt;</font></span><span style="line-height: 11pt; color: "><font color="#a31515">Location</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">/&gt;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">&lt;</font></span><span style="line-height: 11pt; color: "><font color="#a31515">Extension</font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">&lt;</font></span><span style="line-height: 11pt; color: "><font color="#a31515">Tolerance</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">&gt;</font></span><span style="line-height: 11pt"><font color="#000000">2</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">&lt;/</font></span><span style="line-height: 11pt; color: "><font color="#a31515">Tolerance</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">&gt;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">&lt;</font></span><span style="line-height: 11pt; color: "><font color="#a31515">Target</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">&gt;</font></span><span style="line-height: 11pt"><font color="#000000">MaptipWindow</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">&lt;/</font></span><span style="line-height: 11pt; color: "><font color="#a31515">Target</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">&gt;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">&lt;</font></span><span style="line-height: 11pt; color: "><font color="#a31515">WinFeatures</font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; menubar=no,location=no,resizable=no,status=no</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">&lt;/</font></span><span style="line-height: 11pt; color: "><font color="#a31515">WinFeatures</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">&gt;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160; <font style="background-color: #ffff00">&#160; </font></font></font></span><font style="font-size: 8pt"><font style="background-color: #ffff00"><span style="line-height: 11pt; color: "><font color="#0000ff">&lt;</font></span><span style="line-height: 11pt; color: "><font color="#a31515">Delay</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">&gt;</font></span><span style="line-height: 11pt"><font color="#000000">350</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">&lt;/</font></span><span style="line-height: 11pt; color: "><font color="#a31515">Delay</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">&gt;</font></span></font><span style="line-height: 11pt"><font color="#000000">&#160; </font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">&lt;!-- millisecond--&gt;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">&lt;</font></span><span style="line-height: 11pt; color: "><font color="#a31515">Layer</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">/&gt;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">&lt;/</font></span><span style="line-height: 11pt; color: "><font color="#a31515">Extension</font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">&lt;/</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">Widget</font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font></p> </div>  <p>Hope this helps.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Arrianne
EMAIL: arrguzman@indracompany.com
IP: 63.243.144.7
URL: 
DATE: 03/20/2013 01:42:04 AM
Hi Daniel,

What could be the problem if tooltip is not displaying at all? We have tooltip displaying in AIMS 
2012 but it's not working in AIMS 2013 which we are going to use. Tooltip is not displaying even in Sheboygan example. 

Thank you.

Regards,
Arrianne
-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Opening map in fusion viewer
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: opening-map-in-fusion-viewer
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: Daniel Du
CATEGORY: MapGuide Enterprise 2011

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/05/opening-map-in-fusion-viewer.html 
DATE: 05/23/2012 02:21:00 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>You may have been using following code snippet to open a map in basic layout (assuming a map resource named as “myMapName” is created in MapGuide Studio,):</p>  <pre class="csharpcode">MgMap map = <span class="kwrd">new</span> MgMap();
map.Open(resourceServices, “myMapName”);</pre>
<style type="text/css">



.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }</style>

<p>But it does not work in fusion viewer, the error message is :</p>

<p>Error : &quot; Invalid argument(s): [0] = &quot; &quot; The string cannot be empty &quot;</p>

<p>&#160;</p>

<p>The reason is the map name will be changed during run time in fusion viewer, so please do not use hard-coded map name when programing. </p>

<p>If you are using “Invoke URL” command to invoke the page, MapGuide will add some parameters for you including SESSION, MAPNAME, etc. The value of these parameters can be retrieved by Request object. Here is a demonstration of how to get map name and open a map in fusion viewer:</p>

<pre class="csharpcode"><span class="kwrd">string</span> mapname = Request[“MapName”].ToString()
map.open(resSvc,mapname);</pre>
<style type="text/css">


.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }</style>

<p>Firstly, create a custom command to &quot;invoke URL&quot; and point the URL to your custom page.</p>

<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0168ebb4ed4e970c-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0168ebb4ed6e970c-pi" width="499" height="186" /></a></p>

<p>Specify the target as &quot;Task Pane&quot;: </p>

<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b016766b36d32970b-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0168ebb4eda3970c-pi" width="496" height="186" /></a></p>

<p>Code snippet goes as below:</p>

<div style="font-family: ; color: ">
  <p style="margin: 0px"><font face="Courier New"><span style="background-image: none; line-height: 11pt; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%"><font style="background-color: #ffee62" color="#000000"><font style="font-size: 8pt">&lt;%</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">@</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#a31515">Page</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#ff0000">Language</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">=&quot;C#&quot;</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#ff0000">AutoEventWireup</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">=&quot;true&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> </font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#ff0000">CodeBehind</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">=&quot;MapInformation.aspx.cs&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> </font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#ff0000">Inherits</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">=&quot;AIMS2012WebApp.MapInformation&quot;</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span></font><span style="background-image: none; line-height: 11pt; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%"><font style="background-color: #ffee62; font-size: 8pt" color="#000000">%&gt;</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">&lt;!</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">DOCTYPE</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#ff0000">html</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#ff0000">PUBLIC</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">&quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> </font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">&quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">&lt;</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">html</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#ff0000">xmlns</font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">&lt;</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">head</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#ff0000">runat</font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">=&quot;server&quot;&gt;</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">&lt;</font></span><span style="line-height: 11pt; color: "><font color="#a31515">title</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">&gt;&lt;/</font></span><span style="line-height: 11pt; color: "><font color="#a31515">title</font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">&lt;</font></span><span style="line-height: 11pt; color: "><font color="#a31515">script</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#ff0000">language</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">=</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">&quot;javascript&quot;</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#ff0000">type</font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">=&quot;text/javascript&quot;&gt;</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">function</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> Init() {</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">var</font></span><span style="line-height: 11pt"><font color="#000000"> aa = </font></span><span style="line-height: 11pt; color: "><font color="#a31515">'&lt;%=mapNameXX %&gt;'</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> ;</font></span></font></p>

  <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; alert(aa);</font></font></span></p>

  <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">&lt;/</font></span><span style="line-height: 11pt; color: "><font color="#a31515">script</font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">&lt;/</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">head</font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">&lt;</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">body</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#ff0000">onload</font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">=&quot;Init();&quot;&gt;</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">&lt;</font></span><span style="line-height: 11pt; color: "><font color="#a31515">form</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#ff0000">id</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">=&quot;form1&quot;</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#ff0000">runat</font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">=&quot;server&quot;&gt;</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">&lt;</font></span><span style="line-height: 11pt; color: "><font color="#a31515">div</font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">&lt;/</font></span><span style="line-height: 11pt; color: "><font color="#a31515">div</font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">&lt;/</font></span><span style="line-height: 11pt; color: "><font color="#a31515">form</font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">&lt;/</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">body</font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">&lt;/</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">html</font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font></p>
</div>

<p>Code behind:</p>

<div style="font-family: ; color: ">
  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> System;</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> System.Collections.Generic;</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> System.Linq;</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> System.Web;</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> System.Web.UI;</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> System.Web.UI.WebControls;</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">namespace</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> AIMS2012WebApp</font></span></font></p>

  <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">{</font></font></span></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">public</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">partial</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">class</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">MapInformation</font></span><span style="line-height: 11pt"><font color="#000000"> : System.Web.UI.</font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#2b91af">Page</font></span></font></p>

  <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></span></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">public</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">string</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> mapNameXX;</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">protected</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">void</font></span><span style="line-height: 11pt"><font color="#000000"> Page_Load(</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">object</font></span><span style="line-height: 11pt"><font color="#000000"> sender, </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">EventArgs</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> e)</font></span></font></p>

  <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; UtilityClass util = </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> UtilityClass();</font></span></font></p>

  <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; util.InitializeWebTier(Request);</font></font></span></p>

  <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">string</font></span><span style="line-height: 11pt"><font color="#000000"> sessionId = Request[</font></span><span style="line-height: 11pt; color: "><font color="#a31515">&quot;Session&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">].ToString();</font></span></font></p>

  <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; util.ConnectToServer(sessionId);</font></font></span></p>

  <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">string</font></span><span style="line-height: 11pt"><font color="#000000"> mapName = Request[</font></span><span style="line-height: 11pt; color: "><font color="#a31515">&quot;MapName&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">].ToString();</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//public variable, alert from client side</font></span></font></p>

  <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; mapNameXX = mapName;</font></font></span></p>

  <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>

  <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>

  <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></span></p>

  <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">}</font></font></span></p>
</div>

<p>The implementation of Utility class goes as below:</p>

<div style="font-family: ; color: ">
  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> System;</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> System.Collections.Generic;</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> System.Web;</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> System.Collections;</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> System.Xml;</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> System.IO;</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> System.Text;</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> OSGeo.MapGuide;</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#808080"><font style="font-size: 8pt">///</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#008000"> </font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#808080">&lt;summary&gt;</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#808080"><font style="font-size: 8pt">///</font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000"> Summary description for Utility.</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#808080"><font style="font-size: 8pt">///</font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000"> Created by Daniel Du, DevTech</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#808080"><font style="font-size: 8pt">///</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#008000"> </font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#808080">&lt;/summary&gt;</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">public</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">class</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#2b91af">UtilityClass</font></span></font></p>

  <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">{</font></font></span></p>

  <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; MgSiteConnection siteConnection;</font></font></span></p>

  <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">public</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">void</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> InitializeWebTier(HttpRequest Request)</font></span></font></p>

  <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></span></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">string</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> realPath =</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Request.ServerVariables[</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">&quot;APPL_PHYSICAL_PATH&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">];</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#2b91af">String</font></span><span style="line-height: 11pt"><font color="#000000"> configPath = realPath + </font></span><span style="line-height: 11pt; color: "><font color="#a31515">&quot;../webconfig.ini&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>

  <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; MapGuideApi.MgInitializeWebTier(configPath);</font></font></span></p>

  <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></span></p>

  <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">public</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">void</font></span><span style="line-height: 11pt"><font color="#000000"> ConnectToServer(</font></span><span style="line-height: 11pt; color: "><font color="#2b91af">String</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> sessionID)</font></span></font></p>

  <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></span></p>

  <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; MgUserInformation userInfo =</font></font></span></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> MgUserInformation(sessionID);</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; siteConnection = </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> MgSiteConnection();</font></span></font></p>

  <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>

  <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; siteConnection.Open(userInfo);</font></font></span></p>

  <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>

  <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></span></p>

  <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">public</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> MgSiteConnection GetSiteConnection()</font></span></font></p>

  <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></span></p>

  <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">return</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> siteConnection;</font></span></font></p>

  <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></span></p>

  <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>

  <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">}</font></font></span></p>
</div>

<p>The result will be similar as below, please the note the map name is different with the one defined in Infrastructure Studio.</p>

<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b016766b36dcb970b-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b016305bf6642970d-pi" width="497" height="322" /></a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Arrianne
EMAIL: arrguzman@indracompany.com
IP: 122.52.41.37
URL: 
DATE: 10/10/2012 10:12:35 PM
Hi Daniel,

How can you get map name and session id from initial task URL specified in the task pane? The URL I specified targets a JSP file.

Thank you very much.

Sincereley,
Arrianne
-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: API Wishlist survey for AutoCAD® Civil 3D®
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: api-wishlist-survey-for-autocad-civil-3d
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/05/api-wishlist-survey-for-autocad-civil-3d.html 
DATE: 05/23/2012 09:55:22 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-  sarkar.html" target="_self">Partha Sarkar</a></p>
<p>We have been organizing this API wishlist survey for AutoCAD® Civil 3D® regularly in last few years. Thanks for your previous participation! We are back this year again and we wish to hear from you on prioritization of APIs for AutoCAD® Civil 3D®.&#0160;We share this wishlist with our engineering team and they take this feedback seriously when prioritizing the APIs to expose over the coming releases.</p>
<p>Please do take the time to provide us with your input by responding to the questions and adding appropriate comments at the following survey link :</p>
<p><a href="http://www.zoomerang.com/Survey/WEB22FSEYSMJ86" target="_self">API Wishlist Survey AutoCAD® Civil 3D®</a> &#0160;</p>
<p>The surveys will remain open until <strong>June 11th, 2012</strong>. Thanks in advance for your feedback!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: How to change the tolerance of tooltip in Ajax viewer and Fusion viewer of AIMS or MapGuide
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 0
ALLOW PINGS: 0
BASENAME: how-to-change-the-tolerance-of-tooltip-in-ajax-viewer-and-fusion-viewer-of-aims-or-mapguide
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: Daniel Du
CATEGORY: MapGuide Enterprise 2011

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/05/how-to-change-the-tolerance-of-tooltip-in-ajax-viewer-and-fusion-viewer-of-aims-or-mapguide.html 
DATE: 05/23/2012 01:19:00 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>Have you ever run into following scenario? When I have tool tips enabled in the point data, I have to be exactly right on the center for the tool tip to show.&#160; There doesn't seem to be any tolerance on the center or symbol.&#160; Is there a way to increase the tolerance or sensitivity for the tool tip in the code?</p>  <p>Yes, There is. If you are using Ajax viewer (basic web layout), it can be done by making changes in: ajaxmappane.templ which is in Viewerfiles.</p>  <div style="font-family: ; color: ">   <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">function</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> RequestHyperLinkData(id, x, y, exec) {</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">if</font></span><span style="line-height: 11pt"><font color="#000000"> (lastMapRcv != mapId) </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">return</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">if</font></span><span style="line-height: 11pt"><font color="#000000"> (isPopupOpen(tbMenu) || isPopupOpen(ctxMenu)) </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">return</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; req = CreateRequestHandler();</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; req.open(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">&quot;POST&quot;</font></span><span style="line-height: 11pt"><font color="#000000">, webAgent, </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">true</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; req.setRequestHeader(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">&quot;Content-Type&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">, </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">&quot;application/x-www-form-urlencoded&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">// default tolerance is 2 pixies, you can edit this line</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">// to change the tolerance</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">// x1 = x - 2; x2 = x + 2; (original. changed to show tooltip)</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">// y1 = y - 2; y2 = y + 2; (original) </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//Change the tolerance to 5 pixies</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; x1 = x - 5; x2 = x + 5;</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; y1 = y - 5; y2 = y + 5;</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; pt1 = ScreenToMapUnits(x1, y1);</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; pt2 = ScreenToMapUnits(x2, y2);</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; geom = MakeWktPolygon(pt1.X, pt1.Y, pt2.X, pt2.Y);</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; reqParams = </font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#a31515">&quot;OPERATION=QUERYMAPFEATURES&amp;VERSION=1.0.0</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &amp;PERSIST=0&amp;MAPNAME=</font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#a31515">&quot; </font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; +encodeURIComponent(mapName)</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; + </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">&quot;&amp;SESSION=&quot;</font></span><span style="line-height: 11pt"><font color="#000000"> + sessionId + </font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#a31515">&quot;&amp;SEQ=&quot;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; + Math.random() + </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#a31515">&quot;&amp;LAYERNAMES=&quot;</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; + encodeURIComponent(GetVisLayers())</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; + </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">&quot;&amp;GEOMETRY=&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> + geom</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; + </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">&quot;&amp;SELECTIONVARIANT=INTERSECTS&amp;MAXFEATURES=1&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; obj = </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> HlRequest(id, x, y, req, exec);</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; req.onreadystatechange = obj.OnHl;</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">try</font></span><span style="line-height: 11pt"><font color="#000000"> { req.send(reqParams); } </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">catch</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> (e) { }</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">} </font></font></span></p> </div>  <p>&#160;</p>  <p>For fusion viewer (flexible web layout), the configuration of map tip tolerance is stored in the application definition (flexible web layout) which is stored in repository.</p>  <p>To solve your problem, you need to edit the ApplicationDefinition resource in repository directly. It can be done by Resource Service API(MgResourceService:GetResourceContent and MgResourceService.SetResource), or by MapAgent, or <a href="http://trac.osgeo.org/mapguide/wiki/maestro" target="_blank">Maestro</a>, which is an open source tool and not supported by DevTech.</p>  <p>Here is a snippet of application definition resource content, you can increase the value of &lt;Tolerance&gt; tag of MapTip . </p>  <div style="font-family: ; color: ">   <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">&lt;</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">Widget</font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">&lt;</font></span><span style="line-height: 11pt; color: "><font color="#a31515">Name</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">&gt;</font></span><span style="line-height: 11pt"><font color="#000000">Maptip</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">&lt;/</font></span><span style="line-height: 11pt; color: "><font color="#a31515">Name</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">&gt;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">&lt;</font></span><span style="line-height: 11pt; color: "><font color="#a31515">Type</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">&gt;</font></span><span style="line-height: 11pt"><font color="#000000">Maptip</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">&lt;/</font></span><span style="line-height: 11pt; color: "><font color="#a31515">Type</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">&gt;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">&lt;</font></span><span style="line-height: 11pt; color: "><font color="#a31515">Location</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">/&gt;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">&lt;</font></span><span style="line-height: 11pt; color: "><font color="#a31515">Extension</font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="background-color: #ffff00"><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">&lt;</font></span><span style="line-height: 11pt; color: "><font color="#a31515">Tolerance</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">&gt;</font></span><span style="line-height: 11pt"><font color="#000000">2</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">&lt;/</font></span><span style="line-height: 11pt; color: "><font color="#a31515">Tolerance</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">&gt;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> </font></span></font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">&lt;</font></span><span style="line-height: 11pt; color: "><font color="#a31515">Target</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">&gt;</font></span><span style="line-height: 11pt"><font color="#000000">MaptipWindow</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">&lt;/</font></span><span style="line-height: 11pt; color: "><font color="#a31515">Target</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">&gt;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">&lt;</font></span><span style="line-height: 11pt; color: "><font color="#a31515">WinFeatures</font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; menubar=no,location=no,resizable=no,status=no</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">&lt;/</font></span><span style="line-height: 11pt; color: "><font color="#a31515">WinFeatures</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">&gt;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">&lt;</font></span><span style="line-height: 11pt; color: "><font color="#a31515">Delay</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">&gt;</font></span><span style="line-height: 11pt"><font color="#000000">350</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">&lt;/</font></span><span style="line-height: 11pt; color: "><font color="#a31515">Delay</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">&gt;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">&lt;</font></span><span style="line-height: 11pt; color: "><font color="#a31515">Layer</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">/&gt;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">&lt;/</font></span><span style="line-height: 11pt; color: "><font color="#a31515">Extension</font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">&lt;/</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">Widget</font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font></p> </div>  <p>&#160;</p>  <p>Hope this helps.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Reducing the number of points on a triangulated irregular network (TIN) surface
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: reducing-the-number-of-points-on-a-triangulated-irregular-network-tin-surface
CATEGORY: AutoCAD Civil 3D 2011
CATEGORY: AutoCAD Civil 3D 2012
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/05/reducing-the-number-of-points-on-a-triangulated-irregular-network-tin-surface.html 
DATE: 05/22/2012 01:54:49 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>If you want to make Civil 3D TIN surface smaller and easier to process&#0160;faster by reducing the number of points, what you do ?</p>
<p>In Civil 3D UI tools, you can select the <strong>Edits -&gt; &#39;Simplify Surface...&#39;</strong> option&#0160;to bring up the &quot;<strong>Simplify Surface - SurfaceName</strong>&quot; dialog box and there in the&#0160;&quot;Reduction Options&quot; you can specify the &#39;<em>Percentage of points to remove</em>&#39; as&#0160;shown in the picture below -</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0168eba69aae970c-pi" style="display: inline;"><img alt="Pic1" class="asset  asset-image at-xid-6a0167607c2431970b0168eba69aae970c" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0168eba69aae970c-500wi" title="Pic1" /></a><br /><br /><br /><br />The same operation, you can perform by calling your custom command and&#0160;invoking the <strong>TinSurface.SimplifySurface()</strong> function. Here is a C# .NET code&#0160;snippet on the same :</p>
<p>&#0160;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">Transaction</span><span style="line-height: 140%;"> trans = db.TransactionManager.StartTransaction())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="color: #2b91af; line-height: 140%;">TinSurface</span><span style="line-height: 140%;"> surface = trans.GetObject(surfaceId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForRead) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">TinSurface</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="color: green; line-height: 140%;">// SurfaceSimplifyOptions </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="color: green; line-height: 140%;">// This class represents the options for simplifing a TinSurface object.</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="color: #2b91af; line-height: 140%;">SurfaceSimplifyOptions</span><span style="line-height: 140%;"> ssop = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">SurfaceSimplifyOptions</span><span style="line-height: 140%;">(</span><span style="color: #2b91af; line-height: 140%;">SurfaceSimplifyType</span><span style="line-height: 140%;">.PointRemoval);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="color: green; line-height: 140%;">//specify the &#39;Percentage of points to remove&#39;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; ssop.PercentageToRemove = 0.40;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="color: green; line-height: 140%;">// Call SimplifySurface() now</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; surface.SimplifySurface(ssop);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="color: green; line-height: 140%;">// Rebuild the Surface</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; surface.Rebuild();&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; &#0160;&#0160;&#0160; &#0160;&#0160;&#0160; </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; trans.Commit();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: AIMS 2012 login failed
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 0
ALLOW PINGS: 0
BASENAME: aims-2012-login-failed
CATEGORY: AIMS 2012
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/05/aims-2012-login-failed.html 
DATE: 05/22/2012 01:41:00 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>I installed AIMS 2012 in windows with IIS + .net binding, but I cannot login in MapGuide Studio or MapAdmin.</p>  <p>Many reasons may cause the failure of login of MapGuide server. Here is a checklist for your reference: </p>  <ol>   <li>Are your system is qualified according to <a href="http://images.autodesk.com/adsk/files/Autodesk_Infrastructure_Map_Server_2012_System_requirements.pdf" target="_blank">system requirement of AIMS2012</a>?&#160;&#160; </li>    <li>Is the MapGuide server services started and running?      <br />Start --&gt; run --&gt; “services.msc” to open Services console, and make sure “Infrastructure Map Server 2012” is started. </li>    <li>Are you using the correct user name and password? Is there anyone(may be others) changed the default user name and password without informing your?&#160; The default user name and password is(case is important):      <br />username: Administrator       <br />password: admin </li>    <li>Have you ever installed IIS correctly before you install AIMS 2012?      <br />Start --&gt; Control Panel --&gt; Programs and Features --&gt; Turn Windows features on or off(from left), check *all* items under Internet Information Services\World Wide Web Services\Application Development Features </li>    <li>Do you configure php correctly?      <br />Start --&gt; Run --&gt; &quot;regedit&quot; , open registry to check whether following key exists or not, if not, create one and reboot:       <br />HKEY_LOCAL_MACHINE\SOFTWARE\PHP\5.3.3\IniFilePath&#160; to C:\Program Files\Autodesk\Autodesk Infrastructure Web Server Extension 2012\Php </li>    <li>Are you using trail version? Is the trail version expired? Have you ever run ServerActivator.exe to activate you license?      <br />Run ServerActivator.exe to activate your product. </li> </ol>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: Using LINQ with Civil 3D ActiveX objects
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: using-linq-with-civil-3d-activex-objects
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D 2011
CATEGORY: AutoCAD Civil 3D 2012

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/05/using-linq-with-civil-3d-activex-objects.html 
DATE: 05/21/2012 01:13:31 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>Yes it is possible use .NET LINQ (Language-Integrated Query) features with Civil 3D ActiveX objects, this Microsoft technology consists in a set of extensions to .NET languages and supporting libraries that allow users to formulate queries within the programming language itself.</p>  <p>We can use it for a Civil 3D ActiveX collection like points, the following code sample demonstrate it. It can also be used for .NET collections in a similar way, but the new Point .NET API on Civil 3D 2013 have better features.</p>  <div style="font-family: ; background: white">   <p style="margin: 0px"><font face="Consolas"><span><font color="#0000ff"><font style="font-size: 10pt">private </font></font></span><font style="font-size: 10pt" color="#000000">Autodesk.AECC.Interop.UiLand.AeccApplication aeccApp;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><span><font color="#0000ff"><font style="font-size: 10pt">private</font></font></span><font style="font-size: 10pt" color="#000000"> Autodesk.AECC.Interop.UiLand.AeccDocument aeccDoc;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><span><font color="#0000ff"><font style="font-size: 10pt">private</font></font></span><font style="font-size: 10pt" color="#000000"> Autodesk.AECC.Interop.Land.AeccDatabase aeccDb;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span><font face="Consolas"><font style="font-size: 10pt" color="#008000">//Get Civil 3D objects</font></font></span></p>    <p style="margin: 0px"><font face="Consolas"><span><font color="#0000ff"><font style="font-size: 10pt">public</font></font></span><font style="font-size: 10pt"><font color="#000000"> </font><span><font color="#0000ff">void</font></span><font color="#000000"> getCivilObjects()</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">{</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160; AcadApplication oApp = (AcadApplication)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <font style="font-size: 10pt"><span><font color="#2b91af">Application</font></span><font color="#000000">.AcadApplication;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">string</font></span><font color="#000000"> sAppName = </font><span><font color="#a31515">&quot;AeccXUiLand.AeccApplication.9.0&quot;</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">&#160; aeccApp = (AeccApplication)oApp.GetInterfaceObject(sAppName);</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">&#160; aeccDoc = (AeccDocument)aeccApp.ActiveDocument;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">&#160; aeccDb = (AeccDatabase)aeccDoc.Database;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">}</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span><font face="Consolas"><font style="font-size: 10pt" color="#008000">//release Civil 3D objects</font></font></span></p>    <p style="margin: 0px"><font face="Consolas"><span><font color="#0000ff"><font style="font-size: 10pt">public</font></font></span><font style="font-size: 10pt"><font color="#000000"> </font><span><font color="#0000ff">void</font></span><font color="#000000"> releaseCivilObjects()</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">{</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">&#160; Marshal.ReleaseComObject(aeccDb);</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">&#160; Marshal.ReleaseComObject(aeccDoc);</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">&#160; Marshal.ReleaseComObject(aeccApp);</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">}</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><span><font color="#0000ff"><font style="font-size: 10pt">public</font></font></span><font style="font-size: 10pt"><font color="#000000"> AeccPoint[] findPoints(</font><span><font color="#0000ff">double</font></span><font color="#000000"> easting, </font><span><font color="#0000ff">double</font></span><font color="#000000"> northing, </font><span><font color="#0000ff">double</font></span><font color="#000000"> tolerance)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">{</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">var</font></span><font color="#000000"> pointLinqSearch = </font><span><font color="#0000ff">from</font></span><font color="#000000"> AeccPoint pto </font><span><font color="#0000ff">in</font></span><font color="#000000"> aeccDb.Points</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 10pt" color="#0000ff">where</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 10pt" color="#008000">//easting with tolerance</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">&#160;&#160;&#160;&#160; (pto.Easting &gt;= easting - tolerance &amp;&amp; </font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">&#160;&#160;&#160;&#160; pto.Easting &lt;= easting + tolerance) &amp;&amp;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 10pt" color="#008000">//northing with tolerance</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">&#160;&#160;&#160;&#160; (pto.Northing &gt;= northing - tolerance &amp;&amp;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">&#160;&#160;&#160;&#160; pto.Northing &lt;= northing + tolerance)</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">select</font></span><font color="#000000"> pto;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">return</font></span><font color="#000000"> pointLinqSearch.ToArray();</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">}</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">[CommandMethod(</font></font><font style="font-size: 10pt"><span><font color="#a31515">&quot;findpto&quot;</font></span><font color="#000000">)]</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><span><font color="#0000ff"><font style="font-size: 10pt">public</font></font></span><font style="font-size: 10pt"><font color="#000000"> </font><span><font color="#0000ff">void</font></span><font color="#000000"> testFindPoint()</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">{</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">&#160; getCivilObjects();</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160; Editor ed = </font></font><font style="font-size: 10pt"><span><font color="#2b91af">Application</font></span><font color="#000000">.DocumentManager.MdiActiveDocument.Editor;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">double</font></span><font color="#000000"> easting, northing, tolerance;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">&#160; easting = northing = tolerance = 0.0;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">for</font></span><font color="#000000"> (</font><span><font color="#0000ff">int</font></span><font color="#000000"> i = 0; i &lt; 3; i++)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">&#160; {</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; PromptDoubleResult pdr = </font></font><font style="font-size: 10pt"><span><font color="#0000ff">null</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">&#160;&#160;&#160; PromptDoubleOptions o;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">switch</font></span><font color="#000000"> (i)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">&#160;&#160;&#160; {</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">case</font></span><font color="#000000"> 0: pdr = ed.GetDouble(</font><span><font color="#a31515">&quot;Enter easting: &quot;</font></span><font color="#000000">); </font><span><font color="#0000ff">break</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">case</font></span><font color="#000000"> 1: pdr = ed.GetDouble(</font><span><font color="#a31515">&quot;Enter northing: &quot;</font></span><font color="#000000">); </font><span><font color="#0000ff">break</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">case</font></span><font color="#000000"> 2: pdr = ed.GetDouble(</font><span><font color="#a31515">&quot;Enter tolerance: &quot;</font></span><font color="#000000">); </font><span><font color="#0000ff">break</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">&#160;&#160;&#160; }</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">if</font></span><font color="#000000"> (pdr.Status != PromptStatus.OK) </font><span><font color="#0000ff">return</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">switch</font></span><font color="#000000"> (i)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">&#160;&#160;&#160; {</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">case</font></span><font color="#000000"> 0: easting = pdr.Value; </font><span><font color="#0000ff">break</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">case</font></span><font color="#000000"> 1: northing = pdr.Value; </font><span><font color="#0000ff">break</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">case</font></span><font color="#000000"> 2: tolerance = pdr.Value; </font><span><font color="#0000ff">break</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">&#160;&#160;&#160; }</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">&#160; }</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">&#160; AeccPoint[] ptos = findPoints(easting, northing, tolerance);</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">foreach</font></span><font color="#000000"> (AeccPoint pto </font><span><font color="#0000ff">in</font></span><font color="#000000"> ptos)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">&#160; {</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; pto.Highlight(</font></font><font style="font-size: 10pt"><span><font color="#0000ff">true</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">&#160; }</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">&#160; releaseCivilObjects();</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">}</font></font></p> </div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: How do I get the geometry of the Watershed area created in AutoCAD Civil 3D?
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: how-do-i-get-the-geometry-of-the-watershed-area-created-in-autocad-civil-3d
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/05/how-do-i-get-the-geometry-of-the-watershed-area-created-in-autocad-civil-3d.html 
DATE: 05/21/2012 02:10:00 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>In AutoCAD Civil 3D 2013 .NET API, there is a new function included which extracts the surface watershed information from the terrain surface. <strong>TinSurface.ExtractWatershed()</strong> takes <em>SurfaceExtractionSettingsType</em> as input parameter and it returns <strong>ObjectIdCollection </strong>for entities that can be Polyline3d or Hatch. Here is a C#.NET code snippet which demonstrates usage of TinSurface.ExtractWatershed() :</p>
<p>&#0160;</p>
<div style="font-family: Consolas; font-size: 10pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: green;">//select a surface</span></p>
<p style="margin: 0px;"><span style="color: #2b91af;">PromptEntityOptions</span> selSurface = <span style="color: blue;">new</span> <span style="color: #2b91af;">PromptEntityOptions</span>(<span style="color: #a31515;">&quot;\nSelect a Tin Surface: &quot;</span>);</p>
<p style="margin: 0px;">selSurface.SetRejectMessage(<span style="color: #a31515;">&quot;\nOnly Tin Surface is allowed&quot;</span>);</p>
<p style="margin: 0px;">selSurface.AddAllowedClass(<span style="color: blue;">typeof</span>(<span style="color: #2b91af;">TinSurface</span>), <span style="color: blue;">true</span>);</p>
<p style="margin: 0px;"><span style="color: #2b91af;">PromptEntityResult</span> resSurface = ed.GetEntity(selSurface);</p>
<p style="margin: 0px;"><span style="color: blue;">if</span> (resSurface.Status != <span style="color: #2b91af;">PromptStatus</span>.OK) <span style="color: blue;">return</span>;</p>
<p style="margin: 0px;"><span style="color: #2b91af;">ObjectId</span> surfaceId = resSurface.ObjectId;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: #2b91af;">Database</span> db = <span style="color: #2b91af;">Application</span>.DocumentManager.MdiActiveDocument.Database;</p>
<p style="margin: 0px;"><span style="color: blue;">using</span> (<span style="color: #2b91af;">Transaction</span> trans = db.TransactionManager.StartTransaction())</p>
<p style="margin: 0px;">{</p>
<p style="margin: 0px;">&#0160; &#0160; <span style="color: #2b91af;">TinSurface</span> surface = trans.GetObject(surfaceId, <span style="color: #2b91af;">OpenMode</span>.ForRead) <span style="color: blue;">as</span> <span style="color: #2b91af;">TinSurface</span>;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; <span style="color: green;">// Extract ExtractWatershed() from the TinSurface</span></p>
<p style="margin: 0px;">&#0160; &#0160; <span style="color: green;">// The extracted entities can be Polyline3d or Hatch.</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; <span style="color: #2b91af;">ObjectIdCollection</span> wsentityIds;</p>
<p style="margin: 0px;">&#0160; &#0160; wsentityIds = surface.ExtractWatershed(Autodesk.Civil.<span style="color: #2b91af;">SurfaceExtractionSettingsType</span>.Plan);</p>
<p style="margin: 0px;">&#0160; &#0160; <span style="color: blue;">for</span> (<span style="color: blue;">int</span> i = 0; i &lt; wsentityIds.Count; i++)</p>
<p style="margin: 0px;">&#0160; &#0160; {</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; <span style="color: #2b91af;">ObjectId</span> entityId = wsentityIds[i];&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; <span style="color: #2b91af;">Polyline3d</span> watershedLine = entityId.GetObject(<span style="color: #2b91af;">OpenMode</span>.ForRead) <span style="color: blue;">as</span> <span style="color: #2b91af;">Polyline3d</span>;</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">if</span> (watershedLine != <span style="color: blue;">null</span>)</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; {</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: green;">// Access watershedLine Properties&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; }</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: #2b91af;">Hatch</span> watersheHatch = entityId.GetObject(<span style="color: #2b91af;">OpenMode</span>.ForRead) <span style="color: blue;">as</span> <span style="color: #2b91af;">Hatch</span>;</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">if</span> (watersheHatch != <span style="color: blue;">null</span>)</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; {</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: green;">// Access watersheHatch Properties</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; }&#0160; &#0160; &#0160;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; }</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; trans.Commit();</p>
<p style="margin: 0px;">}</p>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: How to enumerate specified type of resources in Map 3D?
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 0
ALLOW PINGS: 0
BASENAME: how-to-enumerate-specified-type-of-resources-in-map-3d
CATEGORY: AutoCAD Map 3D 2011
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/05/how-to-enumerate-specified-type-of-resources-in-map-3d.html 
DATE: 05/21/2012 01:04:00 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>We can use MgResourceService::EnumerateResources to enumerate resources in the repository. The detailed information of this function goes as below:</p>  <p><strong>.NET Syntax</strong></p>  <p>MgByteReader EnumerateResources(MgResourceIdentifier resource, int depth, string type);</p>  <p><b>Parameters:</b></p>  <p><i>resource</i>     <br />(MgResourceIdentifier) Resource identifier specifying the resource to enumerate. This can be a document or a folder.     <br />If it is a folder, you must include the trailing slash in the identifier.</p>  <p><i>depth</i>     <br />(int) Recursion depth, relative to the specified resource.</p>  <ul>   <li>If the resource is a document, depth must be set to 0. </li>    <li>If the resource is a folder:      <ul>       <li>If the depth is equal to 0, only information about the specified folder is returned. </li>     </ul>      <ul>       <li>If the depth is greater than 0, information about the folder and its descendants up to the specified depth are returned. </li>     </ul>   </li>    <li>If the depth is -1, information about the folder and all its descendants is returned. </li> </ul>  <p><i>type</i>     <br />(String/string) Type of the resource to be enumerated. (Case sensitive.) See MgResourceTypefor valid types.     <br />Or, this can be set to null, in which case information about all resource types is returned.</p>  <p><b>Returns:</b></p>  <p>Returns an MgByteReader object containing a description of the resources in XML format using the ResourceList schema.</p>  <p>EnumerateResources method returns the MgByteReader object containing a description of resources in XML format; we can resolve this XML and get all the resource Ids.</p>  <p>Please see code below:</p>  <div style="font-family: ; color: ">   <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">public</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#000000"> Dictionary&lt;</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">string</font></span><span style="line-height: 11pt"><font color="#000000">, </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">string</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">&gt; </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; GetResourcesByType(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">string</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> resourceType)</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">{</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; Dictionary&lt;</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">string</font></span><span style="line-height: 11pt"><font color="#000000">, </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">string</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">&gt; resources </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; = </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> Dictionary&lt;</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">string</font></span><span style="line-height: 11pt"><font color="#000000">, </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">string</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">&gt;();</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; MgResourceIdentifier rootResId </font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; = </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> MgResourceIdentifier(</font></span><span style="line-height: 11pt; color: "><font color="#a31515">@&quot;Library://&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">);</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; MgByteReader reader = ResourceService</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; .EnumerateResources(rootResId, -1, resourceType.ToString());</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//Convert to string</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; String resStr = reader.ToString();</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//Load into XML document so we can parse </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//and get the names of the maps</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; XmlDocument doc = </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> XmlDocument();</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; doc.LoadXml(resStr);</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//let's extract the resource names and list them&#160;&#160;&#160; </font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; XmlNodeList resIdNodeList;</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; XmlElement root = doc.DocumentElement;</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; resIdNodeList = root.SelectNodes(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">&quot;//ResourceId&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">);</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">int</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> resCount = resIdNodeList.Count;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">for</font></span><span style="line-height: 11pt"><font color="#000000"> (</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">int</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> i = 0; i &lt; resCount; i++)</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; XmlNode resIdNode = resIdNodeList.Item(i);</font></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; String resId = resIdNode.InnerText;</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">int</font></span><span style="line-height: 11pt"><font color="#000000"> index1 = resId.LastIndexOf(</font></span><span style="line-height: 11pt; color: "><font color="#a31515">'/'</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">) + 1;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">int</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> index2 = resId.IndexOf(resourceType) - 2;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">int</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> length = index2 - index1 + 1;</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">string</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> resName = resId.Substring(index1, length);</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; resources.Add(resName, resId);</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">return</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> resources;</font></span></font></p>    <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">}</font></font></span></p> </div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Avoid freezing or memory leak of AIMS
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: avoid-freezing-or-memory-leak-of-aims
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: Daniel Du
CATEGORY: MapGuide Enterprise 2011

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/05/avoid-freezing-or-memory-leak-of-aims.html 
DATE: 05/20/2012 08:46:12 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>You many run into the issue of memory leak when working with Autodesk Infrastructure Map Server or MapGuide Enterprise. The memory may increase to a very high level and finally brings down the server, or the server just gets frozen and does not response any more.</p>  <p>Here are some suggestions, hope it is helpful for you. </p>  <p>Firstly, if you are running custom applications, please check your code carefully, to make sure to close the feature reader and release resources as early as possible. You can use following code snippet: </p>  <pre class="csharpcode">MgFeatureReader reader = featureService.SelectFeatures();
<span class="kwrd">try</span>
{
 <span class="rem">//your code here ...</span>
}
<span class="kwrd">finally</span>
{
 Reader.close();
}</pre>
<style type="text/css">






.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }</style>

<p>Or :</p>

<pre class="csharpcode">MgFeatureService featureService <br />            = siteConnection.CreateService(..)</pre>

<pre class="csharpcode"><span class="kwrd">try</span>
{
<span class="kwrd">  using</span>(MgFeatureReader reader <br />            = featureService.SelectFeatures(..)) 
  { 
<span class="rem">    // your code here …</span>
    Reader.close();
  }

}
<span class="kwrd">finally</span>
{
  featureService.dispose();
}</pre>

<p>Autodesk Infrastructure Map Server is designed very carefully to avoid memory leak, there are sometimes memory leaks in web-based applications and application servers, given the complexity and number of dependent processes. What might appear to be a minor memory leak can accumulate over time and affect general server performance.</p>

<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b016766a3854e970b-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0168eba55b27970c-pi" width="353" height="394" /></a></p>

<p>One workaround is to write a routine to occasionally restart your web server service, thereby freeing up orphaned resources. Setting the Autodesk MapGuide service to restart automatically may also help in the event that the service has shut down. Following script to stop and start the service: </p>

<blockquote>
  <p>net stop InfrastructureMapServer2012 
    <br />net start InfrastructureMapServer2012</p>
</blockquote>

<p>You might want to look at the service log files to determine the cause for the service to stop and rectify it to prevent it in the future.</p>

<p>For more suggestions of best practice, please refer to the <a href="http://sandbox.mapguide.com/index.php/Main_Page" target="_blank">MapGuide Best Practice Wiki</a>. </p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Creating COGO Point and updating its Elevation
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: creating-cogo-point-and-updating-its-elevation
CATEGORY: AutoCAD Civil 3D 2011
CATEGORY: AutoCAD Civil 3D 2012
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/05/creating-cogo-point-and-updating-its-elevation.html 
DATE: 05/18/2012 03:01:55 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>This AutoLISP code snippet demonstrates how to create a COGO Point in AutoCAD Civil 3D and update it&#39;s elevation property.</p>
<p>(defun c:CreateCOGO ()</p>
<p>&#0160; (vl-load-com)</p>
<p>&#0160; ;; Change ProgID per Traget Civil 3D version</p>
<p>&#0160; ;; This code sample is meant for Civil 3D 2013</p>
<p>&#0160; (setq aeccApp (vla-getinterfaceobject</p>
<p>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (vlax-get-acad-object)</p>
<p>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &quot;AeccXUiLand.AeccApplication.10.0&quot;</p>
<p>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; )</p>
<p>&#0160; )</p>
<p>&#0160; (setq aeccDoc (vlax-get-property aeccApp &quot;ActiveDocument&quot;))</p>
<p>&#0160; (setq aeccDb (vlax-get-property aeccDoc &quot;Database&quot;))</p>
<p>&#0160; (setq oPoints (vlax-get-property aeccDoc &quot;Points&quot;))</p>
<p>&#0160; (setq pt1 (vlax-3d-point &#39;(10.0 10.0 0.0)))</p>
<p>&#0160; (setq oPoint1 (vlax-invoke-method oPoints &quot;Add&quot; pt1))</p>
<p>&#0160; (setq elevn1 (vlax-get-property oPoint1 &quot;Elevation&quot;))</p>
<p>&#0160; (setq str1 &quot;Initial Elevation = &quot;)</p>
<p>&#0160; (prompt str1)</p>
<p>&#0160; (princ elevn1)</p>
<p>&#0160; ;; Set the COGO Point Elevation to a new Value</p>
<p>&#0160; (vlax-put-property oPoint1 &quot;Elevation&quot; 101.0)</p>
<p>&#0160; (setq elevn2 (vlax-get-property oPoint1 &quot;Elevation&quot;))</p>
<p>&#0160; (setq str2 &quot;Elevation after change= &quot;)</p>
<p>&#0160; (print str2)</p>
<p>&#0160; (princ elevn2)</p>
<p>)</p>
<p>BTW - <strong>COGO Point</strong> and its associated functionalities are exposed in <strong>.NET</strong> API in Civil 3D 2013 release and you might find my colleague Isaac&#39;s blog post <a href="http://civilizeddevelopment.typepad.com/civilized-development/2012/05/21wojp-week-5-cogo-point-basics.html" target="_self">21WOJP – Week 5: COGO Point Basics</a> very useful</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:
COGO, LISP, API
-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: It is possible to deploy MapGuide Enterprise or AIMS on Amazon Cloud EC2?
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 0
ALLOW PINGS: 0
BASENAME: it-is-possible-to-deploy-mapguide-enterprise-or-aims-on-amazon-cloud-ec2
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: Daniel Du
CATEGORY: MapGuide Enterprise 2011

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/05/it-is-possible-to-deploy-mapguide-enterprise-or-aims-on-amazon-cloud-ec2.html 
DATE: 05/18/2012 02:54:00 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>
<p>Unfortunately at this stage, MapGuide Enterprise or AIMS is not supported to deploy on cloud environment.</p>
<p>From a licensing and warranty stand-point, we are not allowing cloud-based deployment of MapGuide Enterprise 2011 (or previous releases for that matter) – one of the primary reasons being that we have not yet dedicated resources to engineer and test the core server for cloud-based deployment. It’s one of the many things we are considering at the moment in our product plan for future releases.</p>
<p>I can also share with you a information, one Japanese customer did install MapGuide Open Source 2.0 in Amazon EC2 successfully.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Dan
EMAIL: mwaurah@gmail.com
IP: 41.209.25.90
URL: http://jkuat.ac.ke
DATE: 10/11/2012 04:34:25 AM
HI would be very interested in deploying MapGuide open source on Amazon. Would you know of any available AMI orcould you help. 
-----
COMMENT:
AUTHOR: Daniel Du
EMAIL: 
IP: 
URL: http://profile.typepad.com/daniel_du
DATE: 10/11/2012 04:55:27 AM





You can select any AMI which satisfies the system requirement of MapGuide and install it when logging into the instance with remote control tool.




Sorry but Autodesk cannot provide support about this.
-----
--------
AUTHOR: Gopinath Taget
AUTHOR EMAIL: gopinath.taget@autodesk.com
TITLE: Approaching deadlines
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: approaching-deadlines-1
CATEGORY: Events
CATEGORY: Gopinath Taget

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/05/approaching-deadlines-1.html 
DATE: 05/17/2012 04:13:20 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/autocad/gopinath-taget.html">Gopinath Taget</a></p>
<p>Quick reminder …</p>
<p>Time is running out to <a href="http://au.autodesk.com/?nd=slv2012_call_for_proposals">submit your class proposals for Autodesk University 2012</a>. The deadline is May 22nd – next Tuesday.</p>
<p>The <a href="http://adndevblog.typepad.com/autocad/2012/04/devcamps.html">AEC and Manufacturing DevCamps</a> are close now too. AEC is June 6-7, and Manufacturing is June 13-14. Each is followed by a one-day DevLab workshop.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Gopinath Taget
AUTHOR EMAIL: gopinath.taget@autodesk.com
TITLE: Approaching deadlines
STATUS: Draft
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: approaching-deadlines

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/05/approaching-deadlines.html 
DATE: 05/17/2012 04:08:25 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/autocad/gopinath-taget.html">Gopinath Taget</a></p>  <p>Quick reminder …</p>  <p>Time is running out to <a href="http://au.autodesk.com/?nd=slv2012_call_for_proposals">submit your class proposals for Autodesk University 2012</a>. The deadline is May 22nd – next Tuesday. </p>  <p>The <a href="http://adndevblog.typepad.com/autocad/2012/04/devcamps.html">AEC and Manufacturing DevCamps</a> are close now too. AEC is June 6-7, and Manufacturing is June 13-14. Each is followed by a one-day DevLab workshop.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: How to change size and appearance of new opened window in MapGuide viewer?
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 0
ALLOW PINGS: 0
BASENAME: how-to-change-size-and-appearance-of-new-opened-window-in-mapguide-viewer
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: Daniel Du
CATEGORY: MapGuide Enterprise 2011

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/05/how-to-change-size-and-appearance-of-new-opened-window-in-mapguide-viewer.html 
DATE: 05/17/2012 02:47:00 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>In MapGuide Ajax viewer, I can open a new window if I specify the value for &quot;Display result in this target interface&quot; to &quot;New window&quot; or &quot;Specified frame&quot; in Web layout editor, but it always opens a 500*500 window without toolbar. How can I resize the window or change its appearance when it is opened?</p>  <p>The solution is simple. It can be edited in &lt;WebExetension Installation folder&gt;\www\viewerfiles\ajaxmappane.templ</p>  <p>For AIMS2012:&#160; C:\Program Files\Autodesk\Autodesk Infrastructure Web Server Extension 2012\www\viewerfiles\ajaxmappane.templ</p>  <p>For MapGuide 2011: C:\Program Files\Autodesk\MapGuideEnterprise2011\WebServerExtensions\www\viewerfiles\ajaxmappane.templ, etc.</p>  <p>Edit the source code at about line 3785:</p>  <pre class="csharpcode"><span class="rem">//the code can be modified here,</span>
<span class="rem">//if necessary, to control the size and appearance of the</span>
<span class="rem">//new window. e.g. </span>
window.open(url, targetFrame, 
  <span class="str">&quot;toolbar=no,width=500,height=500,resizable,scrollbars&quot;</span>);
//window.open(linkURL, targetFrame);</pre>
<style type="text/css">
.csharpcode, .csharpcode pre
{
	font-size: small;
	color: black;
	font-family: consolas, "Courier New", courier, monospace;
	background-color: #ffffff;
	/*white-space: pre;*/
}
.csharpcode pre { margin: 0em; }
.csharpcode .rem { color: #008000; }
.csharpcode .kwrd { color: #0000ff; }
.csharpcode .str { color: #006080; }
.csharpcode .op { color: #0000c0; }
.csharpcode .preproc { color: #cc6633; }
.csharpcode .asp { background-color: #ffff00; }
.csharpcode .html { color: #800000; }
.csharpcode .attr { color: #ff0000; }
.csharpcode .alt 
{
	background-color: #f4f4f4;
	width: 100%;
	margin: 0em;
}
.csharpcode .lnum { color: #606060; }</style>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Read FDO Features using Map 3D Geospatial Platform API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: read-fdo-features-using-map-3d-geospatial-platform-api
CATEGORY: AutoCAD Map 3D 2011
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/05/read-fdo-features-using-map-3d-geospatial-platform-api.html 
DATE: 05/17/2012 02:02:48 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>If you are looking for a way to access the FDO features and read the feature attributes in Map 3D using Geospatial Platform API, then the following C#.NET code snippet might be useful to you. This code snippet shows how to use the Geospatial Platform API in AutoCAD Map 3D and access the FDO Features.</p>
<div style="font-family: Consolas; font-size: 10pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: green;">// Get the Map Object</span></p>
<p style="margin: 0px;"><span style="color: #2b91af;">AcMapMap</span> currentMap = <span style="color: #2b91af;">AcMapMap</span>.GetCurrentMap();</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green;">// Prompt user to Select Feature in Map</span></p>
<p style="margin: 0px;"><span style="color: #2b91af;">PromptSelectionOptions</span> psop = <span style="color: blue;">new</span> <span style="color: #2b91af;">PromptSelectionOptions</span>();</p>
<p style="margin: 0px;">psop.MessageForAdding = <span style="color: #a31515;">&quot;Select the FDO Feature in Map 3D to read Data : &quot;</span>;</p>
<p style="margin: 0px;">psop.SingleOnly = <span style="color: blue;">true</span>;</p>
<p style="margin: 0px;"><span style="color: #2b91af;">PromptSelectionResult</span> psResult = ed.GetSelection(psop);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: blue;">if</span> (psResult.Status == <span style="color: #2b91af;">PromptStatus</span>.OK)</p>
<p style="margin: 0px;">{</p>
<p style="margin: 0px;">&#0160; &#0160; <span style="color: #2b91af;">SelectionSet</span> selSet = psResult.Value;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; <span style="color: green;">// Get Map Selectionset from AutoCAD SelectionSet</span></p>
<p style="margin: 0px;">&#0160; &#0160; <span style="color: #2b91af;">MgSelectionBase</span> mapSelBase = <span style="color: #2b91af;">AcMapFeatureEntityService</span>.GetSelection(selSet);</p>
<p style="margin: 0px;">&#0160; &#0160; <span style="color: #2b91af;">AcMapLayer</span> mapLayer = <span style="color: #2b91af;">AcMapFeatureEntityService</span>.GetLayer(psResult.Value[0].ObjectId);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; <span style="color: green;">//Get the ID of the selected Parcel</span></p>
<p style="margin: 0px;">&#0160; &#0160; <span style="color: #2b91af;">MgFeatureReader</span> ftrRdr = mapSelBase.GetSelectedFeatures(mapLayer, mapLayer.FeatureClassName, <span style="color: blue;">false</span>);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; <span style="color: blue;">while</span> (ftrRdr.ReadNext())</p>
<p style="margin: 0px;">&#0160; &#0160; {</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; <span style="color: #2b91af;">MgClassDefinition</span> cd = ftrRdr.GetClassDefinition();</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; <span style="color: green;">//this is just an example; change this according to your FDO data field</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; <span style="color: #2b91af;">String</span> ownerName = ftrRdr.GetString(<span style="color: #a31515;">&quot;STNAME&quot;</span>);</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; ed.WriteMessage(<span style="color: #a31515;">&quot;\n Parcel Owner Name :&quot;</span> + ownerName.ToString());</p>
<p style="margin: 0px;">&#0160; &#0160; }&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160;</p>
<p style="margin: 0px;">}</p>
<p style="margin: 0px;">trans.Commit();</p>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Kim Jjong
EMAIL: 
IP: 125.7.242.86
URL: http://profile.typepad.com/jjong
DATE: 08/30/2013 01:54:38 AM
Hi Partha Sarkar, 

I would like to ask you about "ed." and "trans"

When I was compiling , VS2012 Alerted me that " 'ed' name isn't  context.

Could you please tell me more details explanations.
Thank you.
-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 203.202.234.246
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 08/30/2013 03:05:52 AM
Hi Kim,

Use this :

Editor ed = Autodesk.AutoCAD.ApplicationServices.Application.DocumentManager.MdiActiveDocument.Editor;

Transaction trans = Autodesk.AutoCAD.ApplicationServices.Application.DocumentManager.MdiActiveDocument.Database.TransactionManager.StartTransaction();

Hope this helps!

Thanks,
Partha Sarkar
ADN
-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: How to toggle the layer's visibility programmatically in Ajax viewer of AIMS?
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: how-to-toggle-the-layers-visibility-programmatically-in-ajax-viewer-of-aims
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: Daniel Du
CATEGORY: MapGuide Enterprise 2011

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/05/how-to-toggle-the-layers-visibility-programmatically-in-ajax-viewer-of-aims.html 
DATE: 05/16/2012 02:39:34 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>
<p>As a first step, we need to find the layer and toggle the layer visibility by changing the MgLayer::Visibility property. And next, we need to save the map to apply the change, followed by a call to viewer API to refresh the map. If you are using fusion viewer or flexible web layout, you will want to refer to <a href="http://adndevblog.typepad.com/infrastructure/2012/04/toggle-visibility-of-layer-in-fusion-does-not-work.html" target="_blank">this post</a> as well.</p>
<p>Here is a code snippet to demonstrate it.</p>
<div>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">using</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> System;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">using</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> System.Data;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">using</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> System.Configuration;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">using</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> System.Collections;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">using</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> System.Web;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">using</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> System.Web.Security;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">using</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> System.Web.UI;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">using</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> System.Web.UI.WebControls;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">using</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> System.Web.UI.WebControls.WebParts;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">using</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> System.Web.UI.HtmlControls;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">using</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> OSGeo.MapGuide;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">using</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> System.Collections.Specialized;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">public</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">partial</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">class</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">INTERACTING_WITH_LAYERS_Toggle_Layer_visible</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> </span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; : System.Web.UI.Page</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">{</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">protected</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">void</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> Page_Load(</span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">object</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> sender, </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">EventArgs</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> e)</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160; {</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; NameValueCollection requestParams </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; = Request.HttpMethod == </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;GET&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> ? </span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Request.QueryString : Request.Form;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">String</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> mgSessionId = requestParams[</span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;SESSION&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">];</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">String</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> mgLocale = requestParams[</span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;LOCALE&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">];</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">String</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> mgMapName = requestParams[</span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;MAPNAME&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">];</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">// Initialize the web-tier.</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">String</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> realPath = Request.ServerVariables[</span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;APPL_PHYSICAL_PATH&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">];</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">String</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> configPath = realPath + </span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;..\\webconfig.ini&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">;</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; MapGuideApi.MgInitializeWebTier(configPath);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">// Connect to the site.</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; MgUserInformation userInfo = </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">new</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> MgUserInformation(mgSessionId);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; MgSiteConnection siteConnection = </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">new</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> MgSiteConnection();</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; siteConnection.Open(userInfo);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">// Get an instance of the required service(s).</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; MgResourceService resourceService </span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; = siteConnection.CreateService(</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; MgServiceType.ResourceService</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ) </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">as</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> MgResourceService;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">// Get the current map.</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; MgMap map = </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">new</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> MgMap();</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; map.Open(resourceService, mgMapName);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">// Get map layers.</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; MgLayerCollection mgLayers = map.GetLayers();</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; MgLayer roadsLayer = mgLayers.GetItem(</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;Parcels&quot;</span></span><span style="line-height: 11pt;"><span style="color: #000000;">) </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">as</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> MgLayer;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">//toggle the visibility.</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; roadsLayer.Visible = !roadsLayer.Visible;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">// Save the updated map to apply the change</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; map.Save(resourceService);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Response.Write(</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;Parcels Layers visible togged!&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">//refresh the map using the viewer API</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Response.Write(</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;&lt;script&gt;parent.parent.Refresh();&lt;/script&gt;&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160; }</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">}</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">Another way to refresh map is:&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;"><br /></span></span></p>
</div>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">&lt;</span><span style="color: maroon; line-height: 140%;">script</span><span style="line-height: 140%;"> </span><span style="color: red; line-height: 140%;">type</span><span style="color: blue; line-height: 140%;">=&quot;text/javascript&quot;&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="color: blue; line-height: 140%;">function</span><span style="line-height: 140%;"> RefreshMap() {</span></p>
<p style="margin: 0px;">&#0160;<span style="line-height: 140%; background-color: white; font-size: 8pt;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; parent.parent.Refresh();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">&lt;/</span><span style="color: maroon; line-height: 140%;">script</span><span style="color: blue; line-height: 140%;">&gt;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">&lt;/</span><span style="color: maroon; line-height: 140%;">head</span><span style="color: blue; line-height: 140%;">&gt;</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">&lt;</span><span style="color: maroon; line-height: 140%;">body</span><span style="line-height: 140%;"> </span><span style="color: red; line-height: 140%;">onload</span><span style="color: blue; line-height: 140%;">=&quot;javascript:RefreshMap()&quot;&gt;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">&lt;/</span><span style="color: maroon; line-height: 140%;">body</span><span style="color: blue; line-height: 140%;">&gt;</span></p>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Alexandre Barboza
EMAIL: abarboza@hotmail.com
IP: 187.72.144.65
URL: 
DATE: 07/16/2012 07:00:32 AM
When I applied this code on a raster layer, the layer just hide or show when a I click on Zoom command.
Do you have any tip for Raster Layer?

-----
COMMENT:
AUTHOR: Daniel Du
EMAIL: 
IP: 125.98.160.4
URL: http://profile.typepad.com/daniel_du
DATE: 07/23/2012 11:31:29 PM
I did a test, it works fine for Raster layer as well. A reminder is, please to make sure to refresh the map using viewer API. 

-----
COMMENT:
AUTHOR: Radu
EMAIL: radui@mte.ca
IP: 216.185.82.202
URL: 
DATE: 02/27/2013 07:32:01 AM
can visibility be turned on/off using java script?
-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: DevTV and Code Sample: create temporary layer, feature editing in AIMS2012
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: devtv-and-code-sample-create-temporary-layer-feature-editing-in-aims2012
CATEGORY: AIMS 2012
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/05/devtv-and-code-sample-create-temporary-layer-feature-editing-in-aims2012.html 
DATE: 05/16/2012 02:07:15 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>Are you looking for code samples to create temporary layer in Autodesk Infrastructure Map Server? Are you looking for samples demonstrating insert/update/delete features in AIMS? </p>  <p>Here are two DevTVs and code samples. It demonstrates how to setup and run the samples in DevTV.</p>  <p><a name="section0"></a></p>  <p><a name="section1"></a></p>  <p>Demos of using MapGuide sample 5 &amp; 6 on AIMS2012 are available for Download</p>  <p><img alt="" src="http://images.autodesk.com/adn/images/zip.gif" width="15" height="16" /> <a href="http://download.autodesk.com/media/adn/AIMS_Sample_DevTV_Solution_5_6/AIMSSample_DevTV_Solution5.zip">AIMS Sample DevTV Solution 5</a> <i>(zip - 17.1 MB)</i></p>  <p><img alt="" src="http://images.autodesk.com/adn/images/zip.gif" width="15" height="16" /> <a href="http://download.autodesk.com/media/adn/AIMS_Sample_DevTV_Solution_5_6/AIMSSample_DevTV_Solution6.zip">AIMS Sample DevTV Solution 6</a> <i>(zip - 21.7 MB)</i></p>  <p><img alt="" src="http://images.autodesk.com/adn/images/zip.gif" width="15" height="16" /> <a href="http://download.autodesk.com/media/adn/AIMS_Sample_DevTV_Solution_5_6/MapGuideSamples2012.zip">MapGuide Samples 2012</a> <i>(zip - 22.5 MB)</i></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Badar
EMAIL: mbadarmunir@hotmail.com
IP: 182.185.140.103
URL: 
DATE: 10/06/2012 07:36:33 AM
Dear Daniel,

Thank you very much indeed for your efforts. I had been looking for some tutorial on .NET and AIMS. Thanks to you I found some. But unfortunately I couldn't find the source code in your attached zip files for solutions 5 & 6. Can you kindly provide us the source code so that a newbie like me could start developing? I'll be highly obliged.

Also if possible, can you share with us other solutions also?
-----
COMMENT:
AUTHOR: Daniel Du
EMAIL: 
IP: 
URL: http://profile.typepad.com/daniel_du
DATE: 10/06/2012 06:26:21 PM





Hi Badar,




The sample code of solution 5/6, including all others, can be downloaded from the last link in the post.MapGuide
 Samples 2012(zip
 - 22.5 MB)




Thanks,

Daniel
-----
COMMENT:
AUTHOR: Badar
EMAIL: mbadarmunir@hotmail.com
IP: 182.185.161.135
URL: 
DATE: 10/07/2012 02:02:50 AM
Ah, my bad. Though I copied sample from mgp folder but dunno how I overlooked other folders. I now found 'em. Thanks a lot again.

Regards
-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: How to create my own website to access Fusion viewer of AIMS?
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: how-to-create-my-own-website-to-access-fusion-viewer-of-aims
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: Daniel Du
CATEGORY: MapGuide Enterprise 2011

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/05/how-to-create-my-own-website-to-access-fusion-viewer-of-aims.html 
DATE: 05/15/2012 07:16:15 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>The fusion viewer has a pretty long URL, I want to create my own website instead of the the long address, it is possible ? </p>  <p>The answer is YES, the simplest way(although not a very elegant way) is to can create an website and use Response.Redirect(), referring to the Fusion viewer. </p>  <p>Sometimes, you need to authenticate user first, in that case, you can implement your authentication function yourself, once authentication failed, just stop running the page by Response.End().</p>  <p>To setup the website, you need to setup a website and create a webform(default.aspx), create bin folder and copy dlls from www/mapviewernet/bin</p>  <p>Here is&#160; the code snippet, it uses MapGuide Enterprise 2010, and it also applies to other versions including MapGudie Enterprise 2011, Autodesk Infrastructure Map Server 2012 and 2013 with minor changes. </p>  <p>&#160;</p>  <div style="font-family: ; color: ">   <p style="margin: 0px"></p>    <div style="font-family: ; color: ">     <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> System;</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> System.Data;</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> System.Configuration;</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> System.Web;</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> System.Web.Security;</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> System.Web.UI;</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> System.Web.UI.WebControls;</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> System.Web.UI.WebControls.WebParts;</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> System.Web.UI.HtmlControls;</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> OSGeo.MapGuide;</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#0000ff"><font style="font-size: 8pt">public</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">partial</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">class</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">_Default</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> : System.Web.UI.Page</font></span></font></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">{</font></font></span></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">protected</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">void</font></span><span style="line-height: 11pt"><font color="#000000"> Page_Load(</font></span><span style="line-height: 11pt; color: "><font color="#0000ff">object</font></span><span style="line-height: 11pt"><font color="#000000"> sender, </font></span><span style="line-height: 11pt; color: "><font color="#2b91af">EventArgs</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> e)</font></span></font></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></span></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//Authentication goes here, </font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">// you will need to implement your authentication yourself</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">if</font></span><span style="line-height: 11pt"><font color="#000000">(Authenticated() == </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">false</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">)</font></span></font></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//if authentication failed, return </font></span></font></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Response.End();</font></font></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>      <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">string</font></span><span style="line-height: 11pt"><font color="#000000"> webLayout = </font></span></font><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#a31515">&quot;Library://Samples/Sheboygan/Layouts/</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; TestFlex.ApplicationDefinition</font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#a31515">&quot;;</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">string</font></span><span style="line-height: 11pt"><font color="#000000"> defaultUser = </font></span><span style="line-height: 11pt; color: "><font color="#a31515">&quot;Administrator&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">string</font></span><span style="line-height: 11pt"><font color="#000000"> defaultPassword = </font></span><span style="line-height: 11pt; color: "><font color="#a31515">&quot;admin&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#0000ff">try</font></span></font></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; MapGuideApi.MgInitializeWebTier(</font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#a31515">@&quot;C:\Program Files</font></span></font></p>      <p style="margin: 0px"><span style="line-height: 11pt; color: "><font face="Courier New"><font style="font-size: 8pt" color="#a31515">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; \Autodesk\MapGuideEnterprise2010</font></font></span></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt; color: "><font color="#a31515"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; \WebServerExtensions\www\webconfig.ini&quot;</font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">);</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; MgUserInformation userInfo = </font></font></span></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> MgUserInformation(defaultUser, defaultPassword);</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; MgSite site = </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">new</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> MgSite();</font></span></font></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; site.Open(userInfo);</font></font></span></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">string</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> sessionId = site.CreateSession();</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>      <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Response.Redirect(</font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#a31515">&quot;http://localhost/mapguide2010/</font></span></font></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; fusion/templates/mapguide/slate/index.html</font></font></span></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ?ApplicationDefinition=</font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#a31515">&quot; + webLayout </font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; + </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#a31515">&quot;&amp;Session=&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> + sessionId);</font></span></font></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">catch</font></span><span style="line-height: 11pt"><font color="#000000"> (</font></span><span style="line-height: 11pt; color: "><font color="#2b91af">Exception</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> ex)</font></span></font></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Response.Write(ex.Message);</font></font></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></span></p>      <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">public</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">bool</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> Authenticated()</font></span></font></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></span></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">//implement your authentication logic yourself</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt; color: "><font style="font-size: 8pt" color="#008000">// ....</font></span></font></p>      <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>      <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt; color: "><font color="#0000ff">return</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt; color: "><font color="#0000ff">true</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">}</font></font></span></p>   </div>     </div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Miha
EMAIL: mihapozauko@gmail.com
IP: 213.161.30.186
URL: 
DATE: 07/07/2012 12:14:54 PM
Hey.
I'm a noob at Mapguide and i just started to work with MG OpenSource. So i would like to ask you if this is applicable to open source version as well. Because in MGOS (2.4 version) i can't seem to find or enable the authentication settings (login) for fusion layout.This question is probably more suitable for MGOS forum but since i read this blog article of yours (and i really like your articles-very informative) i wanted to ask you directly.

Thanks!
-----
COMMENT:
AUTHOR: Daniel Du
EMAIL: Daniel.Du@autodesk.com
IP: 125.98.160.4
URL: http://adndevblog.typepad.com/autocad/daniel-du/
DATE: 07/08/2012 07:39:01 PM
This code snippet is not tested on MapGuide OpenSource, but yes, it should work with minor changes.

Thanks,
Daniel 
-----
COMMENT:
AUTHOR: Anand
EMAIL: anand_krishan11@yahoo.co.uk
IP: 112.133.198.134
URL: 
DATE: 10/07/2012 03:22:09 AM
Daniel,
I am using .NET ASP C#. Will it work with that as well.

I am new to Mapguide and .Net

At this moment i am using anonymous user name and paswword. But I want to use authentication of user which are created in Mapguide Administrator as per role ect.

Regards,
Anand
-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: List all alignment entities
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: list-all-alignment-entities
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D 2011
CATEGORY: AutoCAD Civil 3D 2012
CATEGORY: AutoCAD Civil 3D 2013

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/05/list-all-alignment-entities.html 
DATE: 05/15/2012 02:34:46 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>An alignment is composed of entities, which can be complex, such as SpiralCurveSpiral (SCS), but in the end is basically composed by Lines, Arcs and Spirals.</p>  <p>For both cases we can start at the Alignment.Entities property collection, but this property only return the first level of complex entities derived from type AlignmentEntity. For the second level, corresponding to primitive entities, for each of those AlignmentEntity objects we can access as an array of AlignmentSubEntity. </p>  <div style="font-family: ; background: white">   <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Public</font></span><font color="#000000"> </font><span><font color="#0000ff">Sub</font></span><font color="#000000"> alignmentsEntities()</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> ed </font><span><font color="#0000ff">As</font></span><font color="#000000"> Editor = _</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#2b91af">Application</font></span><font color="#000000">.DocumentManager.MdiActiveDocument.Editor</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> db </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">Database</font></span><font color="#000000"> = _</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#2b91af">Application</font></span><font color="#000000">.DocumentManager.MdiActiveDocument.Database</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Using</font></span><font color="#000000"> trans </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">Transaction</font></span><font color="#000000"> = _</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; db.TransactionManager.StartTransaction()</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 10pt" color="#008000">'get the civil document</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> civilDoc </font><span><font color="#0000ff">As</font></span><font color="#000000"> CivilDocument = CivilApplication.ActiveDocument</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 10pt" color="#008000">'and the collection of alignments</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> alignColl </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">ObjectIdCollection</font></span><font color="#000000"> = _</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; civilDoc.GetAlignmentIds()</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">For</font></span><font color="#000000"> </font><span><font color="#0000ff">Each</font></span><font color="#000000"> alignId </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">ObjectId</font></span><font color="#000000"> </font><span><font color="#0000ff">In</font></span><font color="#000000"> alignColl </font></font><span><font style="font-size: 10pt" color="#008000">'for each alignment</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 10pt" color="#008000">'open for read</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> align </font><span><font color="#0000ff">As</font></span><font color="#000000"> Alignment = trans.GetObject( _</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; alignId, </font></font><font style="font-size: 10pt"><span><font color="#2b91af">OpenMode</font></span><font color="#000000">.ForRead)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 10pt" color="#008000">'for each entity in the alignment</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">For</font></span><font color="#000000"> </font><span><font color="#0000ff">Each</font></span><font color="#000000"> alignEnt </font><span><font color="#0000ff">As</font></span><font color="#000000"> AlignmentEntity </font><span><font color="#0000ff">In</font></span><font color="#000000"> align.Entities</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 10pt" color="#008000">'get the number of sub entities</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> subEntCount </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#0000ff">Integer</font></span><font color="#000000"> = alignEnt.SubEntityCount</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">For</font></span><font color="#000000"> i </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#0000ff">Integer</font></span><font color="#000000"> = 0 </font><span><font color="#0000ff">To</font></span><font color="#000000"> subEntCount - 1 </font></font><span><font style="font-size: 10pt" color="#008000">'for each subentity</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 10pt" color="#008000">'get the type</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> alignSubEnt </font><span><font color="#0000ff">As</font></span><font color="#000000"> AlignmentSubEntity = alignEnt(i)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Select</font></span><font color="#000000"> </font><span><font color="#0000ff">Case</font></span><font color="#000000"> alignSubEnt.SubEntityType</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Case</font></span><font color="#000000"> AlignmentSubEntityType.Arc</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 10pt" color="#008000">'ARC</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> alignSubEntArc </font><span><font color="#0000ff">As</font></span><font color="#000000"> AlignmentSubEntityArc = _</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; alignSubEnt</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Case</font></span><font color="#000000"> AlignmentSubEntityType.Line</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 10pt" color="#008000">'LINE</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> alignSubEntLine </font><span><font color="#0000ff">As</font></span><font color="#000000"> AlignmentSubEntityLine = _</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; alignSubEnt</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Case</font></span><font color="#000000"> AlignmentSubEntityType.Spiral</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 10pt" color="#008000">'SPIRAL</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> alignSubEntSpiral </font><span><font color="#0000ff">As</font></span><font color="#000000"> AlignmentSubEntitySpiral = _</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; alignSubEnt</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#0000ff">Select</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 10pt" color="#0000ff">Next</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 10pt" color="#0000ff">Next</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 10pt" color="#0000ff">Next</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#0000ff">Using</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#0000ff">Sub</font></span></font></p> </div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: petcon
EMAIL: newton521200@yahoo.com.cn
IP: 74.125.184.42
URL: 
DATE: 05/16/2012 04:42:47 AM
any c# code？
-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 189.8.69.39
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 05/16/2012 05:35:24 AM
Hi,

You can easily convert between VB.NET and C# using this online (and free) tool <a href="http://www.developerfusion.com/tools/convert/vb-to-csharp/">http://www.developerfusion.com/tools/convert/vb-to-csharp/</a>

Regards,
Augusto Goncalves
-----
COMMENT:
AUTHOR: joantopo
EMAIL: joantopo@hotmail.com
IP: 88.25.45.218
URL: 
DATE: 02/19/2013 11:25:19 AM
Hello.
VS doesn´t find the next words in the code:
"Editor"
"Database"
"Transaction"
"objectIDcollection"

I have imported(using) the next namespaces and others:
using Autodesk.Civil.ApplicationServices;
using Autodesk.Civil.DatabaseServices;
using Autodesk.Civil.Runtime;
using Autodesk.Civil.Settings;

Which references *.dll do I have to add or import namespaces? Thank you.



-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 200.57.88.172
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 02/19/2013 11:30:34 AM
Hi,

You need the following .NET references:

AcMgd.dll
AcDbMgd.dll
AcCoreMgd.dll (2013 only)
AecBaseMgd.dll
AeccDbMgd.dll

All references are at the Civil3D folder. Please try that and let me know.

Regards,
Augusto Goncalves
-----
COMMENT:
AUTHOR: joantopo
EMAIL: joantopo@hotmail.com
IP: 88.25.45.218
URL: 
DATE: 02/19/2013 12:26:52 PM
I already have all these added assemblies. Can I contact myself with you?


-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 177.84.160.213
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 02/21/2013 11:25:10 AM
Hi,

Please email me. My first name, dot, my last name, @autodesk.com

Thanks,
Augusto Goncalves
-----
COMMENT:
AUTHOR: joantopo
EMAIL: joantopo@hotmail.com
IP: 88.15.242.231
URL: 
DATE: 02/28/2013 12:01:03 PM
Hello Augusto.

I don´t understand a thing.



In this line "foreach (AlignmentEntity alignEnt in align.Entities)" is supposed to start at the order of entities in the drawing, but using the debugger, I do not understand what order continues to go naming each entity.

For example, if I start with a line and then I have an entity SCS, until appoints five Alignmentline, the following is not AlignmentSCS.

What criteria is to order and how you could get a Database with sorted entities? I would like a database as if the alignment table.

Thank you.

-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 200.150.29.130
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 03/01/2013 11:29:12 AM
Hi,

You should use GetEntityByOrder instead, which requires a 'for' on the index.

There are a couple samples at <a href="http://adndevblog.typepad.com/infrastructure/2012/08/replacing-alignment-entities.html">http://adndevblog.typepad.com/infrastructure/2012/08/replacing-alignment-entities.html</a> and <a href="http://adndevblog.typepad.com/infrastructure/2012/08/using-overrule-with-civil-3d-entities.html">http://adndevblog.typepad.com/infrastructure/2012/08/using-overrule-with-civil-3d-entities.html</a>

Regards,
Augusto Goncalves
-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Creating MPolygon object using .NET API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: creating-mpolygon-object-using-net-api
CATEGORY: AutoCAD Civil 3D 2011
CATEGORY: AutoCAD Civil 3D 2012
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: AutoCAD Map 3D 2011
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/05/creating-mpolygon-object-using-net-api.html 
DATE: 05/15/2012 03:20:32 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>If ever, you were searching for a code snippet to see how you can create MPolygon object using .NET API, your search ends here :)</p>
<p><br />Here is the C# .NET code snippet which demonstrates Mpolygon creation. Make sure to reference <strong>AcMPolygonMGD.dll</strong> assembly in your project.</p>
<div style="font-family: Consolas; font-size: 10pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: blue;">using</span> (<span style="color: #2b91af;">Transaction</span> trans = db.TransactionManager.StartTransaction())</p>
<p style="margin: 0px;">{</p>
<p style="margin: 0px;">&#0160; &#0160; <span style="color: blue;">try</span></p>
<p style="margin: 0px;">&#0160; &#0160; {</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; <span style="color: #2b91af;">BlockTable</span> blockTable = trans.GetObject(db.BlockTableId, Autodesk.AutoCAD.DatabaseServices.<span style="color: #2b91af;">OpenMode</span>.ForRead) <span style="color: blue;">as</span> <span style="color: #2b91af;">BlockTable</span>;</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; <span style="color: #2b91af;">BlockTableRecord</span> blockTableRecord = trans.GetObject(blockTable[<span style="color: #2b91af;">BlockTableRecord</span>.ModelSpace], Autodesk.AutoCAD.DatabaseServices.<span style="color: #2b91af;">OpenMode</span>.ForWrite) <span style="color: blue;">as</span> <span style="color: #2b91af;">BlockTableRecord</span>;</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; <span style="color: #2b91af;">MPolygonLoop</span> mPolygonLoop = <span style="color: blue;">new</span> <span style="color: #2b91af;">MPolygonLoop</span>();</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; mPolygonLoop.Add(<span style="color: blue;">new</span> <span style="color: #2b91af;">BulgeVertex</span>(<span style="color: blue;">new</span> <span style="color: #2b91af;">Point2d</span>(2, 2), 0));</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; mPolygonLoop.Add(<span style="color: blue;">new</span> <span style="color: #2b91af;">BulgeVertex</span>(<span style="color: blue;">new</span> <span style="color: #2b91af;">Point2d</span>(2, 1), 0));</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; mPolygonLoop.Add(<span style="color: blue;">new</span> <span style="color: #2b91af;">BulgeVertex</span>(<span style="color: blue;">new</span> <span style="color: #2b91af;">Point2d</span>(1, 1), 0));</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; mPolygonLoop.Add(<span style="color: blue;">new</span> <span style="color: #2b91af;">BulgeVertex</span>(<span style="color: blue;">new</span> <span style="color: #2b91af;">Point2d</span>(1, 2), 0));</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; mPolygonLoop.Add(<span style="color: blue;">new</span> <span style="color: #2b91af;">BulgeVertex</span>(<span style="color: blue;">new</span> <span style="color: #2b91af;">Point2d</span>(2, 2), 0));</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; <span style="color: #2b91af;">MPolygon</span> mPolygon = <span style="color: blue;">new</span> <span style="color: #2b91af;">MPolygon</span>();</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; mPolygon.AppendMPolygonLoop(mPolygonLoop, <span style="color: blue;">false</span>, 0);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; <span style="color: green;">// set the pattern scale and space</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; mPolygon.PatternScale = 0.05;</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; mPolygon.PatternSpace = 0.05;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; <span style="color: green;">//set the predefined pattern.</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; mPolygon.SetPattern(<span style="color: #2b91af;">HatchPatternType</span>.PreDefined, <span style="color: #a31515;">&quot;ANSI37&quot;</span>);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; blockTableRecord.AppendEntity(mPolygon);</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; trans.AddNewlyCreatedDBObject(mPolygon, <span style="color: blue;">true</span>);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; trans.Commit();</p>
<p style="margin: 0px;">&#0160; &#0160; }</p>
<p style="margin: 0px;">&#0160; &#0160; <span style="color: blue;">catch</span> (System.<span style="color: #2b91af;">Exception</span> ex)</p>
<p style="margin: 0px;">&#0160; &#0160; {</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; ed.WriteMessage(<span style="color: #a31515;">&quot;\nException: &quot;</span> + ex.Message);</p>
<p style="margin: 0px;">&#0160; &#0160; }</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">}</p>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:
MPolygon, .NET API
-----
COMMENT:
AUTHOR: Norman Yuan
EMAIL: norman.yuan@focus.ca
IP: 207.229.13.65
URL: 
DATE: 01/03/2013 03:03:37 PM
Why accessing MPolygon.PatternColor property (readin g the property value) causes fatal error. The proeprty is { set; get}. Setting the color is OK. I tried it with AcadMap2009 (32bit) and AcadMap2012(64-bit), behaved the same. Is this a bug? If it is, is Autodesk going to fixed eventually?
-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 203.202.234.246
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 01/03/2013 09:06:30 PM
Hi Norman,

I have seen this issue and same is reported to our QA & Engineering team. I am expecting a fix to come in future release, but at this point of time, I can't comment on when exactly this fix would be available.

Thanks,
Partha Sarkar,
ADN
-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Are you getting exceptions when accessing Object Data Records from Entity in Map 3D?
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: are-you-getting-exceptions-when-accessing-object-data-records-from-entity-in-map-3d
CATEGORY: AutoCAD Map 3D 2011
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/05/are-you-getting-exceptions-when-accessing-object-data-records-from-entity-in-map-3d.html 
DATE: 05/14/2012 09:46:56 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>Sometimes, when using managed Map API to access Object Data Record from Entity you may hit exceptions or unexpected errors. You might be wondering why this exception? Take a look into your code to see if <em><strong>Records </strong></em>object is <em>Disposed </em>properly.&#0160;</p>
<p><br />Here is a .NET code snippet which demonstrates timely dispose of Records by simple usage of *<strong>using</strong>* clause :</p>
<div style="font-family: Consolas; font-size: 10pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: blue;">using</span> (<span style="color: #2b91af;">Transaction</span> trans = db.TransactionManager.StartTransaction())</p>
<p style="margin: 0px;">{</p>
<p style="margin: 0px;">&#0160; &#0160; <span style="color: blue;">try</span></p>
<p style="margin: 0px;">&#0160; &#0160; {</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; <span style="color: #2b91af;">BlockTable</span> bt = (<span style="color: #2b91af;">BlockTable</span>)trans.GetObject(db.BlockTableId, <span style="color: #2b91af;">OpenMode</span>.ForRead, <span style="color: blue;">false</span>);</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; <span style="color: #2b91af;">BlockTableRecord</span> btr = (<span style="color: #2b91af;">BlockTableRecord</span>)trans.GetObject(bt[<span style="color: #2b91af;">BlockTableRecord</span>.ModelSpace], <span style="color: #2b91af;">OpenMode</span>.ForRead, <span style="color: blue;">false</span>);</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; <span style="color: blue;">foreach</span> (<span style="color: #2b91af;">ObjectId</span> id <span style="color: blue;">in</span> btr)</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; {</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: green;">// *using* will ensure the variable records will be disposed in time</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">using</span> (<span style="color: #2b91af;">Records</span> records = tables.GetObjectRecords(0, id, Autodesk.Gis.Map.Constants.<span style="color: #2b91af;">OpenMode</span>.OpenForRead, <span style="color: blue;">false</span>))</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; {</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: green;">// access Records</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; }</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; }</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; trans.Commit();</p>
<p style="margin: 0px;">&#0160; &#0160; }</p>
<p style="margin: 0px;">&#0160; &#0160; <span style="color: blue;">catch</span> (System.<span style="color: #2b91af;">Exception</span> ex)</p>
<p style="margin: 0px;">&#0160; &#0160; {</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; ed.WriteMessage(<span style="color: #a31515;">&quot;\nException: &quot;</span> + ex.Message);</p>
<p style="margin: 0px;">&#0160; &#0160; }</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">}</p>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Chuck
EMAIL: chuckwilbur@spatialnet.net
IP: 75.132.4.27
URL: 
DATE: 05/15/2012 07:33:11 PM
Aren't you Disposing trans twice? Once in the finally block and once invisibly as you leave the using clause?

See <a href="http://msdn.microsoft.com/en-us/library/yh598w02.aspx">http://msdn.microsoft.com/en-us/library/yh598w02.aspx</a>
-----
COMMENT:
AUTHOR: Partha
EMAIL: partha.sarkar@autodesk.com
IP: 203.116.198.71
URL: 
DATE: 05/15/2012 09:53:20 PM
Hi Chuck,

Thanks for the comments! In this particular code snippet it's redundant; I have updated the code snippet accordingly, but it might be useful in a larger code sample where exceptions are not handled appropriately and in that situation we should call trans.Dispose() and I would rather use it in this way :

finally
{
 if (trans != null)
   {
      trans.Dispose();
   }
}

Thanks,
Partha
-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Connect to data source using FDO API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: connect-to-data-source-using-fdo-api
CATEGORY: AutoCAD Map 3D 2011
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/05/connect-to-data-source-using-fdo-api.html 
DATE: 05/13/2012 07:51:44 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>Here is a code snippet to demonstrate how to connect to data sources, with this tool code snippet, you will get deep understanding which parameters are needed for each provider. </p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.ApplicationServices;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.EditorInput;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.AutoCAD.Runtime;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> OSGeo.FDO;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> OSGeo.FDO.ClientServices;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> OSGeo.FDO.Commands;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> OSGeo.FDO.Commands.DataStore;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> OSGeo.FDO.Commands.Schema;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> OSGeo.FDO.Connections;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> OSGeo.FDO.Connections.Capabilities;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> OSGeo.FDO.Schema;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">class</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Class1</span></p>    <p style="margin: 0px"><span style="line-height: 140%">{</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">IConnection</span><span style="line-height: 140%"> m_pConnection = </span><span style="line-height: 140%; color: blue">null</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Editor</span><span style="line-height: 140%"> ed = </span><span style="line-height: 140%; color: #2b91af">Application</span><span style="line-height: 140%">.DocumentManager.MdiActiveDocument.Editor;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">FeatureClass</span><span style="line-height: 140%"> m_baseClass;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">FeatureClass</span><span style="line-height: 140%"> m_riverClass;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">ProviderCollection</span><span style="line-height: 140%"> m_Providers;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%"> m_sProviderName;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; [</span><span style="line-height: 140%; color: #2b91af">CommandMethod</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: #a31515">&quot;connect&quot;</span><span style="line-height: 140%">)]</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> Connect()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">IConnectionManager</span><span style="line-height: 140%"> connMgr;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">int</span><span style="line-height: 140%"> index;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Provider</span><span style="line-height: 140%"> provider;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">IProviderRegistry</span><span style="line-height: 140%"> registry = </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">FeatureAccessManager</span><span style="line-height: 140%">.GetProviderRegistry();</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_Providers = registry.GetProviders();</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">for</span><span style="line-height: 140%"> (</span><span style="line-height: 140%; color: blue">int</span><span style="line-height: 140%"> i = 0; i &lt; m_Providers.Count; i++)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; provider = m_Providers[i];</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%">.Format</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; (</span><span style="line-height: 140%; color: #a31515">&quot;FDO support provider {0}, its index is {1} \n&quot;</span><span style="line-height: 140%">, </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; provider.Name, i));</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">PromptIntegerResult</span><span style="line-height: 140%"> intRes = </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.GetInteger(</span><span style="line-height: 140%; color: #a31515">&quot;please input the provider's index&quot;</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (intRes.Status == </span><span style="line-height: 140%; color: #2b91af">PromptStatus</span><span style="line-height: 140%">.OK)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; index = intRes.Value;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; provider = m_Providers[index];</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_sProviderName = provider.Name;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%"> shortName = provider.Name.Split(</span><span style="line-height: 140%; color: #a31515">'.'</span><span style="line-height: 140%">)[1];</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">try</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; connMgr = </span><span style="line-height: 140%; color: #2b91af">FeatureAccessManager</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; .GetConnectionManager();</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_pConnection = connMgr</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; .CreateConnection(m_sProviderName);</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">IConnectionInfo</span><span style="line-height: 140%"> connInfo </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; = m_pConnection.ConnectionInfo;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">IConnectionPropertyDictionary</span><span style="line-height: 140%"> properties </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; = connInfo.ConnectionProperties;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; InputParametersValue(properties);</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">ConnectionState</span><span style="line-height: 140%"> connState = m_pConnection.Open();</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</span><span style="line-height: 140%; color: #a31515">&quot;connect status is &quot;</span><span style="line-height: 140%"> </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; + connState.ToString() + </span><span style="line-height: 140%; color: #a31515">&quot;\n&quot;</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">catch</span><span style="line-height: 140%"> (OSGeo.FDO.Common.</span><span style="line-height: 140%; color: #2b91af">Exception</span><span style="line-height: 140%"> exception)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</span><span style="line-height: 140%; color: #a31515">&quot;There are some exceptions </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; with message : </span><span style="line-height: 140%; color: #a31515">&quot; </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; + exception.Message + </span><span style="line-height: 140%; color: #a31515">&quot;\n&quot;</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">else</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</span><span style="line-height: 140%; color: #a31515">&quot;you did not select a correct provider,</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; exit \n</span><span style="line-height: 140%; color: #a31515">&quot;);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; [</span><span style="line-height: 140%; color: #2b91af">CommandMethod</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: #a31515">&quot;DisConnect&quot;</span><span style="line-height: 140%">)]</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> CloseConnection()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_pConnection.Close();</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> InputParametersValue(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">IConnectionPropertyDictionary</span><span style="line-height: 140%"> properties)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%">[] propertiesNames = properties.PropertyNames;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">foreach</span><span style="line-height: 140%"> (</span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%"> name </span><span style="line-height: 140%; color: blue">in</span><span style="line-height: 140%"> propertiesNames)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">PromptStringOptions</span><span style="line-height: 140%"> pso = </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">PromptStringOptions</span><span style="line-height: 140%">(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;Please input the value for \&quot;&quot;</span><span style="line-height: 140%"> + name + </span><span style="line-height: 140%; color: #a31515">&quot;\&quot;:&quot;</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">PromptResult</span><span style="line-height: 140%"> psr = ed.GetString(pso);</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (properties.IsPropertyRequired(name))</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">while</span><span style="line-height: 140%"> (psr.Status != </span><span style="line-height: 140%; color: #2b91af">PromptStatus</span><span style="line-height: 140%">.OK)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(</span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%">.Format(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;Parameter \&quot;{0}\&quot; is required, please </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; input value again\n</span><span style="line-height: 140%; color: #a31515">&quot;, name));</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; psr = ed.GetString(pso);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; properties.SetProperty(name, psr.StringResult);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> ListPropertiesParameters(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">IDataStorePropertyDictionary</span><span style="line-height: 140%"> properties)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">foreach</span><span style="line-height: 140%"> (</span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%"> name </span><span style="line-height: 140%; color: blue">in</span><span style="line-height: 140%"> properties.PropertyNames)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ed.WriteMessage(name + </span><span style="line-height: 140%; color: #a31515">&quot;\n&quot;</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; [</span><span style="line-height: 140%; color: #2b91af">CommandMethod</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: #a31515">&quot;CreateDataStore&quot;</span><span style="line-height: 140%">)]</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> CreateDataStore()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">ICreateDataStore</span><span style="line-height: 140%"> createDS = m_pConnection.CreateCommand(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">CommandType</span><span style="line-height: 140%">.CommandType_CreateDataStore) </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">as</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">ICreateDataStore</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">IDataStorePropertyDictionary</span><span style="line-height: 140%"> properties </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; = createDS.DataStoreProperties;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; InputParametersValue(properties);</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; createDS.Execute();</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">}</span></p>    <p style="margin: 0px"></p> </div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Firexoulz
EMAIL: fremorx_07@yahoo.com
IP: 112.202.20.50
URL: 
DATE: 05/14/2012 05:08:23 PM
Thank you very much this is a great help... Nice blog.. Keep em' up!... Thank you for sharing your wisdom to others...
-----
COMMENT:
AUTHOR: Daniel Du
EMAIL: Daniel.Du@autodesk.com
IP: 74.125.19.35
URL: http://adndevblog.typepad.com/autocad/daniel-du/
DATE: 05/14/2012 06:47:15 PM
Thank you for the comment, I am glad to hear it helps :) 
-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Accessing Layer names from the selected FDO Features
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: accessing-layer-names-from-the-selected-fdo-features
CATEGORY: AutoCAD Map 3D 2011
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/05/accessing-layer-names-from-the-selected-fdo-features.html 
DATE: 05/11/2012 03:50:47 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>When you select a FDO feature in Map 3D, you want to know the corresponding layer name as shown in Map 3D display Manager. How to do this using Map 3D Geospatial Platform API ?</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0168eb6502ab970c-pi" style="display: inline;"><img alt="Img1" class="asset  asset-image at-xid-6a0167607c2431970b0168eb6502ab970c" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0168eb6502ab970c-500wi" title="Img1" /></a></p>
<p><br />We can use the <em><strong>MgSelectionBase.GetLayers()</strong></em> API to get the layers name for the selected FDO features in Map 3D. Here is a C#.NET code snippet for the same:</p>
<div style="font-family: Consolas; font-size: 10pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: green;">// Get the Map Object</span></p>
<p style="margin: 0px;"><span style="color: #2b91af;">AcMapMap</span> currentMap = <span style="color: #2b91af;">AcMapMap</span>.GetCurrentMap();</p>
<p style="margin: 0px;"><span style="color: #2b91af;">MgLayerCollection</span> layers = currentMap.GetLayers();</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green;">//select feature on Map</span></p>
<p style="margin: 0px;"><span style="color: #2b91af;">PromptSelectionResult</span> selResult = ed.GetSelection();</p>
<p style="margin: 0px;"><span style="color: blue;">if</span> (selResult.Status == <span style="color: #2b91af;">PromptStatus</span>.OK)</p>
<p style="margin: 0px;">{</p>
<p style="margin: 0px;">&#0160; &#0160; <span style="color: #2b91af;">SelectionSet</span> selSet = selResult.Value;</p>
<p style="margin: 0px;">&#0160; &#0160; <span style="color: #2b91af;">MgSelectionBase</span> selectionBase = <span style="color: #2b91af;">AcMapFeatureEntityService</span>.GetSelection(selSet);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; <span style="color: blue;">foreach</span> (<span style="color: #2b91af;">MgLayerBase</span> layer <span style="color: blue;">in</span> selectionBase.GetLayers())</p>
<p style="margin: 0px;">&#0160; &#0160; {</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; ed.WriteMessage(<span style="color: #a31515;">&quot;\nFeature selected from Layer :&quot;</span> + layer.Name.ToString());</p>
<p style="margin: 0px;">&#0160; &#0160; }</p>
<p style="margin: 0px;">}</p>
</div>
<p>&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Firexoulz
EMAIL: fremorx_07@yahoo.com
IP: 112.202.20.50
URL: 
DATE: 05/13/2012 05:48:41 PM
Hello.. can you give a sample codes on vb.net of how to connect vb.net on autocad map 3d. Thank you! hope you continue sharing your knowledge. :)
-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Speed up the scrolling of Mobile Viewer panel
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: speed-up-the-scrolling-of-mobile-viewer-panel
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/05/speed-up-the-scrolling-of-mobile-viewer-panel.html 
DATE: 05/10/2012 09:15:00 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>
<p>You may find the the scrolling of legend and property panel is too slow in iPad when you have many items in the panel.</p>
<p>Here is a workaround for this.</p>
<p>1. Open MobileViewer\lib\mobileviewerSF.js</p>
<p>2. Go to function onScroll: function(e)</p>
<p>3. Add diffY *= 4; after if(diffY != 0)</p>
<pre class="csharpcode"><span class="kwrd">if</span>(diffY != 0)
{
  <strong> diffY *= 4;</strong>
   <span class="kwrd">var</span> newTop = <span class="kwrd">this</span>.startDragOffsetY - diffY;
    <span class="kwrd">var</span> visibleHeight = <span class="kwrd">this</span>.parentDiv.clientHeight <br />                     - <span class="kwrd">this</span>.titleBarDiv.clientHeight;
    <span class="kwrd">if</span>(newTop &lt; visibleHeight <br />                 - <span class="kwrd">this</span>.scrollPanelDiv.scrollHeight)
    {
        newTop = visibleHeight <br />                  - <span class="kwrd">this</span>.scrollPanelDiv.scrollHeight;
        <span class="kwrd">this</span>.captureDragStart(e);
    }
...</pre>
<p>To make it effective, please open C:\Program Files\Autodesk\Autodesk Infrastructure Web Server Extension 2012\www\MobileViewer\index.html and change JavaScript references to this modified file:</p>
<pre>&lt;!-- For debugging, use these links--&gt;
&lt;script type=&quot;text/javascript&quot; src=&quot;lib/mobileviewerSF.js&quot;&gt;
&lt;/script&gt;</pre>
<p><span style="font-family: Arial;">You may want to check <a href="http://adndevblog.typepad.com/infrastructure/2012/04/debugging-fusion-viewer-or-mobile-viewer-of-aims-in-firebug.html" target="_blank">this blog</a> for more detail information.</span></p>
<p>Hope this helps!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Loading a *.layer file using API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: loading-a-layer-file-using-api
CATEGORY: AutoCAD Map 3D 2011
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/05/loading-a-layer-file-using-api.html 
DATE: 05/10/2012 02:42:04 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>In AutoCAD Map 3D you can use the &#39;Load Layer...&#39; UI tool to load a <strong>*.layer</strong> file and create data layer with specific FDO data source.</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01676662d28d970b-pi" style="display: inline;"><img alt="Img1" class="asset  asset-image at-xid-6a0167607c2431970b01676662d28d970b" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01676662d28d970b-320wi" title="Img1" /></a><br /><br /><br />If you have many such *.layer files and you want them to load programmatically, you can use <strong>Autodesk.Gis.Map.Platform.AcMapMap &#0160;<em>LoadLayer(string layerFile)</em></strong> API for the same.&#0160;</p>
<p>Here is a C# code snippet :</p>
<div style="font-family: Consolas; font-size: 10pt; color: black; background: white;">
<p style="margin: 0px;">&#0160; &#0160; <span style="color: blue;">try</span></p>
<p style="margin: 0px;">&#0160; &#0160; {</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; <span style="color: green;">// Get the Map Object</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; <span style="color: #2b91af;">AcMapMap</span> currentMap = <span style="color: #2b91af;">AcMapMap</span>.GetCurrentMap();</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; currentMap.LoadLayer(<span style="color: #a31515;">@&quot;C:\Data_set\Layer_Files\Parcels.layer&quot;</span>);&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; }</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; <span style="color: blue;">catch</span> (<span style="color: #2b91af;">MgException</span> ex)</p>
<p style="margin: 0px;">&#0160; &#0160; {</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; ed.WriteMessage(ex.Message.ToString());</p>
<p style="margin: 0px;">&#0160; &#0160; }</p>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Create a custom Query with Boundary Type as 'Point' using Map 3D .NET API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: create-a-custom-query-with-boundary-type-as-point-using-map-3d-net-api
CATEGORY: AutoCAD Map 3D 2011
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/05/create-a-custom-query-with-boundary-type-as-point-using-map-3d-net-api.html 
DATE: 05/09/2012 06:31:39 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>Presume you have some DWG files attached to your project in AutoCAD Map 3D and you want to run a Query with Boundary Type as &#39;Point&#39;. What you do in Map 3D?&#0160;</p>
<p>You bring up the &#39;Define Query of Attached Drawing(s)&#39; dialog box and select the &#39;Location&#39; button. In &#39;Location Condition&#39; dialog box, select &#39;Point&#39; (see the screenshot below) and define the location and finally execute the Query. You get to see the desired result in Map 3D Model space.</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01676658705d970b-pi" style="display: inline;"><img alt="IMG1" class="asset  asset-image at-xid-6a0167607c2431970b01676658705d970b" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01676658705d970b-320wi" title="IMG1" /></a></p>
<p>&#0160;</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01676658711f970b-pi" style="display: inline;"><img alt="IMG2" class="asset  asset-image at-xid-6a0167607c2431970b01676658711f970b" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01676658711f970b-320wi" title="IMG2" /></a><br /><br /></p>
<p>In a complicated project you don&#39;t want user to select the Point location arbitrarily and you simply want them to run a predefined custom command to execute the query with that particular point location. Here is a VB.NET code snippet which uses Map 3D managed API to run a custom query:</p>
<div style="font-family: Consolas; font-size: 10pt; color: black; background: white;">
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: green;">&#39;&#39; Create the query using ProjectModel.CreateQuery().</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Dim</span> dwg <span style="color: blue;">As</span> <span style="color: #2b91af;">Document</span> = <span style="color: #2b91af;">Application</span>.DocumentManager.MdiActiveDocument</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Dim</span> database <span style="color: blue;">As</span> <span style="color: #2b91af;">Database</span> = dwg.Database</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Dim</span> PROJECT <span style="color: blue;">As</span> Project.<span style="color: #2b91af;">ProjectModel</span> = <span style="color: #2b91af;">HostMapApplicationServices</span>.Application.ActiveProject</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Dim</span> qryModel <span style="color: blue;">As</span> <span style="color: #2b91af;">QueryModel</span> = PROJECT.CreateQuery()</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: green;">&#39;&#39; Clear the exisitng Query</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; qryModel.Clear()</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: green;">&#39;&#39; Create one or more query conditions</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Dim</span> locationCondition <span style="color: blue;">As</span> Query.<span style="color: #2b91af;">LocationCondition</span> = <span style="color: blue;">New</span> Query.<span style="color: #2b91af;">LocationCondition</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Dim</span> qryCondition <span style="color: blue;">As</span> <span style="color: #2b91af;">LocationCondition</span> = <span style="color: blue;">New</span> <span style="color: #2b91af;">LocationCondition</span>()</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: green;">&#39;&#39; This point location is specific to a test DWG file</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Dim</span> pt3d <span style="color: blue;">As</span> <span style="color: #2b91af;">Point3d</span> = <span style="color: blue;">New</span> <span style="color: #2b91af;">Point3d</span>(3080168.7995, 1271284.8294, 0.0)</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Dim</span> pntBdry <span style="color: blue;">As</span> <span style="color: #2b91af;">PointBoundary</span> = <span style="color: blue;">New</span> <span style="color: #2b91af;">PointBoundary</span>(pt3d)</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; qryCondition.Boundary = pntBdry</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Dim</span> qryBranch <span style="color: blue;">As</span> <span style="color: blue;">New</span> <span style="color: #2b91af;">QueryBranch</span>(<span style="color: #2b91af;">JoinOperator</span>.OperatorAnd)</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; qryBranch.AppendOperand(qryCondition)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: green;">&#39;&#39;Create the query definition by passing the root query branch to QueryModel.Define().</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; qryModel.Define(qryBranch)</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; qryModel.Mode = <span style="color: #2b91af;">QueryType</span>.QueryDraw</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; qryModel.Run()</p>
</div>
<p><br /><br />Hope this is useful to you!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:
Query, .NET, API
-----
COMMENT:
AUTHOR: Karl Anich
EMAIL: karl.anich@tirol.gv.at
IP: 194.8.61.5
URL: 
DATE: 09/19/2013 02:01:47 AM
hello, i have a problem to run the query (see below) with VB.NET in AutoCad Map 2013 64bit (windows7). The definition of the query works fine, but i am not able to bring it into execution. When i do this step within the programm manually it works fine.
i would be pleased for an answer, thanks.


  _
    Sub TestQuery()
        Dim prjModel As ProjectModel = HostMapApplicationServices.Application.ActiveProject
        Dim mapApp As Autodesk.Gis.Map.MapApplication = Autodesk.Gis.Map.HostMapApplicationServices.Application
        Dim topoName As String = "Bestände"
        Dim flNr As Integer = 3503


        'Topologie laden
        Dim Topos As Topologies = prjModel.Topologies
        Dim TopoBest As TopologyModel = Nothing
        If Topos.Exists(topoName) = True Then
            TopoBest = Topos.Item(topoName)
            Try
                TopoBest.Open(Topology.OpenMode.ForRead)
            Catch MEx As MapException
                If MEx.ErrorCode <> 1002 Then
                    System.Windows.MessageBox.Show("Errorcode: " & MEx.ErrorCode.ToString & ControlChars.CrLf _
                                                 & "Errormessage: " & MEx.Message.ToString, "MapException")
                    Exit Sub
                End If
            End Try
        Else
            System.Windows.MessageBox.Show("Topolgie ist nicht vorhanden!", "Information")
            Exit Sub
        End If

        'Abfrage
        Dim qryModel As QueryModel = prjModel.CreateQuery(True)
        qryModel.Clear(True)
        qryModel.TopologyName = topoName
        qryModel.Mode = QueryType.QueryDraw
        Dim qryRoot As QueryBranch = QueryBranch.Create()
        Dim DatCond As DataCondition = New DataCondition()
        DatCond.Column = "ID"
        DatCond.ConditionOperator = ConditionOperator.ConditionEqual
        DatCond.DataType = DataQueryType.DataIrd
        DatCond.Flag = True
        DatCond.HasOperatorNot = False
        DatCond.JoinOperator = JoinOperator.OperatorAnd
        DatCond.Table = "TPMCNTR_" & topoName
        DatCond.Value = flNr

        qryRoot.AppendOperand(DatCond)
        qryModel.Define(qryRoot)

        'Eigenschaften
        Dim propChange As PropertyAlterationDefinition = qryModel.PropertyAlteration
        Dim propColor As PropertyAlteration = Nothing
        propColor = propChange.AddAlteration(AlterationType.AlterationColor)
        propColor.Expression = 6
        qryModel.EnablePropertyAlteration(True)

        'Ausführen
        If qryModel.Defined Then
            Try
                qryModel.Run()
            Catch Mex As MapException
                System.Windows.MessageBox.Show("Errorcode: " & Mex.ErrorCode.ToString & ControlChars.CrLf _
                                             & "Errormessage: " & Mex.Message.ToString, "MapException")
            End Try
        End If
    End Sub
-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 59.92.176.188
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 09/19/2013 09:24:57 AM
Hi Karl,

Is it specific to any DWG file ? Do you get any error ? 

Unless I debug with that DWG file, it hard to say why it's not showing any result.

Thanks,
Partha
-----
COMMENT:
AUTHOR: Karl Anich
EMAIL: karl.anich@tirol.gv.at
IP: 194.8.61.5
URL: 
DATE: 09/23/2013 12:27:27 AM
Hi Partha,
thank you for quick response!
The problem is not specific to a DWG. You can test it with any DWG using a topology. No error message is reported.  I debugged it with a test DWG and topology (named test) and defined the query as shown below. The query (property change) is defined in the drawing but I have to execute it manually.

     _
    Sub TestQuery()
        Dim prjModel As ProjectModel = HostMapApplicationServices.Application.ActiveProject
        Dim mapApp As Autodesk.Gis.Map.MapApplication = Autodesk.Gis.Map.HostMapApplicationServices.Application
        Dim topoName As String = "Test"
        Dim flNr As Integer = 9


        'Topologie laden
        Dim Topos As Topologies = prjModel.Topologies
        Dim TopoBest As TopologyModel = Nothing
        If Topos.Exists(topoName) = True Then
            TopoBest = Topos.Item(topoName)
            Try
                TopoBest.Open(Topology.OpenMode.ForRead)
            Catch MEx As MapException
                If MEx.ErrorCode <> 1002 Then
                    System.Windows.MessageBox.Show("Errorcode: " & MEx.ErrorCode.ToString & ControlChars.CrLf _
                                                 & "Errormessage: " & MEx.Message.ToString, "MapException")
                    Exit Sub
                End If
            End Try
        Else
            System.Windows.MessageBox.Show("Topolgie ist nicht vorhanden!", "Information")
            Exit Sub
        End If

        'Abfrage
        Dim qryModel As QueryModel = prjModel.CreateQuery(True)
        qryModel.Clear(True)
        qryModel.TopologyName = topoName
        qryModel.Mode = QueryType.QueryDraw
        Dim qryRoot As QueryBranch = QueryBranch.Create()
        Dim DatCond As DataCondition = New DataCondition()
        DatCond.Column = "ID"
        DatCond.ConditionOperator = ConditionOperator.ConditionEqual
        DatCond.DataType = DataQueryType.DataIrd
        DatCond.Flag = True
        DatCond.HasOperatorNot = False
        DatCond.JoinOperator = JoinOperator.OperatorAnd
        DatCond.Table = "TPMCNTR_" & topoName
        DatCond.Value = flNr

        qryRoot.AppendOperand(DatCond)
        qryModel.Define(qryRoot)

        'Eigenschaften
        Dim propChange As PropertyAlterationDefinition = qryModel.PropertyAlteration
        Dim propColor As PropertyAlteration = Nothing
        propColor = propChange.AddAlteration(AlterationType.AlterationColor)
        propColor.Expression = 6
        qryModel.EnablePropertyAlteration(True)

        'Ausführen
        If qryModel.Defined Then
            Try
                qryModel.Run()
            Catch Mex As MapException
                System.Windows.MessageBox.Show("Errorcode: " & Mex.ErrorCode.ToString & ControlChars.CrLf _
                                             & "Errormessage: " & Mex.Message.ToString, "MapException")
            End Try
        End If
    End Sub


Thanks,
Karl
-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Where is the AIMS 2013 development documentation?
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: where-is-the-aims-2013-development-documentation
CATEGORY: AIMS 2013
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/05/where-is-the-aims-2013-development-documentation.html 
DATE: 05/08/2012 10:09:07 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>Hi, are you looking for the development documents of Autodesk Infrastructure Map Server 2013?&#160; Some of them were removed from product installation media since AIMS 2012 and published online, it is search-engine-friendly to help you find what you want more quickly with search engine like Google. But some of them were just missing, now the new package of documentation is published for download now.&#160; It includes Infrastructure Studio API references, Web Extension API references, and Ajax Viewer API references. Please download them with hyper link below:</p>  <p><img alt="" src="https://images.autodesk.com/adsk/images/default.gif" width="16" height="16" /> <a href="http://images.autodesk.com/adsk/files/autodesk_infrastructure_map_server_2013_api_references.zip">Autodesk Infrastructure Map Server 2013 API References</a> <i>(zip - 23.6 Mb)</i></p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01630561a69b970d-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01630561a6a5970d-pi" width="436" height="125" /></a></p>  <p>The AIMS Developer’ Guide, Mobile Viewer References Guide and other user’s manual are published to WikiHelp. They include getting started, Infrastructure Studio User’s Guide, Application Extension(also known as Topobase Web in previous version) User’s Guide, Infrastructure Administrator Guide, and installation Guide. Please check it out at <a href="http://wikihelp.autodesk.com/infr._map_server/enu/2013">Autodesk Infrastructure Map Server Wiki Help</a>.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: How to modify / update Feature attribute using API in Map 3D?
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: how-to-modify-update-feature-attribute-using-api-in-map-3d
CATEGORY: AutoCAD Map 3D 2011
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/05/how-to-modify-update-feature-attribute-using-api-in-map-3d.html 
DATE: 05/07/2012 07:41:10 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>You would like to programmatically modify / update the Feature Object&#39;s fields i.e. it&#39;s attribute data using Geospatial Platform API in Map 3D.</p>
<p><br />In the screenshot below, we can see a Feature Object with ID = 10 and its Length property = 10.1234; using API we will update it’s value to 12.0.</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0163054dc6c7970d-pi" style="display: inline;"><img alt="IMG_1" class="asset  asset-image at-xid-6a0167607c2431970b0163054dc6c7970d" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0163054dc6c7970d-320wi" title="IMG_1" /></a><br /><br /></p>
<p><br />Here is a VB.NET code snippet which demonstrates how to programmatically modify / update the Feature Object&#39;s fields i.e. it&#39;s attribute data using Geospatial Platform API in Map 3D :</p>
<div style="font-family: Consolas; font-size: 10pt; color: black; background: white;">
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Try</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Dim</span> map <span style="color: blue;">As</span> <span style="color: #2b91af;">AcMapMap</span> = <span style="color: #2b91af;">AcMapMap</span>.GetCurrentMap()</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Dim</span> resId <span style="color: blue;">As</span> <span style="color: #2b91af;">MgResourceIdentifier</span> = <span style="color: blue;">Nothing</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Dim</span> layerName <span style="color: blue;">As</span> <span style="color: blue;">String</span> = <span style="color: #a31515;">&quot;API_Poly_Objects&quot;</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Dim</span> className <span style="color: blue;">As</span> <span style="color: blue;">String</span> = <span style="color: #a31515;">&quot;&quot;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: green;">&#39; Get the resource Id and class name of the layer on which we want to update</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Dim</span> layers <span style="color: blue;">As</span> <span style="color: #2b91af;">MgLayerCollection</span> = map.GetLayers()</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Dim</span> layer <span style="color: blue;">As</span> <span style="color: #2b91af;">MgLayerBase</span> = <span style="color: blue;">Nothing</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Dim</span> iCount <span style="color: blue;">As</span> <span style="color: blue;">Integer</span> = <span style="color: blue;">Nothing</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">For</span> iCount = 0 <span style="color: blue;">To</span> (layers.Count)</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">If</span> (layers.GetItem(iCount).Name.ToLower() = layerName.ToLower()) <span style="color: blue;">Then</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; layer = layers.GetItem(iCount)</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; resId = <span style="color: blue;">New</span> <span style="color: #2b91af;">MgResourceIdentifier</span>(layer.GetFeatureSourceId().ToString())</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Exit For</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">End</span> <span style="color: blue;">If</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Next</span> iCount</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">If</span> layer <span style="color: blue;">Is</span> <span style="color: blue;">Nothing</span> <span style="color: blue;">Then</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; ed.WriteMessage(vbCrLf + <span style="color: #a31515;">&quot;Layer Not Found ! &quot;</span>)</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Exit Sub</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">End</span> <span style="color: blue;">If</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: green;">&#39; Create a new Property colleaction Object</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Dim</span> propColl <span style="color: blue;">As</span> <span style="color: #2b91af;">MgPropertyCollection</span> = <span style="color: blue;">New</span> <span style="color: #2b91af;">MgPropertyCollection</span>()</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: green;">&#39; Create STNAME prop to Update it</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Dim</span> lengthProp <span style="color: blue;">As</span> <span style="color: #2b91af;">MgDoubleProperty</span> = <span style="color: blue;">New</span> <span style="color: #2b91af;">MgDoubleProperty</span>(<span style="color: #a31515;">&quot;Length&quot;</span>, 12.0)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: green;">&#39;Add the length property to property collection</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; propColl.Add(lengthProp)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: green;">&#39; Define a filter to get the object whose property we want to update</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: green;">&#39;&#39; Feature ID = 10 is specific to a sample SDF </span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Dim</span> filterText <span style="color: blue;">As</span> <span style="color: blue;">String</span> = <span style="color: #a31515;">&quot;ID=10&quot;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: green;">&#39;Create the UpdateFeatures object for the update</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Dim</span> updateFeatures <span style="color: blue;">As</span> <span style="color: #2b91af;">MgUpdateFeatures</span> = <span style="color: blue;">New</span> <span style="color: #2b91af;">MgUpdateFeatures</span>(layer.FeatureClassName, propColl, filterText)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: green;">&#39; Create a command collection for the update</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Dim</span> commands <span style="color: blue;">As</span> <span style="color: #2b91af;">MgFeatureCommandCollection</span> = <span style="color: blue;">New</span> <span style="color: #2b91af;">MgFeatureCommandCollection</span>()</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; commands.Add(updateFeatures)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: green;">&#39; Commit the Update</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; fs.UpdateFeatures(resId, commands, <span style="color: blue;">True</span>)</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; layer.ForceRefresh()</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; trans.Commit()</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Catch</span> ex <span style="color: blue;">As</span> <span style="color: #2b91af;">MgException</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; ed.WriteMessage(ex.Message.ToString())</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Finally</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; trans.Dispose()</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; <span style="color: blue;">End</span> <span style="color: blue;">Try</span></p>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:
FDO, .NET API
-----
COMMENT:
AUTHOR: Frank
EMAIL: fbowne@cemscience.com
IP: 167.102.135.136
URL: 
DATE: 03/25/2015 11:40:42 AM
This updates the attribute data for me but in AutoCAD Map 3D 2015 when the update happens I also get the Warning: "Property value has not been set on feature." Why and how to eliminate the Warning?
-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: How to create FDO Feature using Geospatial Platform API in Map 3D?
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: how-to-create-fdo-feature-using-geospatial-platform-api-in-map-3d
CATEGORY: AutoCAD Map 3D 2011
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/05/how-to-create-fdo-feature-using-geospatial-platform-api-in-map-3d.html 
DATE: 05/07/2012 04:25:29 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>If you want to know, how to create FDO Feature Object in AutoCAD Map 3D using Geospatial Platform API, here is a VB.NET code snippet which demonstrates creation of FDO Feature in Map 3D (in&#0160;this sample it shows creation of Point Feature like the UI command MAPPointCreate) :</p>
<div style="font-family: Consolas; font-size: 10pt; color: black; background: white;">
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Dim</span> ed <span style="color: blue;">As</span> <span style="color: #2b91af;">Editor</span> = Autodesk.AutoCAD.ApplicationServices.<span style="color: #2b91af;">Application</span>.DocumentManager.MdiActiveDocument.Editor</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; <span style="color: green;">&#39;start the transaction</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Dim</span> trans <span style="color: blue;">As</span> <span style="color: #2b91af;">Transaction</span> = Autodesk.AutoCAD.ApplicationServices.<span style="color: #2b91af;">Application</span>.DocumentManager.MdiActiveDocument.Database.TransactionManager.StartTransaction</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Try</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: green;">&#39;&#39; layerName used in the folloiwn gline is specific to a FDO </span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: green;">&#39;&#39; Data source which has the same layer. </span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Dim</span> layerName <span style="color: blue;">As</span> <span style="color: blue;">String</span> = <span style="color: #a31515;">&quot;park_points&quot;</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Dim</span> map <span style="color: blue;">As</span> <span style="color: #2b91af;">AcMapMap</span> = <span style="color: #2b91af;">AcMapMap</span>.GetCurrentMap()</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Dim</span> layers <span style="color: blue;">As</span> <span style="color: #2b91af;">MgLayerCollection</span> = map.GetLayers()</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Dim</span> layer <span style="color: blue;">As</span> <span style="color: #2b91af;">AcMapLayer</span> = <span style="color: blue;">Nothing</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Dim</span> iCount <span style="color: blue;">As</span> <span style="color: blue;">Integer</span> = <span style="color: blue;">Nothing</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">For</span> iCount = 0 <span style="color: blue;">To</span> (layers.Count)</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">If</span> (layers.GetItem(iCount).Name.ToLower() = layerName.ToLower()) <span style="color: blue;">Then</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; layer = layers.GetItem(iCount)</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Exit For</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">End</span> <span style="color: blue;">If</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Next</span> iCount</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">If</span> layer <span style="color: blue;">Is</span> <span style="color: blue;">Nothing</span> <span style="color: blue;">Then</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; ed.WriteMessage(vbCrLf + <span style="color: #a31515;">&quot;Layer Not Found ! &quot;</span>)</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Exit Sub</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">End</span> <span style="color: blue;">If</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Dim</span> pt <span style="color: blue;">As</span> Autodesk.AutoCAD.Geometry.<span style="color: #2b91af;">Point3d</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Dim</span> promptPtOp <span style="color: blue;">As</span> <span style="color: #2b91af;">PromptPointOptions</span> = <span style="color: blue;">New</span> <span style="color: #2b91af;">PromptPointOptions</span>(vbCrLf + <span style="color: #a31515;">&quot;Select the Location to create a FDO Point : &quot;</span>)</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; promptPtOp.AllowNone = <span style="color: blue;">False</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Dim</span> promptPtRes <span style="color: blue;">As</span> <span style="color: #2b91af;">PromptPointResult</span> = ed.GetPoint(promptPtOp)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">If</span> promptPtRes.Status &lt;&gt; <span style="color: #2b91af;">PromptStatus</span>.OK <span style="color: blue;">Then</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; ed.WriteMessage(<span style="color: #a31515;">&quot;Exiting! Try Again !&quot;</span>)</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Exit Sub</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">End</span> <span style="color: blue;">If</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; pt = promptPtRes.Value</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Dim</span> geoFact <span style="color: blue;">As</span> <span style="color: #2b91af;">MgGeometryFactory</span> = <span style="color: blue;">New</span> <span style="color: #2b91af;">MgGeometryFactory</span>()</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Dim</span> coord <span style="color: blue;">As</span> <span style="color: #2b91af;">MgCoordinate</span> = geoFact.CreateCoordinateXY(<span style="color: #2b91af;">Convert</span>.ToDouble(pt.X), <span style="color: #2b91af;">Convert</span>.ToDouble(pt.Y))</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Dim</span> point <span style="color: blue;">As</span> <span style="color: #2b91af;">MgPoint</span> = geoFact.CreatePoint(coord)</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Dim</span> agf <span style="color: blue;">As</span> <span style="color: #2b91af;">MgAgfReaderWriter</span> = <span style="color: blue;">New</span> <span style="color: #2b91af;">MgAgfReaderWriter</span>()</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Dim</span> reader <span style="color: blue;">As</span> <span style="color: #2b91af;">MgByteReader</span> = agf.Write(point)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Dim</span> propCol <span style="color: blue;">As</span> <span style="color: blue;">New</span> <span style="color: #2b91af;">MgPropertyCollection</span>()</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; propCol.Add(<span style="color: blue;">New</span> <span style="color: #2b91af;">MgGeometryProperty</span>(layer.GetFeatureGeometryName(), reader))</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; propCol.Add(<span style="color: blue;">New</span> <span style="color: #2b91af;">MgStringProperty</span>(<span style="color: #a31515;">&quot;STNAME&quot;</span>, <span style="color: #a31515;">&quot;Autodesk&quot;</span>))</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Dim</span> commands <span style="color: blue;">As</span> <span style="color: blue;">New</span> <span style="color: #2b91af;">MgFeatureCommandCollection</span>()</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; commands.Add(<span style="color: blue;">New</span> <span style="color: #2b91af;">MgInsertFeatures</span>(layer.GetFeatureClassName(), propCol))</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; layer.UpdateFeatures(commands)</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; <span style="color: green;">&#39;&#39; Call to SaveFeatureChanges to update the FDO Data Source</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; layer.SaveFeatureChanges(<span style="color: blue;">New</span> <span style="color: #2b91af;">MgFeatureQueryOptions</span>())</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; layer.ForceRefresh()</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; trans.Commit()</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Catch</span> ex <span style="color: blue;">As</span> <span style="color: #2b91af;">MgException</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; ed.WriteMessage(ex.Message.ToString())</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; <span style="color: blue;">Finally</span></p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; trans.Dispose()</p>
<p style="margin: 0px;">&#0160; &#0160; &#0160; &#0160; <span style="color: blue;">End</span> <span style="color: blue;">Try</span></p>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:
FDO, Feature, .NET API
-----
COMMENT:
AUTHOR: athier
EMAIL: athier74@hotmail.com
IP: 145.53.237.164
URL: 
DATE: 03/27/2013 12:49:50 AM
Great work and clear code, Thanks!
I developing library for Autocad map 3d 2013,using palette
When user press button on our palette- FDO object"which in our case arcgis data oject"will be created programmatically and ask the user to pick point.
As i see your code doing the job correctly! am i right?
-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 203.202.234.243
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 03/27/2013 01:57:16 AM
Hi athier,

Thanks for the comment.
If you want to write to ArcSDE data store using FDO provider, I believe you also need to have the client installed. You can quick check your code for SHP or SDF provider to figure out if its working fine.

Thanks,
Partha
-----
COMMENT:
AUTHOR: Athier
EMAIL: athier74@hotmail.com
IP: 145.53.237.164
URL: 
DATE: 03/31/2013 11:07:09 AM
Ser Partha
i'm so glad for your answering,I have no real experience with map 3d!it's not like standard autocad!!Especially FDO Feature:). In any case, I follow AutoCAD Map 3D API Training and also your  posts.
my Issue is:I would like to insert new feature by clicking button(point, line, ..)
your code is to create not to insert.
I hope that you can help me as I have a lot of questions, I try to learn from you all I can.  

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Want to know which Object Data Tables are in the current drawing file?
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: want-to-know-which-object-data-tables-are-in-the-current-drawing-file
CATEGORY: AutoCAD Map 3D 2011
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/05/want-to-know-which-object-data-tables-are-in-the-current-drawing-file.html 
DATE: 05/07/2012 02:32:07 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>In your current DWG file, you might have many other DWG files attached. The current drawing as well as the attached drawing has many <em><strong>Object Data Tables</strong></em> defined in them and you want to find out the Object Data Table names only from the current DWG file. How do you do that?&#0160;</p>
<p>The following C# .NET code snippet demonstrates how to find out the Object Data Table names only from the current DWG file.<br /><br /></p>
<div style="font-family: Consolas; font-size: 10pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: #2b91af;">Tables</span> odTables = <span style="color: #2b91af;">HostMapApplicationServices</span>.Application.ActiveProject.ODTables;</p>
<p style="margin: 0px;"><span style="color: #2b91af;">StringCollection</span> curDbTables = <span style="color: blue;">new</span> <span style="color: #2b91af;">StringCollection</span>();</p>
<p style="margin: 0px;"><span style="color: #2b91af;">Database</span> curDb = <span style="color: #2b91af;">HostApplicationServices</span>.WorkingDatabase;</p>
<p style="margin: 0px;"><span style="color: #2b91af;">StringCollection</span> allDbTables = odTables.GetTableNames();</p>
<p style="margin: 0px;"><span style="color: #2b91af;">AttachedDrawings</span> attachedDwgs = <span style="color: #2b91af;">HostMapApplicationServices</span>.Application.ActiveProject.DrawingSet.AllAttachedDrawings;</p>
<p style="margin: 0px;"><span style="color: blue;">int</span> directDWGCount = <span style="color: #2b91af;">HostMapApplicationServices</span>.Application.ActiveProject.DrawingSet.DirectDrawingsCount;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: blue;">foreach</span> (<span style="color: #2b91af;">String</span> name <span style="color: blue;">in</span> allDbTables)</p>
<p style="margin: 0px;">{</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; Autodesk.Gis.Map.ObjectData.<span style="color: #2b91af;">Table</span> table = odTables[name];</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">bool</span> bTableExistsInCurDb = <span style="color: blue;">true</span>;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">for</span> (<span style="color: blue;">int</span> i = 0; i &lt; directDWGCount; ++i)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; <span style="color: #2b91af;">AttachedDrawing</span> attDwg = attachedDwgs[i];</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; <span style="color: #2b91af;">StringCollection</span> attachedTables = attDwg.GetTableList(Autodesk.Gis.Map.Constants.<span style="color: #2b91af;">TableType</span>.ObjectDataTable);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; <span style="color: blue;">if</span> (attachedTables.Contains(name))</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; &#0160;&#0160;&#0160; bTableExistsInCurDb = <span style="color: blue;">false</span>;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; &#0160;&#0160;&#0160; <span style="color: blue;">break</span>;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">if</span> (bTableExistsInCurDb)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; curDbTables.Add(name);</p>
<p style="margin: 0px;">}&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; &#0160;&#0160;&#0160;</p>
<p style="margin: 0px;">ed.WriteMessage(<span style="color: #a31515;">&quot;Current Drawing Object Data Tables Names :\r\n&quot;</span>);</p>
<p style="margin: 0px;"><span style="color: blue;">foreach</span> (<span style="color: #2b91af;">String</span> name <span style="color: blue;">in</span> curDbTables)</p>
<p style="margin: 0px;">{</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; ed.WriteMessage(name + <span style="color: #a31515;">&quot;\r\n&quot;</span>);</p>
<p style="margin: 0px;">}</p>
</div>
<p>&#0160;</p>
<p>Hope this helps :)</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:
Object Data Table, Map 3D. .NET API
-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Using Surface.GetBoundedVolumes() in AutoCAD Civil 3D 2013 .NET API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: using-surfacegetboundedvolumes-in-autocad-civil-3d-2013-net-api
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/05/using-surfacegetboundedvolumes-in-autocad-civil-3d-2013-net-api.html 
DATE: 05/04/2012 02:01:17 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p><strong>Surface.GetBoundedVolumes()</strong> is a new inclusion in 2013 release of AutoCAD Civil 3D .NET API, which calculates the volume of a closed area. <em><strong>GetBoundedVolumes(Point3dCollection polygon)</strong></em> takes a <em>Point3dCollection </em>containing points that define the vertices of a closed area and an optional elevation datum (If you do not provide an elevation datum, the method uses 0.0). One point to be noted here, the first and last point in the vertices collection <span style="text-decoration: underline;">must</span> be the same, i.e. the polygon must be closed. GetBoundedVolumes() method returns a <em><strong>SurfaceVolumeInfo </strong></em>object that includes values for net volume, cut volume, and fill volume.&#0160;</p>
<p>Here is a C# code snippet which demonstrates usage of this API function in AutoCAD Civil 3D 2013 :</p>
<div style="font-family: Consolas; font-size: 10pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: green;">// Get the AutoCAD Editor</span></p>
<p style="margin: 0px;"><span style="color: #2b91af;">Editor</span> ed = <span style="color: #2b91af;">Application</span>.DocumentManager.MdiActiveDocument.Editor;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: green;">//select a polygon</span></p>
<p style="margin: 0px;"><span style="color: #2b91af;">PromptEntityOptions</span> selPline = <span style="color: blue;">new</span> <span style="color: #2b91af;">PromptEntityOptions</span>(<span style="color: #a31515;">&quot;\nSelect a Closed Polyline: &quot;</span>);</p>
<p style="margin: 0px;">selPline.SetRejectMessage(<span style="color: #a31515;">&quot;\nOnly polyline is allowed&quot;</span>);</p>
<p style="margin: 0px;">selPline.AddAllowedClass(<span style="color: blue;">typeof</span>(<span style="color: #2b91af;">Polyline</span>), <span style="color: blue;">true</span>);</p>
<p style="margin: 0px;"><span style="color: #2b91af;">PromptEntityResult</span> resPline = ed.GetEntity(selPline);</p>
<p style="margin: 0px;"><span style="color: blue;">if</span> (resPline.Status != <span style="color: #2b91af;">PromptStatus</span>.OK) <span style="color: blue;">return</span>;</p>
<p style="margin: 0px;"><span style="color: #2b91af;">ObjectId</span> plineId = resPline.ObjectId;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="color: #2b91af;">Database</span> db = <span style="color: #2b91af;">Application</span>.DocumentManager.MdiActiveDocument.Database;</p>
<p style="margin: 0px;"><span style="color: blue;">using</span> (<span style="color: #2b91af;">Transaction</span> trans = db.TransactionManager.StartTransaction())</p>
<p style="margin: 0px;">{</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">CivilDocument</span> civilDoc = <span style="color: #2b91af;">CivilApplication</span>.ActiveDocument;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">TinVolumeSurface</span> tinVolSurf = <span style="color: blue;">null</span>;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">ObjectIdCollection</span> SurfaceIds = civilDoc.GetSurfaceIds();</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">foreach</span> (<span style="color: #2b91af;">ObjectId</span> surfaceId <span style="color: blue;">in</span> SurfaceIds)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; Autodesk.Civil.DatabaseServices.<span style="color: #2b91af;">Surface</span> oSurface = surfaceId.GetObject(<span style="color: #2b91af;">OpenMode</span>.ForRead) <span style="color: blue;">as</span> Autodesk.Civil.DatabaseServices.<span style="color: #2b91af;">Surface</span>;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; <span style="color: blue;">if</span> (oSurface.GetType().ToString()== <span style="color: #a31515;">&quot;Autodesk.Civil.DatabaseServices.TinVolumeSurface&quot;</span>)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; &#0160;&#0160;&#0160; tinVolSurf = (<span style="color: #2b91af;">TinVolumeSurface</span>)oSurface;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; &#0160;&#0160;&#0160; <span style="color: blue;">break</span>; <span style="color: green;">// In this example we are dealing with the 1st TinVolume Surface</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">Polyline</span> pline = trans.GetObject(plineId, <span style="color: #2b91af;">OpenMode</span>.ForRead) <span style="color: blue;">as</span> <span style="color: #2b91af;">Polyline</span>;&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; &#0160;&#0160;&#0160; &#0160;&#0160;&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">Point3dCollection</span> pointcoll = <span style="color: blue;">new</span> <span style="color: #2b91af;">Point3dCollection</span>();</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">for</span> (<span style="color: blue;">int</span> i = 0; i &lt; pline.NumberOfVertices; i++)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; pointcoll.Add(pline.GetPoint3dAt(i));</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; }&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; &#0160;&#0160;&#0160; &#0160;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: green;">// the start point and the end point must be the same. </span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; pointcoll.Add(pline.StartPoint);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">SurfaceVolumeInfo</span> svinfo = tinVolSurf.GetBoundedVolumes(pointcoll);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; ed.WriteMessage(<span style="color: #a31515;">&quot;\n*********Bounded Volume Result from API Function call **************&quot;</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; ed.WriteMessage(<span style="color: #2b91af;">String</span>.Format(<span style="color: #a31515;">&quot;\nCut volume: {0}\n Fill volume: {1}\n Net&#0160; volume: {2}\n&quot;</span>, svinfo.Cut, svinfo.Fill, svinfo.Net));</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; trans.Commit();</p>
<p style="margin: 0px;">}</p>
</div>
<p><br /><br />And here is a screenshot of Bounded Volume calculation performed using API as well as using the Civil 3D Volumes utility tools:</p>
<p>&#0160;</p>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01676618cc03970b-pi" style="display: inline;"><img alt="C3D2013_Bounded_Vol" border="0" class="asset  asset-image at-xid-6a0167607c2431970b01676618cc03970b image-full" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01676618cc03970b-800wi" title="C3D2013_Bounded_Vol" /></a><br /><br /></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:
Civil 3D, .NET API, GetBoundedVolumes, Surface
-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: DBEnvironmentProperties in 'serverconfig.ini' of AIMS 2013
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: dbenvironmentproperties-in-serverconfigini-of-aims-2013
CATEGORY: AIMS 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/05/dbenvironmentproperties-in-serverconfigini-of-aims-2013.html 
DATE: 05/03/2012 02:17:30 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>If you have installed AIMS 2013, it&#39;s worth taking a look into the &#39;Server Configuration File&#39; (<strong>serverconfig.ini</strong>) and you will see a new section &quot;<strong>DBEnvironmentProperties</strong>&quot; added to 2013 release. Let me copy the relevant section as-it-is from the 2013 release of ‘serverconfig.ini’ -</p>
<p>[DBEnvironmentProperties]</p>
<p># ****************************************************************</p>
<p># DB ENVIRONMENT</p>
<p># This section is to set DB Environment.</p>
<p># Determine the best sizes to improve the Server performance.</p>
<p># Property Name&#0160;&#0160;&#0160;&#0160; &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;Description</p>
<p># -----------------------------------------------------------------------------</p>
<p># LibraryCacheSize&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; The size for library cache size in MB</p>
<p># SessionCacheSize&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; The size for session cache size in MB</p>
<p># DBPageSize&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; The size for library DB page in KB</p>
<p># DBXMLPageSize&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; The size for library DBXML page in KB</p>
<p># LibraryLogBufferSize&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; The size for library log buffer in MB</p>
<p># SessionLogBufferSize&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; The size for session log buffer in MB</p>
<p># DBMaxTransactions&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; The max number of DB transactions</p>
<p># SessionDBPageSize&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; The size for session DB page in KB</p>
<p># SessionDBXMLPageSize&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; The size for session DBXML page in KB</p>
<p># DBTimeout&#0160;&#0160; &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;The time out for lock and transaction in second</p>
<p># DBMaxLockers&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; The max number of DB lockers</p>
<p># ***************************************************************</p>
<p>LibraryCacheSize&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#0160;&#0160;&#0160;&#0160;= 32</p>
<p>SessionCacheSize&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#0160;&#0160;&#0160;= 2</p>
<p>DBPageSize&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;= 32</p>
<p>DBXMLPageSize&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &#0160; &#0160;= 32</p>
<p>LibraryLogBufferSize &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; = 12</p>
<p>SessionLogBufferSize&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; = 1</p>
<p>DBMaxTransactions&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; = 1000</p>
<p>SessionDBPageSize&#0160; &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;= 2</p>
<p>SessionDBXMLPageSize &#0160; &#0160; &#0160; &#0160; &#0160; = 0.5</p>
<p>DBTimeout&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;= 0.2</p>
<p>DBMaxLockers&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;= 1000&#0160;</p>
<p>#***************************************************************</p>
<p>If you have encountered an error message / exception like this - &#39;<em>DB_LOG_BUFFER_FULL :In-memory log buffer is full</em>&#39; while uploading large package (mgp files) in 2012 or earlier release of MapGuide Enterprise, you could try changing the values of DBMaxLockers and DBMaxTransactions. Increasing the default values of these variables might help to resolve that exception in your setup.<br /><br />These new set of variables are from Berkley DB settings. In &#39;serverconfig.ini&#39; (AIMS 2013) you will see a default value is assigned to them. These default values do not suggest any minimum / maximum range as every situation / configuration will be unique to your requirement and environment. You should try changing them and setting values what is appropriate in your setup / environment for your application. I would suggest you to keep a copy of &#39;serverconfig.ini&#39; before you start changing the values in it. &#0160;And, rememeber to restart the service to make the changes effective.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:
DBEnvironmentProperties, serverconfig.ini
-----
COMMENT:
AUTHOR: Ludovic Gnemmi
EMAIL: 
IP: 78.119.208.39
URL: http://profile.typepad.com/ludovicgnemmi
DATE: 08/09/2012 01:30:35 PM
I'm working with MG2011 and i don't see any DBMaxLockers and DBMaxTransactions variable in my serverconfig file.
How can we solve this issue. I'm encountering this log message since i have a big number of layers in my map (300). Thanks for your help
-----
COMMENT:
AUTHOR: Partha
EMAIL: partha.sarkar@autodesk.com
IP: 115.112.233.72
URL: 
DATE: 08/23/2012 02:35:39 AM
Hi Ludovic,

DBMaxLockers and DBMaxTransactions are new in AIMS 2013. You could try using AIMS 2013 and set the appropriate values for these and see if it helps in your dataset / project.

Thanks,
Partha
-----
COMMENT:
AUTHOR: Mobin
EMAIL: mobin.rehman@gmail.com
IP: 182.178.39.239
URL: 
DATE: 11/19/2012 08:43:35 AM
Hi Partha 
I have tried, but error is same, can you please specifically tell me which parameter i need to configure, my problem is that i have 20000 points coming from db.  when i try to select the all points at once, it gives me  DB_LOG_MEMORY_BUFFER FULL.

PLEASE ADVICE WHICH parameter i need to reconfigure
thanks

-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 59.92.137.109
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 11/26/2012 04:52:56 AM
Hi Mobin,


Please see the list of the variable and what they are related to from the above blog post. You might have to play around with them to see what gives you best result. It's difficult for me to pin-point the variable / value which will fix the issue in your set-up, sorry.

Thanks,
Partha
ADN
-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: AutoCAD .net Wizard supports Map 3D, Civil 3D, AutoCAD Architecture and AutoCAD MEP now
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: autocad-net-wizard-support-map-3d-civil-3d-autocad-architecture-and-autocad-mep-now
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/05/autocad-net-wizard-support-map-3d-civil-3d-autocad-architecture-and-autocad-mep-now.html 
DATE: 05/02/2012 03:31:27 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>
<p>You must be familiar with the <a href="http://images.autodesk.com/adsk/files/autocad_2013_dotnet_wizards.zip" target="_blank">AutoCAD .NET Wizard</a>, which helps you to create a AutoCAD .net Plug-in easily, and also enables debugging from Visual Studio Express.</p>
<p>AutoCAD.Net Wizard now has been upgraded to support AutoCAD 2013 and Visual Studio 2010, it is also extended to other AutoCAD vertical products, including Map 3D 2013, Civil 3D 2013, AutoCAD Architecture 2013 and AutoCAD MEP 2013.</p>
<p>You can find the “AutoCAD 2013 CSharp plug-in” wizard when creating new project</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b016765ff7bfe970b-pi"><img alt="image" border="0" height="298" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0163050c2380970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="457" /></a></p>
<p>The VB.net wizard also is available.</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0163050c239f970d-pi"><img alt="image" border="0" height="319" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0168eb01e258970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="468" /></a></p>
<p>The AutoCAD tab is always available. For Map 3D 2013,&#0160; “Map 3D” tab is available, you can select the Map 3D related references.</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0168eb01e26b970c-pi"><img alt="image" border="0" height="409" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b016765ff7c47970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="379" /></a></p>
<p>There is a trick here.This wizard is supposed to use for Map 3D 2013, but it works for Map 3D 2012 as well.&#0160; if you are using Map 3D 2012, please check “Autodesk.Platform.Core(for 2012)”, and delete the reference of acCoreMgd from references of Visual Studio.</p>
<p>For Civil 3D, Civil 3D related references can be checked from “Civil 3D” tab.</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0163050c23e0970d-pi"><img alt="image" border="0" height="415" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0163050c23f2970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="384" /></a></p>
<p>&#0160;</p>
<p>It also works for Architecture 2013 and AutoCAD MEP 2013, please add references from “ACA” and “AME” tab, so download a copy and give it a try.</p>
<p>It can be downloaded from AutoCAD Developer Center:</p>
<p><a href="http://images.autodesk.com/adsk/files/autocad_2013_dotnet_wizards.zip" title="http://images.autodesk.com/adsk/files/autocad_2013_dotnet_wizards.zip">http://images.autodesk.com/adsk/files/autocad_2013_dotnet_wizards.zip</a></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Autodesk University (AU) 2012 – Call for proposals now open
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: autodesk-university-au-2012-call-for-proposals-now-open
CATEGORY: Events
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/05/autodesk-university-au-2012-call-for-proposals-now-open.html 
DATE: 05/01/2012 02:06:57 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>Incase you missed to notice this earlier...<br /><br /></p>
<p>The <strong>AU 2012</strong> Call for Proposals is now open. Click on the link below to go to the AU website to find out more.</p>
<p><a href="http://au.autodesk.com/?nd=slv2012_call_for_proposals" target="_blank"><img alt="" height="100" src="http://au.autodesk.com/ama/orig/au2012/e/images/slv2012_call_for_proposals.jpg" style="display: block; margin-bottom: 12px; margin-left: auto; margin-right: auto;" width="483" /></a></p>
<p>&#0160;</p>
<p>Autodesk University (AU) is coming up in December, 2012. &#0160;If you’ve ever attended AU, you know that this annual event is Autodesk’s largest user conference, with hundreds of classes and labs taught by top-notch instructors and industry professionals.&#0160;</p>
<p><br />Like previous years, DevTech team members will be there in this year too! This year at AU, we are planning to present few classes on <strong><em>cloud and mobile development</em></strong>. Cloud and Mobile? Yes, you heard it right. Eager to see some start-up resources on Cloud and Mobile? Check this out <a href="http://adndevblog.typepad.com/autocad/2012/04/list-of-some-important-autodesk-cloud-and-mobile-resources.html" target="_self">List of some important Autodesk cloud and mobile resources</a><br /><br />If you have some expertise (programming or otherwise) that you&#39;d like to share, then why not submit a proposal? We&#39;re always looking for new and exciting classes.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:
AU 2012, API
-----
COMMENT:
AUTHOR: Military Colleges
EMAIL: abs@gmail.com
IP: 64.203.50.62
URL: http://www.trident.edu
DATE: 05/14/2012 04:01:16 PM
Sounds like a great opportunity for an experienced programmer to share his or her knowledge at the conference. 
-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Export DWG to SDF using Autodesk.Gis.Map.ImportExport.Exporter API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: export-dwg-to-sdf-using-autodeskgismapimportexportexporter-api
CATEGORY: AutoCAD Map 3D 2011
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/04/export-dwg-to-sdf-using-autodeskgismapimportexportexporter-api.html 
DATE: 04/30/2012 01:29:31 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>In <a href="http://adndevblog.typepad.com/infrastructure/2012/03/exporting-dwg-to-sdf-using-epf-file-using-map-3d-api.html" target="_self">Exporting DWG to SDF using *.epf file using Map 3D API</a> I showed how to use *.epf file and Map 3D API to export DWG file to SDF file. In this example, I tried to explore how we can export DWG data to <a href="http://en.wikipedia.org/wiki/Spatial_data_file" target="_self">SDF</a> (Spatial Data File) using AutoCAD Map 3D API without using a *.epf file. &#0160;This sample code uses Map 3D <strong>Autodesk.Gis.Map.ImportExport.Exporter</strong> class and exports the entities from a specific layer in the DWG file to <em><strong>GeometryType.Line</strong></em>. To find out what all GeometryType you can export, you need to explore the <strong>Autodesk:: Gis:: Map:: ImportExport:: GeometryType</strong> <em>Enumeration</em>. Details of these are available in the Map 3D SDK <a href="http://adndevblog.typepad.com/infrastructure/2012/04/renaming-the-industry-data-model-aka-topobase-api-assemblies-and-namespace-in-autocad-map-3d-2013.html" target="_self">API reference documents</a>.&#0160;Here is the code snippet :</p>
<div style="font-family: Consolas; font-size: 10pt; color: black; background: white;">
<div style="font-family: Consolas; font-size: 10pt; color: black; background: white;">
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: #2b91af;">Editor</span> ed = <span style="color: #2b91af;">Application</span>.DocumentManager.MdiActiveDocument.Editor;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">try</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; <span style="color: #2b91af;">Exporter</span> myExporter = <span style="color: blue;">null</span>;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; <span style="color: #2b91af;">MapApplication</span> mapApp = <span style="color: #2b91af;">HostMapApplicationServices</span>.Application;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; myExporter = mapApp.Exporter;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; myExporter.Init(<span style="color: #a31515;">&quot;FDO_SDF&quot;</span>, <span style="color: #a31515;">@&quot;C:\Temp\Test.sdf&quot;</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; myExporter.ClassMappingType = <span style="color: #2b91af;">ExportClassMappingType</span>.ByLayer;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; myExporter.ClosedPolylinesAsPolygons = <span style="color: blue;">true</span>;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; <span style="color: blue;">string</span> sSourceName = <span style="color: #a31515;">&quot;Line&quot;</span>; <span style="color: green;">// Source DWG file should have a Layer Named &quot;Line&quot;</span></p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; <span style="color: blue;">string</span> sSchemaName = <span style="color: #a31515;">&quot;ADNSchema&quot;</span>;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; <span style="color: blue;">string</span> sFeatureClassName = <span style="color: #a31515;">&quot;LineFC&quot;</span>;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; <span style="color: #2b91af;">ExportClassMapping</span> mapping = <span style="color: #2b91af;">ExportClassMapping</span>.Create(sSourceName, sSchemaName, sFeatureClassName);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; mapping.AddPropertyMapping(<span style="color: #a31515;">&quot;.COLOR&quot;</span>, <span style="color: #a31515;">&quot;Color&quot;</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; mapping.AddPropertyMapping(<span style="color: #a31515;">&quot;.LAYER&quot;</span>, <span style="color: #a31515;">&quot;Layer&quot;</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; mapping.AddPropertyMapping(<span style="color: #a31515;">&quot;.LENGTH&quot;</span>, <span style="color: #a31515;">&quot;Length&quot;</span>);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; myExporter.AddClassMapping(mapping);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; myExporter.SetGeometryTypeForClass(sSchemaName, sFeatureClassName, <span style="color: #2b91af;">GeometryType</span>.Line);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; myExporter.TargetCoordinateSystem = <span style="color: #a31515;">&quot;LL84&quot;</span>;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; myExporter.ExportAll = <span style="color: blue;">true</span>;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; myExporter.Export(<span style="color: blue;">true</span>);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; ed.WriteMessage(<span style="color: #a31515;">&quot;\nExport Completed !&quot;</span>);</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; }</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; <span style="color: blue;">catch</span> (Autodesk.Gis.Map.<span style="color: #2b91af;">MapImportExportException</span> e)</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; {</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; ed.WriteMessage(<span style="color: #a31515;">&quot;Exception thrown. Error Code = &quot;</span> + e.ErrorCode);</p>
<p style="margin: 0px;">&#0160;&#0160;&#0160; }</p>
</div>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">And here is the resulted output SDF file in Map 3D :</p>
</div>
<p><a class="asset-img-link" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0168eaec88bf970c-pi" style="display: inline;"><img alt="DWG_2_SDF" border="0" class="asset  asset-image at-xid-6a0167607c2431970b0168eaec88bf970c image-full" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0168eaec88bf970c-800wi" title="DWG_2_SDF" /></a><br /><br /></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:
Export, .NET API, Map 3D
-----
COMMENT:
AUTHOR: Andres
EMAIL: torregrosa.a@seys.es
IP: 88.2.49.183
URL: 
DATE: 04/11/2013 08:47:47 AM
Hi, 
you know if is possible to do something similar but from Autodesk Infraestructure Map Server? Maybe with AIMS Studio API???

Thanks
-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 203.202.234.243
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 04/15/2013 04:55:32 AM
Hi Andres,

AIMS is designed to serve Map online. If you are looking for a way to upload DWG file to AIMS server you can use Infrastructure Studio API. Infrastructure Studio has DwgLoadProcedure which we can use to load DWG files to AIMS server.

Does this info help ?

Thanks,
Partha
A D N
-----
COMMENT:
AUTHOR: mehrsa rad
EMAIL: mehrsa000@gmail.com
IP: 173.45.98.142
URL: 
DATE: 04/22/2013 06:10:28 AM
hi Partha, i've used your code to load ipf into shape files while importing
but there's a problem, i have multiple shape files, and select theme in the "import location" dialogue
   importer.Init("SHP", "d:\\files\\CAD\\GIS_EXPORT_1391128_135103\\ISELFCT.shp");
                
                importer.LoadImportFormat("d:\\files\\CAD\\Imp_Attribute_910809.ipf");

the ipf file loads just in one of my shape file that is given in init
what should i do to load ipf in all shapes which i select to import?
thank u in advance
-----
COMMENT:
AUTHOR: Sherwin
EMAIL: sherwin.luna@gmail.com
IP: 202.81.30.29
URL: 
DATE: 10/23/2013 08:53:52 AM
Hi Partha,

I tried this code to get the layers from the current drawing how about the xref layers, how will i be able to get the layers from the current and xref then create a single sdf file?

Thanks,
Sherwin
-----
COMMENT:
AUTHOR: Sherwin
EMAIL: sherwin.luna@gmail.com
IP: 202.81.30.29
URL: 
DATE: 10/23/2013 08:57:34 AM
Hi Partha,

I use your code to export current layers of the drawing to sdf but how do i get the xref layers also?

Thanks an Regards,
Sherwin
-----
COMMENT:
AUTHOR: Sherwin
EMAIL: sherwin.luna@gmail.com
IP: 144.230.63.53
URL: 
DATE: 10/28/2013 07:50:31 AM
Hi Partha

Do you have example of export to sdf using Exporter.LayerFilter?
-----
COMMENT:
AUTHOR: Sherwin
EMAIL: sherwin.luna@gmail.com
IP: 144.230.63.53
URL: 
DATE: 01/08/2014 07:08:08 AM
Is there an API for exporting the SDF to version 2 instead of version 3?
-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 203.202.234.243
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 01/08/2014 10:04:20 PM
Hi Sherwin,

AFAIK there is no API to export to old SDF i.e. 'SDF2' for old MapGuide 6.5 or earlier.
You need to use either MAP2SDF UI tool / command in AutoCAD Map 3D or you can use SDF Loader. 

SDF Loader is included in SDF ToolKit, and it can be downloaded from http://usa.autodesk.com/adsk/servlet/ps/dl/item?siteID=123112&id=4307350&linkID=9240658

Thanks,
Partha
-----
COMMENT:
AUTHOR: Mark
EMAIL: markmarkarian@comcast.net
IP: 71.59.18.59
URL: 
DATE: 01/18/2014 08:28:53 AM
Hi Partha,
is it possible to do the code above in vlisp/activx
(the code to create an sdf file from map 3d or using
only autocad 14) and if possible, can you provide a sample.
thanks
m

-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 59.92.218.21
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 01/19/2014 10:51:14 PM
Hi Mark,

No, these APIs are not exposed in LISP / ActiveX.

Thanks,
Partha
-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: AEC DevCamp 2012
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: aec-devcamp-2012
CATEGORY: AIMS 2013
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/04/aec-devcamp-2012.html 
DATE: 04/27/2012 02:49:23 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>Just in case you missed to notice this....</p>
<p><a name="devcamp"><strong><span style="color: #000000;">Autodesk June DevCamps   “Early Bird Discount” Ends April 30 – Register to Attend Now!</span></strong></a></p>
<p>If you would like to learn more about customizing Autodesk’s AEC or Manufacturing   products and technologies direct from Autodesk engineers in a casual fun learning   environment, and take advantage of the early bird discount to save US$ 100, we strongly   recommend you register to attend DevCamp by the <strong>April 30</strong> early bird   registration deadline.&#0160; Note, these DevCamps are run only once every two years so   if you are interested in attending now is the time.</p>
<p><strong>Learn to customize Autodesk AEC products in Boston, June 6-7,   2012</strong><strong>&#0160;</strong></p>
<p>The upcoming Autodesk AEC DevCamp is the software developer conference for anyone in   the AEC industry considering or actively customizing Autodesk AEC technologies,   including Autodesk® Revit® (Architecture, Structure and MEP), AutoCAD® Architecture,   AutoCAD® Civil 3D®, AutoCAD® Map 3D, Navisworks® and more.&#0160; Open to everyone -   Autodesk customers, VARs, and members of the Autodesk Developer Network (ADN) - the <a name="_GoBack"></a>AEC DevCamp features more than 30 software development training   classes taught by Autodesk engineers in a casual “fun “Camp” environment.&#0160; There   are introductory programming classes for people just starting to customize and advanced   topics on how to architect and implement state-of-the-art software solutions for   professional software developers. In addition, there is a business track for software   business owners who want to learn how to expand their business by leveraging Autodesk’s   sales and marketing resources.&#0160; The cost to attend this two day AEC DevCamp is   $500 per attendee till April end ($600 later). Learn more at <a href="http://www.cvent.com/events/devcamp-2012/event-summary-  56817a3b57614f8eb59ea05fcd59bc32.aspx">http://www.cvent.com/events/devcamp-2012/event-  summary-56817a3b57614f8eb59ea05fcd59bc32.aspx</a></p>
<p><span style="text-decoration: underline;"><strong>Cloud and Mobile Classes</strong></span></p>
<p>New for this year’s DevCamps are several classes on helping you get started   developing apps based on Cloud and Mobile technologies.&#0160; Learn how to build your   first Cloud app integrated with your favorite Autodesk product – and how you can make   it available “everywhere” through browser and mobile user interfaces.&#0160; Have you   been considering building your first app for the iPhone, iPad or Android device but   holding back because of fear of lost hours thrashing while learning the new   technology?&#0160; DevCamp includes classes that will show you how to quickly and easily   create your first “Hello World” app for iOS and Android - with a design and graphics   twist.<strong>&#0160;</strong></p>
<p><span style="text-decoration: underline;"><a name="devlabs"><strong><span style="color: #000000;">DevLabs</span></strong></a></span></p>
<p>Don’t forget about the DevLabs we’re running to coincide with the DevCamps!</p>
<p>DevLabs provide an ideal opportunity to work on your code with the help of an   Autodesk expert. Bring your laptop and work on your code as you’d normally do in your   own office – the difference is that you have a team of DevTech experts (the same people   who answer your questions through DevHelp Online) available to review your code if   you’d like, answer your questions, and make suggestions.</p>
<p><strong>AEC – Waltham, MA</strong></p>
<p>DevCamp – June 6-7</p>
<p>DevLab – June 8 – click <a href="http://usa.autodesk.com/adsk/servlet/item?  id=6703509&amp;siteID=123112&amp;cname=DevLab%20AEC,%20Waltham,%20Jun%2008%202012,  %20201253"><strong>here</strong></a> to register</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:
Events, ADN, Autodesk, API, DevLabs
-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Restore view panel position to top when opening in Mobile Viewer
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: restore-view-panel-position-to-top-when-opening-in-mobile-viewer
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/04/restore-view-panel-position-to-top-when-opening-in-mobile-viewer.html 
DATE: 04/27/2012 01:26:20 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>
<p>In Mobile Viewer, if you open a view panel, let’s say the properties panel, scroll down to bottom then close it. Next time you open the same view panel you will found it still show the bottom part of the panel, it does not go back to the page top. It may be not the expected behavior for some users, they prefer to go the page top every time when opening the view panel. How do we do?</p>
<p>This topic is raised by Nivashini from V3 Teletech Pte Ltd and he finds out a solution too. He is very kind to share his solution to help others who are trying to do the same thing.</p>
<p>The solution is simple, open C:\Program Files\Autodesk\Autodesk Infrastructure Web Server Extension 2012\www\MobileViewer\lib\mobileviewer_viewpanel.js, around line 110, change it as below:</p>
<div style="font-family: courier new; color: black; font-size: 8pt;">
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; showPanel: </span><span style="line-height: 140%; color: blue;">function</span><span style="line-height: 140%;">()</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">if</span><span style="line-height: 140%;">(</span><span style="line-height: 140%; color: blue;">this</span><span style="line-height: 140%;">.parentDiv)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">this</span><span style="line-height: 140%;">.parentDiv.style.visibility = </span><span style="line-height: 140%; color: #a31515;">&#39;visible&#39;</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="background-color: #ffff00;"><span style="line-height: 140%; color: blue;">this</span><span style="line-height: 140%;">.scrollPanelDiv.style.top = 0;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; },</span></p>
</div>
<p>You need to change to script reference to “lib/mobileviewer.js&quot; to make it work, please check out <a href="http://adndevblog.typepad.com/infrastructure/2012/04/debugging-fusion-viewer-or-mobile-viewer-of-aims-in-firebug.html" target="_blank">this post</a> to get more information</p>
<p>Thank you Nivashini for sharing this!</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Down-loadable version of AutoCAD Civil 3D 2013 & 2012 API Reference document
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: down-loadable-version-of-autocad-civil-3d-2013-api-reference-document
CATEGORY: AutoCAD Civil 3D 2012
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/04/down-loadable-version-of-autocad-civil-3d-2013-api-reference-document.html 
DATE: 04/26/2012 02:14:45 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>Since 2012 release, Civil 3D API Developer&#39;s Guide and API reference document is available online. Here are the relevant links -</p>
<p>AutoCAD Civil 3D 2013 API Developer&#39;s Guide &amp; API Reference <strong><a href="http://wikihelp.autodesk.com/AutoCAD_Civil_3D/enu/2013" target="_self">online</a></strong><br /><br />AutoCAD Civil 3D 2012 API Developer&#39;s Guide &amp; API Reference <strong><a href="http://wikihelp.autodesk.com/AutoCAD_Civil_3D/enu/2012" target="_self">online</a></strong><br /><br />If you are looking for a down-loadable copy of the Civil 3D API Reference document, here you go -</p>
<p><strong><a href="http://download.autodesk.com/media/adn/Civil3D2013APIRefDocs.zip" target="_self">Download</a></strong> AutoCAD <strong>Civil 3D 2013 API Reference</strong>&#0160;Document</p>
<p><strong><a href="http://images.autodesk.com/adsk/files/ipanema_api_reference_guide_2.zip" target="_self">Download </a></strong>AutoCAD <strong>Civil 3D 2012 API Reference</strong> Document</p>
<p>Please note that, down-loadable versions are one-time only post and they won&#39;t be updated on regular basis. Hence we suggest to refer the Online API Reference document for up-to date version.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Want to use only StartPoint and EndPoint as input to .NET API SampleElevations()?
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: want-to-use-only-startpoint-and-endpoint-as-input-to-net-api-sampleelevations
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/04/want-to-use-only-startpoint-and-endpoint-as-input-to-net-api-sampleelevations.html 
DATE: 04/25/2012 01:18:51 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>This is in continuation of my <a href="http://adndevblog.typepad.com/infrastructure/2012/04/using-sampleelevations-in-autocad-civil-3d-2013-net-api.html" target="_self">previous</a> post on using <strong>SampleElevations()</strong> in AutoCAD Civil 3D 2013 .NET API. I was exploring if we have to mimic Civil 3D COM API AeccSurface::SampleElevations(X1,Y1, X2,Y2) which takes a StartPoint and EndPoint and returns an array of doubles consisting of points derived from the surface along the line, how do we achieve this using the new .NET API.&#0160;</p>
<p>The new .NET API (2013) <strong>TinSurface.SampleElevations(curveId)</strong> takes an ObjectId. To get an ObjectId, we need to add the new entity (Line / Pline) from a set of Points (StartPoint and EndPoint) and later dispose it. Here is a code snippet which demonstrates the same :</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="color: green; line-height: 140%;">// Get the AutoCAD Editor</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="color: #2b91af; line-height: 140%;">Editor</span><span style="line-height: 140%;"> ed = </span><span style="color: #2b91af; line-height: 140%;">Application</span><span style="line-height: 140%;">.DocumentManager.MdiActiveDocument.Editor;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="color: green; line-height: 140%;">//select a surface</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="color: #2b91af; line-height: 140%;">PromptEntityOptions</span><span style="line-height: 140%;"> selSurface = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">PromptEntityOptions</span><span style="line-height: 140%;">(</span><span style="color: #a31515; line-height: 140%;">&quot;\nSelect a Tin Surface: &quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; selSurface.SetRejectMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nOnly Tin Surface is allowed&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; selSurface.AddAllowedClass(</span><span style="color: blue; line-height: 140%;">typeof</span><span style="line-height: 140%;">(</span><span style="color: #2b91af; line-height: 140%;">TinSurface</span><span style="line-height: 140%;">), </span><span style="color: blue; line-height: 140%;">true</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="color: #2b91af; line-height: 140%;">PromptEntityResult</span><span style="line-height: 140%;"> resSurface = ed.GetEntity(selSurface);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (resSurface.Status != </span><span style="color: #2b91af; line-height: 140%;">PromptStatus</span><span style="line-height: 140%;">.OK) </span><span style="color: blue; line-height: 140%;">return</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> surfaceId = resSurface.ObjectId;&#0160; </span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="color: green; line-height: 140%;">// Select two points </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="color: #2b91af; line-height: 140%;">PromptPointOptions</span><span style="line-height: 140%;"> getPointOptions1 = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">PromptPointOptions</span><span style="line-height: 140%;">(</span><span style="color: #a31515; line-height: 140%;">&quot;\nPick A Point Inside the Surface Boundary : &quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="color: #2b91af; line-height: 140%;">PromptPointResult</span><span style="line-height: 140%;"> getPointResult1 = ed.GetPoint(getPointOptions1);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="color: #2b91af; line-height: 140%;">PromptPointOptions</span><span style="line-height: 140%;"> getPointOptions2 = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">PromptPointOptions</span><span style="line-height: 140%;">(</span><span style="color: #a31515; line-height: 140%;">&quot;\nPick 2nd Point Inside the Surface Boundary : &quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="color: #2b91af; line-height: 140%;">PromptPointResult</span><span style="line-height: 140%;"> getPointResult2 = ed.GetPoint(getPointOptions2);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="color: #2b91af; line-height: 140%;">Database</span><span style="line-height: 140%;"> db = </span><span style="color: #2b91af; line-height: 140%;">Application</span><span style="line-height: 140%;">.DocumentManager.MdiActiveDocument.Database;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">Transaction</span><span style="line-height: 140%;"> trans = db.TransactionManager.StartTransaction())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; </span><span style="color: #2b91af; line-height: 140%;">TinSurface</span><span style="line-height: 140%;"> surface = trans.GetObject(surfaceId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForRead) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">TinSurface</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; </span><span style="color: green; line-height: 140%;">// create a polyline from the two points to use in SampleElevations(ObjectId curveId)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; </span><span style="color: #2b91af; line-height: 140%;">Polyline</span><span style="line-height: 140%;"> pline = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Polyline</span><span style="line-height: 140%;">();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; </span><span style="color: #2b91af; line-height: 140%;">Point2d</span><span style="line-height: 140%;"> pt1 = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Point2d</span><span style="line-height: 140%;">(getPointResult1.Value.X, getPointResult1.Value.Y);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; </span><span style="color: #2b91af; line-height: 140%;">Point2d</span><span style="line-height: 140%;"> pt2 = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Point2d</span><span style="line-height: 140%;">(getPointResult2.Value.X, getPointResult2.Value.Y);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; pline.AddVertexAt(0, pt1, 0, 0, 0);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; pline.AddVertexAt(1, pt2, 0, 0, 0);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; </span><span style="color: green; line-height: 140%;">// open the current space for write</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; </span><span style="color: #2b91af; line-height: 140%;">BlockTableRecord</span><span style="line-height: 140%;"> btr = (</span><span style="color: #2b91af; line-height: 140%;">BlockTableRecord</span><span style="line-height: 140%;">)trans.GetObject(db.CurrentSpaceId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForWrite);&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; &#0160;&#0160;&#0160; &#0160;&#0160;&#0160; &#0160;&#0160;&#0160; &#0160;&#0160;&#0160; &#0160;&#0160;&#0160; &#0160;&#0160;&#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; btr.AppendEntity(pline);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; </span><span style="color: green; line-height: 140%;">// SampleElevations(ObjectId curveId) returns a Point3dCollection</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; </span><span style="color: #2b91af; line-height: 140%;">Point3dCollection</span><span style="line-height: 140%;"> intPts = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Point3dCollection</span><span style="line-height: 140%;">();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; intPts = surface.SampleElevations(pline.ObjectId);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; </span><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (intPts.Count != 0)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; &#0160;&#0160;&#0160; </span><span style="color: blue; line-height: 140%;">foreach</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">Point3d</span><span style="line-height: 140%;"> pt </span><span style="color: blue; line-height: 140%;">in</span><span style="line-height: 140%;"> intPts)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; &#0160;&#0160;&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; &#0160;&#0160;&#0160; &#0160;&#0160;&#0160; ed.WriteMessage(</span><span style="color: blue; line-height: 140%;">string</span><span style="line-height: 140%;">.Format(</span><span style="color: #a31515; line-height: 140%;">&quot;{0} {1}&quot;</span><span style="line-height: 140%;">, </span><span style="color: #2b91af; line-height: 140%;">Environment</span><span style="line-height: 140%;">.NewLine, pt.ToString()));</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; &#0160;&#0160;&#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; }</span><span style="background-color: white; font-size: 8pt;">&#0160;</span></p>
<p style="margin: 0px;"><span style="line-height: 15px;"><br /></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; }</span></p>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:
SampleElevations, Civil 3D, .NET API
-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Debugging Fusion Viewer or Mobile Viewer of AIMS in Firebug
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: debugging-fusion-viewer-or-mobile-viewer-of-aims-in-firebug
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/04/debugging-fusion-viewer-or-mobile-viewer-of-aims-in-firebug.html 
DATE: 04/24/2012 12:24:30 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>
<p>Have you ever started programming on Fusion viewer --as known as flexible web layout in Infrastructure Studio -- or Mobile viewer of Autodesk Infrastructure Map Server? If yes, this post may be helpful for you.</p>
<p>Fusion viewer and Mobile viewer are implemented with heavy JavaScript at client side and some PHP code at server side.&#0160; At most time, you will be fighting with JavaScript when extending the functionalities of Fusion Viewer or Mobile Viewer.&#0160; To debug JavaScript, a good toolset is Firefox + Firebug.</p>
<p>To improve performance, Fusion Viewer or Mobile Viewer are referencing a compressed version of JavaScript lib, which is created by ant + YUICompressor, but for debugging purpose, you will need the uncompressed version.</p>
<p>&#0160;</p>
<p>For Fusion Viewer, let’s say you are using the “slate” template, please open C:\Program Files\Autodesk\Autodesk Infrastructure Web Server Extension 2013\www\fusion\templates\mapguide\slate\index.html with your favorite text editor, I am using notepad++, change following code:</p>
<pre class="csharpcode"><span class="kwrd">&lt;</span><span class="html">script</span> <span class="attr">type</span><span class="kwrd">=&quot;text/javascript&quot;</span> <br /><span class="attr">src</span><span class="kwrd">=&quot;../../../lib/fusionSF-compressed.js&quot;</span><span class="kwrd">&gt;&lt;/</span><span class="html">script</span><span class="kwrd">&gt;</span></pre>
<p>to</p>
<pre class="csharpcode"><span class="kwrd">&lt;</span><span class="html">script</span> <span class="attr">type</span><span class="kwrd">=&quot;text/javascript&quot;</span> <br /><span class="attr">src</span><span class="kwrd">=&quot;../../../lib/fusion.js&quot;</span><span class="kwrd">&gt;&lt;/</span><span class="html">script</span><span class="kwrd">&gt;</span></pre>
<p>&#0160;</p>
<p>For Mobile Viewer, please open C:\Program Files\Autodesk\Autodesk Infrastructure Web Server Extension 2012\www\MobileViewer\index.html and change JavaScript and CSS file references as indicated in the comment:</p>
<pre class="csharpcode"><span class="rem">&lt;!-- For debugging, use these links--&gt;</span>
<span class="kwrd">&lt;</span><span class="html">link</span> <span class="attr">href</span><span class="kwrd">=&quot;css/mobileviewer.css&quot;</span> 
  <span class="attr">rel</span><span class="kwrd">=&quot;stylesheet&quot;</span> <span class="attr">media</span><span class="kwrd">=&quot;screen&quot;</span> <span class="attr">type</span><span class="kwrd">=&quot;text/css&quot;</span> <span class="kwrd">/&gt;</span>
<span class="kwrd">&lt;</span><span class="html">script</span> <span class="attr">type</span><span class="kwrd">=&quot;text/javascript&quot;</span> <span class="attr">src</span><span class="kwrd">=&quot;lib/mobileviewer.js&quot;</span><span class="kwrd">&gt;</span>
<span class="kwrd">&lt;/</span><span class="html">script</span><span class="kwrd">&gt;</span></pre>
<pre class="csharpcode"><span class="kwrd">&#0160;</span></pre>
<p><span class="kwrd">&#0160;</span></p>
<p>&#0160;</p>
<p>Now you are ready to open your webpage in Firefox and enable Firebug to debug. You can setup break points in JavaScript code and check the runtime value of objects in monitoring window. It also to step into or step over by pressing F11 or F10 to run through your JavaScript code. There are many other interesting functionalities provided by Firebug, so please give it a try and find more.</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0167659dda27970b-pi"><img alt="image" border="0" height="397" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b016304aa49c9970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="486" /></a></p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b016304aa50a0970d-pi"><img alt="image" border="0" height="399" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0167659de3be970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="484" /></a></p>
<p>&#0160;</p>
<p>Mobile Viewer is targeting the safari browser on iPad/iPhone/iPod touch, but it runs on Firefox on PC as well, so you can debug your extension on PC and check it on mobile devices. On the Apple<sup>®</sup>iPhone<sup>®</sup> itself, the settings for the Apple<sup>®</sup> Safari<sup>®</sup> app allow the debug console to be enabled (look under the &#39;Developer&#39; menu in the settings) which is useful in determining errors that cannot be reproduced on the desktop.</p>
<p>&#0160;</p>
<p>Of cause, the recent versions of other browsers also have developer tools, like IE9 or Google Chrome, which one do you prefer?</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Veli V.
EMAIL: veli.vaisanen@basepoint.fi
IP: 212.116.37.26
URL: 
DATE: 05/22/2012 01:05:39 AM
Hi Daniel,
do you know why we could not open examples on site <a href="http://sandbox.mapguide.com/iviewer/">http://sandbox.mapguide.com/iviewer/</a>
That circle of balls is in busy state only, but nothing happens.
Cheers
Veli V. / Basepoint Oy
-----
COMMENT:
AUTHOR: Daniel Du
EMAIL: 
IP: 123.117.24.166
URL: http://profile.typepad.com/daniel_du
DATE: 06/13/2012 03:39:51 PM
Sorry but I don't know who is maintaining this site. Many reason may cause this behavior, one of the them is that the Map Server is not running.
-----
COMMENT:
AUTHOR: Jordan Retro 7
EMAIL: seely2e2xxo@hotmail.com
IP: 72.52.116.244
URL: http://www.jordanvii.com/
DATE: 07/04/2012 08:13:56 PM
Where Gandhi stayed during his visit to London; where Save The Children was started; the East End's most infamous Victorian factory and the statue, fountain and mysterious hands that tell the story of blood on men's hands. <a href="http://www.jordanvii.com/">http://www.jordanvii.com/</a>


-----
--------
AUTHOR: Madhukar Moogala
AUTHOR EMAIL: fpdtypepadadmin@autodesk.com
TITLE: Augusto Goncalves
STATUS: Publish
ALLOW COMMENTS: 0
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: augusto-goncalves

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/augusto-goncalves.html 
DATE: 04/23/2012 03:10:53 AM
-----
BODY:
<p><a class="asset-img-link" style="display: inline;" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b016304a1266e970d-pi"><img class="asset  asset-image at-xid-6a0167607c2431970b016304a1266e970d" style="float: left; padding: 6px 6px 0 0;" title="Augusto_goncalves" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b016304a1266e970d-800wi" border="0" alt="Augusto_goncalves" /></a>Augusto Gonçalves is a DevTech engineer from Autodesk since 2008, based in São Paulo, Brazil. With five years of previous experience before joining Autodesk, he has started supporting developers on AutoCAD®, Civil 3D®, Revit and Inventor based technologies, especially in Latin America.</p>
<p>Augusto holds a Master's in Computer Science and B.S. in Civil Engineering.</p>
<p>View posts by <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves/">Augusto</a>.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Renaming the ‘Industry Data Model’ aka ‘Topobase’ API assemblies and namespace in AutoCAD Map 3D 2013
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: renaming-the-industry-data-model-aka-topobase-api-assemblies-and-namespace-in-autocad-map-3d-2013
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/04/renaming-the-industry-data-model-aka-topobase-api-assemblies-and-namespace-in-autocad-map-3d-2013.html 
DATE: 04/23/2012 01:42:31 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>This article is in continuation of <a href="http://adndevblog.typepad.com/infrastructure/2012/04/importance-of-autodeskmapplatform-assembly-in-autocad-map-3d-2013.html" target="_self">previous</a> post related to AutoCAD Map 3D 2013 and change in API namespaces / assemblies. In AutoCAD Map 3D 2013, all the namespaces and assemblies starting with &quot;<strong>Topobase.xxx</strong>&quot; is renamed to &quot;<strong>Autodesk.Map.IM.xxx</strong>&quot;, e.g. <strong>Topobase.AreaTopology.dll</strong> is renamed to <strong>Autodesk.Map.IM.AreaTopology.dll</strong> and the <em>Topobase.AreaTopology</em> namespace is renamed to <em>Autodesk.Map.IM.AreaTopology</em> Namespace. If you have an existing application for AutoCAD Map 3D 2012, which is using Topobase assemblies and namespaces, you need to update the assemblies and namespaces per AutoCAD Map 3D 2013.</p>
<p>AutoCAD Map 3D 2013 SDK is available for <strong><a href="http://usa.autodesk.com/adsk/servlet/item?siteID=123112&amp;id=868205" target="_self">download</a></strong> from Map 3D <a href="http://www.autodesk.com/developmap" target="_self">Developer Center page</a>. AutoCAD Map 3D 2013 <strong><a href="http://wikihelp.autodesk.com/AutoCAD_Map_3D/enu/2013" target="_self">Developer Guide</a></strong> is available online and you can download the related <strong><a href="http://download.autodesk.com/media/adn/Map3D2013APIRefDocs.zip" target="_self">API Reference documents</a></strong> from here.</p>
<p>&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Augusto Goncalves
AUTHOR EMAIL: augusto.goncalves@autodesk.com
TITLE: COM References on Civil 3D 2013
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: com-references-on-civil-3d-2013
CATEGORY: Augusto Goncalves
CATEGORY: AutoCAD Civil 3D 2013

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/04/com-references-on-civil-3d-2013.html 
DATE: 04/22/2012 03:10:09 PM
-----
BODY:
<p>By Augusto Goncalves</p>
<p>Now with this new release, the COM references are not registered on the system, therefore we cannot add the from the traditional ‘COM’ tab we adding references, but use the ‘Browse’ tab to search them at the Civil 3D install folder. To seem the references, go to the folder and search for *interop*.dll, like shown below.</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0163049aa809970d-pi"><img alt="c3d_2013_refs" border="0" height="213" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0168ea901c8d970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: block; float: none; margin-left: auto; margin-right: auto; padding-top: 0px; border: 0px;" title="c3d_2013_refs" width="244" /></a></p>
<p>To use if on your .NET project, go to ‘Add reference’, then select ‘Browse’ tab, then locate the required assemblies at the Civil 3D folder. By default, Visual Studio 2010 (all versions) mark these references as ‘Embed Interop Types’ by leaving it as True. This is required, as the references as not registered, the plug-in DLL must include the type definitions.</p>
<p><strong>Update</strong></p>
<p>There is a change on Civil 3D 2013: some of the COM types now have GUIDs, therefore you need to compile using 64 bit references for 64 bit OS, and replace the references and compile again for 32 bit. A common symptom of these wrong references is the runtime error showing &#39;Unable to cast COM object&#39;.</p>
<p>This blog post was changed to reflect this updated information.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Richard Sincovec
EMAIL: sinc@quuxsoft.com
IP: 64.25.237.238
URL: http://www.quuxsoft.com
DATE: 04/23/2012 08:14:24 AM
NOT pleased with this change.  It's made our life much more difficult.  But it helps explain some of the problems we've been encountering, trying to create a 2013 build of our software.
-----
COMMENT:
AUTHOR: RasmusB
EMAIL: rfb@focus.no
IP: 176.11.27.232
URL: 
DATE: 04/23/2012 09:10:54 AM
Hi Augusto,
Thanks for clearing things up. Up until now I have built the 32 bit version of my Civil 3D application on a 32 bit machine - just in case, really. However, having read the different blog posts about migration code, I am tempted to try to build both versions (32 and 64 bit) of my app on my 64 bit machine. Though when I set platform target to x86, I do get a warning saying that the .net wrappers AecBaseMgd etc. (referenced from the Civil installation folder) targets a different platform...should I set platform target to Any CPU when building the 32 bit version?
-----
COMMENT:
AUTHOR: Jeff Mishler
EMAIL: jeffm@quuxsoft.com
IP: 99.105.62.248
URL: http://www.quuxsoft.com
DATE: 04/23/2012 10:12:51 PM
And I still can't get a simple test project to correctly build for both 32/64 from my Win7x64. They both build, and I can actually get the AeccApplication and AeccDocument objects in a 32 bit OS, but attempting to access an Aecc* object yields the Nointerface error. Just this simple line of code fails:
 AeccAlignment align = (AeccAlignment)aeccdoc.AlignmentsSiteless.Item(0);

I thought these new changes were supposed to making things better? So far, I'm not real impressed. 
-----
COMMENT:
AUTHOR: RasmusB
EMAIL: rfb@focus.no
IP: 84.202.42.85
URL: 
DATE: 04/24/2012 12:16:08 PM
To build the 32 bit version of a Civil app on a 64 bit machine; is it sufficient to copy the dlls we want to reference, from the Civil 3D 2013 installation folder on a 32 bit machine, on to a folder on the 64 bit machine, and reference them from there, or must the 32 bit version be built on a 32 bit machine?
-----
COMMENT:
AUTHOR: Jeff Mishler
EMAIL: jeffm@quuxsoft.com
IP: 99.105.62.248
URL: http://www.quuxsoft.com
DATE: 04/24/2012 08:15:44 PM
I am now successfully building 32-bit versions on my Win7x64. I ended up copying the Aec* interop dll's from a x86 install to the inc-win32 folder in ObjectARX2013 and set the references for the x86 build there. It took some trickery in the csproj file so all I have to do is switch platforms between x86 & x64, but it's working fine now. Still more work than it should've been, IMHO. 
-----
COMMENT:
AUTHOR: RasmusB
EMAIL: rfb@focus.no
IP: 195.159.18.131
URL: 
DATE: 04/24/2012 11:36:43 PM
And for a C++/ObjectARX project, one have to copy the .tlb-files from the Civil Engineering 100-folder on a x86 install, I guess?
-----
COMMENT:
AUTHOR: Augusto Goncalves
EMAIL: 
IP: 189.8.69.39
URL: http://profile.typepad.com/6p0168e7e7c9dd970c
DATE: 04/25/2012 08:36:44 AM
Thank you all for the comments and reports so far, I'm currently investigating this with the engineers responsible, soon will publish more data. Regards.
-----
COMMENT:
AUTHOR: Richard Sincovec
EMAIL: sinc@quuxsoft.com
IP: 66.129.59.44
URL: http://www.quuxsoft.com
DATE: 04/26/2012 12:15:59 AM
This problem would probably not exist if we could actually build .NET versions of our apps, and avoid the Interops.  But having so many features still missing from the .NET stuff, we still have to include Interops (Sheet Set Manager stuff is a key example for the core ACAD stuff, there's TONS of stuff in Civil 3D that require Interops).  If we're really supposed to switch to a .NET interface, as we've been told we should, for several years now, we need Autodesk to give us some help, and make everything available via .NET.
-----
COMMENT:
AUTHOR: Richard Sincovec
EMAIL: sinc@quuxsoft.com
IP: 66.129.59.44
URL: http://www.quuxsoft.com
DATE: 04/26/2012 12:19:37 AM
Oh, sorry, I guess this might not help the C++ programmers...  But a FULL .NET API would sure help all us .NET programmers (C#, VB, F#, etc.....)
-----
COMMENT:
AUTHOR: RasmusB
EMAIL: rfb@focus.no
IP: 195.18.137.50
URL: 
DATE: 04/26/2012 06:15:00 AM
If I copy the TLBs (AecXBase70, AecXUIBase70, AeccXLand etc) from the Civil Engineering 100-folder on a x86 install, on to my Win7 x64 machine to build a 32 bit version, I get errors when trying to import them (the TLBs) in my C++-project:
error C4772: #import referenced a type from a missing type library.

Importing the equivalent TLBs from the Civil Engineering 100-folder on my machine for 64 bit build goes on without errors.
-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Using SampleElevations() in AutoCAD Civil 3D 2013 .NET API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: using-sampleelevations-in-autocad-civil-3d-2013-net-api
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/04/using-sampleelevations-in-autocad-civil-3d-2013-net-api.html 
DATE: 04/20/2012 01:07:52 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>.NET version of SampleElevations() was not included in AutoCAD Civil 3D 2012 release. However, in 2013 release, it&#39;s included : &#0160;<span style="font-size: 10pt;"><span style="background-color: white; font-family: &#39;Courier New&#39;; color: blue; line-height: 140%;">public</span><span style="background-color: white; font-family: &#39;Courier New&#39;; line-height: 140%;"> </span><span style="background-color: white; font-family: &#39;Courier New&#39;; color: #2b91af; line-height: 140%;">Point3dCollection</span><span style="background-color: white; font-family: &#39;Courier New&#39;; line-height: 140%;"><strong> SampleElevations</strong>(</span><span style="background-color: white; font-family: &#39;Courier New&#39;; color: #2b91af; line-height: 140%;">ObjectId</span><span style="background-color: white; font-family: &#39;Courier New&#39;; line-height: 140%;"> curveId);</span></span></p>
<p>It takes an <em>ObjectId </em>of <em>Autodesk.AutoCAD.DatabaseServices.Curve</em> and the curve can be a line, arc and so on. Here is a C# code snippet which demonstartes usage of this API function in AutoCAD Civil 3D 2013 :</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">public</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">static</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">void</span><span style="line-height: 140%;"> DemoSurfaceSampleElevations2013()</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="color: green; line-height: 140%;">// Get the AutoCAD Editor</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="color: #2b91af; line-height: 140%;">Editor</span><span style="line-height: 140%;"> ed = </span><span style="color: #2b91af; line-height: 140%;">Application</span><span style="line-height: 140%;">.DocumentManager.MdiActiveDocument.Editor;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="color: green; line-height: 140%;">//select a surface</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="color: #2b91af; line-height: 140%;">PromptEntityOptions</span><span style="line-height: 140%;"> selSurface = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">PromptEntityOptions</span><span style="line-height: 140%;">(</span><span style="color: #a31515; line-height: 140%;">&quot;\nSelect a Tin Surface: &quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; selSurface.SetRejectMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nOnly Tin Surface is allowed&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; selSurface.AddAllowedClass(</span><span style="color: blue; line-height: 140%;">typeof</span><span style="line-height: 140%;">(</span><span style="color: #2b91af; line-height: 140%;">TinSurface</span><span style="line-height: 140%;">), </span><span style="color: blue; line-height: 140%;">true</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="color: #2b91af; line-height: 140%;">PromptEntityResult</span><span style="line-height: 140%;"> resSurface = ed.GetEntity(selSurface);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (resSurface.Status != </span><span style="color: #2b91af; line-height: 140%;">PromptStatus</span><span style="line-height: 140%;">.OK) </span><span style="color: blue; line-height: 140%;">return</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> surfaceId = resSurface.ObjectId;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="color: green; line-height: 140%;">//select a polyline</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="color: #2b91af; line-height: 140%;">PromptEntityOptions</span><span style="line-height: 140%;"> selPline = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">PromptEntityOptions</span><span style="line-height: 140%;">(</span><span style="color: #a31515; line-height: 140%;">&quot;\nSelect a polyline: &quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; selPline.SetRejectMessage(</span><span style="color: #a31515; line-height: 140%;">&quot;\nOnly polylines allowed&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; selPline.AddAllowedClass(</span><span style="color: blue; line-height: 140%;">typeof</span><span style="line-height: 140%;">(</span><span style="color: #2b91af; line-height: 140%;">Polyline</span><span style="line-height: 140%;">), </span><span style="color: blue; line-height: 140%;">true</span><span style="line-height: 140%;">);&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; &#0160;&#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="color: #2b91af; line-height: 140%;">PromptEntityResult</span><span style="line-height: 140%;"> resPline = ed.GetEntity(selPline);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (resPline.Status != </span><span style="color: #2b91af; line-height: 140%;">PromptStatus</span><span style="line-height: 140%;">.OK) </span><span style="color: blue; line-height: 140%;">return</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="color: #2b91af; line-height: 140%;">ObjectId</span><span style="line-height: 140%;"> plineId = resPline.ObjectId;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="color: #2b91af; line-height: 140%;">Database</span><span style="line-height: 140%;"> db = </span><span style="color: #2b91af; line-height: 140%;">Application</span><span style="line-height: 140%;">.DocumentManager.MdiActiveDocument.Database;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">Transaction</span><span style="line-height: 140%;"> trans = db.TransactionManager.StartTransaction())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; </span><span style="color: #2b91af; line-height: 140%;">TinSurface</span><span style="line-height: 140%;"> surface = trans.GetObject(surfaceId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForRead) </span><span style="color: blue; line-height: 140%;">as</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">TinSurface</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; </span><span style="color: green; line-height: 140%;">// SampleElevations(ObjectId curveId) returns a Point3dCollection</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; </span><span style="color: #2b91af; line-height: 140%;">Point3dCollection</span><span style="line-height: 140%;"> intPts = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Point3dCollection</span><span style="line-height: 140%;">();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; intPts = surface.SampleElevations(plineId);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; </span><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (intPts.Count != 0)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; &#0160;&#0160;&#0160; </span><span style="color: blue; line-height: 140%;">foreach</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">Point3d</span><span style="line-height: 140%;"> pt </span><span style="color: blue; line-height: 140%;">in</span><span style="line-height: 140%;"> intPts)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; &#0160;&#0160;&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; &#0160;&#0160;&#0160; &#0160;&#0160;&#0160; ed.WriteMessage(</span><span style="color: blue; line-height: 140%;">string</span><span style="line-height: 140%;">.Format(</span><span style="color: #a31515; line-height: 140%;">&quot;{0} {1}&quot;</span><span style="line-height: 140%;">, </span><span style="color: #2b91af; line-height: 140%;">Environment</span><span style="line-height: 140%;">.NewLine, pt.ToString()));&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; &#0160;&#0160;&#0160; &#0160;&#0160;&#0160; &#0160;&#0160;&#0160; &#0160;&#0160;&#0160; &#0160; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; &#0160;&#0160;&#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; }</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; &#0160;&#0160;&#0160; trans.Commit();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; }</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:
SampleElevations, .NET API, Civil 3D, Surface
-----
COMMENT:
AUTHOR: Johan Pingree
EMAIL: johan@holdown.com
IP: 75.151.123.103
URL: http://www.slackjack.com
DATE: 06/01/2012 03:22:13 PM
BTW, it might be nice to note that you have to define SetRejectedMessage before you define AddAllowClass. Although your plugin will compile, it will throw an error if this is out of sequence when it is reached in process.
Something I did not know!
-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Activate hyperlink by double click in Ajax viewer of AIMS 2013
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 1
ALLOW PINGS: 0
BASENAME: activate-hyperlink-by-double-click-in-ajax-viewer-of-aims-2013
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: Daniel Du
CATEGORY: MapGuide Enterprise 2011

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/04/activate-hyperlink-by-double-click-in-ajax-viewer-of-aims-2013.html 
DATE: 04/18/2012 10:41:10 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>As you know, it is possible to set up a hyper link for features, and open a link by ctrl+click. For those who does not know, you can open a layer by double clicking the layer from Site Explorer of Infrastructure Studio, and click the … button to set a hyperlink expression for “URL activated for feature”:</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01630467fc85970d-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0168ea5d4f37970c-pi" width="436" height="24" /></a></p>  <p>With this setting, user can activate an URL by clicking one feature while pressing CTRL key.</p>  <p>But many users, especially users who are used to MapGuide 6.5, are willing to change this behavior to double click, it is possible? The answer is yes. here is a <a href="http://osgeo-org.1560.n6.nabble.com/Activate-Hyperlink-by-double-click-td4195187.html" target="_blank">thread</a> on MapGuide Open Source discussion group,, and it applies to AIMS 2013 as well. I presume it works for other versions of MapGuide Enterprise or AIMS with or without minor changes.</p>  <p>Here it goes. Open C:\Program Files\Autodesk\Autodesk Infrastructure Web Server Extension 2013\www\viewerfiles\ajaxmappane.templ and search “OnDblClick”, around line 867, and implement the “OnDblClick” function as below: </p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%; color: blue">function</span><span style="line-height: 140%"> OnDblClick(e)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">{</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: #006400">// Override this method in an external script to implement</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: #006400">// your own double-click handler.</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: #006400">// e.g. mapFrame.OnDblClick = MyOnDblClick</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: #006400">// where MyOnDblClick() is a function in your script.</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; hidePopup(tbMenu) </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; hidePopup(infoMenu) </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; hidePopup(ctxMenu) </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; parent.ForwardMouseDown(document, e); </span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">var</span><span style="line-height: 140%"> x = e.clientX - mapPosX; </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">var</span><span style="line-height: 140%"> y = e.clientY; </span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%">(x &lt; 0) { </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%">(safari &amp;&amp; x &gt; -5) { </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; moveType = RESIZING; </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">false</span><span style="line-height: 140%">; </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; } </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">false</span><span style="line-height: 140%">; </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; } </span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">var</span><span style="line-height: 140%"> processed = parent.ClickMap(x,y); </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (msie) {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; e.cancelBubble = </span><span style="line-height: 140%; color: blue">true</span><span style="line-height: 140%">; </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">else</span><span style="line-height: 140%"> {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; e.stopPropagation(); </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (!processed) { </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; HideHyperlinkTip(); </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%">(tool != 6) { </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%">(hlData.url != </span><span style="line-height: 140%; color: maroon">&quot;&quot;</span><span style="line-height: 140%">) {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ExecuteHyperlink(hlData.url); </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">else</span><span style="line-height: 140%"> { </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; hlData.curx = x; hlData.cury = y; </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; RequestHyperLinkData(++ hlData.reqId, </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; hlData.curx, hlData.cury, </span><span style="line-height: 140%; color: blue">true</span><span style="line-height: 140%">); </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; } </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; } </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160; } </span></p>    <p style="margin: 0px"><span style="line-height: 140%">}</span></p>    <p style="margin: 0px">&#160;</p> </div>  <p>Hope this helps.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Madhukar Moogala
AUTHOR EMAIL: fpdtypepadadmin@autodesk.com
TITLE: Daniel Du
STATUS: Publish
ALLOW COMMENTS: 0
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: daniel-du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/daniel-du.html 
DATE: 04/18/2012 02:03:50 AM
-----
BODY:
<p><a class="asset-img-link" style="display: inline;" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b016304560774970d-pi"><img class="asset  asset-image at-xid-6a0167607c2431970b016304560774970d" style="float: left; padding: 6px 6px 0 0;" title="Daniel-Du" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b016304560774970d-800wi" border="0" alt="Daniel-Du" /></a>Daniel Du has been with Autodesk since 2008, focusing on providing programming support, consulting, training and evangelism to external developers. He is based in Autodesk Beijing, China office. He started his career from an institute and gained more than 10 years’ experiences on software design and development domain. His expertise spreads across application development for Autodesk Infrastructure Map Server (former MapGuide), AutoCAD Map 3D, AutoCAD Civil 3D, Topobase and other Infrastructure Modeling Technologies from Autodesk.</p>
<p>Daniel has a bachelor degree in Geography from Lanzhou University. At his spare time, he likes going out for hiking in the hills near Beijing.</p>
<p>View posts by <a href="http://adndevblog.typepad.com/infrastructure/daniel-du/">Daniel</a>.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Madhukar Moogala
AUTHOR EMAIL: fpdtypepadadmin@autodesk.com
TITLE: Useful Links
STATUS: Publish
ALLOW COMMENTS: 0
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: useful-links

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/useful-links.html 
DATE: 04/17/2012 04:59:13 PM
-----
BODY:
<p><strong>ADN DevBlogs</strong></p>
<p><a href="http://adndevblog.typepad.com/aec" target="_blank">AEC</a></p>
<p><a title="AutoCAD" href="http://adndevblog.typepad.com/autocad" target="_self">AutoCAD</a></p>
<p><a title="Cloud and Mobile" href="http://adndevblog.typepad.com/cloud_and_mobile/" target="_self">Cloud and Mobile</a></p>
<p><a href="http://adndevblog.typepad.com/infrastructure" target="_self">Infrastructure</a></p>
<p><a href="http://adndevblog.typepad.com/manufacturing" target="_blank">Manufacturing</a></p>
<p><strong>&nbsp;</strong></p>
<p><strong>Other Autodesk Developer Blogs</strong></p>
<p><a href="http://through-the-interface.typepad.com/" target="_self">Through the Interface</a><br />Kean Walmsley's AutoCAD developer blog.</p>
<p><a href="http://thebuildingcoder.typepad.com/" target="_self">The Building Coder</a><br />Jeremy Tammik's Revit developer blog.</p>
<p><a href="http://modthemachine.typepad.com/" target="_blank">Mod the Machine</a><br />Brian Ekins' and Wayne Brill's Inventor developer blog.</p>
<p><a href="http://civilizeddevelopment.typepad.com/" target="_blank">Civilized Development</a><br />Isaac Rodriguez's AutoCAD Civil 3D developer blog.</p>
<p><a href="http://justonesandzeros.typepad.com/" target="_blank">Its All Just Ones and Zeros</a><br />Doug Redmond's Vault developer blog.</p>
<p><a href="http://dances-with-elephants.typepad.com/blog/" target="_blank">Dancing with Elephants</a><br />Jim Quanci's blog on partnering with large companies.</p>
<p><a href="http://blogs.autodesk.com/" target="_blank">More blogs on Autodesk.com</a>&nbsp;...</p>
<p>&nbsp;</p>
<p><strong>Useful Resources - General</strong></p>
<p><a href="http://www.autodesk.com/developer" target="_blank">Autodesk Developer Center</a><br />Information on using Autodesk technologies and APIs.</p>
<p><a href="http://www.autodesk.com/joinadn" target="_blank">Autodesk Developer Network</a><br />A program for developers using Autodesk technologies.</p>
<p><a href="http://apps.exchange.autodesk.com/" target="_blank">Autodesk Exchange Store</a><br />Written a great plugin? Why not sell it on our store?</p>
<p>&nbsp;</p>
<p><strong>Useful Resources - Infrastructure Modeling</strong></p>
<p>Coming soon</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Madhukar Moogala
AUTHOR EMAIL: fpdtypepadadmin@autodesk.com
TITLE: Gopinath Taget
STATUS: Publish
ALLOW COMMENTS: 0
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: gopinath-taget

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/gopinath-taget.html 
DATE: 04/17/2012 12:17:52 PM
-----
BODY:
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0163044ee257970d-pi"><img class="asset  asset-image at-xid-6a0167607c2431970b0163044ee257970d" style="float: left; padding: 6px 6px 0 0;" title="Gopinath-Taget" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0163044ee257970d-800wi" border="0" alt="Gopinath-Taget" /></a>Gopinath is a member of the Autodesk Developer Technical Services Team. He has been working on CAD and GIS platforms and APIs since 1999 and specifically on Autodesk CAD and GIS platforms since 2004. He has extensive experience developing and supporting AutoCAD® APIs, including ObjectARX®, Microsoft® .NET, VBA and LISP. Gopinath also has several years of experience in software development on other CAD platforms, including MicroStation®, SolidWorks®, and CATIA mainly using C++ and technologies such as MFC and COM. Gopinath was also involved in the development of web-based applications for Autodesk® MapGuide® and AutoCAD Map. Gopinath has master’s degrees in civil engineering and software systems. Currently, Gopinath is investigating and working on the exciting new trends in cloud computing and how it impacts the CAD industry.</p>
<p>View posts by <a href="http://adndevblog.typepad.com/infrastructure/gopinath-taget/">Gopinath</a>.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Madhukar Moogala
AUTHOR EMAIL: fpdtypepadadmin@autodesk.com
TITLE: Marat Mirgaleev
STATUS: Publish
ALLOW COMMENTS: 0
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: marat-mirgaleev

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/marat-mirgaleev.html 
DATE: 04/17/2012 12:11:01 PM
-----
BODY:
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0168ea445339970c-pi"><img class="asset  asset-image at-xid-6a0167607c2431970b0168ea445339970c" style="float: left; padding: 6px 6px 0 0;" title="Marat-Mirgaleev" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0168ea445339970c-800wi" border="0" alt="Marat-Mirgaleev" /></a>Marat joined Autodesk in 2008 and is located in Moscow, Russia.</p>
<p>His main responsibilities are technical support to Autodesk Developer Network partners and delivery of API trainings.</p>
<p>Marat has a Mechanics Engineer degree from Samara State Aerospace University (Samara, Russia).</p>
<p>Prior Autodesk Marat worked in several companies in aviation industry, medical equipment manufacturing etc.</p>
<p>In his spare time he likes doing sports, playing the guitar.</p>
<p>View posts by <a href="http://adndevblog.typepad.com/infrastructure/marat-mirgaleev/">Marat</a>.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Toggle visibility of Layer in Fusion does not work?
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: toggle-visibility-of-layer-in-fusion-does-not-work
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/04/toggle-visibility-of-layer-in-fusion-does-not-work.html 
DATE: 04/17/2012 04:24:51 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html" target="_self">Daniel Du</a></p>
<p>In this topic, I would like to show you how to change the visibility of layer in AIMS Fusion Viewer or flexible web layout. The basic steps will be changing the “Visible” property of MgLayer, or calling MgLayer.SetVisible() method, then refresh the map.</p>
<p>&#0160;</p>
<p>We can refresh the map in body.onload() event. To refresh the map in fusion viewer, we can use the APIs provided by “MapGuideViewerAPI.js”. We import this script file by :</p>
<p style="margin: 0px;"><span style="line-height: 140%; background: yellow;">&lt;%</span><span style="line-height: 140%; color: #006400;">--reference the fusion viewer API javascript file--</span><span style="line-height: 140%; background: yellow;">%&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;</span><span style="line-height: 140%; color: blue;">&lt;</span><span style="line-height: 140%; color: maroon;">script</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: red;">type</span><span style="line-height: 140%; color: blue;">=&quot;text/javascript&quot;</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: red;">language</span><span style="line-height: 140%; color: blue;">=&quot;javascript&quot;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;</span><span style="line-height: 140%; color: red;">src</span><span style="line-height: 140%; color: blue;">=&quot;../mapserver2012/fusion/layers/MapGuide/MapGuideViewerApi.js&quot;&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;</span><span style="line-height: 140%; color: blue;">&lt;/</span><span style="line-height: 140%; color: maroon;">script</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&#0160;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&#0160;</span></p>
<p><span style="line-height: 140%; background: yellow;"><span style="background-color: #ffffff;">Here is the complete code for refresh, please note that we need to call <span style="line-height: 140%;">Fusion.getWidgetById(</span><span style="line-height: 140%; color: maroon;">&#39;Map&#39;</span><span style="line-height: 140%;">).reloadMap() to refresh both legend and map.</span></span></span></p>
<p><span style="line-height: 140%; background: yellow;">&lt;%</span><span style="line-height: 140%; color: blue;">@</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: maroon;">Page</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: red;">Language</span><span style="line-height: 140%; color: blue;">=&quot;C#&quot;</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: red;">AutoEventWireup</span><span style="line-height: 140%; color: blue;">=&quot;true&quot;</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: red;">CodeFile</span><span style="line-height: 140%; color: blue;">=&quot;ToggleLayer.aspx.cs&quot;</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: red;">Inherits</span><span style="line-height: 140%; color: blue;">=&quot;ToggleLayer&quot;</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; background: yellow;">%&gt;</span></p>
<div style="font-family: courier new; background: white; color: black; font-size: 8pt;">
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&lt;!</span><span style="line-height: 140%; color: maroon;">DOCTYPE</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: red;">html</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: red;">PUBLIC</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">&quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">&quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&lt;</span><span style="line-height: 140%; color: maroon;">html</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: red;">xmlns</span><span style="line-height: 140%; color: blue;">=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&lt;</span><span style="line-height: 140%; color: maroon;">head</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: red;">id</span><span style="line-height: 140%; color: blue;">=&quot;Head1&quot;</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: red;">runat</span><span style="line-height: 140%; color: blue;">=&quot;server&quot;&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">&lt;</span><span style="line-height: 140%; color: maroon;">title</span><span style="line-height: 140%; color: blue;">&gt;&lt;/</span><span style="line-height: 140%; color: maroon;">title</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; background: yellow;">&lt;%</span><span style="line-height: 140%; color: #006400;">--reference the fusion viewer API javascript file--</span><span style="line-height: 140%; background: yellow;">%&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">&lt;</span><span style="line-height: 140%; color: maroon;">script</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: red;">type</span><span style="line-height: 140%; color: blue;">=&quot;text/javascript&quot;</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: red;">language</span><span style="line-height: 140%; color: blue;">=&quot;javascript&quot;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: red;">src</span><span style="line-height: 140%; color: blue;">=&quot;../mapserver2012/fusion/layers/MapGuide/MapGuideViewerApi.js&quot;&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">&lt;/</span><span style="line-height: 140%; color: maroon;">script</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">&lt;</span><span style="line-height: 140%; color: maroon;">script</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: red;">type</span><span style="line-height: 140%; color: blue;">=&quot;text/javascript&quot;&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #006400;">// set isFusion to false if you are using Ajax viewer</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">var</span><span style="line-height: 140%;"> isFusion = </span><span style="line-height: 140%; color: blue;">true</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">function</span><span style="line-height: 140%;"> RefreshMap() {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">if</span><span style="line-height: 140%;"> (isFusion) {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #006400;">//Refresh();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Fusion = window.top.Fusion;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #006400;">//following code does not work</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #006400;">//var legend = Fusion.getWidgetById(&quot;Legend&quot;);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #006400;">//legend.renderer.update();</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #006400;">//reload the Map to refresh legend</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Fusion.getWidgetById(</span><span style="line-height: 140%; color: maroon;">&#39;Map&#39;</span><span style="line-height: 140%;">).reloadMap();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">else</span><span style="line-height: 140%;"> {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #006400;">// for basic web layout, </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #006400;">// if using basic weblayout, referenceing </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #006400;">// to MapGuideViewerApi.js should be removed</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; parent.parent.Refresh();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">&lt;/</span><span style="line-height: 140%; color: maroon;">script</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&lt;/</span><span style="line-height: 140%; color: maroon;">head</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&lt;</span><span style="line-height: 140%; color: maroon;">body</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: red;">onload</span><span style="line-height: 140%; color: blue;">=&quot;javascript:RefreshMap()&quot;&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">&lt;</span><span style="line-height: 140%; color: maroon;">form</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: red;">id</span><span style="line-height: 140%; color: blue;">=&quot;form1&quot;</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: red;">runat</span><span style="line-height: 140%; color: blue;">=&quot;server&quot;&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">&lt;</span><span style="line-height: 140%; color: maroon;">div</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">&lt;/</span><span style="line-height: 140%; color: maroon;">div</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">&lt;/</span><span style="line-height: 140%; color: maroon;">form</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&lt;/</span><span style="line-height: 140%; color: maroon;">body</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&lt;/</span><span style="line-height: 140%; color: maroon;">html</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
<p style="margin: 0px;">&#0160;</p>
</div>
<p>Now let’s working on the code behind. this part of work is pretty straight forward, I paste the code as below:</p>
<div style="font-family: courier new; background: white; color: black; font-size: 8pt;">
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> System;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> System.Collections.Generic;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> System.Web;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> System.Web.UI;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> System.Web.UI.WebControls;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> OSGeo.MapGuide;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">public</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">partial</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">class</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">ToggleLayer</span><span style="line-height: 140%;"> : System.Web.UI.</span><span style="line-height: 140%; color: #2b91af;">Page</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">protected</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">void</span><span style="line-height: 140%;"> Page_Load(</span><span style="line-height: 140%; color: blue;">object</span><span style="line-height: 140%;"> sender, </span><span style="line-height: 140%; color: #2b91af;">EventArgs</span><span style="line-height: 140%;"> e)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> sessionId = Request[</span><span style="line-height: 140%; color: #a31515;">&quot;Session&quot;</span><span style="line-height: 140%;">].ToString();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> mapName = Request[</span><span style="line-height: 140%; color: #a31515;">&quot;MapName&quot;</span><span style="line-height: 140%;">].ToString();</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">try</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af;">Utility</span><span style="line-height: 140%;"> utility = </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">Utility</span><span style="line-height: 140%;">();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; utility.InitializeWebTier(Request);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; utility.ConnectToServer(sessionId);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af;">MgSiteConnection</span><span style="line-height: 140%;"> siteConnection </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; = utility.GetSiteConnection();</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">if</span><span style="line-height: 140%;"> (siteConnection == </span><span style="line-height: 140%; color: blue;">null</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Response.Write(</span><span style="line-height: 140%; color: #a31515;">&quot;fail to get site connection, exit&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">return</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af;">MgResourceService</span><span style="line-height: 140%;"> resService = </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (</span><span style="line-height: 140%; color: #2b91af;">MgResourceService</span><span style="line-height: 140%;">)siteConnection</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; .CreateService(</span><span style="line-height: 140%; color: #2b91af;">MgServiceType</span><span style="line-height: 140%;">.ResourceService);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af;">MgLayerBase</span><span style="line-height: 140%;"> tmpLayer = </span><span style="line-height: 140%; color: blue;">null</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af;">MgMap</span><span style="line-height: 140%;"> map = </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">MgMap</span><span style="line-height: 140%;">();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; map.Open(resService, mapName);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; tmpLayer = map.GetLayers().GetItem(</span><span style="line-height: 140%; color: #a31515;">&quot;Districts&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; tmpLayer.SetVisible(!tmpLayer.IsVisible());</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; tmpLayer.ForceRefresh();</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; map.Save(resService);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">if</span><span style="line-height: 140%;"> (tmpLayer.IsVisible())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Response.Write(</span><span style="line-height: 140%; color: #a31515;">&quot;&lt;p&gt;&lt;b&gt; the Districts layer is turned on &lt;/b&gt;&lt;/p&gt;&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">else</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Response.Write(</span><span style="line-height: 140%; color: #a31515;">&quot;&lt;p&gt;&lt;b&gt; the Districts layer is turned off &lt;/b&gt;&lt;/p&gt;&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">catch</span><span style="line-height: 140%;"> (</span><span style="line-height: 140%; color: #2b91af;">MgException</span><span style="line-height: 140%;"> ex)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Response.Write(ex.Message);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Response.Write(ex.GetDetails());</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
<p style="margin: 0px;">&#0160;</p>
</div>
<p>It is quite simple, but when you running this code snippet, you may find it does not work, it is executed without any problem, but the visibility of layer does not change in map and legend. The reason is due to the page cache, so we need to clear the page cache by adding following code at the beginning of Page_Load function:</p>
<div style="font-family: courier new; background: white; color: black; font-size: 8pt;">
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Response.CacheControl = </span><span style="line-height: 140%; color: #a31515;">&quot;no-cache&quot;</span><span style="line-height: 140%;">;</span></p>
</div>
<p>&#0160;</p>
<p>The complete code goes as below:</p>
<div style="font-family: courier new; background: white; color: black; font-size: 8pt;">
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> System;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> System.Collections.Generic;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> System.Web;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> System.Web.UI;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> System.Web.UI.WebControls;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> OSGeo.MapGuide;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">public</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">partial</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">class</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">ToggleLayer</span><span style="line-height: 140%;"> : System.Web.UI.</span><span style="line-height: 140%; color: #2b91af;">Page</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">protected</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">void</span><span style="line-height: 140%;"> Page_Load(</span><span style="line-height: 140%; color: blue;">object</span><span style="line-height: 140%;"> sender, </span><span style="line-height: 140%; color: #2b91af;">EventArgs</span><span style="line-height: 140%;"> e)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">// *IMPORTANT*, clear the cache</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Response.CacheControl = </span><span style="line-height: 140%; color: #a31515;">&quot;no-cache&quot;</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> sessionId = Request[</span><span style="line-height: 140%; color: #a31515;">&quot;Session&quot;</span><span style="line-height: 140%;">].ToString();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> mapName = Request[</span><span style="line-height: 140%; color: #a31515;">&quot;MapName&quot;</span><span style="line-height: 140%;">].ToString();</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">try</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af;">Utility</span><span style="line-height: 140%;"> utility = </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">Utility</span><span style="line-height: 140%;">();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; utility.InitializeWebTier(Request);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; utility.ConnectToServer(sessionId);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af;">MgSiteConnection</span><span style="line-height: 140%;"> siteConnection </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; = utility.GetSiteConnection();</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">if</span><span style="line-height: 140%;"> (siteConnection == </span><span style="line-height: 140%; color: blue;">null</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Response.Write(</span><span style="line-height: 140%; color: #a31515;">&quot;fail to get site connection, exit&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">return</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af;">MgResourceService</span><span style="line-height: 140%;"> resService = </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (</span><span style="line-height: 140%; color: #2b91af;">MgResourceService</span><span style="line-height: 140%;">)siteConnection</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; .CreateService(</span><span style="line-height: 140%; color: #2b91af;">MgServiceType</span><span style="line-height: 140%;">.ResourceService);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af;">MgLayerBase</span><span style="line-height: 140%;"> tmpLayer = </span><span style="line-height: 140%; color: blue;">null</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af;">MgMap</span><span style="line-height: 140%;"> map = </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">MgMap</span><span style="line-height: 140%;">();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; map.Open(resService, mapName);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; tmpLayer = map.GetLayers().GetItem(</span><span style="line-height: 140%; color: #a31515;">&quot;Districts&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; tmpLayer.SetVisible(!tmpLayer.IsVisible());</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; tmpLayer.ForceRefresh();</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; map.Save(resService);</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">if</span><span style="line-height: 140%;"> (tmpLayer.IsVisible())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Response.Write(</span><span style="line-height: 140%; color: #a31515;">&quot;&lt;p&gt;&lt;b&gt; the Districts layer is turned on &lt;/b&gt;&lt;/p&gt;&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">else</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Response.Write(</span><span style="line-height: 140%; color: #a31515;">&quot;&lt;p&gt;&lt;b&gt; the Districts layer is turned off &lt;/b&gt;&lt;/p&gt;&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">catch</span><span style="line-height: 140%;"> (</span><span style="line-height: 140%; color: #2b91af;">MgException</span><span style="line-height: 140%;"> ex)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Response.Write(ex.Message);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Response.Write(ex.GetDetails());</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
<p style="margin: 0px;">&#0160;</p>
</div>
<p>The implementation of Utility class goes as below:</p>
<div style="font-family: courier new; background: white; color: black; font-size: 8pt;">
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> System;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> System.Collections.Generic;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> System.Web;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> System.Collections;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> System.Xml;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> System.IO;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> System.Text;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> OSGeo.MapGuide;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%; color: gray;">///</span><span style="line-height: 140%; color: green;"> </span><span style="line-height: 140%; color: gray;">&lt;summary&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: gray;">///</span><span style="line-height: 140%; color: green;"> Summary description for Utility.</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: gray;">///</span><span style="line-height: 140%; color: green;"> Created by Daniel Du, DevTech</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: gray;">///</span><span style="line-height: 140%; color: green;"> </span><span style="line-height: 140%; color: gray;">&lt;/summary&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">public</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">class</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">Utility</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af;">MgSiteConnection</span><span style="line-height: 140%;"> siteConnection;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">public</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">void</span><span style="line-height: 140%;"> InitializeWebTier(</span><span style="line-height: 140%; color: #2b91af;">HttpRequest</span><span style="line-height: 140%;"> Request)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> realPath = </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Request.ServerVariables[</span><span style="line-height: 140%; color: #a31515;">&quot;APPL_PHYSICAL_PATH&quot;</span><span style="line-height: 140%;">];</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af;">String</span><span style="line-height: 140%;"> configPath = realPath + </span><span style="line-height: 140%; color: #a31515;">&quot;../webconfig.ini&quot;</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af;">MapGuideApi</span><span style="line-height: 140%;">.MgInitializeWebTier(configPath);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; }</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">public</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">void</span><span style="line-height: 140%;"> ConnectToServer(</span><span style="line-height: 140%; color: #2b91af;">String</span><span style="line-height: 140%;"> sessionID)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af;">MgUserInformation</span><span style="line-height: 140%;"> userInfo = </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">MgUserInformation</span><span style="line-height: 140%;">(sessionID);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; siteConnection = </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">MgSiteConnection</span><span style="line-height: 140%;">();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; siteConnection.Open(userInfo);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; }</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">public</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">MgSiteConnection</span><span style="line-height: 140%;"> GetSiteConnection()</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">return</span><span style="line-height: 140%;"> siteConnection;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; }</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
<p>&#0160;</p>
<p>Hope this helps you.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Make full use of tooltip in Autodesk Infrastructure Map Server(AIMS) or MapGuide Open Source
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 0
ALLOW PINGS: 0
BASENAME: make-full-use-of-tooltip-in-autodesk-infrastructure-map-serveraims-or-mapguide-open-source
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: Daniel Du
CATEGORY: MapGuide Enterprise 2011

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/04/make-full-use-of-tooltip-in-autodesk-infrastructure-map-serveraims-or-mapguide-open-source.html 
DATE: 04/13/2012 01:23:22 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html" target="_self">Daniel Du</a></p>
<p>My colleague Partha wrote up an <a href="http://adndevblog.typepad.com/infrastructure/2012/04/multiline-tool-tip-in-autodesk-infrastructure-map-server-mapguide-enterprise.html" target="_blank">post</a> about creating multiline mouse over Tool tip for your map in Autodesk Infrastructure Map Server / MapGuide Enterprise, in this post, I would dive deeper to introduce more interesting ways to make full use of tool-tip in AIMS, it also applies to MapGuide Open Source. I posted some articles about this topic in Chinese in my <a href="http://www.cnblogs.com/junqilian/" target="_blank">personal blog</a> years ago, but I am kind of obligated to rewrite it in English to spread to more audience.</p>
<p>&nbsp;</p>
<h3>Improvement of CONCAT</h3>
<p>Before we start, here is a tip you want to know to make your life easier. As you know, to join multiple components in Advanced mode, we can use “concat”. For example:</p>
<blockquote>
<p><a name="WS1A9193826455F5FFBA679E112A6A1900464CD"></a>concat(State_Name, concat(‘: ‘,Population))</p>
</blockquote>
<p>But you may get lost if you have so many components to join, it may make you crazy with so many “contact” and brackets. The good news is, contact function is improved from MapGuide Enterprise 2011/Map 3D 2011. CONCAT takes any number of arguments, which can be any property type except Geometry or Raster. The return value uses the String data type.Use ‘\n’ to insert a line break. To include static text labels or spaces, surround them with single quotes. When you use CONCAT with a Boolean property, the operation generates 1/0 (not True/False) as a result.</p>
<p><strong>Syntax</strong></p>
<p><a name="WS73099cc142f48755-6ab6cd0115aeafde51-7bd1"></a></p>
<p>CONCAT(Property, Property, ...)</p>
<p><strong>Example</strong></p>
<p><a name="WS73099cc142f48755-6ab6cd0115aeafde51-7bd0"></a></p>
<pre class="csharpcode">CONCAT(First_Name, <span class="str">' ', </span>Last_Name,
      <span class="str">'\n Address: '</span>, Street_number, <span class="str">' '</span>,<br />       Street_name, <span class="str">' '</span>, Suffix) </pre>
<p><a name="WS73099cc142f487553bd5b66812435c29801-62d6"></a></p>
<p>Here is the result：</p>
<p><a name="WS73099cc142f487553bd5b66812435c29801-62d5"></a></p>
<blockquote>
<p>John Smith</p>
<p><a name="WS73099cc142f487553bd5b66812435c29801-62d4"></a></p>
<p>Address: 123 Maple Street</p>
</blockquote>
<p>&nbsp;</p>
<h3>Embed hyperlink into tooltip</h3>
<p>Tooltip is implemented in the viewer as HTML div containers, that means you can embed any HTML tags in tooltip to create many pretty cool stuffs in tooltip with your basic HTML knowledge. We can add a hyperlink in tooltip by following code snippet to tooltip of parcel layer.</p>
<p>Double click parcels from Site Explorer in Infrastructure Studio to open the layer editor,</p>
<pre class="csharpcode">concat(<span class="str">'Parcel\nName: '</span>, RNAME, 
<span class="str">'\nAddress: '</span>, RBILAD,<span class="str">'
\nfeatid:'</span>, Autogenerated_SDF_ID ,
<span class="str">'\n &lt;a href="http://www.google.com" target=_blank&gt;     
     Click here to launch google search 
    &lt;/a&gt;'</span>)</pre>
<p>It will look like:</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0168e9ebfdf9970c-pi"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b016303f64d27970d-pi" border="0" alt="image" width="454" height="231" /></a></p>
<p>&nbsp;</p>
<h3>Embed image into tooltip</h3>
<p>Now, let’s add an &lt;image&gt; tag to embed an image into the tooltip, at the same time, add a hyperlink to this image.</p>
<pre class="csharpcode">concat(<span class="str">'Parcel\nName: '</span>, RNAME, 
<span class="str">'\nAddress: '</span>, RBILAD,<span class="str">'
\nfeatid:'</span>, Autogenerated_SDF_ID ,
<span class="str">'\n &lt;a href="http://www.google.com" target=_blank&gt;     
   Click here to launch google search &lt;/a&gt;'</span>,
<span class="str">'\n &lt;a href=http://www.autodesk.com target=_blank&gt;      
      &lt;image src="http://img1.mediabea.com/images
        /3/37/Autodesk_logo.jpg"
       alt="Autodesk" height=50, width=100&gt;
     &lt;/image&gt;
   &lt;/a&gt;'</span>)</pre>
<p>It will look like:</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0168e9ebfe16970c-pi"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b016764eaada3970b-pi" border="0" alt="image" width="442" height="218" /></a></p>
<p>&nbsp;</p>
<h3>Embed other tags</h3>
<p>Now I believe you’ve got the idea. we can embed any HTML tag into tooltip, so just use your imagination! <img class="wlEmoticon wlEmoticon-smile" style="border-style: none;" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b016764eaadb0970b-pi" alt="Smile" /></p>
<p>&nbsp;</p>
<h3>Let’s do something cool—Display Chart/Pie in tooltip</h3>
<p>I do know many people are trying to display chart on map, and it is not easy to do with native MapGuide API. I was suffering this as well until I came across <a href="https://developers.google.com/chart/image/docs/making_charts?hl=zh-CN" target="_blank">Google Chart API</a>. The Google Chart API returns a chart image in response to a URL GET or POST request. The API can generate many kinds of charts, from pie or line charts to QR codes and formulas. All the information about the chart that you want, such as chart data, size, colors, and labels, are part of the URL. To make the simplest chart possible, all your URL needs to specify is the chart type, data, and size. You can type this URL directly in your browser, or point to it with an <code>&lt;img&gt;</code> tag in your web page. For example, follow this link for a pie chart:</p>
<p><a href="https://chart.googleapis.com/chart?chs=250x100&amp;chd=t:60,40&amp;cht=p3&amp;chl=Hello|World">https://chart.googleapis.com/chart?chs=250x100&amp;chd=t:60,40&amp;cht=p3&amp;chl=Hello|World</a></p>
<p>You will get a chart image:</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b016303f73960970d-pi"><img style="background-image: none; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0168e9eceb03970c-pi" border="0" alt="image" width="244" height="113" /></a></p>
<p>&nbsp;</p>
<p>As per our discussion above, you can create the chart image and embed it into tooltip of MapGuide. MapGuide Open Source guru Jackie Ng created <a href="http://themapguyde.blogspot.com/2009/07/expressive-power-of-mapguide-tooltips.html" target="_blank">a post</a> to demonstrate how to do this. please refer to <a href="http://themapguyde.blogspot.com/" target="_blank">his blog</a> for more information.</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0168e9eceb0f970c-pi"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b016764eb98e7970b-pi" border="0" alt="image" width="394" height="144" /></a>&nbsp;</p>
<p>&nbsp;</p>
<h3>Display more comprehensive information in tooltip</h3>
<p>You may find it too complicated by joining contacting HTML tag directly if you want display more complicated information in tooltip. In this case, we can create a separate page then embed this page into tooltip with &lt;iframe&gt; tag.</p>
<p>Here is an example, I an trying to display detailed feature information in tooltip, so I created a web page named&nbsp; as FeatureInformation.aspx to retrieve detailed information of feature by feature ID, then embed it into tooltip:</p>
<pre class="csharpcode">concat(<span class="str">'Parcel\nName: '</span>, RNAME, 
<span class="str">'\nAddress: '</span>, RBILAD,<span class="str">'
\nfeatid:'</span>, Autogenerated_SDF_ID ,
<span class="str">'\n &lt;a href="http://www.google.com" target=_blank&gt;<br />     Click here to launch google search &lt;/a&gt;'</span>,
<span class="str">'\n &lt;a href=<a href="http://www.autodesk.com">http://www.autodesk.com</a> target=_blank&gt;<br />      &lt;image src="http://img1.mediabea.com/images<br />                          </span><span class="str">/3/37/Autodesk_logo.jpg" <br />             alt="Autodesk" height=50, width=100&gt;<br />      &lt;/image&gt;<br />    &lt;/a&gt;'</span>,
<span class="str">'\n&lt;iframe width=500 height=500 <br />      src= http://localhost/WebcastDemo/<br />              FeatureInformation.aspx?MyFeatID='</span>, <br />                           Autogenerated_SDF_ID ,<br />                           <span class="str">'&amp;session='</span>,<br />                           URLENCODE(SESSION()),</pre>
<pre class="csharpcode"><span class="str">'&gt;&lt;/iframe&gt;'</span>)</pre>
<p>&nbsp;</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b016764eaadbf970b-pi"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b016764eaadd1970b-pi" border="0" alt="image" width="498" height="393" /></a></p>
<p>Actually I can display any information this page, I can even query information from other system, like ERP/CRM, to implement the integration of MapGuide and other systems.</p>
<p>Did I mention that the it works for both Ajax viewer and Fusion viewer?</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b016764eb9942970b-pi"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0168e9eceb87970c-pi" border="0" alt="image" width="493" height="295" /></a></p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b016764eb997e970b-pi"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0168e9ecebf2970c-pi" border="0" alt="image" width="501" height="302" /></a></p>
<p>&nbsp;</p>
<p>I know someone is trying to add panoramic image and video into tooltip, do you have any other ideas to make full use of tooltip?</p>
<p>&nbsp;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: David
EMAIL: david.wilhelmsson@gmail.com
IP: 213.115.20.219
URL: 
DATE: 09/03/2012 05:03:56 AM
The first example should be corrected to read:

CONCAT(First_Name, ' ', Last_Name,
       '\nAddress: ', Street_number, ' ',
       Street_name, ' ', Suffix)
-----
COMMENT:
AUTHOR: Daniel Du
EMAIL: 
IP: 125.98.160.4
URL: http://profile.typepad.com/daniel_du
DATE: 09/03/2012 11:00:28 PM
Thanks David for pointing out this, it is fixed now.
-----
COMMENT:
AUTHOR: Aries
EMAIL: aaustria@indracompany.com
IP: 63.243.144.7
URL: 
DATE: 03/24/2013 10:58:14 PM
Hi Daniel. We can't get any success displaying this tooltip in our AIMS 2013 using fusion. Support told us to adjust these parameters but we can't find it.
ROLLOVERTIPS=1
SELECTIONPREVIEW=1 

What seems to be the problem here? Thank you.

-----
COMMENT:
AUTHOR: Progri
EMAIL: progrimail@gmail.com
IP: 201.212.202.77
URL: 
DATE: 06/24/2014 10:05:26 AM
Thanks a lot, genius!
-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Map.Save() throws MgNotImplementedException exception when adding new layer to map
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 0
ALLOW PINGS: 0
BASENAME: mapsave-throws-mgnotimplementedexception-exception-when-adding-new-layer-to-map
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: Daniel Du
CATEGORY: MapGuide Enterprise 2011

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/04/mapsave-throws-mgnotimplementedexception-exception-when-adding-new-layer-to-map.html 
DATE: 04/12/2012 01:29:22 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html" target="_self">Daniel Du</a></p>
<p>Are you getting <strong>MgNotImplementedException </strong>when trying to add new layers to map? If yes, keep reading.</p>
<p>&nbsp;</p>
<p>Here is my code snippet to create a MapGuide layer and insert it to current map, but it throws <strong>MgNotImplementedException </strong>at <strong>map.Save()</strong>:</p>
<div style="font-family: courier new; color: black; font-size: 8pt;">
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: green;">//Open the site connection and connect to </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: green;">//mapguide site using current session</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">if</span><span style="line-height: 140%;"> (siteConnection == </span><span style="line-height: 140%; color: blue;">null</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">MgUserInformation</span><span style="line-height: 140%;"> userInfo =</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">MgUserInformation</span><span style="line-height: 140%;">(sessionId);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; siteConnection = </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">MgSiteConnection</span><span style="line-height: 140%;">();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; siteConnection.Open(userInfo);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: green;">//Create resource service from site connection</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">MgResourceService</span><span style="line-height: 140%;"> resSvc = siteConnection</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .CreateService(</span><span style="line-height: 140%; color: #2b91af;">MgServiceType</span><span style="line-height: 140%;">.ResourceService)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">as</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">MgResourceService</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: green;">//Declare an resource id for layer</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">MgResourceIdentifier</span><span style="line-height: 140%;"> filterLayerId =</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">MgResourceIdentifier</span><span style="line-height: 140%;">(sessionLayerResId);</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: green;">//Open current map</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">MgMap</span><span style="line-height: 140%;"> map = </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">MgMap</span><span style="line-height: 140%;">();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; map.Open(resSvc, mapName);</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: green;">//Create a MgLayerBase object</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">MgLayerBase</span><span style="line-height: 140%;"> filteredLayer =</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">MgLayerBase</span><span style="line-height: 140%;">(filterLayerId, resSvc);</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: green;">//set up the new layer </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; filteredLayer.LegendLabel = </span><span style="line-height: 140%; color: #a31515;">"filtered"</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; filteredLayer.Selectable = </span><span style="line-height: 140%; color: blue;">true</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; filteredLayer.DisplayInLegend = </span><span style="line-height: 140%; color: blue;">true</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; filteredLayer.Name = </span><span style="line-height: 140%; color: #a31515;">"_filtered"</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; filteredLayer.Group = map.GetLayerGroups()[0];</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: green;">//insert the layer into map on top</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; map.GetLayers().Insert(0, filteredLayer);</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: green;">//MgNotImplementedException here ****</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; map.Save(resSvc);&nbsp; </span></p>
</div>
<p>When running this code snippet, I always get MgNotImplementedException, detailed error message goes as below:</p>
<p>==============================</p>
<p><em>Not implemented.</em></p>
<p><strong>Description: </strong>An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code.     <br /><strong>Exception Details: </strong>OSGeo.MapGuide.MgNotImplementedException: Not implemented.     <br /><strong>Source Error:</strong></p>
<p>&nbsp;</p>
<pre>Line 412:        map.GetLayers().Insert(0, filteredLayer);
Line 413:
Line 414:        map.Save(resSvc);
Line 415:
Line 416:    }</pre>
<p>==============================</p>
<p>Is there anything wrong with my code above?</p>
<pre class="csharpcode">    </pre>
<h4>Solution:</h4>
<p>Use <strong>MgLayer</strong> instead of MgLayerBase when inserting layers into map,&nbsp; it is simple but it is a little tricky and not easy to debug. so the working code snippet will be:</p>
<div style="font-family: courier new; color: black; font-size: 8pt;">
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: green;">//Open the site connection and connect to </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: green;">//mapguide site using current session</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">if</span><span style="line-height: 140%;"> (siteConnection == </span><span style="line-height: 140%; color: blue;">null</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">MgUserInformation</span><span style="line-height: 140%;"> userInfo =</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">MgUserInformation</span><span style="line-height: 140%;">(sessionId);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; siteConnection = </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">MgSiteConnection</span><span style="line-height: 140%;">();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; siteConnection.Open(userInfo);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: green;">//Create resource service from site connection</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">MgResourceService</span><span style="line-height: 140%;"> resSvc = siteConnection</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .CreateService(</span><span style="line-height: 140%; color: #2b91af;">MgServiceType</span><span style="line-height: 140%;">.ResourceService)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">as</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">MgResourceService</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: green;">//Declare an resource id for layer</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">MgResourceIdentifier</span><span style="line-height: 140%;"> filterLayerId =</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">MgResourceIdentifier</span><span style="line-height: 140%;">(sessionLayerResId);</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: green;">//Open current map</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">MgMap</span><span style="line-height: 140%;"> map = </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">MgMap</span><span style="line-height: 140%;">();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; map.Open(resSvc, mapName);</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: green;">//Create a MgLayerBase object</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">MgLayer</span><span style="line-height: 140%;"> filteredLayer =</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">MgLayer</span><span style="line-height: 140%;">(filterLayerId, resSvc);</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: green;">//set up the new layer </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; filteredLayer.LegendLabel = </span><span style="line-height: 140%; color: #a31515;">"filtered"</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; filteredLayer.Selectable = </span><span style="line-height: 140%; color: blue;">true</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; filteredLayer.DisplayInLegend = </span><span style="line-height: 140%; color: blue;">true</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; filteredLayer.Name = </span><span style="line-height: 140%; color: #a31515;">"_filtered"</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; filteredLayer.Group = map.GetLayerGroups()[0];</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: green;">//insert the layer into map on top</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; map.GetLayers().Insert(0, filteredLayer);</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: green;">//works fine now</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; map.Save(resSvc);&nbsp; </span></p>
</div>
<p>&nbsp;</p>
<p>Hope this helps you.</p>
<p>&nbsp;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Set filter for layer at runtime in Autodesk Infrastructure Map Server or MapGuide Enterprise
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 0
ALLOW PINGS: 0
BASENAME: set-filter-for-layer-at-runtime-in-autodesk-infrastructure-map-server-or-mapguide-open-source
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: Daniel Du
CATEGORY: MapGuide Enterprise 2011

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/04/set-filter-for-layer-at-runtime-in-autodesk-infrastructure-map-server-or-mapguide-open-source.html 
DATE: 04/10/2012 11:04:59 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html" target="_self">Daniel Du</a></p>
<p>When developing application on Autodesk Infrastructure Map Server, you may want to apply a filter to a layer to hide some features. In this post, I will demonstrate how to do this programmatically.</p>
<p>&nbsp;</p>
<h4>How to do in Infrastructure Studio UI</h4>
<p>Firstly, let’s take a look how we can do the same using Infrastructure Studio UI. Open the layer in Infrastructure Studio, you will notice that you can set filter for layer by setting “Filter applied to data”, click the “…” button to open the expression editor, which helps you create filter string more easier. In this case, I set a filter for parcels layer:</p>
<p>Autogenerated_SDF_ID&nbsp; &gt; 10000</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b016764b71663970b-pi"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0168e9b80b83970c-pi" border="0" alt="image" width="478" height="279" /></a></p>
<p>If you save the changes and click “refresh” button in layer preview, you will notice that the layer is filtered.</p>
<p>Where is this filter stored? It is stored in Infrastructure Map Server <em>repository.</em> An Infrastructure Map Server repository is a XML database that stores and manages the data for the site. The repository stores all data except data that is stored in external databases. Data stored in a repository is a resource.<em> </em>Let’s look at the resource content in MapAgent. Open the mapagent(<a title="http://localhost/mapserver2012/mapagent/index.html" href="http://localhost/mapserver2012/mapagent/index.html">http://localhost/mapserver2012/mapagent/index.html</a>), select “Resource” from Services API and “GetResourceContent” from left-bottom frame, input the resource ID of parcel layer. For those who don’t know, you can right click the layer name in Site Explorer and select “properties” to get the resource id., Then click “submit” button, you will get the xml representation of the layer definition resource as following:     <br /><span class="kwrd">&lt;?</span><span class="html">xml</span> <span class="attr">version</span><span class="kwrd">="1.0"</span> <span class="attr">encoding</span><span class="kwrd">="UTF-8"</span> ?<span class="kwrd">&gt;</span> <br /><span class="kwrd">&lt;</span><span class="html">LayerDefinition</span> <span class="attr">xmlns:xsi</span><span class="kwrd">="http://www.w3.org/2001/XMLSchema-instance"</span> <br />&nbsp;&nbsp; <span class="attr">mlns:xsd</span><span class="kwrd">="http://www.w3.org/2001/XMLSchema"</span> <br />&nbsp;&nbsp; <span class="attr">xsi:noNamespaceSchemaLocation</span><span class="kwrd">="LayerDefinition-2.3.0.xsd"</span> <br />&nbsp;&nbsp; <span class="attr">version</span><span class="kwrd">="2.3.0"</span><span class="kwrd">&gt;</span> <br /><span class="kwrd">&lt;</span><span class="html">VectorLayerDefinition</span><span class="kwrd">&gt;</span> <br />&nbsp;&nbsp; <span class="kwrd">&lt;</span><span class="html">ResourceId</span><span class="kwrd">&gt;</span> <br />&nbsp;&nbsp;&nbsp;&nbsp; Library://Samples/Sheboygan/Data/Parcels.FeatureSource     <br />&nbsp; <span class="kwrd">&lt;/</span><span class="html">ResourceId</span><span class="kwrd">&gt;</span> <br />&nbsp; <span class="kwrd">&lt;</span><span class="html">Watermarks</span> <span class="kwrd">/&gt;</span> <br />&nbsp; <span class="kwrd">&lt;</span><span class="html">FeatureName</span><span class="kwrd">&gt;</span>SHP_Schema:Parcels<span class="kwrd">&lt;/</span><span class="html">FeatureName</span><span class="kwrd">&gt;</span> <br />&nbsp; <span class="kwrd">&lt;</span><span class="html">FeatureNameType</span><span class="kwrd">&gt;</span>FeatureClass<span class="kwrd">&lt;/</span><span class="html">FeatureNameType</span><span class="kwrd">&gt;</span> <br /><span style="background-color: #ffff00;">&nbsp; <span class="kwrd">&lt;</span><span class="html">Filter</span><span class="kwrd">&gt;</span> <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Autogenerated_SDF_ID <span style="color: #0000ff;">&amp;gt;</span> 10000       <br />&nbsp; <span class="kwrd">&lt;/</span><span class="html">Filter</span><span class="kwrd">&gt;</span></span> <br />...</p>
<p>The filter is stored in &lt;Filter&gt; section.&nbsp; We did the modification from Infrastructure Studio, it applies to library repository, that means it affects all users.</p>
<p>&nbsp;</p>
<h4>Some background knowledge</h4>
<p>There are two types of repository in Infrastructure Map Server: Library and Session. Persistent data that is available to all users is stored in the Library repository. In addition, each session has its own repository, which stores the run-time map state. It can also be used to store other data, like temporary layers that apply only to an individual session. For example, a temporary layer might be used to overlay map symbols indicating places of interest. Data in a session repository is destroyed when the session ends.</p>
<p>A resource identifier for a resource in the Library will always begin with Library://. For example:</p>
<blockquote>
<p><a name="WS73099CC142F48755F31EC6111B3CB055B2A7D"></a>Library://Samples/Layouts/SamplesPhp.WebLayout</p>
</blockquote>
<p><a name="WS73099CC142F48755F31EC6111B3CB055B2A7E"></a>A resource identifier for a session resource will always begin with Session:, followed by the session id. For example:</p>
<blockquote>
<p><a name="WS73099CC142F48755F31EC6111B3CB055B2A7F"></a>Session:70ea89fe-0000-1000-8000-005056c00008_en//layer.LayerDefinition</p>
</blockquote>
<p>We can get the content of the specified resource by :</p>
<p>MgByteReader GetResourceContent(    <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MgResourceIdentifier resource);</p>
<p>And we can add a new resource to a resource repository, or updates an existing resource by:</p>
<p><span class="kwrd">virtual</span> <span class="kwrd">void</span> SetResource(</p>
<blockquote>
<p>MgResourceIdentifier resource,      <br />MgByteReader content,       <br />MgByteReader header);</p>
<p>&nbsp;</p>
</blockquote>
<h4>How to do programmatically at runtime</h4>
<p>Since we are going to set the filter at runtime, we will not want to change the library resource, otherwise it confuses other users. The solution is to make a copy of the layer as a temporary layer, and change the value of &lt;Filter&gt; tag programmatically, it only applies to the user who is setting the filter.</p>
<p>Now let’s do it step by step. Firstly create an web application, add references to Infrastructure Map Server Web Extension API dlls, and add a custom page names as “LayerFilter.aspx”, then add a custom command with “invoke URL” type and add it to web layout in Infrastructure Studio. If you are not familiar with this process, please refer to following DevTV:</p>
<p><strong>Video : Autodesk® Infrastructure Map Server 2012 API Webcast      <br /></strong>Recorded version of the Autodesk® Infrastructure Map Server 2012 API webcast     <br /><a href="http://download.autodesk.com/media/adn/AIMS2012_Webcast_English/AIMS2012_Webcast_English.html">View online</a> | <a href="http://download.autodesk.com/media/adn/AIMS2012_Webcast_English.zip">Download</a></p>
<p>&nbsp;</p>
<p>Here is the aspx code of “LayerFilter.aspx”, please note that we need to refresh the map to make it take effect after changing the layer, so we need</p>
<p>&nbsp;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black;">
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">&lt;</span><span style="color: maroon; line-height: 140%;">body</span><span style="line-height: 140%;"> </span><span style="color: red; line-height: 140%;">onload</span><span style="color: blue; line-height: 140%;">="parent.parent.Refresh();"&gt;</span></p>
</div>
<p>&nbsp;</p>
<p>Here is the complete code :</p>
<div style="font-family: courier new; color: black; font-size: 8pt;">
<p style="margin: 0px;"><span style="line-height: 140%; background: yellow;">&lt;%</span><span style="line-height: 140%; color: blue;">@</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: maroon;">Page</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: red;">Language</span><span style="line-height: 140%; color: blue;">="C#"</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: red;">AutoEventWireup</span><span style="line-height: 140%; color: blue;">="true"</span><span style="line-height: 140%;"> </span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: red;">CodeBehind</span><span style="line-height: 140%; color: blue;">="LayerFilter.aspx.cs"</span><span style="line-height: 140%;"> </span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: red;">Inherits</span><span style="line-height: 140%; color: blue;">="LayerFilterSample.LayerFilter"</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; background: yellow;">%&gt;</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&lt;!</span><span style="line-height: 140%; color: maroon;">DOCTYPE</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: red;">html</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: red;">PUBLIC</span><span style="line-height: 140%;"> </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">"-//W3C//DTD XHTML 1.0 Transitional//EN"</span><span style="line-height: 140%;"> </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&lt;</span><span style="line-height: 140%; color: maroon;">html</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: red;">xmlns</span><span style="line-height: 140%; color: blue;">="http://www.w3.org/1999/xhtml"&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&lt;</span><span style="line-height: 140%; color: maroon;">head</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: red;">runat</span><span style="line-height: 140%; color: blue;">="server"&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">&lt;</span><span style="line-height: 140%; color: maroon;">title</span><span style="line-height: 140%; color: blue;">&gt;&lt;/</span><span style="line-height: 140%; color: maroon;">title</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&lt;/</span><span style="line-height: 140%; color: maroon;">head</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&lt;</span><span style="line-height: 140%; color: maroon;">body</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: red;">onload</span><span style="line-height: 140%; color: blue;">="parent.parent.Refresh();"&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">&lt;</span><span style="line-height: 140%; color: maroon;">form</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: red;">id</span><span style="line-height: 140%; color: blue;">="form1"</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: red;">runat</span><span style="line-height: 140%; color: blue;">="server"&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">&lt;</span><span style="line-height: 140%; color: maroon;">div</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Layer to filter:</span><span style="line-height: 140%; color: red;">&amp;nbsp;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">&lt;</span><span style="line-height: 140%; color: maroon;">asp</span><span style="line-height: 140%; color: blue;">:</span><span style="line-height: 140%; color: maroon;">TextBox</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: red;">ID</span><span style="line-height: 140%; color: blue;">="tbLayer"</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: red;">runat</span><span style="line-height: 140%; color: blue;">="server"&gt;</span><span style="line-height: 140%;">Parcels</span><span style="line-height: 140%; color: blue;">&lt;/</span><span style="line-height: 140%; color: maroon;">asp</span><span style="line-height: 140%; color: blue;">:</span><span style="line-height: 140%; color: maroon;">TextBox</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">&lt;</span><span style="line-height: 140%; color: maroon;">br</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">/&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">&lt;</span><span style="line-height: 140%; color: maroon;">br</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">/&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Filter string:</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">&lt;</span><span style="line-height: 140%; color: maroon;">asp</span><span style="line-height: 140%; color: blue;">:</span><span style="line-height: 140%; color: maroon;">TextBox</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: red;">ID</span><span style="line-height: 140%; color: blue;">="tbFilter"</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: red;">runat</span><span style="line-height: 140%; color: blue;">="server"</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: red;">Width</span><span style="line-height: 140%; color: blue;">="387px"&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Autogenerated_SDF_ID </span><span style="line-height: 140%; color: red;">&amp;gt;</span><span style="line-height: 140%;"> 10000</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">&lt;/</span><span style="line-height: 140%; color: maroon;">asp</span><span style="line-height: 140%; color: blue;">:</span><span style="line-height: 140%; color: maroon;">TextBox</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">&lt;</span><span style="line-height: 140%; color: maroon;">br</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">/&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try: Autogenerated_SDF_ID </span><span style="line-height: 140%; color: red;">&amp;gt;</span><span style="line-height: 140%;"> 10000</span><span style="line-height: 140%; color: blue;">&lt;</span><span style="line-height: 140%; color: maroon;">br</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">/&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">&lt;</span><span style="line-height: 140%; color: maroon;">br</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">/&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">&lt;</span><span style="line-height: 140%; color: maroon;">asp</span><span style="line-height: 140%; color: blue;">:</span><span style="line-height: 140%; color: maroon;">Button</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: red;">ID</span><span style="line-height: 140%; color: blue;">="tbOK"</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: red;">runat</span><span style="line-height: 140%; color: blue;">="server"</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: red;">onclick</span><span style="line-height: 140%; color: blue;">="tbOK_Click"</span><span style="line-height: 140%;"> </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: red;">Text</span><span style="line-height: 140%; color: blue;">="OK"</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: red;">Width</span><span style="line-height: 140%; color: blue;">="94px"</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">/&gt;</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">&lt;/</span><span style="line-height: 140%; color: maroon;">div</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">&lt;/</span><span style="line-height: 140%; color: maroon;">form</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&lt;/</span><span style="line-height: 140%; color: maroon;">body</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">&lt;/</span><span style="line-height: 140%; color: maroon;">html</span><span style="line-height: 140%; color: blue;">&gt;</span></p>
<p style="margin: 0px;">&nbsp;</p>
</div>
<p>Here is the code behind:</p>
<div style="font-family: courier new; color: black; font-size: 8pt;">
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> System;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> System.Collections.Generic;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> System.Linq;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> System.Web;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> System.Web.UI;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> System.Web.UI.WebControls;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> OSGeo.MapGuide;</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">namespace</span><span style="line-height: 140%;"> LayerFilterSample</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">public</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">partial</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">class</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">LayerFilter</span><span style="line-height: 140%;"> </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : System.Web.UI.</span><span style="line-height: 140%; color: #2b91af;">Page</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">const</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> viewerPathSchema </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = </span><span style="line-height: 140%; color: #a31515;">"http://localhost/mapserver2012/mapviewernet/"</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; + </span><span style="line-height: 140%; color: #a31515;">"ajaxviewer.aspx?SESSION={0}&amp;WEBLAYOUT={1}"</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">Utility</span><span style="line-height: 140%;"> utility = </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">Utility</span><span style="line-height: 140%;">();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> mapName = </span><span style="line-height: 140%; color: #a31515;">"Sheboygan"</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">protected</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">void</span><span style="line-height: 140%;"> Page_Load(</span><span style="line-height: 140%; color: blue;">object</span><span style="line-height: 140%;"> sender, </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">EventArgs</span><span style="line-height: 140%;"> e)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">if</span><span style="line-height: 140%;"> (!IsPostBack)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> session = </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Request.Form.Get(</span><span style="line-height: 140%; color: #a31515;">"SESSION"</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Session[</span><span style="line-height: 140%; color: #a31515;">"MgSession"</span><span style="line-height: 140%;">] = session;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">if</span><span style="line-height: 140%;"> (session != </span><span style="line-height: 140%; color: blue;">null</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; utility.InitializeWebTier(Request);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; utility.ConnectToServer(session);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">protected</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">void</span><span style="line-height: 140%;"> tbOK_Click(</span><span style="line-height: 140%; color: blue;">object</span><span style="line-height: 140%;"> sender, </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">EventArgs</span><span style="line-height: 140%;"> e)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> layerName = tbLayer.Text;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> strFilter = </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Server.HtmlEncode(tbFilter.Text);</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> session = </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Session[</span><span style="line-height: 140%; color: #a31515;">"MgSession"</span><span style="line-height: 140%;">].ToString();</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">Utility</span><span style="line-height: 140%;"> utility = </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">Utility</span><span style="line-height: 140%;">();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; utility.InitializeWebTier(Request);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; utility.ConnectToServer(session);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">MgSiteConnection</span><span style="line-height: 140%;"> siteConnection = </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; utility.GetSiteConnection();</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> webLayout = </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Session[</span><span style="line-height: 140%; color: #a31515;">"InitWebLayout"</span><span style="line-height: 140%;">].ToString();</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> layerDefId = utility</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .GetLayerDefinitionResourceId(</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; layerName,</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; session,</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mapName);</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: green;">//create a filtered session layer defination </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> sessionLayerId = utility</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .SetFilterForLayer(session, </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; layerDefId, </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strFilter);</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: green;">//create a session layer object, </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: green;">//replace it with the library layer</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; utility.ReplaceWithFilteredLayer(</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; session,</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sessionLayerId,</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; layerName, </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mapName);</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
<p>Here is the implementation of Utility class:</p>
<div style="font-family: courier new; color: black; font-size: 8pt;">
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> System;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> System.Collections.Generic;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> System.Web;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> System.Collections;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> System.Xml;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> System.IO;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> System.Text;</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> OSGeo.MapGuide;</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%; color: gray;">///</span><span style="line-height: 140%; color: green;"> </span><span style="line-height: 140%; color: gray;">&lt;summary&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: gray;">///</span><span style="line-height: 140%; color: green;"> Summary description for Utility.</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: gray;">///</span><span style="line-height: 140%; color: green;"> Created by Daniel Du, DevTech</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: gray;">///</span><span style="line-height: 140%; color: green;"> </span><span style="line-height: 140%; color: gray;">&lt;/summary&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">public</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">class</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">Utility</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">MgSiteConnection</span><span style="line-height: 140%;"> siteConnection;</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">public</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">void</span><span style="line-height: 140%;"> InitializeWebTier(</span><span style="line-height: 140%; color: #2b91af;">HttpRequest</span><span style="line-height: 140%;"> Request)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> realPath = </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Request.ServerVariables[</span><span style="line-height: 140%; color: #a31515;">"APPL_PHYSICAL_PATH"</span><span style="line-height: 140%;">];</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">String</span><span style="line-height: 140%;"> configPath = realPath + </span><span style="line-height: 140%; color: #a31515;">"../webconfig.ini"</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">MapGuideApi</span><span style="line-height: 140%;">.MgInitializeWebTier(configPath);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; }</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">public</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">void</span><span style="line-height: 140%;"> ConnectToServer(</span><span style="line-height: 140%; color: #2b91af;">String</span><span style="line-height: 140%;"> sessionID)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">MgUserInformation</span><span style="line-height: 140%;"> userInfo = </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">MgUserInformation</span><span style="line-height: 140%;">(sessionID);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; siteConnection = </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">MgSiteConnection</span><span style="line-height: 140%;">();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; siteConnection.Open(userInfo);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; }</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">public</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">MgSiteConnection</span><span style="line-height: 140%;"> GetSiteConnection()</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">return</span><span style="line-height: 140%;"> siteConnection;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; }</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">public</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">MgByteSource</span><span style="line-height: 140%;"> ByteSourceFromXMLDoc(</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">XmlDocument</span><span style="line-height: 140%;"> xmlDoc)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: green;">//Save the amended DOM object to a memory stream</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">MemoryStream</span><span style="line-height: 140%;"> XmlStream = </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">MemoryStream</span><span style="line-height: 140%;">();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xmlDoc.Save(XmlStream);</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: green;">//Now get the memory stream into a byte array </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: green;">//that can be read into an MgByteSource</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">byte</span><span style="line-height: 140%;">[] byteNewDef = XmlStream.ToArray();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">String</span><span style="line-height: 140%;"> sNewDef = </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">String</span><span style="line-height: 140%;">(</span><span style="line-height: 140%; color: #2b91af;">Encoding</span><span style="line-height: 140%;">.UTF8</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .GetChars(byteNewDef));</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">byte</span><span style="line-height: 140%;">[] byteNewDef2 = </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">byte</span><span style="line-height: 140%;">[byteNewDef.Length - 1];</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">int</span><span style="line-height: 140%;"> iNewByteCount = </span><span style="line-height: 140%; color: #2b91af;">Encoding</span><span style="line-height: 140%;">.UTF8</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .GetBytes(sNewDef, 1, sNewDef.Length - 1,</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; byteNewDef2, 0);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">MgByteSource</span><span style="line-height: 140%;"> byteSource = </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">MgByteSource</span><span style="line-height: 140%;">(byteNewDef2, </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; byteNewDef2.Length);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; byteSource.SetMimeType(</span><span style="line-height: 140%; color: #2b91af;">MgMimeType</span><span style="line-height: 140%;">.Xml);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">return</span><span style="line-height: 140%;"> byteSource;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; }</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">public</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">static</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> GetStringFromMemoryStream(</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">MemoryStream</span><span style="line-height: 140%;"> m)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">if</span><span style="line-height: 140%;"> (m == </span><span style="line-height: 140%; color: blue;">null</span><span style="line-height: 140%;"> || m.Length == 0)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">return</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">null</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; m.Flush();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; m.Position = 0;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">StreamReader</span><span style="line-height: 140%;"> sr = </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">StreamReader</span><span style="line-height: 140%;">(m);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> s = sr.ReadToEnd();</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">return</span><span style="line-height: 140%;"> s;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; }</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">public</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">static</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">MemoryStream</span><span style="line-height: 140%;"> </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; GetMemoryStreamFromString(</span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> s)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">if</span><span style="line-height: 140%;"> (s == </span><span style="line-height: 140%; color: blue;">null</span><span style="line-height: 140%;"> || s.Length == 0)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">return</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">null</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">MemoryStream</span><span style="line-height: 140%;"> m = </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">MemoryStream</span><span style="line-height: 140%;">();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">StreamWriter</span><span style="line-height: 140%;"> sw = </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">StreamWriter</span><span style="line-height: 140%;">(m);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sw.Write(s);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sw.Flush();</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">return</span><span style="line-height: 140%;"> m;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; }</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%; color: green;">&nbsp;</span></p>
<p>&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">private</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">static</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> GetXmlFromByteReader(</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">MgByteReader</span><span style="line-height: 140%;"> reader)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.IO.</span><span style="line-height: 140%; color: #2b91af;">MemoryStream</span><span style="line-height: 140%;"> ms = </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> System.IO.</span><span style="line-height: 140%; color: #2b91af;">MemoryStream</span><span style="line-height: 140%;">();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">byte</span><span style="line-height: 140%;">[] buf = </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">byte</span><span style="line-height: 140%;">[8 * 1024];</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">int</span><span style="line-height: 140%;"> read = 1;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">while</span><span style="line-height: 140%;"> (read != 0)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; read = reader.Read(buf, buf.Length);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ms.Write(buf, 0, read);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> layoutXml = GetStringFromMemoryStream(ms);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">return</span><span style="line-height: 140%;"> layoutXml;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; }</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: gray;">///</span><span style="line-height: 140%; color: green;"> </span><span style="line-height: 140%; color: gray;">&lt;summary&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: gray;">///</span><span style="line-height: 140%; color: green;"> use a layer in reposorty as template, </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: gray;">///</span><span style="line-height: 140%; color: green;"> to create a temp layer </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: gray;">///</span><span style="line-height: 140%; color: green;"> with filter, and set resource in repository</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: gray;">///</span><span style="line-height: 140%; color: green;"> </span><span style="line-height: 140%; color: gray;">&lt;/summary&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: gray;">///</span><span style="line-height: 140%; color: green;"> </span><span style="line-height: 140%; color: gray;">&lt;param name="map"&gt;&lt;/param&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: gray;">///</span><span style="line-height: 140%; color: green;"> </span><span style="line-height: 140%; color: gray;">&lt;param name="layerResId"&gt;</span><span style="line-height: 140%; color: green;">the resource id </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: gray;">///</span><span style="line-height: 140%; color: green;">&nbsp;&nbsp;&nbsp;&nbsp; of template layer defination </span><span style="line-height: 140%; color: gray;">&lt;/param&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: gray;">///</span><span style="line-height: 140%; color: green;"> </span><span style="line-height: 140%; color: gray;">&lt;param name="strFilter"&gt;</span><span style="line-height: 140%; color: green;">filter string</span><span style="line-height: 140%; color: gray;">&lt;/param&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: gray;">///</span><span style="line-height: 140%; color: green;"> </span><span style="line-height: 140%; color: gray;">&lt;returns&gt;</span><span style="line-height: 140%; color: green;">resource id of temp layer in </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: gray;">///</span><span style="line-height: 140%; color: green;">&nbsp;&nbsp;&nbsp;&nbsp; repository</span><span style="line-height: 140%; color: gray;">&lt;/returns&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">public</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> SetFilterForLayer(</span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> sessionId, </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> layerResId, </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> strFilter)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">if</span><span style="line-height: 140%;"> (siteConnection == </span><span style="line-height: 140%; color: blue;">null</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">MgUserInformation</span><span style="line-height: 140%;"> userInfo = </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">MgUserInformation</span><span style="line-height: 140%;">(sessionId);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; siteConnection = </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">MgSiteConnection</span><span style="line-height: 140%;">();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; siteConnection.Open(userInfo);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">MgResourceIdentifier</span><span style="line-height: 140%;"> templateLayerId </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">MgResourceIdentifier</span><span style="line-height: 140%;">(layerResId);</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">MgResourceService</span><span style="line-height: 140%;"> resSvc = siteConnection</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .CreateService(</span><span style="line-height: 140%; color: #2b91af;">MgServiceType</span><span style="line-height: 140%;">.ResourceService) </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">as</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">MgResourceService</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: green;">//the resource content of LayerDefinition</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">MgByteReader</span><span style="line-height: 140%;"> reader = resSvc</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .GetResourceContent(templateLayerId);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> layoutXml = GetXmlFromByteReader(reader);</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: green;">//Edit the map resource in XmlDocument in DOM</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">XmlDocument</span><span style="line-height: 140%;"> doc = </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">XmlDocument</span><span style="line-height: 140%;">();</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; doc.LoadXml(layoutXml);</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">XmlNodeList</span><span style="line-height: 140%;"> objNodeList = </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; doc.SelectNodes(</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #a31515;">"//VectorLayerDefinition/Filter"</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">if</span><span style="line-height: 140%;"> (objNodeList.Count &gt; 0)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; objNodeList.Item(0).InnerXml = strFilter;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">else</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">XmlNode</span><span style="line-height: 140%;"> filterNode;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; filterNode = doc.CreateElement(</span><span style="line-height: 140%; color: #a31515;">"Filter"</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; filterNode.InnerText = strFilter;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; doc.GetElementsByTagName</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (</span><span style="line-height: 140%; color: #a31515;">"VectorLayerDefinition"</span><span style="line-height: 140%;">)[0]</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .AppendChild(filterNode);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">MgByteSource</span><span style="line-height: 140%;"> byteSource = ByteSourceFromXMLDoc(doc);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> sessionLayerName = templateLayerId.GetName();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> sessionLayer = </span><span style="line-height: 140%; color: #a31515;">"Session:"</span><span style="line-height: 140%;"> + sessionId </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; + </span><span style="line-height: 140%; color: #a31515;">@"//"</span><span style="line-height: 140%;"> + sessionLayerName + </span><span style="line-height: 140%; color: #a31515;">".LayerDefinition"</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">MgResourceIdentifier</span><span style="line-height: 140%;"> sessionLayerResId </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">MgResourceIdentifier</span><span style="line-height: 140%;">(sessionLayer);</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; resSvc.SetResource(sessionLayerResId, </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; byteSource.GetReader(), </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">null</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">return</span><span style="line-height: 140%;"> sessionLayer;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; }</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: gray;">///</span><span style="line-height: 140%; color: green;"> </span><span style="line-height: 140%; color: gray;">&lt;summary&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: gray;">///</span><span style="line-height: 140%; color: green;"> Create a MgLayer object using the session layer definition,</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: gray;">///</span><span style="line-height: 140%; color: green;"> Add it to MgMap and remove the original one</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: gray;">///</span><span style="line-height: 140%; color: green;"> </span><span style="line-height: 140%; color: gray;">&lt;/summary&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: gray;">///</span><span style="line-height: 140%; color: green;"> </span><span style="line-height: 140%; color: gray;">&lt;param name="sessionId"&gt;&lt;/param&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: gray;">///</span><span style="line-height: 140%; color: green;"> </span><span style="line-height: 140%; color: gray;">&lt;param name="sessionLayerResId"&gt;&lt;/param&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: gray;">///</span><span style="line-height: 140%; color: green;"> </span><span style="line-height: 140%; color: gray;">&lt;param name="originalLayerName"&gt;&lt;/param&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: gray;">///</span><span style="line-height: 140%; color: green;"> </span><span style="line-height: 140%; color: gray;">&lt;param name="mapName"&gt;&lt;/param&gt;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">public</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">void</span><span style="line-height: 140%;"> ReplaceWithFilteredLayer(&nbsp;&nbsp; </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> sessionId, </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> sessionLayerResId, </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> originalLayerName,</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> mapName)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">if</span><span style="line-height: 140%;"> (siteConnection == </span><span style="line-height: 140%; color: blue;">null</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">MgUserInformation</span><span style="line-height: 140%;"> userInfo = </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">MgUserInformation</span><span style="line-height: 140%;">(sessionId);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; siteConnection = </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">MgSiteConnection</span><span style="line-height: 140%;">();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; siteConnection.Open(userInfo);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">MgResourceService</span><span style="line-height: 140%;"> resSvc = siteConnection</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .CreateService(</span><span style="line-height: 140%; color: #2b91af;">MgServiceType</span><span style="line-height: 140%;">.ResourceService) </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">as</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">MgResourceService</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">MgResourceIdentifier</span><span style="line-height: 140%;"> filterLayerId = </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">MgResourceIdentifier</span><span style="line-height: 140%;">(sessionLayerResId);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">MgLayer</span><span style="line-height: 140%;"> filteredLayer = </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">MgLayer</span><span style="line-height: 140%;">(filterLayerId, resSvc);</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">MgMap</span><span style="line-height: 140%;"> map = </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">MgMap</span><span style="line-height: 140%;">();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; map.Open(resSvc, mapName);</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">MgLayer</span><span style="line-height: 140%;"> oriLayer;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">try</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oriLayer = map.GetLayers()</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .GetItem(originalLayerName) </span><span style="line-height: 140%; color: blue;">as</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">MgLayer</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">catch</span><span style="line-height: 140%;"> (</span><span style="line-height: 140%; color: #2b91af;">MgObjectNotFoundException</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oriLayer = map.GetLayers()</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .GetItem(originalLayerName + </span><span style="line-height: 140%; color: #a31515;">"_filtered"</span><span style="line-height: 140%;">) </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">as</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">MgLayer</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; originalLayerName = originalLayerName </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; + </span><span style="line-height: 140%; color: #a31515;">"_filtered"</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; filteredLayer.LegendLabel = </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oriLayer.LegendLabel.Contains(</span><span style="line-height: 140%; color: #a31515;">"_filtered"</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ? oriLayer.LegendLabel</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : oriLayer.LegendLabel + </span><span style="line-height: 140%; color: #a31515;">"_filtered"</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; filteredLayer.Selectable = oriLayer.Selectable;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; filteredLayer.DisplayInLegend = </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oriLayer.DisplayInLegend;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; filteredLayer.Name = </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oriLayer.Name.Contains(</span><span style="line-height: 140%; color: #a31515;">"_filtered"</span><span style="line-height: 140%;">) </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ? oriLayer.Name</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : oriLayer.Name + </span><span style="line-height: 140%; color: #a31515;">"_filtered"</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; filteredLayer.Group = oriLayer.Group;</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">int</span><span style="line-height: 140%;"> index = map.GetLayers()</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .IndexOf(originalLayerName);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; map.GetLayers().RemoveAt(index);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; map.GetLayers().Insert(index, filteredLayer);</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; map.Save(resSvc);</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; }</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">public</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> GetLayerDefinitionResourceId(</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> layerName,</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> sessionId, </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> mapName)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">if</span><span style="line-height: 140%;"> (siteConnection == </span><span style="line-height: 140%; color: blue;">null</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">MgUserInformation</span><span style="line-height: 140%;"> userInfo </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">MgUserInformation</span><span style="line-height: 140%;">(sessionId);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; siteConnection = </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">MgSiteConnection</span><span style="line-height: 140%;">();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; siteConnection.Open(userInfo);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">MgResourceService</span><span style="line-height: 140%;"> resSvc = siteConnection</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .CreateService(</span><span style="line-height: 140%; color: #2b91af;">MgServiceType</span><span style="line-height: 140%;">.ResourceService) </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">as</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">MgResourceService</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">MgMap</span><span style="line-height: 140%;"> map = </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">MgMap</span><span style="line-height: 140%;">();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; map.Open(resSvc, mapName);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">MgLayerCollection</span><span style="line-height: 140%;"> layerColl = map.GetLayers();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">foreach</span><span style="line-height: 140%;"> (</span><span style="line-height: 140%; color: #2b91af;">MgLayerBase</span><span style="line-height: 140%;"> ly </span><span style="line-height: 140%; color: blue;">in</span><span style="line-height: 140%;"> layerColl)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">if</span><span style="line-height: 140%;"> (ly.Name == layerName </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; || ly.Name == layerName + </span><span style="line-height: 140%; color: #a31515;">"_filtered"</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">return</span><span style="line-height: 140%;"> ly.GetLayerDefinition().ToString();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: blue;">return</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;">.Empty;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; }</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
<p style="margin: 0px;">&nbsp;</p>
</div>
<p>I have intentionally not performed a lot of error checking or exception handling in the code below. This was to keep the code snippets as simple as possible.</p>
<p>&nbsp;</p>
<h4>How it looks like</h4>
<p>Now I’d like to run this application and see how it looks like. Firstly I would like to set the filter string as “Autogenerated_SDF_ID &gt; 0 ”, I can see all parcels are displayed:</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b016303c2675c970d-pi"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0168e9b80bd8970c-pi" border="0" alt="image" width="446" height="297" /></a></p>
<p>Now I change the filter to Autogenerated_SDF_ID &gt; 10000, you will see that some of the parcels are filtered:</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0168e9b80bec970c-pi"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0168e9b80c00970c-pi" border="0" alt="image" width="437" height="291" /></a></p>
<p>At the same time, I open another browser(Firefox) to mimic another user, you will notice that the filter does not affect other users.</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0168e9b80c1f970c-pi"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b016764b716dd970b-pi" border="0" alt="image" width="435" height="293" /></a></p>
<p>&nbsp;</p>
<p>Hope this helps!</p>
<p>&nbsp;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Kent
EMAIL: kent@lake-eng.com
IP: 71.116.63.25
URL: 
DATE: 09/18/2012 11:57:12 AM
I need some help getting my flexible layout to work on a xp and ie 8 machine.  I get a fusionsf-compressed.js error
-----
COMMENT:
AUTHOR: Tom
EMAIL: thomas.croux@pt-consulting.eu
IP: 195.46.241.19
URL: 
DATE: 09/11/2013 06:47:56 AM
Dear Daniel, 

thank you very much for this sample, and the explanations.
I try to adapt this code to my needs, in AutoCAD Map 3D 2013.

In SetFilterForLayer method, when executing the final SetResource, I get an Exception telling me that the XML Layer Definition is incorrect. This Exception occurs even if I bypass the Xml Content modification (by appending the child filterNode). Even with the original XML content, I get the Exception.

OSGeo.MapGuide.MgInvalidArgumentException: Argument(s) incorrect(s):
La définition du calque XML est incorrecte.
   à OSGeo.MapGuide.MapApiPINVOKE.SWIGExceptionHelper.ThrowCustomException(String className, IntPtr cptr)
   à OSGeo.MapGuide.MapApiPINVOKE.AcMapResourceService_SetResource(IntPtr jarg1, IntPtr jarg2, IntPtr jarg3, IntPtr jarg4)
   à Autodesk.Gis.Map.Platform.AcMapResourceService.SetResource(MgResourceIdentifier resource, MgByteReader content, MgByteReader header)
   à Takm.AutoCadMap3D2013.TakmAutoCadHelper.SetFilterForLayer(String layerResId, String strFilter) dans D:\TAKM_PRODUCT\trunk\takm.AutoCAD_MAP_3D_2013\TakmAutocadHelper.cs:ligne 149
   à Takm.AutoCadMap3D2013.TakmAutoCad.TakmTestFilter() dans D:\TAKM_PRODUCT\trunk\takm.AutoCAD_MAP_3D_2013\TAKMAutoCAD.cs:ligne 663
   à Autodesk.AutoCAD.Runtime.CommandClass.InvokeWorker(MethodInfo mi, Object commandObject, Boolean bLispFunction)
   à Autodesk.AutoCAD.Runtime.CommandClass.InvokeWorkerWithExceptionFilter(MethodInfo mi, Object commandObject, Boolean bLispFunction)
   à Autodesk.AutoCAD.Runtime.PerDocumentCommandClass.Invoke(MethodInfo mi, Boolean bLispFunction)
   à Autodesk.AutoCAD.Runtime.CommandClass.CommandThunk.Invoke()

Below is the code I adapted from your one :

        public static String SetFilterForLayer(String layerResId, String strFilter)
        {
            MgResourceIdentifier templateLayerId = new MgResourceIdentifier(layerResId);
            MgResourceService resSvc = AcMapServiceFactory.GetService(MgServiceType.ResourceService) as MgResourceService;
            MgByteReader reader = resSvc.GetResourceContent(templateLayerId);
            string layoutXml = GetXmlFromByteReader(reader);

            XmlDocument doc = new XmlDocument();
            doc.LoadXml(layoutXml);
            XmlNodeList objNodeList = doc.SelectNodes("//VectorLayerDefinition/Filter");

            if (objNodeList.Count > 0)
            {
                objNodeList.Item(0).InnerXml = strFilter;
            }
            else
            {
                XmlNode filterNode;
                filterNode = doc.CreateElement("Filter");
                filterNode.InnerText = strFilter;
                doc.GetElementsByTagName("VectorLayerDefinition")[0].AppendChild(filterNode);
            }

            MgByteSource byteSource = ByteSourceFromXMLDoc(doc);
            string sessionLayerName = templateLayerId.GetName();
            string sessionLayer = @"Library://" + sessionLayerName + ".LayerDefinition";
            MgResourceIdentifier sessionLayerResId = new MgResourceIdentifier(sessionLayer);

            resSvc.SetResource(sessionLayerResId,byteSource.GetReader(),null);



            return sessionLayer;
        }



Do you have any idea ?
Thanks a lot again ;)

tom.
-----
COMMENT:
AUTHOR: Daniel Du
EMAIL: 
IP: 221.216.250.60
URL: http://profile.typepad.com/daniel_du
DATE: 09/11/2013 05:23:59 PM
Hi Tom,

For AutoCAD Map 3D, there is no concept of "session layer", so you cannot use code snippet like below: 

string sessionLayerName = templateLayerId.GetName();
string sessionLayer = @"Library://" + sessionLayerName + ".LayerDefinition";
MgResourceIdentifier sessionLayerResId = new MgResourceIdentifier(sessionLayer);

resSvc.SetResource(sessionLayerResId,byteSource.GetReader(),null);

You have to change the layer definition of library resources.

PS. blog is not a good place for technical support, if you have question, you are recommended to go to forums.autodesk.com or ADN if you are a member. 

-----
COMMENT:
AUTHOR: Anil Kumar K B
EMAIL: anilkb1105@gmail.com
IP: 183.83.59.62
URL: 
DATE: 11/07/2013 07:51:12 PM
Hi, Could you please help me on the query below.

For displaying the pole symbol over PGIS Browser Web Application i have configured the pole layer in MapGuide Studio and when i am trying to set the query conditions like POLE_CLASS ='NULL' to display the pole symbol for the pole_class null its not reflecting over Application.

But for other query conditions like POLE_CLASS in ('SB', 'CB','SWR') its working fine.

Could you please help me on this.
-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Multiline Tool-tip in Autodesk Infrastructure Map Server / MapGuide Enterprise
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 0
ALLOW PINGS: 0
BASENAME: multiline-tool-tip-in-autodesk-infrastructure-map-server-mapguide-enterprise
CATEGORY: AIMS 2012
CATEGORY: AIMS 2013
CATEGORY: MapGuide Enterprise 2011
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/04/multiline-tool-tip-in-autodesk-infrastructure-map-server-mapguide-enterprise.html 
DATE: 04/09/2012 11:13:19 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p style="text-align: justify;">If you are looking for a way to create a multiline mouse over Tool tip for your map in Autodesk Infrastructure Map Server / MapGuide Enterprise, here is the trick.</p>
<p style="text-align: justify;">You can use '\n' to create a new line for mouse-over tool tip. Here is an example expression :</p>
<p style="text-align: justify;"><strong>concat("APN", concat('\nArea : ', concat("AREA", concat('\nAcres: ', concat("ACRES", concat('\nValue: $', ( "LAND_VALUE")))))))</strong></p>
<p style="text-align: justify;"><strong>&nbsp;</strong> <a class="asset-img-link" style="display: inline;" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b016303eb7267970d-pi"><img class="asset  asset-image at-xid-6a0167607c2431970b016303eb7267970d image-full" title="Tool tip exp" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b016303eb7267970d-800wi" border="0" alt="Tool tip exp" /></a><br /><br /><br />Here is the screenshot of multiline mouse over tool tip created using the above expression -</p>
<p style="text-align: justify;">&nbsp;</p>
<p style="text-align: justify;"><a class="asset-img-link" style="display: inline;" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b016303eb7302970d-pi"><img class="asset  asset-image at-xid-6a0167607c2431970b016303eb7302970d image-full" title="Tooltip" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b016303eb7302970d-800wi" border="0" alt="Tooltip" /></a><br /><br /><br /></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:
Tool tip, Expression, Concat
-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Importance of Autodesk.Map.Platform assembly in AutoCAD Map 3D 2013
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 0
ALLOW PINGS: 0
BASENAME: importance-of-autodeskmapplatform-assembly-in-autocad-map-3d-2013
CATEGORY: AutoCAD Map 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/04/importance-of-autodeskmapplatform-assembly-in-autocad-map-3d-2013.html 
DATE: 04/06/2012 08:14:08 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>In AutoCAD Map 3D 2012 or 2011, <em><strong>Autodesk.Gis.Map.Platform</strong></em> namespace was part of <strong>Autodesk.Map.Platform.Core</strong> Assembly (Autodesk.Map.Platform.Core.dll) located in Map 3D's installation folder. While building application which uses Geospatial Platform API, we had to add reference to Autodesk.Map.Platform.Core.dll. This API assembly used to give access to all the important objects in Platform API.</p>
<p><br />There is a change in AutoCAD Map 3D 2013; now <em><strong>Autodesk.Gis.Map.Platform</strong></em> namespace is member of <strong>Autodesk.Map.Platform</strong> Assembly (<strong>Autodesk.Map.Platform.dll</strong>). In AutoCAD Map 3D 2013, there is no Autodesk.Map.Platform.Core.dll. To migrate your current application (working in Map 3D 2012 / 2011) you need to change the reference to <span style="text-decoration: underline;">Autodesk.Map.Platform.dll</span> assembly in Map 3D 2013. And to build a new application using Geospatial Platform API, simply add reference to Autodesk.Map.Platform.dll<br /><br /><br /></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Marat Mirgaleev
AUTHOR EMAIL: marat.mirgaleev@autodesk.com
TITLE: Civil 3D .NET API: Is there any simple way to copy a style to the same drawing?
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 0
ALLOW PINGS: 0
BASENAME: civil-3d-net-api-is-there-any-simple-way-to-copy-a-style-to-the-same-drawing
CATEGORY: AutoCAD Civil 3D 2011
CATEGORY: AutoCAD Civil 3D 2012
CATEGORY: AutoCAD Civil 3D 2013

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/04/civil-3d-net-api-is-there-any-simple-way-to-copy-a-style-to-the-same-drawing.html 
DATE: 04/05/2012 01:24:59 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/marat-mirgaleev.html" target="_self">Marat Mirgaleev</a></p>
<p>There is a method which copies a Civil 3D style object from one drawing to another – this is StyleBase::ExportTo(). It is helpful for copying any kind of styles, such as Label styles, Surface styles or others. But when you use this method to copy a style to the same drawing, it may fail.</p>
<p>The reason for this is that the ExportTo() method was not designed to export styles to the same drawings.</p>
<p>Instead of this, we can use StyleBase::CopyAsSibling(). Here is a code snippet :</p>
<div style="font-family: courier new; background: white; color: black; font-size: 8pt;">
<p style="margin: 0px;"><span style="line-height: 140%; color: #2b91af;">Database</span><span style="line-height: 140%;"> db = </span><span style="line-height: 140%; color: #2b91af;">HostApplicationServices</span><span style="line-height: 140%;">.WorkingDatabase;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> (</span><span style="line-height: 140%; color: #2b91af;">Transaction</span><span style="line-height: 140%;"> ts = </span><span style="line-height: 140%; color: #2b91af;">HostApplicationServices</span><span style="line-height: 140%;">.WorkingDatabase.</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TransactionManager.StartTransaction())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="line-height: 140%; color: #2b91af;">ObjectId</span><span style="line-height: 140%;"> id = </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="line-height: 140%; color: #2b91af;">CivilApplication</span><span style="line-height: 140%;">.ActiveDocument.Styles.AlignmentStyles[0];</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="line-height: 140%; color: #2b91af;">AlignmentStyle</span><span style="line-height: 140%;"> alignStyle = </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; id.GetObject(</span><span style="line-height: 140%; color: #2b91af;">OpenMode</span><span style="line-height: 140%;">.ForWrite) </span><span style="line-height: 140%; color: blue;">as</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">AlignmentStyle</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; alignStyle.CopyAsSibling(</span><span style="line-height: 140%; color: #a31515;">"newStyle_CopyAlignmentStyle"</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; ts.Commit();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
<p style="margin: 0px;">&nbsp;</p>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:
Copy, Style, .NET API
-----
COMMENT:
AUTHOR: Miroslav Vrabec
EMAIL: 
IP: 195.93.192.195
URL: http://profile.typepad.com/6p01a3fd417d42970b
DATE: 04/09/2015 05:09:17 AM
Tanks Alot!! Really needed just this piece of code to make a copy pipe network to another drawing with same style plug in :))
-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: .NET API namespace simplification in AutoCAD Civil 3D 2013
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 0
ALLOW PINGS: 0
BASENAME: net-api-namespace-simplification-in-autocad-civil-3d-2013
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/04/net-api-namespace-simplification-in-autocad-civil-3d-2013.html 
DATE: 04/04/2012 04:03:04 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>AutoCAD Civil 3D 2013 release introduces a namespace restructuring that simplifies referencing objects. We have fewer namespaces in AutoCAD Civil 3D .NET API assembly (AeccDbMgd.dll) compared to a long list of the namespaces in 2012 or earlier release. Here is the first look of the simplified namespaces in Civil 3D 2013 .NET API -</p>
<p><a class="asset-img-link" style="display: inline;" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b016764a0861d970b-pi"><img class="asset  asset-image at-xid-6a0167607c2431970b016764a0861d970b" title="C3D2013_API_Namespace" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b016764a0861d970b-800wi" border="0" alt="C3D2013_API_Namespace" /></a><br /><br /><br />And here is the long list of the namespaces in Civil 3D 2012 .NET API -</p>
<p><a class="asset-img-link" style="display: inline;" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0168e9a1905d970c-pi"><img class="asset  asset-image at-xid-6a0167607c2431970b0168e9a1905d970c" title="C3D2012_API_Namespace" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0168e9a1905d970c-800wi" border="0" alt="C3D2012_API_Namespace" /></a></p>
<p><br />You can see clearly that in AutoCAD Civil 3D 2013 release, all the feature name/domain levels (e.g. Land, PipeNetwork, Roadway...) are removed from the namespaces. This change will necessitate your existing projects to be rebuilt by updating the new namespaces. This restructuring of the namespaces will improve the usability by grouping related classes into the same namespace. Currently, some classes need to access other namespaces to work with certain types. With the new structure, all related classes will be grouped in the same namespace, which will simplify the usage.</p>
<p><br /><br /></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Adding a new Alignment Design Checks using Civil 3D API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 0
ALLOW PINGS: 0
BASENAME: adding-a-new-alignment-design-checks-using-civil-3d-api
CATEGORY: AutoCAD Civil 3D 2011
CATEGORY: AutoCAD Civil 3D 2012
CATEGORY: AutoCAD Civil 3D 2013
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/04/adding-a-new-alignment-design-checks-using-civil-3d-api.html 
DATE: 04/03/2012 03:14:00 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>In AutoCAD Civil 3D's Toolspace -&gt; Settings Tabs when you expand the collection items under Alignment, you would see a set of object collection like the Alignment Styles, Design Checks, Label styles etc. Under the Design Checks collection you would see objects like "Design Check Sets", "Line", "Curve", "Spiral" etc. You intend to add a new Line Design Check item with a custom Expression or a new Curve Design Check item with a custom Expression / Formula.&nbsp;</p>
<p>The trick of adding a new Design Checks is exploring the <em><strong>AlignmentDesignCheckRoot</strong></em> Object.</p>
<p>Here is a VB.NET code snippet which demonstrates how to add new Alignment Design Checks using Civil 3D .NET API.</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: blue; line-height: 140%;">Using</span><span style="line-height: 140%;"> db </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Database</span><span style="line-height: 140%;"> = </span><span style="color: #2b91af; line-height: 140%;">HostApplicationServices</span><span style="line-height: 140%;">.WorkingDatabase</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp; </span><span style="color: blue; line-height: 140%;">Using</span><span style="line-height: 140%;"> trans </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Transaction</span><span style="line-height: 140%;"> = db.TransactionManager.StartTransaction</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: green; line-height: 140%;">' AlignmentDesignCheckRoot </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">Dim</span><span style="line-height: 140%;"> oAlignmentDesignCheckRoot </span><span style="color: blue; line-height: 140%;">As</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">AlignmentDesignCheckRoot</span><span style="line-height: 140%;"> =</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; &nbsp; &nbsp; </span><span style="color: blue; line-height: 140%;">New</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">AlignmentDesignCheckRoot</span><span style="line-height: 140%;">(Autodesk.AutoCAD.DatabaseServices.</span><span style="color: #2b91af; line-height: 140%;">HostApplicationServices</span><span style="line-height: 140%;">.WorkingDatabase)</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: green; line-height: 140%;">' Add CurveDesignChecks</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; oAlignmentDesignCheckRoot.CurveDesignChecks.Add(</span><span style="color: #a31515; line-height: 140%;">"MY_TEST_Curve"</span><span style="line-height: 140%;">, </span><span style="color: #a31515; line-height: 140%;">"Created using API"</span><span style="line-height: 140%;">, </span><span style="color: #a31515; line-height: 140%;">"Radius&gt;200"</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: green; line-height: 140%;">' Add LineDesignChecks</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; oAlignmentDesignCheckRoot.LineDesignChecks.Add(</span><span style="color: #a31515; line-height: 140%;">"MY_TEST_Line"</span><span style="line-height: 140%;">, </span><span style="color: #a31515; line-height: 140%;">"Created using API"</span><span style="line-height: 140%;">, </span><span style="color: #a31515; line-height: 140%;">"{Design Speed}&lt;=65"</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; </span><span style="color: green; line-height: 140%;">' SpiralDesignChecks</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; oAlignmentDesignCheckRoot.SpiralDesignChecks.Add(</span><span style="color: #a31515; line-height: 140%;">"MY_TEST_Spiral"</span><span style="line-height: 140%;">, </span><span style="color: #a31515; line-height: 140%;">"Created using API"</span><span style="line-height: 140%;">, </span><span style="color: #a31515; line-height: 140%;">"A&lt;=100.05"</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; &nbsp; trans.Commit()</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp; </span><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Using</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp; </span><span style="color: blue; line-height: 140%;">End</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">Using</span></p>
</div>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="line-height: 15px;"><br /></span></p>
</div>
<p><br />And the result of running the above code snippet –&nbsp;</p>
<p><a class="asset-img-link" style="display: inline;" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0168e996c696970c-pi"><img class="asset  asset-image at-xid-6a0167607c2431970b0168e996c696970c" title="C3D_ALD" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0168e996c696970c-800wi" border="0" alt="C3D_ALD" /></a><br /><br /></p>
<p><br />Hope this is useful to you !</p>
<p><br /><br /></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Install Autodesk Infrastructure Map Server 2013 step by step
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: install-autodesk-infrastructure-map-server-2013-step-by-step
CATEGORY: AIMS 2013
CATEGORY: Daniel Du

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/04/install-autodesk-infrastructure-map-server-2013-step-by-step.html 
DATE: 04/01/2012 11:40:06 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html" target="_self">Daniel Du</a></p>
<p>Autodesk Infrastructure Map Server 2013 has been released, it can be downloaded from ADN website if you are an ADN member. Trail version will also be published to Autodesk.com website very soon.</p>
<p>In this article, I would like to share with you how to install AIMS 2013 on windows machine.&#0160;</p>
<h2>Before Installation</h2>
<p>Before you start, to avoid unexpected errors, please do read the System Requirement to ensure your computer meets the minimum system requirements of AIMS. Documentation is accessible from links at the lower left corner of the installer.</p>
<p>Core Server &amp; Web Extension &amp; Infrastructure Application Extensions need Microsoft<sup>®</sup> Windows<sup>®</sup> Server 2008 Enterprise SP2. It is not officially supported to install AIMS2013 on Windows 7, but it does run without problem.Since many developers are developing AIMS application from a Win7 machine, I will use Windows 7 as demonstration here. To install on windows with IIS+.NET binding, please make sure IIS is installed/configured correctly, make sure you can run common ASP.NET application first.</p>
<p>Autodesk Infrastructure Map Server Web Extension uses CGI to communicate with core Server, please make sure check “CGI” in IIS configuration. For Windows 7, click Control Panel—&gt; Program and Features –&gt; Turn Windows features on or off:</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01676480f052970b-pi"><img alt="image" border="0" height="334" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01676480f061970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="381" /></a></p>
<p>Another reminder is to ensure that your user name has Administrator permissions to install AIMS 2013.</p>
<p>&#0160;</p>
<h2>Start Installation</h2>
<p>Now let’s begin, you will see this screen after the setup is launched, please do take some time reading the Installation Help, System Requirement and Readme. Click “Install” to continue.</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0168e9822ebd970c-pi"><img alt="image" border="0" height="363" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01676480f0ab970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="441" /></a></p>
<p>Read and accept the license agreement:</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0163038c1702970d-pi"><img alt="image" border="0" height="369" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0163038c1714970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="448" /></a></p>
<p>Input your serial number and product key if you have one, otherwise you can select the first option to try this product for 30 days.</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0163038c171f970d-pi"><img alt="image" border="0" height="369" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0163038c1729970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="448" /></a></p>
<p><strong>Caution</strong>! Do not go too fast in this page. You need to click each item to open the configuration page, otherwise it will install with default configuration.</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0168e9822f42970c-pi"><img alt="image" border="0" height="377" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0168e9822f4b970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="459" /></a></p>
<p>Click “Autodesk Infrastructure Map Server 2013” to open the server configuration page as below. You can install Map Server and Web Extension on same machine or separate machines.</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0163038c177d970d-pi"><img alt="image" border="0" height="383" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0163038c1784970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="466" /></a></p>
<p>For “Autodesk Infrastructure Web Server Extension 2013”, it is a little complicated. As you know, Autodesk Infrastructure Map Server runs on both Windows and Linux, provides APIs in 3 languages: .net, php and Java. Depending on the choices you made to develop AIMS applications, you have different choice to install Infrastructure Map Server Web Extension.</p>
<p>You should decide which language you are planning to use before installing AIMS Web Extension.</p>
<p>Language&#0160;&#0160;&#0160; OS&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Web Server</p>
<p>-----------------------------------------------------------------------------</p>
<p>.net&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Windows&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; IIS Configuration with .net</p>
<p>php&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Windows&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; IIS Configuration with php</p>
<p>php&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Linux&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Apache with php</p>
<p>Java&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Windows&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Apache/Tomcat with Java</p>
<p>Java&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Linux&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Apache/Tomcat with Java</p>
<p>------------------------------------------------------------------------------</p>
<p>I am going to use .NET to develop AIMS application, so I select IIS configuration with .NET.</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0163038c1799970d-pi"><img alt="image" border="0" height="359" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0163038c17a1970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="437" /></a></p>
<p>&#0160;</p>
<p>I need to install “Autodesk Infrastructure Studio 2013” in next page. You can also install “Autodesk Infrastructure Application Extension 2013” and “Autodesk Infrastructure Administrator 2013” if you are going to use industry model.</p>
<p>Please note that IIS with .NET configuration is the only option if you want to install “Autodesk Infrastructure Application Extension 2013” .</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0168e9822fa8970c-pi"><img alt="image" border="0" height="372" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0163038c17cf970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="452" /></a></p>
<p>Now it is all set, you can sit back to have a cup of coffee now.</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0163038c1803970d-pi"><img alt="image" border="0" height="381" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0168e9822fe5970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="463" /></a></p>
<p>A few minutes latter, the product will be installed successfully.</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01676480f1ea970b-pi"><img alt="image" border="0" height="389" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0163038c1851970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="473" /></a></p>
<p>&#0160;</p>
<h2>License Activation</h2>
<p>Unlike other Autodesk products, Autodesk Infrastructure Map Server 2013 does not start the activation process when you launch the program for the first time. You must manually activate Infrastructure Map Server by clicking Start <a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0163038c1863970d-pi"><img alt="ac.menuaro" border="0" height="11" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01676480f211970b-pi" style="background-image: none; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="ac.menuaro" width="17" /></a> Programs (or All Programs) <a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0168e9823033970c-pi"><img alt="ac.menuaro[1]" border="0" height="11" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0163038c1876970d-pi" style="background-image: none; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="ac.menuaro[1]" width="17" /></a> Autodesk <a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0168e9823038970c-pi"><img alt="ac.menuaro[2]" border="0" height="11" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0168e9823042970c-pi" style="background-image: none; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="ac.menuaro[2]" width="17" /></a> Autodesk Infrastructure Map Server 2013 <a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01676480f221970b-pi"><img alt="ac.menuaro[3]" border="0" height="11" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0163038c188b970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="ac.menuaro[3]" width="17" /></a> Autodesk Infrastructure Map Server 2013 Licensing Activator.</p>
<p><a name="GUID-5B0CE3B1-1733-4C55-BD0B-FCBDF39957C0"></a>The Autodesk Licensing wizard is started where you can follow the on-screen instructions to activate your Autodesk Infrastructure Map Server 2013 license.</p>
<p>&#0160;</p>
<h2>Verifying the Configuration</h2>
<p>You can run some simple tests to ensure that the Map Agent and Web Server Extensions are configured properly.</p>
<h4>Testing the Map Agent</h4>
<p>Ensure that the Infrastructure Map Server is running. The installer configures Infrastructure Map Server as a service. Open Services Management Console by typing “Services.msc” in Start—&gt;Run, check that the service status is Started.</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0168e9823050970c-pi"><img alt="image" border="0" height="324" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0163038c1898970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="487" /></a></p>
<p>&#0160;</p>
<p><a name="WS73099CC142F487551259E26112442A7ABB521"></a>Open a web browser and go to the following URL. If the Web Server Extensions are not running on your local machine, replace localhost with the name or IP address of your server.</p>
<p><a name="GUID-6DA14D45-775E-4AAF-B10F-9891DEB26C43"></a></p>
<p><a name="WS73099CC142F4875535A241551166AC8792F147D"></a><a href="file:///C:/Users/duda/AppData/Local/Temp/_AIEB8C.tmp/en-us/Help/files/">http://localhost:8008/mapserver2013/mapagent/index.html </a>(Apache) or <a href="file:///C:/Users/duda/AppData/Local/Temp/_AIEB8C.tmp/en-us/Help/files/">http://localhost/mapserver2013/mapagent/index.html</a>(IIS)</p>
<p><a name="WS73099CC142F487551259E26112442A7ABB523"></a>Note that if your web server is listening on a different port you must include the port number in the HTTP request. For example, if Apache is listening on port 8700, you must go to the following URL:</p>
<p><a name="GUID-2C593634-1E70-4BCC-A92C-98D5B0BF5D2E"></a></p>
<p><a name="WS73099CC142F4875535A241551166AC8792F147E"></a><a href="file:///C:/Users/duda/AppData/Local/Temp/_AIEB8C.tmp/en-us/Help/files/">http://localhost:8700/mapserver2013/mapagent/index.html</a></p>
<p><a name="WS73099CC142F487551259E26112442A7ABB525"></a>Click one test method, for example, “Features” in Service API, then “GetFeatureProviders”, it will get all register FDO providers. Enter Administrator for the user id and admin for the password. Both are case-sensitive.</p>
<p><a name="WS73099CC142F487551259E26112442A7ABB526"></a>If the Map Agent is running properly, you will get an XML document describing the resources in the repository.</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01676480f276970b-pi"><img alt="image" border="0" height="323" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01676480f28a970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="525" /></a></p>
<p>&#0160;</p>
<h4>Testing the Site Administrator</h4>
<p>Ensure that the Map Server is running. Open a web browser and go to the following URL.</p>
<p><a name="GUID-EA57710D-ABFF-4729-A524-A031730AFC9E"></a></p>
<p><a name="WS73099CC142F4875535A241551166AC8792F147F"></a><a href="file:///C:/Users/duda/AppData/Local/Temp/_AIEB8C.tmp/en-us/Help/files/">http://localhost:8008/mapserver2013/mapadmin/login.php</a> (Apache) or <a href="file:///C:/Users/duda/AppData/Local/Temp/_AIEB8C.tmp/en-us/Help/files/">http://localhost/mapserver2013/mapadmin/login.php</a>(IIS)</p>
<p><a name="WS73099CC142F487551259E26112442A7ABB529"></a>Note that if your web server is listening on a different port you must include the port number in the HTTP request. For example, if Apache is listening on port 8700, you must go to the following URL:</p>
<p><a name="GUID-DF56BDB9-5F81-4783-8EB7-B0E7724DF060"></a></p>
<p><a name="WS73099CC142F487551259E26112442A7ABB52A"></a><a href="file:///C:/Users/duda/AppData/Local/Temp/_AIEB8C.tmp/en-us/Help/files/">http://localhost:8700/mapserver2013/mapadmin/login.php</a></p>
<p><a name="WS73099CC142F487551259E26112442A7ABB52B"></a>Enter Administrator for the user id and admin for the password. Both are case-sensitive.</p>
<p><a name="WS73099CC142F487551259E26112442A7ABB52C"></a>If the Site Administrator is configured properly, you will get a Manage Servers page which lists all the servers configured in the Map Server Site.</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0168e9823077970c-pi"><img alt="image" border="0" height="359" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0163038c18c3970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="452" /></a></p>
<p>&#0160;</p>
<h2>Common Errors/Problems:</h2>
<p>Here are some solutions for common problems for your reference:</p>
<h4>1. cannot login from Infrastructure Studio,</h4>
<p>Error message:</p>
<p>---------------------------</p>
<p>Unable to complete request to Site</p>
<p>The User ID or Password is invalid. Please try again.</p>
<p>---------------------------</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0163038c18ca970d-pi"><img alt="image" border="0" height="136" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0163038c18d3970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="289" /></a></p>
<p>&#0160;</p>
<p>Solution:</p>
<blockquote>
<p><strong>Enable </strong>“<strong>Anonymous Authentication</strong>” and<strong> Disable</strong> “<strong>Basic Authentication</strong>” in IIS for MapServer2013 web application.</p>
</blockquote>
<blockquote>
<p>Start—&gt;Run, type “inetmgr” to open Internet Information Service Manager. Click “MapServer 2013” web application from let, then Authentication from right.</p>
</blockquote>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01676480f2dc970b-pi"><img alt="image" border="0" height="424" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0168e98230b7970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="496" /></a></p>
<p>&#0160;</p>
<p>2. Get following error message in Infrastructure Studio:</p>
<p>---------------------------    <br />Unable to complete request to Site     <br />FastCGI must be properly configured before attempting to connect to Map Server.     <br />---------------------------</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0168e98230c7970c-pi"><img alt="image" border="0" height="165" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b01676480f310970b-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="358" /></a></p>
<p>&#0160;</p>
<p>Solution:</p>
<ul>
<li>Check whether your configure CGI successfully in IIS(see Before Starting) </li>
<li>Disable “ASP.NET Impersonation” </li>
</ul>
<p>&#0160;</p>
<p>3. Cannot login from mapagent, <a href="http://localhost/mapserver2013/mapagent/index.html">http://localhost/mapserver2013/mapagent/index.html</a>, always get this authentication dialogue even input the correct user name “Administrator” and password “admin”:</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01676480f31f970b-pi"><img alt="image" border="0" height="166" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0168e98230eb970c-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="292" /></a></p>
<p>&#0160;</p>
<p>Solution:</p>
<blockquote>
<p><strong>Disable “Digest Authentication ” </strong>in&#0160; IIS for MapServer2013 web application.</p>
</blockquote>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0168e98230f0970c-pi"><img alt="image" border="0" height="267" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0163038c195b970d-pi" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="image" width="485" /></a></p>
<p>&#0160;</p>
<p>&#0160;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Warrick
EMAIL: warrick.Hughes@hotmail.com
IP: 124.170.86.114
URL: 
DATE: 07/22/2012 02:43:51 AM
Why windows 7???? Seems stupid to me... if you need to explain on how to install on windows 7 then branch off. Server product on Desktop OS. won't be taking any of your advice...
-----
COMMENT:
AUTHOR: Daniel Du
EMAIL: Daniel.Du@autodesk.com
IP: 123.116.107.79
URL: http://adndevblog.typepad.com/autocad/daniel-du/
DATE: 07/22/2012 03:05:26 AM
Thanks for your comment! Yes, installing MapServer on windows 7 is not supported. Considering that many developers, including me, are using windows 7 as development OS, so it may be helpful for developers to create a development environment without changing OS. Since there are some similarities between IIS on win7 and Windows server 2008, hope it is helpful when installing map server on a production environment.
-----
COMMENT:
AUTHOR: swimming
EMAIL: 
IP: 216.208.69.94
URL: http://profile.typepad.com/6p016768b8e150970b
DATE: 07/24/2012 02:56:02 PM
Good information. Thanks for sharing.

-----
COMMENT:
AUTHOR: Antonio
EMAIL: antonio.dlap@gmail.com
IP: 187.245.114.1
URL: 
DATE: 09/06/2012 01:53:51 PM
Wow, aren't you pedantic?
-----
COMMENT:
AUTHOR: Mido Much2000
EMAIL: 
IP: 80.239.242.191
URL: http://profile.typepad.com/much2000
DATE: 09/13/2012 02:24:26 PM
i want to learn autodesk infrastructure but how 

-----
COMMENT:
AUTHOR: Daniel Du
EMAIL: Daniel.Du@autodesk.com
IP: 125.98.160.4
URL: http://adndevblog.typepad.com/autocad/daniel-du/
DATE: 09/13/2012 06:40:10 PM
You can start from developer center(<a href="http://www.autodesk.com/developmapguide)">http://www.autodesk.com/developmapguide)</a> and subscribe our devblog of cause :) 
-----
COMMENT:
AUTHOR: Tony Witham
EMAIL: tony.witham@cdrgroup.co.uk
IP: 217.35.64.33
URL: 
DATE: 06/13/2013 02:30:15 AM
Excellent article - very helpful.  Couldn't have got Map Server running without this info!
-----
COMMENT:
AUTHOR: GN8FC
EMAIL: GN8FC@yahoo.de
IP: 79.194.193.114
URL: 
DATE: 08/21/2013 02:00:06 PM
Very usefull thanks. Now i got it going: Map, Map Server and Ms Sql Server 2008. Do you know if the if the Web extension is working with Ms Sql Server 2008? That is the onlything not working yet ..
-----
COMMENT:
AUTHOR: Selvackp
EMAIL: selvacks@gmail.com
IP: 10.100.4.104
URL: http://www.dbaterminal.blogspot.com
DATE: 07/16/2014 08:07:29 PM
Hi,

Its useful., Thank you
-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: How to use command line version of -mapexport for exporting to SHP file ?
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 0
ALLOW PINGS: 0
BASENAME: how-to-use-command-line-version-of-mapexport-for-exporting-to-shp-file-
CATEGORY: AutoCAD Map 3D 2011
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/03/how-to-use-command-line-version-of-mapexport-for-exporting-to-shp-file-.html 
DATE: 03/28/2012 02:11:07 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>Here is an example on how to use command line version of -mapexport for exporting DWG data to SHP file.</p>
<p><br /><strong>(command "-mapexport" "SHP" "c:\\Temp\\MyTest.shp" "Y" "c:\\Temp\\Street.epf" "S" "L" "All" "*" "*" "No" "Proceed")</strong></p>
<p><a class="asset-img-link" style="display: inline;" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0163035e5cda970d-pi"><img class="asset  asset-image at-xid-6a0167607c2431970b0163035e5cda970d image-full" title="MapExportSHP" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0163035e5cda970d-800wi" border="0" alt="MapExportSHP" /></a><br /><br /></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:
mapexport, SHP
-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Change Alignment Curve Label style using Civil 3D .NET API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 0
ALLOW PINGS: 0
BASENAME: change-alignment-curve-label-style-using-civil-3d-net-api
CATEGORY: AutoCAD Civil 3D 2011
CATEGORY: AutoCAD Civil 3D 2012
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/03/change-alignment-curve-label-style-using-civil-3d-net-api.html 
DATE: 03/22/2012 09:50:51 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>Do you want to change the Label style of an Alignment curve element using Civil 3D .NET AP ? Here is the C# code snippet which demonstrates how to do this :</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">public</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">void</span><span style="line-height: 140%;"> ChangeAlignmentCurveLblStyle()</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="color: #2b91af; line-height: 140%;">Editor</span><span style="line-height: 140%;"> ed = </span><span style="color: #2b91af; line-height: 140%;">Application</span><span style="line-height: 140%;">.DocumentManager.MdiActiveDocument.Editor;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="color: #2b91af; line-height: 140%;">PromptEntityOptions</span><span style="line-height: 140%;"> pops = </span><span style="color: blue; line-height: 140%;">new</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">PromptEntityOptions</span><span style="line-height: 140%;">(</span><span style="color: #a31515; line-height: 140%;">"Select Alignment Curve Label : "</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; pops.AllowNone = </span><span style="color: blue; line-height: 140%;">true</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="color: #2b91af; line-height: 140%;">PromptEntityResult</span><span style="line-height: 140%;"> pres = ed.GetEntity(pops);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="color: blue; line-height: 140%;">if</span><span style="line-height: 140%;"> (pres.Status != </span><span style="color: #2b91af; line-height: 140%;">PromptStatus</span><span style="line-height: 140%;">.OK)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </span><span style="color: blue; line-height: 140%;">return</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">Transaction</span><span style="line-height: 140%;"> tr = </span><span style="color: #2b91af; line-height: 140%;">HostApplicationServices</span><span style="line-height: 140%;">.WorkingDatabase.TransactionManager.StartTransaction())</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </span><span style="color: blue; line-height: 140%;">try</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </span><span style="color: #2b91af; line-height: 140%;">AlignmentCurveLabel</span><span style="line-height: 140%;"> alignCurveLbl = (</span><span style="color: #2b91af; line-height: 140%;">AlignmentCurveLabel</span><span style="line-height: 140%;">)tr.GetObject(pres.ObjectId, </span><span style="color: #2b91af; line-height: 140%;">OpenMode</span><span style="line-height: 140%;">.ForWrite);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">"\nAlignment Curve Label Style Name (before Change) : "</span><span style="line-height: 140%;"> + alignCurveLbl.StyleName.ToString());</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </span><span style="color: green; line-height: 140%;">// The following Style Name is specific to Tutorial DWG file - "Labels-6a.dwg"</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; alignCurveLbl.StyleName = </span><span style="color: #a31515; line-height: 140%;">"Design Data"</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">"\nAlignment Curve Label Style Name (after Change) : "</span><span style="line-height: 140%;"> + alignCurveLbl.StyleName.ToString());</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; tr.Commit();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </span><span style="color: blue; line-height: 140%;">catch</span><span style="line-height: 140%;"> (System.</span><span style="color: #2b91af; line-height: 140%;">Exception</span><span style="line-height: 140%;"> e)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; System.Windows.Forms.</span><span style="color: #2b91af; line-height: 140%;">MessageBox</span><span style="line-height: 140%;">.Show(e.Message);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: #0000ff;"><span style="line-height: 15px;"><br /></span></span></p>
</div>
<p>After executing the command in AutoCAD Civil 3D you will see a result similar to the screenshot below –&nbsp;</p>
<p><a class="asset-img-link" style="display: inline;" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0168e918fb77970c-pi"><img class="asset  asset-image at-xid-6a0167607c2431970b0168e918fb77970c image-full" title="C3D_Alignment_CurveLbl" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0168e918fb77970c-800wi" border="0" alt="C3D_Alignment_CurveLbl" /></a><br /><br /></p>
<p><br /><br /></p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:
AlignmentCurveLabel, Civil 3D API
-----
--------
AUTHOR: Daniel Du
AUTHOR EMAIL: duchangyu@gmail.com
TITLE: Change the selection color in MapGuide Ajax viewer and Fusion viewer
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 0
ALLOW PINGS: 0
BASENAME: change-the-selection-color-in-mapguide-ajax-viewer-and-fusion-viewer
CATEGORY: AIMS 2012
CATEGORY: Daniel Du
CATEGORY: MapGuide Enterprise 2011

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/03/change-the-selection-color-in-mapguide-ajax-viewer-and-fusion-viewer.html 
DATE: 03/20/2012 10:11:22 PM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html" target="_self">Daniel Du</a></p>
<p>As you know, if a feature is selected, it will be highlighted as blue by default, but is it possible to change to other color for selection? It is possible to change the selection color when plotting as well? Yes, it is. In this article, I would like to introduce how to do that.</p>
<p>To change the selection color of select features in Ajax viewer, you can open the ajaxmappane.temp file in text editor, change the value to your favorite color. The value is 0xRRGGBBaa where each is a hex value from 0-255 representing your RGB and transparency (alpha) values. Currently the alpha value does not have any impact as either FF or 00, it is hardcoded in source code.</p>
<p>C:\Program Files\Autodesk\MapGuideEnterprise2011\WebServerExtensions\www\viewerfiles\ajaxmappane.templ</p>
<p>around line 335:</p>
<pre class="csharpcode"><span class="rem">//var selectionColor = '0x0000FFFF'; // Blue</span>
<span class="kwrd">var</span> selectionColor = <span class="str">'0xFF5300FF'</span>;</pre>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0168e90b01bd970c-pi"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="clip_image002[4]" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0167640a4563970b-pi" border="0" alt="clip_image002[4]" width="358" height="216" /></a></p>
<p>If you want to change the selection color of print as well, you will have to modify printablepage.templ file. Please pay attention to the words highlighted.</p>
<p>C:\Program Files\Autodesk\MapGuideEnterprise2011\WebServerExtensions\www\viewerfiles\printablepage.templ</p>
<p>Line 72:</p>
<pre class="csharpcode"><span class="kwrd">if</span>(requester.responseXML)
{
    <span class="kwrd">if</span>(ValidateMapResponse(<br />         requester.responseXML.documentElement))
        <span class="rem">//document.getElementById("mapImage").src = </span>
        <span class="rem">//webAgent + "?OPERATION=GETMAPIMAGE</span>
        <span class="rem">//&amp;FORMAT=PNG</span>
        <span class="rem">//&amp;VERSION=1.0.0&amp;SELECTION=</span>
        <span class="rem">//&amp;MAPNAME=" + encodeURIComponent(mapName) </span>
        <span class="rem">//+ "&amp;SESSION=" + sessionId </span>
        <span class="rem">//+ "&amp;CLIENTAGENT=" + encodeURIComponent(clientAgent) ;</span>

        document.getElementById(<span class="str">"mapImage"</span>).src = 
         webAgent <br />         + <span class="str">"OPERATION=<span style="background-color: #ffff00;">GETDYNAMICMAPOVERLAYIMAGE</span>
         &amp;FORMAT=PNG
         &amp;VERSION=<span style="background-color: #ffff00;">2.0.0<br /></span>         &amp;SELECTION=
         &amp;MAPNAME="</span> + encodeURIComponent(mapName) 
        + <span class="str">"&amp;SESSION="</span> + sessionId <br />        + <span class="str">"&amp;CLIENTAGENT="</span> 
        + encodeURIComponent(clientAgent) +
        <span class="str">"&amp;<span style="background-color: #ffff00;">BEHAVIOR=7&amp;SELECTIONCOLOR=FF5300FF</span>"</span> ;
}</pre>
<p>With this modification, we use GETDYNAMICMAPOVERLAYIMAGE as operation and pass the BEHAVIOR and SELECTIONCOLOR as additional parameters. You may be curious about the BEHAVIOR parameter. MapGuideRfc38( <a href="http://trac.osgeo.org/mapguide/wiki/MapGuideRfc38">http://trac.osgeo.org/mapguide/wiki/MapGuideRfc38</a> ) gives us an explanation. In old release, MapGuide rendered the selection and the overlay image as a single image. This required all untiled layers to be redrawn whenever the selection is changed. To make it more efficient, an improvement is implemented to add the parameter BEHAVIOR to the existing GETDYNAMICMAPOVERLAYIMAGE and increase the VERSION to 2.0.0. BEHAVIOR is a bitmask with the following values:</p>
<pre class="csharpcode">RenderSelection = 1 <span class="rem">// Renders the selected feature(s)</span>
RenderLayers = 2    <span class="rem">// Renders the features on the map</span>
KeepSelection = 4   <span class="rem">// Renders the selected feature(s) </span>
          //even <span class="kwrd">if</span> they are outside the current scale</pre>
<p>With this change, the color of selected features is also changed while plotting.</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0168e90b01d4970c-pi"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="clip_image004[4]" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0167640a4576970b-pi" border="0" alt="clip_image004[4]" width="250" height="298" /></a></p>
<p>If you are using Flexible Web Layout (Fusion Viewer), you can change the selection color from MapGuide Studio. Open the flexible web layout in MapGuide Studio, and switch to Map tab. By clicking “Edit Map Groups” button, you will get the xml configuration of map groups as below, and you can change the value of &lt;SelectionColor&gt; to other color value:</p>
<pre class="csharpcode"><span class="kwrd">&lt;?</span><span class="html">xml</span> <span class="attr">version</span><span class="kwrd">="1.0"</span> <span class="attr">encoding</span><span class="kwrd">="utf-8"</span>?<span class="kwrd">&gt;</span>
<span class="kwrd">&lt;</span><span class="html">MapSet</span> <span class="attr">xmlns:xsi</span><span class="kwrd">=<a href="http://www.w3.org/2001/XMLSchema-instance">http://www.w3.org/2001/XMLSchema-instance</a></span> <br /><span class="attr">        xmlns:xsd</span><span class="kwrd">="http://www.w3.org/2001/XMLSchema"</span><span class="kwrd">&gt;</span>
  <span class="kwrd">&lt;</span><span class="html">MapGroupType</span> <span class="attr">id</span><span class="kwrd">="Sheboygan"</span><span class="kwrd">&gt;</span>
    <span class="kwrd">&lt;</span><span class="html">Map</span><span class="kwrd">&gt;</span>
      <span class="kwrd">&lt;</span><span class="html">Type</span><span class="kwrd">&gt;</span>MapGuide<span class="kwrd">&lt;/</span><span class="html">Type</span><span class="kwrd">&gt;</span>
      <span class="kwrd">&lt;</span><span class="html">SingleTile</span><span class="kwrd">&gt;</span>true<span class="kwrd">&lt;/</span><span class="html">SingleTile</span><span class="kwrd">&gt;</span>
      <span class="kwrd">&lt;</span><span class="html">Extension</span><span class="kwrd">&gt;</span>
        <span class="kwrd">&lt;</span><span class="html">ResourceId</span><span class="kwrd">&gt;<br /></span>          Library://Samples/Sheboygan/Maps/Sheboygan.MapDefinition<br />        <span class="kwrd">&lt;/</span><span class="html">ResourceId</span><span class="kwrd">&gt;</span>
        <span class="kwrd">&lt;</span><span class="html">SelectionAsOverlay</span><span class="kwrd">&gt;</span>true<span class="kwrd">&lt;/</span><span class="html">SelectionAsOverlay</span><span class="kwrd">&gt;</span>
        <span class="kwrd">&lt;</span><span class="html">SelectionColor</span><span class="kwrd">&gt;</span><span style="background-color: #ffff00;">0xFF5300FF</span> <span class="kwrd">&lt;/</span><span class="html">SelectionColor</span><span class="kwrd">&gt;</span>
      <span class="kwrd">&lt;/</span><span class="html">Extension</span><span class="kwrd">&gt;</span>
    <span class="kwrd">&lt;/</span><span class="html">Map</span><span class="kwrd">&gt;</span>
    <span class="kwrd">&lt;</span><span class="html">Extension</span> <span class="kwrd">/&gt;</span>
  <span class="kwrd">&lt;/</span><span class="html">MapGroupType</span><span class="kwrd">&gt;</span>
<span class="kwrd">&lt;/</span><span class="html">MapSet</span><span class="kwrd">&gt;</span></pre>
<p>Here is the screen-shot after modification:</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b016303157caf970d-pi"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="clip_image006[4]" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b016303157cb8970d-pi" border="0" alt="clip_image006[4]" width="341" height="274" /></a></p>
<p>To change the selection color of printing in Fusion viewer, you have to modify the source code of printablepage.templ. Here is the code snippet:</p>
<p>C:\Program Files\Autodesk\MapGuideEnterprise2011\WebServerExtensions\www\fusion\widgets\Print\printablepage.templ</p>
<p>Line 53:</p>
<pre class="csharpcode">        <span class="rem">//var imgReq = webAgent + "?OPERATION=GETMAPIMAGE</span>
        <span class="rem">//&amp;VERSION=1.0.0&amp;FORMAT=PNG&amp;LOCALE="+locale</span>
        <span class="rem">//+"&amp;MAPNAME=" + encodeURIComponent(mapName) </span>
        <span class="rem">//+ "&amp;SESSION=" + sessionId + "&amp;SETDISPLAYWIDTH=" </span>
        <span class="rem">//+ mapWidth + "&amp;SETDISPLAYHEIGHT=" + mapHeight </span>
        <span class="rem">//+ "&amp;SETDISPLAYDPI=" + dpi + "&amp;SETVIEWSCALE=" </span>
        <span class="rem">//+ scale + "&amp;SETVIEWCENTERX=" + centerX </span>
        <span class="rem">//+ "&amp;SETVIEWCENTERY=" + centerY + "&amp;SEQ=" </span>
        <span class="rem">//+ Math.random() + "&amp;CLIENTAGENT=" </span>
        <span class="rem">//+ encodeURIComponent(clientAgent);</span>

        <span class="kwrd">var</span> imgReq = webAgent <br />        + OPERATION=<span style="background-color: #ffff00;">GETDYNAMICMAPOVERLAYIMAGE</span>
        &amp;VERSION=<span style="background-color: #ffff00;">2.0.0<br /></span>        &amp;FORMAT=PNG&amp;LOCALE=<span class="str">"+locale
        +"</span>&amp;MAPNAME=<span class="str">" + encodeURIComponent(mapName) 
        + "</span>&amp;SESSION=<span class="str">" + sessionId <br />        + "</span>&amp;SETDISPLAYWIDTH=<span class="str">" 
        + mapWidth + "</span>&amp;SETDISPLAYHEIHT=<span class="str">" + mapHeight
        + "</span>&amp;SETDISPLAYDPI=<span class="str">" + dpi + "</span>&amp;SETVIEWSCALE=<span class="str">" 
        + scale + "</span>&amp;SETVIEWCENTERX=<span class="str">" + centerX 
        + "</span>&amp;SETVIEWCENTERY=<span class="str">" + centerY + "</span>&amp;SEQ=<span class="str">" 
        + Math.random() + "</span>&amp;CLIENTAGENT=<span class="str">" 
        + encodeURIComponent(clientAgent) 
        + <span style="background-color: #ffff00;">"</span></span><span style="background-color: #ffff00;">&amp;BEHAVIOR=7&amp;SELECTIONCOLOR=0xFF5300FF</span>";</pre>
<p>And here is the screen-shot after modification:</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0168e90b01f6970c-pi"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="clip_image008[4]" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0167640a4594970b-pi" border="0" alt="clip_image008[4]" width="301" height="343" /></a></p>
<p>OK, with that you can change the selection color to your favorite ones for both Ajax viewer and fusion viewer when viewing and printing. Enjoy !</p>
<p><strong>&nbsp;</strong></p>
<p>&nbsp;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Programmatically Attach and Detach DWG files in AutoCAD Map 3D
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 0
ALLOW PINGS: 0
BASENAME: programmatically-attach-and-detach-dwg-files-in-autocad-map-3d
CATEGORY: AutoCAD Map 3D 2011
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/03/programmatically-attach-and-detach-dwg-files-in-autocad-map-3d.html 
DATE: 03/13/2012 03:35:50 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>Are you looking for a way to attach or detach dwg files in AutoCAD Map 3D using .NET API?</p>
<p><a style="display: inline;" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b016302c78076970d-pi"><img class="asset  asset-image at-xid-6a0167607c2431970b016302c78076970d" title="MapDWGAttach" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b016302c78076970d-800wi" border="0" alt="MapDWGAttach" /></a><br /><br /></p>
<p style="text-align: justify;">If the answer is ‘YES’, you are at the right place. <strong><em>DrawingSet</em></strong> class in Map 3D .NET API has the necessary API function to attach a DWG file using DrawingSet.AttachDrawing() as well as detach a DWG file using DrawingSet.DetachDrawing(). To access the <strong><em>DrawingSet</em></strong>&nbsp;object you need to make a reference to the <strong>ManagedMapApi</strong> assembly located in the Map 3D installation folder (For Map 3D 2012 release its here - &nbsp;C:\Program Files\Autodesk\AutoCAD Map 3D 2012\ManagedMapApi.dll)</p>
<p style="text-align: justify;">Here is the code snippet which demonstrates the Attach and Detach DWG files using Map 3D .NET API functions –</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;</span><span style="color: blue; line-height: 140%;">public</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">void</span><span style="line-height: 140%;"> AttachDWG()</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="color: #2b91af; line-height: 140%;">MapApplication</span><span style="line-height: 140%;"> mapApp = </span><span style="color: #2b91af; line-height: 140%;">HostMapApplicationServices</span><span style="line-height: 140%;">.Application;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="color: #2b91af; line-height: 140%;">ProjectModel</span><span style="line-height: 140%;"> activeProject = mapApp.ActiveProject;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="color: #2b91af; line-height: 140%;">ProjectCollection</span><span style="line-height: 140%;"> progList = mapApp.Projects;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="color: #2b91af; line-height: 140%;">DrawingSet</span><span style="line-height: 140%;"> dwgSet = activeProject.DrawingSet;</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="color: green; line-height: 140%;">// String to indicate the DWG file path</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="color: blue; line-height: 140%;">string</span><span style="line-height: 140%;"> dwgStr = </span><span style="color: #a31515; line-height: 140%;">@"C:\Data_set\DWGs_Map\Street_Centerlines.dwg"</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="color: blue; line-height: 140%;">try</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </span><span style="color: #2b91af; line-height: 140%;">AttachedDrawing</span><span style="line-height: 140%;"> dwgAttached = dwgSet.AttachDrawing(dwgStr);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; dwgAttached.Preview();</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="color: blue; line-height: 140%;">catch</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">MapException</span><span style="line-height: 140%;"> ex)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ed.WriteMessage(ex.Message);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;}</span></p>
</div>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;</span><span style="color: blue; line-height: 140%;">public</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">void</span><span style="line-height: 140%;"> DetachDWG()</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="color: #2b91af; line-height: 140%;">MapApplication</span><span style="line-height: 140%;"> mapApp = </span><span style="color: #2b91af; line-height: 140%;">HostMapApplicationServices</span><span style="line-height: 140%;">.Application;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="color: #2b91af; line-height: 140%;">ProjectModel</span><span style="line-height: 140%;"> activeProject = mapApp.ActiveProject;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="color: #2b91af; line-height: 140%;">ProjectCollection</span><span style="line-height: 140%;"> progList = mapApp.Projects;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="color: #2b91af; line-height: 140%;">DrawingSet</span><span style="line-height: 140%;"> dwgSet = activeProject.DrawingSet;</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="color: blue; line-height: 140%;">try</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </span><span style="color: green; line-height: 140%;">// Check how many DWG files are attached and then Detach each of them</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </span><span style="color: blue; line-height: 140%;">while</span><span style="line-height: 140%;"> (dwgSet.DirectDrawingsCount &gt; 0)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; dwgSet.DetachDrawing(0);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ed.WriteMessage(</span><span style="color: #a31515; line-height: 140%;">"attached number: "</span><span style="line-height: 140%;"> + dwgSet.DirectDrawingsCount.ToString() + </span><span style="color: #a31515; line-height: 140%;">"\n"</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="color: blue; line-height: 140%;">catch</span><span style="line-height: 140%;"> (</span><span style="color: #2b91af; line-height: 140%;">MapException</span><span style="line-height: 140%;"> ex)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ed.WriteMessage(ex.Message);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;}</span></p>
</div>
<p>To know more about the AutoCAD Map 3D .NET API, refer to the <strong><a href="http://usa.autodesk.com/adsk/servlet/item?siteID=123112&amp;id=868205">Map 3D SDK</a></strong> documents and the API samples in the SDK.</p>
<p>&nbsp;</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
COMMENT:
AUTHOR: Chase hochstrasser
EMAIL: chase.hochstrasser@gmail.com
IP: 208.186.200.7
URL: 
DATE: 08/05/2013 11:52:28 AM
This didn't work for me. When I get to attachdrawing it throws a mapexception error.
-----
COMMENT:
AUTHOR: Partha Sarkar
EMAIL: 
IP: 203.202.234.243
URL: http://profile.typepad.com/6p0168e7e4ef23970c
DATE: 08/06/2013 02:02:31 AM
Hi, 

What's the exact error message ?
And which version of Map 3D are you using ?

Thanks,
Partha
ADN
-----
--------
AUTHOR: Partha Sarkar
AUTHOR EMAIL: partha.sarkar@autodesk.com
TITLE: Exporting DWG to SDF using *.epf file using Map 3D API
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: 0
ALLOW PINGS: 0
BASENAME: exporting-dwg-to-sdf-using-epf-file-using-map-3d-api
CATEGORY: AutoCAD Map 3D 2012
CATEGORY: Partha Sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/03/exporting-dwg-to-sdf-using-epf-file-using-map-3d-api.html 
DATE: 03/08/2012 07:52:41 AM
-----
BODY:
<p>By <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html" target="_self">Partha Sarkar</a></p>
<p>Want to export a DWG<sup>TM</sup> file with Map 3D Object Data to a SDF file using .NET API? Autodesk.Gis.Map.ImportExport.Exporter API class has the required functionality to enable this export. However, in the past we had found some issues with it and the resultant export was not producing expected SDF file. With the release of <a href="http://usa.autodesk.com/adsk/servlet/ps/dl/item?siteID=123112&amp;id=18021295&amp;linkID=9240858">AutoCAD® Map 3D 2012 SP1</a> exporting DWG to SDF using *.epf file through <strong><em>Autodesk.Gis.Map.ImportExport.Exporter</em></strong> API class is now operational.</p>
<p>Make sure to reference the <strong>ManagedMapApi.dll</strong> (C:\Program Files\Autodesk\AutoCAD Map 3D 2012\ManagedMapApi.dll) to your project.&nbsp;</p>
<p>Here is a .NET code sample which demonstrates how to export a DWG file with Map 3D Object Data to a SDF file using Autodesk.Gis.Map.ImportExport.Exporter API –&nbsp;</p>
<div style="font-family: Courier New; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// AutoCAD Ref</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> Autodesk.AutoCAD.Runtime;</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> Autodesk.AutoCAD.ApplicationServices;</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> Autodesk.AutoCAD.DatabaseServices;</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="color: green; line-height: 140%;">// Map 3D Ref</span></p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">using</span><span style="line-height: 140%;"> map = Autodesk.Gis.Map;</span><span style="background-color: white; font-size: 8pt;">&nbsp;</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="color: blue; line-height: 140%;">namespace</span><span style="line-height: 140%;"> MapExport</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; </span><span style="color: blue; line-height: 140%;">public</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">class</span><span style="line-height: 140%;"> </span><span style="color: #2b91af; line-height: 140%;">Class1</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </span><span style="color: blue; line-height: 140%;">public</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">static</span><span style="line-height: 140%;"> Autodesk.AutoCAD.EditorInput.Editor Editor</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </span><span style="color: blue; line-height: 140%;">get</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </span><span style="color: blue; line-height: 140%;">return</span><span style="line-height: 140%;"> Autodesk.AutoCAD.ApplicationServices.Application.DocumentManager.MdiActiveDocument.Editor;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; [CommandMethod(</span><span style="color: #a31515; line-height: 140%;">"ADN_EXPORTSDF"</span><span style="line-height: 140%;">)]</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </span><span style="color: blue; line-height: 140%;">static</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">public</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">void</span><span style="line-height: 140%;"> ExportSDFTest() </span><span style="color: green; line-height: 140%;">// This method can have any name</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </span><span style="color: blue; line-height: 140%;">try</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; map.ImportExport.Exporter exporter = map.HostMapApplicationServices.Application.Exporter;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; exporter.Init(</span><span style="color: #a31515; line-height: 140%;">"FDO_SDF"</span><span style="line-height: 140%;">, </span><span style="color: #a31515; line-height: 140%;">"C:\\Temp\\Street_Centerlines.sdf"</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; exporter.LoadExportFormat(</span><span style="color: #a31515; line-height: 140%;">"C:\\Temp\\Street.epf"</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; exporter.Export();</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; DisplayOutputMessage(</span><span style="color: blue; line-height: 140%;">string</span><span style="line-height: 140%;">.Format(</span><span style="color: #a31515; line-height: 140%;">"Export completed."</span><span style="line-height: 140%;">));</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </span><span style="color: blue; line-height: 140%;">catch</span><span style="line-height: 140%;"> (map.MapException ex)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; map.Constants.ErrorCode errOdCode = (map.Constants.ErrorCode)ex.ErrorCode;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; MessageBox.Show(</span><span style="color: #a31515; line-height: 140%;">"The following Map exception has occurred:\n\n"</span><span style="line-height: 140%;"> + errOdCode);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </span><span style="color: blue; line-height: 140%;">catch</span><span style="line-height: 140%;"> (System.</span><span style="color: #2b91af; line-height: 140%;">Exception</span><span style="line-height: 140%;"> ex)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; MessageBox.Show(</span><span style="color: #a31515; line-height: 140%;">"The following exception has occurred:\n\n"</span><span style="line-height: 140%;"> + ex.ToString());</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </span><span style="color: blue; line-height: 140%;">static</span><span style="line-height: 140%;"> </span><span style="color: blue; line-height: 140%;">void</span><span style="line-height: 140%;"> DisplayOutputMessage(String str)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Editor.WriteMessage(str);</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&nbsp;&nbsp;&nbsp; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
<p style="margin: 0px;">&nbsp;</p>
<p style="margin: 0px;"><span style="line-height: 140%;"><br /></span></p>
</div>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:
ImportExport, API, SDF
-----
--------
AUTHOR: Madhukar Moogala
AUTHOR EMAIL: fpdtypepadadmin@autodesk.com
TITLE: Welcome to the ADN DevBlog
STATUS: Publish
ALLOW COMMENTS: 1
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: welcome-to-the-adn-devblog

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/2012/02/welcome-to-the-adn-devblog.html 
DATE: 02/20/2012 12:17:25 PM
-----
BODY:
<p>Welcome to our ADN DevBlog for Civil 3D, Map 3D and AIMS and other Autodesk Infrastructure Modeling technologies from Autodesk. This blog is maintained by the Developer Technical Services (DevTech) team – the worldwide team of API gurus providing technical services through the Autodesk Developer Network.</p>
<p>Whenever any of us comes across some information on programming for Autodesk technology that we think you’ll be interested in, then you can expect it to be posted here. That will be technical (how-to) solutions derived from answering questions from ADN partners and from Autodesk forum users, sample projects, white papers screencasts, conference presentation material, and other information derived from our work.</p>
<p>This blog is a vehicle to quickly put lots of up to date information in one place so you can easily find what you need to solve your programming problems. Don’t expect poetry and prose – just good, old-fashioned hard facts. Every member of the DevTech team will be posting information here – and lots of it. Follow us on Twitter, RSS, or just visit us when you need to browse or search for specific information.</p>
<p>You’re very welcome to post additional information on topics or ask questions in the comments section for any blog post you’re interested in. Other Work Groups in DevTech are also starting DevBlogs covering Programming aspects in respective Industry focused areas and relevant Autodesk Technologies in the same domain which you might be interested to know.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Madhukar Moogala
AUTHOR EMAIL: fpdtypepadadmin@autodesk.com
TITLE: Partha Sarkar
STATUS: Publish
ALLOW COMMENTS: 0
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: partha-sarkar

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/partha-sarkar.html 
DATE: 02/20/2012 12:15:58 PM
-----
BODY:
<p><a class="asset-img-link" style="float: left;" href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0163045169f7970d-pi"><img class="asset  asset-image at-xid-6a0167607c2431970b0163045169f7970d" style="margin: 0px 5px 5px 0px;" title="Partha" src="https://adndevblog.typepad.com/.a/6a0167607c2431970b0163045169f7970d-800wi" border="0" alt="Partha" /></a>Partha Sarkar has been with Autodesk since 2002, focusing on providing programming support, consulting, training and evangelism to external developers. He is currently based in Autodesk Bangalore, India office and he leads the Global Infrastructure Modeling group in Developer Technical Services (DevTech), the worldwide team of API gurus providing technical services through the Autodesk Developer Network. His expertise spreads across application development for AutoCAD Civil 3D, AutoCAD Map 3D, Autodesk Infrastructure Map Server (former MapGuide), Topobase and other Infrastructure Modeling Technologies from Autodesk.<br /><br />He has a Bachelor’s and Master’s degree in Civil Engineering from Premier Institutions in India. He is an avid sports fan and goes for anything which is full of fun!</p>
<p>View posts by <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar/">Partha</a>.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
AUTHOR: Madhukar Moogala
AUTHOR EMAIL: fpdtypepadadmin@autodesk.com
TITLE: Test Post
STATUS: Publish
ALLOW COMMENTS: 0
CONVERT BREAKS: wysiwyg
ALLOW PINGS: 0
BASENAME: test-post

UNIQUE URL: https://adndevblog.typepad.com/infrastructure/test-post.html 
DATE: 02/20/2012 12:02:21 PM
-----
BODY:
<p>This is a test entry.</p>
-----
EXTENDED BODY:

-----
EXCERPT:

-----
KEYWORDS:

-----
--------
