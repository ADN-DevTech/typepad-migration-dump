---
layout: "post"
title: "Retrieve the maps or web layouts from AIMS/MGE repository"
date: "2012-08-12 23:51:54"
author: "Daniel Du"
categories:
  - "AIMS 2012"
  - "AIMS 2013"
  - "Daniel Du"
  - "MapGuide Enterprise 2011"
original_url: "https://adndevblog.typepad.com/infrastructure/2012/08/retrieve-the-maps-or-web-layouts-from-aimsmge-repository.html "
typepad_basename: "retrieve-the-maps-or-web-layouts-from-aimsmge-repository"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>
<p>I am asked how to get the list of maps from MapGuide repository. In this post, I will show you how to do it with code, actually it is possible to get a list of resource with specified type, it can be feature source, layer, map or web layout.</p>
<p>The resources can be retrieved by resource service. Here is the help information about EnumerateResources method:</p>
<p><a href="http://adn.autodesk.com/d8/d50/class_mg_byte_reader.htm">MgByteReader</a>* MgResourceService::EnumerateResources     <br />(     <br /><a href="http://adn.autodesk.com/d6/d80/class_mg_resource_identifier.htm">MgResourceIdentifier</a> * resource,     <br /><a href="http://adn.autodesk.com/d2/d04/_foundation_defs_8h_0cb58e7e6f0bad369840a52e54a56ae0.htm#0cb58e7e6f0bad369840a52e54a56ae0">INT32</a> depth,     <br /><a href="http://adn.autodesk.com/d2/d04/_foundation_defs_8h_2697935ae7be4121104b37ff513b810b.htm#2697935ae7be4121104b37ff513b810b">CREFSTRING</a> type     <br />)</p>
<p>Enumerates the resources in the specified repository.</p>
<p>Remarks:</p>
<p>You can enumerate all types or just a selected type. You can also choose what depth in the repository to examine. This method only works on &quot;Library&quot; repository. If you specify a repository that is not supported, this method will throw an MgInvalidRepositoryType exception.</p>
<p>Parameters:</p>
<p><em>resource</em></p>
<p>(<a href="http://adn.autodesk.com/d6/d80/class_mg_resource_identifier.htm">MgResourceIdentifier</a>) Resource identifier specifying the resource to enumerate. This can be a document or a folder.     <br />If it is a folder, you must include the trailing slash in the identifier.</p>
<p><em>depth</em></p>
<p>(int) Recursion depth, relative to the specified resource.</p>
<ul>
<li>If the resource is a document, depth must be set to 0. </li>
<li>If the resource is a folder:      
<ul>
<li>If the depth is equal to 0, only information about the specified folder is returned. </li>
<li>If the depth is greater than 0, information about the folder and its descendants up to the specified depth are returned. </li>
</ul>
</li>
<li>If the depth is -1, information about the folder and all its descendants is returned. </li>
</ul>
<p><em>type</em></p>
<p>(String/string) Type of the resource to be enumerated. (Case sensitive.) See<a href="http://adn.autodesk.com/d0/d19/class_mg_resource_type.htm">MgResourceType </a>for valid types.     <br />Or, this can be set to null, in which case information about all resource types is returned.</p>
<p>Returns:</p>
<p>Returns an <a href="http://adn.autodesk.com/d8/d50/class_mg_byte_reader.htm">MgByteReader</a> object containing a description of the resources in XML format using the <a href="http://adn.autodesk.com/de/daa/group___resource_list__schema.htm">ResourceList </a>schema.</p>
<p>The resource type can be specified by member of MgResourceType.</p>
<p>&#0160;</p>
<p>For your information, following the implementation of MgResourceType, it is included in MapGuide WebExtension API, you DO NOT need to implement it yourself.</p>
<div style="background: white;">
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">class</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #2b91af;">MgResourceType</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160; {</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">// For flexible weblayout</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">const</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">string</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> ApplicationDefinition = </span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;ApplicationDefinition&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">;&#0160; </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">const</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">string</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> DrawingSource = </span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;DrawingSource&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">const</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">string</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> FeatureSource = </span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;FeatureSource&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">const</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">string</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> Folder = </span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;Folder&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">const</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">string</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> LayerDefinition = </span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;LayerDefinition&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">const</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">string</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> LoadProcedure = </span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;LoadProcedure&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">// For runtime map</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">const</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">string</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> Map = </span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;Map&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">// For map definition&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">const</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">string</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> MapDefinition = </span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;MapDefinition&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">const</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">string</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> PrintLayout = </span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;PrintLayout&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">const</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">string</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> Selection = </span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;Selection&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">const</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">string</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> SymbolDefinition = </span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;SymbolDefinition&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">const</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">string</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> SymbolLibrary = </span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;SymbolLibrary&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">// For basic weblayout&#0160; </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">const</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">string</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> WebLayout = </span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;WebLayout&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> MgResourceType();</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160; }</span></span></span></p>
</div>
<p>Following code snippet demonstrates how to get all maps, you make some minior changes to retrieve other type of resources very easily:</p>
<div style="background: white;">
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #808080;"><span style="font-size: 8pt;">///</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #008000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #808080;">&lt;summary&gt;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #808080;"><span style="font-size: 8pt;">///</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">&#0160; enumberate all the map definitions in the </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #808080;"><span style="font-size: 8pt;">///</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #008000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #808080;">&lt;/summary&gt;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #808080;"><span style="font-size: 8pt;">///</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #008000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #808080;">&lt;param name=&quot;resId&quot;&gt;&lt;/param&gt;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #808080;"><span style="font-size: 8pt;">///</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #008000;"> </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #808080;">&lt;returns&gt;&lt;/returns&gt;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">public</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;"> Dictionary&lt;</span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">string</span></span><span style="line-height: 11pt;"><span style="color: #000000;">, </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">string</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">&gt; GetAllMaps(MgResourceIdentifier resId)</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">{</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; Dictionary&lt;</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">string</span></span><span style="line-height: 11pt;"><span style="color: #000000;">, </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">string</span></span><span style="line-height: 11pt;"><span style="color: #000000;">&gt; mapList = </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">new</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> Dictionary&lt;</span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">string</span></span><span style="line-height: 11pt;"><span style="color: #000000;">, </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">string</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">&gt;();</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160; MgResourceService resSvc = siteConnection.CreateService</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; (MgServiceType.ResourceService) </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">as</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> MgResourceService;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">// Get all map def resources</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">// MgResourceType.WebLayout for basic weblayout and </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">// MgResourceType.ApplicationDefinition for flexible weblayout</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160; MgByteReader byteRdr = resSvc.EnumerateResources(resId, -1, </span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; MgResourceType.MapDefinition);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">//Convert to string </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">String</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> MapResStr = byteRdr.ToString();</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">//Load into XML document so we can parse and get the names of the maps</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; XmlDocument doc = </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">new</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> XmlDocument();</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160; doc.LoadXml(MapResStr);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; </span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #008000;">//let&#39;s extract the map names and list them&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160; XmlNodeList MapResIdNodeList;</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160; XmlElement root = doc.DocumentElement;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; MapResIdNodeList = root.SelectNodes(</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;//ResourceId&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">int</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> nRes = MapResIdNodeList.Count;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">for</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> (</span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">int</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> i = 0; i &lt; nRes; i++)</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160; {</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160; XmlNode MapResIdNode = MapResIdNodeList.Item(i);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">String</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> MapRes = MapResIdNode.InnerText;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">int</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> index1 = MapRes.LastIndexOf(</span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&#39;/&#39;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">) + 1;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">int</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> index2 = MapRes.IndexOf(</span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;MapDefinition&quot;</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;">) - 2;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">int</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> length = index2 - index1 + 1;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">string</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> mapName = MapRes.Substring(index1, length);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">if</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> (!mapList.ContainsKey(mapName))</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160; {</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; mapList.Add(mapName, MapRes);</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160; }</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160; }</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">return</span></span></span><span style="line-height: 11pt;"><span style="font-size: 8pt; color: #000000;"> mapList;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: &#39;Courier New&#39;;"><span style="font-size: 8pt; color: #000000;">}</span></span></span></p>
</div>
<p>Hope this helps.</p>
