---
layout: "post"
title: "Visual Studio .NET settings for Civil 3D 2015"
date: "2014-04-25 07:26:46"
author: "Augusto Goncalves"
categories: []
original_url: "https://adndevblog.typepad.com/infrastructure/2014/04/visual-studio-net-settings-for-civil-3d-2015.html "
typepad_basename: "visual-studio-net-settings-for-civil-3d-2015"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>Now that we have released <a href="http://www.autodesk.com/products/autodesk-autocad-civil-3d/free-trial">Civil 3D 2015</a>, you might be wondering what is required to create a .NET addin project for this new release. First, let me point out that if you have a Civil 3D 2014 .NET addin, it should just work on 2015 in compatibility mode (.NET supports older versions).</p>  <p><strong>Platform changes for Civil 3D 2015</strong></p>  <p>There are some major changes you need to consider when creating a new addin. As mentioned, 2014 addins should work in compatibility mode. Here are the main points:</p>  <ul>   <li>Visual Studio 2012 </li>    <li>.NET 4.5 </li>    <li>64 bit only – since 2014 </li>    <li>No Windows XP support </li> </ul>  <p><strong>Configurable AutoCAD &amp; Civil 3D</strong></p>  <p>Now an interesting point: there is no Civil 3D 2015 install folder, it’s actually installed at the same folder as plain AutoCAD and there is a subfolder with Civil 3D specific files: [\Program Files\Autodesk\AutoCAD 2015\C3D]. Actually this change started back on 2014, see more details at <a href="http://adndevblog.typepad.com/autocad/2013/06/new-2014-configurable-autocad-installation-structure.html">this post</a>.</p>  <p>This also means the Civil 3D will actually start AutoCAD with a few parameters. For instance, this is the default icon target for Metric profile: <strong>&quot;C:\Program Files\Autodesk\AutoCAD 2015\acad.exe&quot; /ld &quot;C:\Program Files\Autodesk\AutoCAD 2015\\AecBase.dbx&quot; /p &quot;&lt;&lt;C3D_Metric&gt;&gt;&quot; /product &quot;C3D&quot;</strong></p>  <p>This change will affect our project settings… let’s see.</p>  <p><strong>Required .NET references</strong></p>  <p>First, as usual, we need to add reference to AutoCAD .NET references. Those are required as Civil 3D was build on top of AutoCAD. You may choose to download the <a href="http://www.autodesk.com/objectarx">ObjectARX SDK</a> and get the references from [\ObjectARX 2015\inc] folder or simply get them from [\Program Files\Autodesk\AutoCAD 2015] folder. As Civil 3D 2015 is 64 bit only, there is no relevant difference between them. Here are the AutoCAD references required:</p>  <ol>   <li><strong>AcMgd.dll</strong> – AutoCAD interface objects </li>    <li><strong>AcCoreMgd.dll</strong> – Core objects, used on both AutoCAD and Console </li>    <li><strong>AcDbMgd.dll</strong> – Database objects, required to access the drawing data </li> </ol>  <p>Now, Civil 3D will require its reference. As there is no SDK for Civil 3D, the reference is located [\Program Files\Autodesk\AutoCAD 2015\C3D] folder:</p>  <ol>   <li><strong>AeccDbMgd.dll</strong> – Civil 3D main objects </li> </ol>  <p>When you start writing code, it will complain that another reference is missing. Actually our AEC products share some objects, therefore Civil 3D also needs reference to this common DLL located under AutoCAD [\Program Files\Autodesk\AutoCAD 2015] folder:</p>  <ol>   <li><strong>AecBaseMgd.dll</strong> – AEC common objects, not directly used, but required </li> </ol>  <p>There are some other references, but those 5 are required, all others are optional and only used on specific features;</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01a3fcf98b01970b-pi"><img title="copylocal_false" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; margin-left: 0px; display: inline; border-top-width: 0px; margin-right: 0px" border="0" alt="copylocal_false" src="/assets/image_777d14.jpg" width="199" align="right" height="297" /></a>By default, Visual Studio will assume the&#160; references are required to run this code and then make a copy of the under the [\bin\] output folder of your .NET project. But, as this addin will load and run inside AutoCAD Civil 3D, the references are already there. <strong>So we need to specify the references as ‘Copy Local’ equals false</strong>. This is extremely important, otherwise Civil 3D will get confused and start crashing randomly. </p>  <p>Finally it’s time to build, but you’ll see a warning saying: “<em>there was a mismatch between the processor architecture of the project being built</em>”. This is somehow expected as the AutoCAD and Civil 3D references are 64 bit and the .NET project is Any CPU. You can simply ignore this warning or go to project settings and change the ‘Platform target’ to ‘x64’ (64 bit).</p>  <p><strong>Setting up Debug options</strong></p>  <p>Now we’re ready to debug the project. As Civil 3D is running as a configurable AutoCAD, you need to specify a few command line arguments. Actually, the same used on the icon. Below is a sample assuming the default install folder with Metric profile.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01a3fcf98b07970b-pi"><img title="debug_VS" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; display: inline; border-top-width: 0px" border="0" alt="debug_VS" src="/assets/image_aa386f.jpg" width="462" height="281" /></a> </p>  <p></p>  <p></p>  <p></p>  <p></p>  <p></p>  <p></p>  <p>That’s it! You should be able to start developing for AutoCAD Civil 3D 2015 with these settings. Next topic, let’s talk about Interop settings.</p>
