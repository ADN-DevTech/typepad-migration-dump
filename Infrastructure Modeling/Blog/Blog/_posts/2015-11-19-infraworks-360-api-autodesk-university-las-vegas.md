---
layout: "post"
title: "InfraWorks 360 API @ Autodesk University Las Vegas"
date: "2015-11-19 03:12:04"
author: "Augusto Goncalves"
categories:
  - "Infraworks 360"
original_url: "https://adndevblog.typepad.com/infrastructure/2015/11/infraworks-360-api-autodesk-university-las-vegas.html "
typepad_basename: "infraworks-360-api-autodesk-university-las-vegas"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>Are you going to AU Las Vegas? If so, my class on <strong>InfraWorks 360 API - Sharing Model and Proposal Data </strong>will be Thursday, Dec 3rd, 3pm. If you cannot attend, here is the handout, enjoy.</p>  <p><strong>1. Start developing apps based on InfraWorks 360 REST API</strong> </p>  <p>To start developing with the REST API, first there are some required background topics. This material will not cover them in deep, but there are lots of resources on the web.</p>  <p><strong>Background </strong></p>  <p>The InfraWorks 360 model data available to be accessed via API is seating on the Autodesk Cloud servers and the protocol to talk with that server is REST (Representational State Transfer). In summary it’s quite similar to connect via regular browser, but with parameters (like when we submit a form on a webpage) and a reply format in JSON (JavaScript Object Notation), basically plain text with a standard notation for objects, properties and collections. </p>  <p><strong>Required Software and Libraries</strong> </p>  <p>First it’s required to have models on your account, so you should install InfraWorks 360 and create a model that will be accessed via API. If the model is created locally, it must be synched to the Autodesk Cloud, only then it will be accessible via API. As expected, any local change will not be visible via API until the model is synched again.</p>  <p>The communication code can be written in any language that has support for&#160; REST protocols. In fact, as REST is language agnostic, any language should work, but not every language have the libraries to do so. Most modern languages are natively compatible or have libraries to do so. For instance, in .NET, the RestSharp (<a href="http://restsharp.org)">http://restsharp.org)</a> should have all the main features.</p>  <p>The response will come in plain text formatted as JSON. Although we can read it (human-readable), it’s easier to deserialize into objects on your preferred language. From JSON to .NET Objects, for instance, the Newtonsoft.JSON library (<a href="https://www.nuget.org/packages/Newtonsoft.Json">https://www.nuget.org/packages/Newtonsoft.Json</a> ) can do the trick. To clarify, deserialize is the process of converting an object stored into an object in memory. For this process, we need the classes representing the JSON structure. We provide that class structure in .NET (we’ll talk about sample later in this material), just like many other libraries for other APIs.</p>  <p>The samples presented here were developed using .NET with Visual Studio, which is the same developing language supported for AutoCAD Civil 3D (and for other Autodesk desktop prodcuts). This language was selected by convenience and any other language with support for REST should work.</p>  <p><strong>2. Discover the data structure of the API</strong> </p>  <p>The API structure is basically the same as the product: for each account, there are models that represent a specific area and contains one or more proposals, with different designs for that specific area, then the features, such as road, buildings, trees, etc.    <br />On the API perspective, the first level resides at <a href="https://api.infraworks.autodesk.com">https://api.infraworks.autodesk.com</a>, but it doesn’t contain relevant model information, just some basic server information.</p>  <p><strong>Models</strong> </p>  <p>The first URL level to provide information is <strong>https://api.infraworks.autodesk.com/models</strong> and contains a list of models for the logged user, as shown on the example below. Note the id and name of each model, and the model id will be used on the next calls. </p>  <p>Using the model id, the response from <strong>https://api.infraworks.autodesk.com/models/:model_id</strong> will contain the name, boundary, list of proposals, among other properties. Below is a sample reply: </p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b7c7ee9990970b-pi"><img title="model" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="model" src="/assets/image_008050.jpg" width="429" height="446" /></a> </p>  <p><strong>Proposals</strong> </p>  <p>To access a specific proposal, we will need the model_id along with the proposal_name, obtained on the model level. The URL is <strong>https://api.infraworks.autodesk.com/models/:model_id/propsals/:proposal_name</strong>.&#160; As we can see, each level uses a URL build on top of the previous level URL.     <br />Below is a sample response for a proposal call (end-point). Note the list of available features at the bottom, the href parameter contains the URL for each feature collection. </p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01bb0892bbdb970d-pi"><img title="proposal" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="proposal" src="/assets/image_fad518.jpg" width="434" height="396" /></a> </p>  <p><strong>Features</strong> </p>  <p>At this level we can access the items (features) placed on the model’s proposal. The URL consists in <strong>https://api.infraworks.autodesk.com/models/:model_id/proposals/:proposal_name/:feature_type/</strong> and contains the model_id, the proposal_name and, finally, the feature_type, which will return a list of features.     <br />The feature types can be:     <br />•&#160;&#160;&#160; Barrier     <br />•&#160;&#160;&#160; Buildings     <br />•&#160;&#160;&#160; City furniture     <br />•&#160;&#160;&#160; Constraint definition     <br />•&#160;&#160;&#160; Coverages     <br />•&#160;&#160;&#160; Horizontal and Vertical constraint     <br />•&#160;&#160;&#160; Intersection and Intersection region     <br />•&#160;&#160;&#160; Markup     <br />•&#160;&#160;&#160; Pipe connector and Pipeline     <br />•&#160;&#160;&#160; Point clouds     <br />•&#160;&#160;&#160; Points of Interest (POI)     <br />•&#160;&#160;&#160; Railway     <br />•&#160;&#160;&#160; Road     <br />•&#160;&#160;&#160; Terrain surface and texture     <br />•&#160;&#160;&#160; Trees     <br />•&#160;&#160;&#160; Water     <br /><a href="http://api-docs.infraworks.autodesk.com/ref_guide/rg_collections_and_representations.html">Full list here</a>. After the list, next step is read the feature data itself. Each different feature will have different information, but the calling URL should be in the same format, using the model_id, proposal_name, feature_type and the its id: <a href="http://api.infraworks.autodesk.com/models/:model_id/proposals/:proposal_name/:feature_type/:id">http://api.infraworks.autodesk.com/models/:model_id/proposals/:proposal_name/:feature_type/:id</a>. Here is a sample response for a tree feature type: </p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d1785fdf970c-pi"><img title="feature" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="feature" src="/assets/image_5b75f4.jpg" width="494" height="253" /></a> </p>  <p>Some feature properties are expected for all types of features, such as revision and id. </p>  <p><strong>Learn how to make calls to InfraWorks 360 REST API</strong> </p>  <p>InfraWorks 360 REST API uses the OAuth 2.0 authentication, that requires a key &amp; secret on the developer side, plus a user login &amp; password on the user side. The developer authentication is required to increase security and avoid attacks to Autodesk servers. The user authentication certifies confidentially of each user’s information.</p>  <p>The first step is authenticate using the developer key &amp; secret on <a href="https://accounts.autodesk.com">https://accounts.autodesk.com</a> server, which will return a authorization token, allowing access to the API. With this token, your application can ask the user to login on the same server and, if ok, will return a verifier, that allows access to the user’s data. This process is known as “2 legged authentication” and is required because a developer and the user are different personas, and both need to authorization, to use the API and read the data. </p>  <p>All requests to the InfraWorks 360 REST API must have a header indicating the type of response required. If not, the server will automatically redirect to the documentation (and will not return API data). The header should include (along with the authentication token) the following “Accept” requirement:</p>  <p><strong>application/vnd.autodesk.infraworks-v1+json</strong></p>  <p>With this header, we just need to connect to the server using the URLs described on the previous topic. Each request will require a different URL (end-point). For instance, to get a model with ID 1234, make a request with /models/1234. </p>  <p>In C# .NET, using RestSharp and Newtonsoft.JSON libraries, it would be like:</p>  <pre style="font-size: 13px; font-family: consolas; background: white; color: black"><span style="color: green">// Required since relase May/2015 – TLS 1.2</span><br />System.Net.<span style="color: #2b91af">ServicePointManager</span>.SecurityProtocol =<br />&#160; System.Net.<span style="color: #2b91af">SecurityProtocolType</span>.Tls12;<br /> <br /><span style="color: green">// base client URL</span><br />RestClient client = <span style="color: blue">new</span> RestClient(<span style="color: #a31515">&quot;https://api.infraworks.autodesk.com&quot;</span>);<br /> <br /><span style="color: green">// consumer key &amp; secret + authorization tokens</span><br />OAuth1Authenticator authenticator = OAuth1Authenticator.ForProtectedResource(<br />&#160; consumerKey, consumerSecret, accessToken, accessTokenSecret);<br />client.Authenticator = authenticator;<br /> <br /><span style="color: green">// resource we need to access</span><br />RestRequest request = <span style="color: blue">new</span> RestRequest(<span style="color: #a31515">&quot;/models/1234&quot;</span>, Method.GET);<br />request.RequestFormat = DataFormat.Json;<br />request.AddHeader(<span style="color: #a31515">&quot;Accept&quot;</span>, <span style="color: #a31515">&quot;application/vnd.autodesk.infraworks-v1+json&quot;</span>);<br /> <br /><span style="color: green">// make the call</span><br />IRestResponse response = client.Execute(request);<br /> <br /><span style="color: green">// treat the results</span><br /><span style="color: blue">if</span> (response.StatusCode == System.Net.<span style="color: #2b91af">HttpStatusCode</span>.OK)<br />{<br />&#160; <span style="color: blue">string</span> json = response.Content;<br />&#160; <span style="color: green">// deserialize the JSON return into objects in .NET</span><br />&#160; <span style="color: blue">return</span> JsonConvert.DeserializeObject(json, <span style="color: blue">typeof</span>(Model));<br />}<br /><span style="color: blue">else</span><br />{<br />&#160; <span style="color: green">// many problems can happen...treat error here</span><br />&#160; <span style="color: blue">return</span>&#160;<span style="color: blue">null</span>;<br />}</pre>

<p>Note this is just a schematic, on a real application, this should be optimized (reuse variables) and adjusted according to each scenario. See next section for more sample code.</p>

<p><strong>Discover sample scenarios of integration</strong> </p>

<p>There is a huge number of webservices available on the web, providing all types of data. Most likely, your application will collect data from different sources and mashup different providers and create a unique interface. 
  <br />How we can we mashup webservices?

  <br />First we need to find out what makes sense. As InfraWorks 360 store geolocated city design information, it’s make sense to link to other geolocated data. There is an extensive catalog of webservice APIs at the <a href="http://www.programmableweb.com">Programmable Web</a>, check the Mapping and Geography categories for interesting providers. </p>

<p><strong>InfraWorks 360 + Four Square + Google Maps</strong> </p>

<p>This sample was originally presented at this blog post and now updated. It reads the buildings of the InfraWorks 360 model and, using the location information, asks the Four Square API for nearby venues. The result is shown at a Google Maps with the InfraWorks 360 location of the building and the Four Square location of the venue found and selected.</p>

<p>Just like Autodesk Cloud APIs, to use Four Square API you will need a key &amp; secret. To get more information about their API program, please <a href="https://developer.foursquare.com">visit here</a>. Below is a quick print-screen of the sample running. To use it with your personal account, please <a href="http://infraworks360samples.azurewebsites.net/IW360Demo.aspx">visit here</a>. and login with your Autodesk Account (the same used on InfraWorks 360). Note that you must have at least 1 model on that account. The source code is available at the sample sample page. </p>

<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d1785fe5970c-pi"><img title="sample1" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="sample1" src="/assets/image_856d3a.jpg" width="467" height="120" /></a> </p>

<p>About the technology: the sample was developed with ASP.NET (server side) and uses JavaScript (client side) to automate the interface with the <a href="https://jquery.com">JQuery library</a></p>

<p><strong>InfraWorks 360 + Google Maps</strong> </p>

<p>This sample aims to show 3D buildings from InfraWorks 360 on web map. As you may know and use, there is a 3D version of the Google Maps where we can see the city (mostly buildings) in 3D. It’s a cool interface. Despite there some APIs around the maps, there is no JavaScript API to interact with the 3D version.
  <br />After some searching, I found the John Dyer blog with a nice sample: Drawing 3D Objects and Buildings on Google Maps. After reading and understanding the code, you will see that it is actually a 2 + ½ D, not actually a 3D: the buildings are drawn in perspective to look like 3D. </p>

<p>Using InfraWorks 360 building polygon information and John Dyer’s code to draw the buildings, the result will be like shown below: </p>

<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d1785fed970c-pi"><img title="sample2" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="sample2" src="/assets/image_4c6a7b.jpg" width="470" height="206" /></a> </p>

<p>And you can try with your models (using your Autodesk Account with InfraWorks 360 models) at <a href="http://infraworks360samples.azurewebsites.net/BuildingOnGMaps.aspx">this link</a>.</p>

<p><strong>InfraWorks 360 + AutoCAD Civil 3D</strong> </p>

<p>Sure we can also integrate with AutoCAD Civil 3D. As you may know some integration is already available via Productivity Pack, but this is just to demonstrate the idea. </p>

<p>This sample demonstrating how bring InfraWorks 360 Roads into AutoCAD Civil 3D as Alignments is available at the <a href="http://adndevblog.typepad.com/infrastructure/2014/10/importing-alignment-from-infraworks-360-to-civil-3d.html">Importing Alignment from InfraWorks 360 to AutoCAD Civil 3D</a> blog post and was also the sample presented at my Autodesk University 2014 class <a href="http://au.autodesk.com/au-online/classes-on-demand/class-catalog/2014/infraworks/sd6503">SD6503</a>.</p>
