---
layout: "post"
title: "Intelligent landing page for AIMS/MapGuide Ajax viewer"
date: "2012-09-27 20:45:25"
author: "Daniel Du"
categories:
  - "AIMS 2012"
  - "AIMS 2013"
  - "Daniel Du"
  - "MapGuide Enterprise 2011"
  - "Web"
original_url: "https://adndevblog.typepad.com/infrastructure/2012/09/intelligent-landing-page-for-aimsmapguide-ajax-viewer-1.html "
typepad_basename: "intelligent-landing-page-for-aimsmapguide-ajax-viewer-1"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/infrastructure/daniel-du.html">Daniel Du</a></p>  <p>You may come across the <a href="http://trac.osgeo.org/mapguide/wiki/CodeSamples/PHP/InitialMapView">InitialMapView</a> sample page in php, It expects the values to be passed to the script as query string parameters, and zoom to specified view port when loading the map. Here is an intelligent landing page MapGuide Viewer in .NET, and with more extended functionalities. </p>  <p>&#0160;</p>  <h4>What is the function of this sample application?</h4>  <p>1. Zoom to specified view port by initial x, y and scale, the URL is expected as below: <a href="http://serverName/MgViewerExtention/Default.aspx?X=-87.723233&amp;Y=43.754561&amp;scale=5000">http://serverName/MgViewerExtention/Default.aspx?X=-87.723233&amp;Y=43.754561&amp;scale=5000</a>     <br />It works by taking a copy of the <em><a>WebLayout</a></em> stored in the <em>Library repository</em> and changing the &lt;CenterX/&gt;, &lt;CenterY/&gt; and &lt;Scale/&gt; elements. The updated XML is written into the <em>Session</em> and is used as the target when the page is ultimately loaded.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017c322fe1d9970b-pi"><img alt="image" border="0" height="357" src="/assets/image_eb5567.jpg" style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" width="470" /></a></p>  <p>&#0160;</p>  <p>2. Query, zoom to and highlight by filter string. It accepts layer name, keyFieldID and id value, for following URL, map viewer zooms to the objects corresponding to “Autogenerated_SDF_ID in (1812,1813)” in the layer Parcels, highlighted if “highlight=1”.</p>  <p><a href="http://localhost/MgViewerExtention/Default.aspx?Layer=Parcels&amp;KeyField=Autogenerated_SDF_ID&amp;ListId=1812,1813&amp;highlight=1" title="http://localhost/MgViewerExtention/Default.aspx?Layer=Parcels&amp;KeyField=Autogenerated_SDF_ID&amp;ListId=1812,1813&amp;highlight=1">http://localhost/MgViewerExtention/Default.aspx?Layer=Parcels&amp;KeyField=Autogenerated_SDF_ID&amp;ListId=1812,1813&amp;highlight=1</a></p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017d3c5e144d970c-pi"><img alt="image" border="0" height="361" src="/assets/image_317ac6.jpg" style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" width="475" /></a></p>  <p>&#0160;</p>  <p>3. Filter features shown on map. You may have thousands even millions of features in a data source, but sometime you do not need to show all of them on map. With a filter string in URL, you can filter the features in MapGuide viewer when the viewer shows up. With following URL, I only show the parcels which Autogenerated_SDF_ID great than 1000:</p>  <p><a href="http://localhost/MgViewerExtention/Default.aspx?Layer=Parcels&amp;layerfilter=Autogenerated_SDF_ID">http://localhost/MgViewerExtention/Default.aspx?Layer=Parcels&amp;layerfilter=Autogenerated_SDF_ID</a> &gt; 10000</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017c322fe20c970b-pi"><img alt="image" border="0" height="404" src="/assets/image_95b4b3.jpg" style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" width="459" /></a></p>  <p>&#0160;</p>  <p>The sample project can be downloaded<a href="http://adndevblog.typepad.com/files/mgviewerextention.zip" target="_self"> here</a>, it is based on AIMS 2013, but it could be easy to apply it to other version of AIMS/MapGuide. If you are interested in how it is implemented in detail, please download and read the code. Hope it helps.</p>  <p><a href="http://adndevblog.typepad.com/files/mgviewerextention.zip">Download MgViewerExtention</a></p>  <p>&#0160;</p>  <p><font color="#ff0000">[Updated: October, 26, 2012]</font></p>  <h4>How to install this sample application?</h4>  <p>I am often asked how to install/use this sample application, here is the detailed steps:</p>  <p>1. unzip the sample application to a folder of your web server where Map Server Extension is installed. Let’s say: C:\Work\CodeSamples\MgViewerExtention</p>  <p>2. Copy all dlls from “C:\Program Files\Autodesk\Autodesk Infrastructure Web Server Extension 2013\www\mapviewernet\bin” to “C:\Work\CodeSamples\MgViewerExtention\MgViewerExtention\bin”</p>  <p>3. Copy “WebConfig.ini” from “C:\Program Files\Autodesk\Autodesk Infrastructure Web Server Extension 2013\www” to “C:\Work\CodeSamples\MgViewerExtention\MgViewerExtention”</p>  <p>4. Since I am using web application as visual studio project, you need to rebuild the project. Open the “MgViewerExtention.sln” file in Visual Studio 2010, add references to OSGeo.MapGuide.* from MgViewerExtention\bin folder and set “CopyLocal” to FALSE. Then Build and fix any outstanding problems. </p>  <p>5. Open Internet Information Services(IIS) Manager by typing “inetmgr” in Start –&gt; Run</p>  <p>6. Add a application in IIS. Right click “Default Web Site” and select “Add Application”, input alias as “MgViewerExtension”, please note that the URL to access this web application will be http://localhost/&lt;yourAliasName&gt;, for me it is <a href="http://localhost/MgViewer/Extension">http://localhost/MgViewer/Extension</a>.&#0160; It is recommend to select &quot;MapServer2013App” as application pool. You will notice that it is using .net Framework 4.0 for AIMS2013.&#0160; The physical path refers to the folder which contains the ASPX web page, for me, it is C:\Work\CodeSamples\MgViewerExtention\MgViewerExtention.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017d3cfea3b8970c-pi"><img alt="image" border="0" height="350" src="/assets/image_052280.jpg" style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" width="439" /></a></p>  <p>7. Give it a run and test, refer to the top of this post for test URLs.</p>  <h4>&#0160;</h4>  <h4>How to Debug and Extend this further? </h4>  <p>1. Open the “MgViewerExtention.sln” solution is Visual Studio 2010, set an break points at somewhere. </p>  <p>2. Launch the browser to the MgViewerExtension.</p>  <p>3. Attach to process from Debug menu, attach to “w3wp”, please note the username should be “MapServer2013App” as it may have more than one “w3wp” process. </p>  <p>4. Refresh the webpage, your break point will be hit.</p>  <p>Please refer to this video at <a href="http://autodesk.com/developmapguide">MapServer Developer Center</a>, it is for AIMS 2012 x64, but it still applies to AIMS 2013 as well.</p>  <p><b>Video : Autodesk® Infrastructure Map Server 2012 API Webcast      <br /></b>Recorded version of the Autodesk® Infrastructure Map Server 2012 API webcast     <br /><a href="http://download.autodesk.com/media/adn/AIMS2012_Webcast_English/AIMS2012_Webcast_English.html">View Online</a> | <a href="http://download.autodesk.com/media/adn/AIMS2012_Webcast_English.zip">Download</a></p>  <p>&#0160;</p>  <p>It should be easy to use it for AIMS 2012 as well, Here are some critical point to be noticed: </p>  <p>1. Using the correct Dlls/References of AIMS2012</p>  <p>2. Change Target Framework to .NET Framework 3.5 in Visual Studio.</p>    <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017d3d1b6ccb970c-pi"><img alt="image" border="0" height="268" src="/assets/image_a09a78.jpg" style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" width="450" /></a></p>  <p>3. Change the url of viewer path: </p>  <pre>&#0160;&#0160;&#0160;&#0160; string viewerPathSchema = @&quot;/mapserver<strong>2012</strong>/mapviewerajax/<br />       ajaxviewer.aspx?Weblayout={1}&amp;SESSION={0}&quot;;</pre>

<p>4.&#0160; Rebuild and fix any outstanding problems.</p>

<p>5.&#0160; Select an application pool with .NET Framework 2.0(ASP.NET 2.0) when creating Applications in IIS:</p>

<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017d3d1b6d0b970c-pi"><img alt="image" border="0" height="334" src="/assets/image_307e9a.jpg" style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" width="473" /></a></p>

<p>&#0160;</p>

<p>Hope this helps.</p>
