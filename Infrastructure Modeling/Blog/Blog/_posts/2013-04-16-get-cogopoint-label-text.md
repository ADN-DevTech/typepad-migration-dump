---
layout: "post"
title: "Get CogoPoint label text"
date: "2013-04-16 07:04:36"
author: "Augusto Goncalves"
categories:
  - ".NET"
  - "Augusto Goncalves"
  - "AutoCAD Civil 3D 2013"
original_url: "https://adndevblog.typepad.com/infrastructure/2013/04/get-cogopoint-label-text.html "
typepad_basename: "get-cogopoint-label-text"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>The <strong>CogoPoint</strong> object on Civil 3D can hold labels with more information than the regular Description, which contains only part of the information (and sometimes not the same showed on the point).</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017eea4c20f9970d-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="point_description" border="0" alt="point_description" src="/assets/image_994009.jpg" width="443" height="213" /></a></p>  <p>One alternative could be the <em>CogoPoint.GetLabelTextComponentOverride</em> method, passing the IDs obtained from. <u>Unfortunately this will output the format of the text</u>, as shown on the Text Component Editor, <u>not the actual value</u>. </p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017eea4c211f970d-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="point_label_component" border="0" alt="point_label_component" src="/assets/image_7bc65f.jpg" width="449" height="243" /></a></p>  <p>So one workaround, although not very elegant, can be explode the CogoPoint in memory, then explode again and again all the containing BlockReference and MText objects, to end up with DBText, which is the information we seek. The following code show the idea.</p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px">[<span style="color: #2b91af">CommandMethod</span>(<span style="color: #a31515">&quot;getPointText&quot;</span>)]</p>    <p style="margin: 0px"><span style="color: blue">public</span> <span style="color: blue">void</span> CmdGetPointText()</p>    <p style="margin: 0px">{</p>    <p style="margin: 0px">&#160; <span style="color: #2b91af">Editor</span> ed = <span style="color: #2b91af">Application</span>.DocumentManager.MdiActiveDocument.Editor;</p>    <p style="margin: 0px">&#160; <span style="color: #2b91af">PromptEntityResult</span> resPoint = ed.GetEntity(<span style="color: #a31515">&quot;Select point: &quot;</span>);</p>    <p style="margin: 0px">&#160; <span style="color: blue">if</span> (resPoint.Status != <span style="color: #2b91af">PromptStatus</span>.OK) <span style="color: blue">return</span>;</p>    <p style="margin: 0px">&#160; ed.WriteMessage(GetText(resPoint.ObjectId));</p>    <p style="margin: 0px">}</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">private</span> <span style="color: blue">string</span> GetText(<span style="color: #2b91af">ObjectId</span> id)</p>    <p style="margin: 0px">{</p>    <p style="margin: 0px">&#160; <span style="color: green">// store the DBTexts</span></p>    <p style="margin: 0px">&#160; <span style="color: #2b91af">StringBuilder</span> entityText = <span style="color: blue">new</span> <span style="color: #2b91af">StringBuilder</span>();</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: #2b91af">Database</span> db = <span style="color: #2b91af">Application</span>.DocumentManager.</p>    <p style="margin: 0px">&#160;&#160;&#160; MdiActiveDocument.Database;</p>    <p style="margin: 0px">&#160; <span style="color: blue">using</span> (<span style="color: #2b91af">Transaction</span> trans = db.</p>    <p style="margin: 0px">&#160;&#160;&#160; TransactionManager.StartTransaction())</p>    <p style="margin: 0px">&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">// open the entity</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #2b91af">Entity</span> point = trans.GetObject(id, </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">OpenMode</span>.ForRead) <span style="color: blue">as</span> <span style="color: #2b91af">Entity</span>;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">// do a full explode (considering explode again</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">// all BlockReferences and MText)</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #2b91af">List</span>&lt;<span style="color: #2b91af">DBObject</span>&gt; objs = FullExplode(point);</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">foreach</span> (<span style="color: #2b91af">Entity</span> ent <span style="color: blue">in</span> objs)</p>    <p style="margin: 0px">&#160;&#160;&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: green">// now get the text of each DBText</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> (ent.GetType() == <span style="color: blue">typeof</span>(<span style="color: #2b91af">DBText</span>))</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">DBText</span> text = ent <span style="color: blue">as</span> <span style="color: #2b91af">DBText</span>;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; entityText.AppendLine(text.TextString);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; }</p>    <p style="margin: 0px">&#160;&#160;&#160; }</p>    <p style="margin: 0px">&#160;&#160;&#160; trans.Commit();</p>    <p style="margin: 0px">&#160; }</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: blue">return</span> entityText.ToString();</p>    <p style="margin: 0px">}</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">private</span> <span style="color: #2b91af">List</span>&lt;<span style="color: #2b91af">DBObject</span>&gt; FullExplode(<span style="color: #2b91af">Entity</span> ent)</p>    <p style="margin: 0px">{</p>    <p style="margin: 0px">&#160; <span style="color: green">// final result</span></p>    <p style="margin: 0px">&#160; <span style="color: #2b91af">List</span>&lt;<span style="color: #2b91af">DBObject</span>&gt; fullList = <span style="color: blue">new</span> <span style="color: #2b91af">List</span>&lt;<span style="color: #2b91af">DBObject</span>&gt;();</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160; <span style="color: green">// explode the entity</span></p>    <p style="margin: 0px">&#160; <span style="color: #2b91af">DBObjectCollection</span> explodedObjects = <span style="color: blue">new</span> <span style="color: #2b91af">DBObjectCollection</span>();</p>    <p style="margin: 0px">&#160; ent.Explode(explodedObjects);</p>    <p style="margin: 0px">&#160; <span style="color: blue">foreach</span> (<span style="color: #2b91af">Entity</span> explodedObj <span style="color: blue">in</span> explodedObjects)</p>    <p style="margin: 0px">&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">// if the exploded entity is a blockref or mtext</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">// then explode again</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">if</span> (explodedObj.GetType() == <span style="color: blue">typeof</span>(<span style="color: #2b91af">BlockReference</span>) ||</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; explodedObj.GetType() == <span style="color: blue">typeof</span>(<span style="color: #2b91af">MText</span>))</p>    <p style="margin: 0px">&#160;&#160;&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; fullList.AddRange(FullExplode(explodedObj));</p>    <p style="margin: 0px">&#160;&#160;&#160; }</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">else</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160; fullList.Add(explodedObj);</p>    <p style="margin: 0px">&#160; }</p>    <p style="margin: 0px">&#160; <span style="color: blue">return</span> fullList;</p>    <p style="margin: 0px">}</p> </div>
