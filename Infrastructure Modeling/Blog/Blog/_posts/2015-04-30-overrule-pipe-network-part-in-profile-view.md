---
layout: "post"
title: "Overrule pipe network part in profile view"
date: "2015-04-30 06:25:52"
author: "Augusto Goncalves"
categories:
  - ".NET"
  - "Augusto Goncalves"
  - "AutoCAD Civil 3D"
original_url: "https://adndevblog.typepad.com/infrastructure/2015/04/overrule-pipe-network-part-in-profile-view.html "
typepad_basename: "overrule-pipe-network-part-in-profile-view"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>Using this <a href="http://adndevblog.typepad.com/autocad/2015/04/simple-drawable-overrule-skeleton.html">simple overrule skeleton</a> we can change the pipe or structure representation on a profile view. We just need to overrule the <a href="http://adndevblog.typepad.com/infrastructure/2014/07/pipe-network-parts-on-profile-view.html">ProfilePartView</a> class and do some additional geometry. Here is a quick sample.</p>  <pre style="font-size: 13px; font-family: consolas; background: white; color: black"><span style="color: blue">class</span>&#160;<span style="color: #2b91af">PipePartOverrule</span> : <span style="color: #2b91af">DrawableOverrule</span><br />{<br />&#160; <span style="color: blue">public</span>&#160;<span style="color: blue">override</span>&#160;<span style="color: blue">bool</span> WorldDraw(<br />&#160;&#160;&#160; <span style="color: #2b91af">Drawable</span> drawable, <span style="color: #2b91af">WorldDraw</span> wd)<br />&#160; {<br />&#160;&#160;&#160; <span style="color: blue">bool</span> ret = <span style="color: blue">base</span>.WorldDraw(drawable, wd);<br /> <br />&#160;&#160;&#160; <span style="color: #2b91af">ProfileViewPart</span> viewPart = drawable <span style="color: blue">as</span>&#160;<span style="color: #2b91af">ProfileViewPart</span>;<br />&#160;&#160;&#160; <span style="color: blue">if</span> (viewPart == <span style="color: blue">null</span>) <span style="color: blue">return</span> ret; <span style="color: green">// for safety</span><br /> <br />&#160;&#160;&#160; <span style="color: green">// get the database</span><br />&#160;&#160;&#160; <span style="color: green">// if the entity is database resident, if not,</span><br />&#160;&#160;&#160; <span style="color: green">// then get the active on</span><br />&#160;&#160;&#160; <span style="color: #2b91af">Database</span> db = (viewPart.Database != <span style="color: blue">null</span> ? <br />&#160;&#160;&#160;&#160;&#160; viewPart.Database :<br />&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">Application</span>.DocumentManager.<br />&#160;&#160;&#160;&#160;&#160; MdiActiveDocument.Database);<br /> <br />&#160;&#160;&#160; <span style="color: green">// get the model part type</span><br />&#160;&#160;&#160; <span style="color: blue">if</span> (viewPart.ModelPartId.ObjectClass ==<br />&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">RXClass</span>.GetClass(<span style="color: blue">typeof</span>(<span style="color: #2b91af">Pipe</span>)))<br />&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160; <span style="color: green">// ok, this view part represents a Pipe</span><br />&#160;&#160;&#160;&#160;&#160; <span style="color: green">// let's draw something... just a crossing line</span><br />&#160;&#160;&#160;&#160;&#160; wd.Geometry.WorldLine(<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; viewPart.Bounds.Value.MinPoint,<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; viewPart.Bounds.Value.MaxPoint);<br />&#160;&#160;&#160; }<br /> <br />&#160;&#160;&#160; <span style="color: green">// if you consider handle Structures</span><br />&#160;&#160;&#160; <span style="color: green">//else if (viewPart.ModelPartId.ObjectClass ==</span><br />&#160;&#160;&#160; <span style="color: green">//&#160; RXClass.GetClass(typeof(Structure)))</span><br />&#160;&#160;&#160; <span style="color: green">//{</span><br />&#160;&#160;&#160; <span style="color: green">//}</span><br /> <br />&#160;&#160;&#160; <span style="color: blue">return</span> ret;<br />&#160; }<br />}</pre>

<p>And here is the command based on the skeleton</p>

<pre style="font-size: 13px; font-family: consolas; background: white; color: black"><span style="color: blue">public</span>&#160;<span style="color: blue">class</span>&#160;<span style="color: #2b91af">Commads</span><br />{<br />&#160; [<span style="color: #2b91af">CommandMethod</span>(<span style="color: #a31515">&quot;profilePartOverrule&quot;</span>)]<br />&#160; <span style="color: blue">public</span>&#160;<span style="color: blue">static</span>&#160;<span style="color: blue">void</span> CmdProfilePartOverrule()<br />&#160; {<br />&#160;&#160;&#160; <span style="color: blue">if</span> (_overrule == <span style="color: blue">null</span>)<br />&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160; _overrule = <span style="color: blue">new</span>&#160;<span style="color: #2b91af">PipePartOverrule</span>();<br />&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">Overrule</span>.AddOverrule(<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">RXClass</span>.GetClass(<span style="color: blue">typeof</span>(<span style="color: #2b91af">ProfileViewPart</span>)),<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; _overrule, <span style="color: blue">false</span>);<br />&#160;&#160;&#160; }<br />&#160;&#160;&#160; <span style="color: blue">else</span><br />&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">Overrule</span>.RemoveOverrule(<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">RXClass</span>.GetClass(<span style="color: blue">typeof</span>(<span style="color: #2b91af">ProfileViewPart</span>)),<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; _overrule);<br />&#160;&#160;&#160;&#160;&#160; _overrule = <span style="color: blue">null</span>;<br />&#160;&#160;&#160; }<br />&#160;&#160;&#160; <span style="color: #2b91af">Application</span>.DocumentManager.<br />&#160;&#160;&#160;&#160;&#160; MdiActiveDocument.Editor.Regen();<br />&#160; }<br /> <br />&#160; <span style="color: blue">private</span>&#160;<span style="color: blue">static</span>&#160;<span style="color: #2b91af">PipePartOverrule</span> _overrule = <span style="color: blue">null</span>;<br />}</pre>
