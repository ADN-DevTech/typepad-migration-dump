---
layout: "post"
title: "List all alignment entities"
date: "2012-05-15 14:34:46"
author: "Augusto Goncalves"
categories:
  - "Augusto Goncalves"
  - "AutoCAD Civil 3D 2011"
  - "AutoCAD Civil 3D 2012"
  - "AutoCAD Civil 3D 2013"
original_url: "https://adndevblog.typepad.com/infrastructure/2012/05/list-all-alignment-entities.html "
typepad_basename: "list-all-alignment-entities"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/infrastructure/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>An alignment is composed of entities, which can be complex, such as SpiralCurveSpiral (SCS), but in the end is basically composed by Lines, Arcs and Spirals.</p>  <p>For both cases we can start at the Alignment.Entities property collection, but this property only return the first level of complex entities derived from type AlignmentEntity. For the second level, corresponding to primitive entities, for each of those AlignmentEntity objects we can access as an array of AlignmentSubEntity. </p>  <div style="font-family: ; background: white">   <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Public</font></span><font color="#000000"> </font><span><font color="#0000ff">Sub</font></span><font color="#000000"> alignmentsEntities()</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> ed </font><span><font color="#0000ff">As</font></span><font color="#000000"> Editor = _</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#2b91af">Application</font></span><font color="#000000">.DocumentManager.MdiActiveDocument.Editor</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> db </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">Database</font></span><font color="#000000"> = _</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#2b91af">Application</font></span><font color="#000000">.DocumentManager.MdiActiveDocument.Database</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Using</font></span><font color="#000000"> trans </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">Transaction</font></span><font color="#000000"> = _</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; db.TransactionManager.StartTransaction()</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 10pt" color="#008000">'get the civil document</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> civilDoc </font><span><font color="#0000ff">As</font></span><font color="#000000"> CivilDocument = CivilApplication.ActiveDocument</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 10pt" color="#008000">'and the collection of alignments</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> alignColl </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">ObjectIdCollection</font></span><font color="#000000"> = _</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; civilDoc.GetAlignmentIds()</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">For</font></span><font color="#000000"> </font><span><font color="#0000ff">Each</font></span><font color="#000000"> alignId </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#2b91af">ObjectId</font></span><font color="#000000"> </font><span><font color="#0000ff">In</font></span><font color="#000000"> alignColl </font></font><span><font style="font-size: 10pt" color="#008000">'for each alignment</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 10pt" color="#008000">'open for read</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> align </font><span><font color="#0000ff">As</font></span><font color="#000000"> Alignment = trans.GetObject( _</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; alignId, </font></font><font style="font-size: 10pt"><span><font color="#2b91af">OpenMode</font></span><font color="#000000">.ForRead)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 10pt" color="#008000">'for each entity in the alignment</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">For</font></span><font color="#000000"> </font><span><font color="#0000ff">Each</font></span><font color="#000000"> alignEnt </font><span><font color="#0000ff">As</font></span><font color="#000000"> AlignmentEntity </font><span><font color="#0000ff">In</font></span><font color="#000000"> align.Entities</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 10pt" color="#008000">'get the number of sub entities</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> subEntCount </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#0000ff">Integer</font></span><font color="#000000"> = alignEnt.SubEntityCount</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">For</font></span><font color="#000000"> i </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#0000ff">Integer</font></span><font color="#000000"> = 0 </font><span><font color="#0000ff">To</font></span><font color="#000000"> subEntCount - 1 </font></font><span><font style="font-size: 10pt" color="#008000">'for each subentity</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 10pt" color="#008000">'get the type</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> alignSubEnt </font><span><font color="#0000ff">As</font></span><font color="#000000"> AlignmentSubEntity = alignEnt(i)</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Select</font></span><font color="#000000"> </font><span><font color="#0000ff">Case</font></span><font color="#000000"> alignSubEnt.SubEntityType</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Case</font></span><font color="#000000"> AlignmentSubEntityType.Arc</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 10pt" color="#008000">'ARC</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> alignSubEntArc </font><span><font color="#0000ff">As</font></span><font color="#000000"> AlignmentSubEntityArc = _</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; alignSubEnt</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Case</font></span><font color="#000000"> AlignmentSubEntityType.Line</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 10pt" color="#008000">'LINE</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> alignSubEntLine </font><span><font color="#0000ff">As</font></span><font color="#000000"> AlignmentSubEntityLine = _</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; alignSubEnt</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Case</font></span><font color="#000000"> AlignmentSubEntityType.Spiral</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 10pt" color="#008000">'SPIRAL</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Dim</font></span><font color="#000000"> alignSubEntSpiral </font><span><font color="#0000ff">As</font></span><font color="#000000"> AlignmentSubEntitySpiral = _</font></font></font></p>    <p style="margin: 0px"><font face="Consolas"><font style="font-size: 10pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; alignSubEnt</font></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#0000ff">Select</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 10pt" color="#0000ff">Next</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 10pt" color="#0000ff">Next</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160;&#160;&#160; </font></font><span><font style="font-size: 10pt" color="#0000ff">Next</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#0000ff">Using</font></span></font></p>    <p style="margin: 0px"><font face="Consolas"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#0000ff">Sub</font></span></font></p> </div>
