---
layout: "post"
title: "AutoCAD Map 3D API Training content: Part-5"
date: "2013-05-08 10:18:30"
author: "Gopinath Taget"
categories:
  - ".NET"
  - "AutoCAD Map 3D 2013"
  - "FDO"
  - "Gopinath Taget"
original_url: "https://adndevblog.typepad.com/infrastructure/2013/05/autocad-map-3d-api-training-content-part-5.html "
typepad_basename: "autocad-map-3d-api-training-content-part-5"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/infrastructure/gopinath-taget.html">Gopinath Taget</a></p>  <p>This is in continuation of <a href="http://adndevblog.typepad.com/infrastructure/partha-sarkar.html">Partha</a>’s earlier posts on <strong>AutoCAD Map 3D API Training content</strong>: <a href="http://adndevblog.typepad.com/infrastructure/2013/02/autocad-map-3d-api-training-content-part-1.html">Part-1</a> , <a href="http://adndevblog.typepad.com/infrastructure/2013/03/autocad-map-3d-api-training-content-part-2.html">Part 2</a>, <a href="http://adndevblog.typepad.com/infrastructure/2013/03/autocad-map-3d-api-training-content-part-3.html">Part-3</a> and <a href="http://adndevblog.typepad.com/infrastructure/2013/03/autocad-map-3d-api-training-content-part-4.html">Part-4</a>. In this post, I will talk about the Geospatial geometry API. To start with let me state that there have been a few changes to the API organization over the years and currently, you will find all the APIs used for this post in the following assemblies:</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01901bf030c4970b-pi"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="/assets/image_d512fe.jpg" width="389" height="411" /></a></p>  <p>&#160;</p>  <p>All the selected assemblies above can be found in the Map 3D install folder or its subfolders.</p>  <p>Now, coming back to the API, the Geometry API is organized in a simple manner. There are two basic types. <strong>MgGeometry</strong> and <strong>MgGeometryComponent</strong>. MgGeometry is inherited by <strong>MgAggregateGeometry</strong>, <strong>MgCurve</strong>, <strong>MgPoint</strong> and <strong>MgRegion</strong>. MgGeometryComponent is inherited by <strong>MgCurveSegment </strong>and <strong>MgRing</strong>. In general as the names suggests, MgGeometry types represent the geometry itself and MgGeometryComponent types constitute (are contained by) the MgGeometry types:</p>  <p>&#160;</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017eeaedd801970d-pi"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="/assets/image_ea729b.jpg" width="288" height="567" /></a></p>  <p>The relationship between these types is explained in more detail in <a href="http://adndevblog.typepad.com/files/Chapter%205.pdf">this presentation</a>. A few points to note when using the geometry API:</p>  <ul>   <li>You should use the utility type MgGeometryFactory to create a MgGeometry object </li>    <li>In the MgLinearRing type, the first and last coordinates in the coordinate collection should be identical </li>    <li>When connecting segment types (base type MgCurveSegment) in segment collection, the last coordinate of a curve segment should be identical to the first segment of the next segment. </li>    <li>When forming closed rings(MgLinearRing, MgCurveRing) the direction of traversal of the points in the ring indicates if it is an exterior or interior ring. The direction of traversal is counterclockwise for exterior ring and clockwise for interior rings. </li> </ul>  <p>You will find additional details for creating specific geometries in the presentation I provided above.</p>  <p>In addition to the geometry types mentioned above, there are several utility API that form a part of the geometry API. The raw geometry data can be used in three specific forms in the geometry API: </p>  <ul>   <li>The text based Autodesk Geometry Format (AGF) which is a plain text format </li>    <li>The binary based AGF format </li>    <li>Internal representations in the MgGeometry types </li> </ul>  <p>Geometry API comes with utility functions to manage the above types of data. The other utility of APIs allow you to determine the spatial relationship between geometry objects (contains, crosses, touches etc) and create new geometry with boolean operations (union, intersection, difference, symmitric difference).</p>  <p>The coordinate systems supported by the geometry API are Arbitrary X-Y, Geographic and Projected.</p>  <p>Finally, the geometry API allows you to create <a href="http://wikihelp.autodesk.com/AutoCAD_Map_3D/enu/2014/Help/0006-AutoCAD_0/0044-Geometry44/0050-Creating50">buffer geometry</a> from existing geometry.</p>  <p><a href="http://adndevblog.typepad.com/infrastructure/MapSamples/Geometry.zip">Here</a> is a sample that demonstrates the usage of most of the API mentioned in this post. It implements two commands CRGEOM and CRBUFFER. CRGEOM demonstrates creation of geometry and CRBUFFER demonstrates creation of buffer geometry. In order to use the sample, do the following:</p>  <ul>   <li>Open Geometry.sln in Visual Studio 2010 and build the project. </li>    <li>Delete the SDF if it exists NewFile.sdf (if you have used this sample before) </li>    <li>Launch Map 3D and open a new drawing </li>    <li>Load the .NET assembly created in step #1 </li>    <li>Assign the a coordinate system to the new drawing </li>    <li>Draw one or more polyline entities in the drawing </li>    <li>Enter the command “crgeom” and select a polyline entity. A line string feature is created from it on the API_Poly_Objects layer and inserted into NewFile.sdf in the .\Data\SDF folder. If this file doesn’t exist, it is created. </li>    <li>Select a feature on the API_Poly_Objects layer and enter the command “crbuffer”. A buffer polygon is created round the feature. The buffer is created on the “Buffer_Objects” layer and inserted into Buffer.sdf in the.\Data\SDF folder </li> </ul>  <p><b>Note:</b> If you will be revisiting this exercise later, deleting NewFile.sdf and Buffer.sdf before starting would make things easier for you. This is to ensure that both SDFs are created fresh using the <u>same coordinate system</u>, otherwise buffer creation would fail. Also, the Path to the SDF folders are hard coded in the sample so please modify this path to a folder convenient to you before using the sample.</p>
