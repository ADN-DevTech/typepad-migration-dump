---
layout: "post"
title: "Save Document to Lower Version from Excel VBA"
date: "2015-09-16 20:44:29"
author: "Xiaodong Liang"
categories: []
original_url: "https://adndevblog.typepad.com/aec/2015/09/save-document-to-lower-version-from-excel-vba.html "
typepad_basename: "save-document-to-lower-version-from-excel-vba"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>
<p><strong>Question:</strong></p>
<p>I have an application in Excel VBA which did some jobs related with Navisworks model by COM API. Now I wanted to save the model to lower version, but I do not find an API in COM.</p>
<p><strong>Solution</strong>:</p>
<p>.NET API allows Document.SaveFile allows you to save the file to specific version. While VBA does not support .NET. however you could produce a .NET Automation application, and a .NET plugin. In plugin, use Document.SaveFile to save to specific version. The Automation executes the plugin. In Excel, run the Automation (exe) with the parameter of the source file.</p>
<p>This sounds a little awkward. The better solution is to create a DocumentControl application (without viewcontrol), do the similar job. A DocumentControl application is a light process which does not require to start Navisworks standard process. In addition, you do not need to write a plugin.</p>
<p>The following is the core code of a DocumentControl application. It iterates each file from the argument, saves them to version 2014. Assume the source files are available in the path.</p>
<p>&#0160; <span class="asset  asset-generic at-xid-6a0167607c2431970b01bb0873a0aa970d img-responsive"><a href="http://adndevblog.typepad.com/files/test-1.zip">Download Test</a></span></p>
<table border="1" cellpadding="2" cellspacing="0" width="600">
<tbody>
<tr>
<td valign="top" width="598">
<p align="left" class="MsoNormal" style="margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-size: 9.5pt; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-size: 9.5pt; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span><span style="color: #0000ff;">class</span></span></span><span><span style="font-size: 8pt; color: #2b91af;">Program</span></span></span></span></p>
<p align="left" class="MsoNormal" style="margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-size: 9.5pt; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt;">{</span></span></span></span></p>
<p align="left" class="MsoNormal" style="margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-size: 9.5pt; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt;">[</span></span><span style="font-size: 8pt;"><span><span style="color: #2b91af;">STAThread</span></span><span style="color: #000000;">]</span></span></span></span></p>
<p align="left" class="MsoNormal" style="margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-size: 9.5pt; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span><span style="color: #0000ff;">static</span></span><span><span style="color: #0000ff;">void</span></span><span style="color: #000000;"> Main(</span><span><span style="color: #0000ff;">string</span></span><span style="color: #000000;">[] args)</span></span></span></span></p>
<p align="left" class="MsoNormal" style="margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-size: 9.5pt; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt;">{</span></span></span></span></p>
<p align="left" class="MsoNormal" style="margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-size: 9.5pt; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span><span style="color: #0000ff;">if</span></span><span style="color: #000000;"> (args.Count&lt;</span><span><span style="color: #0000ff;">string</span></span><span style="color: #000000;">&gt;() &gt; 0)</span></span></span></span></p>
<p align="left" class="MsoNormal" style="margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-size: 9.5pt; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt;">{ </span></span></span></span></p>
<p align="left" class="MsoNormal" style="margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-size: 9.5pt; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="font-size: 8pt; color: #008000;">//single document mode</span></span></span></span></p>
<p align="left" class="MsoNormal" style="margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-size: 9.5pt; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt;">Autodesk.Navisworks.Api.Controls.ApplicationControl.ApplicationType =</span></span></span></span></p>
<p align="left" class="MsoNormal" style="margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-size: 9.5pt; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt;">ApplicationType.SingleDocument;</span></span></span></span></p>
<p align="left" class="MsoNormal" style="margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-size: 9.5pt; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="font-size: 8pt; color: #008000;">//initialize application control </span></span></span></span></p>
<p align="left" class="MsoNormal" style="margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-size: 9.5pt; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt;">ApplicationControl.Initialize();</span></span></span></span></p>
<p align="left" class="MsoNormal" style="margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-size: 9.5pt; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="font-size: 8pt; color: #008000;">//create a DocumentControl</span></span></span></span></p>
<p align="left" class="MsoNormal" style="margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-size: 9.5pt; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt;">DocumentControl documentCtrl = </span></span><span style="font-size: 8pt;"><span><span style="color: #0000ff;">new</span></span><span style="color: #000000;"> DocumentControl();</span></span></span></span></p>
<p align="left" class="MsoNormal" style="margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-size: 9.5pt; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="font-size: 8pt; color: #008000;">//open a document </span></span></span></span></p>
<p align="left" class="MsoNormal" style="margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-size: 9.5pt; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-size: 9.5pt; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span><span style="color: #0000ff;">foreach</span></span><span style="color: #000000;"> (</span><span><span style="color: #0000ff;">string</span></span><span style="color: #000000;"> fullfilename </span><span><span style="color: #0000ff;">in</span></span><span style="color: #000000;"> args)</span></span></span></span></p>
<p align="left" class="MsoNormal" style="margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-size: 9.5pt; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt;">{</span></span></span></span></p>
<p align="left" class="MsoNormal" style="margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-size: 9.5pt; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span><span style="color: #0000ff;">if</span></span><span style="color: #000000;"> (documentCtrl.Document.TryOpenFile(fullfilename))</span></span></span></span></p>
<p align="left" class="MsoNormal" style="margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-size: 9.5pt; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt;">{</span></span></span></span></p>
<p align="left" class="MsoNormal" style="margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-size: 9.5pt; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span><span style="color: #0000ff;">string</span></span><span style="color: #000000;"> oldName = System.IO.</span><span><span style="color: #2b91af;">Path</span></span><span style="color: #000000;">.GetFullPath(fullfilename);</span></span></span></span></p>
<p align="left" class="MsoNormal" style="margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-size: 9.5pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span></p>
<p align="left" class="MsoNormal" style="margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-size: 9.5pt; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span><span style="color: #0000ff;">string</span></span><span style="color: #000000;"> newfullfilename =<span style="mso-spacerun: yes;">&#0160; </span>oldName + </span><span><span style="color: #a31515;">&quot;-lowerversion&quot;</span></span><span style="color: #000000;"> +</span><span><span style="color: #a31515;">&quot;.nwd&quot;</span></span><span style="color: #000000;">;</span></span></span></span></p>
<p align="left" class="MsoNormal" style="margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-size: 9.5pt; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="font-size: 8pt; color: #008000;">//save to a lower version</span></span></span></span></p>
<p align="left" class="MsoNormal" style="margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-size: 9.5pt; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt;">documentCtrl.Document.SaveFile(newfullfilename, DocumentFileVersion.Navisworks2014);<span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="mso-spacerun: yes;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160; </span></span></span></span></span></p>
<p align="left" class="MsoNormal" style="margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-size: 9.5pt; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt;">}</span></span></span></span></p>
<p align="left" class="MsoNormal" style="margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-size: 9.5pt; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt;">}</span></span></span></span></p>
<p align="left" class="MsoNormal" style="margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-size: 9.5pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span></p>
<p align="left" class="MsoNormal" style="margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-size: 9.5pt; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="font-size: 8pt; color: #008000;">//destroy DocumentControl</span></span></span></span></p>
<p align="left" class="MsoNormal" style="margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-size: 9.5pt; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt;">documentCtrl.Dispose();</span></span></span></span></p>
<p align="left" class="MsoNormal" style="margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-size: 9.5pt; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="font-size: 8pt; color: #008000;">//terminate application control </span></span></span></span></p>
<p align="left" class="MsoNormal" style="margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-size: 9.5pt; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt;">ApplicationControl.Terminate();</span></span></span></span></p>
<p align="left" class="MsoNormal" style="margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-size: 9.5pt; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt;">}</span></span></span></span></p>
<p align="left" class="MsoNormal" style="margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-size: 9.5pt; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt;">}</span></span></span></span></p>
<p align="left" class="MsoNormal" style="margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-size: 9.5pt; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt;">}</span></span></span></span></p>
<p align="left" class="MsoNormal" style="margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-size: 9.5pt; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 8pt; color: #000000;">}</span></span></span></p>
<p align="justify" class="MsoNormal" style="text-justify: inter-ideograph; margin: 0cm 0cm 0pt;"><span lang="EN-US" style="text-justify: inter-ideograph; text-align: justify; mso-bidi-font-size: 11.0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
</td>
</tr>
</tbody>
</table>
<p>&#0160;The VBA code executes the application with the parameters.&#0160;</p>
<table border="1" cellpadding="2" cellspacing="0" width="600">
<tbody>
<tr>
<td valign="top" width="598">
<p>Public Sub StartNWApp_WithArgument() <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; Dim strProgramName As String <br />&#0160;&#0160;&#0160; Dim strArgument As String</p>
<p>&#0160;&#0160;&#0160; strProgramName = &quot;C:\temp\Nw_Without_View_control\bin\Debug\Nw_Without_View_control.exe&quot; <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; strArgument = &quot; C:\temp\test.nwd&quot; <br />&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; Dim strToExecute As String <br />&#0160;&#0160;&#0160; strToExecute = strProgramName &amp; strArgument</p>
<p>&#0160;&#0160;&#0160; Call Shell(strToExecute, vbNormalFocus) <br />End Sub</p>
</td>
</tr>
</tbody>
</table>
