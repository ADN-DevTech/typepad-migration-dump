---
layout: "post"
title: "Accessing the Path of a Revit Family Document from the Family Instance"
date: "2012-09-27 11:00:00"
author: "Saikat Bhattacharya"
categories:
  - ".NET"
  - "Revit"
  - "Saikat Bhattacharya"
original_url: "https://adndevblog.typepad.com/aec/2012/09/accessing-the-path-a-revit-family-document-from-the-family-instance.html "
typepad_basename: "accessing-the-path-a-revit-family-document-from-the-family-instance"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/aec/saikat-bhattacharya.html">Saikat Bhattacharya</a></p>
<p>When a Revit project (RVT) file contains a family instance and we select the instance and edit the family, it opens up the Family in family editor mode. If users click Save at this point from the Revit User Interface, Revit knows the location of the Family Document from where the Family was loaded initially. Can we extract this file path (location) programmatically?</p>
<p>If you want to programmatically access this path of Family Document from the Family Instance, you can do that by traversing the path from Family Instance –&gt; Family Symbol –&gt; Family –&gt; Family Document. <strong><em>But,</em></strong> the problem that came up with this approach was that after Family element, it only provides access to the Document property which only returns the active document in which the Family is loaded in (or where the Family Instance has been created in) – whereas what we need is to access the Family Document from which the Family was loaded.</p>
<p>After some further playing around, one of the approach that seemed to work was to follow the workflow as followed using Revit UI – which was to call the EditFamily() on the Family element. This provided access to the Family Document and from this Document element, the PathName could be extracted. The Family.Document had taken us to the wrong direction. </p>
<p>The following code snippet illustrates this approach:</p>
<div style="background: white;">
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">using</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;"> System;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">using</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;"> System.Collections.Generic;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">using</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;"> System.Text;</span></span></span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">using</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;"> Autodesk.Revit.Attributes;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">using</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;"> Autodesk.Revit.DB;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">using</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;"> Autodesk.Revit.UI;</span></span></span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">namespace</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;"> Revit.SDK.Samples.HelloRevit.CS</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Courier New;"><span style="color: #000000; font-size: 8pt;">{</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; [</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">Transaction</span></span><span style="line-height: 11pt;"><span style="color: #000000;">(</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">TransactionMode</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;">.Manual)]</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">class</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Command</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> : </span></span></span><span style="line-height: 11pt;"><span style="color: #2b91af; font-size: 8pt;">IExternalCommand</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Courier New;"><span style="color: #000000; font-size: 8pt;">&#0160; {</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Result</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> Execute(</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">ExternalCommandData</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;"> commandData,</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">ref</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">string</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;"> message,</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">ElementSet</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;"> elements)</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Courier New;"><span style="color: #000000; font-size: 8pt;">&#0160;&#0160;&#0160; {</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">Document</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;"> doc = commandData.Application.ActiveUIDocument.Document;</span></span></span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">foreach</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> (</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">FamilyInstance</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> famInst </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">in</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;"> commandData.Application.ActiveUIDocument.Selection.Elements)</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Courier New;"><span style="color: #000000; font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160; {</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">Document</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;"> famDoc = doc.EditFamily(famInst.Symbol.Family);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">TaskDialog</span></span><span style="line-height: 11pt;"><span style="color: #000000;">.Show(</span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;Family PathName&quot;</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;">, famDoc.PathName);</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Courier New;"><span style="color: #000000; font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160; }</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">return</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Result</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;">.Succeeded;</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Courier New;"><span style="color: #000000; font-size: 8pt;">&#0160;&#0160;&#0160; }</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Courier New;"><span style="color: #000000; font-size: 8pt;">&#0160; }&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Courier New;"><span style="color: #000000; font-size: 8pt;">}</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Courier New;"><span style="color: #000000; font-size: 8pt;">&#0160;</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt; font-family: arial,helvetica,sans-serif; font-size: 10pt;"><span style="color: #000000;">UPDATE: Thanks Dan for pointing out that we indeed need to close the Family document after the path name has been extracted - otherwise each of the family documents will throw the save dialog and consequently have to close them manually before Revit is closed.</span></span></p>
</div>
