---
layout: "post"
title: "Add Search or Selection Set to Timeliner Task"
date: "2014-03-12 20:28:41"
author: "Xiaodong Liang"
categories:
  - ".NET"
  - "Navisworks"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/aec/2014/03/add-search-or-selection-set-to-timeliner-task.html "
typepad_basename: "add-search-or-selection-set-to-timeliner-task"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/aec/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>  <p>In the <a href="http://adndevblog.typepad.com/aec/2012/10/timeliner-api-part1.html">post</a>, we demoed how to bind an explicit selection to a timeliner task. The API also supports to attach a selection set (SelectionSet) to the task. </p>  <p>The TimelinerTask.Selection (TimelinerSelection) could be:</p>  <p><strong>Explicit selection     <br /></strong>Tthe typical code snippet is:</p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><font face="Times New Roman"><span style="background-image: none; background-attachment: scroll; background-repeat: repeat; font-family: ; background-position: 0% 0%; mso-bidi-font-size: 8.0pt" lang="EN-US"><font color="#2b91af"><font style="font-size: 9pt">Selection</font></font></span><font style="font-size: 9pt"></span></font><span class="apple-converted-space"><font color="#000000"><font style="font-size: 9pt"><span style="background-image: none; background-attachment: scroll; background-repeat: repeat; font-family: ; background-position: 0% 0%; mso-bidi-font-size: 8.0pt" lang="EN-US"><span style="word-spacing: 0px; -webkit-text-stroke-width: 0px">&#160;</span></span></font><span style="background-image: none; background-attachment: scroll; background-repeat: repeat; font-family: ; background-position: 0% 0%; mso-bidi-font-size: 8.0pt" lang="EN-US"><font style="font-size: 9pt">current = main_doc.CurrentSelection;</font></span></font></span></font></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="background-image: none; background-attachment: scroll; background-repeat: repeat; font-family: ; background-position: 0% 0%; mso-bidi-font-size: 8.0pt" lang="EN-US"><font face="Times New Roman"><font style="font-size: 9pt" color="#000000">task.Selection.CopyFrom(current);</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="background-image: none; background-attachment: scroll; background-repeat: repeat; font-family: ; background-position: 0% 0%; mso-bidi-font-size: 8.0pt" lang="EN-US"><font color="#000000" face="Times New Roman"></font></span></p>  <p>the <a href="http://adndevblog.typepad.com/aec/2012/10/timeliner-api-part1.html">post</a> above shows in detail. With an Explicit selection, TimelinerSelection.<a href="mk:@MSITStore:C:\Program%20Files\Autodesk\Navisworks%20Manage%202014\api\NET\documentation\NET%20API.chm::/html/P_Autodesk_Navisworks_Api_Timeliner_TimelinerSelection_HasExplicitSelection.htm">HasExplicitSelection</a> will be true.</p>  <p><strong>Search selection</strong></p>  <p>The workflow is to get/create a Search, and TimelinerSelection.CopyFrom this Search. With an Search selection, TimelinerSelection. <a href="mk:@MSITStore:C:\Program%20Files\Autodesk\Navisworks%20Manage%202014\api\NET\documentation\NET%20API.chm::/html/P_Autodesk_Navisworks_Api_Timeliner_TimelinerSelection_HasSearch.htm">HasSearch</a> will be true.</p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><font face="Times New Roman"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#0000ff"><font style="font-size: 9pt">public</font></font></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font style="font-size: 9pt"><font color="#000000"> </font><span><font color="#0000ff">void</font></span><font color="#000000"> attachSearchToTask()</font></font></span></font></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">{ </font></font><span><span style="mso-spacerun: yes"><font style="font-size: 9pt" color="#0000ff">&#160;</font></span></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9pt"><span><font color="#2b91af">Document</font></span><font color="#000000"> main_doc =</font></font></font></span></p>  <p style="line-height: normal; text-indent: 21pt; margin: 0cm 0cm 0pt 63pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><font style="font-size: 9pt">Autodesk.Navisworks.Api.</font></font><font style="font-size: 9pt"><span><font color="#2b91af">Application</font></span><font color="#000000">.ActiveDocument;</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes"><font face="Times New Roman"><font style="font-size: 9pt" color="#000000">&#160;</font></font></span></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font style="font-size: 9pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span><font style="font-size: 9pt" color="#008000">// create a search and conditions</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9pt"><span><font color="#2b91af">Search</font></span><font color="#000000"> s = </font><span><font color="#0000ff">new</font></span><font color="#000000"> </font><span><font color="#2b91af">Search</font></span><font color="#000000">();</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span><font style="font-size: 9pt" color="#008000">//search the items whose properties:<span style="mso-spacerun: yes">&#160; </span>Element &gt;&gt; Category = Wall</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9pt"><span><font color="#2b91af">SearchCondition</font></span><font color="#000000"> sc =</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9pt"><span><font color="#2b91af">SearchCondition</font></span><font color="#000000">.HasPropertyByDisplayName(</font><span><font color="#a31515">&quot;Element&quot;</font></span><font color="#000000">,</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9pt"><span><font color="#a31515">&quot;Category&quot;</font></span><font color="#000000">);</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">s.SearchConditions.Add(</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">sc.EqualValue(</font></font><font style="font-size: 9pt"><span><font color="#2b91af">VariantData</font></span><font color="#000000">.FromDisplayString(</font><span><font color="#a31515">&quot;Walls&quot;</font></span><font color="#000000">)));</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font style="font-size: 9pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span><font style="font-size: 9pt" color="#008000">//set the selection to everything</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">s.Selection.SelectAll();</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">s.Locations =</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9pt"><span><font color="#2b91af">SearchLocations</font></span><font color="#000000">.DescendantsAndSelf; </font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font style="font-size: 9pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span><font style="font-size: 9pt" color="#008000">// get the Timeliner document part from an active document</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes"><font face="Times New Roman"><font style="font-size: 9pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Tl.</font></font><font style="font-size: 9pt"><span><font color="#2b91af">DocumentTimeliner</font></span><font color="#000000"> doc_tl = </font></font></font></span></p>  <p style="line-height: normal; text-indent: 21pt; margin: 0cm 0cm 0pt 84pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><font style="font-size: 9pt">Tl.</font></font><font style="font-size: 9pt"><span><font color="#2b91af">TimelinerDocumentExtensions</font></span><font color="#000000">.GetTimeliner(main_doc);</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span><font style="font-size: 9pt" color="#008000">// copy the current set of tasks. get the current selection.</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9pt"><span><font color="#2b91af">GroupItem</font></span><font color="#000000"> root_copy =</font></font><span style="mso-tab-count: 3"><font style="font-size: 9pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;</font></span><font style="font-size: 9pt"><span style="mso-tab-count: 4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>doc_tl.TasksRoot.CreateCopy() </font></font><font style="font-size: 9pt"><span><font color="#0000ff">as</font></span><font color="#000000"> </font><span><font color="#2b91af">GroupItem</font></span><font color="#000000">; </font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes"><font face="Times New Roman"><font style="font-size: 9pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span><font style="font-size: 9pt" color="#008000">// attach <span style="mso-spacerun: yes">&#160;</span>search <span style="mso-spacerun: yes">&#160;</span>to one task</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Tl.</font></font><font style="font-size: 9pt"><span><font color="#2b91af">TimelinerTask</font></span><font color="#000000"> task1 = root_copy.Children[0] </font><span><font color="#0000ff">as</font></span><font color="#000000"> Tl.</font><span><font color="#2b91af">TimelinerTask</font></span><font color="#000000">;</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">task1.Selection.CopyFrom(s); </font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes"><font face="Times New Roman"><font style="font-size: 9pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span><font style="font-size: 9pt" color="#008000">// replace the timeliner tasks</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">doc_tl.TasksCopyFrom(root_copy.Children);</font><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font style="font-size: 9pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9pt"><span><font color="#0000ff">return</font></span><font color="#000000"> 0;</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">}</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#000000" face="Times New Roman"></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><strong>Selection Set</strong></p>  <p>It is a bit tricky to attach a SelectionSet. In Navisworks API, SelectionSet is a kind of SelectionSource. You will need to create a SelectionSourceCollection which contains the SelectionSet, and bind it to the task. Then, TimelinerSelection. <a href="mk:@MSITStore:C:\Program%20Files\Autodesk\Navisworks%20Manage%202014\api\NET\documentation\NET%20API.chm::/html/P_Autodesk_Navisworks_Api_Timeliner_TimelinerSelection_HasSelectionSources.htm">HasSelectionSources</a> will be true.    <br /></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><font face="Times New Roman"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#0000ff"><font style="font-size: 9pt">public</font></font></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font style="font-size: 9pt"><font color="#000000"> </font><span><span style="mso-spacerun: yes"><font color="#0000ff">&#160;</font></span></span><span style="mso-spacerun: yes"><font color="#000000">&#160;</font></span><span><font color="#0000ff">void</font></span><font color="#000000"> attachSelectionSetToTask()</font></font></span></font></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">{</font></font></font></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;</font></span></font></font></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font style="font-size: 9pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9pt"><span><font color="#2b91af">Document</font></span><font color="#000000"> main_doc =Autodesk.Navisworks.Api.</font><span><font color="#2b91af">Application</font></span><font color="#000000">.ActiveDocument;</font></font></font></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font style="font-size: 9pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font style="font-size: 9pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span><font style="font-size: 9pt" color="#008000">// create a selection set (from explicitly selection)</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span><font style="font-size: 9pt" color="#008000">// assume some objects are selected already</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9pt"><span><font color="#2b91af">ModelItemCollection</font></span><font color="#000000"> oCurrentSelection = main_doc.CurrentSelection.SelectedItems;</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span><font style="font-size: 9pt" color="#008000">// create a selectionset with the search condition</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9pt"><span><font color="#2b91af">SavedItem</font></span><font color="#000000"> newExplicitlySetItem =</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9pt"><span><font color="#0000ff">new</font></span><font color="#000000"> </font><span><font color="#2b91af">SelectionSet</font></span><font color="#000000">(oCurrentSelection);</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160; </span>newExplicitlySetItem.DisplayName = </font></font><font style="font-size: 9pt"><span><font color="#a31515">&quot;My Selection&quot;</font></span><font color="#000000">;</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font style="font-size: 9pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span><font style="font-size: 9pt" color="#008000">// add this selection set to selection set collection</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span><font style="font-size: 9pt" color="#008000">//Note: InsertCopy makes a copy from newExplicitlySetItem</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span><font style="font-size: 9pt" color="#008000">// instead of adding<span style="mso-spacerun: yes">&#160; </span>it directly.</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Autodesk.Navisworks.Api.</font></font><font style="font-size: 9pt"><span><font color="#2b91af">Application</font></span><font color="#000000">.ActiveDocument.</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">SelectionSets.InsertCopy(0, newExplicitlySetItem);</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes"><font face="Times New Roman"><font style="font-size: 9pt" color="#000000">&#160;</font></font></span></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span><font color="#008000"><font style="font-size: 9pt">//get the SelectionSet added just now</font><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160; </font></span></font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9pt"><span><font color="#2b91af">IEnumerable</font></span><font color="#000000">&lt;</font><span><font color="#2b91af">SavedItem</font></span><font color="#000000">&gt; tempCollection = Autodesk.Navisworks.Api.</font><span><font color="#2b91af">Application</font></span><font color="#000000">.ActiveDocument.</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">SelectionSets.Value.Where&lt;</font></font><font style="font-size: 9pt"><span><font color="#2b91af">SavedItem</font></span><font color="#000000">&gt;(x =&gt; x.DisplayName == </font><span><font color="#a31515">&quot;My Selection&quot;</font></span><font color="#000000">) ;</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font style="font-size: 9pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9pt"><span><font color="#2b91af">SelectionSet</font></span><font color="#000000"> newSelectionSet = </font><span><font color="#0000ff">null</font></span><font color="#000000">; ;</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9pt"><span><font color="#0000ff">if</font></span><font color="#000000"> (tempCollection.Count&lt;</font><span><font color="#2b91af">SavedItem</font></span><font color="#000000">&gt;() &gt; 0)</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">{</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">newSelectionSet = tempCollection.ElementAt&lt;</font></font><font style="font-size: 9pt"><span><font color="#2b91af">SavedItem</font></span><font color="#000000">&gt;(0) </font><span><font color="#0000ff">as</font></span><font color="#000000"> </font><span><font color="#2b91af">SelectionSet</font></span><font color="#000000">;</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">}</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span><font style="font-size: 9pt" color="#0000ff">else</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">{</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes"><font color="#000000" face="Times New Roman"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font face="Times New Roman"><font style="font-size: 9pt"><span><font color="#008000">// should not happen</font>            <br /></span><span style="mso-spacerun: yes"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span><font color="#0000ff">return</font></span><font color="#000000">;</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">}</font></font></font></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes"><font face="Times New Roman"><font style="font-size: 9pt" color="#000000">&#160;</font></font></span></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font style="font-size: 9pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span><font color="#008000"><font style="font-size: 9pt">// get the Timeliner document part from an active document</font><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span></font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Tl.</font></font><font style="font-size: 9pt"><span><font color="#2b91af">DocumentTimeliner</font></span><font color="#000000"> doc_tl = Tl.</font><span><font color="#2b91af">TimelinerDocumentExtensions</font></span><font color="#000000">.GetTimeliner(main_doc);</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font style="font-size: 9pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span><font style="font-size: 9pt" color="#008000">// copy the current set of tasks. get the current selection.</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9pt"><span><font color="#2b91af">GroupItem</font></span><font color="#000000"> root_copy = doc_tl.TasksRoot.CreateCopy() </font><span><font color="#0000ff">as</font></span><font color="#000000"> </font><span><font color="#2b91af">GroupItem</font></span><font color="#000000">;</font></font><span style="mso-spacerun: yes"><font style="font-size: 9pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes"><font face="Times New Roman"><font style="font-size: 9pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span><font style="font-size: 9pt" color="#008000">// attach selection set (search set) to one task</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">Tl.</font></font><font style="font-size: 9pt"><span><font color="#2b91af">TimelinerTask</font></span><font color="#000000"> task1 = root_copy.Children[0] </font><span><font color="#0000ff">as</font></span><font color="#000000"> Tl.</font><span><font color="#2b91af">TimelinerTask</font></span><font color="#000000">;</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span><font style="font-size: 9pt" color="#008000">//create a SelectionSourceCollection</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9pt"><span><font color="#2b91af">SelectionSourceCollection</font></span><font color="#000000"> oSC = </font><span><font color="#0000ff">new</font></span><font color="#000000"> </font><span><font color="#2b91af">SelectionSourceCollection</font></span><font color="#000000">();</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span><font style="font-size: 9pt" color="#008000">//create a SelectionSource from the selection set</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9pt"><span><font color="#2b91af">SelectionSource</font></span><font color="#000000"> oS = Autodesk.Navisworks.Api.</font><span><font color="#2b91af">Application</font></span><font color="#000000">.ActiveDocument.</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">SelectionSets.CreateSelectionSource(newSelectionSet);</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span><font style="font-size: 9pt" color="#008000">//add the SelectionSource to SelectionSourceCollection</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">oSC.Add(oS);</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span><font style="font-size: 9pt" color="#008000">//attach the SelectionSourceCollection to the task.</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">task1.Selection.CopyFrom(oSC); </font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes"><font face="Times New Roman"><font style="font-size: 9pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span><font style="font-size: 9pt" color="#008000">// replace the timeliner tasks</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">doc_tl.TasksCopyFrom(root_copy.Children);</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes"><font face="Times New Roman"><font style="font-size: 9pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font style="font-size: 9pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 9pt"><span><font color="#0000ff">return</font></span><font color="#000000"> 0;</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9pt">&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9pt">}</font></font></font></span></p>
