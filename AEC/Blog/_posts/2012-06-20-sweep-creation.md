---
layout: "post"
title: "Sweep creation"
date: "2012-06-20 00:19:23"
author: "Katsuaki Takamizawa"
categories:
  - "Katsuaki Takamizawa"
original_url: "https://adndevblog.typepad.com/aec/2012/06/sweep-creation.html "
typepad_basename: "sweep-creation"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/aec/katsuaki-takamizawa.html" target="_self">Katsuaki Takamizawa</a></p> <p>There are two common mistakes you could make when creating a sweep using API. First, please make sure to create a sketch plane in which the sweep path is on the plane. The second, you can choose an arc for lines for the sweep path. You can not mix them together.</p>  <p>Here is the simple sample code creating a sweep with a circular profile and arced sweep path. You can uncomment the code for multiple lines sweep path instead of the arced path. </p>  <p><font color="#000000"><font style="font-size: 7.8pt"></font></font></p>  <p><font color="#000000"><font style="font-size: 7.8pt">&#160; </font></font><font style="font-size: 7.8pt"><span><font color="#2b91af">UIApplication</font></span></font><font style="font-size: 7.8pt"><font color="#000000"> uiapp = commandData.Application;       <br />&#160; </font><span><font color="#2b91af">UIDocument</font></span><font color="#000000"> uidoc = uiapp.ActiveUIDocument;       <br />&#160; </font><span><font color="#2b91af">Application</font></span><font color="#000000"> app = uiapp.Application;       <br />&#160; </font><span><font color="#2b91af">Document</font></span><font color="#000000"> doc = uidoc.Document;&#160; <br />         <br />&#160; </font><span><font color="#2b91af">Transaction</font></span><font color="#000000"> transaction = </font><span><font color="#0000ff">new</font></span><font color="#000000">&#160;</font><span><font color="#2b91af">Transaction</font></span><font color="#000000">(doc);       <br />&#160; transaction.Start(</font><span><font color="#a31515">&quot;Create a sweep&quot;</font></span><font color="#000000">);&#160; <br />         <br />&#160; </font><span><font color="#008000">// Sketch plane is important and must match the curves below. </font></span>      <br /><font color="#000000">&#160; </font><span><font color="#008000">// Here we use a sketch plane whose normal is X.</font></span>      <br /><font color="#000000">&#160; </font><span><font color="#008000">// </font></span>      <br /><font color="#000000">&#160; </font><span><font color="#2b91af">Plane</font></span><font color="#000000"> geometryPlane =&#160; <br />&#160;&#160;&#160; doc.Application.Create.NewPlane(</font><span><font color="#2b91af">XYZ</font></span><font color="#000000">.BasisX, </font><span><font color="#2b91af">XYZ</font></span><font color="#000000">.Zero);       <br />&#160; </font><span><font color="#2b91af">SketchPlane</font></span><font color="#000000"> sketchPlane =&#160; <br />&#160;&#160;&#160; doc.FamilyCreate.NewSketchPlane(geometryPlane);&#160; <br />&#160; </font><span><font color="#2b91af">CurveArrArray</font></span><font color="#000000"> arrarr = </font><span><font color="#0000ff">new</font></span><font color="#000000">&#160;</font><span><font color="#2b91af">CurveArrArray</font></span><font color="#000000">();       <br />&#160; </font><span><font color="#2b91af">CurveArray</font></span><font color="#000000"> arr = </font><span><font color="#0000ff">new</font></span><font color="#000000">&#160;</font><span><font color="#2b91af">CurveArray</font></span><font color="#000000">();&#160; <br />         <br />&#160; </font><span><font color="#008000">// the units of the new arc angles are radians. </font></span>      <br /><font color="#000000">&#160; </font><span><font color="#008000">// Creating a profile of a circle</font></span>      <br /><font color="#000000">&#160; </font><span><font color="#008000">//</font></span>      <br /><font color="#000000">&#160; arr.Append(doc.Application.Create.NewArc(       <br />&#160;&#160;&#160; </font><span><font color="#0000ff">new</font></span><font color="#000000">&#160;</font><span><font color="#2b91af">XYZ</font></span><font color="#000000">(), 1.0, 0.0, 2 * </font><span><font color="#2b91af">Math</font></span><font color="#000000">.PI, </font><span><font color="#2b91af">XYZ</font></span><font color="#000000">.BasisX, </font><span><font color="#2b91af">XYZ</font></span><font color="#000000">.BasisY));       <br />&#160; arrarr.Append(arr);&#160; <br />&#160; </font><span><font color="#2b91af">SweepProfile</font></span><font color="#000000"> profile = doc.Application.       <br />&#160;&#160;&#160; Create.NewCurveLoopsProfile(arrarr);&#160; <br />         <br />&#160; </font><span><font color="#008000">// Two lines which proceed in the YZ plane defined by the sketch plane: OK. </font></span>      <br /><font color="#000000">&#160; </font><span><font color="#008000">// If the second line were to go out of the sketch plane this would fail.</font></span>      <br /><font color="#000000">&#160; </font><span><font color="#2b91af">CurveArray</font></span><font color="#000000"> curves = </font><span><font color="#0000ff">new</font></span><font color="#000000">&#160;</font><span><font color="#2b91af">CurveArray</font></span><font color="#000000">();       <br />         <br />&#160; </font><span><font color="#008000">// Comment out either the arc or the lines, can't use both together </font></span>      <br /><font color="#000000">&#160; </font><span><font color="#008000">// curves.Append(doc.Application.Create.</font></span>      <br /><font color="#000000">&#160; </font><span><font color="#008000">//&#160;&#160; NewLineBound(XYZ.Zero, new XYZ(0, 0, 10.0)));</font></span>      <br /><font color="#000000">&#160; </font><span><font color="#008000">// curves.Append(doc.Application.Create.</font></span>      <br /><font color="#000000">&#160; </font><span><font color="#008000">// NewLineBound(new XYZ(0, 0, 10.0), new XYZ(0, 10.0, 10.0))); </font></span>      <br /><font color="#000000">        <br />&#160; </font><span><font color="#008000">// Arc must lie in the sketch plane. Again, X doesn't change, and the arc is only in YZ.</font></span>      <br /><font color="#000000">&#160; </font><span><font color="#008000">//// Create a new arc using two ends and a point on the curve</font></span>      <br /><font color="#000000">&#160; </font><span><font color="#008000">// </font></span>      <br /><font color="#000000">&#160; </font><span><font color="#2b91af">XYZ</font></span><font color="#000000"> end0 = </font><span><font color="#0000ff">new</font></span><font color="#000000">&#160;</font><span><font color="#2b91af">XYZ</font></span><font color="#000000">(0, 0, 0); </font><span><font color="#008000">// start point of the arc</font></span>      <br /><font color="#000000">&#160; </font><span><font color="#0000ff">double</font></span><font color="#000000"> radius = 10.0;       <br />&#160; </font><span><font color="#2b91af">XYZ</font></span><font color="#000000"> end1 = </font><span><font color="#0000ff">new</font></span><font color="#000000">&#160;</font><span><font color="#2b91af">XYZ</font></span><font color="#000000">(0, radius * (1.0 - </font><span><font color="#2b91af">Math</font></span><font color="#000000">.Sin(</font><span><font color="#2b91af">Math</font></span><font color="#000000">.PI / 6.0)),       <br />&#160;&#160;&#160; radius * </font><span><font color="#2b91af">Math</font></span><font color="#000000">.Cos(</font><span><font color="#2b91af">Math</font></span><font color="#000000">.PI / 6.0)); </font><span><font color="#008000">// end point of the arc</font></span>      <br /><font color="#000000">&#160; </font><span><font color="#2b91af">XYZ</font></span><font color="#000000"> pointOnCurve = </font><span><font color="#0000ff">new</font></span><font color="#000000">&#160;</font><span><font color="#2b91af">XYZ</font></span><font color="#000000">(0, radius * (1.0 - </font><span><font color="#2b91af">Math</font></span><font color="#000000">.Sin(</font><span><font color="#2b91af">Math</font></span><font color="#000000">.PI / 3.0)),&#160; <br />&#160;&#160;&#160; radius * </font><span><font color="#2b91af">Math</font></span><font color="#000000">.Cos(</font><span><font color="#2b91af">Math</font></span><font color="#000000">.PI / 3.0)); </font><span><font color="#008000">// point along arc</font></span>      <br /><font color="#000000">&#160; </font><span><font color="#2b91af">Arc</font></span><font color="#000000"> arc = app.Create.NewArc(end0, end1, pointOnCurve);&#160; <br />&#160; curves.Append(arc);&#160; <br />&#160; </font><span><font color="#2b91af">Sweep</font></span><font color="#000000"> sweep = doc.FamilyCreate.NewSweep(</font><span><font color="#0000ff">true</font></span></font><font style="font-size: 7.8pt"><font color="#000000">, curves, sketchPlane,&#160; <br />&#160;&#160;&#160; profile, 0, </font><span><font color="#2b91af">ProfilePlaneLocation</font></span><font color="#000000">.Start);&#160; <br />&#160; transaction.Commit();</font></font></p>
