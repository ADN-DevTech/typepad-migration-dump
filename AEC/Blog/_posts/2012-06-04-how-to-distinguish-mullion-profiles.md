---
layout: "post"
title: "How to distinguish mullion profiles"
date: "2012-06-04 17:59:00"
author: "Mikako Harada"
categories:
  - ".NET"
  - "Mikako Harada"
  - "Revit"
original_url: "https://adndevblog.typepad.com/aec/2012/06/how-to-distinguish-mullion-profiles.html "
typepad_basename: "how-to-distinguish-mullion-profiles"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/aec/mikako-harada.html" target="_self" title="Mikako Harada">Mikako Harada</a></p>
<p><strong>Issue</strong></p>
<p>When I assign a profile to a Mullion in Revit, the drop-down list only includes profiles made using the Profile-Mullion.rft Imperial Template, plus a few system families. I want to create a similar drop-down list of mullion profiles but I&#39;m not sure how to determine if a profile is a mullion profile or something else. When I look at all the profiles in the API I see that all their categories are OST_ProfileFamilies.</p>
<p>How can I filter out just the mullion profiles like Revit does?</p>
<p><strong>Solution</strong></p>
<p>A profile family has profile Usage property in its definition. Mullion is the integer value &quot;8&quot;, and generic one is &quot;0&quot;.&#0160; You can use it to determine if the given profile is for mullion or not.&#0160; The sample code is attached below:</p>
<p>One thing to note, however, is that the system profiles isn&#39;t in the elements list. This is something Revit handles internally as a special case.&#0160; Let us know if you wish to access to the system profile. We&#39;ll log a wish.&#0160;</p>
<div style="font-family: Consolas; font-size: 8pt; color: black; background: white;">
<p style="margin: 0px;"><span style="line-hight: 140%;">&lt;</span><span style="color: #2b91af; line-hight: 140%;">Transaction</span><span style="line-hight: 140%;">(</span><span style="color: #2b91af; line-hight: 140%;">TransactionMode</span><span style="line-hight: 140%;">.Automatic)&gt; _</span></p>
<p style="margin: 0px;"><span style="color: blue; line-hight: 140%;">Public</span><span style="line-hight: 140%;"> </span><span style="color: blue; line-hight: 140%;">Class</span><span style="line-hight: 140%;"> </span><span style="color: #2b91af; line-hight: 140%;">RvtCmd_Test</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; </span><span style="color: blue; line-hight: 140%;">Implements</span><span style="line-hight: 140%;"> </span><span style="color: #2b91af; line-hight: 140%;">IExternalCommand</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; </span><span style="color: blue; line-hight: 140%;">Public</span><span style="line-hight: 140%;"> </span><span style="color: blue; line-hight: 140%;">Function</span><span style="line-hight: 140%;"> Execute(</span><span style="color: blue; line-hight: 140%;">ByVal</span><span style="line-hight: 140%;"> commandData </span><span style="color: blue; line-hight: 140%;">As</span><span style="line-hight: 140%;"> </span><span style="color: #2b91af; line-hight: 140%;">ExternalCommandData</span><span style="line-hight: 140%;">, _</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: blue; line-hight: 140%;">ByRef</span><span style="line-hight: 140%;"> message </span><span style="color: blue; line-hight: 140%;">As</span><span style="line-hight: 140%;"> </span><span style="color: blue; line-hight: 140%;">String</span><span style="line-hight: 140%;">, _</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: blue; line-hight: 140%;">ByVal</span><span style="line-hight: 140%;"> elements </span><span style="color: blue; line-hight: 140%;">As</span><span style="line-hight: 140%;"> </span><span style="color: #2b91af; line-hight: 140%;">ElementSet</span><span style="line-hight: 140%;">) _</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; </span><span style="color: blue; line-hight: 140%;">As</span><span style="line-hight: 140%;"> </span><span style="color: #2b91af; line-hight: 140%;">Result</span><span style="line-hight: 140%;"> </span><span style="color: blue; line-hight: 140%;">Implements</span><span style="line-hight: 140%;"> </span><span style="color: #2b91af; line-hight: 140%;">IExternalCommand</span><span style="line-hight: 140%;">.Execute</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160;</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; &#0160; </span><span style="color: blue; line-hight: 140%;">Dim</span><span style="line-hight: 140%;"> rvtDoc </span><span style="color: blue; line-hight: 140%;">As</span><span style="line-hight: 140%;"> </span><span style="color: #2b91af; line-hight: 140%;">Document</span><span style="line-hight: 140%;"> = commandData.Application.ActiveUIDocument.Document</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160;</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; &#0160; </span><span style="color: green; line-hight: 140%;">&#39;&#39;&#0160; get the list of profile families</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; &#0160; </span><span style="color: green; line-hight: 140%;">&#39;&#39;&#0160; we can only pick up standard family, however.&#0160; </span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160;&#0160;&#0160; </span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; &#0160; </span><span style="color: blue; line-hight: 140%;">Dim</span><span style="line-hight: 140%;"> collector </span><span style="color: blue; line-hight: 140%;">As</span><span style="line-hight: 140%;"> </span><span style="color: #2b91af; line-hight: 140%;">FilteredElementCollector</span><span style="line-hight: 140%;"> = </span><span style="color: blue; line-hight: 140%;">New</span><span style="line-hight: 140%;"> </span><span style="color: #2b91af; line-hight: 140%;">FilteredElementCollector</span><span style="line-hight: 140%;">(rvtDoc)</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; &#0160; </span><span style="color: green; line-hight: 140%;">&#39;&#39; this picks up only standard family types, however. </span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; &#0160; collector.OfCategory(</span><span style="color: #2b91af; line-hight: 140%;">BuiltInCategory</span><span style="line-hight: 140%;">.OST_ProfileFamilies)</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; &#0160; </span><span style="color: blue; line-hight: 140%;">Dim</span><span style="line-hight: 140%;"> elems </span><span style="color: blue; line-hight: 140%;">As</span><span style="line-hight: 140%;"> </span><span style="color: #2b91af; line-hight: 140%;">List</span><span style="line-hight: 140%;">(</span><span style="color: blue; line-hight: 140%;">Of</span><span style="line-hight: 140%;"> </span><span style="color: #2b91af; line-hight: 140%;">Element</span><span style="line-hight: 140%;">) = collector.ToElements</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; &#0160; </span><span style="color: green; line-hight: 140%;">&#39;&#39;&#0160; check the usage parameter from the loaded family. </span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; &#0160; </span><span style="color: green; line-hight: 140%;">&#39;&#39;&#0160; mullion profile = 8&#0160; &amp; Generic profile = 0 </span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160;&#0160;&#0160; </span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; &#0160; </span><span style="color: blue; line-hight: 140%;">Dim</span><span style="line-hight: 140%;"> elems2 = </span><span style="color: blue; line-hight: 140%;">New</span><span style="line-hight: 140%;"> </span><span style="color: #2b91af; line-hight: 140%;">List</span><span style="line-hight: 140%;">(</span><span style="color: blue; line-hight: 140%;">Of</span><span style="line-hight: 140%;"> </span><span style="color: #2b91af; line-hight: 140%;">Element</span><span style="line-hight: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; &#0160; </span><span style="color: blue; line-hight: 140%;">For</span><span style="line-hight: 140%;"> </span><span style="color: blue; line-hight: 140%;">Each</span><span style="line-hight: 140%;"> elem </span><span style="color: blue; line-hight: 140%;">As</span><span style="line-hight: 140%;"> </span><span style="color: #2b91af; line-hight: 140%;">Element</span><span style="line-hight: 140%;"> </span><span style="color: blue; line-hight: 140%;">In</span><span style="line-hight: 140%;"> elems</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-hight: 140%;">Dim</span><span style="line-hight: 140%;"> aType </span><span style="color: blue; line-hight: 140%;">As</span><span style="line-hight: 140%;"> </span><span style="color: #2b91af; line-hight: 140%;">FamilySymbol</span><span style="line-hight: 140%;"> = </span><span style="color: blue; line-hight: 140%;">CType</span><span style="line-hight: 140%;">(elem, </span><span style="color: #2b91af; line-hight: 140%;">FamilySymbol</span><span style="line-hight: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-hight: 140%;">Dim</span><span style="line-hight: 140%;"> paraUsage </span><span style="color: blue; line-hight: 140%;">As</span><span style="line-hight: 140%;"> </span><span style="color: #2b91af; line-hight: 140%;">Parameter</span><span style="line-hight: 140%;"> = aType.Family.Parameter(</span><span style="color: #2b91af; line-hight: 140%;">BuiltInParameter</span><span style="line-hight: 140%;">.FAM_PROFILE_USAGE)</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-hight: 140%;">If</span><span style="line-hight: 140%;"> (paraUsage.AsInteger = 8) </span><span style="color: blue; line-hight: 140%;">Or</span><span style="line-hight: 140%;"> (paraUsage.AsInteger = 0) </span><span style="color: blue; line-hight: 140%;">Then</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; &#0160; &#0160; &#0160; elems2.Add(elem)</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-hight: 140%;">End</span><span style="line-hight: 140%;"> </span><span style="color: blue; line-hight: 140%;">If</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; &#0160; </span><span style="color: blue; line-hight: 140%;">Next</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; &#0160; </span><span style="color: green; line-hight: 140%;">&#39;&#39;&#0160; show it</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160;&#0160;&#0160;&#0160;</span><span style="line-hight: 140%;">ShowElementList(elems2, </span><span style="color: #a31515; line-hight: 140%;">&quot;mullion profile families&quot;</span><span style="line-hight: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; &#0160; </span><span style="color: blue; line-hight: 140%;">Return</span><span style="line-hight: 140%;"> </span><span style="color: #2b91af; line-hight: 140%;">Result</span><span style="line-hight: 140%;">.Succeeded</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; </span><span style="color: blue; line-hight: 140%;">End</span><span style="line-hight: 140%;"> </span><span style="color: blue; line-hight: 140%;">Function</span></p>
<p style="margin: 0px;">&#0160;<span style="line-hight: 140%;">&#0160;</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160;</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; </span><span style="color: green; line-hight: 140%;">&#39;&#39;&#0160; Helper function to display info from a list of elements passed onto. </span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; </span><span style="color: green; line-hight: 140%;">&#39;&#39;&#0160; (Same as Revit Intro Lab3.) </span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160;&#0160;</span><span style="color: green; line-hight: 140%;"> </span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; </span><span style="color: blue; line-hight: 140%;">Sub</span><span style="line-hight: 140%;"> ShowElementList(</span><span style="color: blue; line-hight: 140%;">ByVal</span><span style="line-hight: 140%;"> elems </span><span style="color: blue; line-hight: 140%;">As</span><span style="line-hight: 140%;"> </span><span style="color: #2b91af; line-hight: 140%;">IList</span><span style="line-hight: 140%;">(</span><span style="color: blue; line-hight: 140%;">Of</span><span style="line-hight: 140%;"> </span><span style="color: #2b91af; line-hight: 140%;">Element</span><span style="line-hight: 140%;">), </span><span style="color: blue; line-hight: 140%;">ByVal</span><span style="line-hight: 140%;"> header </span><span style="color: blue; line-hight: 140%;">As</span><span style="line-hight: 140%;"> </span><span style="color: blue; line-hight: 140%;">String</span><span style="line-hight: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; &#0160; </span><span style="color: blue; line-hight: 140%;">Dim</span><span style="line-hight: 140%;"> s </span><span style="color: blue; line-hight: 140%;">As</span><span style="line-hight: 140%;"> </span><span style="color: blue; line-hight: 140%;">String</span><span style="line-hight: 140%;"> = header + </span><span style="color: #a31515; line-hight: 140%;">&quot;(&quot;</span><span style="line-hight: 140%;"> + elems.Count.ToString + </span><span style="color: #a31515; line-hight: 140%;">&quot;)&quot;</span><span style="line-hight: 140%;"> + vbCr + vbCr</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; &#0160; s = s + </span><span style="color: #a31515; line-hight: 140%;">&quot; - Class - Category - Name (or Family: Type Name) - Id - &quot;</span><span style="line-hight: 140%;"> + vbCr</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; &#0160; </span><span style="color: blue; line-hight: 140%;">For</span><span style="line-hight: 140%;"> </span><span style="color: blue; line-hight: 140%;">Each</span><span style="line-hight: 140%;"> elem </span><span style="color: blue; line-hight: 140%;">As</span><span style="line-hight: 140%;"> </span><span style="color: #2b91af; line-hight: 140%;">Element</span><span style="line-hight: 140%;"> </span><span style="color: blue; line-hight: 140%;">In</span><span style="line-hight: 140%;"> elems</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; &#0160; &#0160; s = s + ElementToString(elem)</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; &#0160; </span><span style="color: blue; line-hight: 140%;">Next</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; &#0160; </span><span style="color: #2b91af; line-hight: 140%;">TaskDialog</span><span style="line-hight: 140%;">.Show(</span><span style="color: #a31515; line-hight: 140%;">&quot;Revit UI Lab&quot;</span><span style="line-hight: 140%;">, s)</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; </span><span style="color: blue; line-hight: 140%;">End</span><span style="line-hight: 140%;"> </span><span style="color: blue; line-hight: 140%;">Sub</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; </span><span style="color: green; line-hight: 140%;">&#39;&#39;&#0160; Helper Funtion: summarize an element information as a line of text, </span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; </span><span style="color: green; line-hight: 140%;">&#39;&#39;&#0160; which is composed of: class, category, name and id. </span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; </span><span style="color: green; line-hight: 140%;">&#39;&#39;&#0160; name will be &quot;Family: Type&quot; if a given element is ElementType. </span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; </span><span style="color: green; line-hight: 140%;">&#39;&#39;&#0160; Intended for quick viewing of list of element, for example. </span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; </span><span style="color: green; line-hight: 140%;">&#39;&#39;&#0160; (Same as Revit Intro Lab3.) </span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; </span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; </span><span style="color: blue; line-hight: 140%;">Function</span><span style="line-hight: 140%;"> ElementToString(</span><span style="color: blue; line-hight: 140%;">ByVal</span><span style="line-hight: 140%;"> elem </span><span style="color: blue; line-hight: 140%;">As</span><span style="line-hight: 140%;"> </span><span style="color: #2b91af; line-hight: 140%;">Element</span><span style="line-hight: 140%;">) </span><span style="color: blue; line-hight: 140%;">As</span><span style="line-hight: 140%;"> </span><span style="color: blue; line-hight: 140%;">String</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; &#0160; </span><span style="color: blue; line-hight: 140%;">If</span><span style="line-hight: 140%;"> elem </span><span style="color: blue; line-hight: 140%;">Is</span><span style="line-hight: 140%;"> </span><span style="color: blue; line-hight: 140%;">Nothing</span><span style="line-hight: 140%;"> </span><span style="color: blue; line-hight: 140%;">Then</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-hight: 140%;">Return</span><span style="line-hight: 140%;"> </span><span style="color: #a31515; line-hight: 140%;">&quot;none&quot;</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; &#0160; </span><span style="color: blue; line-hight: 140%;">End</span><span style="line-hight: 140%;"> </span><span style="color: blue; line-hight: 140%;">If</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; &#0160; </span><span style="color: blue; line-hight: 140%;">Dim</span><span style="line-hight: 140%;"> name </span><span style="color: blue; line-hight: 140%;">As</span><span style="line-hight: 140%;"> </span><span style="color: blue; line-hight: 140%;">String</span><span style="line-hight: 140%;"> = </span><span style="color: #a31515; line-hight: 140%;">&quot;&quot;</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; &#0160; </span><span style="color: blue; line-hight: 140%;">If</span><span style="line-hight: 140%;"> </span><span style="color: blue; line-hight: 140%;">TypeOf</span><span style="line-hight: 140%;"> elem </span><span style="color: blue; line-hight: 140%;">Is</span><span style="line-hight: 140%;"> </span><span style="color: #2b91af; line-hight: 140%;">ElementType</span><span style="line-hight: 140%;"> </span><span style="color: blue; line-hight: 140%;">Then</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-hight: 140%;">Dim</span><span style="line-hight: 140%;"> param </span><span style="color: blue; line-hight: 140%;">As</span><span style="line-hight: 140%;"> </span><span style="color: #2b91af; line-hight: 140%;">Parameter</span><span style="line-hight: 140%;"> = _</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; &#0160; &#0160; &#0160; elem.Parameter(</span><span style="color: #2b91af; line-hight: 140%;">BuiltInParameter</span><span style="line-hight: 140%;">.SYMBOL_FAMILY_AND_TYPE_NAMES_PARAM)</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-hight: 140%;">If</span><span style="line-hight: 140%;"> param </span><span style="color: blue; line-hight: 140%;">IsNot</span><span style="line-hight: 140%;"> </span><span style="color: blue; line-hight: 140%;">Nothing</span><span style="line-hight: 140%;"> </span><span style="color: blue; line-hight: 140%;">Then</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; &#0160; &#0160; &#0160; name = param.AsString</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; &#0160; &#0160; </span><span style="color: blue; line-hight: 140%;">End</span><span style="line-hight: 140%;"> </span><span style="color: blue; line-hight: 140%;">If</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; &#0160; </span><span style="color: blue; line-hight: 140%;">Else</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; &#0160; &#0160; name = elem.Name</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; &#0160; </span><span style="color: blue; line-hight: 140%;">End</span><span style="line-hight: 140%;"> </span><span style="color: blue; line-hight: 140%;">If</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; &#0160; </span><span style="color: blue; line-hight: 140%;">Return</span><span style="line-hight: 140%;"> elem.GetType.Name + </span><span style="color: #a31515; line-hight: 140%;">&quot;; &quot;</span><span style="line-hight: 140%;"> + elem.Category.Name + </span><span style="color: #a31515; line-hight: 140%;">&quot;; &quot;</span><span style="line-hight: 140%;"> _</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; &#0160; + name + </span><span style="color: #a31515; line-hight: 140%;">&quot;; &quot;</span><span style="line-hight: 140%;"> + elem.Id.IntegerValue.ToString + vbCr</span></p>
<p style="margin: 0px;"><span style="line-hight: 140%;">&#0160; </span><span style="color: blue; line-hight: 140%;">End</span><span style="line-hight: 140%;"> </span><span style="color: blue; line-hight: 140%;">Function</span></p>
<p style="margin: 0px;">&#0160;&#0160;</p>
<p style="margin: 0px;"><span style="color: blue; line-hight: 140%;">End</span><span style="line-hight: 140%;"> </span><span style="color: blue; line-hight: 140%;">Class</span></p>
</div>
