---
layout: "post"
title: "Show customized Ribbon buttons in specific Revit product flavor"
date: "2012-07-05 00:20:51"
author: "Joe Ye"
categories:
  - ".NET"
  - "Joe Ye"
  - "Revit"
original_url: "https://adndevblog.typepad.com/aec/2012/07/show-customized-ribbon-buttons-to-specific-revit-product-flavor.html "
typepad_basename: "show-customized-ribbon-buttons-to-specific-revit-product-flavor"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/aec/joe-ye.html">Joe Ye</a></p>  <p>Some customized Ribbon buttons are designed only for specific Revit product flavor. For example, button A is designed only for Revit Structure. It should be hidden in Revit MEP or Revit Architecture. One way is through the setting in the plugin loading config file, *.addin.&#160; VisibilityMode tag controls the visibility in the three Revit product flavors. </p>  <p>To show a button only in Revit Structure, you can use the following setting. Please note the bold and italics line.</p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%; color: blue">&lt;?</span><span style="line-height: 140%; color: #a31515">xml</span><span style="line-height: 140%; color: blue"> </span><span style="line-height: 140%; color: red">version</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">1.0</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue"> </span><span style="line-height: 140%; color: red">encoding</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">utf-8</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">?&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&lt;</span><span style="line-height: 140%; color: #a31515">RevitAddIns</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue"> &lt;</span><span style="line-height: 140%; color: #a31515">AddIn</span><span style="line-height: 140%; color: blue"> </span><span style="line-height: 140%; color: red">Type</span><span style="line-height: 140%; color: blue">=</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">Command</span><span style="line-height: 140%">&quot;</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160; &lt;</span><span style="line-height: 140%; color: #a31515">Assembly</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">C:\Program Files\Autodesk\Revit Structure 2013\Program\SomeAddin2013.dll</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">Assembly</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160; &lt;</span><span style="line-height: 140%; color: #a31515">ClientId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">d796aae2-ab10-4e7b-bba9-e8ed56276ad6</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">ClientId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160; &lt;</span><span style="line-height: 140%; color: #a31515">FullClassName</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">Revit.A</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">FullClassName</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160; &lt;</span><span style="line-height: 140%; color: #a31515">VendorId</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">Vendor</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">VendorId</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160; &lt;</span><span style="line-height: 140%; color: #a31515">Text</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">Some Text</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">Text</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160; &lt;</span><span style="line-height: 140%; color: #a31515">TooltipImage</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">C:\Program Files\Autodesk\Revit Structure 2013\Program\\SomePictureLarge.png</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">TooltipImage</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160; &lt;</span><span style="line-height: 140%; color: #a31515">LargeImage</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">C:\Program Files\Autodesk\Revit Structure 2013\Program\\SomePictureLarge.png</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">LargeImage</span><span style="line-height: 140%; color: blue">&gt;&#160; </span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160; &lt;</span><span style="line-height: 140%; color: #a31515">SmallImage</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">C:\Program Files\Autodesk\Revit Structure 2013\Program\\SomePicture.png</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">SmallImage</span><span style="line-height: 140%; color: blue">&gt; </span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160; &lt;</span><span style="line-height: 140%; color: #a31515">Description</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">Some addin for Revit 2013</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">Description</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><strong><em><span> &lt;VisibilityMode</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">NotVisibleInFamily|NotvisibleInArchitecture|</span></em></strong></p>    <p style="margin: 0px"><strong><em><span style="line-height: 140%">NotVisibleInMEP</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">VisibilityMode</span><span style="line-height: 140%; color: blue">&gt; </span></em></strong></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160; &lt;</span><span style="line-height: 140%; color: #a31515">VisibilityMode</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">NotVisibleWhenNoActiveDocument</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">VisibilityMode</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160; &lt;</span><span style="line-height: 140%; color: #a31515">Discipline</span><span style="line-height: 140%; color: blue">&gt;</span><span style="line-height: 140%">Structure</span><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">Discipline</span><span style="line-height: 140%; color: blue">&gt;&#160; </span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160; &lt;/</span><span style="line-height: 140%; color: #a31515">AddIn</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&lt;/</span><span style="line-height: 140%; color: #a31515">RevitAddIns</span><span style="line-height: 140%; color: blue">&gt;</span></p>    <p style="margin: 0px">&#160;</p> </div>  <p>Here is the description of VisibilityMode tag, which is excerpted from the Revit API Developer Guide.pdf document.</p>  <p>The modes in which the external command will be visible.Multiple values may be set for this option. Optional; use this tag for ExternalCommands only.    <br />The default is to display the command in all modes and disciplines, including when there is no active document. Previously written external commands which need to run against the active document should either be modified to ensure that the code deals with invocation of the command when there is no active document, or apply the NotVisibleWhenNoActiveDocument mode. See table below for more information.</p>  <p>All the optional values for tag VisibilityMode is as follow. These values can be united by “|” operator.</p>  <blockquote>   <p>     <br />AlwaysVisible      <br />The command is available in all possible modes supported by the Revit API.      <br />NotVisibleInProject      <br />The command is invisible when there is a project document active.      <br />NotVisibleInFamily      <br />The command is invisible when there is a family document active.      <br />NotVisibleWhenNoActiveDocument      <br />The command is invisible when there is no active document.      <br />NotVisibleInArchitecture      <br />The command is invisible in Autodesk Revit Architecture.      <br />NotVisibleInStructure      <br />The command is invisible in Autodesk Revit Structure.      <br />NotVisibleInMechanical      <br />The command is invisible when the Mechanical discipline editing tools are available, e.g. in Autodesk Revit MEP.      <br />NotVisibleInElectrical      <br />The command is invisible when the Electrical discipline editing tools are available, e.g. in Autodesk Revit MEP.      <br />NotVisibleInPlumbing      <br />The command is invisible when the Plumbing discipline editing tools are available, e.g. in Autodesk Revit MEP.      <br />NotVisibleInMEP      <br />The command is invisible in Autodesk Revit MEP.</p></blockquote>
