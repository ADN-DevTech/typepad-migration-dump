---
layout: "post"
title: "Get Value from App.config file and Sur la France"
date: "2014-09-03 15:27:32"
author: "Jaime Rosales"
categories:
  - ".NET"
  - "Augusto Goncalves"
  - "Jaime Rosales"
  - "Revit"
  - "Revit Architecture"
  - "Revit MEP"
  - "Revit Structure"
original_url: "https://adndevblog.typepad.com/aec/2014/09/get-value-from-appconfig-file-and-sur-la-france.html "
typepad_basename: "get-value-from-appconfig-file-and-sur-la-france"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/aec/jaime-rosales.html">Jaime Rosales</a></p>  <p>After a great end of August, where the wedding was a total success, I now have a gorgeous wife for the rest of my life, the honeymoon vacation was incredible, the culinary experience in Iceland and France was unforgettable, I’m now back as a married man, wiser on the wine culture of France and 100 times more in love with black truffles. My batteries have fully recharged and I’m excited to be back.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b7c6da2893970b-pi" target="_blank"><img alt="Balance Rocks French Riviera" border="0" height="480" src="/assets/image_930738.jpg" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" title="Balance Rocks French Riviera" width="480" /></a></p>  <p>The question this time came from our Autodesk Forum.</p>  <p><a href="http://forums.autodesk.com/t5/revit-api/get-value-from-app-config-file/m-p/5244679#M7119" title="http://forums.autodesk.com/t5/revit-api/get-value-from-app-config-file/m-p/5244679#M7119">http://forums.autodesk.com/t5/revit-api/get-value-from-app-config-file/m-p/5244679#M7119</a></p>  <p><strong>Question: </strong>I am trying set up my addin to read folder name and path from app.config file.using:</p>  <pre style="font-size: 13px; font-family: consolas; background: #1e1e1e; color: gainsboro"><span style="color: #4ec9b0">ConfigurationManager</span><span style="color: #b4b4b4">.</span><span style="color: white">AppSettings</span>&#0160;</pre>

<p>to get the value. This is giving me an error.</p>

<pre style="font-size: 13px; font-family: consolas; background: #1e1e1e; color: gainsboro">[<span style="color: #4ec9b0">Transaction</span>(<span style="color: #b8d7a3">TransactionMode</span><span style="color: #b4b4b4">.</span><span style="color: white">Manual</span>)]<br /><span style="color: #569cd6">public</span>&#0160;<span style="color: #569cd6">class</span>&#0160;<span style="color: #4ec9b0">Command</span> : <span style="color: #b8d7a3">IExternalCommand</span><br />{<br />&#0160; <span style="color: #569cd6">public</span>&#0160;<span style="color: #b8d7a3">Result</span>&#0160;<span style="color: white">Execute</span>(<br />&#0160;&#0160;&#0160; <span style="color: #4ec9b0">ExternalCommandData</span>&#0160;<span style="color: white">commandData</span>,<br />&#0160;&#0160;&#0160; <span style="color: #569cd6">ref</span>&#0160;<span style="color: #569cd6">string</span>&#0160;<span style="color: white">message</span>,<br />&#0160;&#0160;&#0160; <span style="color: #4ec9b0">ElementSet</span>&#0160;<span style="color: white">elements</span>)<br />&#0160; {<br />&#0160;&#0160;&#0160; <span style="color: #4ec9b0">UIApplication</span>&#0160;<span style="color: white">uiapp</span>&#0160;<span style="color: #b4b4b4">=</span>&#0160;<span style="color: white">commandData</span><span style="color: #b4b4b4">.</span><span style="color: white">Application</span>;<br />&#0160;&#0160;&#0160; <span style="color: #4ec9b0">UIDocument</span>&#0160;<span style="color: white">uidoc</span>&#0160;<span style="color: #b4b4b4">=</span>&#0160;<span style="color: white">uiapp</span><span style="color: #b4b4b4">.</span><span style="color: white">ActiveUIDocument</span>;<br />&#0160;&#0160;&#0160; <span style="color: #4ec9b0">Application</span>&#0160;<span style="color: white">app</span>&#0160;<span style="color: #b4b4b4">=</span>&#0160;<span style="color: white">uiapp</span><span style="color: #b4b4b4">.</span><span style="color: white">Application</span>;<br />&#0160;&#0160;&#0160; <span style="color: #4ec9b0">Document</span>&#0160;<span style="color: white">doc</span>&#0160;<span style="color: #b4b4b4">=</span>&#0160;<span style="color: white">uidoc</span><span style="color: #b4b4b4">.</span><span style="color: white">Document</span>;<br /> <br />&#0160;&#0160;&#0160; <span style="color: #569cd6">string</span>&#0160;<span style="color: white">dir</span>&#0160;<span style="color: #b4b4b4">=</span>&#0160;<span style="color: #4ec9b0">ConfigurationManager</span><span style="color: #b4b4b4">.</span><span style="color: white">AppSettings</span>[<span style="color: #d69d85">&quot;pdfOutput&quot;</span>];<br />&#0160;&#0160;&#0160; <span style="color: #4ec9b0">TaskDialog</span><span style="color: #b4b4b4">.</span><span style="color: white">Show</span>(<span style="color: white">dir</span>, <span style="color: white">dir</span>);<br />&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; <span style="color: #569cd6">return</span>&#0160;<span style="color: #b8d7a3">Result</span><span style="color: #b4b4b4">.</span><span style="color: white">Succeeded</span>;<br />&#0160; }<br />}</pre>

<p>Here is the XML file:</p>

<pre style="font-size: 13px; font-family: consolas; background: #1e1e1e; color: gainsboro"><span style="color: gray">&lt;?</span><span style="color: #569cd6">xmlversion</span><span style="color: #c8c8c8">=&quot;1.0&quot;encoding=&quot;utf-8&quot; </span><span style="color: gray">?&gt;</span><br /><span style="color: gray">&lt;</span><span style="color: #569cd6">configuration</span><span style="color: gray">&gt;</span><br /><span style="color: gray">&#0160; &lt;</span><span style="color: #569cd6">configSections</span><span style="color: gray">&gt;</span><br /><span style="color: gray">&#0160;&#0160;&#0160; &lt;</span><span style="color: #569cd6">sectionGroupname</span><span style="color: gray">=</span><span style="color: gray">&quot;</span><span style="color: #c8c8c8">userSettings</span><span style="color: gray">&quot;</span><span style="color: #92caf4">type</span><span style="color: gray">=</span><span style="color: gray">&quot;</span><span style="color: #c8c8c8">System.Configuration.</span><br /><span style="color: #c8c8c8">                       UserSettingsGroup, System, Version=4.0.0.0, </span><br /><span style="color: #c8c8c8">	       Culture=neutral, PublicKeyToken=b77a5c561934e089</span><span style="color: gray">&quot;</span><span style="color: gray"> &gt;</span><br /><span style="color: gray">&#0160;&#0160;&#0160;&#0160;&#0160; &lt;</span><span style="color: #569cd6">sectionname</span><span style="color: gray">=</span><span style="color: gray">&quot;</span><span style="color: #c8c8c8">BabuRevitAPI.HCL</span><span style="color: gray">&quot;</span><span style="color: #92caf4">type</span><span style="color: gray">=</span><span style="color: gray">&quot;</span><span style="color: #c8c8c8">System.Configuration.</span><br /><span style="color: #c8c8c8">&#0160;&#0160; ClientSettingsSection, System, Version=4.0.0.0, </span><br /><span style="color: #c8c8c8">&#0160;&#0160; Culture=neutral, PublicKeyToken=b77a5c561934e089</span><span style="color: gray">&quot;</span><br /><span style="color: #92caf4">  allowExeDefinition</span><span style="color: gray">=</span><span style="color: gray">&quot;</span><span style="color: #c8c8c8">MachineToLocalUser</span><span style="color: gray">&quot;</span><span style="color: #92caf4">requirePermission</span><span style="color: gray">=</span><span style="color: gray">&quot;</span><span style="color: #c8c8c8">false</span><span style="color: gray">&quot;</span><span style="color: gray"> /&gt;</span><br /><span style="color: gray">&#0160;&#0160;&#0160;&#0160;&#0160; &lt;</span><span style="color: #569cd6">sectionname</span><span style="color: gray">=</span><span style="color: gray">&quot;</span><span style="color: #c8c8c8">BabuRevitAPI.Settings</span><span style="color: gray">&quot;</span><span style="color: #92caf4">type</span><span style="color: gray">=</span><span style="color: gray">&quot;</span><span style="color: #c8c8c8">System.Configuration.</span><br /><span style="color: #c8c8c8">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ClientSettingsSection, System, Version=4.0.0.0, </span><br /><span style="color: #c8c8c8">&#0160;&#0160; Culture=neutral, PublicKeyToken=b77a5c561934e089</span><span style="color: gray">&quot;</span><br /><span style="color: #92caf4">  allowExeDefinition</span><span style="color: gray">=</span><span style="color: gray">&quot;</span><span style="color: #c8c8c8">MachineToLocalUser</span><span style="color: gray">&quot;</span><span style="color: #92caf4">requirePermission</span><span style="color: gray">=</span><span style="color: gray">&quot;</span><span style="color: #c8c8c8">false</span><span style="color: gray">&quot;</span><span style="color: gray"> /&gt;</span><br /><span style="color: gray">&#0160;&#0160;&#0160;&#0160;&#0160; &lt;/</span><span style="color: #569cd6">sectionGroup</span><span style="color: gray">&gt;</span><br /><span style="color: gray">&#0160;&#0160;&#0160; &lt;/</span><span style="color: #569cd6">configSections</span><span style="color: gray">&gt;</span><br /><span style="color: gray">&#0160; &lt;</span><span style="color: #569cd6">userSettings</span><span style="color: gray">&gt;</span><br /><span style="color: gray">&#0160;&#0160;&#0160; &lt;</span><span style="color: #569cd6">BabuRevitAPI.HCL</span><span style="color: gray">&gt;</span><br /><span style="color: gray">&#0160;&#0160;&#0160;&#0160;&#0160; &lt;</span><span style="color: #569cd6">settingname</span><span style="color: gray">=</span><span style="color: gray">&quot;</span><span style="color: #c8c8c8">pdfOutput</span><span style="color: gray">&quot;</span><span style="color: #92caf4">serializeAs</span><span style="color: gray">=</span><span style="color: gray">&quot;</span><span style="color: #c8c8c8">String</span><span style="color: gray">&quot;</span><span style="color: gray">&gt;</span><br /><span style="color: gray">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &lt;</span><span style="color: #569cd6">value</span><span style="color: gray">&gt;</span><span style="color: #c8c8c8">pdf outt put folder</span><span style="color: gray">&lt;/</span><span style="color: #569cd6">value</span><span style="color: gray">&gt;</span><br /><span style="color: gray">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &lt;/</span><span style="color: #569cd6">setting</span><span style="color: gray">&gt;</span><br /><span style="color: gray">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &lt;</span><span style="color: #569cd6">settingname</span><span style="color: gray">=</span><span style="color: gray">&quot;</span><span style="color: #c8c8c8">auslocal</span><span style="color: gray">&quot;</span><span style="color: #92caf4">serializeAs</span><span style="color: gray">=</span><span style="color: gray">&quot;</span><span style="color: #c8c8c8">String</span><span style="color: gray">&quot;</span><span style="color: gray">&gt;</span><br /><span style="color: gray">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &lt;</span><span style="color: #569cd6">value</span><span style="color: gray">&gt;</span><span style="color: #c8c8c8">aus local folder</span><span style="color: gray">&lt;/</span><span style="color: #569cd6">value</span><span style="color: gray">&gt;</span><br /><span style="color: gray">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &lt;/</span><span style="color: #569cd6">setting</span><span style="color: gray">&gt;</span><br /><span style="color: gray">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &lt;</span><span style="color: #569cd6">settingname</span><span style="color: gray">=</span><span style="color: gray">&quot;</span><span style="color: #c8c8c8">test</span><span style="color: gray">&quot;</span><span style="color: #92caf4">serializeAs</span><span style="color: gray">=</span><span style="color: gray">&quot;</span><span style="color: #c8c8c8">String</span><span style="color: gray">&quot;</span><span style="color: gray">&gt;</span><br /><span style="color: gray">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &lt;</span><span style="color: #569cd6">value</span><span style="color: gray">&gt;</span><span style="color: #c8c8c8">I am a test</span><span style="color: gray">&lt;/</span><span style="color: #569cd6">value</span><span style="color: gray">&gt;</span><br /><span style="color: gray">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &lt;/</span><span style="color: #569cd6">setting</span><span style="color: gray">&gt;</span><br /><span style="color: gray">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; &lt;/</span><span style="color: #569cd6">BabuRevitAPI.HCL</span><span style="color: gray">&gt;</span><br /><span style="color: gray">&#0160; &lt;/</span><span style="color: #569cd6">userSettings</span><span style="color: gray">&gt;</span><br /><span style="color: gray">&lt;/</span><span style="color: #569cd6">configuration</span><span style="color: gray">&gt;</span></pre>

<p>
  <br />Error Image after using above code.</p>

<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01a73e0ed656970d-pi"><img alt="image" border="0" height="324" src="/assets/image_336505.jpg" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; display: inline; border-top-width: 0px" title="image" width="482" /></a></p>

<p><strong>Answer: </strong>There is a couple of steps we need to follow in order to solve this and not get our value = null like it’s happening in this case. Here is a snippet of code that came from one of our evangelists <a href="http://adndevblog.typepad.com/aec/augusto-goncalves.html">Augusto Goncalves</a>. Where we have to keep in mind that the config file needs to be at the same location and with the exact name as the DLL of our addin. This needs to be taken into consideration other than that the value will be null since it will be reading the AppSettings Keys from the Revit.exe.config file where the 4 existing keys will not match our custom one.</p>

<pre style="font-size: 13px; font-family: consolas; background: #1e1e1e; color: gainsboro">[<span style="color: #4ec9b0">Transaction</span>(<span style="color: #b8d7a3">TransactionMode</span><span style="color: #b4b4b4">.</span><span style="color: white">Manual</span>)]<br /><span style="color: #569cd6">public</span>&#0160;<span style="color: #569cd6">class</span>&#0160;<span style="color: #4ec9b0">Command</span> : <span style="color: #b8d7a3">IExternalCommand</span><br />{<br />&#0160; <span style="color: #569cd6">public</span>&#0160;<span style="color: #b8d7a3">Result</span>&#0160;<span style="color: white">Execute</span>(<br />&#0160;&#0160;&#0160; <span style="color: #4ec9b0">ExternalCommandData</span>&#0160;<span style="color: white">commandData</span>,<br />&#0160;&#0160;&#0160; <span style="color: #569cd6">ref</span>&#0160;<span style="color: #569cd6">string</span>&#0160;<span style="color: white">message</span>,<br />&#0160;&#0160;&#0160; <span style="color: #4ec9b0">ElementSet</span>&#0160;<span style="color: white">elements</span>)<br />&#0160; {<br />&#0160;&#0160;&#0160; <span style="color: #4ec9b0">UIApplication</span>&#0160;<span style="color: white">uiapp</span>&#0160;<span style="color: #b4b4b4">=</span>&#0160;<span style="color: white">commandData</span><span style="color: #b4b4b4">.</span><span style="color: white">Application</span>;<br />&#0160;&#0160;&#0160; <span style="color: #4ec9b0">UIDocument</span>&#0160;<span style="color: white">uidoc</span>&#0160;<span style="color: #b4b4b4">=</span>&#0160;<span style="color: white">uiapp</span><span style="color: #b4b4b4">.</span><span style="color: white">ActiveUIDocument</span>;<br />&#0160;&#0160;&#0160; <span style="color: #4ec9b0">Application</span>&#0160;<span style="color: white">app</span>&#0160;<span style="color: #b4b4b4">=</span>&#0160;<span style="color: white">uiapp</span><span style="color: #b4b4b4">.</span><span style="color: white">Application</span>;<br />&#0160;&#0160;&#0160; <span style="color: #4ec9b0">Document</span>&#0160;<span style="color: white">doc</span>&#0160;<span style="color: #b4b4b4">=</span>&#0160;<span style="color: white">uidoc</span><span style="color: #b4b4b4">.</span><span style="color: white">Document</span>;<br /> <br />&#0160;&#0160;&#0160; <span style="color: #4ec9b0">Configuration</span>&#0160;<span style="color: white">config</span>&#0160;<span style="color: #b4b4b4">=</span>&#0160;<span style="color: #4ec9b0">ConfigurationManager</span><span style="color: #b4b4b4">.</span><span style="color: white">OpenExeConfiguration</span><br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (<span style="color: white">System</span><span style="color: #b4b4b4">.</span><span style="color: white">Reflection</span><span style="color: #b4b4b4">.</span><span style="color: #4ec9b0">Assembly</span><span style="color: #b4b4b4">.</span><span style="color: white">GetExecutingAssembly</span>()<span style="color: #b4b4b4">.</span><span style="color: white">Location</span>);<br />&#0160;&#0160;&#0160; <span style="color: #569cd6">string</span>&#0160;<span style="color: white">value</span>&#0160;<span style="color: #b4b4b4">=</span>&#0160;<span style="color: white">config</span><span style="color: #b4b4b4">.</span><span style="color: white">AppSettings</span><span style="color: #b4b4b4">.</span><span style="color: white">Settings</span>[<span style="color: #d69d85">&quot;pdfOutput&quot;</span>]<span style="color: #b4b4b4">.</span><span style="color: white">Value</span>;<br />&#0160;&#0160;&#0160; <span style="color: #4ec9b0">TaskDialog</span><span style="color: #b4b4b4">.</span><span style="color: white">Show</span>(<span style="color: #d69d85">&quot;App config Value&quot;</span>, <span style="color: white">value</span>);<br />&#0160; <br />&#0160;&#0160;&#0160; <span style="color: #569cd6">return</span>&#0160;<span style="color: #b8d7a3">Result</span><span style="color: #b4b4b4">.</span><span style="color: white">Succeeded</span>;<br />&#0160; }<br />}</pre>

<p>Here is the .config file.</p>

<pre style="font-size: 13px; font-family: consolas; background: #1e1e1e; color: gainsboro"><span style="color: gray">&lt;?</span><span style="color: #569cd6">xml</span><span style="color: gray">&#0160;</span><span style="color: #92caf4">version</span><span style="color: gray">=</span><span style="color: gray">&quot;</span><span style="color: #c8c8c8">1.0</span><span style="color: gray">&quot;</span><span style="color: gray">&#0160;</span><span style="color: #92caf4">encoding</span><span style="color: gray">=</span><span style="color: gray">&quot;</span><span style="color: #c8c8c8">utf-8</span><span style="color: gray">&quot;</span><span style="color: gray"> ?&gt;</span><br /><span style="color: gray">&lt;</span><span style="color: #569cd6">configuration</span><span style="color: gray">&gt;</span><br /><span style="color: gray">&#0160; &lt;</span><span style="color: #569cd6">appSettings</span><span style="color: gray">&gt;</span><br /><span style="color: gray">&#0160;&#0160;&#0160; &lt;</span><span style="color: #569cd6">add</span><span style="color: gray">&#0160;</span><span style="color: #92caf4">key</span><span style="color: gray">=</span><span style="color: gray">&quot;</span><span style="color: #c8c8c8">pdfOutput</span><span style="color: gray">&quot;</span><span style="color: gray">&#0160;</span><span style="color: #92caf4">value</span><span style="color: gray">=</span><span style="color: gray">&quot;</span><span style="color: #c8c8c8">Yes, I&#39;m Working</span><span style="color: gray">&quot;</span><span style="color: gray">/&gt;</span><br /><span style="color: gray">&#0160; &lt;/</span><span style="color: #569cd6">appSettings</span><span style="color: gray">&gt;</span><br /><span style="color: gray">&lt;/</span><span style="color: #569cd6">configuration</span><span style="color: gray">&gt;</span></pre>

<p>As you notice the code in the answer is much simpler but keep in mind that is just for testing purposes.</p>

<p>Here is how the name should be placed at the location where our addin files gets installed.</p>

<p>&#0160;<a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d062d78d970c-pi" target="_blank"><img alt="Screen Shot 2014-09-03 at 5.59.00 PM" border="0" height="64" src="/assets/image_717965.jpg" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; display: inline; border-top-width: 0px" title="Screen Shot 2014-09-03 at 5.59.00 PM" width="481" /></a></p>

<p>After that is completed. <strong>Voilà!</strong></p>

<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b7c6d8ef0c970b-pi" target="_blank"><img alt="Screen Shot 2014-09-03 at 6.03.05 PM" border="0" height="342" src="/assets/image_715842.jpg" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; display: inline; border-top-width: 0px" title="Screen Shot 2014-09-03 at 6.03.05 PM" width="490" /></a></p>

<p>&#0160;</p>

<p>Thank you for reading, until next time.</p>
