---
layout: "post"
title: "Create Quick Properties"
date: "2013-02-21 19:16:24"
author: "Xiaodong Liang"
categories:
  - ".NET"
  - "COM"
  - "Navisworks"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/aec/2013/02/create-quick-properties.html "
typepad_basename: "create-quick-properties"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/aec/xiaodong-liang.html" target="_self">Xiaodong Liang</a>     <br /></p>  <p><a name="WS1A9193826455F5FF-30857B3612671CDEC1813DE"></a>From product help: </p>  <p><em>When Quick Properties are switched on, you can view property information in a tooltip style window as you move your cursor over objects in the Scene View. You donâ€™t need to select objects first. The quick properties tooltip disappears after a few seconds. <em>By default, quick properties show the name and type of the object, but you can use the Options Editor to define which properties are shown. Each definition that you configure enables you to display an additional category/property combination in quick properties. You can choose whether to hide category names in quick properties or not. </em></em></p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017c3705c392970b-pi"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="/assets/image_223135.jpg" width="214" height="170" /></a> </p>  <p><a name="WS73099CC142F48755-191A86AC126720FA354-56C8"></a></p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017ee8a8f3cb970d-pi"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="/assets/image_804006.jpg" width="333" height="275" /></a> </p>  <p>&#160;</p>  <p>In [Global Options] &gt;&gt; [Interface] &gt;&gt; [Quick Properties], you can add more definitions for the quick properties. </p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017ee8a8f416970d-pi"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="image" border="0" alt="image" src="/assets/image_403518.jpg" width="299" height="277" /></a> </p>  <p>Currently, only COM API allows you to access and edit the quick properties. In API terminology, Quick Properties is called Smart Tag. </p>  <p>You can enable it by    <br />&#160;&#160; <em>InwOpState3.SmartTagsEnabled      <br />      <br /></em>You can also get the smart tags of a path:&#160;&#160;&#160; </p>  <p><em>&#160;&#160; InwOpState4::SmartTagText&#160; ( [in] InwOaPath *&#160; path,&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; [out, retval] BSTR *&#160; Text&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ) </em></p>  <p></p>  <p></p>  <p></p>  <p></p>  <p>The API cannot add more definition,&#160; but it provides the ability to re-construct the definitions. The method is</p>  <p><em>&#160;&#160; InwGlobalProperties::SetSmartTagsOpts ([in] </em><a href="interfaceInwSmartTagsOpts.html"><em>InwSmartTagsOpts</em></a><em> * pI ) </em></p>  <p>InwSmartTagsOpts::Conditions can add various search conditions (definitions) .</p>  <p>The following is a small demo. It enable the quick properties,get the properties of the selected object, and re-construct the definitions with only one search condition.</p>  <div style="font-family: courier new; background: white; color: black; font-size: 9pt">   <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160; </span></p> </div>  <div style="font-family: courier new; background: white; color: black; font-size: 9pt">   <p style="margin: 0px"><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> QuickProperties()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">{</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; ComApi.</span><span style="line-height: 140%; color: #2b91af">InwOpState4</span><span style="line-height: 140%"> oState = ComApiBridge.</span><span style="line-height: 140%; color: #2b91af">ComApiBridge</span><span style="line-height: 140%">.State;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">//get the current selection</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">ModelItemCollection</span><span style="line-height: 140%"> oModelColl =</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; Autodesk.Navisworks.Api.</span><span style="line-height: 140%; color: #2b91af">Application</span><span style="line-height: 140%">.</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ActiveDocument.CurrentSelection.SelectedItems;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// simple demo: check the first model item only</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (oModelColl.Count &gt; 0)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; {</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">ModelItem</span><span style="line-height: 140%"> oFirstItem = oModelColl[0];</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; ComApi.</span><span style="line-height: 140%; color: #2b91af">InwOaPath</span><span style="line-height: 140%"> oPath =</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ComApiBridge.</span><span style="line-height: 140%; color: #2b91af">ComApiBridge</span><span style="line-height: 140%">.ToInwOaPath(oFirstItem);</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// get the content of the display string</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">MessageBox</span><span style="line-height: 140%">.Show(oState.SmartTagText(oPath));</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; }</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// re-construct the definitions</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// create a new property tag property</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; ComApi.</span><span style="line-height: 140%; color: #2b91af">InwSmartTagsOpts</span><span style="line-height: 140%"> oSmartTagOpt = </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (ComApi.</span><span style="line-height: 140%; color: #2b91af">InwSmartTagsOpts</span><span style="line-height: 140%">)oState.ObjectFactory(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; ComApi.</span><span style="line-height: 140%; color: #2b91af">nwEObjectType</span><span style="line-height: 140%">.eObjectType_nwSmartTagsOpts,</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">null</span><span style="line-height: 140%">,</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">null</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// the search condition of the property</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; ComApi.</span><span style="line-height: 140%; color: #2b91af">InwOpFindCondition</span><span style="line-height: 140%"> oOpFindCond = </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (ComApi.</span><span style="line-height: 140%; color: #2b91af">InwOpFindCondition</span><span style="line-height: 140%">)oState.ObjectFactory(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; ComApi.</span><span style="line-height: 140%; color: #2b91af">nwEObjectType</span><span style="line-height: 140%">.eObjectType_nwOpFindCondition,</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">null</span><span style="line-height: 140%">,</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">null</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// clear the conditions if you re-use the existing InwSmartTagsOpts</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">//oSmartTagOpt.Conditions().Clear();</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// demo: to display the property:</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// Entity Handle &gt;&gt; Value</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">//set attribute name: use the internal name and user name together!&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; oOpFindCond.SetAttributeNames(</span><span style="line-height: 140%; color: #a31515">&quot;LcOpDwgEntityAttrib&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;Entity Handle&quot;</span><span style="line-height: 140%"> );</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">//set property name: use the internal name and user name together!&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; oOpFindCond.SetPropertyNames( </span><span style="line-height: 140%; color: #a31515">&quot;LcOaNat64AttributeValue&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;Value&quot;</span><span style="line-height: 140%"> );</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">//search condition</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; oOpFindCond.Condition = ComApi.</span><span style="line-height: 140%; color: #2b91af">nwEFindCondition</span><span style="line-height: 140%">.eFind_HAS_PROP; </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">//add the condition to the InwSmartTagsOpts</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; oSmartTagOpt.Conditions().Add(oOpFindCond);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// add the InwSmartTagsOpts to global options</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; oState.GlobalProperties().SetSmartTagsOpts(oSmartTagOpt);</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// display the properties</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; oState.SmartTagsEnabled = </span><span style="line-height: 140%; color: blue">true</span><span style="line-height: 140%">; </span></p>    <p style="margin: 0px"><span style="line-height: 140%">}</span></p> </div>
