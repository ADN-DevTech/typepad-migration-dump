---
layout: "post"
title: "Add search selectionset in COM"
date: "2012-08-01 01:09:19"
author: "Xiaodong Liang"
categories:
  - "COM"
  - "Navisworks"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/aec/2012/08/add-search-selectionset-in-com.html "
typepad_basename: "add-search-selectionset-in-com"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/aec/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>  <p>In COM, you need to create a Find condition <span style="line-height: 140%; color: #2b91af">InwOpFindSpec</span><span style="line-height: 140%"> </span>and assign it to the new selectionset by InwOpSelectionSet2.ImplicitFindSpec. Following is a demo code: </p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> AddSearchSelectionSet()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">{</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// get state object</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; ComApi.</span><span style="line-height: 140%; color: #2b91af">InwOpState</span><span style="line-height: 140%"> oState = </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">ComBridge</span><span style="line-height: 140%">.State;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// new a selection set</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; ComApi.</span><span style="line-height: 140%; color: #2b91af">InwOpSelectionSet2</span><span style="line-height: 140%"> oNewSelSet = </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (ComApi.</span><span style="line-height: 140%; color: #2b91af">InwOpSelectionSet2</span><span style="line-height: 140%">)(</span><span style="line-height: 140%; color: blue">object</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oState.ObjectFactory(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; ComApi.</span><span style="line-height: 140%; color: #2b91af">nwEObjectType</span><span style="line-height: 140%">.eObjectType_nwOpSelectionSet);</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; oNewSelSet.name = </span><span style="line-height: 140%; color: #a31515">&quot;MySet&quot;</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// create the find condition</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; ComApi.</span><span style="line-height: 140%; color: #2b91af">InwOpFindSpec</span><span style="line-height: 140%"> nwFindSpec = </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (ComApi.</span><span style="line-height: 140%; color: #2b91af">InwOpFindSpec</span><span style="line-height: 140%">)(</span><span style="line-height: 140%; color: blue">object</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oState.ObjectFactory(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; ComApi.</span><span style="line-height: 140%; color: #2b91af">nwEObjectType</span><span style="line-height: 140%">.eObjectType_nwOpFindSpec);</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; ComApi.</span><span style="line-height: 140%; color: #2b91af">InwOpFindCondition</span><span style="line-height: 140%"> nwFindCondition = </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (ComApi.</span><span style="line-height: 140%; color: #2b91af">InwOpFindCondition</span><span style="line-height: 140%">)(</span><span style="line-height: 140%; color: blue">object</span><span style="line-height: 140%">)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oState.ObjectFactory(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; ComApi.</span><span style="line-height: 140%; color: #2b91af">nwEObjectType</span><span style="line-height: 140%">.eObjectType_nwOpFindCondition);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; nwFindCondition.SetAttributeNames(</span><span style="line-height: 140%; color: #a31515">&quot;&quot;</span><span style="line-height: 140%">, </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;Entity Handle&quot;</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; nwFindCondition.SetPropertyNames(</span><span style="line-height: 140%; color: #a31515">&quot;&quot;</span><span style="line-height: 140%">, </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;Value&quot;</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; nwFindCondition.Condition = </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; ComApi.</span><span style="line-height: 140%; color: #2b91af">nwEFindCondition</span><span style="line-height: 140%">.eFind_EQUAL;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; nwFindCondition.value = </span><span style="line-height: 140%; color: #a31515">&quot;187E2&quot;</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; nwFindSpec.selection = </span><span style="line-height: 140%; color: blue">null</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; nwFindSpec.SearchMode = </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; ComApi.</span><span style="line-height: 140%; color: #2b91af">nwESearchMode</span><span style="line-height: 140%">.eSearchMode_ALL_PATHS;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; nwFindSpec.Conditions().Add(nwFindCondition);</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// set the find condition to the selectionset</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; oNewSelSet.ImplicitFindSpec = nwFindSpec;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// add the selectionset to the collection</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; oState.SelectionSets().Add(oNewSelSet);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">}</span></p> </div>
