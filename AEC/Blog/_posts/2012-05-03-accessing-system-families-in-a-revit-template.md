---
layout: "post"
title: "Accessing System Families in a Revit Template"
date: "2012-05-03 22:53:00"
author: "Saikat Bhattacharya"
categories:
  - ".NET"
  - "Revit"
  - "Saikat Bhattacharya"
original_url: "https://adndevblog.typepad.com/aec/2012/05/accessing-system-families-in-a-revit-template.html "
typepad_basename: "accessing-system-families-in-a-revit-template"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/aec/saikat-bhattacharya.html" target="_self">Saikat Bhattacharya</a></p>  <p>To access the System Families in a Revit Template file, we can use the ElementType to list system family types (for example Wall types, floor types, etc).    <br />&#160; <br />The following code snippet, creates a list of all the ElementTypes including the system family types. The code create a log file with the type name as well as the family name (using the Built-In parameter) and this code can be run this on the template file to get the information desired.</p>  <div style="font-family: ; background: white">   <div style="font-family: ; background: white">     <div style="font-family: ; background: white">       <div style="font-family: ; background: white">         <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">[</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#2b91af">Transaction</font></span><span style="line-height: 11pt"><font color="#000000">(</font></span><span style="line-height: 11pt"><font color="#2b91af">TransactionMode</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.Manual)]</font></span></font></p>          <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">[</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#2b91af">Regeneration</font></span><span style="line-height: 11pt"><font color="#000000">(</font></span><span style="line-height: 11pt"><font color="#2b91af">RegenerationOption</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.Manual)]</font></span></font></p>          <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#0000ff"><font style="font-size: 8pt">public</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt"><font color="#0000ff">class</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt"><font color="#2b91af">Command</font></span><span style="line-height: 11pt"><font color="#000000"> : </font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#2b91af">IExternalCommand</font></span></font></p>          <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">{</font></font></span></p>          <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#0000ff">public</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt"><font color="#2b91af">Result</font></span><span style="line-height: 11pt"><font color="#000000"> Execute(</font></span></font></font></p>          <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#000000">&#160;&#160;&#160; </font></span><span style="line-height: 11pt"><font color="#2b91af">ExternalCommandData</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> commandData, </font></span></font></p>          <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#0000ff">ref</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt"><font color="#0000ff">string</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> message, </font></span></font></p>          <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#2b91af">ElementSet</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> elements)</font></span></font></p>          <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; {</font></font></span></p>          <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><span style="line-height: 11pt"><font style="font-size: 8pt" color="#008000">// Get the application and document </font></span></font></p>          <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#2b91af">Application</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> app = commandData.Application.Application;</font></span></font></p>          <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#2b91af">Document</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> activeDoc = </font></span></font></p>          <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; commandData.Application.ActiveUIDocument.Document;</font></font></span></p>          <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>          <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#0000ff">var</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> familyTypeCollector1 = </font></span></font></p>          <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt"><font color="#2b91af">FilteredElementCollector</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">(activeDoc);</font></span></font></p>          <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; familyTypeCollector1.OfClass(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#0000ff">typeof</font></span><span style="line-height: 11pt"><font color="#000000">(</font></span><span style="line-height: 11pt"><font color="#2b91af">ElementType</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">));</font></span></font></p>          <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#2b91af">IList</font></span><span style="line-height: 11pt"><font color="#000000">&lt;</font></span><span style="line-height: 11pt"><font color="#2b91af">Element</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">&gt; famTypes = </font></span></font></p>          <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; familyTypeCollector1.ToElements();</font></span></font></p>          <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>          <div style="font-family: ; background: white">           <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; System.IO.</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#2b91af">StreamWriter</font></span><span style="line-height: 11pt"><font color="#000000"> writer </font></span></font></font><font face="Courier New"><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#000000">= </font></span></font></font></p>            <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#000000">&#160;&#160;&#160;&#160;&#160; </font></span><span style="line-height: 11pt"><font color="#0000ff">new</font></span><span style="line-height: 11pt"><font color="#000000"> System.IO.</font></span><span style="line-height: 11pt"><font color="#2b91af">StreamWriter</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">(</font></span></font></p>            <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#a31515">&quot;C:\\Temp\\ElementTypes.txt&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">);</font></span></font></p>         </div>          <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>          <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#0000ff">foreach</font></span><span style="line-height: 11pt"><font color="#000000"> (</font></span><span style="line-height: 11pt"><font color="#2b91af">Element</font></span><span style="line-height: 11pt"><font color="#000000"> ele </font></span><span style="line-height: 11pt"><font color="#0000ff">in</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> famTypes)</font></span></font></p>          <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></span></p>          <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#2b91af">ElementType</font></span><span style="line-height: 11pt"><font color="#000000"> type = ele </font></span><span style="line-height: 11pt"><font color="#0000ff">as</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt"><font color="#2b91af">ElementType</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">;</font></span></font></p>          <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#0000ff">if</font></span><span style="line-height: 11pt"><font color="#000000"> (</font></span><span style="line-height: 11pt"><font color="#0000ff">null</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000"> != type)</font></span></font></p>          <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; {</font></font></span></p>          <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; writer.WriteLine(</font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#a31515">&quot;-------------------------------&quot;</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">); </font></span></font></p>          <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; writer.WriteLine(</font></font></span></font><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">type.Name + </font></font></span></font><font face="Courier New"><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#a31515">&quot;: &quot; </font></span></font></font></p>          <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#a31515"><span style="line-height: 11pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span></font></font><font face="Courier New"><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">+ type.get_Parameter(</font></span></font></p>          <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#2b91af">BuiltInParameter</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.SYMBOL_FAMILY_NAME_PARAM)</font></span></font></p>          <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; .</font></span></font><font face="Courier New"><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">AsString());</font></span></font></p>          <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; }</font></font></span></p>          <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></span><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>          <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; writer.Close();</font></font></span></p>          <p style="margin: 0px"><font face="Courier New"><span style="line-height: 11pt"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="line-height: 11pt"><font color="#0000ff">return</font></span><span style="line-height: 11pt"><font color="#000000"> </font></span><span style="line-height: 11pt"><font color="#2b91af">Result</font></span></font><span style="line-height: 11pt"><font style="font-size: 8pt" color="#000000">.Succeeded;</font></span></font></p>          <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; }</font></font></span></p>          <p style="margin: 0px"><span style="line-height: 11pt"><font face="Courier New"><font style="font-size: 8pt" color="#000000">}</font></font></span></p>       </div>     </div>   </div> </div>  <p>Using this code with the Column template, creates the output text file listing the symbol and the family names contained in the template, as shown below:</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0168eb18a11c970c-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: block; float: none; margin-left: auto; border-top: 0px; margin-right: auto; border-right: 0px; padding-top: 0px" title="ElementTypes.txt" border="0" alt="Type:Family output" src="/assets/image_114298.jpg" width="240" height="233" /></a></p>
