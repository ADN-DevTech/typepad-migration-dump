---
layout: "post"
title: "Call Plugin within Application of .NET Control"
date: "2014-03-19 01:03:00"
author: "Xiaodong Liang"
categories:
  - ".NET"
  - "Navisworks"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/aec/2014/03/call-plugin-within-application-of-net-control.html "
typepad_basename: "call-plugin-within-application-of-net-control"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/aec/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>
<h5>In the past, it is impossible for an application of .NET control to communicate with a plugin. Now you can. The solution is very simple. It is just similar to what is mentioned in the other post:</h5>
<h5><a href="http://adndevblog.typepad.com/aec/2013/05/navisworks-2014-api-new-feature-dynamic-loading-of-plugin.html">Dynamic Loading of Plugin</a></h5>
<p>In short, if you want to use any plugin, you can load it firstly and call the relevant method of the plugin. The following is repeating as the other post demos. It assumes a plugin has been deployed to &lt;Navisworks Install Path&gt;\Plugins\BasicPlugIn_LoadTest.ADSK\. Navisworks can load it when it is launching, while your .NET control application needs to load it explicitly.</p>
<p>This is the test demo source.&#0160; <span class="asset  asset-generic at-xid-6a0167607c2431970b01b8d13a86d8970c img-responsive"><a href="http://adndevblog.typepad.com/files/test_dynamic_load.zip">Download Test_dynamic_load</a></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: 新宋体;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="color: #0000ff;"><span style="font-size: 9pt;">using</span></span></span><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> Autodesk.Navisworks.Api.Controls;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: 新宋体;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="color: #0000ff;"><span style="font-size: 9pt;">using</span></span></span><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> Autodesk.Navisworks.Api;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: 新宋体;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="color: #0000ff;"><span style="font-size: 9pt;">using</span></span></span><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> Autodesk.Navisworks.Api.Plugins;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: 新宋体;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="color: #0000ff;"><span style="font-size: 9pt;">private</span></span></span><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-size: 9pt;"><span><span style="color: #0000ff;">void</span></span><span style="color: #000000;"> button1_Click(</span><span><span style="color: #0000ff;">object</span></span><span style="color: #000000;"> sender, </span><span><span style="color: #2b91af;">EventArgs</span></span><span style="color: #000000;"> e)</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="font-size: 9pt; color: #000000;">{ </span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #0000ff;">string</span></span><span style="color: #000000;"> plugin_name_to_load = </span><span><span style="color: #a31515;">&quot;BasicPlugIn_LoadTest.ADSK&quot;</span></span><span style="color: #000000;">;</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #2b91af;">PluginRecord</span></span><span style="color: #000000;"> dotest = </span><span><span style="color: #0000ff;">null</span></span><span style="color: #000000;">;</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span></span><span><span style="font-size: 9pt; color: #0000ff;">try</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">{</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160; &#0160; &#0160; &#0160;</span></span><span style="font-size: 9pt;">dotest = Autodesk.Navisworks.Api.</span></span><span style="font-size: 9pt;"><span><span style="color: #2b91af;">Application</span></span><span style="color: #000000;">.Plugins.</span></span></span></span><span lang="EN-US"><span style="font-family: 新宋体;"><span><span><span style="font-size: 9pt;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160;&#0160;</span></span><span style="font-size: 9pt;">FindPlugin(plugin_name_to_load);</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;">&#0160;</p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #0000ff;">if</span></span><span style="color: #000000;"> (dotest != </span><span><span style="color: #0000ff;">null</span></span><span style="color: #000000;">)</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">{</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;"><span style="mso-spacerun: yes;">&#0160;</span></span></span><span><span style="font-size: 9pt; color: #008000;">// the plugin has been loaded. exit.</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #2b91af;">MessageBox</span></span><span style="color: #000000;">.Show(</span><span><span style="color: #a31515;">&quot;the plugin &quot;</span></span><span style="color: #000000;"> +</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">plugin_name_to_load +</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #a31515;">&quot; has been loaded!&quot;</span></span><span style="color: #000000;">);</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #0000ff;">return</span></span><span style="color: #000000;">;</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">}</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="font-size: 9pt; color: #0000ff;">else</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">{</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="font-size: 9pt; color: #008000;">// load the plugin assembly</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">Autodesk.Navisworks.Api.</span></span><span style="font-size: 9pt;"><span><span style="color: #2b91af;">Application</span></span><span style="color: #000000;">.Plugins.AddPluginAssembly<br />&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; (path of the dll</span></span></span></span><span style="font-family: 新宋体;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;">);</span></span></span><span lang="EN-US"><span style="font-family: 新宋体;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="font-size: 9pt; color: #008000;">// get the plugin record.</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #2b91af;">PluginRecord</span></span><span style="color: #000000;"> otherpluginrecord =</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">Autodesk.Navisworks.Api.</span></span><span style="font-size: 9pt;"><span><span style="color: #2b91af;">Application</span></span><span style="color: #000000;">.Plugins.</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; FindPlugin(plugin_name_to_load);</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #0000ff;">if</span></span><span style="color: #000000;"> (otherpluginrecord != </span><span><span style="color: #0000ff;">null</span></span><span style="color: #000000;">)</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">{</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="color: #008000;"><span style="font-size: 9pt;">//loaded</span><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #0000ff;">if</span></span><span style="color: #000000;"> (!otherpluginrecord.IsLoaded)</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">{</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="font-size: 9pt; color: #008000;">//load the plugin</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">otherpluginrecord.LoadPlugin();</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #2b91af;">MessageBox</span></span><span style="color: #000000;">.Show(</span><span><span style="color: #a31515;">&quot;the plugin &quot;</span></span><span style="color: #000000;"> +</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; plugin_name_to_load + <br /></span></span></span></span><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="font-size: 9pt;"><span><span style="color: #a31515;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; has been loaded by AddPluginAssembly!&quot;</span></span><span style="color: #000000;">);</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="font-size: 9pt; color: #008000;">//get the plugin of the record</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #2b91af;">Plugin</span></span><span style="color: #000000;"> otherplugin =</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160; &#0160;&#0160;</span></span><span style="font-size: 9pt;"><span style="mso-spacerun: yes;">&#0160;</span>otherpluginrecord.LoadedPlugin;</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span><span style="font-size: 9pt; color: #008000;">&#0160; //call one method of the plugin</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span><span style="font-size: 9pt; color: #008000;">&#0160; //since we do not know the type of the other plugin,</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span><span style="font-size: 9pt; color: #008000;">&#0160; //use InvokeMember</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #0000ff;">string</span></span><span style="color: #000000;">[] pa = { </span><span><span style="color: #a31515;">&quot;dummy&quot;</span></span><span style="color: #000000;"> };</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; otherplugin.GetType().InvokeMember(</span></span><span style="font-size: 9pt;"><span><span style="color: #a31515;">&quot;Execute&quot;</span></span><span style="color: #000000;">, <br /></span></span></span></span><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="color: #000000;"><span style="font-size: 9pt;">System.Reflection.</span></span><span style="font-size: 9pt;"><span><span style="color: #2b91af;">BindingFlags</span></span><span style="color: #000000;">.InvokeMethod,</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="font-size: 9pt;"><span><span style="color: #0000ff;">null</span></span><span style="color: #000000;">, otherplugin, pa);</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">}</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">}</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="font-size: 9pt; color: #0000ff;">else</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160; </span>{</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="font-size: 9pt; color: #008000;">// any other problems</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #2b91af;">MessageBox</span></span><span style="color: #000000;">.Show(</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #a31515;">&quot;My app has tried to load the plugin &quot;</span></span><span style="color: #000000;"> +</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">plugin_name_to_load +</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #a31515;">&quot; but it is still null. Please check the path name!&quot;</span></span><span style="color: #000000;">);</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">}</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">}</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">}</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #0000ff;">catch</span></span><span style="color: #000000;"> (</span><span><span style="color: #2b91af;">Exception</span></span><span style="color: #000000;"> ex)</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">{</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #008000;">// any exception</span></span><span style="mso-spacerun: yes;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="mso-spacerun: yes;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">}</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt;"><span style="font-family: 新宋体;"><span style="font-size: 9pt; color: #000000;">}</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;">&#0160;</p>
