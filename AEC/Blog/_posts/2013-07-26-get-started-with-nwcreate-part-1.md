---
layout: "post"
title: "Get started with NwCreate - part 1"
date: "2013-07-26 00:10:42"
author: "Xiaodong Liang"
categories: []
original_url: "https://adndevblog.typepad.com/aec/2013/07/get-started-with-nwcreate-part-1.html "
typepad_basename: "get-started-with-nwcreate-part-1"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/aec/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>  <p>The NWCreate API provides a means of creating NavisWorks models, either for export of NWD files from a third party application (<strong>LiNwcApi</strong>) or to implement a file loader (<strong>LiNwcLoader</strong>) for NavisWorks. The figure below shows the two features.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0192ac32a8a1970d-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="/assets/image_271987.jpg" width="410" height="190" /></a>&#160; <br />Either feature does not mean you can add additional model/elements to the existing model. Instead, you can just create your own model on a blank document. The difference of them is:</p>  <p><strong>LiNwcAPI</strong> is a standalone EXE which creates the model. You can save to a nwd file. i.e. a new file.</p>  <p><strong>LiNwcLoader</strong> is a kind of plugin which is loaded by Navisworks. This plugin provides the machaism how to create&#160; a model with the data of the specific file format which Navisworks does not support. e.g. assume you have a file format whose extension name is: *.myfile, when you try to open such file, Navisworks will look for the corresponding loader and get to know how to use the data of the file, finally create the models.</p>  <p>NWCreate is a stdcall interface callable from C, C++, etc. All data manipulation is by means of handles (LiNwcTypes) providing complete encapsulation. For ease of use a C++ wrapper API is provided that gives an object oriented interface to the API. </p>  <p>We deploy the binary dll and lib for the features in the SDK folder <strong>api\NwCreate\bin</strong> and <strong>api\NwCreate\lib</strong>. Note: you will need to link to 32bits lib for 32bits program and 64bits for 64bits program.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0192ac32a8b6970d-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="/assets/image_457600.jpg" width="271" height="218" /></a></p>  <p>In this section, we firstly introduce LiNwcAPI. Your application should link with <b>nwcreate.lib</b> distributed in from the ‘lib’ directory. The implementation of the API is in <b>nwcreate.dll</b> from the ‘bin’ directory. You <strong>should</strong> distribute this dll with your application. </p>  <p>The typical workflow is:</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01901e7338d6970b-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="/assets/image_887397.jpg" width="216" height="549" /></a></p>  <p>Let us start with a sample. This sample is to export a NWC file.&#160; </p>  <p>1. Create a C++ Console Application</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0192ac32a8ec970d-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="/assets/image_172322.jpg" width="320" height="383" /></a></p>  <p>&#160;</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b019104694e5e970c-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="/assets/image_951111.jpg" width="316" height="290" /></a></p>  <p>2. Link with <b>nwcreate.lib</b>. I am testing on 64bits OS, so link to 64bits version at </p>  <p><font color="#232323"><strong>\api\nwcreate\lib\x64</strong></font></p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b019104694e71970c-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="/assets/image_836281.jpg" width="344" height="150" /></a></p>  <p>&#160;</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b019104694e8a970c-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="/assets/image_674857.jpg" width="409" height="143" /></a></p>  <p>3. Add include folder <strong>\api\nwcreate\include</strong></p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0192ac32a946970d-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="/assets/image_602659.jpg" width="392" height="245" /></a></p>  <p>&#160;</p>  <p>3.&#160; Add necessary head files <strong>‘nwcreate/LiNwcAll.h’ </strong>in testLiNwcAPI.cpp. This head file includes all head files of NwCreate.</p>  <p>4. Add the code in main function. </p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Times New Roman"><span style="font-family: ; color: ; mso-bidi-font-size: 9.5pt"><font color="#0000ff"><font style="font-size: 8pt">#include</font></font></span><span style="font-family: ; mso-bidi-font-size: 9.5pt"><font style="font-size: 8pt"><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#a31515">&quot;stdafx.h&quot;</font></span></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Times New Roman"><span style="font-family: ; color: ; mso-bidi-font-size: 9.5pt"><font color="#0000ff"><font style="font-size: 8pt">#include</font></font></span><span style="font-family: ; mso-bidi-font-size: 9.5pt"><font style="font-size: 8pt"><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#a31515">&quot;nwcreate/LiNwcAll.h&quot;</font></span></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.5pt"><font face="Times New Roman"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Times New Roman"><span style="font-family: ; color: ; mso-bidi-font-size: 9.5pt"><font color="#0000ff"><font style="font-size: 8pt">int</font></font></span><span style="font-family: ; mso-bidi-font-size: 9.5pt"><font style="font-size: 8pt"><font color="#000000"> _tmain(</font><span style="color: "><font color="#0000ff">int</font></span><font color="#000000"> argc, _TCHAR* argv[])</font></font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.5pt"><font face="Times New Roman"><font style="font-size: 8pt" color="#000000">{</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.5pt"><font face="Times New Roman"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.5pt"><font face="Times New Roman"><font color="#000000"><span style="mso-tab-count: 1"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt"><span style="mso-spacerun: yes">&#160;&#160; </span></font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// Initialise low-level API first. </font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.5pt"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160; </font></span><font style="font-size: 8pt">LiNwcApiErrorInitialise();</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.5pt"><font face="Times New Roman"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.5pt"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font></span><span style="color: "><font style="font-size: 8pt" color="#008000">// Then initialise the rest of the API. </font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.5pt"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">switch</font></span><font color="#000000"> (LiNwcApiInitialise())</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.5pt"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160; </font></span><font style="font-size: 8pt">{</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.5pt"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">case</font></span><font color="#000000"> LI_NWC_API_OK:</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.5pt"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">doExport();</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.5pt"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">break</font></span><font color="#000000">;</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.5pt"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">case</font></span><font color="#000000"> LI_NWC_API_NOT_LICENSED:</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.5pt"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">printf(</font></font><font style="font-size: 8pt"><span style="color: "><font color="#a31515">&quot;Not Licensed\n&quot;</font></span><font color="#000000">);</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.5pt"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> 1;</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.5pt"><font face="Times New Roman"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.5pt"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">case</font></span><font color="#000000"> LI_NWC_API_INTERNAL_ERROR:</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.5pt"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">default</font></span><font color="#000000">:</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.5pt"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">printf(</font></font><font style="font-size: 8pt"><span style="color: "><font color="#a31515">&quot;Internal Error\n&quot;</font></span><font color="#000000">);</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.5pt"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> 1;</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.5pt"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160; </font></span><font style="font-size: 8pt">} </font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.5pt"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160; </font></span><font style="font-size: 8pt">LiNwcApiTerminate();</font><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160; </font></span></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.5pt"><span style="mso-spacerun: yes"><font face="Times New Roman"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; </font></font></span></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.5pt"><font face="Times New Roman"><span style="mso-tab-count: 1"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> 0;</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.5pt"><font face="Times New Roman"><font style="font-size: 8pt" color="#000000">}</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.5pt"><font face="Times New Roman"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char" class="MsoNormal">5. Implement the export function doExport.</p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char" class="MsoNormal">&#160;</p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Times New Roman"><span style="font-family: ; color: ; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: nsimsun; mso-no-proof: yes"><font color="#0000ff"><font style="font-size: 8pt">void</font></font></span><span style="font-family: ; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: nsimsun; mso-no-proof: yes"><font style="font-size: 8pt" color="#000000"> doExport()</font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: nsimsun; mso-no-proof: yes"><font face="Times New Roman"><font style="font-size: 8pt" color="#000000">{</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: nsimsun; mso-no-proof: yes"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160; </font></span><font style="font-size: 8pt">LtWideString wfilename<span style="mso-spacerun: yes">&#160; </span>= L</font></font><font style="font-size: 8pt"><span style="color: "><font color="#800000">&quot;C:\\test.nwc&quot;</font></span><font color="#000000">;</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: nsimsun; mso-no-proof: yes"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160; </font></span><font style="font-size: 8pt">LtNwcScene scene;</font><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160; </font></span></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: nsimsun; mso-no-proof: yes"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160; </font></span><font style="font-size: 8pt">LtNwcGeometry geom; </font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: nsimsun; mso-no-proof: yes"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160; </font></span><font style="font-size: 8pt">LtNwcGeometryStream stream;</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: nsimsun; mso-no-proof: yes"><font face="Times New Roman"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: nsimsun; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font></span><span style="color: "><font style="font-size: 8pt" color="#008000">//create scene and geometry</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: nsimsun; mso-no-proof: yes"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160; </font></span><font style="font-size: 8pt">scene = LiNwcSceneCreate();</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: nsimsun; mso-no-proof: yes"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160; </font></span><font style="font-size: 8pt">geom = LiNwcGeometryCreate();</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: nsimsun; mso-no-proof: yes"><font face="Times New Roman"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: nsimsun; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font></span><span style="color: "><font style="font-size: 8pt" color="#008000">//open geometry stream, draw a triangle, close stream</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: nsimsun; mso-no-proof: yes"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160; </font></span><font style="font-size: 8pt">stream = LiNwcGeometryOpenStream(geom);</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: nsimsun; mso-no-proof: yes"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160; </font></span><font style="font-size: 8pt">LiNwcGeometryStreamBegin (stream, 0);<span style="mso-spacerun: yes">&#160;&#160;&#160; </span>LiNwcGeometryStreamTriangleVertex(stream, 1, 0, 0);</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: nsimsun; mso-no-proof: yes"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160; </font></span><font style="font-size: 8pt">LiNwcGeometryStreamTriangleVertex(stream, 2, 0, 10); </font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: nsimsun; mso-no-proof: yes"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160; </font></span><font style="font-size: 8pt">LiNwcGeometryStreamTriangleVertex(stream, 3, 10, 10);</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: nsimsun; mso-no-proof: yes"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160; </font></span><font style="font-size: 8pt">LiNwcGeometryStreamEnd(stream);<span style="mso-spacerun: yes">&#160;&#160;&#160; </span>LiNwcGeometryCloseStream( geom, stream);</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: nsimsun; mso-no-proof: yes"><span style="mso-spacerun: yes"><font face="Times New Roman"><font style="font-size: 8pt" color="#000000">&#160;&#160; </font></font></span></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: nsimsun; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font></span><span style="color: "><font style="font-size: 8pt" color="#008000">//add the geometry to the scene and cleanup geom</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: nsimsun; mso-no-proof: yes"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160; </font></span><font style="font-size: 8pt">LiNwcSceneAddNode (scene, geom);</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: nsimsun; mso-no-proof: yes"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160; </font></span><font style="font-size: 8pt">LiNwcGeometryDestroy(geom);</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: nsimsun; mso-no-proof: yes"><span style="mso-spacerun: yes"><font face="Times New Roman"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160; </font></font></span></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: nsimsun; mso-no-proof: yes"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160; </font></font></span><span style="color: "><font style="font-size: 8pt" color="#008000">//write out the NWC file</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: nsimsun; mso-no-proof: yes"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160; </font></span><font style="font-size: 8pt">LiNwcSceneWriteCacheEx(scene, wfilename, wfilename, 0, 0); </font></font></font></span></p>  <p style="line-height: 13pt; margin: 0in 0in 0pt; layout-grid-mode: char" class="MsoNormal"><span style="line-height: 9pt; font-family: ; mso-bidi-font-size: 9.0pt; mso-fareast-font-family: nsimsun; mso-no-proof: yes"><font face="Times New Roman"><font style="font-size: 8pt" color="#000000">}</font></font></span><span style="line-height: 12pt; font-family: ; mso-bidi-font-size: 11.0pt"></span></p>  <p style="line-height: 13pt; margin: 0in 0in 0pt; layout-grid-mode: char" class="MsoNormal">&#160;</p>  <p>6. Copy the NwCreate bindary dll files in the folder&#160; <strong>\api\nwcreate\bin\x64 </strong>to the same folder of your application binary, e.g. </p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0192ac32a958970d-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="/assets/image_455225.jpg" width="345" height="420" /></a></p>  <p>7. Run the program, a file named test.nwc will be generated, in which a triangle is produced. </p>  <p>&#160;</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01901e733975970b-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="/assets/image_544618.jpg" width="397" height="369" /></a></p>
