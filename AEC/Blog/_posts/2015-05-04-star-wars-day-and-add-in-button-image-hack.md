---
layout: "post"
title: "Star Wars Day and Add-in button image hack."
date: "2015-05-04 13:25:34"
author: "Jaime Rosales"
categories:
  - ".NET"
  - "Cloud"
  - "Jaime Rosales"
  - "Off-topic"
  - "Revit"
  - "Revit Architecture"
  - "Revit MEP"
  - "Revit Structure"
original_url: "https://adndevblog.typepad.com/aec/2015/05/star-wars-day-and-add-in-button-image-hack.html "
typepad_basename: "star-wars-day-and-add-in-button-image-hack"
typepad_status: "Publish"
---

<p><a href="http://adndevblog.typepad.com/aec/jaime-rosales.html">By Jaime Rosales</a> (@<a href="https://twitter.com/AfroJme">afrojme</a>)</p>  <p>May the 4th be with all of you, Today is one of my favorite days, As you have seen before I am a huge Star Wars fan and I cannot wait for December for the New Episode 7 movie to come out. Today during my lunch break, I ran into R2-D2 and some Jawas that had him captured in NYC #<a href="https://twitter.com/search?q=%23CaptureTheDroid&amp;src=tyah">capturethedroid</a>, after saying the magical phrase of “<em>This is just the droid I was looking for</em>” to the Jawas, they didn’t had any other choice than released him and I myself to scored a couple of nice Star Wars prices in celebration of #Maythe4th. </p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d10e4d6f970c-pi"><img title="IMG_8783" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; display: inline; border-top-width: 0px" border="0" alt="IMG_8783" src="/assets/image_138579.jpg" width="480" height="360" /></a> </p>  <p>Also here is a 3D model of the new little droid for the upcoming Episode VII – BB8 loaded in our A360 viewer for you to play with, trust me you will spend a couple of more minutes here just spinning this little guy around. Enjoy.</p> <iframe style="height: 463px; width: 484px" height="480" src="https://autodesk145.autodesk360.com/shares/public/SH7f1edQT22b515c761e3fcebcc6f16b60e0?mode=embed" frameborder="0" width="640" mozallowfullscreen="true" webkitallowfullscreen="true" allowfullscreen="true"></iframe>  <p>&#160;</p>  <p>Also today, I got to help Drew Jarvis from Red Top Training in Canada with a little hack on how to make your plug-in icon pick up the right side of 32x32 pixels and be displayed correctly, It can get sometimes a bit annoying, I don’t know if is Visual Studio the one that has a glitch but after this hack the icon gets displayed in the right size. Here is the question. </p>  <p><strong>Question</strong>: I have a button on a ribbon, which I have supplied a 32x32 image for:     <br /><a href="http://globaletraining.ca/icon/app_32.png">http://globaletraining.ca/icon/app_32.png</a>     <br />using the following code: </p>  <pre style="font-size: 13px; font-family: consolas; background: #1e1e1e; color: gainsboro"><span style="color: #4ec9b0">PushButton</span>&#160;<span style="color: white">Button01</span>&#160;<span style="color: #b4b4b4">=</span>&#160;<span style="color: white">GeTRibbon</span><span style="color: #b4b4b4">.</span><span style="color: white">AddItem</span>(<span style="color: #569cd6">new</span>&#160;<br />&#160;&#160;&#160; <span style="color: #4ec9b0">PushButtonData</span>(<span style="color: #d69d85">&quot;GeT&quot;</span>, <span style="color: #d69d85">&quot;GeT&quot;</span>, <span style="color: white">assembly</span>, <br />&#160;&#160;&#160; <span style="color: #569cd6">typeof</span>(<span style="color: white">LoadDockableDialog</span>)<span style="color: #b4b4b4">.</span><span style="color: white">FullName</span>)) <span style="color: #569cd6">as</span>&#160;<span style="color: #4ec9b0">PushButton</span>;<br />&#160; <span style="color: white">Button01</span><span style="color: #b4b4b4">.</span><span style="color: white">LargeImage</span>&#160;<span style="color: #b4b4b4">=</span>&#160;<span style="color: #569cd6">new</span>&#160;<span style="color: #4ec9b0">BitmapImage</span>(<span style="color: white">GeT32</span>);<br />&#160;&#160;&#160;&#160;&#160; <br />&#160; <span style="color: white">Button01</span><span style="color: #b4b4b4">.</span><span style="color: white">ToolTipImage</span>&#160;<span style="color: #b4b4b4">=</span>&#160;<span style="color: #569cd6">new</span>&#160;<span style="color: #4ec9b0">BitmapImage</span>(<span style="color: white">GeT32</span>);<br />&#160; <span style="color: white">Button01</span><span style="color: #b4b4b4">.</span><span style="color: white">ToolTip</span>&#160;<span style="color: #b4b4b4">=</span>&#160;<span style="color: #d69d85">&quot;Load the GeT Help System&quot;</span>;<br />&#160;&#160;&#160;&#160; <br />&#160; <span style="color: white">MainDockableWindow</span><span style="color: #b4b4b4">.</span><span style="color: white">InitiatedText</span><span style="color: #b4b4b4">.</span><span style="color: white">Content</span>&#160;<span style="color: #b4b4b4">=</span>&#160;<br />&#160;&#160;&#160; <span style="color: #d69d85">&quot;Please Run the GeT&quot;</span>&#160;<span style="color: #b4b4b4">+</span>&#160;<span style="color: #4ec9b0">Environment</span><span style="color: #b4b4b4">.</span><span style="color: white">NewLine</span>&#160;<span style="color: #b4b4b4">+</span>&#160;<br />&#160;&#160;&#160; <span style="color: #d69d85">&quot;Command on the Revit&quot;</span>&#160;<span style="color: #b4b4b4">+</span>&#160;<span style="color: #4ec9b0">Environment</span><span style="color: #b4b4b4">.</span><span style="color: white">NewLine</span>&#160;<span style="color: #b4b4b4">+</span>&#160;<br />&#160;&#160;&#160; <span style="color: #d69d85">&quot;Add-Ins Ribbon Tab to&quot;</span>&#160;<span style="color: #b4b4b4">+</span>&#160;<span style="color: #4ec9b0">Environment</span><span style="color: #b4b4b4">.</span><span style="color: white">NewLine</span>&#160;<span style="color: #b4b4b4">+</span>&#160;<br />&#160;&#160;&#160; <span style="color: #d69d85">&quot;Initialize the Get Addin&quot;</span>; </pre>

<p>However the image is always very small, attached is an example, how does the Dynamo button image look so large and mine looks so tiny? should I be using something other than PushButton?</p>

<p><strong>Answer</strong>: Thank you for your query, I have tested it and it works with the following snippet of code, also see attached proof. </p>

<p>&#160;<a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d10e4d73970c-pi"><img title="proof image" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; display: inline; border-top-width: 0px" border="0" alt="proof image" src="/assets/image_583515.jpg" width="480" height="73" /></a> </p>

<pre style="font-size: 13px; font-family: consolas; background: #1e1e1e; color: gainsboro"><span style="color: #4ec9b0">PushButton</span>&#160;<span style="color: white">pushButton</span>&#160;<span style="color: #b4b4b4">=</span>&#160;<span style="color: white">ribbonPanel</span><span style="color: #b4b4b4">.</span><span style="color: white">AddItem</span>(<span style="color: white">buttonData</span>) <span style="color: #569cd6">as</span>&#160;<span style="color: #4ec9b0">PushButton</span>;<br /><span style="color: white">pushButton</span><span style="color: #b4b4b4">.</span><span style="color: white">ToolTip</span>&#160;<span style="color: #b4b4b4">=</span>&#160;<span style="color: #d69d85">&quot;Your ToolTip Text Here&quot;</span>;<br /><span style="color: #4ec9b0">Uri</span>&#160;<span style="color: white">uriImage</span>&#160;<span style="color: #b4b4b4">=</span>&#160;<span style="color: #569cd6">new</span>&#160;<span style="color: #4ec9b0">Uri</span>(<span style="color: #d69d85">&quot;C:\\app-32.png&quot;</span>, <span style="color: #b8d7a3">UriKind</span><span style="color: #b4b4b4">.</span><span style="color: white">RelativeOrAbsolute</span>);<br /><span style="color: #4ec9b0">BitmapImage</span>&#160;<span style="color: white">largeImage</span>&#160;<span style="color: #b4b4b4">=</span>&#160;<span style="color: #569cd6">new</span>&#160;<span style="color: #4ec9b0">BitmapImage</span>(<span style="color: white">uriImage</span>);<br /><span style="color: white">pushButton</span><span style="color: #b4b4b4">.</span><span style="color: white">LargeImage</span>&#160;<span style="color: #b4b4b4">=</span>&#160;<span style="color: white">largeImage</span>;</pre>

<p>Let me know how it goes ok. </p>

<p><strong>Response</strong>: Thanks Jaime, unfortunately this doesn’t seem to work for me, it still gives me a small image, which is odd as I haven’t specified an .Image only a .LargeImage, do you think I should try another image? What is the maximum image size that can be used? Is there a best suggested format?</p>

<p><strong>Answer</strong> <strong>2</strong>:Thank you for letting me know, as per our phone conversation, You are using the correct format and size of your image in order to be displayed in your plug-in. Like I said try to debug it a couple of times with the code I provided and play a bit with the names of the icon, you can roll it back when the plug-in picks up the right size. </p>

<p>I know it is very strange but that is how I tried it in the past and with your image as well and it worked. </p>

<p>Let me know how it goes ok. </p>

<p><strong>Final Response</strong>: Thanks, that worked, I pointed it at a new filename and it worked without issue.Cheers. 

  <br /></p>

<p>Another Happy developer with his case resolved. </p>

<p>Thanks for reading and I hope it helps some of you in the future. Until next time.</p>
