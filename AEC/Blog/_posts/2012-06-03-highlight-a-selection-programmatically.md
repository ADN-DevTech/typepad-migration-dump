---
layout: "post"
title: "highlight a selection programmatically"
date: "2012-06-03 23:05:13"
author: "Xiaodong Liang"
categories:
  - ".NET"
  - "COM"
  - "Navisworks"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/aec/2012/06/highlight-a-selection-programmatically.html "
typepad_basename: "highlight-a-selection-programmatically"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/aec/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>  <p>With COM API, you could setup an InwOpSelection and add the paths which is the result of the find. And call State.CurrentSelection = your InwOpSelection. While in .NET API,&#160; current selection is exposed as a document part CurrentSelection. The highlighting&#160; objects is to change the selected items of CurrentSelection. </p>  <p>The code below shows the ways to highlight in COM and .NET.</p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> Autodesk.Navisworks.Api;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> ComApi = Autodesk.Navisworks.Api.Interop.ComApi;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> ComApiBridge = Autodesk.Navisworks.Api.ComApi;</span></p>    <p style="margin: 0px"><span style="line-height: 140%"></span></p> </div>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%; color: green">// highlight objects</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> highlight()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">{</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Document</span><span style="line-height: 140%"> oDoc =</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; Autodesk.Navisworks.Api.</span><span style="line-height: 140%; color: #2b91af">Application</span><span style="line-height: 140%">.ActiveDocument;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// assume we get two model items</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">ModelItem</span><span style="line-height: 140%"> oItem1 = </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oDoc.Models[0].RootItem.DescendantsAndSelf.</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; ElementAt&lt;</span><span style="line-height: 140%; color: #2b91af">ModelItem</span><span style="line-height: 140%">&gt;(1);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">ModelItem</span><span style="line-height: 140%"> oItem2 =&#160; </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oDoc.Models[0].RootItem.DescendantsAndSelf.</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; ElementAt&lt;</span><span style="line-height: 140%; color: #2b91af">ModelItem</span><span style="line-height: 140%">&gt;(2);</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// create ModelItemCollection</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">ModelItemCollection</span><span style="line-height: 140%"> oSel_Net =</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">ModelItemCollection</span><span style="line-height: 140%">();</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; oSel_Net.Add(oItem1);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; oSel_Net.Add(oItem2); </span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// highlight by .NET API</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; oDoc.CurrentSelection.SelectedItems.CopyFrom(oSel_Net);</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">//highlight by COM API</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; ComApi.</span><span style="line-height: 140%; color: #2b91af">InwOpState10</span><span style="line-height: 140%"> state =</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; ComApiBridge.</span><span style="line-height: 140%; color: #2b91af">ComApiBridge</span><span style="line-height: 140%">.State;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; ComApi.</span><span style="line-height: 140%; color: #2b91af">InwOpSelection</span><span style="line-height: 140%"> comSelectionOut = </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; ComApiBridge.</span><span style="line-height: 140%; color: #2b91af">ComApiBridge</span><span style="line-height: 140%">.ToInwOpSelection(oSel_Net);</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; state.CurrentSelection = comSelectionOut;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">}</span></p> </div>
