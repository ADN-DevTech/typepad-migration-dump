---
layout: "post"
title: "Working with Presenter by API"
date: "2013-12-29 19:13:36"
author: "Xiaodong Liang"
categories:
  - ".NET"
  - "COM"
  - "Navisworks"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/aec/2013/12/working-with-presenter-by-api.html "
typepad_basename: "working-with-presenter-by-api"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/aec/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>  <p>The ability of Presenter is available only in COM API currently. It is provided in terms of a plug-in. You will need to use COM interop if you work with .NET API. </p>  <p>In theory, there are three ways to get material, but there are some limitations with the current API. </p>  <p>1) assume you have added a material to the palette by UI. you can iterate and find it by name. this works with plug-in or control. </p>  <p>2) you can add a material from archive. But this only works in a plug-in. It does not work in .NET or ActiveX control. </p>  <p>3) API has one method to add material from a bitmap. However it is not implemented yet. </p>  <p>The following code shows the 3 ways. Please note the comments. </p>  <p>&#160;</p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><font face="Courier New"><span style="font-family: ; color: "><font color="#0000ff"><font style="font-size: 8pt">public</font></font></span><span style="font-family: "><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000"> applyMaterial()</font></font></span></font><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">{</font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; ComApi.</font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">InwOpState10</font></span><font color="#000000"> state;</font></font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; ComApi.</font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">InwOwPresenterElement</font></span><font color="#000000"> m_presenter = </font><span style="color: "><font color="#0000ff">null</font></span><font color="#000000">;</font></font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; state = </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">ComBridge</font></span><font color="#000000">.State;</font></font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">//find presenter plugin</font></span></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">foreach</font></span><font color="#000000"> (ComApi.</font><span style="color: "><font color="#2b91af">InwBase</font></span><font color="#000000"> oPlugin </font><span style="color: "><font color="#0000ff">in</font></span><font color="#000000"> state.Plugins())</font></font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (oPlugin.ObjectName == </font><span style="color: "><font color="#a31515">&quot;nwOwPresenterElement&quot;</font></span><font color="#000000">)</font></font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_presenter = (ComApi.</font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">InwOwPresenterElement</font></span><font color="#000000">)oPlugin;</font></font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">break</font></span><font color="#000000">;</font></font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (m_presenter == </font><span style="color: "><font color="#0000ff">null</font></span><font color="#000000">)</font></font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; System.Windows.Forms.</font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">MessageBox</font></span><font color="#000000">.Show(</font><span style="color: "><font color="#a31515">&quot;cannot find presenter plugin!&quot;</font></span><font color="#000000">);</font></font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000">;</font></font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; ComApi.</font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">InwOwUserMaterialsColl</font></span><font color="#000000"> materials = m_presenter.UserMaterials();</font></font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; ComApi.</font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">InwOwMaterial</font></span><font color="#000000"> material_to_apply = </font><span style="color: "><font color="#0000ff">null</font></span><font color="#000000">;</font></font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">String</font></span><font color="#000000"> oMaterial_name_to_apply = </font><span style="color: "><font color="#a31515">&quot;Shiny texture&quot;</font></span><font color="#000000">;</font></font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// way1: assume the &quot;Shiny texture&quot; has been added to the palette by UI</font></span></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// iterate and find the material</font></span></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">//bool flgFind = false;</font></span></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">//foreach (dynamic dmaterial in m_presenter.UserMaterials())</font></span></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">//{</font></span></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">//&#160;&#160;&#160; ComApi.InwOwMaterial nmaterial = dmaterial as ComApi.InwOwMaterial;</font></span></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">//&#160;&#160;&#160; if (nmaterial.name == oMaterial_name_to_apply)</font></span></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">//&#160;&#160;&#160; {</font></span></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">//&#160;&#160;&#160;&#160;&#160;&#160;&#160; material_to_apply = nmaterial;</font></span></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">//&#160;&#160;&#160;&#160;&#160;&#160;&#160; flgFind = true;</font></span></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">//&#160;&#160;&#160;&#160;&#160;&#160;&#160; break;</font></span></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">//&#160;&#160;&#160; }</font></span></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">//}</font></span></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// way2: in plugin, you can add from Archive</font></span></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// Note: this does not work with ActiveX control or .NET control</font></span></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">try</font></span></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {&#160; </font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_presenter.UserMaterials().AddFromArchive(oMaterial_name_to_apply);</font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; material_to_apply = m_presenter.UserMaterials().Last() </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">as</font></span><font color="#000000"> ComApi.</font><span style="color: "><font color="#2b91af">InwOwMaterial</font></span><font color="#000000">;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">catch</font></span><font color="#000000"> (</font><span style="color: "><font color="#2b91af">SystemException</font></span><font color="#000000"> ex)</font></font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; { ;}</font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">//// way3: from bitmap // this is NOT implemented!!</font></span></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">//try</font></span></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">//{&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">//&#160;&#160;&#160; //m_presenter.UserMaterials().LoadFromFile(@&quot;c:\mytest.bmp&quot;);</font></span></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">//}</font></span></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">//catch (SystemException ex)</font></span></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">//{ ;}&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (material_to_apply != </font><span style="color: "><font color="#0000ff">null</font></span><font color="#000000">)</font></font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; {</font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><span style="color: "><font style="font-size: 8pt" color="#008000">// apply the material to the selected object</font></span></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (state.CurrentSelection.Paths().Count &gt; 0)</font></font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">foreach</font></span><font color="#000000"> (ComApi.</font><span style="color: "><font color="#2b91af">InwOaPath</font></span><font color="#000000"> path </font><span style="color: "><font color="#0000ff">in</font></span><font color="#000000"> state.CurrentSelection.Paths())</font></font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_presenter.MaterialMappings().AddMapping(oMaterial_name_to_apply, path, </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">false</font></span><font color="#000000">);</font></font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; }</font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font face="Courier New"><font style="font-size: 8pt" color="#000000">}</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; background: white"><span style="font-family: "><font color="#000000" face="Courier New"></font></span></p>  <p>About changing background, you could find a sample in SDK \api\COM\examples\Auto\AutoPresenterExample </p>  <p>or refer to this blog:   <br /><a href="http://adndevblog.typepad.com/aec/2012/07/changing-background-for-publishing-file-using-script-automation-in-navisworks.html">http://adndevblog.typepad.com/aec/2012/07/changing-background-for-publishing-file-using-script-automation-in-navisworks.html</a></p>
