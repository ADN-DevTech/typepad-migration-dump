---
layout: "post"
title: "Navisworks 2014 API new feature - Override Transformation"
date: "2013-05-13 00:36:51"
author: "Xiaodong Liang"
categories:
  - ".NET"
  - "Navisworks"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/aec/2013/05/navisworks-2014-api-new-feature-override-transformation.html "
typepad_basename: "navisworks-2014-api-new-feature-override-transformation"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/aec/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>  <p>In the past, we have to use COM interop to override the transformation of the objects by the method State.OverrideTransform. Here is a blog on how to transform the whole model. It is similar if you transform an object.    <br /><a title="http://adndevblog.typepad.com/aec/2012/08/transform-nodes-of-a-loaded-model.html" href="http://adndevblog.typepad.com/aec/2012/08/transform-nodes-of-a-loaded-model.html">http://adndevblog.typepad.com/aec/2012/08/transform-nodes-of-a-loaded-model.html</a></p>  <p>2014 .NET API provides the direct ways. </p>  <ul>   <li><strong>DocumentModels.OverridePermanentTransform</strong> (&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; IEnumerable&lt;ModelItem&gt; items,&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Transform3D transform,&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; bool updateModelTransform) </li> </ul>  <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; this method applies an incremental transform to a selection with a transform matrix. </p>  <ul>   <li><strong>DocumentModels.ResetAllPermanentTransforms</strong>() </li> </ul>  <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; this method reset incremental transforms for all model items contained in the entire model. </p>  <p>In addition, .NET API allows you to access the transformation information of the objects. While in the past, we cannot know the override value.</p>  <ul>   <li><strong>ModelGeometry.OriginalTransform</strong>: Returns the original transform of the geometry when it was loaded. </li>    <li><strong>ModelGeometry.PermanentOverrideTransform</strong>: Transform applied to the original transform of the model geometry </li>    <li><strong>ModelGeometry.PermanentTransform</strong> : Permanent transform for the model geometry. The transform formed as a result of combining the original transform with the override transform </li> </ul>  <div style="font-family: courier new; background: white; color: black; font-size: 9pt">   <p style="margin: 0px">     <div style="font-family: courier new; background: white; color: black; font-size: 9pt">       <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">override</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">int</span><span style="line-height: 140%"> Execute(</span><span style="line-height: 140%; color: blue">params</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%">[] parameters)</span></p>        <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; { </span></p>        <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Document</span><span style="line-height: 140%"> doc = Autodesk.Navisworks.Api.</span><span style="line-height: 140%; color: #2b91af">Application</span><span style="line-height: 140%">.MainDocument;</span></p>        <p style="margin: 0px">&#160;</p>        <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// current selection</span></p>        <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">ModelItemCollection</span><span style="line-height: 140%"> coll = doc.CurrentSelection.SelectedItems;</span></p>        <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (coll.Count == 0)</span></p>        <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> 0;</span></p>        <p style="margin: 0px">&#160;</p>        <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">//build a vector for moving</span></p>        <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Vector3D</span><span style="line-height: 140%"> oNewVector3d = </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Vector3D</span><span style="line-height: 140%">(1, 1, 0);</span></p>        <p style="margin: 0px">&#160;</p>        <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// optional way 1: orthogonal transforms + translation</span></p>        <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">//*********</span></p>        <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">//build an identity matrix which represents orthogonal transforms </span></p>        <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Matrix3</span><span style="line-height: 140%"> oNewIndentityM = </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Matrix3</span><span style="line-height: 140%">();&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span></p>        <p style="margin: 0px">&#160;</p>        <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">//create a transform from a matrix with a vector.</span></p>        <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Transform3D</span><span style="line-height: 140%"> oNewOverrideTrans = </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Transform3D</span><span style="line-height: 140%">(oNewIndentityM, oNewVector3d);</span></p>        <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">//***********</span></p>        <p style="margin: 0px">&#160;</p>        <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// optional way 2: direct static function</span></p>        <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">//********</span></p>        <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Transform3D</span><span style="line-height: 140%"> oNewOverrideTrans1 = </span><span style="line-height: 140%; color: #2b91af">Transform3D</span><span style="line-height: 140%">.CreateTranslation(oNewVector3d);</span></p>        <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">//*********</span></p>        <p style="margin: 0px">&#160;</p>        <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">//override the transformation of the selection</span></p>        <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; doc.Models.OverridePermanentTransform(coll, oNewOverrideTrans1, </span><span style="line-height: 140%; color: blue">true</span><span style="line-height: 140%">);&#160;&#160; </span></p>        <p style="margin: 0px">&#160;</p>        <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> 0;</span></p>        <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; }</span></p>     </div>   </p> </div>
