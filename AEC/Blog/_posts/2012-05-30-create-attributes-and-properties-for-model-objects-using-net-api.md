---
layout: "post"
title: "Create Attributes and properties for model objects using .NET API"
date: "2012-05-30 00:54:20"
author: "Xiaodong Liang"
categories:
  - ".NET"
  - "Navisworks"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/aec/2012/05/create-attributes-and-properties-for-model-objects-using-net-api.html "
typepad_basename: "create-attributes-and-properties-for-model-objects-using-net-api"
typepad_status: "Publish"
---

<div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p>By <a href="http://adndevblog.typepad.com/aec/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>    <p>The current .NET API does not provide the related objects. But you can take advantage of COM API by COM interop. The chapter 10 of <navisworks  2011 Manage>\api\net\documentation\ NET Developers Guide.pdf to know more about COM interop. The following code snippet is based on the sample <navisworks  2011 Manage>\api\net\examples\PlugIns\APICallsCOMPlugin. </p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> addProperty()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">{</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; ComApi.</span><span style="line-height: 140%; color: #2b91af">InwOpState10</span><span style="line-height: 140%"> state;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; state = ComApiBridge.</span><span style="line-height: 140%; color: #2b91af">ComApiBridge</span><span style="line-height: 140%">.State;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// get current selection</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">ModelItemCollection</span><span style="line-height: 140%"> modelItemCollectionIn = </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">ModelItemCollection</span><span style="line-height: 140%">(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Autodesk.Navisworks.Api.</span><span style="line-height: 140%; color: #2b91af">Application</span><span style="line-height: 140%">.ActiveDocument.</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; CurrentSelection.SelectedItems);</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// get the selection in COM</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; ComApi.</span><span style="line-height: 140%; color: #2b91af">InwOpSelection</span><span style="line-height: 140%"> comSelectionOut =</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; ComApiBridge.</span><span style="line-height: 140%; color: #2b91af">ComApiBridge</span><span style="line-height: 140%">.ToInwOpSelection(modelItemCollectionIn);</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// get paths within the selection</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; ComApi.</span><span style="line-height: 140%; color: #2b91af">InwSelectionPathsColl</span><span style="line-height: 140%"> oPaths = comSelectionOut.Paths();</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; ComApi.</span><span style="line-height: 140%; color: #2b91af">InwOaPath3</span><span style="line-height: 140%"> oPath = (ComApi.</span><span style="line-height: 140%; color: #2b91af">InwOaPath3</span><span style="line-height: 140%">)oPaths.Last();</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// get properties collection of the path</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; ComApi.</span><span style="line-height: 140%; color: #2b91af">InwGUIPropertyNode2</span><span style="line-height: 140%"> propn = </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (ComApi.</span><span style="line-height: 140%; color: #2b91af">InwGUIPropertyNode2</span><span style="line-height: 140%">)state.GetGUIPropertyNode(oPath, </span><span style="line-height: 140%; color: blue">true</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// create new property category </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// (new tab in the properties dialog)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; ComApi.</span><span style="line-height: 140%; color: #2b91af">InwOaPropertyVec</span><span style="line-height: 140%"> newPvec = </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (ComApi.</span><span style="line-height: 140%; color: #2b91af">InwOaPropertyVec</span><span style="line-height: 140%">)state.ObjectFactory(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; ComApi.</span><span style="line-height: 140%; color: #2b91af">nwEObjectType</span><span style="line-height: 140%">.eObjectType_nwOaPropertyVec, </span><span style="line-height: 140%; color: blue">null</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: blue">null</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// create new property</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; ComApi.</span><span style="line-height: 140%; color: #2b91af">InwOaProperty</span><span style="line-height: 140%"> newP = </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; (ComApi.</span><span style="line-height: 140%; color: #2b91af">InwOaProperty</span><span style="line-height: 140%">)state.ObjectFactory(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; ComApi.</span><span style="line-height: 140%; color: #2b91af">nwEObjectType</span><span style="line-height: 140%">.eObjectType_nwOaProperty, </span><span style="line-height: 140%; color: blue">null</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: blue">null</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// set the name, username and value of the new property</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; newP.name = </span><span style="line-height: 140%; color: #a31515">&quot;demo_Property_Name&quot;</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; newP.UserName = </span><span style="line-height: 140%; color: #a31515">&quot;demo_Property_UserName&quot;</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; newP.value = </span><span style="line-height: 140%; color: #a31515">&quot;demo_Property_Value&quot;</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// add the new property to the new property category</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; newPvec.Properties().Add(newP);</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// add the new property category to the path</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; propn.SetUserDefined(0, </span><span style="line-height: 140%; color: #a31515">&quot;demo_PropertyTab_Name&quot;</span><span style="line-height: 140%">, </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;demo_PropertyTab_InteralName&quot;</span><span style="line-height: 140%">, newPvec);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">} </span></p> </div>
