---
layout: "post"
title: "Another year wiser&hellip;I hope! Revit API: Check for WorkSharing environment, Get type parameters from a system family"
date: "2015-09-17 13:07:57"
author: "Jaime Rosales"
categories:
  - ".NET"
  - "Jaime Rosales"
  - "Off-topic"
  - "Revit"
  - "Revit Architecture"
  - "Revit MEP"
  - "Revit Structure"
original_url: "https://adndevblog.typepad.com/aec/2015/09/another-year-wiseri-hope-revit-api-check-for-worksharing-environment-get-type-parameters-from-a-system-family.html "
typepad_basename: "another-year-wiseri-hope-revit-api-check-for-worksharing-environment-get-type-parameters-from-a-system-family"
typepad_status: "Publish"
---

<p><a href="http://adndevblog.typepad.com/aec/jaime-rosales.html">By Jaime Rosales</a> (@<a href="https://twitter.com/AfroJme">afrojme</a>)</p>  <p>It is a special day for me today, since it is my Birthday (number will remain unknown) Let’s just say is my 21st part… (unknown). I’m not sharing this with all of you to wish me “Happy Birthday” or get extra attention, I just like to reflect on what the year that passed has left me and I take it as a moment of reflection on my failures, accomplishments and my needs and wants to learn from life and from topics that interest me such as technology. </p>  <p>Sharing a little quote with all of you today and then back to Revit API.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01bb0873f77f970d-pi"><img title="bday quote" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="bday quote" src="/assets/image_25037.jpg" width="332" height="356" /></a><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01bb0873f786970d-pi"><img title="bday pic" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="bday pic" src="/assets/image_255057.jpg" width="340" height="340" /></a></p>  <p>I want to share a couple of interesting questions that came up this past week in our Revit API forum community, if you haven’t seen it before, it is one of the greatest resources to solve your questions or simply chat with the community about the API. Here is the <a href="http://forums.autodesk.com/t5/revit-api/bd-p/160">link</a>.</p>  <p>The first question is from Mendo123 asking the community about how to quickly check if the user is working in a WorkSharing Environment. I know a lot of you probably already know how, but is it always to have this information handy for when we need it and also for our new Revit API developers. </p>  <p>Here is the question.</p>  <p><strong>Question:</strong> <em>Sorry if this has been asked but what is the easiest way of determining if the user is working in a WorkSharing environment?</em></p>  <p><em>Originally I was comparing the username against the doc.title but proved to be a very rushed and messy Idea.</em></p>  <p>The answer came by one of our legacy contributors to the Forum, Mr. Revitalizer. where he suggested the use of the bool check on the Document.</p>  <p><strong>Answer:<em> </em></strong><em>Document.IsWorkshared will do the trick. </em></p>  <p>Here is what the description on the RevitAPI.CHM file says on the property suggested.</p>  <p>Identifies if worksharing (i.e. editing permissions and multiple worksets) have been enabled in the document. Also, see IsDetached, which will check if the workshared Document has been detached. </p>  <p>Thanks Revitalizer for the quick and nice tip. </p>  <p>Next, the second question is about how to get parameters from a system Family eg. Keynote, asked by Anders.</p>  <p><strong>Question:</strong><em>Hope some one can help me to get type parameters from a system family. I can get the instants like Area &amp; Volume, but not eg. Keynote</em></p>  <p><em>With component families do I use eg Door.Symbol.get_Parameter(BuiltInParameter.KEYNOTE_PARAM); But I can't get it to work with system families like floors. </em><em>Where do I fail ?? :-)</em></p>  <blockquote>   <p style="font-family: ; white-space: normal; word-spacing: 0px; text-transform: none; color: ; padding-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; widows: 1; letter-spacing: normal; line-height: 15px; padding-right: 0px; background-color: rgb(255,255,255); text-indent: 0px; -webkit-text-stroke-width: 0px" align="left"><font style="line-height: normal" color="#2b91af" size="2" face="Consolas">FilteredElementCollector</font><font style="line-height: normal" size="2" face="Consolas"><font color="#000000"><span class="Apple-converted-space">&#160;</span>FMFloorCollector =<span class="Apple-converted-space">&#160;</span></font></font><font style="line-height: normal" color="#0000ff" size="2" face="Consolas">new</font><span class="Apple-converted-space"><font face="Times New Roman"><font style="font-size: 10.5pt" color="#000000">&#160;</font></font></span><font style="line-height: normal" color="#2b91af" size="2" face="Consolas">FilteredElementCollector</font><font style="line-height: normal" color="#000000" size="2" face="Consolas">(OpenDoc);</font></p>    <p style="font-family: ; white-space: normal; word-spacing: 0px; text-transform: none; color: ; padding-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; widows: 1; letter-spacing: normal; line-height: 15px; padding-right: 0px; background-color: rgb(255,255,255); text-indent: 0px; -webkit-text-stroke-width: 0px" align="left"><font style="line-height: normal" size="2" face="Consolas"><font style="line-height: normal" color="#000000" size="2" face="Consolas">FMFloorCollector.OfClass(</font></font><font style="line-height: normal" color="#0000ff" size="2" face="Consolas"><font style="line-height: normal" color="#0000ff" size="2" face="Consolas"><font style="line-height: normal" color="#0000ff" size="2" face="Consolas">typeof</font></font></font><font style="line-height: normal" size="2" face="Consolas"><font style="line-height: normal" color="#000000" size="2" face="Consolas">(</font></font><font style="line-height: normal" color="#2b91af" size="2" face="Consolas"><font style="line-height: normal" color="#2b91af" size="2" face="Consolas"><font style="line-height: normal" color="#2b91af" size="2" face="Consolas">Floor</font></font></font><font style="line-height: normal" size="2" face="Consolas"><font style="line-height: normal" color="#000000" size="2" face="Consolas">));</font></font></p>    <p style="font-family: ; white-space: normal; word-spacing: 0px; text-transform: none; color: ; padding-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; widows: 1; letter-spacing: normal; line-height: 15px; padding-right: 0px; background-color: rgb(255,255,255); text-indent: 0px; -webkit-text-stroke-width: 0px" align="left"><font style="line-height: normal" color="#0000ff" size="2" face="Consolas"><font style="line-height: normal" color="#0000ff" size="2" face="Consolas"><font style="line-height: normal" color="#0000ff" size="2" face="Consolas">foreach</font></font></font><font style="line-height: normal" size="2" face="Consolas"><font style="line-height: normal" size="2" face="Consolas"><font color="#000000"><span class="Apple-converted-space">&#160;</span>(</font></font></font><font style="line-height: normal" color="#2b91af" size="2" face="Consolas"><font style="line-height: normal" color="#2b91af" size="2" face="Consolas"><font style="line-height: normal" color="#2b91af" size="2" face="Consolas">Floor</font></font></font><font style="line-height: normal" size="2" face="Consolas"><font style="line-height: normal" size="2" face="Consolas"><font color="#000000"><span class="Apple-converted-space">&#160;</span>FMFloor<span class="Apple-converted-space">&#160;</span></font></font></font><font style="line-height: normal" color="#0000ff" size="2" face="Consolas"><font style="line-height: normal" color="#0000ff" size="2" face="Consolas"><font style="line-height: normal" color="#0000ff" size="2" face="Consolas">in</font></font></font><font style="line-height: normal" size="2" face="Consolas"><font style="line-height: normal" size="2" face="Consolas"><font color="#000000"><span class="Apple-converted-space">&#160;</span>FMFloorCollector)</font></font></font></p>    <p style="font-family: ; white-space: normal; word-spacing: 0px; text-transform: none; color: ; padding-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; widows: 1; letter-spacing: normal; line-height: 15px; padding-right: 0px; background-color: rgb(255,255,255); text-indent: 0px; -webkit-text-stroke-width: 0px" align="left"><font face="Times New Roman"><font style="font-size: 10.5pt" color="#000000">{</font></font></p>    <p style="font-family: ; white-space: normal; word-spacing: 0px; text-transform: none; color: ; padding-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; widows: 1; letter-spacing: normal; line-height: 15px; padding-right: 0px; background-color: rgb(255,255,255); text-indent: 0px; -webkit-text-stroke-width: 0px" align="left"><font style="line-height: normal" size="2" face="Consolas"><font style="line-height: normal" color="#000000" size="2" face="Consolas">Floor_Keynote = FMFloor.get_Parameter(</font></font><font style="line-height: normal" color="#2b91af" size="2" face="Consolas"><font style="line-height: normal" color="#2b91af" size="2" face="Consolas"><font style="line-height: normal" color="#2b91af" size="2" face="Consolas">BuiltInParameter</font></font></font><font style="line-height: normal" size="2" face="Consolas"><font style="line-height: normal" color="#000000" size="2" face="Consolas">.KEYNOTE_PARAM);</font></font></p>    <p style="font-family: ; white-space: normal; word-spacing: 0px; text-transform: none; color: ; padding-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; widows: 1; letter-spacing: normal; line-height: 15px; padding-right: 0px; background-color: rgb(255,255,255); text-indent: 0px; -webkit-text-stroke-width: 0px" align="left"><font style="line-height: normal" size="2" face="Consolas"><font style="line-height: normal" color="#000000" size="2" face="Consolas">Floor_Family = FMFloor.get_Parameter(</font></font><font style="line-height: normal" color="#2b91af" size="2" face="Consolas"><font style="line-height: normal" color="#2b91af" size="2" face="Consolas"><font style="line-height: normal" color="#2b91af" size="2" face="Consolas">BuiltInParameter</font></font></font><font style="line-height: normal" size="2" face="Consolas"><font style="line-height: normal" color="#000000" size="2" face="Consolas">.ALL_MODEL_FAMILY_NAME);</font></font></p>    <p style="font-family: ; white-space: normal; word-spacing: 0px; text-transform: none; color: ; padding-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; widows: 1; letter-spacing: normal; line-height: 15px; padding-right: 0px; background-color: rgb(255,255,255); text-indent: 0px; -webkit-text-stroke-width: 0px" align="left"><font style="line-height: normal" size="2" face="Consolas"><font style="line-height: normal" color="#000000" size="2" face="Consolas">Floor_Mark = FMFloor.get_Parameter(</font></font><font style="line-height: normal" color="#2b91af" size="2" face="Consolas"><font style="line-height: normal" color="#2b91af" size="2" face="Consolas"><font style="line-height: normal" color="#2b91af" size="2" face="Consolas">BuiltInParameter</font></font></font><font style="line-height: normal" size="2" face="Consolas"><font style="line-height: normal" color="#000000" size="2" face="Consolas">.ALL_MODEL_MARK);</font></font></p>    <p style="font-family: ; white-space: normal; word-spacing: 0px; text-transform: none; color: ; padding-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; widows: 1; letter-spacing: normal; line-height: 15px; padding-right: 0px; background-color: rgb(255,255,255); text-indent: 0px; -webkit-text-stroke-width: 0px" align="left"><font style="line-height: normal" size="2" face="Consolas"><font style="line-height: normal" color="#000000" size="2" face="Consolas">Floor_Type = FMFloor.get_Parameter(</font></font><font style="line-height: normal" color="#2b91af" size="2" face="Consolas"><font style="line-height: normal" color="#2b91af" size="2" face="Consolas"><font style="line-height: normal" color="#2b91af" size="2" face="Consolas">BuiltInParameter</font></font></font><font style="line-height: normal" size="2" face="Consolas"><font style="line-height: normal" color="#000000" size="2" face="Consolas">.ALL_MODEL_TYPE_NAME);</font></font></p>    <p style="font-family: ; white-space: normal; word-spacing: 0px; text-transform: none; color: ; padding-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; widows: 1; letter-spacing: normal; line-height: 15px; padding-right: 0px; background-color: rgb(255,255,255); text-indent: 0px; -webkit-text-stroke-width: 0px" align="left"><font style="line-height: normal" size="2" face="Consolas"><font style="line-height: normal" color="#000000" size="2" face="Consolas">Floor_Description = FMFloor.get_Parameter(</font></font><font style="line-height: normal" color="#2b91af" size="2" face="Consolas"><font style="line-height: normal" color="#2b91af" size="2" face="Consolas"><font style="line-height: normal" color="#2b91af" size="2" face="Consolas">BuiltInParameter</font></font></font><font style="line-height: normal" size="2" face="Consolas"><font style="line-height: normal" color="#000000" size="2" face="Consolas">.ALL_MODEL_DESCRIPTION);</font></font></p>    <p style="font-family: ; white-space: normal; word-spacing: 0px; text-transform: none; color: ; padding-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; widows: 1; letter-spacing: normal; line-height: 15px; padding-right: 0px; background-color: rgb(255,255,255); text-indent: 0px; -webkit-text-stroke-width: 0px" align="left"><font style="line-height: normal" size="2" face="Consolas"><font style="line-height: normal" color="#000000" size="2" face="Consolas">Floor_Area = FMFloor.get_Parameter(</font></font><font style="line-height: normal" color="#2b91af" size="2" face="Consolas"><font style="line-height: normal" color="#2b91af" size="2" face="Consolas"><font style="line-height: normal" color="#2b91af" size="2" face="Consolas">BuiltInParameter</font></font></font><font style="line-height: normal" size="2" face="Consolas"><font style="line-height: normal" color="#000000" size="2" face="Consolas">.HOST_AREA_COMPUTED);</font></font></p>    <p style="font-family: ; white-space: normal; word-spacing: 0px; text-transform: none; color: ; padding-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; widows: 1; letter-spacing: normal; line-height: 15px; padding-right: 0px; background-color: rgb(255,255,255); text-indent: 0px; -webkit-text-stroke-width: 0px" align="left"><font style="line-height: normal" size="2" face="Consolas"><font style="line-height: normal" color="#000000" size="2" face="Consolas">Floor_Volume = FMFloor.get_Parameter(</font></font><font style="line-height: normal" color="#2b91af" size="2" face="Consolas"><font style="line-height: normal" color="#2b91af" size="2" face="Consolas"><font style="line-height: normal" color="#2b91af" size="2" face="Consolas">BuiltInParameter</font></font></font><font style="line-height: normal" size="2" face="Consolas"><font style="line-height: normal" color="#000000" size="2" face="Consolas">.HOST_VOLUME_COMPUTED);</font></font></p>    <p style="font-family: ; white-space: normal; word-spacing: 0px; text-transform: none; color: ; padding-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; widows: 1; letter-spacing: normal; line-height: 15px; padding-right: 0px; background-color: rgb(255,255,255); text-indent: 0px; -webkit-text-stroke-width: 0px" align="left"><font style="line-height: normal" size="2" face="Consolas"><font style="line-height: normal" color="#000000" size="2" face="Consolas">}</font></font></p> </blockquote>  <p style="font-family: ; white-space: normal; word-spacing: 0px; text-transform: none; color: ; padding-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; widows: 1; letter-spacing: normal; line-height: 15px; padding-right: 0px; background-color: rgb(255,255,255); text-indent: 0px; -webkit-text-stroke-width: 0px" align="left">There were quite a few posts in response to the question, but one was selected as the accepted solution at the end. For those of you curious about it here is the <a href="http://forums.autodesk.com/t5/revit-api/type-parametres-from-systemfamilies/td-p/5807035">link</a> </p>  <p style="font-family: ; white-space: normal; word-spacing: 0px; text-transform: none; color: ; padding-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; widows: 1; letter-spacing: normal; line-height: 15px; padding-right: 0px; background-color: rgb(255,255,255); text-indent: 0px; -webkit-text-stroke-width: 0px" align="left">to the complete question. Here is also the answer by peterjegan.</p>  <p style="font-family: ; white-space: normal; word-spacing: 0px; text-transform: none; color: ; padding-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; widows: 1; letter-spacing: normal; line-height: 15px; padding-right: 0px; background-color: rgb(255,255,255); text-indent: 0px; -webkit-text-stroke-width: 0px" align="left">&#160;</p>  <p><strong>Answer: </strong><em>Anders, It looks like you are trying to get information from instances of a floor. You are not having trouble with instance-based parameters, but you can't get type-based parameters. I would suggest that you find each instance, get the instance-based information, then find the type and get the type-based information. </em><em>I would suggest this:</em></p>  <pre style="word-wrap: normal; border-top: rgb(218,218,218) 1px dotted; border-right: rgb(218,218,218) 1px dotted; white-space: pre; word-spacing: 0px; overflow-x: auto; border-bottom: rgb(218,218,218) 1px dotted; text-transform: none; word-break: normal; color: ; padding-bottom: 0px; text-align: left; padding-top: 0px; padding-left: 0px; margin: 0px 10px 10px; border-left: rgb(218,218,218) 1px dotted; widows: 1; letter-spacing: normal; line-height: 15px; padding-right: 0px; background-color: rgb(247,247,247); text-indent: 0px; -webkit-text-stroke-width: 0px"><font face="Courier New"><font style="font-size: 10.5pt" color="#000000">foreach (Floor FMFloor in FMFloorCollector)
{
	//instance params
	Parameter Floor_Family = FMFloor.get_Parameter(BuiltInParameter.ALL_MODEL_F<wbr>AMILY_NAME);
	Parameter Floor_Mark = FMFloor.get_Parameter(BuiltInParameter.ALL_MODEL_M<wbr>ARK);
	Parameter Floor_Type = FMFloor.get_Parameter(BuiltInParameter.ALL_MODEL_T<wbr>YPE_NAME);
	Parameter Floor_Area = FMFloor.get_Parameter(BuiltInParameter.HOST_AREA_C<wbr>OMPUTED);
	Parameter Floor_Volume = FMFloor.get_Parameter(BuiltInParameter.HOST_VOLUME<wbr>_COMPUTED);

	Element el = FMFloor as Element;
	ElementId typeid = el.GetTypeId();
	Element floortype = OpenDoc.GetElement(typeid);

	//type params
	Parameter Floor_Keynote = floortype.get_Parameter(BuiltInParameter.KEYNOTE_P<wbr>ARAM);
	Parameter Floor_Description = floortype.get_Parameter(BuiltInParameter.ALL_MODEL<wbr>_DESCRIPTION);
}</font></font></pre>

<p><em>Note that get_Parameter(string) is obsolete, but get_Parameter(BuiltInParameter) still works.</em></p>

<p>Thank you to our community of developers in the Revit API forum for the continuous collaboration on day to day questions with the use of the API.</p>

<p>Cheers, and until next time. </p>
