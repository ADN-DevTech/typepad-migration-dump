---
layout: "post"
title: "Create hyperlinks for model objects using .NET API"
date: "2012-05-30 01:09:03"
author: "Xiaodong Liang"
categories:
  - ".NET"
  - "Navisworks"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/aec/2012/05/create-hyperlinks-for-model-objects-using-net-api.html "
typepad_basename: "create-hyperlinks-for-model-objects-using-net-api"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/aec/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>  <p>The current .NET API does not provide the related abilities. But you can take advantage of COM API by COM interop. The chapter 10 of \api\net\documentation\ NET Developers Guide.pdf to know more about COM interop. The following code snippet is based on the SDK sample \api\net\examples\PlugIns\APICallsCOMPlugin.</p>  <p>The object InwURL2 could be a ‘hyperlink’ or a ‘label’. Both of them link to a file or hyperlink. </p>  <p>&#0160;</p>  <p><strong>hyperlink</strong>:</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017c37059542970b-pi"><img alt="image" border="0" height="238" src="/assets/image_931017.jpg" style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" width="246" /></a> </p>  <p>&#0160;</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017ee8a8c74d970d-pi"><img alt="image" border="0" height="204" src="/assets/image_701706.jpg" style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" width="241" /></a> </p>  <p>&#0160;</p>  <p><strong>Label</strong>:</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017ee8a8c75c970d-pi"><img alt="image" border="0" height="202" src="/assets/image_956092.jpg" style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" width="238" /></a> </p>  <p>&#0160;</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017d4134e66c970c-pi"><img alt="image" border="0" height="210" src="/assets/image_56203.jpg" style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" width="245" /></a> </p>  <p>&#0160;</p>  <div style="font-family: courier new; background: white; color: black; font-size: 9pt">   <p style="margin: 0px">They are categorized to ‘label’ and ‘hyperlink’ separately. By API, we could know the corresponding category. In default, the InwURL2 is created as a label. So to set a URL as a hyperlink, we could use InwURL2.SetCategory. </p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">ComApi.</span><span style="line-height: 140%; color: #2b91af">InwGlobalProperties</span><span style="line-height: 140%"> oGlobalP = state.GlobalProperties();</span></p>    <p style="margin: 0px"><span style="line-height: 140%">ComApi.</span><span style="line-height: 140%; color: #2b91af">InwURLCategoriesColl</span><span style="line-height: 140%"> oURLCategories = oGlobalP.URLsCategories();</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">foreach</span><span style="line-height: 140%"> (ComApi.</span><span style="line-height: 140%; color: #2b91af">InwURLCategory</span><span style="line-height: 140%"> oURLCas </span><span style="line-height: 140%; color: blue">in</span><span style="line-height: 140%"> oURLCategories)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">{</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160; System.Diagnostics.</span><span style="line-height: 140%; color: #2b91af">Debug</span><span style="line-height: 140%">.Write(oURLCas.InternalName + </span><span style="line-height: 140%; color: #a31515">&quot;-&quot;</span><span style="line-height: 140%"> + oURLCas.UserName);</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">}</span></p>    <p style="margin: 0px"><span style="line-height: 140%"></span></p> </div> In default, the InwURL2 is created as a label. to set a URL as a hyperlink, we could use InwURL2.SetCategory.   <div style="font-family: courier new; background: white; color: black; font-size: 9pt">   <p style="margin: 0px"><span style="line-height: 140%; color: blue"></span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">private</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> AddURL()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">{</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160; ComApi.</span><span style="line-height: 140%; color: #2b91af">InwOpState10</span><span style="line-height: 140%"> state;</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160; state = ComApiBridge.</span><span style="line-height: 140%; color: #2b91af">ComApiBridge</span><span style="line-height: 140%">.State;</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">// create the hyperlink collection</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160; ComApi.</span><span style="line-height: 140%; color: #2b91af">InwURLOverride</span><span style="line-height: 140%"> oMyURLOoverride =</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (ComApi.</span><span style="line-height: 140%; color: #2b91af">InwURLOverride</span><span style="line-height: 140%">)state.ObjectFactory(</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ComApi.</span><span style="line-height: 140%; color: #2b91af">nwEObjectType</span><span style="line-height: 140%">.eObjectType_nwURLOverride, </span><span style="line-height: 140%; color: blue">null</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: blue">null</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">// some locations to add the hyperlink </span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">double</span><span style="line-height: 140%">[] coordinate = { 10, 10, 0, 20, 20, 0, 30, 30, 0 };</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">for</span><span style="line-height: 140%"> (</span><span style="line-height: 140%; color: blue">int</span><span style="line-height: 140%"> i = 0; i &lt; 9; i += 3)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160; {</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">// create one hyperlink</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ComApi.</span><span style="line-height: 140%; color: #2b91af">InwURL2</span><span style="line-height: 140%"> oMyURL =</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (ComApi.</span><span style="line-height: 140%; color: #2b91af">InwURL2</span><span style="line-height: 140%">)state.ObjectFactory(</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ComApi.</span><span style="line-height: 140%; color: #2b91af">nwEObjectType</span><span style="line-height: 140%">.eObjectType_nwURL, </span><span style="line-height: 140%; color: blue">null</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: blue">null</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">// name of the hyperlink</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oMyURL.name = </span><span style="line-height: 140%; color: #a31515">&quot;MyURL&quot;</span><span style="line-height: 140%"> + i;</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">// site of the hyperlink</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oMyURL.URL = </span><span style="line-height: 140%; color: #a31515">&quot;http://www.google.com&quot;</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">if</span><span style="line-height: 140%"> (i == 0)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">// create Hyperlink</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oMyURL.SetCategory(</span><span style="line-height: 140%; color: #a31515">&quot;Hyperlink&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;LcOaURLCategoryHyperlink&quot;</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">else</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">// create label</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oMyURL.SetCategory(</span><span style="line-height: 140%; color: #a31515">&quot;Label&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;LcOaURLCategoryTag&quot;</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">// Attachment Point of the hyperlink</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ComApi.</span><span style="line-height: 140%; color: #2b91af">InwLPos3f</span><span style="line-height: 140%"> oNewP =</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (ComApi.</span><span style="line-height: 140%; color: #2b91af">InwLPos3f</span><span style="line-height: 140%">)state.ObjectFactory(</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ComApi.</span><span style="line-height: 140%; color: #2b91af">nwEObjectType</span><span style="line-height: 140%">.eObjectType_nwLPos3f, </span><span style="line-height: 140%; color: blue">null</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: blue">null</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oNewP.data1 = coordinate[i];</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oNewP.data2 = coordinate[i + 1];</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oNewP.data3 = coordinate[i + 2];</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">// add the AttachmentPoint to </span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">// AttachmentPoints collection</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oMyURL.AttachmentPoints().Add(oNewP);</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">// add the new hyperlink to the hyperlink collection</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ComApi.</span><span style="line-height: 140%; color: #2b91af">InwURLColl</span><span style="line-height: 140%"> oURLColl = oMyURLOoverride.URLs();</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oURLColl.Add(oMyURL);</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">// get current selected items</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af">ModelItemCollection</span><span style="line-height: 140%"> modelItemCollectionIn =</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">ModelItemCollection</span><span style="line-height: 140%">(</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Autodesk.Navisworks.Api.</span><span style="line-height: 140%; color: #2b91af">Application</span><span style="line-height: 140%">.ActiveDocument.</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; CurrentSelection.SelectedItems);</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">//convert to InwOpSelection of COM API</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ComApi.</span><span style="line-height: 140%; color: #2b91af">InwOpSelection</span><span style="line-height: 140%"> comSelectionOut =</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ComApiBridge.</span><span style="line-height: 140%; color: #2b91af">ComApiBridge</span><span style="line-height: 140%">.ToInwOpSelection(modelItemCollectionIn);</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">// set the hyplerlink of the model items</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; state.SetOverrideURL(comSelectionOut, oMyURLOoverride);</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green">// enable to the hyperlinks visible</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; state.URLsEnabled = </span><span style="line-height: 140%; color: blue">true</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#0160;&#0160;&#0160; }</span></p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px"><span style="line-height: 140%">}</span></p> </div>
