---
layout: "post"
title: "Changing the color of annotation"
date: "2012-07-31 03:26:20"
author: "Joe Ye"
categories:
  - ".NET"
  - "Joe Ye"
  - "Revit"
original_url: "https://adndevblog.typepad.com/aec/2012/07/changing-the-color-of-annotation.html "
typepad_basename: "changing-the-color-of-annotation"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/aec/joe-ye.html">Joe Ye</a></p>  <p><b>Issue</b></p>  <p>How can I change the color of an annotation symbol&#160; through Revit API?</p>  <p><b></b></p>  <p><b>Solution</b></p>  <p>View.ProjColorOverrideByElement can be used to change a set of individual elements' color in the caller view.Here is the code fragment to change selected annotation in active view.</p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">UIApplication</span><span style="line-height: 140%"> uiApp = commandData.Application;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Application</span><span style="line-height: 140%"> app = uiApp.Application;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Document</span><span style="line-height: 140%"> doc = uiApp.ActiveUIDocument.Document;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Color</span><span style="line-height: 140%"> color = app.Create.NewColor();</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; color.Blue = (</span><span style="line-height: 140%; color: blue">byte</span><span style="line-height: 140%">)150;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; color.Red = (</span><span style="line-height: 140%; color: blue">byte</span><span style="line-height: 140%">)200;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; color.Green = (</span><span style="line-height: 140%; color: blue">byte</span><span style="line-height: 140%">)200;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; Selection sel = uiApp.ActiveUIDocument.Selection;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Reference</span><span style="line-height: 140%"> ref1 = sel.PickObject(ObjectType.Element, </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;Pick an Annotation&quot;</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Element</span><span style="line-height: 140%"> elem = ref1.Element;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; List&lt;</span><span style="line-height: 140%; color: #2b91af">ElementId</span><span style="line-height: 140%">&gt; ids = </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> List&lt;</span><span style="line-height: 140%; color: #2b91af">ElementId</span><span style="line-height: 140%">&gt;();</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; ids.Add(elem.Id);</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Transaction</span><span style="line-height: 140%"> trans = </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Transaction</span><span style="line-height: 140%">(doc);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; trans.Start(</span><span style="line-height: 140%; color: #a31515">&quot;ChangeColor&quot;</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; doc.ActiveView.set_ProjColorOverrideByElement(ids, color);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; trans.Commit();</span></p> </div>
