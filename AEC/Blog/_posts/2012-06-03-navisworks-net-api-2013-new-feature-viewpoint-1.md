---
layout: "post"
title: "Navisworks .NET API 2013 new feature &ndash; Viewpoint 1"
date: "2012-06-03 00:49:30"
author: "Xiaodong Liang"
categories:
  - ".NET"
  - "Navisworks"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/aec/2012/06/navisworks-net-api-2013-new-feature-viewpoint-1.html "
typepad_basename: "navisworks-net-api-2013-new-feature-viewpoint-1"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/aec/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>  <p>ViewPoint is how eyes look at the model. In the past, we need to use COM API to access viewpoint and camera. 2013 .NET API provides the relevant object <strong>Viewpoint</strong>. </p>  <p>Viewpoint represents the anonymous viewpoint, containing the properties such as near plane distance, far plane distance, linear speed, angular speed etc. It also includes the abilities to manipulate the camera directly. The current viewpoint is accessed by <strong>DocumentCurrentViewpoint</strong>. </p>  <p>One particular property of Viewpoint is Rotation, which is an object <strong>Roation3D</strong>. It defines a <a href="http://en.wikipedia.org/wiki/Quaternion">quaternion</a> to configure the behaviors of the camera. </p>  <p>Note: in current release, API does not provide the property of view direction and the method to multiply two quaternion. While they can be achieved with the theory of quaternion, using Roation3D. The following code snippet dumps the properties of current view point. It also demos how to get view direction. A help method MultiplyRotation3D is to multiply quaternion.&#160; </p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="color: blue">using</span> System.Diagnostics; <span style="color: green">&#160;</span></p>    <p style="margin: 0px"><span style="color: blue">using</span> Autodesk.Navisworks.Api;</p>    <p style="margin: 0px"><span style="color: blue">using</span> Autodesk.Navisworks.Api.Plugins;</p>    <p style="margin: 0px">&#160;</p> </div>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="color: blue">private</span> <span style="color: blue">void</span> dumpViewPoint()</p>    <p style="margin: 0px">{</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #2b91af">Document</span> oDoc = </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; Autodesk.Navisworks.Api.<span style="color: #2b91af">Application</span>.ActiveDocument;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">// get current viewpoint </span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #2b91af">Viewpoint</span> oCurVP = oDoc.CurrentViewpoint;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">// common properties</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #2b91af">Debug</span>.Print(<span style="color: #a31515">&quot;Far Plane Distance: &quot;</span> + </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oCurVP.FarPlaneDistance);</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #2b91af">Debug</span>.Print(<span style="color: #a31515">&quot;Near Plane Distance: &quot;</span> + </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oCurVP.NearPlaneDistance);</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #2b91af">Debug</span>.Print(<span style="color: #a31515">&quot;Projection: &quot;</span> + </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oCurVP.Projection);</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #2b91af">Debug</span>.Print(<span style="color: #a31515">&quot;Aspect Ratio: &quot;</span> + </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oCurVP.AspectRatio);</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">if</span> (oCurVP.HasLinearSpeed)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">Debug</span>.Print(<span style="color: #a31515">&quot;Linear Speed: &quot;</span> + </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oCurVP.LinearSpeed);</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">else</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">Debug</span>.Print(<span style="color: #a31515">&quot;Linear Speed: &lt;None&gt;&quot;</span>);</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">if</span> (oCurVP.HasAngularSpeed)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">Debug</span>.Print(<span style="color: #a31515">&quot;Angular Speed: &quot;</span> + </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oCurVP.AngularSpeed);</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">else</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">Debug</span>.Print(<span style="color: #a31515">&quot;Angular Speed: &lt;None&gt;&quot;</span>);</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">if</span> (oCurVP.HasLighting)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">Debug</span>.Print(<span style="color: #a31515">&quot;Lighting: &quot;</span> +</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oCurVP.Lighting);</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">else</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">Debug</span>.Print(<span style="color: #a31515">&quot;Lighting: &lt;None&gt;&quot;</span>);</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">if</span> (oCurVP.HasRenderStyle)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">Debug</span>.Print(<span style="color: #a31515">&quot;RenderStyle: &quot;</span> + </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oCurVP.RenderStyle);</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">else</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">Debug</span>.Print(<span style="color: #a31515">&quot;RenderStyle:&lt;None&gt; &quot;</span> + </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oCurVP.RenderStyle);</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">if</span> (oCurVP.HasTool)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">Debug</span>.Print(<span style="color: #a31515">&quot;Tool: &quot;</span> + </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oCurVP.Tool);</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">else</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">Debug</span>.Print(<span style="color: #a31515">&quot;Tool:&lt;None&gt; &quot;</span> + </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oCurVP.Tool);</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">// camera properties</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">double</span> oFocal = </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oCurVP.FocalDistance;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #2b91af">Debug</span>.Print(<span style="color: #a31515">&quot;Focal Distance: &quot;</span> +</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oFocal);</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">// Rotation</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #2b91af">Rotation3D</span> oRot = oCurVP.Rotation;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #2b91af">Debug</span>.Print(</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #a31515">&quot;Quaternion: &lt;A (x),B(y),C(z),D(w)&gt; = &lt;{0},{1},{2}, </span></p>    <p style="margin: 0px"><span style="color: #a31515">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {3}&gt;&quot;</span>,</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oRot.A,</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oRot.B,</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oRot.C,</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oRot.D);</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">// calculate view direction</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #2b91af">Rotation3D</span> oNegtiveZ = </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">new</span> <span style="color: #2b91af">Rotation3D</span>(0, 0, -1, 0);</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #2b91af">Rotation3D</span> otempRot = </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; MultiplyRotation3D(oNegtiveZ, oRot.Invert());</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #2b91af">Rotation3D</span> oViewDirRot =</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; MultiplyRotation3D(oRot, otempRot);</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">// get view direction</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #2b91af">Vector3D</span> oViewDir = </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">new</span> <span style="color: #2b91af">Vector3D</span>(oViewDirRot.A,</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oViewDirRot.B,</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oViewDirRot.C);</p>    <p style="margin: 0px">&#160;&#160;&#160; oViewDir.Normalize();</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #2b91af">Debug</span>.Print(<span style="color: #a31515">&quot;View Direction:&lt;{0},{1},{2}&gt; &quot;</span>, </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oViewDir.X,</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oViewDir.Y,</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oViewDir.Z);</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">// position</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #2b91af">Point3D</span> oPos = oCurVP.Position;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #2b91af">Debug</span>.Print(<span style="color: #a31515">&quot;Position:&lt;{0},{1},{2}&gt; &quot;</span>,</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oPos.X,</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oPos.Y,</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oPos.Z);</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">// target</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #2b91af">Point3D</span> oTarget = </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">new</span> <span style="color: #2b91af">Point3D</span>(oPos.X + oViewDir.X * oFocal,</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oPos.Y + oViewDir.Y * oFocal,</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oPos.Z + oViewDir.Z * oFocal);</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #2b91af">Debug</span>.Print(<span style="color: #a31515">&quot;Target:&lt;{0},{1},{2}&gt; &quot;</span>,</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oTarget.X,</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oTarget.Y,</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oTarget.Z);</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">// rotation information</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #2b91af">AxisAndAngleResult</span> oAR =</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oRot.ToAxisAndAngle();</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #2b91af">Debug</span>.Print(<span style="color: #a31515">&quot;Rotation Axis:&lt;{0},{1},{2}&gt; &quot;</span>, </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oAR.Axis.X,</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oAR.Axis.Y,</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oAR.Axis.Z);</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #2b91af">Debug</span>.Print(<span style="color: #a31515">&quot;Rotation Angle: &quot;</span> + </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oAR.Angle);&#160;&#160;&#160;&#160;&#160;&#160; </p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">}</p> </div>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="color: blue">private</span> <span style="color: #2b91af">Rotation3D</span> MultiplyRotation3D(</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">Rotation3D</span> r2, </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">Rotation3D</span> r1)</p>    <p style="margin: 0px">{&#160;&#160;&#160;&#160;&#160;&#160;&#160; </p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #2b91af">Rotation3D</span> oRot = </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">new</span> <span style="color: #2b91af">Rotation3D</span>(r2.D * r1.A + r2.A * r1.D + </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; r2.B * r1.C - r2.C * r1.B,</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; r2.D * r1.B + r2.B * r1.D + </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; r2.C * r1.A - r2.A * r1.C,</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; r2.D * r1.C + r2.C * r1.D +</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; r2.A * r1.B - r2.B * r1.A,</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; r2.D * r1.D - r2.A * r1.A - </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; r2.B * r1.B - r2.C * r1.C);</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; oRot.Normalize();</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">return</span> oRot;</p>    <p style="margin: 0px">}</p> </div>  <p>In the next article, we will introduce how to manipulate viewpoint.</p>  <p>(To be continued)</p>
