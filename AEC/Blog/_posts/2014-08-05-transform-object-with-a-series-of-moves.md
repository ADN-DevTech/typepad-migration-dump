---
layout: "post"
title: "Transform Object with a Series of Moves"
date: "2014-08-05 03:56:36"
author: "Xiaodong Liang"
categories:
  - ".NET"
  - "Navisworks"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/aec/2014/08/transform-object-with-a-series-of-moves.html "
typepad_basename: "transform-object-with-a-series-of-moves"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/aec/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>
<p><strong>Question</strong>: <br />I am trying to apply a series of moves with time delay to an object in Navisworks using OverridePermanentTransform and System.Threading.Thread.Sleep(), but Navisworks delays first then applies the moves at the same time.</p>
<p><strong>Solution</strong>: <br />This is similar to the behavior discussed in the <a href="http://adndevblog.typepad.com/aec/2013/11/capture-view-image-and-force-screen-refresh-continuously.html" target="_self">other article</a>. The Navisworks screen refresh happens when the UI message loop delivers a paint event. If you have some code running that sits in a loop doing lots of work then thereâ€™s no way for the UI message loop to deliver a paint event.</p>
<p>I have practiced the way of Idle event. i.e. put your series of moves in the event. The following codes simulates a transformation: first move the selection along X+ with some distances, next rotate the objects along the axis (origin: center of the bundingbox; vector: 0,0,1). Finally, move the object along Z+ with some distances.</p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;"><span style="font-size: 9pt;">#region</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> HelloWorld</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;"><span style="font-size: 9pt;">using</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> System;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;"><span style="font-size: 9pt;">using</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> System.Collections.Generic;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;"><span style="font-size: 9pt;">using</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> System.Windows.Forms;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;"><span style="font-size: 9pt;">using</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> System.Text;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #008000;">//Add two new namespaces</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;"><span style="font-size: 9pt;">using</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> Autodesk.Navisworks.Api;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;"><span style="font-size: 9pt;">using</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> Autodesk.Navisworks.Api.Plugins;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;"><span style="font-size: 9pt;">namespace</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> BasicPlugIn</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">{</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #000000;"><span style="font-size: 9pt;">[</span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">PluginAttribute</span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #000000;">(</span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #a31515;">&quot;BasicPlugIn.ABasicPlugin&quot;</span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #000000;">,<span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #008000;">//Plugin name</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #a31515;">&quot;ADSK&quot;</span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #000000;">,<span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #008000;">//4 character Developer ID or GUID</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">ToolTip = </span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #a31515;">&quot;BasicPlugIn.ABasicPlugin tool tip&quot;</span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #000000;">,</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #008000;">//The tooltip for the item in the ribbon</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">DisplayName = </span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #a31515;">&quot;Hello World Plugin&quot;</span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #000000;">)]<span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #008000;">//Display name for the Plugin in the Ribbon</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;"><span style="font-size: 9pt;">public</span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;">class</span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">ABasicPlugin</span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #000000;"> : </span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">AddInPlugin</span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #008000;">//Derives from AddInPlugin</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">{ </span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;">public</span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;">override</span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;">int</span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #000000;"> Execute(</span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;">params</span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;">string</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;">[] parameters)</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">{ </span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">Document</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> doc = </span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">Autodesk.Navisworks.Api.</span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">Application</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;">.MainDocument;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #008000;">// current selection</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">ModelItemCollection</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> coll = </span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160; </span>doc.CurrentSelection.SelectedItems;</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;">if</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> (coll.Count == 0)</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">{</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">MessageBox</span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #000000;">.Show(</span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #a31515;">&quot;no selection!&quot;</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;">);</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;">return</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> 0;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">}</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">m_Index = 0;</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #008000;">//delagate the event of Idle</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">Autodesk.Navisworks.Api.</span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">Application</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;">.Idle +=</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;">new</span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">EventHandler</span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #000000;">&lt;</span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">EventArgs</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;">&gt;(Idle_EventHandler);</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;">return</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> 0;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">}</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #008000;">//simulation index</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;">int</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> m_Index = 0;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;&#0160;&#0160; </span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #008000;">//move step</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;">double</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> oMoveStep = 2;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #008000;">//rotate step</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;">double</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> oRotateStep = 0.1;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;">void</span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #000000;"> Idle_EventHandler(</span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;">object</span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #000000;"> sender, </span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">EventArgs</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> e)</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">{</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #008000;">//get handle of Navisworks window</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">IntPtr</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> hWnd = </span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">Autodesk.Navisworks.Api.</span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">Application</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;">.Gui.MainWindow.Handle;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;">if</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> (m_Index &lt; 50)</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">{</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;">if</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> (m_Index &lt;= 15)</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">{</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #008000;">// move X+</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">moveObjAlongX();</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">}</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;">if</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> (m_Index &lt;= 30 &amp;&amp; m_Index &gt; 15)</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">{</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #008000;">//rotate the axis that (0,0,1) and </span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #008000;">//origin is the center of the </span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #008000;">//boundingbox of the collection</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">rotateObjAlongAxis();</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">}</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;">if</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> (m_Index &lt;= 50 &amp;&amp; m_Index &gt; 30)</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">{</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #008000;">// move Z+</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">moveObjAlongZ();</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">} </span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;"><span style="mso-spacerun: yes;">&#0160; </span>m_Index++;</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">}</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #0000ff;">else</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">{</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #008000;">//stop the event Idle</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">Autodesk.Navisworks.Api.</span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">Application</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;">.Idle -= </span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">Idle_EventHandler;</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">} </span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">}</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">#region</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> &quot;transform object&quot;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;">private</span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;">void</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> moveObjAlongX()</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">{</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">Document</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> doc = </span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">Autodesk.Navisworks.Api.</span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">Application</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;">.MainDocument;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #008000;">// current selection</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">ModelItemCollection</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> coll = </span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">doc.CurrentSelection.SelectedItems;</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;">if</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> (coll.Count == 0)</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160; </span></span><span style="font-size: 9pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;">return</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;">;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #008000;">//build a vector for moving</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">Vector3D</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> oNewVector3d = </span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;">new</span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">Vector3D</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;">(oMoveStep, 0, 0);</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #008000;">//create a transform from a matrix with a vector.</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">Transform3D</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> oNewOverrideTrans = </span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">Transform3D</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;">.CreateTranslation(oNewVector3d);</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">doc.Models.OverridePermanentTransform(coll, </span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">oNewOverrideTrans, </span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;">true</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #000000;"><span style="font-size: 9pt;">);</span><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160; </span></span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">}</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;">private</span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;">void</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> rotateObjAlongAxis()</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">{</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">Document</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> doc = </span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">Autodesk.Navisworks.Api.</span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">Application</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;">.MainDocument;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #008000;">// current selection</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">ModelItemCollection</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> coll = </span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">doc.CurrentSelection.SelectedItems;</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;">if</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> (coll.Count == 0)</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;">return</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;">;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #008000;">//build the translation from boundingbox center to origin of WCS </span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">Point3D</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> oCenterP = </span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">coll.BoundingBox().Center;</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">Vector3D</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> oMoveBackToOrig = </span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;">new</span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">Vector3D</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;">(-oCenterP.X, -oCenterP.Y, -oCenterP.Z);</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">Transform3D</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> oMoveBackToOrigM =</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">Transform3D</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;">.CreateTranslation(oMoveBackToOrig);</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt; color: #008000;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;">//<span style="mso-spacerun: yes;">&#0160; </span>set the axis we will rotate around </span></span></span><span style="color: #008000;"><span style="font-size: 9pt;"><span style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt; mso-ascii-font-family: &#39;Times New Roman&#39;; mso-fareast-font-family: å®‹ä½“; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: &#39;Times New Roman&#39;; mso-bidi-font-family: &#39;Times New Roman&#39;;"><span style="font-family: å®‹ä½“;">ï¼ˆ</span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;">0,0,1</span></span></span><span style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt; mso-ascii-font-family: &#39;Times New Roman&#39;; mso-fareast-font-family: å®‹ä½“; mso-fareast-theme-font: minor-fareast; mso-hansi-font-family: &#39;Times New Roman&#39;; mso-bidi-font-family: &#39;Times New Roman&#39;;"><span style="font-family: å®‹ä½“;"><span style="font-size: 9pt;">ï¼‰</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">UnitVector3D</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> odeltaA =</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;">new</span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">UnitVector3D</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;">(0, 0, 1);</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #008000;"><span style="font-size: 9pt;">// Create delta of Quaternion: axis is Z,</span><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">Rotation3D</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> delta =</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;">new</span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">Rotation3D</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;">(odeltaA, oRotateStep);</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #008000;">//create a transform from a matrix with a rotation.</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">Transform3D</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> oNewOverrideTrans = </span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;">new</span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">Transform3D</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;">(delta);</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #008000;">//build final matrix</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">Transform3D</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> oFinalM = </span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">Transform3D</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;">.Multiply(oMoveBackToOrigM, oNewOverrideTrans);</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">oFinalM = </span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">Transform3D</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;">.Multiply(oFinalM, oMoveBackToOrigM.Inverse());</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">doc.Models.OverridePermanentTransform(coll, oFinalM, </span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;">true</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;">); </span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">}</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;">private</span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;">void</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> moveObjAlongZ()</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">{</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">Document</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> doc = </span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">Autodesk.Navisworks.Api.</span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">Application</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;">.MainDocument;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #008000;">// current selection</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">ModelItemCollection</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> coll = </span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">doc.CurrentSelection.SelectedItems;</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;">if</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> (coll.Count == 0)</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;">return</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;">;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #008000;">//build a vector for moving along X+</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">Vector3D</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> oNewVector3d =</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;">new</span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">Vector3D</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;">(0,0 ,oMoveStep);</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">Matrix3</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> oNewIndentityM = </span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;">new</span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">Matrix3</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;">();</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #008000;">//create a transform from a matrix with a vector.</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">Transform3D</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;"> oNewOverrideTrans =</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;">new</span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #2b91af;">Transform3D</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;">(oNewIndentityM, oNewVector3d);</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">doc.Models.OverridePermanentTransform(coll, </span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">oNewOverrideTrans,</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span style="font-family: &#39;Times New Roman&#39;;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span><span style="font-size: 9pt;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="color: #0000ff;">true</span></span></span><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-size: 9pt; color: #000000;">);</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">} </span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #0000ff;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">#endregion</span></span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">}</span></span></span></p>
<p align="left" class="MsoNormal" style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none;"><span lang="EN-US" style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #000000;">}</span></span></span></p>
<p align="justify" class="MsoNormal" style="text-justify: inter-ideograph; line-height: normal; margin: 0cm 0cm 0pt;"><span lang="EN-US" style="background-image: none; text-justify: inter-ideograph; text-align: justify; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 9pt; color: #0000ff;">#endregion</span></span></span></p>
<p align="justify" class="MsoNormal" style="text-justify: inter-ideograph; line-height: normal; margin: 0cm 0cm 0pt;">&#0160;</p>
<p align="justify" class="MsoNormal" style="text-justify: inter-ideograph; line-height: normal; margin: 0cm 0cm 0pt;">&#0160;</p>
<p align="justify" class="MsoNormal" style="text-justify: inter-ideograph; line-height: normal; margin: 0cm 0cm 0pt;"><span lang="EN-US" style="background-image: none; text-justify: inter-ideograph; text-align: justify; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: white; mso-font-kerning: 0pt;"><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01a73dfba6d9970d-pi"><img alt="Untitled" height="223" src="/assets/image_839407.jpg" style="display: inline;" title="Untitled" width="240" /></a></span></p>
