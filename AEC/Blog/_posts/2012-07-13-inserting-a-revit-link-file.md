---
layout: "post"
title: "Inserting a Revit Link file"
date: "2012-07-13 13:22:10"
author: "Augusto Goncalves"
categories:
  - ".NET"
  - "Augusto Goncalves"
  - "Revit"
original_url: "https://adndevblog.typepad.com/aec/2012/07/inserting-a-revit-link-file.html "
typepad_basename: "inserting-a-revit-link-file"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/aec/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>Starting on release 2013 it is possible create a RevitLinkType, which defines the link to a .rvt file, and then insert a new RevitLinkInstance on the project.</p>  <div style="font-family: ; background: white">   <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">// Ask for the file name</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">System.Windows.Forms.</font></font><font style="font-size: 8pt"><span><font color="#2b91af">OpenFileDialog</font></span><font color="#000000"> </font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; openFileDlg = </font></font><font style="font-size: 8pt"><span><font color="#0000ff">new</font></span><font color="#000000"> </font><span><font color="#2b91af">OpenFileDialog</font></span><font color="#000000">();</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">if</font></font></span><font style="font-size: 8pt"><font color="#000000"> (openFileDlg.ShowDialog() != </font><span><font color="#2b91af">DialogResult</font></span><font color="#000000">.OK) </font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">return</font></span><font color="#000000"> </font><span><font color="#2b91af">Result</font></span><font color="#000000">.Cancelled;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">string</font></font></span><font style="font-size: 8pt" color="#000000"> rvtFileName = openFileDlg.FileName;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">// Get the active document </font></font></span></p>    <p style="margin: 0px"><span></span><font face="Courier New"><span><font color="#2b91af"><font style="font-size: 8pt">UIDocument</font></font></span><font style="font-size: 8pt" color="#000000"> uiDoc = commandData.</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160; Application.ActiveUIDocument;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#2b91af"><font style="font-size: 8pt">Document</font></font></span><font style="font-size: 8pt" color="#000000"> doc = uiDoc.Document;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">// Create the Revit Link Type</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#2b91af"><font style="font-size: 8pt">FilePath</font></font></span><font style="font-size: 8pt"><font color="#000000"> mp = </font><span><font color="#0000ff">new</font></span><font color="#000000"> </font><span><font color="#2b91af">FilePath</font></span><font color="#000000">(rvtFileName);</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#2b91af"><font style="font-size: 8pt">RevitLinkOptions</font></font></span><font style="font-size: 8pt"><font color="#000000"> lnkOp = </font><span><font color="#0000ff">new</font></span><font color="#000000"> </font><span><font color="#2b91af">RevitLinkOptions</font></span><font color="#000000">(</font><span><font color="#0000ff">false</font></span><font color="#000000">);</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#2b91af"><font style="font-size: 8pt">RevitLinkLoadResult</font></font></span><font style="font-size: 8pt" color="#000000"> loadedLnkType = </font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">RevitLinkType</font></span><font color="#000000">.Create(doc, mp, lnkOp);</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">// Create the Revit Link Instance</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#2b91af"><font style="font-size: 8pt">RevitLinkInstance</font></font></span><font style="font-size: 8pt" color="#000000"> lnkInstance = </font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">RevitLinkInstance</font></span><font color="#000000">.Create(doc, loadedLnkType.ElementId);</font></font></font></p> </div>
