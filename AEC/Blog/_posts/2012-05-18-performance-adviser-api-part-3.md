---
layout: "post"
title: "Performance Adviser API &ndash; Part 3"
date: "2012-05-18 08:00:00"
author: "Saikat Bhattacharya"
categories:
  - ".NET"
  - "Revit"
  - "Saikat Bhattacharya"
original_url: "https://adndevblog.typepad.com/aec/2012/05/performance-adviser-api-part-3.html "
typepad_basename: "performance-adviser-api-part-3"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/aec/saikat-bhattacharya.html" target="_self">Saikat Bhattacharya</a></p>
<p>In this concluding post on this topic, we shall look at how to define a custom rule using the Performance Adviser API.</p>
<p>Now, the most powerful part of this API is that we define custom adviser rules. To create our own, we define a class implementing an interface called IPerformanceAdviserRule. Your custom adviser class then needs to define the following methods:</p>
<p>•&#0160;&#0160;&#0160; GetName() - returns the name of this rule. <br />•&#0160;&#0160;&#0160; GetDescription() - provides the description of this custom rule. <br />•&#0160;&#0160;&#0160; InitCheck() – performs the initialization work before running the rule. For example, it could be a task like clearing a collection of elements that we will be storing elements that fail the rule execution test. <br />•&#0160;&#0160;&#0160; WillCheckElements() – sets whether the rule will iterate through elements or not. <br />•&#0160;&#0160;&#0160; GetElementFilter() - provides the element filter which can help narrow down the type or category of elements that a certain rule is expected to work with. <br />•&#0160;&#0160;&#0160; ExecuteElementCheck() – This method contains most of the implementation steps for a given rule. It examines the element passed to it (which is filtered by the GetElementFilter) and checks for all elements that fail the criteria laid by the rule. <br />•&#0160;&#0160;&#0160; FinalizeCheck() – This method gets called by the PerformanceAdviser after all the elements in a document matching the element filter in the GetElementFilter() method are checked by the ExecuteElementCheck() method. This method usually will contain the code to check if there are elements which fail the rule test and if there are, the names of the elements are listed along with the standard warning failure message.</p>
<p>The code below shows an example of a custom performance adviser rule, which provides warnings if there are clashes between ducts in a Revit model:&#0160;</p>
<div style="background: white;">
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">using</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> System;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">using</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> System.Collections.Generic;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">using</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> System.Linq;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">using</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> System.Text;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">using</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> Autodesk.Revit.UI;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">using</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> Autodesk.Revit.DB;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">using</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> Autodesk.Revit.Attributes;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">namespace</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> PASample</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt; font-size: 8pt;"><span style="font-family: Courier New;"><span style="color: #000000;">{</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">class</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">DuctClashDetection</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> : </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">IPerformanceAdviserRule</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt; font-size: 8pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160; {</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">private</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">FailureDefinition</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> m_warning;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">private</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">FailureDefinitionId</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> m_warningId;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">private</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">List</span></span><span style="line-height: 11pt;"><span style="color: #000000;">&lt;Autodesk.Revit.DB.</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">ElementId</span></span><span style="line-height: 11pt;"><span style="color: #000000;">&gt; m_ClashingDucts;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> </span></span><span style="line-height: 11pt;"><span style="color: #808080;">&lt;summary&gt;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> Constructor for DuctClashDetection</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> </span></span><span style="line-height: 11pt;"><span style="color: #808080;">&lt;/summary&gt;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> DuctClashDetection()</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt; font-size: 8pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;&#0160;&#0160; {</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #008000;">// Create failure message </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; m_warningId = </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">new</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">FailureDefinitionId</span></span><span style="line-height: 11pt;"><span style="color: #000000;">(</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">new</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Guid</span></span><span style="line-height: 11pt;"><span style="color: #000000;">(</span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;AACC9C09-7956-4B36-9D27-FF8A64544C31&quot;</span></span><span style="line-height: 11pt;"><span style="color: #000000;">));</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; m_warning = </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">FailureDefinition</span></span><span style="line-height: 11pt;"><span style="color: #000000;">.CreateFailureDefinition(</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt; font-size: 8pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; m_warningId, </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Autodesk.Revit.DB.</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">FailureSeverity</span></span><span style="line-height: 11pt;"><span style="color: #000000;">.Warning, </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;Some ducts clash with each other&quot;</span></span><span style="line-height: 11pt;"><span style="color: #000000;">);</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt; font-size: 8pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;&#0160;&#0160; }</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> </span></span><span style="line-height: 11pt;"><span style="color: #808080;">&lt;summary&gt;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> This method does most of the work of the </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> IPerformanceAdviserRule implementation. This method is </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> called by PerformanceAdviser. It examines the element passed </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> to it (which was previously filtered by the filter</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> returned by GetElementFilter).&#0160; This method is </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> checking for all elements that intersect with current duct and </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> adds them to the list of elements</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> </span></span><span style="line-height: 11pt;"><span style="color: #808080;">&lt;/summary&gt;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> </span></span><span style="line-height: 11pt;"><span style="color: #808080;">&lt;param name=&quot;document&quot;&gt;&lt;/param&gt;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> </span></span><span style="line-height: 11pt;"><span style="color: #808080;">&lt;param name=&quot;element&quot;&gt;&lt;/param&gt;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">void</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> ExecuteElementCheck(</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Document</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> document, </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Element</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> element)</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt; font-size: 8pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;&#0160;&#0160; {</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #008000;">// For each of the elements, check if there is any </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #008000;">// intersection with the specific element being passed on </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #008000;">// via the method signature</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">FilteredElementCollector</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> collector = </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">new</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">FilteredElementCollector</span></span><span style="line-height: 11pt;"><span style="color: #000000;">(document);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #008000;">// Use the Elements Intersection Filter to get elements</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #008000;">// that intersect with the specified element</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">ElementIntersectsElementFilter</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> elementFilter = </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">new</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">ElementIntersectsElementFilter</span></span><span style="line-height: 11pt;"><span style="color: #000000;">(element, </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">false</span></span><span style="line-height: 11pt;"><span style="color: #000000;">);</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt; font-size: 8pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; collector.WherePasses(elementFilter);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #008000;">// Exclude the element in the intersection</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">List</span></span><span style="line-height: 11pt;"><span style="color: #000000;">&lt;</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">ElementId</span></span><span style="line-height: 11pt;"><span style="color: #000000;">&gt; excludes = </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">new</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">List</span></span><span style="line-height: 11pt;"><span style="color: #000000;">&lt;</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">ElementId</span></span><span style="line-height: 11pt;"><span style="color: #000000;">&gt;();</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt; font-size: 8pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; excludes.Add(element.Id);</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt; font-size: 8pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; collector.Excluding(excludes);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #008000;">// Save the intersecting ducts</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">foreach</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> (</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Element</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> elem </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">in</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> collector)</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt; font-size: 8pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; {</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt; font-size: 8pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; m_ClashingDucts.Add(elem.Id);</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt; font-size: 8pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; }</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt; font-size: 8pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;&#0160;&#0160; }</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> </span></span><span style="line-height: 11pt;"><span style="color: #808080;">&lt;summary&gt;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> The rule ID for this rule;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> </span></span><span style="line-height: 11pt;"><span style="color: #808080;">&lt;/summary&gt;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> Autodesk.Revit.DB.</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">PerformanceAdviserRuleId</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> Id = </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">new</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> Autodesk.Revit.DB.</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">PerformanceAdviserRuleId</span></span><span style="line-height: 11pt;"><span style="color: #000000;">(</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">new</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Guid</span></span><span style="line-height: 11pt;"><span style="color: #000000;">(</span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;C00CEF6D-2C4B-402C-9AED-160DFA1785BE&quot;</span></span><span style="line-height: 11pt;"><span style="color: #000000;">));</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> </span></span><span style="line-height: 11pt;"><span style="color: #808080;">&lt;summary&gt;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> This method is called by PerformanceAdviser after all </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> elements in document matching the ElementFilter from </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> GetElementFilter() are checked by ExecuteElementCheck().</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> This method checks to see if there are any ducts in the</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> m_ClashingDucts list.&#0160; If there are, it iterates through </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> that list and reports the failures.</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> </span></span><span style="line-height: 11pt;"><span style="color: #808080;">&lt;/summary&gt;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> </span></span><span style="line-height: 11pt;"><span style="color: #808080;">&lt;param name=&quot;document&quot;&gt;&lt;/param&gt;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">void</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> FinalizeCheck(</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Document</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> document)</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt; font-size: 8pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;&#0160;&#0160; {</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">try</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt; font-size: 8pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; {</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #008000;">// If no ducts clash </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">if</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> (m_ClashingDucts.Count == 0)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; System.Diagnostics.</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Debug</span></span><span style="line-height: 11pt;"><span style="color: #000000;">.WriteLine(</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;No clashing ducts. Test passed.&quot;</span></span><span style="line-height: 11pt;"><span style="color: #000000;">);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">else</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt; font-size: 8pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #008000;">// Pass the element IDs of the clashing ducts to the revit</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #008000;">// failure reporting APIs.</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Autodesk.Revit.DB.</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">FailureMessage</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> fm = </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">new</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> Autodesk.Revit.DB.</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">FailureMessage</span></span><span style="line-height: 11pt;"><span style="color: #000000;">(m_warningId);</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt; font-size: 8pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; fm.SetFailingElements(m_ClashingDucts);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Autodesk.Revit.DB.</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Transaction</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> failureReportingTransaction = </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">new</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> Autodesk.Revit.DB.</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Transaction</span></span><span style="line-height: 11pt;"><span style="color: #000000;">(document, </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;Failure reporting&quot;</span></span><span style="line-height: 11pt;"><span style="color: #000000;">);</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt; font-size: 8pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; failureReportingTransaction.Start();</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #008000;">//document.PostFailure(fm);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">PerformanceAdviser</span></span><span style="line-height: 11pt;"><span style="color: #000000;">.GetPerformanceAdviser().PostWarning(fm);</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt; font-size: 8pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; failureReportingTransaction.Commit();</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt; font-size: 8pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; m_ClashingDucts.Clear();&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt; font-size: 8pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt; font-size: 8pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; }</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">catch</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> (System.</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Exception</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> ex)</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt; font-size: 8pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; {</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">TaskDialog</span></span><span style="line-height: 11pt;"><span style="color: #000000;">.Show(</span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;Oops!&quot;</span></span><span style="line-height: 11pt;"><span style="color: #000000;">, ex.Message);</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt; font-size: 8pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; }</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt; font-size: 8pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;&#0160;&#0160; }</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> </span></span><span style="line-height: 11pt;"><span style="color: #808080;">&lt;summary&gt;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> Get the Description of the rule</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> </span></span><span style="line-height: 11pt;"><span style="color: #808080;">&lt;/summary&gt;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> </span></span><span style="line-height: 11pt;"><span style="color: #808080;">&lt;returns&gt;&lt;/returns&gt;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">string</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> GetDescription()</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt; font-size: 8pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;&#0160;&#0160; {</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">return</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;Detects clash between ducts&quot;</span></span><span style="line-height: 11pt;"><span style="color: #000000;">;</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt; font-size: 8pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;&#0160;&#0160; }</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> </span></span><span style="line-height: 11pt;"><span style="color: #808080;">&lt;summary&gt;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> Provide the filter to focus on elements that this rule should</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> be focussed on</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> </span></span><span style="line-height: 11pt;"><span style="color: #808080;">&lt;/summary&gt;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> </span></span><span style="line-height: 11pt;"><span style="color: #808080;">&lt;param name=&quot;document&quot;&gt;&lt;/param&gt;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> </span></span><span style="line-height: 11pt;"><span style="color: #808080;">&lt;returns&gt;&lt;/returns&gt;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">ElementFilter</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> GetElementFilter(</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Document</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> document)</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt; font-size: 8pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;&#0160;&#0160; {</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">return</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">new</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">ElementClassFilter</span></span><span style="line-height: 11pt;"><span style="color: #000000;">(</span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">typeof</span></span><span style="line-height: 11pt;"><span style="color: #000000;">(</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Autodesk.Revit.DB.Mechanical.</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Duct</span></span><span style="line-height: 11pt;"><span style="color: #000000;">));</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt; font-size: 8pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;&#0160;&#0160; }</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> </span></span><span style="line-height: 11pt;"><span style="color: #808080;">&lt;summary&gt;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> Get the name of the rule</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> </span></span><span style="line-height: 11pt;"><span style="color: #808080;">&lt;/summary&gt;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> </span></span><span style="line-height: 11pt;"><span style="color: #808080;">&lt;returns&gt;&lt;/returns&gt;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">string</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> GetName()</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt; font-size: 8pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;&#0160;&#0160; {</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">return</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;Duct Clash Detection&quot;</span></span><span style="line-height: 11pt;"><span style="color: #000000;">; </span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt; font-size: 8pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;&#0160;&#0160; }</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> </span></span><span style="line-height: 11pt;"><span style="color: #808080;">&lt;summary&gt;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> Perform initial/preliminary work before executing the tests</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> </span></span><span style="line-height: 11pt;"><span style="color: #808080;">&lt;/summary&gt;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> </span></span><span style="line-height: 11pt;"><span style="color: #808080;">&lt;param name=&quot;document&quot;&gt;&lt;/param&gt;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">void</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> InitCheck(</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Document</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> document)</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt; font-size: 8pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;&#0160;&#0160; {</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">if</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> (m_ClashingDucts == </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">null</span></span><span style="line-height: 11pt;"><span style="color: #000000;">)</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; m_ClashingDucts = </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">new</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">List</span></span><span style="line-height: 11pt;"><span style="color: #000000;">&lt;</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">ElementId</span></span><span style="line-height: 11pt;"><span style="color: #000000;">&gt;();</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">else</span></span></span></p>
<p style="margin: 0px;"><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; m_ClashingDucts.Clear();</span></span></span><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">return</span></span><span style="line-height: 11pt;"><span style="color: #000000;">;</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt; font-size: 8pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;&#0160;&#0160; }</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> </span></span><span style="line-height: 11pt;"><span style="color: #808080;">&lt;summary&gt;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> Return true if this rule will iterate through elements and </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> check them, else return false</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> </span></span><span style="line-height: 11pt;"><span style="color: #808080;">&lt;/summary&gt;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #808080;">///</span></span><span style="line-height: 11pt;"><span style="color: #008000;"> </span></span><span style="line-height: 11pt;"><span style="color: #808080;">&lt;returns&gt;&lt;/returns&gt;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">bool</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> WillCheckElements()</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt; font-size: 8pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;&#0160;&#0160; {</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">return</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">true</span></span><span style="line-height: 11pt;"><span style="color: #000000;">;</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt; font-size: 8pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;&#0160;&#0160; }</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt; font-size: 8pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160; }</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt; font-size: 8pt;"><span style="font-family: Courier New;"><span style="color: #000000;">}</span></span></span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;">Once we have defined a class for our custom rule, our next step is to register the rule. You can do this by calling PerformanceAdvisor.AddRule(). This is done at the startup of Revit using the OnStartup() event of IExternalApplication. Similarly, we can unregister the Performance Adviser rule at the OnShutdown() event. The following code shows an example of how the custom rule is registered and unregistered:</p>
<p style="margin: 0px;">&#0160;</p>
<div style="background: white;">
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">[</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Transaction</span></span><span style="line-height: 11pt;"><span style="color: #000000;">(</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">TransactionMode</span></span><span style="line-height: 11pt;"><span style="color: #000000;">.Manual)]</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">class</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">AddPerformanceRule</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> : </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">IExternalApplication</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt; font-size: 8pt;"><span style="font-family: Courier New;"><span style="color: #000000;">{</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">DuctClashDetection</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> ductClashDetect;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Result</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> OnShutdown(</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">UIControlledApplication</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> application)</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt; font-size: 8pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160; {</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">PerformanceAdviser</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> adviser = </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">PerformanceAdviser</span></span><span style="line-height: 11pt;"><span style="color: #000000;">.GetPerformanceAdviser();</span></span></span></p>
<p style="margin: 0px;"><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;&#0160;&#0160; adviser.DeleteRule(ductClashDetect.Id);</span></span></span><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">return</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Result</span></span><span style="line-height: 11pt;"><span style="color: #000000;">.Succeeded;</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt; font-size: 8pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160; }</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Result</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> OnStartup(</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">UIControlledApplication</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> application)</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt; font-size: 8pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160; {</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">PerformanceAdviser</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> adviser = </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">PerformanceAdviser</span></span><span style="line-height: 11pt;"><span style="color: #000000;">.GetPerformanceAdviser();</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; ductClashDetect = </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">new</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">DuctClashDetection</span></span><span style="line-height: 11pt;"><span style="color: #000000;">();</span></span></span></p>
<p style="margin: 0px;"><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;&#0160;&#0160; adviser.AddRule(ductClashDetect.Id, ductClashDetect);</span></span></span><span style="font-family: Courier New;"><span style="color: #000000;">&#0160;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New; font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&#0160;&#0160;&#0160; </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">return</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Result</span></span><span style="line-height: 11pt;"><span style="color: #000000;">.Succeeded;</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt; font-size: 8pt;"><span style="font-family: Courier New;"><span style="color: #000000;">&#0160; }</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt; font-size: 8pt;"><span style="font-family: Courier New;"><span style="color: #000000;">}</span></span></span></p>
</div>
<p>Once the custom rule has been added, we can execute it in the same way as the predefined rules. Using the code used in this article against a given set of clashing ducts, this new API can report the clash results as shown below:&#0160;</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0167668578f5970b-pi"><img alt="clip_image001" border="0" height="245" src="/assets/image_80167.jpg" style="background-image: none; padding-left: 0px; padding-right: 0px; display: block; float: none; margin-left: auto; margin-right: auto; padding-top: 0px; border: 0px;" title="clip_image001" width="446" /></a></p>
<p style="margin: 0px;">&#0160;</p>
</div>
<p>In the blog posts on this topic, we have seen how the performance adviser API provides the ability to define custom rules, execute them, and report potentially problematic results via the failure message APIs. The Revit SDK sample called PerformanceAdviserControl shows more comprehensive example of this API. It presents a list of rules for the users to select and execute. Please refer to the sample for more detail.</p>
