---
layout: "post"
title: "Forge DevCon Early Bird, Revit API Moving a Grid"
date: "2016-04-07 13:44:44"
author: "Jaime Rosales"
categories:
  - ".NET"
  - "Announcements"
  - "Cloud"
  - "Events"
  - "Jaime Rosales"
  - "Revit"
  - "Revit Architecture"
  - "Revit MEP"
  - "Revit Structure"
original_url: "https://adndevblog.typepad.com/aec/2016/04/forge-devcon-early-bird-revit-api-moving-a-grid-with-datumplane-method.html "
typepad_basename: "forge-devcon-early-bird-revit-api-moving-a-grid-with-datumplane-method"
typepad_status: "Publish"
---

<p>by <a href="http://adndevblog.typepad.com/aec/jaime-rosales/">Jaime Rosales</a>&#0160;(<a href="https://twitter.com/AfroJme">@afrojme</a>)</p>
<p>&#0160;I think it has been quite some time since my last post, but definitely it will be something that would not happen again. I’ve been all over the place presenting and evangelizing about Forge, View and Data API and our upcoming DevCon in San Francisco in the month of the Rainy Summer of June.</p>
<p>The conference is intended for developers, entrepreneurs or technology enthusiasts, who are interested in using Autodesk &#39;cloud&#39; technologies to disrupt the AEC and Manufacturing industries. Interested? Wait no more click the image below.</p>
<p><a href="http://forge.autodesk.com/conference"><img alt="Forge" border="0" src="/assets/image_349178.jpg" title="Forge" /></a></p>
<p>Early bird registration is due to end on April 15th, so you don&#39;t have much time to buy your ticket at the low cost of $499. If you&#39;re a student, you can come for FREE- just sign up for a student ticket using a .edu email address.We&#39;re still working on the agenda. Visit this <a href="http://forge.autodesk.com/tracks-and-speakers/">link</a> for a list of the classes we currently have planned.</p>
<p>----------------------------------------------------------------------------------</p>
<p>Back to Revit, This week I had the chance to work in a Revit API forum question by community contributor erikeriksson5686 about how to Move the Gridlines using DatumPlane API Method. <a href="http://forums.autodesk.com/t5/revit-api/moving-a-grid/td-p/6067953">Forum question here</a>.</p>
<p><strong>Question</strong>:So I&#39;ve been asked to synchronize grid leader locations (along the grid line) between files.I thought that this would be easy using the new API for DatumPlane, BUT i was wrong. The property I want to change in the Leader is the Anchor, but that property is readonly and the documentation says: &quot; This is a read-only property, for the this point gets always computed based on various properties of the annotation element. &quot;</p>
<p>Well for the grid element there are no annotation elements attached to the Leader, right? <br />Am i missing something? Thanks!</p>
<p>After some back and fort with Revit Engineering one of their own, Lily Li, got back to me with a macro sample on how to achieve the desired workflow. It was so nice of her.</p>
<p><strong>Answer</strong>:Hi Erik, Revit Engineering got back to me with a solution for moving the grid. Here is what they wrote:</p>
<p>&quot;<em>The new API for DatumPlane works and the data should be computed by users according to their requirements. Here is a Macro as a sample showing how to get from A to B. Please open the file and run the ‘SynGridLeaders’, it will get the following result.</em></p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01bb08d466ff970d-pi"><img alt="image" border="0" height="252" src="/assets/image_753049.jpg" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="image" width="379" /></a>&#0160;&#0160;&#0160;&#0160; After running the Macro, here is the result ---------&gt;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d1ba314f970c-pi"><img alt="image" border="0" height="253" src="/assets/image_892938.jpg" style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-width: 0px;" title="image" width="178" /></a></p>
<p><em>The Anchor property of the leader is read-only as it is computed by the Elbow and End properties set by the users. The new leader should also be set via SetLeader() method to get it work.</em>&quot;</p>
<p>You can find the Revit File <a href="https://github.com/jaimerosales/revit-macros/tree/master/SyncGridLeaders-2016">here</a></p>
<p>And the code for the Macro is the following:</p>
<div class="code"><span style="font-size: small;"><span style="color: #0000ff;">public</span><span style="color: #808080;">&#0160;</span><span style="color: #0000ff;">void</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">SynGridLeaders()</span></span><span style="color: #808080;"> <br /></span><span style="color: #000000; font-size: small;">{</span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160; </span></span><span style="font-size: small;"><span style="color: #000000;">FilteredElementCollector</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">collector</span><span style="color: #808080;">&#0160;</span><span style="color: #0000ff;">=</span><span style="color: #808080;">&#0160;</span><span style="color: #0000ff;">new</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">FilteredElementCollector(Document)</span><span style="color: #0000ff;">;</span></span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160; </span></span><span style="font-size: small;"><span style="color: #000000;">collector.OfClass(</span><span style="color: #0000ff;">typeof</span><span style="color: #000000;">(Grid))</span><span style="color: #0000ff;">;</span></span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160; </span></span><span style="font-size: small;"><span style="color: #2b91af;">IEnumerable</span><span style="color: #000000;">&lt;Grid&gt;</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">grids</span><span style="color: #808080;">&#0160;</span><span style="color: #0000ff;">=</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">collector.Cast&lt;Grid&gt;().OrderBy&lt;Grid,</span><span style="color: #808080;">&#0160;</span><span style="color: #0000ff;">int</span><span style="color: #000000;">&gt;(vp</span><span style="color: #808080;">&#0160;</span><span style="color: #0000ff;">=</span><span style="color: #000000;">&gt;</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">vp.Id.IntegerValue)</span><span style="color: #0000ff;">;</span></span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; </span></span><span style="font-size: small;"><span style="color: #000000;">View</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">view</span><span style="color: #808080;">&#0160;</span><span style="color: #0000ff;">=</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">Document.ActiveView</span><span style="color: #0000ff;">;</span></span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160; </span></span><span style="font-size: small;"><span style="color: #0000ff;">if</span><span style="color: #000000;">(!(view</span><span style="color: #808080;">&#0160;</span><span style="color: #0000ff;">is</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">ViewPlan))</span></span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160; </span></span><span style="color: #000000; font-size: small;">{</span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="color: #0000ff; font-size: small;">return;</span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160; </span></span><span style="color: #000000; font-size: small;">}</span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160; </span></span><span style="font-size: small;"><span style="color: #0000ff;">using</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">(Transaction</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">trans</span><span style="color: #808080;">&#0160;</span><span style="color: #0000ff;">=</span><span style="color: #808080;">&#0160;</span><span style="color: #0000ff;">new</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">Transaction(Document,</span><span style="color: #808080;"> &quot;Set leader&quot;</span><span style="color: #000000;">))</span></span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160; </span></span><span style="color: #000000; font-size: small;">{</span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: small;"><span style="color: #000000;">Leader</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">leaderBase</span><span style="color: #808080;">&#0160;</span><span style="color: #0000ff;">=</span><span style="color: #808080;">&#0160;</span><span style="color: #0000ff;">null;</span></span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: small;"><span style="color: #000000;">trans.Start()</span><span style="color: #0000ff;">;</span></span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="color: #0000ff; font-size: small;">try</span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="color: #000000; font-size: small;">{</span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: small;"><span style="color: #0000ff;">foreach</span><span style="color: #000000;">(Grid</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">grid</span><span style="color: #808080;">&#0160;</span><span style="color: #0000ff;">in</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">grids)</span></span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="color: #000000; font-size: small;">{</span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: small;"><span style="color: #006400;">// The Grid 1 is the baseline <br /></span><span style="color: #808080;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: #0000ff;">if</span><span style="color: #000000;">(grid.Name</span><span style="color: #808080;">&#0160;</span><span style="color: #0000ff;">==</span><span style="color: #808080;"> &quot;1&quot;</span><span style="color: #000000;">)</span></span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="color: #000000; font-size: small;">{</span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: small;"><span style="color: #000000;">leaderBase</span><span style="color: #808080;">&#0160;</span><span style="color: #0000ff;">=</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">grid.GetLeader(DatumEnds.End1,</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">view)</span><span style="color: #0000ff;">;</span></span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="color: #0000ff; font-size: small;">continue;</span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="color: #000000; font-size: small;">}</span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="color: #0000ff; font-size: small;">else</span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="color: #000000; font-size: small;">{</span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: small;"><span style="color: #000000;">Leader</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">leader</span><span style="color: #808080;">&#0160;</span><span style="color: #0000ff;">=</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">grid.GetLeader(DatumEnds.End1,</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">view)</span><span style="color: #0000ff;">;</span></span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: small;"><span style="color: #0000ff;">if</span><span style="color: #000000;">(leader</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">!</span><span style="color: #0000ff;">=</span><span style="color: #808080;">&#0160;</span><span style="color: #0000ff;">null</span><span style="color: #000000;">)</span></span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="color: #000000; font-size: small;">{</span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: small;"><span style="color: #000000;">XYZ</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">anchor</span><span style="color: #808080;">&#0160;</span><span style="color: #0000ff;">=</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">leader.Anchor</span><span style="color: #0000ff;">;</span></span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: small;"><span style="color: #000000;">XYZ</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">end</span><span style="color: #808080;">&#0160;</span><span style="color: #0000ff;">=</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">leader.End</span><span style="color: #0000ff;">;</span></span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: small;"><span style="color: #000000;">XYZ</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">elbow</span><span style="color: #808080;">&#0160;</span><span style="color: #0000ff;">=</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">leader.Elbow</span><span style="color: #0000ff;">;</span></span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: small;"><span style="color: #000000;">XYZ</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">newEnd</span><span style="color: #0000ff;">;</span></span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: small;"><span style="color: #000000;">XYZ</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">newElbow</span><span style="color: #0000ff;">;</span></span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: small;"><span style="color: #0000ff;">double</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">distY</span><span style="color: #808080;">&#0160;</span><span style="color: #0000ff;">=</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">leaderBase.Elbow.Y</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">-</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">leaderBase.End.Y</span><span style="color: #0000ff;">;</span></span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: small;"><span style="color: #0000ff;">double</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">distElbowX</span><span style="color: #808080;">&#0160;</span><span style="color: #0000ff;">=</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">leaderBase.Elbow.X</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">-</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">leaderBase.End.X</span><span style="color: #0000ff;">;</span></span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: small;"><span style="color: #0000ff;">double</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">distEndX</span><span style="color: #808080;">&#0160;</span><span style="color: #0000ff;">=</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">leaderBase.End.X</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">-</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">leader.End.X</span><span style="color: #0000ff;">;</span></span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: small;"><span style="color: #000000;">newEnd</span><span style="color: #808080;">&#0160;</span><span style="color: #0000ff;">=</span><span style="color: #808080;">&#0160;</span><span style="color: #0000ff;">new</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">XYZ(leader.End.X</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">+</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">distEndX,</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">leader.End.Y,</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">leader.End.Z)</span><span style="color: #0000ff;">;</span></span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: small;"><span style="color: #000000;">newElbow</span><span style="color: #808080;">&#0160;</span><span style="color: #0000ff;">=</span><span style="color: #808080;">&#0160;</span><span style="color: #0000ff;">new</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">XYZ(leader.End.X</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">+</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">distEndX</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">+</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">distElbowX,</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">leader.End.Y</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">+distY,</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">leader.Elbow.Z)</span><span style="color: #0000ff;">;</span></span><span style="color: #808080;"> <br /> <br /><span style="font-size: small;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: small;"><span style="color: #000000;">leader.Elbow</span><span style="color: #808080;">&#0160;</span><span style="color: #0000ff;">=</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">newElbow</span><span style="color: #0000ff;">;</span></span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: small;"><span style="color: #000000;">leader.End</span><span style="color: #808080;">&#0160;</span><span style="color: #0000ff;">=</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">newEnd</span><span style="color: #0000ff;">;</span></span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: small;"><span style="color: #000000;">grid.SetLeader(DatumEnds.End1,</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">view,</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">leader)</span><span style="color: #0000ff;">;</span></span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="color: #000000; font-size: small;">}</span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="color: #000000; font-size: small;">}</span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="color: #000000; font-size: small;">}</span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: small;"><span style="color: #0000ff;">if</span><span style="color: #000000;">(Document.IsModified)</span></span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: small;"><span style="color: #000000;">trans.Commit()</span><span style="color: #0000ff;">;</span></span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="color: #000000; font-size: small;">}</span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: small;"><span style="color: #0000ff;">catch</span><span style="color: #000000;">(</span><span style="color: #2b91af;">Exception</span><span style="color: #808080;">&#0160;</span><span style="color: #000000;">ex)</span></span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="color: #000000; font-size: small;">{</span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: small;"><span style="color: #000000;">trans.RollBack()</span><span style="color: #0000ff;">;</span></span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="color: #000000; font-size: small;">}</span><span style="color: #808080;"> <br /><span style="font-size: small;">&#0160;&#0160;&#0160; </span></span><span style="color: #000000; font-size: small;">}</span><span style="color: #808080;"> <br /></span><span style="color: #000000; font-size: small;">}</span></div>
<p>&#0160;</p>
<p>The file attached is saved by R2016R2 version. If running the macro the grid leaders don’t change, please click ‘edit’ button of the macro, compile it then run it again. ( Remember to enable the macro when opening the file.)</p>
<p>Check it out and let me know, hope this solves your question <img alt="Robot Happy" src="/assets/16x16_robot-happy.gif" title="Robot Happy" /></p>
<p>Thank you again for your patience and collaboration.</p>
<p>--------------------------------------------------</p>
<p>I’m still waiting for Erik to get back to me, but after testing the macro, I’m sure it will be something that you guys can benefit from. Cheers and until next time.</p>
