---
layout: "post"
title: "Use Navisworks API with WPF  - Create a .NET control application of WPF"
date: "2013-03-26 02:40:57"
author: "Xiaodong Liang"
categories:
  - ".NET"
  - "Navisworks"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/aec/2013/03/use-navisworks-api-with-wpf-create-a-net-control-application-of-wpf.html "
typepad_basename: "use-navisworks-api-with-wpf-create-a-net-control-application-of-wpf"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/aec/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>  <p>WPF is widely used nowadays. Navisworks .NET API supports it. I plan to write the posts to dig some useful cases with WPF. I’d also like to hear any of your suggestion or I’d appreciate if you could share your use case.</p>  <p>The first post is to demo how to create a .NET&#160; control application of WPF. Actually there are already 3 samples in SDK folder: &lt;Navisworks Installtation Path&gt;\api\net\examples\Basic Examples\CSharp\WPF. They are well written. In this post, I will analyzed the skeleton and introduce the basic steps to create such application. </p>  <p>Firstly, choose the template of <strong>WPF Application</strong>.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017c381d4d99970b-pi"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/assets/image_201792.jpg" width="362" height="374" /></a> </p>  <p>Next, add the two assemblies </p>  <p><em>Autodesk.Navisworks.Api     <br />Autodesk.Navisworks.Controls</em></p>  <p>Because .NET control of Navisworks is still a Windows Form control. It needs to be hosted in <strong>WindowsFormsHost.</strong> So we need to add one more assembly <em>WindowsFormsIntegration</em>.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017ee9c073e9970d-pi"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/assets/image_314062.jpg" width="266" height="421" /></a> </p>  <p>WPF allows you to design the interface flexibly. They are configured by the XAML file. If you open MainWindow.xaml file, you can see some default lines which are added by the VS template. On the basis of the lines, we will need to import the Navisworks assemblies and <em>WindowsFormsIntegration.&#160; e.g.</em></p>  <p><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: red"><span style="mso-spacerun: yes">&#160;</span>xmlns</span><span style="color: blue">:</span><span style="color: red">NwControls</span><span style="color: blue">=&quot;clr-namespace:Autodesk.Navisworks.Api.Controls;assembly=Autodesk.Navisworks.Controls&quot;</span>      <p></p>   </span></p>  <p>Next, add one button which will open the Navisworks file. And the .NET view control of Navisworks. </p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; color: #a31515; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes"></span></span><span style="font-family: nsimsun; color: blue; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">&lt;</span><span style="font-family: nsimsun; color: #a31515; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">WindowsFormsHost</span><span style="font-family: nsimsun; color: blue; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">&gt;</span><span style="font-family: nsimsun; color: #a31515; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"> </span><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">     <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; color: #a31515; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span></span><span style="font-family: nsimsun; color: blue; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">&lt;</span><span style="font-family: nsimsun; color: #a31515; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">NwControls</span><span style="font-family: nsimsun; color: blue; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">:</span><span style="font-family: nsimsun; color: #a31515; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">ViewControl</span><span style="font-family: nsimsun; color: red; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"> x</span><span style="font-family: nsimsun; color: blue; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">:</span><span style="font-family: nsimsun; color: red; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">Uid</span><span style="font-family: nsimsun; color: blue; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">=&quot;viewControl&quot;</span><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160; </span>      <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: red"><span style="mso-spacerun: yes">&#160;</span>x</span><span style="color: blue">:</span><span style="color: red">Name</span><span style="color: blue">=&quot;viewControl&quot;</span>       <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: red"><span style="mso-spacerun: yes">&#160;</span>Dock</span><span style="color: blue">=&quot;Fill&quot; /&gt;</span>      <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; color: blue; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">&lt;/</span><span style="font-family: nsimsun; color: #a31515; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">WindowsFormsHost</span><span style="font-family: nsimsun; color: blue; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">&gt;</span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; color: #bfbfbf; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-themecolor: background1; mso-themeshade: 191; mso-font-kerning: 0pt" lang="EN-US"></span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; color: #bfbfbf; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-themecolor: background1; mso-themeshade: 191; mso-font-kerning: 0pt" lang="EN-US"><font color="#000000" face="Trebuchet MS">Where <span style="color: red"><span style="mso-spacerun: yes">&#160;</span>x</span><span style="color: blue">:</span><span style="color: red">Name</span> is the name we could use behind the interface. The final XAML is as below. The default lines are marked in grey.</font></span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; color: #bfbfbf; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-themecolor: background1; mso-themeshade: 191; mso-font-kerning: 0pt" lang="EN-US"><font color="#000000" face="Trebuchet MS"></font></span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; color: #bfbfbf; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-themecolor: background1; mso-themeshade: 191; mso-font-kerning: 0pt" lang="EN-US">&lt;Window x:Class=&quot;WpfApplication1.MainWindow&quot;     <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; color: #bfbfbf; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-themecolor: background1; mso-themeshade: 191; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="mso-spacerun: yes">&#160;</span>xmlns=&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;      <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; color: #bfbfbf; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-themecolor: background1; mso-themeshade: 191; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="mso-spacerun: yes">&#160;</span>xmlns:x=&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;<span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>      <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; color: #bfbfbf; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-themecolor: background1; mso-themeshade: 191; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="mso-spacerun: yes">&#160;</span>Title=&quot;MainWindow&quot; Height=&quot;350&quot; Width=&quot;525&quot;      <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: red"><span style="mso-spacerun: yes">&#160;</span>xmlns</span><span style="color: blue">:</span><span style="color: red">NwApi</span><span style="color: blue">=&quot;clr-namespace:Autodesk.Navisworks.Api;assembly=Autodesk.Navisworks.Api&quot;</span>      <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: red"><span style="mso-spacerun: yes">&#160;</span>xmlns</span><span style="color: blue">:</span><span style="color: red">NwControls</span><span style="color: blue">=&quot;clr-namespace:Autodesk.Navisworks.Api.Controls;assembly=Autodesk.Navisworks.Controls&quot;</span>      <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: red"><span style="mso-spacerun: yes">&#160;</span>xmlns</span><span style="color: blue">:</span><span style="color: red">my</span><span style="color: blue">=&quot;clr-namespace:System.Windows.Forms.Integration;assembly=WindowsFormsIntegration&quot;</span><span style="color: red"> Closed</span><span style="color: blue">=&quot;Window_Closed&quot;&gt;</span>      <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">     <p>&#160;</p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; color: #a31515; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span></span><span style="font-family: nsimsun; color: blue; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">&lt;</span><span style="font-family: nsimsun; color: #a31515; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">DockPanel</span><span style="font-family: nsimsun; color: blue; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">&gt;</span><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">     <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; color: #a31515; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span></span><span style="font-family: nsimsun; color: blue; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">&lt;</span><span style="font-family: nsimsun; color: #a31515; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">Button</span><span style="font-family: nsimsun; color: red; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"> Content</span><span style="font-family: nsimsun; color: blue; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">=&quot;Open File&quot;</span><span style="font-family: nsimsun; color: red; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"> Height</span><span style="font-family: nsimsun; color: blue; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">=&quot;23&quot;</span><span style="font-family: nsimsun; color: red; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"> Name</span><span style="font-family: nsimsun; color: blue; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">=&quot;button1&quot;</span><span style="font-family: nsimsun; color: red; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"> Width</span><span style="font-family: nsimsun; color: blue; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">=&quot;75&quot;</span><span style="font-family: nsimsun; color: red; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"> Click</span><span style="font-family: nsimsun; color: blue; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">=&quot;button1_Click&quot; /&gt;</span><span style="font-family: nsimsun; color: #a31515; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"> </span><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">     <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; color: #a31515; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span></span><span style="font-family: nsimsun; color: blue; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">&lt;</span><span style="font-family: nsimsun; color: #a31515; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">WindowsFormsHost</span><span style="font-family: nsimsun; color: blue; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">&gt;</span><span style="font-family: nsimsun; color: #a31515; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"> </span><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">     <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; color: #a31515; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span></span><span style="font-family: nsimsun; color: blue; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">&lt;</span><span style="font-family: nsimsun; color: #a31515; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">NwControls</span><span style="font-family: nsimsun; color: blue; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">:</span><span style="font-family: nsimsun; color: #a31515; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">ViewControl</span><span style="font-family: nsimsun; color: red; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"> x</span><span style="font-family: nsimsun; color: blue; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">:</span><span style="font-family: nsimsun; color: red; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">Uid</span><span style="font-family: nsimsun; color: blue; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">=&quot;viewControl&quot;</span><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160; </span>      <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: red"><span style="mso-spacerun: yes">&#160;</span>x</span><span style="color: blue">:</span><span style="color: red">Name</span><span style="color: blue">=&quot;viewControl&quot;</span>       <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: red"><span style="mso-spacerun: yes">&#160;</span>Dock</span><span style="color: blue">=&quot;Fill&quot; /&gt;</span>      <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; color: #a31515; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span></span><span style="font-family: nsimsun; color: blue; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">&lt;/</span><span style="font-family: nsimsun; color: #a31515; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">WindowsFormsHost</span><span style="font-family: nsimsun; color: blue; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">&gt;</span><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">     <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; color: #a31515; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span></span><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">     <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; color: #a31515; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span></span><span style="font-family: nsimsun; color: blue; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">&lt;/</span><span style="font-family: nsimsun; color: #a31515; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">DockPanel</span><span style="font-family: nsimsun; color: blue; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">&gt;</span><span style="font-family: nsimsun; color: #a31515; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"> </span><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">     <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; color: #bfbfbf; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-themecolor: background1; mso-themeshade: 191; mso-font-kerning: 0pt" lang="EN-US">&lt;/Window&gt;</span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; color: #bfbfbf; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-themecolor: background1; mso-themeshade: 191; mso-font-kerning: 0pt" lang="EN-US">     <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">The last is to implement the code behind. As always, to work with the .NET control, we need to initialize the application control before the application runs, and terminate it after it is closed. So in the construction method of <span style="color: #2b91af">MainWindow</span> , we initialize the application, in the mean time, create a document control to bind with the view control. In Window_Closed, terminate application control.</p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">As to open file, it is very simple. Please refer to the code.</p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left">&#160;</p>  <p></p>  <p></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; color: blue; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">using</span><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"> Autodesk.Navisworks.Api.Controls;     <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">     <p>&#160;</p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; color: blue; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">namespace</span><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"> NwWPFControlApp     <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">{     <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span><span style="color: gray">///</span><span style="color: green"> </span><span style="color: gray">&lt;summary&gt;</span>      <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span><span style="color: gray">///</span><span style="color: green"> Interaction logic for MainWindow.xaml</span>      <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span><span style="color: gray">///</span><span style="color: green"> </span><span style="color: gray">&lt;/summary&gt;</span>      <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span><span style="color: blue">public</span> <span style="color: blue">partial</span> <span style="color: blue">class</span> <span style="color: #2b91af">MainWindow</span> : <span style="color: #2b91af">Window</span>      <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span>{      <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: #2b91af">DocumentControl</span> documentControl = <span style="color: blue">new</span> <span style="color: #2b91af">DocumentControl</span>();      <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: blue">public</span> MainWindow()      <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>{      <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: green">// initialize the control application</span>      <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: #2b91af">ApplicationControl</span>.Initialize();      <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>InitializeComponent();      <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>viewControl.DocumentControl = documentControl;      <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>}      <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">     <p>&#160;</p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: blue">private</span> <span style="color: blue">void</span> button1_Click(<span style="color: blue">object</span> sender, <span style="color: #2b91af">RoutedEventArgs</span> e)      <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>{      <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: green">//Dialog for selecting the Location of the file</span>      <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: #2b91af">OpenFileDialog</span> dlg = <span style="color: blue">new</span> <span style="color: #2b91af">OpenFileDialog</span>();      <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">     <p>&#160;</p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: green">//Ask user for file location</span>      <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: blue">if</span> (dlg.ShowDialog() == System.Windows.Forms.<span style="color: #2b91af">DialogResult</span>.OK)      <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>{      <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: green">//If the user has selected a valid location,</span>      <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: green">// then tell DocumentControl to open the file</span>      <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: green">//As DocumentCtrl is linked to ViewControl</span>      <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>documentControl.Document.TryOpenFile(dlg.FileName);      <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>}      <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>}      <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">     <p>&#160;</p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: blue">private</span> <span style="color: blue">void</span> Window_Closed(<span style="color: blue">object</span> sender, <span style="color: #2b91af">EventArgs</span> e)      <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>{      <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: green">// terminate the control application</span>      <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: #2b91af">ApplicationControl</span>.Terminate();      <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>}      <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span>}      <p></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 8pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">}     <p></p>   </span></p>  <p>&#160;</p>  <p>Build the program and run it. Our first WPF application was born! </p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017c381d4e20970b-pi"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/assets/image_96661.jpg" width="448" height="298" /></a> </p>  <p>&#160;</p>  <p>It looks OK, but we seem not find any difference with a Windows Form application. I am far from being an expert of WPF. As I understand, WPF could be looked as the successor of Windows Form, but the WPF <code>control </code>is extremely flexible. It allows for full visual customization.</p>  <p>In the next post, we will explore how to bind the model hierarchy to the treeview, which has full support for data binding.</p>
