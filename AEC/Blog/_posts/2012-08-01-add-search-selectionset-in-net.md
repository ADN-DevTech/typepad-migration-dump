---
layout: "post"
title: "Add search selectionset in .Net"
date: "2012-08-01 01:02:41"
author: "Xiaodong Liang"
categories:
  - ".NET"
  - "Navisworks"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/aec/2012/08/add-search-selectionset-in-net.html "
typepad_basename: "add-search-selectionset-in-net"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/aec/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>  <p>The construction method of SelectionSet provides the way to add a search object. Thus you can create the selectionset with the search. Following is a small demo code.</p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> AddSearchSelectionSetByNet()</span></p>    <p style="margin: 0px"><span style="line-height: 140%">{</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// create a search and conditions</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">Search</span><span style="line-height: 140%"> s = </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Search</span><span style="line-height: 140%">();</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">SearchCondition</span><span style="line-height: 140%"> sc = </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">SearchCondition</span><span style="line-height: 140%">.HasPropertyByDisplayName(</span><span style="line-height: 140%; color: #a31515">&quot;Element&quot;</span><span style="line-height: 140%">, </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;Category&quot;</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; s.SearchConditions.Add(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; sc.EqualValue(</span><span style="line-height: 140%; color: #2b91af">VariantData</span><span style="line-height: 140%">.FromDisplayString(</span><span style="line-height: 140%; color: #a31515">&quot;Walls&quot;</span><span style="line-height: 140%">)));</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">//set the selection to everything</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; s.Selection.SelectAll();</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; s.Locations = </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">SearchLocations</span><span style="line-height: 140%">.DescendantsAndSelf;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// create a selectionset with the search condition</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">SavedItem</span><span style="line-height: 140%"> newItem = </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">SelectionSet</span><span style="line-height: 140%">(s);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; newItem.DisplayName = </span><span style="line-height: 140%; color: #a31515">&quot;My Walls&quot;</span><span style="line-height: 140%">;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// add this selection set to selection set collection</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; Autodesk.Navisworks.Api.</span><span style="line-height: 140%; color: #2b91af">Application</span><span style="line-height: 140%">.ActiveDocument.</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; SelectionSets.InsertCopy(0, newItem);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">}</span></p> </div>
