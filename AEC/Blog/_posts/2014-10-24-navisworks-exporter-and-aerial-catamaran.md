---
layout: "post"
title: "Navisworks Exporter and Aerial Catamaran"
date: "2014-10-24 08:53:39"
author: "Jaime Rosales"
categories:
  - ".NET"
  - "Jaime Rosales"
  - "Navisworks"
  - "Revit"
  - "Revit Architecture"
  - "Revit MEP"
  - "Revit Structure"
original_url: "https://adndevblog.typepad.com/aec/2014/10/navisworks-exporter-and-aerial-catamaran.html "
typepad_basename: "navisworks-exporter-and-aerial-catamaran"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/aec/jaime-rosales.html">Jaime Rosales</a></p>
<p>In New York City you can start feeling the Fall weather and the Winter its starting to make its announcement that might be just around the corner, hopefully not another Polar Vortex year. Something that is keeping me warm are the memories from 2 weeks ago where I had the unique experience of taking some aerial pictures in the Island of Puerto Rico. Here is another one of my shots for you guys to enjoy and use as a background if you desire.</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01bb079eea63970d-pi"><img alt="G0020126" border="0" height="360" src="/assets/image_207254.jpg" style="display: inline; border-width: 0px;" title="G0020126" width="480" /></a>&#0160;</p>
<p>Back to Revit API, This week one case that caught my attention and got to work on came from our Autodesk Community Forum.</p>
<p><a href="http://forums.autodesk.com/t5/revit-api/navisworks-export/td-p/5345767" title="http://forums.autodesk.com/t5/revit-api/navisworks-export/td-p/5345767">http://forums.autodesk.com/t5/revit-api/navisworks-export/td-p/5345767</a></p>
<p><strong>Question</strong>: I was writing an add in that would export a NWC File to the location and file based on 2 parameters.</p>
<p>The actual code to export was working fine in 2014, but when built the code for 2015 the NWC export pop up dialog just hangs.</p>
<p>Is anyone aware of any changes the Document.Export() method that would make this not work on the newer version?</p>
<p><strong>Answer</strong>:I tried on both 2014 and 2015 rebuilt a small piece of code to do an export to NWC, both of them work, can you provide what you are trying to check it out ? also at the beginning I noticed that my Revit 2015 didn&#39;t have the export functionality available but I fixed that and after that the popup dialog does what it&#39;s supposed to and everything works fine.</p>
<p>Looking forward to hear from you so I can help.</p>
<p><strong>Response</strong>:The standard 2015 Exporter works from my Revit fine.</p>
<p>Here is trimmed code that I tried to get to work with no luck. It just hangs.</p>
<pre style="font-size: 13px; font-family: consolas; background: #1e1e1e; color: gainsboro;"> [<span style="color: #4ec9b0;">Transaction</span>(<span style="color: #b8d7a3;">TransactionMode</span><span style="color: #b4b4b4;">.</span><span style="color: white;">Manual</span>)]<br />&#0160; <span style="color: #569cd6;">public</span>&#0160;<span style="color: #569cd6;">class</span>&#0160;<span style="color: #4ec9b0;">Command</span> : <span style="color: #b8d7a3;">IExternalCommand</span><br />&#0160; {<br />&#0160;&#0160;&#0160; <span style="color: #569cd6;">public</span>&#0160;<span style="color: #b8d7a3;">Result</span>&#0160;<span style="color: white;">Execute</span>(<br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #4ec9b0;">ExternalCommandData</span>&#0160;<span style="color: white;">commandData</span>,<br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #569cd6;">ref</span>&#0160;<span style="color: #569cd6;">string</span>&#0160;<span style="color: white;">message</span>,<br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #4ec9b0;">ElementSet</span>&#0160;<span style="color: white;">elements</span>)<br />&#0160;&#0160;&#0160; {<br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #4ec9b0;">UIApplication</span>&#0160;<span style="color: white;">uiapp</span>&#0160;<span style="color: #b4b4b4;">=</span>&#0160;<span style="color: white;">commandData</span><span style="color: #b4b4b4;">.</span><span style="color: white;">Application</span>;<br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #4ec9b0;">UIDocument</span>&#0160;<span style="color: white;">uidoc</span>&#0160;<span style="color: #b4b4b4;">=</span>&#0160;<span style="color: white;">uiapp</span><span style="color: #b4b4b4;">.</span><span style="color: white;">ActiveUIDocument</span>;<br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #4ec9b0;">Application</span>&#0160;<span style="color: white;">app</span>&#0160;<span style="color: #b4b4b4;">=</span>&#0160;<span style="color: white;">uiapp</span><span style="color: #b4b4b4;">.</span><span style="color: white;">Application</span>;<br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #4ec9b0;">Document</span>&#0160;<span style="color: white;">doc</span>&#0160;<span style="color: #b4b4b4;">=</span>&#0160;<span style="color: white;">uidoc</span><span style="color: #b4b4b4;">.</span><span style="color: white;">Document</span>;<br /> <br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #608b4e;">//create NWExportOptions</span><br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #4ec9b0;">NavisworksExportOptions</span>&#0160;<span style="color: white;">nweOptions</span>&#0160;<span style="color: #b4b4b4;">=</span>&#0160;<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #569cd6;">new</span>&#0160;<span style="color: #4ec9b0;">NavisworksExportOptions</span>();<br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: white;">nweOptions</span><span style="color: #b4b4b4;">.</span><span style="color: white;">ExportScope</span>&#0160;<span style="color: #b4b4b4;">=</span>&#0160;<span style="color: #b8d7a3;">NavisworksExportScope</span><span style="color: #b4b4b4;">.</span><span style="color: white;">Model</span>;<br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: white;">nweOptions</span><span style="color: #b4b4b4;">.</span><span style="color: white;">ViewId</span>&#0160;<span style="color: #b4b4b4;">=</span>&#0160;<span style="color: white;">uidoc</span><span style="color: #b4b4b4;">.</span><span style="color: white;">ActiveView</span><span style="color: #b4b4b4;">.</span><span style="color: white;">Id</span>;<br /> <br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #608b4e;">// Modify document within a transaction</span><br /> <br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #569cd6;">using</span> (<span style="color: #4ec9b0;">Transaction</span>&#0160;<span style="color: white;">tx</span>&#0160;<span style="color: #b4b4b4;">=</span>&#0160;<span style="color: #569cd6;">new</span>&#0160;<span style="color: #4ec9b0;">Transaction</span>(<span style="color: white;">doc</span>))<br />&#0160;&#0160;&#0160;&#0160;&#0160; {<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: white;">tx</span><span style="color: #b4b4b4;">.</span><span style="color: white;">Start</span>(<span style="color: #d69d85;">&quot;Export&quot;</span>);<br /> <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: white;">doc</span><span style="color: #b4b4b4;">.</span><span style="color: white;">Export</span>(<span style="color: #d69d85;">@&quot;D:\Shared&quot;</span>, <span style="color: #d69d85;">@&quot;test.nwc&quot;</span>, <span style="color: white;">nweOptions</span>);<br /> <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: white;">tx</span><span style="color: #b4b4b4;">.</span><span style="color: white;">Commit</span>();<br />&#0160;&#0160;&#0160;&#0160;&#0160; }<br /> <br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #569cd6;">return</span>&#0160;<span style="color: #b8d7a3;">Result</span><span style="color: #b4b4b4;">.</span><span style="color: white;">Succeeded</span>;<br />&#0160;&#0160;&#0160; }<br />}</pre>
<p><strong>Answer From Revit Expert</strong>:I admit I am not very familiar with the implementation of the latest version of Navisworks Exported, but I am fairly familiar with the code the exported depends on. I&#39;ll make two suggestions that may (but may not) help:</p>
<ul>
<li>I believe transaction should not be needed. I am basing this on the fact that that underlying export code does not need one. However, it is possible (though strange) that the Navisworks exporter would require transaction for changes it may make to the mode.</li>
<li>I think the export works for 3D views only, but I suppose the Active one already is a 3D (otherwise I would expect an exception to be thrown).</li>
<li>Naturally, both ActiveDocument and ActiveView may be null and should be checked, but that is probably not the problem here,</li>
</ul>
<p><strong>Answer</strong>: As my colleague said, a Transaction might not be needed, I tested your code and removing it makes the exporter work, can you please try it and let us know if you are good to go.</p>
<p>Here is how your code looks now.</p>
<pre style="font-size: 13px; font-family: consolas; background: #1e1e1e; color: gainsboro;">&#0160;<span style="color: #569cd6;">public</span>&#0160;<span style="color: #b8d7a3;">Result</span>&#0160;<span style="color: white;">Execute</span>(<br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #4ec9b0;">ExternalCommandData</span>&#0160;<span style="color: white;">commandData</span>,<br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #569cd6;">ref</span>&#0160;<span style="color: #569cd6;">string</span>&#0160;<span style="color: white;">message</span>,<br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #4ec9b0;">ElementSet</span>&#0160;<span style="color: white;">elements</span>)<br />&#0160;&#0160;&#0160; {<br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #4ec9b0;">UIApplication</span>&#0160;<span style="color: white;">uiapp</span>&#0160;<span style="color: #b4b4b4;">=</span>&#0160;<span style="color: white;">commandData</span><span style="color: #b4b4b4;">.</span><span style="color: white;">Application</span>;<br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #4ec9b0;">UIDocument</span>&#0160;<span style="color: white;">uidoc</span>&#0160;<span style="color: #b4b4b4;">=</span>&#0160;<span style="color: white;">uiapp</span><span style="color: #b4b4b4;">.</span><span style="color: white;">ActiveUIDocument</span>;<br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #4ec9b0;">Application</span>&#0160;<span style="color: white;">app</span>&#0160;<span style="color: #b4b4b4;">=</span>&#0160;<span style="color: white;">uiapp</span><span style="color: #b4b4b4;">.</span><span style="color: white;">Application</span>;<br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #4ec9b0;">Document</span>&#0160;<span style="color: white;">doc</span>&#0160;<span style="color: #b4b4b4;">=</span>&#0160;<span style="color: white;">uidoc</span><span style="color: #b4b4b4;">.</span><span style="color: white;">Document</span>;<br /> <br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #608b4e;">//create NWExportOptions</span><br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #4ec9b0;">NavisworksExportOptions</span>&#0160;<span style="color: white;">nweOptions</span>&#0160;<span style="color: #b4b4b4;">=</span>&#0160;<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #569cd6;">new</span>&#0160;<span style="color: #4ec9b0;">NavisworksExportOptions</span>();<br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: white;">nweOptions</span><span style="color: #b4b4b4;">.</span><span style="color: white;">ExportScope</span>&#0160;<span style="color: #b4b4b4;">=</span>&#0160;<span style="color: #b8d7a3;">NavisworksExportScope</span><span style="color: #b4b4b4;">.</span><span style="color: white;">Model</span>;<br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: white;">nweOptions</span><span style="color: #b4b4b4;">.</span><span style="color: white;">ViewId</span>&#0160;<span style="color: #b4b4b4;">=</span>&#0160;<span style="color: white;">uidoc</span><span style="color: #b4b4b4;">.</span><span style="color: white;">ActiveView</span><span style="color: #b4b4b4;">.</span><span style="color: white;">Id</span>;<br />&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: white;">doc</span><span style="color: #b4b4b4;">.</span><span style="color: white;">Export</span>(<span style="color: #d69d85;">@&quot;D:\Shared&quot;</span>, <span style="color: #d69d85;">@&quot;test.nwc&quot;</span>, <span style="color: white;">nweOptions</span>);<br />&#0160;&#0160;&#0160;&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #569cd6;">return</span>&#0160;<span style="color: #b8d7a3;">Result</span><span style="color: #b4b4b4;">.</span><span style="color: white;">Succeeded</span>;<br />&#0160;&#0160;&#0160; }</pre>
<p><strong>Response</strong>: That worked.So something must have changed in the transaction class? The Export worked in 2014 inside of the transaction.Either way, doesn’t matter to me.Thank you very much!</p>
<p>&#0160;</p>
<p>Special thanks to Arnošt Löbel for the insight in this case.</p>
<p>Thanks for reading and until next time.</p>
