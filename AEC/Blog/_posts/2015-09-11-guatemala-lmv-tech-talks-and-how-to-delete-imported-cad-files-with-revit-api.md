---
layout: "post"
title: "Guatemala LMV Tech Talks and How to delete Imported CAD files with Revit API"
date: "2015-09-11 11:31:38"
author: "Jaime Rosales"
categories:
  - ".NET"
  - "Events"
  - "Jaime Rosales"
  - "Off-topic"
  - "Revit"
  - "Revit Architecture"
  - "Revit MEP"
  - "Revit Structure"
original_url: "https://adndevblog.typepad.com/aec/2015/09/guatemala-lmv-tech-talks-and-how-to-delete-imported-cad-files-with-revit-api.html "
typepad_basename: "guatemala-lmv-tech-talks-and-how-to-delete-imported-cad-files-with-revit-api"
typepad_status: "Publish"
---

<p><a href="http://adndevblog.typepad.com/aec/jaime-rosales.html">By Jaime Rosales</a> (@<a href="https://twitter.com/AfroJme">afrojme</a>)</p>  <p align="left">At the end of August I had the chance to go to my home country to continue the evangelism on Autodesk new Large Model Viewer web service API. Always with the desire to give back part of my experience and knowledge to my home country, I decided to reach out to my Tech contacts in order to make these talks possible and expand my network with the Guatemalan Tech enthusiasts. The response I got from 5 of the Top Universities in Guatemala was simply amazing. </p>  <p align="left">My Tech Evangelism tour started with <a href="https://twitter.com/hashtag/CampusTec?src=hash">#CampusTEC</a> and Universidad Del Valle, where I had the opportunity to share how the Web is changing, and how Autodesk believes that 3D web should be something that starts taking over, we are a big 3D CAD design and software company, the tools exist and seeing the beautiful CAD designs that get created, should be available in your Web. </p>  <p align="left">Later, during the week, I was made the opening Key note speaker at a great Tech Innovation Forum at Galileo University <a href="https://twitter.com/fit_gt/status/636597418516180992">#FITGT</a>, where I share my opinion and experience about Design, Education and 3D web, and how Design should be consider as one of the new pillars in education. With the many makers, we have around today, it just makes sense that these young enthusiasts get a head start shaping their minds to acquire great design skills and create new amazing things, in my opinion. A big thank you to <a href="https://twitter.com/osrodas007">Oscar Rodas</a>. <a href="https://twitter.com/ykro">Adrian Catalan</a>, <a href="https://twitter.com/mzaghi">Maria Zaghi</a> and <a href="https://twitter.com/iiiiMayUiiii">Yucely Beb</a> for making these talks possible.&#160; </p>  <blockquote>   <p align="left"><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01bb0870a8d3970d-pi"><img title="fit 13d" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; float: left; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="fit 13d" src="/assets/image_412754.jpg" width="234" align="left" height="234" /></a><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b7c7cc4ffa970b-pi"><img title="Fit 2" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="Fit 2" src="/assets/image_992679.jpg" width="306" height="234" /></a></p> </blockquote>  <p>After a successful day spending time with many innovators and makers from Guatemala, I went to Universidad Rafael Landivar, where an audience of 200 aspiring engineers (Mechanical, Civil, Software) were eager to learn about how to add their Inventor, Revit, AutoCAD models on their own website. Big thanks to <a href="https://twitter.com/Bobert87">Boris Ruiz</a> for the organization of this great group of students. </p>  <blockquote>   <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01bb0870a8d9970d-pi"><img title="url talk" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="url talk" src="/assets/image_13254.jpg" width="250" height="192" /></a><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b7c7cc4ffc970b-pi"><img title="uvg" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="uvg" src="/assets/image_251947.jpg" width="264" height="196" /></a></p> </blockquote>  <p>During my last days in Guatemala, I had the chance to meet with the Director of the new Computer Science department at Universidad Francisco Marroquin, where I had the chance to present the technology to 1st year students of the CS department and many have already started to reach out, eager to know how to make their Web 3D enabled. Thanks to <a href="https://twitter.com/litomd">Leonel Morales</a> for hosting me.</p>  <p>I see there is a lot of potential in Guatemala when it comes to the Tech Business, I will keep you up to date on how what I showed turns out. </p>  <p>---------------------------------------------------------------------------------------------</p>  <p>Ok, enough of my traveling and evangelism experience, back to the Revit API. This week I had a chance to work and play with a command that deletes the imported CAD from your Revit Project. Something that got addressed by Harry Mattison from Boost Your BIM blog back in 2013. After seeing his nice post on it, I was curious to check if everything he shared will still work with Revit 2016 and sure it did. </p>  <p>Here is the question in our Revit API forum, posted by Vinay.</p>  <p><strong>Question</strong>:Dear All,</p>  <p>Is there any possibilities of deleting imported cad through API.</p>  <p><strong>Answer by Dale Bartlett</strong>: I have used this successfully:</p>  <p>Credit: <a href="http://boostyourbim.wordpress.com/2013/01/12/delete-imported-dwg/">http://boostyourbim.wordpress.com/2013/01/12/delete-imported-dwg/</a></p>  <div class="code"><font color="#808080">&#160;</font><font color="#0000ff">public</font><font color="#808080">&#160;</font><font color="#0000ff">void</font><font color="#808080">&#160;</font><font color="#000000">DeleteImports</font><font color="#808080">&#160; <br />&#160;&#160;&#160;&#160; </font><font color="#000000">(Document</font><font color="#808080">&#160;</font><font color="#000000">doc,</font><font color="#808080">&#160;</font><font color="#0000ff">bool</font><font color="#808080">&#160;</font><font color="#000000">pblnIncludeLinks)</font><font color="#808080">&#160; <br />&#160;</font><font color="#000000">{</font><font color="#808080">&#160; <br />&#160;&#160;&#160;&#160; </font><font color="#0000ff">using</font><font color="#808080">&#160;</font><font color="#000000">(Transaction</font><font color="#808080">&#160;</font><font color="#000000">tr</font><font color="#808080">&#160;</font><font color="#0000ff">=</font><font color="#808080">&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><font color="#0000ff">new</font><font color="#808080">&#160;</font><font color="#000000">Transaction(doc,</font><font color="#808080"> &quot;DeleteImports&quot;</font><font color="#000000">))</font><font color="#808080">&#160; <br />&#160;&#160;&#160;&#160; </font><font color="#000000">{</font><font color="#808080">&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><font color="#000000">tr.Start()</font><font color="#0000ff">;</font><font color="#808080">&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><font color="#0000ff">foreach</font><font color="#808080">&#160;</font><font color="#000000">(ImportInstance</font><font color="#808080">&#160;</font><font color="#000000">ii</font><font color="#808080">&#160;</font><font color="#0000ff">in</font><font color="#808080">&#160;</font><font color="#0000ff">new</font><font color="#808080">&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><font color="#000000">FilteredElementCollector(doc).</font><font color="#808080">&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><font color="#000000">OfClass(</font><font color="#0000ff">typeof</font><font color="#000000">(ImportInstance)).</font><font color="#808080">&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><font color="#000000">Cast&lt;ImportInstance&gt;().</font><font color="#808080">&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><font color="#000000">Where(i</font><font color="#808080">&#160;</font><font color="#0000ff">=</font><font color="#000000">&gt;</font><font color="#808080">&#160;</font><font color="#000000">i.IsLinked</font><font color="#808080">&#160;</font><font color="#0000ff">==</font><font color="#808080">&#160;</font><font color="#000000">pblnIncludeLinks))</font><font color="#808080">&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><font color="#000000">{</font><font color="#808080">&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><font color="#000000">doc.Delete(ii.Id)</font><font color="#0000ff">;</font><font color="#808080">&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><font color="#000000">}</font><font color="#808080">&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><font color="#000000">tr.Commit()</font><font color="#0000ff">;</font><font color="#808080">&#160; <br />&#160;&#160;&#160;&#160; </font><font color="#000000">}</font><font color="#808080">&#160; <br />&#160;</font><font color="#000000">}</font><font color="#808080">&#160;</font> </div>  <p><strong>Adding to the Answer: </strong>The suggestion that Dale gave you is a great one, But I see that only works for Earlier versions of Revit 2013 and earlier probably. I read the source from where he got it and I noticed that the Author also recreated it for 2014. I tested myself using Revit 2015 and 2016 and it seems to be working fine with the imported CAD files. </p>  <p>Credit: <a href="https://boostyourbim.wordpress.com/2013/09/11/looped-deletion-of-elements-in-2014/&nbsp;">https://boostyourbim.wordpress.com/2013/09/11/looped-deletion-of-elements-in-2014/ </a></p>  <p>Here is how the Command looks. </p>  <div class="code"><font color="#0000ff">#region</font><font color="#000000"> Namespaces</font><font color="#808080">      <br /></font><font color="#0000ff">using</font><font color="#808080">&#160;</font><font color="#000000">System</font><font color="#0000ff">;</font><font color="#808080">      <br /></font><font color="#0000ff">using</font><font color="#808080">&#160;</font><font color="#000000">System.Collections.Generic</font><font color="#0000ff">;</font><font color="#808080">      <br /></font><font color="#0000ff">using</font><font color="#808080">&#160;</font><font color="#000000">System.Diagnostics</font><font color="#0000ff">;</font><font color="#808080">      <br /></font><font color="#0000ff">using</font><font color="#808080">&#160;</font><font color="#000000">Autodesk.Revit.ApplicationServices</font><font color="#0000ff">;</font><font color="#808080">      <br /></font><font color="#0000ff">using</font><font color="#808080">&#160;</font><font color="#000000">Autodesk.Revit.Attributes</font><font color="#0000ff">;</font><font color="#808080">      <br /></font><font color="#0000ff">using</font><font color="#808080">&#160;</font><font color="#000000">Autodesk.Revit.DB</font><font color="#0000ff">;</font><font color="#808080">      <br /></font><font color="#0000ff">using</font><font color="#808080">&#160;</font><font color="#000000">Autodesk.Revit.UI</font><font color="#0000ff">;</font><font color="#808080">      <br /></font><font color="#0000ff">using</font><font color="#808080">&#160;</font><font color="#000000">Autodesk.Revit.UI.Selection</font><font color="#0000ff">;</font><font color="#808080">      <br /></font><font color="#0000ff">using</font><font color="#808080">&#160;</font><font color="#000000">System.Linq</font><font color="#0000ff">;</font><font color="#808080">      <br /></font><font color="#0000ff">#endregion</font><font color="#808080">      <br />      <br /></font><font color="#0000ff">namespace</font><font color="#808080">&#160;</font><font color="#000000">testDebug</font><font color="#808080">      <br /></font><font color="#000000">{</font><font color="#808080">      <br />&#160;</font><font color="#000000">[Transaction(TransactionMode.Manual)]</font><font color="#808080">      <br />&#160;</font><font color="#0000ff">public</font><font color="#808080">&#160;</font><font color="#0000ff">class</font><font color="#808080">&#160;</font><font color="#000000">Command</font><font color="#808080">&#160;</font><font color="#000000">:</font><font color="#808080">&#160;</font><font color="#000000">IExternalCommand</font><font color="#808080">      <br />&#160;</font><font color="#000000">{</font><font color="#808080">      <br />&#160; </font><font color="#0000ff">public</font><font color="#808080">&#160;</font><font color="#000000">Result</font><font color="#808080">&#160;</font><font color="#000000">Execute(</font><font color="#808080">      <br />&#160;&#160;&#160; </font><font color="#000000">ExternalCommandData</font><font color="#808080">&#160;</font><font color="#000000">commandData,</font><font color="#808080">      <br />&#160;&#160;&#160; </font><font color="#0000ff">ref</font><font color="#808080">&#160;</font><font color="#0000ff">string</font><font color="#808080">&#160;</font><font color="#000000">message,</font><font color="#808080">      <br />&#160;&#160;&#160; </font><font color="#000000">ElementSet</font><font color="#808080">&#160;</font><font color="#000000">elements)</font><font color="#808080">      <br />&#160; </font><font color="#000000">{</font><font color="#808080">      <br />&#160;&#160;&#160; </font><font color="#000000">UIApplication</font><font color="#808080">&#160;</font><font color="#000000">uiapp</font><font color="#808080">&#160;</font><font color="#0000ff">=</font><font color="#808080">&#160;</font><font color="#000000">commandData.</font><font color="#2b91af">Application</font><font color="#0000ff">;</font><font color="#808080">      <br />&#160;&#160;&#160; </font><font color="#000000">UIDocument</font><font color="#808080">&#160;</font><font color="#000000">uidoc</font><font color="#808080">&#160;</font><font color="#0000ff">=</font><font color="#808080">&#160;</font><font color="#000000">uiapp.ActiveUIDocument</font><font color="#0000ff">;</font><font color="#808080">      <br />&#160;&#160;&#160; </font><font color="#2b91af">Application</font><font color="#808080">&#160;</font><font color="#000000">app</font><font color="#808080">&#160;</font><font color="#0000ff">=</font><font color="#808080">&#160;</font><font color="#000000">uiapp.</font><font color="#2b91af">Application</font><font color="#0000ff">;</font><font color="#808080">      <br />&#160;&#160;&#160; </font><font color="#000000">Document</font><font color="#808080">&#160;</font><font color="#000000">doc</font><font color="#808080">&#160;</font><font color="#0000ff">=</font><font color="#808080">&#160;</font><font color="#000000">uidoc.Document</font><font color="#0000ff">;</font><font color="#808080">      <br />      <br />&#160;&#160;&#160; </font><font color="#000000">deleteImportsNotLinks(doc)</font><font color="#0000ff">;</font><font color="#808080">&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160; </font><font color="#0000ff">return</font><font color="#808080">&#160;</font><font color="#000000">Result.Succeeded</font><font color="#0000ff">;</font><font color="#808080">      <br />&#160; </font><font color="#000000">}</font><font color="#808080">      <br />      <br />&#160;</font><font color="#0000ff">public</font><font color="#808080">&#160;</font><font color="#0000ff">void</font><font color="#808080">&#160;</font><font color="#000000">deleteImportsNotLinks(Document</font><font color="#808080">&#160;</font><font color="#000000">doc)</font><font color="#808080">      <br />&#160; </font><font color="#000000">{</font><font color="#808080">&#160; <br />&#160;&#160;&#160; </font><font color="#2b91af">IList</font><font color="#000000">&lt;ElementId&gt;</font><font color="#808080">&#160;</font><font color="#000000">toDelete</font><font color="#808080">&#160;</font><font color="#0000ff">=</font><font color="#808080">&#160;</font><font color="#0000ff">new</font><font color="#808080">&#160;</font><font color="#2b91af">List</font><font color="#000000">&lt;ElementId&gt;()</font><font color="#0000ff">;</font><font color="#808080">      <br />&#160;&#160;&#160; </font><font color="#0000ff">foreach</font><font color="#808080">&#160;</font><font color="#000000">(ImportInstance</font><font color="#808080">&#160;</font><font color="#000000">ii</font><font color="#808080">&#160;</font><font color="#0000ff">in</font><font color="#808080">&#160;</font><font color="#0000ff">new</font><font color="#808080">&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><font color="#000000">FilteredElementCollector(doc)</font><font color="#808080">      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><font color="#000000">.OfClass(</font><font color="#0000ff">typeof</font><font color="#000000">(ImportInstance))</font><font color="#808080">      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><font color="#000000">.Cast&lt;ImportInstance&gt;()</font><font color="#808080">      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><font color="#000000">.Where(i</font><font color="#808080">&#160;</font><font color="#0000ff">=</font><font color="#000000">&gt;</font><font color="#808080">&#160;</font><font color="#000000">i.IsLinked</font><font color="#808080">&#160;</font><font color="#0000ff">==</font><font color="#808080">&#160;</font><font color="#0000ff">false</font><font color="#000000">))</font><font color="#808080">      <br />&#160;&#160;&#160; </font><font color="#000000">{</font><font color="#808080">      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><font color="#000000">toDelete.Add(ii.Id)</font><font color="#0000ff">;</font><font color="#808080">      <br />&#160;&#160;&#160; </font><font color="#000000">}</font><font color="#808080">      <br />&#160;&#160;&#160; </font><font color="#0000ff">using</font><font color="#808080">&#160;</font><font color="#000000">(Transaction</font><font color="#808080">&#160;</font><font color="#000000">t</font><font color="#808080">&#160;</font><font color="#0000ff">=</font><font color="#808080">&#160;</font><font color="#0000ff">new</font><font color="#808080">&#160;</font><font color="#000000">Transaction</font><font color="#808080">      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><font color="#000000">(doc,</font><font color="#808080"> &quot;Delete Imports&quot;</font><font color="#000000">))</font><font color="#808080">      <br />&#160;&#160;&#160; </font><font color="#000000">{</font><font color="#808080">      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><font color="#000000">t.Start()</font><font color="#0000ff">;</font><font color="#808080">      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><font color="#000000">doc.Delete(toDelete)</font><font color="#0000ff">;</font><font color="#808080">      <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><font color="#000000">t.Commit()</font><font color="#0000ff">;</font><font color="#808080">      <br />&#160;&#160;&#160; </font><font color="#000000">}</font><font color="#808080">      <br />&#160; </font><font color="#000000">}</font> </div>  <div class="code">&#160;</div>  <div class="code">Thank you for reading and until next time. </div>
