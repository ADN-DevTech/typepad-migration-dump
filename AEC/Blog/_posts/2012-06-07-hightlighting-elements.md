---
layout: "post"
title: "Hightlighting elements"
date: "2012-06-07 02:44:38"
author: "Katsuaki Takamizawa"
categories: []
original_url: "https://adndevblog.typepad.com/aec/2012/06/hightlighting-elements.html "
typepad_basename: "hightlighting-elements"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/aec/katsuaki-takamizawa.html" target="_self">Katsuaki Takamizawa</a></p> <p>If you select an element in a mouse cursor in Revit UI, the color of the element will be highlighted with light blue color. You can mimic the same effect in API. It is easy to do it . But strangely it took for a while for me to find it. So I would like to share this with you here.</p> <p>Here is a simple code selecting an element and highlighting it.</p> <p><font face="ＭＳ ゴシック"><span><font color="#0000ff"><font style="font-size: 7.8pt">public</font></font></span><font style="font-size: 7.8pt"><font color="#000000">&nbsp;</font><span><font color="#2b91af">Result</font></span></font></font><font style="font-size: 7.8pt"><font face="ＭＳ ゴシック"><font color="#000000"> Execute(<br>&nbsp;&nbsp;&nbsp; </font><span><font color="#2b91af">ExternalCommandData</font></span></font><font face="ＭＳ ゴシック"><font color="#000000"> commandData,<br>&nbsp;&nbsp;&nbsp; </font><span><font color="#0000ff">ref</font></span><font color="#000000">&nbsp;</font><span><font color="#0000ff">string</font></span></font><font face="ＭＳ ゴシック"><font color="#000000"> message,<br>&nbsp;&nbsp;&nbsp; </font><span><font color="#2b91af">ElementSet</font></span></font><font face="ＭＳ ゴシック"><font color="#000000"> elements)<br>{<br>&nbsp; </font><span><font color="#2b91af">UIApplication</font></span></font><font face="ＭＳ ゴシック"><font color="#000000"> uiapp = commandData.Application;<br>&nbsp; </font><span><font color="#2b91af">UIDocument</font></span></font><font face="ＭＳ ゴシック"><font color="#000000"> uidoc = uiapp.ActiveUIDocument;<br>&nbsp; </font><span><font color="#2b91af">Application</font></span></font><font face="ＭＳ ゴシック"><font color="#000000"> app = uiapp.Application;<br>&nbsp; </font><span><font color="#2b91af">Document</font></span></font><font face="ＭＳ ゴシック"><font color="#000000"> doc = uidoc.Document;<br> <br>&nbsp; </font><span><font color="#008000">// Select an element</font></span><br><font color="#000000">&nbsp; </font><span><font color="#008000">//</font></span><br><font color="#000000">&nbsp; </font><span><font color="#2b91af">Reference</font></span></font><font face="ＭＳ ゴシック"><font color="#000000"> r = uidoc.Selection.PickObject (</font><span><font color="#2b91af">ObjectType</font></span><font color="#000000">.Element, </font><span><font color="#a31515">"Select an element"</font></span></font><font face="ＭＳ ゴシック"><font color="#000000">);<br> <br>&nbsp; </font><span><font color="#2b91af">Element</font></span></font><font face="ＭＳ ゴシック"><font color="#000000"> elem= uidoc.Document.GetElement(r);<br> <br>&nbsp; </font><span><font color="#008000">// Add the element to the selection set to highlight it</font></span><br><font color="#000000">&nbsp; </font><span><font color="#008000">//</font></span><br></font></font><font face="ＭＳ ゴシック"><font style="font-size: 7.8pt"><font color="#000000">&nbsp; uidoc.Selection.Elements.Add(elem);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp; </font><span><font color="#0000ff">return</font></span><font color="#000000">&nbsp;</font><span><font color="#2b91af">Result</font></span><font color="#000000">.Succeeded;<br>}</font></font></font></p><pre style="line-height: normal; font-family: ; background: white">&nbsp;</pre><pre style="line-height: normal; font-family: ; background: white"><font color="#000000" face="ＭＳ ゴシック"></font>&nbsp;</pre>
