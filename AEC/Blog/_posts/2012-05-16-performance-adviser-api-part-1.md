---
layout: "post"
title: "Performance Adviser API &ndash; Part 1"
date: "2012-05-16 08:00:00"
author: "Saikat Bhattacharya"
categories:
  - ".NET"
  - "Revit"
  - "Saikat Bhattacharya"
original_url: "https://adndevblog.typepad.com/aec/2012/05/performance-adviser-api-part-1.html "
typepad_basename: "performance-adviser-api-part-1"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/aec/saikat-bhattacharya.html" target="_self">Saikat Bhattacharya</a></p>  <p>Performance Adviser API, added in Autodesk® Revit® 2012 product, allows developers to execute a set of built-in or custom rules against a given model, and to display a warning dialog about the elements that fail to satisfy the rules. You can use this feature to flag the user about possible performance degradations, and to create your own rules that could be run on a model to check for adherence to certain design guidelines. For example, you may want to signal the user where walls may be overlapping.</p>  <p>In this post and the subsequent ones, we’ll look at this API, and discuss how to gain access to the performance adviser rules, how to execute the rules, and how to define custom rules. </p>  <p><strong><em>Listing performance adviser rules </em></strong></p>  <p>The performance adviser rules are a set of application-wide rules. To work with performance adviser rules, we use an application-wide, singleton class called PerformanceAdviser. This class is a “registry” of all the performance checking rules as well as an engine to execute the rules. You can access the singleton PerformanceAdviser instance using a PerformanceAdviser.GetPerformanceAdviser()static method.</p>  <p>Once we have access to the PerformanceAdviser object, we can use the GetAllRuleIds() method to obtain a list of rule IDs registered in the application. We can then iterate through each rule ID and get the rule information for the corresponding rule ID, using the methods, such as GetRuleName() and GetRuleDescription().</p>  <p>The following command illustrates how to list all the registered performance adviser: </p>  <div style="background: white">   <p style="margin: 0px"><span style="font-family: courier new"><font size="1"><span style="line-height: 11pt"><span style="color: #0000ff"><span>using</span></span></span><span style="line-height: 11pt"><span style="color: #000000"> System;</span></span></font></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><font size="1"><span style="line-height: 11pt"><span style="color: #0000ff"><span>using</span></span></span><span style="line-height: 11pt"><span style="color: #000000"> System.Collections.Generic;</span></span></font></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><font size="1"><span style="line-height: 11pt"><span style="color: #0000ff"><span>using</span></span></span><span style="line-height: 11pt"><span style="color: #000000"> System.Linq;</span></span></font></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><font size="1"><span style="line-height: 11pt"><span style="color: #0000ff"><span>using</span></span></span><span style="line-height: 11pt"><span style="color: #000000"> System.Text;</span></span></font></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="color: #000000"><font size="1">&#0160;</font></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><font size="1"><span style="line-height: 11pt"><span style="color: #0000ff"><span>using</span></span></span><span style="line-height: 11pt"><span style="color: #000000"> Autodesk.Revit.UI;</span></span></font></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><font size="1"><span style="line-height: 11pt"><span style="color: #0000ff"><span>using</span></span></span><span style="line-height: 11pt"><span style="color: #000000"> Autodesk.Revit.DB;</span></span></font></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><font size="1"><span style="line-height: 11pt"><span style="color: #0000ff"><span>using</span></span></span><span style="line-height: 11pt"><span style="color: #000000"> Autodesk.Revit.Attributes;</span></span></font></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="color: #000000"><font size="1">&#0160;</font></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><font size="1"><span style="line-height: 11pt"><span style="color: #0000ff"><span>namespace</span></span></span><span style="line-height: 11pt"><span style="color: #000000"> PASample</span></span></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000"><font size="1">{</font></span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="color: #000000"><font size="1">&#0160;</font></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><font size="1"><span style="line-height: 11pt"><span style="color: #000000"><span>&#0160; [</span></span></span><span><span style="line-height: 11pt"><span style="color: #2b91af">Transaction</span></span><span style="line-height: 11pt"><span style="color: #000000">(</span></span><span style="line-height: 11pt"><span style="color: #2b91af">TransactionMode</span></span></span><span style="line-height: 11pt"><span style="color: #000000">.Manual)]</span></span></font></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><font size="1"><span style="line-height: 11pt"><span style="color: #000000"><span>&#0160; </span></span></span><span><span style="line-height: 11pt"><span style="color: #0000ff">public</span></span><span style="line-height: 11pt"><span style="color: #000000"> </span></span><span style="line-height: 11pt"><span style="color: #0000ff">class</span></span><span style="line-height: 11pt"><span style="color: #000000"> </span></span><span style="line-height: 11pt"><span style="color: #2b91af">ListPerformanceAdviserRules</span></span><span style="line-height: 11pt"><span style="color: #000000">: </span></span></span><span style="line-height: 11pt"><span style="color: #2b91af">IExternalCommand</span></span></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000"><font size="1">&#0160; {</font></span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="color: #000000"><font size="1">&#0160;</font></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><font size="1"><span style="line-height: 11pt"><span style="color: #000000"><span>&#0160;&#0160;&#0160; </span></span></span><span><span style="line-height: 11pt"><span style="color: #0000ff">public</span></span><span style="line-height: 11pt"><span style="color: #000000"> Autodesk.Revit.UI.</span></span><span style="line-height: 11pt"><span style="color: #2b91af">Result</span></span><span style="line-height: 11pt"><span style="color: #000000"> Execute(</span></span><span style="line-height: 11pt"><span style="color: #2b91af">ExternalCommandData</span></span></span><span style="line-height: 11pt"><span style="color: #000000"> </span></span></font></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><font size="1"><span style="line-height: 11pt"><span style="color: #000000"><span>&#0160;&#0160;&#0160;&#0160;&#0160; commandData, </span></span></span><span><span style="line-height: 11pt"><span style="color: #0000ff">ref</span></span><span style="line-height: 11pt"><span style="color: #000000"> </span></span><span style="line-height: 11pt"><span style="color: #0000ff">string</span></span><span style="line-height: 11pt"><span style="color: #000000"> message, </span></span><span style="line-height: 11pt"><span style="color: #2b91af">ElementSet</span></span></span><span style="line-height: 11pt"><span style="color: #000000"> elements)</span></span></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000"><font size="1">&#0160;&#0160;&#0160;&#0160;&#0160; {</font></span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><font size="1"><span style="line-height: 11pt"><span style="color: #000000"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt"><span style="color: #008000">// Get access to PerformanceAdviser object</span></span></font></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><font size="1"><span style="line-height: 11pt"><span style="color: #000000"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="line-height: 11pt"><span style="color: #2b91af">PerformanceAdviser</span></span></span><span style="line-height: 11pt"><span style="color: #000000"> adviser = </span></span></font></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><font size="1"><span style="line-height: 11pt"><span style="color: #000000"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="line-height: 11pt"><span style="color: #2b91af">PerformanceAdviser</span></span></span><span style="line-height: 11pt"><span style="color: #000000">.GetPerformanceAdviser();</span></span></font></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><font size="1"><span style="line-height: 11pt"><span style="color: #000000"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt"><span style="color: #008000">// Get access to the rules in the PerformanceAdviser object</span></span></font></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><font size="1"><span style="line-height: 11pt"><span style="color: #000000"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="line-height: 11pt"><span style="color: #2b91af">IList</span></span><span style="line-height: 11pt"><span style="color: #000000">&lt;</span></span><span style="line-height: 11pt"><span style="color: #2b91af">PerformanceAdviserRuleId</span></span></span><span style="line-height: 11pt"><span style="color: #000000">&gt; ruleIds = </span></span></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000"><font size="1">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; adviser.GetAllRuleIds();&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </font></span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="color: #000000"><font size="1">&#0160;</font></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><font size="1"><span style="line-height: 11pt"><span style="color: #000000"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="line-height: 11pt"><span style="color: #2b91af">String</span></span><span style="line-height: 11pt"><span style="color: #000000"> ruleInfo = </span></span><span style="line-height: 11pt"><span style="color: #2b91af">String</span></span></span><span style="line-height: 11pt"><span style="color: #000000">.Empty;</span></span></font></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><font size="1"><span style="line-height: 11pt"><span style="color: #000000"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt"><span style="color: #008000">// Loop through each rule Id and get rule name, description</span></span></font></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><font size="1"><span style="line-height: 11pt"><span style="color: #000000"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="line-height: 11pt"><span style="color: #0000ff">foreach</span></span><span style="line-height: 11pt"><span style="color: #000000"> (</span></span><span style="line-height: 11pt"><span style="color: #2b91af">PerformanceAdviserRuleId</span></span><span style="line-height: 11pt"><span style="color: #000000"> ruleId </span></span><span style="line-height: 11pt"><span style="color: #0000ff">in</span></span></span><span style="line-height: 11pt"><span style="color: #000000"> ruleIds)</span></span></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000"><font size="1">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</font></span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><font size="1"><span style="line-height: 11pt"><span style="color: #000000"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ruleInfo = ruleInfo + </span></span></span><span><span style="line-height: 11pt"><span style="color: #a31515">&quot;\n&quot;</span></span></span><span style="line-height: 11pt"><span style="color: #000000"> + adviser.GetRuleName(ruleId) </span></span></font></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><font size="1"><span style="line-height: 11pt"><span style="color: #000000"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; + </span></span></span><span><span style="line-height: 11pt"><span style="color: #a31515">&quot; : &quot;</span></span></span><span style="line-height: 11pt"><span style="color: #000000"> + adviser.GetRuleDescription(ruleId);</span></span></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000"><font size="1">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</font></span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="color: #000000"><font size="1">&#0160;</font></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><font size="1"><span style="line-height: 11pt"><span style="color: #000000"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="line-height: 11pt"><span style="color: #2b91af">TaskDialog</span></span><span style="line-height: 11pt"><span style="color: #000000">.Show(</span></span><span style="line-height: 11pt"><span style="color: #a31515">&quot;Existing Rules Info&quot;</span></span></span><span style="line-height: 11pt"><span style="color: #000000">, ruleInfo);&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></font></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><font size="1"><span style="line-height: 11pt"><span style="color: #000000"><span>&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="line-height: 11pt"><span style="color: #0000ff">return</span></span><span style="line-height: 11pt"><span style="color: #000000"> </span></span><span style="line-height: 11pt"><span style="color: #2b91af">Result</span></span></span><span style="line-height: 11pt"><span style="color: #000000">.Succeeded;</span></span></font></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000"><font size="1">&#0160;&#0160;&#0160;&#0160;&#0160; }&#0160;&#0160;&#0160; </font></span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000"><font size="1">&#0160;&#0160;&#0160; }</font></span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000"><font size="1">}</font></span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt">&#0160;</span></p>    <p style="margin: 0px"><span style="line-height: 11pt">In the subsequent post, we shall look at executing a rule.</span></p> </div>
