---
layout: "post"
title: "Navisworks .NET API 2013 new feature &ndash; saved viewpoint"
date: "2012-06-17 07:56:01"
author: "Xiaodong Liang"
categories: []
original_url: "https://adndevblog.typepad.com/aec/2012/06/navisworks-net-api-2013-new-feature-saved-viewpoint.html "
typepad_basename: "navisworks-net-api-2013-new-feature-saved-viewpoint"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/aec/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>  <p>Saved Viewpoint presets views of the model. It enables to jump to viewpoints without having to navigate each time to reach an item. The saved viewpoints could be orignized within a folder. A folder could contain sub-folder. A saved viewpoint could also be a animation clip. Each element is a saved viewpoint. </p>  <p>2013 .NET API provides the following objects:</p>  <p><em>Document.SavedViewpoints</em>: the saved viewpoints collection of a document.</p> <em>SavedViewpoint</em>: The object derives from GroupItem. It could be a specific saved viewpoint, or a folder (FolderItem), or the animation clips ( SavedViewpointAnimation)   <p><em>SavedViewpoints.CurrentSavedViewpoint:</em> The object can know&#160; which saved viewpoint is displayed currently. Any view changes manually will cause it be null- anonymous viewpoint. </p>  <p>The code iterates the saved view collection. The code below dumps all saved viewpoints and switch current saved viewpoint to one whose name is “mysavedviewpoint1”.</p>  <p>&#160;</p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="color: blue">void</span> savedVPs()</p>    <p style="margin: 0px">{</p>    <p style="margin: 0px"><span style="color: #2b91af">Document</span> oDoc = </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; Autodesk.Navisworks.Api.<span style="color: #2b91af">Application</span>.ActiveDocument;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: green">// the saved viewpoint we will set it to current</span></p>    <p style="margin: 0px"><span style="color: #2b91af">SavedViewpoint</span> oSVP_to_SetCurrent = <span style="color: blue">null</span>; </p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: green">// iterate the collection of saved viewpoints</span></p>    <p style="margin: 0px"><span style="color: blue">foreach</span> (<span style="color: #2b91af">SavedItem</span> oSVP <span style="color: blue">in</span> </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oDoc.SavedViewpoints.Value)</p>    <p style="margin: 0px">{</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">// if it is a folder/animation&#160; </span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> (oSVP.IsGroup)&#160; </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; recurse(oSVP);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">else</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// Access the properties of the saved </span></p>    <p style="margin: 0px"><span style="color: green">&#160;&#160;&#160;&#160;&#160;&#160;&#160; //viewpoint&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">SavedViewpoint</span> oThisSVP =</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oSVP <span style="color: blue">as</span> <span style="color: #2b91af">SavedViewpoint</span>;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span>(oThisSVP != <span style="color: blue">null</span>)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">Debug</span>.Print(<span style="color: #a31515">&quot;Display Name&quot;</span> + </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oThisSVP.DisplayName);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #2b91af">Viewpoint</span> oVP = </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oThisSVP.Viewpoint;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// dump the properties of Viewpoint</span></p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// ......</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span>(oThisSVP.DisplayName == </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #a31515">&quot;mysavedviewpoint1&quot;</span>)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oSVP_to_SetCurrent = oThisSVP;</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</p>    <p style="margin: 0px">}</p>    <p style="margin: 0px"><span style="color: green">// current selected saved viewpoint</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #2b91af">SavedViewpoint</span> oCurViewPt =</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oDoc.SavedViewpoints.CurrentSavedViewpoint </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">as</span> <span style="color: #2b91af">SavedViewpoint</span>;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #2b91af">Viewpoint</span> oCurrentVP = </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oCurViewPt.Viewpoint;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">// dump the properties of current Viewpoint</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">// ......</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">// switch the current viewpoint to &quot;myviewpoint1&quot;</span></p>    <p style="margin: 0px">&#160;&#160;&#160; oDoc.SavedViewpoints.CurrentSavedViewpoint = </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oSVP_to_SetCurrent;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">}</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="color: blue">void</span> recurse(<span style="color: #2b91af">SavedItem</span> oFolder)</p>    <p style="margin: 0px">{</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: blue">foreach</span> (<span style="color: #2b91af">SavedViewpoint</span> oSVP <span style="color: blue">in</span> ((<span style="color: #2b91af">GroupItem</span>)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oFolder).Children)</p>    <p style="margin: 0px">&#160;&#160;&#160; {</p>    <p style="margin: 0px"><span style="color: green">&#160; // if it is a folder/animation&#160; </span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">if</span> (oSVP.IsGroup)</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; recurse(oSVP);</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; else</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; {</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: green">// Access the properties of the saved </span></p>    <p style="margin: 0px"><span style="color: green">&#160;&#160;&#160;&#160;&#160;&#160;&#160; //viewpoint&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</p>    <p style="margin: 0px">&#160;&#160;&#160; }</p>    <p style="margin: 0px">}</p> </div> The code below creates two saved viewpooints. One is copied from current viewpoint. The other moves the current viewpoint along X axis with value 10. And the code creates one folder and adds the first saved viewpoint to the folder. The other viewpoints is added directly to the saved viewpoints collection.  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="color: blue">void</span> createSavedVP_Folder()</p>    <p style="margin: 0px">{</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #2b91af">Document</span> oDoc =</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; Autodesk.Navisworks.Api.<span style="color: #2b91af">Application</span>.ActiveDocument;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">// Create a saved viewpoint with current viewpoint</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #2b91af">SavedViewpoint</span> oNewViewPt1 =</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">new</span> <span style="color: #2b91af">SavedViewpoint</span>(</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oDoc.CurrentViewpoint.ToViewpoint());</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; oNewViewPt1.DisplayName = <span style="color: #a31515">&quot;MySavedView1&quot;</span>;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">// Create a viewpoint for the </span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">// second saved viewpoint</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #2b91af">Viewpoint</span> oNewVP = <span style="color: blue">new</span> <span style="color: #2b91af">Viewpoint</span>();</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">// Based on the current viewpoint,</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">// move camera along X+ with value 10</span></p>    <p style="margin: 0px">&#160;&#160;&#160; oNewVP =</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; oDoc.CurrentViewpoint.ToViewpoint().CreateCopy();</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #2b91af">Point3D</span> oNewPos =</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">new</span> <span style="color: #2b91af">Point3D</span>(oNewVP.Position.X + 10,</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oNewVP.Position.Y,</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oNewVP.Position.Z);</p>    <p style="margin: 0px">&#160;&#160;&#160; oNewVP.Position = oNewPos;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">// Create the saved viewpoint </span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">// with the new viewpoint</span></p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #2b91af">SavedViewpoint</span> oNewViewPt2 =</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">new</span> <span style="color: #2b91af">SavedViewpoint</span>(oNewVP);</p>    <p style="margin: 0px">&#160;&#160;&#160; oNewViewPt2.DisplayName =</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #a31515">&quot;MySavedView2&quot;</span>;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">// Add the saved viewpoints to the collection </span></p>    <p style="margin: 0px">&#160;&#160;&#160; oDoc.SavedViewpoints.AddCopy(oNewViewPt1);</p>    <p style="margin: 0px">&#160;&#160;&#160; oDoc.SavedViewpoints.AddCopy(oNewViewPt2);</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: #2b91af">FolderItem</span> oNewViewPtFolder1 =</p>    <p style="margin: 0px">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: blue">new</span> <span style="color: #2b91af">FolderItem</span>();</p>    <p style="margin: 0px">&#160;&#160;&#160; oNewViewPtFolder1.DisplayName = <span style="color: #a31515">&quot;Group1&quot;</span>;</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">// put the saved viewpoint1 to group1</span></p>    <p style="margin: 0px">&#160;&#160;&#160; oNewViewPtFolder1.Children.Add(oNewViewPt1);</p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">// add the group</span></p>    <p style="margin: 0px">&#160;&#160;&#160; oDoc.SavedViewpoints.AddCopy(oNewViewPtFolder1);</p>    <p style="margin: 0px">&#160;&#160;&#160; <span style="color: green">// add saved viewpoint</span></p>    <p style="margin: 0px">&#160;&#160;&#160; oDoc.SavedViewpoints.AddCopy(oNewViewPt2);</p>    <p style="margin: 0px">}</p> </div>
