---
layout: "post"
title: "How to zoom in Current View on current selection with .Net API"
date: "2012-05-16 03:02:48"
author: "Xiaodong Liang"
categories:
  - ".NET"
  - "Navisworks"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/aec/2012/05/how-to-zoom-in-current-view-on-current-selection-with-net-api.html "
typepad_basename: "how-to-zoom-in-current-view-on-current-selection-with-net-api"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/aec/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>  <p>&#160;</p>  <p>With COM API,&#160; &quot;InwOpState.ZoomInCurViewOnCurSel&quot; zooms in on current View on Current selection. You may have found a method in .NET.</p>  <p>Application.ActiveDocument.ActiveView.FocusOnCurrentSelection&quot; </p>  <p>But it only helps set the view to be centered around the selected item and does not zoom into it. </p>  <p>Currently there isnâ€™t any direct .NET API yet to help achieve this zoom in on selection.But you can always use COM interop in .NET. The following code snippet is based on any .NET plugin. It supposes an object is selected. Please copy the code to the plugin, and add the references: Autodesk.Navisworks.ComApi and Autodesk.Navisworks.Interop.ComApi.</p>  <p>&#160;</p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> ComApi = Autodesk.Navisworks.Api.Interop.ComApi;</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">using</span><span style="line-height: 140%"> ComApiBridge = Autodesk.Navisworks.Api.ComApi;</span></p> </div>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <div style="font-family: courier new; background: white; color: black; font-size: 8pt">     <p style="margin: 0px"><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> void</span><span style="line-height: 140%"> zoom(</span><span style="line-height: 140%">)</span></p>      <p style="margin: 0px"><span style="line-height: 140%">{&#160;&#160;&#160; </span></p>      <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; ComApi.</span><span style="line-height: 140%; color: #2b91af">InwOpState10</span><span style="line-height: 140%"> comState = ComApiBridge.</span><span style="line-height: 140%; color: #2b91af">ComApiBridge</span><span style="line-height: 140%">.State;</span></p>      <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">//Create a collection</span></p>      <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">ModelItemCollection</span><span style="line-height: 140%"> modelItemCollectionIn = </span></p>      <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">ModelItemCollection</span><span style="line-height: 140%">(</span></p>      <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Autodesk.Navisworks.Api.</span><span style="line-height: 140%; color: #2b91af">Application</span><span style="line-height: 140%">.ActiveDocument</span></p>      <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; .CurrentSelection.SelectedItems); </span></p>      <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; ComApi.</span><span style="line-height: 140%; color: #2b91af">InwOpSelection</span><span style="line-height: 140%"> comSelectionOut =</span></p>      <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; ComApiBridge.</span><span style="line-height: 140%; color: #2b91af">ComApiBridge</span><span style="line-height: 140%">.ToInwOpSelection(modelItemCollectionIn);</span></p>      <p style="margin: 0px">&#160;</p>      <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// zoom in to the specified selection</span></p>      <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; comState.ZoomInCurViewOnSel(comSelectionOut);</span></p>      <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">// zoom in to the current selection</span></p>      <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: green">//comState.ZoomInCurViewOnCurSel();</span></p>      <p style="margin: 0px">&#160;<span style="line-height: 140%">}</span></p>   </div>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">&#160;</span></p> </div>
