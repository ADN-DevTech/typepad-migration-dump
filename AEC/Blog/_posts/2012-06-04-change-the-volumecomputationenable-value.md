---
layout: "post"
title: "Change the VolumeComputationEnable value"
date: "2012-06-04 06:51:00"
author: "Joe Ye"
categories:
  - ".NET"
  - "Joe Ye"
  - "Revit"
original_url: "https://adndevblog.typepad.com/aec/2012/06/change-the-volumecomputationenable-value.html "
typepad_basename: "change-the-volumecomputationenable-value"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/aec/joe-ye.html">Joe Ye</a></p>  <p>I tried to change VolumeComputationEnable&#160; value by below codes: </p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%; color: #2b91af">Settings</span><span style="line-height: 140%"> setting = activedoc.Settings.VolumeCalculationSetting; </span></p>    <p style="margin: 0px"><span style="line-height: 140%">setting.VolumeCalculationOptions.VolumeComputationEnable = </span><span style="line-height: 140%; color: blue">true</span><span style="line-height: 140%">;</span></p> </div>  <p>Unfortunity, the property value was not changed successfully. It still keeps unchanged. Transaction commit was considered. The help documentation says it is read-write property. Then how to change its value?</p>  <p>VolumeCalculationOptions object obtained by activedoc.Settings.VolumeCalculationSetting.VolumeCalculationOptions is a new VolumeCalculationOptions object. It doesn't refer to the VolumeCalculationOptions object stored in document. If assign the property value directly, in fact, only the temp VolumeCalculationOptions object's property value is changed. The object stored in document isn't changed.</p>  <p>We need to write the changed VolumeCalculationOptions object back to activedoc.Settings.VolumeCalculationSetting.VolumeCalculationOptions to change the property value.</p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%; color: #2b91af">Settings</span><span style="line-height: 140%"> setting = activedoc.Settings.VolumeCalculationSetting; </span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: #2b91af">VolumeCalculationOptions</span><span style="line-height: 140%"> options = setting.VolumeCalculationOptions; </span></p>    <p style="margin: 0px"><span style="line-height: 140%">options.VolumeComputationEnable = </span><span style="line-height: 140%; color: blue">true</span><span style="line-height: 140%">; </span></p>    <p style="margin: 0px"><span style="line-height: 140%">setting.VolumeCalculationOptions = options;</span></p> </div>  <p>&#160;</p>  <p>My colleague Jeremy Tammik reminded that&#160; this post in his blog also talked about this topic.</p>  <p><a href="http://thebuildingcoder.typepad.com/blog/2009/06/volume-computation-enable.html">http://thebuildingcoder.typepad.com/blog/2009/06/volume-computation-enable.html</a></p>  <p>And&#160; in this post, another sample shows the usage of&#160; this in VB:</p>  <p><a href="http://thebuildingcoder.typepad.com/blog/2009/09/room-boundary-location.html">http://thebuildingcoder.typepad.com/blog/2009/09/room-boundary-location.html</a></p>
