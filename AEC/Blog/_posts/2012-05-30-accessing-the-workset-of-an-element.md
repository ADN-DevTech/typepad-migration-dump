---
layout: "post"
title: "Accessing the Workset of an element"
date: "2012-05-30 10:50:14"
author: "Augusto Goncalves"
categories:
  - ".NET"
  - "Augusto Goncalves"
  - "Revit"
original_url: "https://adndevblog.typepad.com/aec/2012/05/accessing-the-workset-of-an-element.html "
typepad_basename: "accessing-the-workset-of-an-element"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>It is possible access the Workset, which resides on the document WorksetTable collection, from the element property or from the parameter. </p>  <p>The code sample below shows how access using both approaches and use it. Notice that this code accesses WorksetId, different form the regular ElementId. </p>  <div style="font-family: ; background: white">   <p style="margin: 0px">     <div style="font-family: ; background: white">       <p style="margin: 0px"><font face="Courier New"><span><font color="#2b91af"><font style="font-size: 8pt">Selection</font></font></span><font style="font-size: 8pt" color="#000000"> sel = commandData.Application.ActiveUIDocument.Selection;</font></font></p>        <p style="margin: 0px"><font face="Courier New"><span><font color="#2b91af"><font style="font-size: 8pt">Document</font></font></span><font style="font-size: 8pt" color="#000000"> doc = commandData.Application.ActiveUIDocument.Document;</font></font></p>        <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>        <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">// select an element</font></font></span></p>        <p style="margin: 0px"><font face="Courier New"><span><font color="#2b91af"><font style="font-size: 8pt">Element</font></font></span><font style="font-size: 8pt"><font color="#000000"> elem = doc.GetElement(sel.PickObject(</font><span><font color="#2b91af">ObjectType</font></span><font color="#000000">.Element));</font></font></font></p>        <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>        <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">// the table of worksets</font></font></span></p>        <p style="margin: 0px"><font face="Courier New"><span><font color="#2b91af"><font style="font-size: 8pt">WorksetTable</font></font></span><font style="font-size: 8pt" color="#000000"> worksetTable = doc.GetWorksetTable();</font></font></p>        <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>        <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">// 1. direct way</font></font></span></p>        <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">// access the workset from element ID</font></font></span></p>        <p style="margin: 0px"><font face="Courier New"><span><font color="#2b91af"><font style="font-size: 8pt">WorksetId</font></font></span><font style="font-size: 8pt" color="#000000"> worksetIdByElement = doc.GetWorksetId(elem.Id);</font></font></p>        <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">if</font></font></span><font style="font-size: 8pt"><font color="#000000"> (worksetIdByElement != </font><span><font color="#2b91af">WorksetId</font></span><font color="#000000">.InvalidWorksetId)</font></font></font></p>        <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">{</font></font></p>        <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// now the workset</font></span></font></p>        <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">Workset</font></span><font color="#000000"> worksetByElement = </font></font></font></p>        <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; worksetTable.GetWorkset(worksetIdByElement);</font></font></p>        <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">}</font></font></p>        <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>        <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">// 2. indirect way (from parameter value)</font></font></span></p>        <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">// access the workset from the param value</font></font></span></p>        <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">// first access the param value</font></font></span></p>        <p style="margin: 0px"><font face="Courier New"><span><font color="#2b91af"><font style="font-size: 8pt">Parameter</font></font></span><font style="font-size: 8pt" color="#000000"> param = elem.get_Parameter</font></font></p>        <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; (</font></font><font style="font-size: 8pt"><span><font color="#2b91af">BuiltInParameter</font></span><font color="#000000">.ELEM_PARTITION_PARAM);</font></font></font></p>        <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">int</font></font></span><font style="font-size: 8pt" color="#000000"> paramValue = param.AsInteger();</font></font></p>        <p style="margin: 0px"><font face="Courier New"><span><font color="#2b91af"><font style="font-size: 8pt">WorksetId</font></font></span><font style="font-size: 8pt"><font color="#000000"> elemWorksetId = </font><span><font color="#0000ff">new</font></span><font color="#000000"> </font><span><font color="#2b91af">WorksetId</font></span><font color="#000000">(paramValue);</font></font></font></p>        <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">if</font></font></span><font style="font-size: 8pt"><font color="#000000"> (worksetIdByElement != </font><span><font color="#2b91af">WorksetId</font></span><font color="#000000">.InvalidWorksetId)</font></font></font></p>        <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">{</font></font></p>        <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// now the workset</font></span></font></p>        <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">Workset</font></span><font color="#000000"> worksetByParam = worksetTable.GetWorkset(elemWorksetId);</font></font></font></p>        <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">}</font></font></p>     </div>   </p> </div>
