---
layout: "post"
title: "Util class with .NET Extension API"
date: "2012-10-29 12:46:39"
author: "Augusto Goncalves"
categories:
  - ".NET"
  - "Augusto Goncalves"
  - "Revit"
original_url: "https://adndevblog.typepad.com/aec/2012/10/util-class-with-net-extension-api.html "
typepad_basename: "util-class-with-net-extension-api"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/aec/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>Create an 'Util’ class is common practice on Revit development. So what about use <a href="http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.extensionattribute.aspx">.NET Extension</a> API? This is available since .NET 3.0. The syntax is a little different from <a href="http://msdn.microsoft.com/en-us/library/bb384936.aspx">VB.NET</a> and <a href="http://msdn.microsoft.com/en-us/library/bb383977.aspx">C#</a>. </p>  <p>Start with a simple idea: convert from feet to meter. For some time I see developers doing it with a regular Utils class. With Extension is basically the same, except that in VB.NET it is required to use a Module (not a Class) and mark all methods with &lt;Extension()&gt; attribute. In C# create a static class with static methods.</p>  <p>VB.NET</p>  <div style="font-family: ; background: white">   <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 10pt">Imports</font></font></span><font style="font-size: 10pt" color="#000000"> System.Runtime.CompilerServices</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 10pt">Public</font></font></span><font style="font-size: 10pt"><font color="#000000"> </font><span><font color="#0000ff">Module</font></span><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#2b91af">Utils</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Private</font></span><font color="#000000"> </font><span><font color="#0000ff">Const</font></span><font color="#000000"> FEET_TO_METERS </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#0000ff">Double</font></span><font color="#000000"> = 0.3048</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; &lt;</font></font><font style="font-size: 10pt"><span><font color="#2b91af">Extension</font></span><font color="#000000">()&gt; _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Public</font></span><font color="#000000"> </font><span><font color="#0000ff">Function</font></span><font color="#000000"> FeetToMeter(feet </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#0000ff">Double</font></span><font color="#000000">) </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#0000ff">Double</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Return</font></span><font color="#000000"> feet * FEET_TO_METERS</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#0000ff">Function</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; &lt;</font></font><font style="font-size: 10pt"><span><font color="#2b91af">Extension</font></span><font color="#000000">()&gt; _</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Public</font></span><font color="#000000"> </font><span><font color="#0000ff">Function</font></span><font color="#000000"> MeterToFeet(meter </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font><span><font color="#0000ff">Double</font></span><font color="#000000">) </font><span><font color="#0000ff">As</font></span><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#0000ff">Double</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">Return</font></span><font color="#000000"> meter / FEET_TO_METERS</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">End</font></span><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#0000ff">Function</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 10pt">End</font></font></span><font style="font-size: 10pt"><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#0000ff">Module</font></span></font><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p> </div>  <p>C#</p>  <div style="font-family: ; background: white">   <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 10pt">public</font></font></span><font style="font-size: 10pt"><font color="#000000"> </font><span><font color="#0000ff">static</font></span><font color="#000000"> </font><span><font color="#0000ff">class</font></span><font color="#000000"> </font></font><span><font style="font-size: 10pt" color="#2b91af">Utils</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">{</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">private</font></span><font color="#000000"> </font><span><font color="#0000ff">const</font></span><font color="#000000"> </font><span><font color="#0000ff">double</font></span><font color="#000000"> FEET_TO_METERS = 0.3048;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">public</font></span><font color="#000000"> </font><span><font color="#0000ff">static</font></span><font color="#000000"> </font><span><font color="#0000ff">double</font></span><font color="#000000"> FeetToMeter(</font><span><font color="#0000ff">this</font></span><font color="#000000"> </font><span><font color="#0000ff">double</font></span><font color="#000000"> feet)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160; {</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">return</font></span><font color="#000000"> feet * FEET_TO_METERS;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160; }</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">public</font></span><font color="#000000"> </font><span><font color="#0000ff">static</font></span><font color="#000000"> </font><span><font color="#0000ff">double</font></span><font color="#000000"> MeterToFeet(</font><span><font color="#0000ff">this</font></span><font color="#000000"> </font><span><font color="#0000ff">double</font></span><font color="#000000"> meter)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160; {</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 10pt">&#160;&#160;&#160; </font></font><font style="font-size: 10pt"><span><font color="#0000ff">return</font></span><font color="#000000"> meter / FEET_TO_METERS;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">&#160; }</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 10pt" color="#000000">}</font></font></p> </div>  <p>Now the use is even more interesting. Just create any double and call its new method MeterToFeet! The auto-complete feature works just fine.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017ee48dd2cd970d-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="variable" border="0" alt="variable" src="/assets/image_176.jpg" width="318" height="71" /></a></p>  <p>Now even more fun, try type a (double) number and call its new extension method, works fine too!</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017ee48dd2ec970d-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="pure_number" border="0" alt="pure_number" src="/assets/image_390244.jpg" width="470" height="99" /></a></p>  <p>And the good news: if we made these changes the code still working on the ‘classic’ way (calling the method by name), so your code should not break because of this change.</p>
