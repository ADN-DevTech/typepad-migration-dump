---
layout: "post"
title: "Use Search API"
date: "2012-07-19 02:54:22"
author: "Xiaodong Liang"
categories:
  - ".NET"
  - "Navisworks"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/aec/2012/07/use-search-api.html "
typepad_basename: "use-search-api"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/aec/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>  <p>We introduced <a href="http://adndevblog.typepad.com/aec/2012/05/navisworks-net-api-properties.html">Object Properties</a>&#160; and how to <a href="http://adndevblog.typepad.com/aec/2012/05/navisworks-net-api-find-item.html">Find Item</a>. In this post, we will learn more on Search API.</p>  <p>Search API corresponds to the Find Items functionality in Roamer. It is similar to the product functionality, but with further refined conditions. It is fast because it is happens in native code, but can only do what Roamer can do.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0167689ecfeb970b-pi"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/assets/image_927282.jpg" width="478" height="62" /></a> </p>  <p><strong>Selection</strong> is what to search (i.e. Where to look).     <br /><strong>Conditions</strong> is what to find. A Condition is basically a test against an object property with quite flexible usage. It also has a few other options that are properties on the Search class.</p>  <p>&#160;</p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%; color: green">//1) Create a SearchCondition instance with the condition</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: #2b91af">VariantData</span><span style="line-height: 140%"> oData = </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">VariantData</span><span style="line-height: 140%">.FromDisplayString(</span><span style="line-height: 140%; color: #a31515">&quot;16C17&quot;</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: #2b91af">SearchCondition</span><span style="line-height: 140%"> oSearchCondition = </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">SearchCondition</span><span style="line-height: 140%">.HasPropertyByDisplayName(</span><span style="line-height: 140%; color: #a31515">&quot;Entity Handle&quot;</span><span style="line-height: 140%">, </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;Value&quot;</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">oSearchCondition = </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; oSearchCondition.EqualValue(oData);</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%">s.SearchConditions.Add(oSearchCondition);</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">//2) Create a SearchCondition instance with construction method</span></p>    <p style="margin: 0px"><span style="line-height: 140%">s.SearchConditions.Add(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">SearchCondition</span><span style="line-height: 140%">(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">NamedConstant</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: #2b91af">PropertyCategoryNames</span><span style="line-height: 140%">.</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; AutoCadEntityHandle, </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;Entity Handle&quot;</span><span style="line-height: 140%">),</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">NamedConstant</span><span style="line-height: 140%">(</span><span style="line-height: 140%; color: #2b91af">DataPropertyNames</span><span style="line-height: 140%">.</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; AutoCadEntityHandleValue, </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #a31515">&quot;Value&quot;</span><span style="line-height: 140%">),</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">SearchConditionOptions</span><span style="line-height: 140%">.IgnoreNames,</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">SearchConditionComparison</span><span style="line-height: 140%">.Equal,</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">VariantData</span><span style="line-height: 140%">.FromDisplayString(</span><span style="line-height: 140%; color: #a31515">&quot;16C17&quot;</span><span style="line-height: 140%">)));</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">//3) invert a search condition</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: #2b91af">SearchCondition</span><span style="line-height: 140%"> s1 = </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">SearchCondition</span><span style="line-height: 140%">.HasCategoryByName(</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">PropertyCategoryNames</span><span style="line-height: 140%">.Transform); </span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: #2b91af">SearchCondition</span><span style="line-height: 140%"> s2 = s1.Negate();</span></p> </div>  <p>&#160;</p>  <p><strong>SearchCondition Group      <br /></strong>SearchConditionCollection::AddGroup adds the items of the specified collection to the SearchConditionCollection as a new group of conditions. The combined set of SearchConditions will match if any group within the set matches. This means it is “OR” condition among the groups. Within a group, the condition is “AND”.</p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%; color: green">//Create a new search</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: #2b91af">Search</span><span style="line-height: 140%"> s = </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: #2b91af">Search</span><span style="line-height: 140%">();</span></p>    <p style="margin: 0px"><span style="line-height: 140%">s.Selection.SelectAll();</span></p>    <p style="margin: 0px"><span style="line-height: 140%"></span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">//SearchCondition1 of group1:the item is required</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: #2b91af">SearchCondition</span><span style="line-height: 140%"> oGroup1_SC1 = </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">SearchCondition</span><span style="line-height: 140%">.HasPropertyByDisplayName(</span><span style="line-height: 140%; color: #a31515">&quot;Item&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;Required&quot;</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">oGroup1_SC1 = oGroup1_SC1.EqualValue(</span><span style="line-height: 140%; color: #2b91af">VariantData</span><span style="line-height: 140%">.FromBoolean(</span><span style="line-height: 140%; color: blue">true</span><span style="line-height: 140%">));</span></p>    <p style="margin: 0px"><span style="line-height: 140%"></span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">//SearchCondition2 of group1:the item's DWG handle is 16C17</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: #2b91af">SearchCondition</span><span style="line-height: 140%"> oGroup1_SC2 =</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">SearchCondition</span><span style="line-height: 140%">.HasPropertyByDisplayName(</span><span style="line-height: 140%; color: #a31515">&quot;Entity Handle&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;Value&quot;</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">oGroup1_SC2 = oGroup1_SC2.EqualValue(</span><span style="line-height: 140%; color: #2b91af">VariantData</span><span style="line-height: 140%">.FromDisplayString(</span><span style="line-height: 140%; color: #a31515">&quot;16C17&quot;</span><span style="line-height: 140%">));</span></p>    <p style="margin: 0px"><span style="line-height: 140%"></span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">//SearchCondition1 of group2: the item is NOT required</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: #2b91af">SearchCondition</span><span style="line-height: 140%"> oGroup2_SC1 =</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">SearchCondition</span><span style="line-height: 140%">.HasPropertyByDisplayName(</span><span style="line-height: 140%; color: #a31515">&quot;Item&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;Required&quot;</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">oGroup2_SC1 = </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160; oGroup2_SC1.EqualValue(</span><span style="line-height: 140%; color: #2b91af">VariantData</span><span style="line-height: 140%">.FromBoolean(</span><span style="line-height: 140%; color: blue">false</span><span style="line-height: 140%">));</span></p>    <p style="margin: 0px"><span style="line-height: 140%"></span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">//SearchCondition2 of group2: the item's DWG handle is 17C2E</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: #2b91af">SearchCondition</span><span style="line-height: 140%"> oGroup2_SC2 = </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: #2b91af">SearchCondition</span><span style="line-height: 140%">.HasPropertyByDisplayName(</span><span style="line-height: 140%; color: #a31515">&quot;Entity Handle&quot;</span><span style="line-height: 140%">, </span><span style="line-height: 140%; color: #a31515">&quot;Value&quot;</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">oGroup2_SC2 = </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160; oGroup2_SC2.EqualValue(</span><span style="line-height: 140%; color: #2b91af">VariantData</span><span style="line-height: 140%">.FromDisplayString(</span><span style="line-height: 140%; color: #a31515">&quot;17C2E&quot;</span><span style="line-height: 140%">));</span></p>    <p style="margin: 0px"><span style="line-height: 140%"></span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">//create group1</span></p>    <p style="margin: 0px"><span style="line-height: 140%">System.Collections.Generic.</span><span style="line-height: 140%; color: #2b91af">List</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: #2b91af">SearchCondition</span><span style="line-height: 140%">&gt; oG1 = </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> System.Collections.Generic.</span><span style="line-height: 140%; color: #2b91af">List</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: #2b91af">SearchCondition</span><span style="line-height: 140%">&gt;();</span></p>    <p style="margin: 0px"><span style="line-height: 140%">oG1.Add(oGroup1_SC1);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">oG1.Add(oGroup1_SC2);</span></p>    <p style="margin: 0px"><span style="line-height: 140%"></span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">//create group2</span></p>    <p style="margin: 0px"><span style="line-height: 140%">System.Collections.Generic.</span><span style="line-height: 140%; color: #2b91af">List</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: #2b91af">SearchCondition</span><span style="line-height: 140%">&gt; oG2 = </span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">new</span><span style="line-height: 140%"> System.Collections.Generic.</span><span style="line-height: 140%; color: #2b91af">List</span><span style="line-height: 140%">&lt;</span><span style="line-height: 140%; color: #2b91af">SearchCondition</span><span style="line-height: 140%">&gt;();</span></p>    <p style="margin: 0px"><span style="line-height: 140%">oG2.Add(oGroup2_SC1);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">oG2.Add(oGroup2_SC2);</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green"></span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">// add groups to SearchConditions</span></p>    <p style="margin: 0px"><span style="line-height: 140%">s.SearchConditions.AddGroup(oG1);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">s.SearchConditions.AddGroup(oG2);</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green"></span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: green">//highlight the items</span></p>    <p style="margin: 0px"><span style="line-height: 140%; color: #2b91af">ModelItemCollection</span><span style="line-height: 140%"> searchResults =</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; s.FindAll(Autodesk.Navisworks.Api.</span><span style="line-height: 140%; color: #2b91af">Application</span><span style="line-height: 140%">.ActiveDocument, </span><span style="line-height: 140%; color: blue">false</span><span style="line-height: 140%">);</span></p>    <p style="margin: 0px"><span style="line-height: 140%">Autodesk.Navisworks.Api.</span><span style="line-height: 140%; color: #2b91af">Application</span><span style="line-height: 140%">.ActiveDocument.CurrentSelection.CopyFrom(searchResults);</span></p> </div>
