---
layout: "post"
title: "Save file in COM plug-in"
date: "2012-06-21 02:56:14"
author: "Xiaodong Liang"
categories:
  - "COM"
  - "Navisworks"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/aec/2012/06/save-file-in-com-plug-in.html "
typepad_basename: "save-file-in-com-plug-in"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/aec/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>  <p><b>Issue</b></p>  <p>I want to save file through my plug-in of COM API. But i cannot find a method. </p>  <p><a name="section2"></a></p>  <p><b>Solution</b></p>  <p>When a plug-in is created it passes a 'plug-in site interface' which it can hold onto. You can QueryInterface the return from GetApplication to a Document. The following code snippet is based on a plug-in sample in &lt;Navisworks 2013&gt;\\api\COM\examples\Plugin\PluginExportExample. </p>  <div style="font-family: courier new; background: white; color: black; font-size: 8pt">   <p style="margin: 0px"><span style="line-height: 140%; color: blue">private</span><span style="line-height: 140%"> NavisworksIntegratedAPI10.</span><span style="line-height: 140%; color: #2b91af">InwPlugin_Site</span><span style="line-height: 140%"> m_plugin_site;</span></p>    <p style="margin: 0px">&#160;</p>    <p style="margin: 0px"><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">virtual</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">void</span><span style="line-height: 140%"> AdviseSite(NavisworksIntegratedAPI10.</span><span style="line-height: 140%; color: #2b91af">InwPlugin_Site</span><span style="line-height: 140%"> plugin_site)</span></p>    <p style="margin: 0px"><span style="line-height: 140%">{</span></p>    <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; m_plugin_site = plugin_site;</span></p>    <p style="margin: 0px"><span style="line-height: 140%">}</span></p>    <p style="margin: 0px"><span style="line-height: 140%"></span></p>    <div style="font-family: courier new; background: white; color: black; font-size: 8pt">     <p style="margin: 0px"><span style="line-height: 140%; color: blue">public</span><span style="line-height: 140%"> </span><span style="line-height: 140%; color: blue">virtual</span><span style="line-height: 140%"> NavisworksIntegratedAPI10.</span><span style="line-height: 140%; color: #2b91af">nwEExportStatus</span><span style="line-height: 140%"> iExport(</span></p>      <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; NavisworksIntegratedAPI10.</span><span style="line-height: 140%; color: #2b91af">InwOpState</span><span style="line-height: 140%"> p_state, </span></p>      <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">int</span><span style="line-height: 140%"> reason, </span></p>      <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">string</span><span style="line-height: 140%"> filename, </span></p>      <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; NavisworksIntegratedAPI10.</span><span style="line-height: 140%; color: #2b91af">InwOpProgress</span><span style="line-height: 140%"> Progress)</span></p>      <p style="margin: 0px"><span style="line-height: 140%">{</span></p>      <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; NavisworksAutomationAPI10.</span><span style="line-height: 140%; color: #2b91af">Document</span><span style="line-height: 140%"> oDoc =</span></p>      <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160; m_plugin_site.GetApplication() </span></p>      <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">as</span><span style="line-height: 140%"> NavisworksAutomationAPI10.</span><span style="line-height: 140%; color: #2b91af">Document</span><span style="line-height: 140%">;</span></p>      <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; oDoc.SaveAs(</span><span style="line-height: 140%; color: #a31515">&quot;c:\\newFile.nwd&quot;</span><span style="line-height: 140%">);</span>&#160;</p>      <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160; </span>&#160;</p>      <p style="margin: 0px"><span style="line-height: 140%">&#160;&#160;&#160; </span><span style="line-height: 140%; color: blue">return</span><span style="line-height: 140%"> NavisworksIntegratedAPI10.</span><span style="line-height: 140%; color: #2b91af">nwEExportStatus</span><span style="line-height: 140%">.eExport_OK;</span></p>      <p style="margin: 0px"><span style="line-height: 140%">}</span></p>   </div> </div>
