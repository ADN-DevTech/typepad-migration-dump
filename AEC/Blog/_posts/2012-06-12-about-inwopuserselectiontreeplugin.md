---
layout: "post"
title: "About InwOpUserSelectionTreePlugin"
date: "2012-06-12 19:33:38"
author: "Xiaodong Liang"
categories:
  - "COM"
  - "Navisworks"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/aec/2012/06/about-inwopuserselectiontreeplugin.html "
typepad_basename: "about-inwopuserselectiontreeplugin"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/aec/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>  <p>The last <a href="http://adndevblog.typepad.com/aec/2012/06/inwselectiontreeplugin-and-inwopuserselectiontreeplugin.html">post</a> introduces InwSelectionTreePlugin and InwOpUserSelectionTreePlugin. In this post, we will talk more about InwOpUserSelectionTreePlugin, in terms of some questions:</p>  <li>What is the functionality of InwOpUserSelectionTreePlugin?   <p>It is to provide a way&#160; to build a custom tree based on the whole tree of Navisworks. That is something like a sub-tree of the whole tree, give the conditions (like Find). Each tree will correspond to one tab of Selection Tree. So the behavior of the node is still managed by Navisworks. SDK sample plugin_07&#160; demonstrates how to implement InwOpUserSelectionTreePlugin. Note: this sample is available in the SDK before 2013. But it is not provided in 2013 SDK. </p> </li>  <p>&#160;</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01761564a773970c-pi"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/assets/image_599528.jpg" width="439" height="374" /></a></p>  <p>&#160;</p>  <li>How to register plugin_07</li>  <p></p>  <p>Because plugin_07 is an ActiveX EXE, you need to firstly register it by running 'LwuserSelTreeEditor.exe' or running the following prompt in DOS command.</p>  <p>&#160;&#160;&#160;&#160;&#160; c:\plugin_07\LwuserSelTreeEditor.exe /regserver</p>  <p>After register it by running 'LwuserSelTreeEditor.exe' or running the following prompt in DOS command, please add a key in register so that Nw can know to load it.</p>  <p>&#160;</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0163067b6a41970d-pi"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/assets/image_255901.jpg" width="604" height="466" /></a> </p>  <p>&#160;</p>  <li>why the program needs to traverse all the plugins before it begins to create the selection tree?   <p>It is to collect all plug-ins of userSelectionTree. Every such kind of plug-in corresponds to one tab in Selection Tree of GUI. e.g. as below, on my machine, there is only one user selection tree. </p> </li>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0167676f1d2d970b-pi"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/assets/image_841454.jpg" width="472" height="412" /></a> </p>  <p>&#160;</p>  <li>what does &quot;InwOpUserSelectionTreeSpec&quot; represent? and &quot;InwOpUserSelectionTreeSpec&quot; ?   <p>&#160; InwOpUserSelectionTreeSpec specifies what is to be displayed in the user selection tree. It could be understood as a result with some Find conditions. e.g. in the figure above, the tree just lists the items whose entity handle is 16C17. Plugin_07 is a tool for you to set up / manage the user selection tree. Please follow the introduction text on the right of the dialog for more details.</p> </li>  <p>&#160;</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01761564a8ee970c-pi"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/assets/image_148731.jpg" width="660" height="359" /></a> </p>  <p>&#160;</p>  <li>can you give some explanation on RebuildTree()?   <p>This function iterates each user selection tree plug-in and their UserSelectionTreeSpec. Next it lists each plug-in as one node and UserSelectionTreeSpec as sub node. Then it lists all properties of the UserSelectionTreeSpec. You can change the properties (like changing find conditions) on rune time.</p> </li>  <p>&#160;</p>  <p></p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0163067b6bb7970d-pi"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/assets/image_237426.jpg" width="390" height="286" /></a></p>
