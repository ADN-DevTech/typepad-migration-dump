---
layout: "post"
title: "Create sectioning plane"
date: "2012-08-28 02:56:23"
author: "Xiaodong Liang"
categories:
  - ".NET"
  - "COM"
  - "Navisworks"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/aec/2012/08/create-sectioning-plane.html "
typepad_basename: "create-sectioning-plane"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/autocad/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>  <p>Currently, only COM exposed some small API for sectioning. InwClippingPlaneColl can add the custom clipping plane. But InwClippingPlaneColl.Add method is not supported. This is because the COM wrapper in having to follow the underlying C++ code.   <br />You need to use InwClippingPlaneColl2.CreatePlane. It passes in a 1 based index. Default planes will be created as required, up to and including this index. Then you modify the plane that is in the collection directly.</p>  <p style="background: white"><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 8pt" lang="EN-US">private</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US"> </span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 8pt" lang="EN-US">void</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US"> createSectionPlane()</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt" lang="EN-US">     <p></p>   </span></p>  <p style="background: white"><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US">{</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt" lang="EN-US">     <p></p>   </span></p>  <p style="background: white"><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US">ComApi.</span><span style="font-family: &quot;Courier New&quot;; color: #2b91af; font-size: 8pt" lang="EN-US">InwOpState10</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US"> state;</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt" lang="EN-US">     <p></p>   </span></p>  <p style="background: white"><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US">state = </span><span style="font-family: &quot;Courier New&quot;; color: #2b91af; font-size: 8pt" lang="EN-US">ComBridge</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US">.State;</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt" lang="EN-US">     <p></p>   </span></p>  <p style="background: white"><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US">&#160;</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt" lang="EN-US">     <p></p>   </span></p>  <p style="background: white"><span style="font-family: &quot;Courier New&quot;; color: green; font-size: 8pt" lang="EN-US">// create a geometry vector as the normal of section plane</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt" lang="EN-US">     <p></p>   </span></p>  <p style="background: white"><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US">ComApi.</span><span style="font-family: &quot;Courier New&quot;; color: #2b91af; font-size: 8pt" lang="EN-US">InwLUnitVec3f</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US"> sectionPlaneNormal =</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt" lang="EN-US">     <p></p>   </span></p>  <p style="background: white"><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US">&#160;&#160;&#160; (ComApi.</span><span style="font-family: &quot;Courier New&quot;; color: #2b91af; font-size: 8pt" lang="EN-US">InwLUnitVec3f</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US">)state.ObjectFactory(</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt" lang="EN-US">     <p></p>   </span></p>  <p style="background: white"><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US">&#160;&#160;&#160; Autodesk.Navisworks.Api.Interop.ComApi.</span><span style="font-family: &quot;Courier New&quot;; color: #2b91af; font-size: 8pt" lang="EN-US">nwEObjectType</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US">.eObjectType_nwLUnitVec3f,</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt" lang="EN-US">     <p></p>   </span></p>  <p style="background: white"><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US">&#160;&#160;&#160; </span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 8pt" lang="EN-US">null</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US">,</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt" lang="EN-US">     <p></p>   </span></p>  <p style="background: white"><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US">&#160;&#160;&#160; </span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 8pt" lang="EN-US">null</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US">);</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt" lang="EN-US">     <p></p>   </span></p>  <p style="background: white"><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US">sectionPlaneNormal.SetValue(1, 1, 0);</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt" lang="EN-US">     <p></p>   </span></p>  <p style="background: white"><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US">&#160;</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt" lang="EN-US">     <p></p>   </span></p>  <p style="background: white"><span style="font-family: &quot;Courier New&quot;; color: green; font-size: 8pt" lang="EN-US">// create a geometry plane</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt" lang="EN-US">     <p></p>   </span></p>  <p style="background: white"><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US">ComApi.</span><span style="font-family: &quot;Courier New&quot;; color: #2b91af; font-size: 8pt" lang="EN-US">InwLPlane3f</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US"> sectionPlane =</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt" lang="EN-US">     <p></p>   </span></p>  <p style="background: white"><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US">&#160;&#160;&#160; (ComApi.</span><span style="font-family: &quot;Courier New&quot;; color: #2b91af; font-size: 8pt" lang="EN-US">InwLPlane3f</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US">)state.ObjectFactory</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt" lang="EN-US">     <p></p>   </span></p>  <p style="background: white"><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US">&#160;&#160;&#160; (Autodesk.Navisworks.Api.Interop.ComApi.</span><span style="font-family: &quot;Courier New&quot;; color: #2b91af; font-size: 8pt" lang="EN-US">nwEObjectType</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US">.eObjectType_nwLPlane3f,</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt" lang="EN-US">     <p></p>   </span></p>  <p style="background: white"><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US">&#160;&#160;&#160; </span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 8pt" lang="EN-US">null</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US">,</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt" lang="EN-US">     <p></p>   </span></p>  <p style="background: white"><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US">&#160;&#160;&#160; </span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 8pt" lang="EN-US">null</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US">);</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt" lang="EN-US">     <p></p>   </span></p>  <p style="background: white"><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US">&#160;</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt" lang="EN-US">     <p></p>   </span></p>  <p style="background: white"><span style="font-family: &quot;Courier New&quot;; color: green; font-size: 8pt" lang="EN-US">//get collection of sectioning planes</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt" lang="EN-US">     <p></p>   </span></p>  <p style="background: white"><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US">ComApi.</span><span style="font-family: &quot;Courier New&quot;; color: #2b91af; font-size: 8pt" lang="EN-US">InwClippingPlaneColl2</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US"> clipColl =</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt" lang="EN-US">     <p></p>   </span></p>  <p style="background: white"><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US">&#160;&#160;&#160; (ComApi.</span><span style="font-family: &quot;Courier New&quot;; color: #2b91af; font-size: 8pt" lang="EN-US">InwClippingPlaneColl2</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US">)state.CurrentView.ClippingPlanes();</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt" lang="EN-US">     <p></p>   </span></p>  <p style="background: white"><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US">&#160;</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt" lang="EN-US">     <p></p>   </span></p>  <p style="background: white"><span style="font-family: &quot;Courier New&quot;; color: green; font-size: 8pt" lang="EN-US">// get the count of current sectioning planes</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt" lang="EN-US">     <p></p>   </span></p>  <p style="background: white"><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 8pt" lang="EN-US">int</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US"> planeCount = clipColl.Count + 1;</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt" lang="EN-US">     <p></p>   </span></p>  <p style="background: white"><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US">&#160;</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt" lang="EN-US">     <p></p>   </span></p>  <p style="background: white"><span style="font-family: &quot;Courier New&quot;; color: green; font-size: 8pt" lang="EN-US">// create a new sectioning plane </span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt" lang="EN-US">     <p></p>   </span></p>  <p style="background: white"><span style="font-family: &quot;Courier New&quot;; color: green; font-size: 8pt" lang="EN-US">// it forces creation of planes up to this index.</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt" lang="EN-US">     <p></p>   </span></p>  <p style="background: white"><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US">clipColl.CreatePlane(planeCount);</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt" lang="EN-US">     <p></p>   </span></p>  <p style="background: white"><span style="font-family: &quot;Courier New&quot;; color: green; font-size: 8pt" lang="EN-US">// get the last sectioning plane which are what we created</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt" lang="EN-US">     <p></p>   </span></p>  <p style="background: white"><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US">ComApi.</span><span style="font-family: &quot;Courier New&quot;; color: #2b91af; font-size: 8pt" lang="EN-US">InwOaClipPlane</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US"> cliPlane =</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt" lang="EN-US">     <p></p>   </span></p>  <p style="background: white"><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US">&#160;&#160;&#160; (ComApi.</span><span style="font-family: &quot;Courier New&quot;; color: #2b91af; font-size: 8pt" lang="EN-US">InwOaClipPlane</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US">)state.CurrentView.ClippingPlanes().Last();</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt" lang="EN-US">     <p></p>   </span></p>  <p style="background: white"><span style="font-family: &quot;Courier New&quot;; color: green; font-size: 8pt" lang="EN-US">//assign the geometry vector with the plane</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt" lang="EN-US">     <p></p>   </span></p>  <p style="background: white"><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US">&#160;</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt" lang="EN-US">     <p></p>   </span></p>  <p style="background: white"><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US">sectionPlane.SetValue(sectionPlaneNormal, 1.0);</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt" lang="EN-US">     <p></p>   </span></p>  <p style="background: white"><span style="font-family: &quot;Courier New&quot;; color: green; font-size: 8pt" lang="EN-US">// ask the sectioning plane uses the new geometry plane</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt" lang="EN-US">     <p></p>   </span></p>  <p style="background: white"><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US">cliPlane.Plane = sectionPlane;</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt" lang="EN-US">     <p></p>   </span></p>  <p style="background: white"><span style="font-family: &quot;Courier New&quot;; color: green; font-size: 8pt" lang="EN-US">// enable this sectioning plane</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt" lang="EN-US">     <p></p>   </span></p>  <p style="background: white"><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US">cliPlane.Enabled = </span><span style="font-family: &quot;Courier New&quot;; color: blue; font-size: 8pt" lang="EN-US">true</span><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US">;</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt" lang="EN-US">     <p></p>   </span></p>  <p style="background: white"><span style="font-family: &quot;Courier New&quot;; color: black; font-size: 8pt" lang="EN-US">}</span><span style="font-family: &quot;Verdana&quot;,&quot;sans-serif&quot;; font-size: 8pt" lang="EN-US">     <p></p>   </span></p>
