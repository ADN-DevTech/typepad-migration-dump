---
layout: "post"
title: "Custom Ribbon of Navisworks part 2"
date: "2012-07-12 02:25:07"
author: "Xiaodong Liang"
categories:
  - ".NET"
  - "Navisworks"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/aec/2012/07/custom-ribbon-of-navisworks-part-2.html "
typepad_basename: "custom-ribbon-of-navisworks-part-2"
typepad_status: "Publish"
---

<p><ribboncontrol xmlns:local="clr-namespace:Autodesk.Navisworks.Gui.Roamer.AIRLook;assembly=navisworks.gui.roamer" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:system="clr-namespace:System;assembly=mscorlib" xmlns:adwi="clr-namespace:Autodesk.Internal.Windows;assembly=AdWindows" xmlns:wpf="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns="clr-namespace:Autodesk.Windows;assembly=AdWindows" x:uid="ADNRibbonDemo"> <ribbontab id="ID_CustomTab_1" keytip="T1"><ribbonpanel x:uid="RibbonPane1_1"><ribbonpanelsource title="Large Button" x:uid="RibbonPanelSource_RibbonPanel_1" keytip="C1"><nwribbonbutton id="ID_Button_1" x:uid="Button_1" keytip="B1" orientation="Vertical" text="Button 1 in xaml" showtext="True" size="Large"></nwribbonbutton></ribbonpanelsource></ribbonpanel></ribbontab></ribboncontrol>By <a href="http://adndevblog.typepad.com/aec/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>  <p>(Continued with <a href="http://adndevblog.typepad.com/aec/2012/07/custom-ribbon-of-navisworks-part-1.html">Custom Ribbon of Navisworks part 1</a>)</p>  <p><b>Ribbon Interface File</b></p>  <p>The technique to configure the ribbon interfaces uses <i>Extensible Application Markup Language</i>(<a href="http://en.wikipedia.org/wiki/Extensible_Application_Markup_Language">XAML</a>). Several main types of tag (nodes):</p>  <p><font color="#ff8000">RibbonControl</font>: This is the top most node. It defines the Ribbonâ€™s unique name and necessary configurations for the xaml. </p>  <p><font color="#ff8000">RibbonTab</font>: configures the Ribbon tab. The attributes include:</p>  <ul>   <li>Id: defines a unique identifier for the ribbon tab - this must be identical to the ribbon tab Id in compiled code.</li>    <li>Title: defines the text than appears on the tab. This overrides the DisplayName attribute in compiled code.</li>    <li>KeyTip: the key or combination of keys that enables the tab to be activated using the keyboard rather than the mouse. </li> </ul>  <p><font color="#ff8000">RibbonPanel</font>: provides a distinct panel in the ribbon tab for a group of buttons. Only one attribute: </p>  <ul>   <li>x:Uid: unique id used in xmal file<u></u></li> </ul>  <p><font color="#ff8000">RibbonPanelSource</font>: defines the content and properties of its parent node RibbonPanel. Commands are defined with this node.</p>  <p><font color="#ff8000">local:NWRibbonButton</font>: indicates a button in the ribbon. The attributes include:</p>  <ul>   <li>x:Uid: unique id used in xmal file</li>    <li>Id: Defines a unique identifier for the command</li>    <li>Size: standard (default) or Large. </li>    <li>Image: image to display. It overrides that defined by plug-in attributes in the compiled code. The image path defines the location relative to the ribbon definition file (XAML), hence our image path here indicates that the images are located in an Images subdirectory next to the sub-directory when the ribbon file is located. If you wish you can define the image location relative to the Roamer executable by using Image=&quot;pack://siteOfOrigin:,,,{image location}&quot; where {image location} is the location of the icon (or png file) relative to the executable. Standard images must be 16x16 pixels. For large buttons specify Size=&quot;Large&quot; and define a LargeImage attribute, which must be 32x32 pixels. </li>    <li>KeyTip: the key or combination of keys that enables the button to be activated using the keyboard rather than the mouse. Keytips are made visible by pressing</li>    <li>Orientation: &quot;Horizontal&quot; or &quot;Vertical&quot;. Horizontal places the buttons side by side with the Text. Vertical places the buttons above the text.</li>    <li>ShowText : indicates whether the button should display its Text with the button, or image only. Text: text displayed on the button if ShowText is true. It overrides that defined by plugin attributes in the compiled code)</li> </ul>  <p><font color="#ff8000">local:NWRibbonSplitButton</font>: As the name suggests, this defines the Split button. It can be defined as synchronized with current item (i.e. the last drop-down item clicked appears on the button), or not synchronized with the current item. The button can be clicked independently from the drop-down menu. Most attributes are same to <font color="#ff8000">local:NWRibbonButton</font>.</p>  <ul>   <li>IsSynchronizedWithCurrentItem: synchronized or non- synchronized</li>    <li>IsSplit: indicates that the button can be clicked independently from the drop down, thus activating the current item.</li> </ul>  <p>e.g. </p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><font size="1"><font face="Courier New"><span style="font-family: nsimsun; color: blue; font-size: 12pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">&lt;?</span><span style="font-family: nsimsun; color: maroon; font-size: 12pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">xml</span><span style="font-family: nsimsun; font-size: 12pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"> <span style="color: red">version</span><span style="color: blue">=&quot;1.0&quot;</span> <span style="color: red">encoding</span><span style="color: blue">=&quot;utf-8&quot;</span> <span style="color: blue">?&gt;</span>          <p></p>       </span></font></font></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><font size="1"><font face="Courier New"><span style="font-family: nsimsun; color: blue; font-size: 12pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">&lt;</span><span style="font-family: nsimsun; color: maroon; font-size: 12pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">RibbonControl</span><span style="font-family: nsimsun; font-size: 12pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">         <p></p>       </span></font></font></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 12pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><font size="1"><font face="Courier New"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span><span style="color: red">x</span><span style="color: blue">:</span><span style="color: red">Uid</span><span style="color: blue">=&quot;ADNRibbonDemo&quot;</span> <span style="color: red">xmlns</span><span style="color: blue">=&quot;clr-namespace:Autodesk.Windows;assembly=AdWindows&quot;</span>          <p></p>       </font></font></span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 12pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><font size="1"><font face="Courier New"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span><span style="color: red">xmlns</span><span style="color: blue">:</span><span style="color: red">wpf</span><span style="color: blue">=&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span>          <p></p>       </font></font></span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 12pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><font size="1"><font face="Courier New"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span><span style="color: red">xmlns</span><span style="color: blue">:</span><span style="color: red">adwi</span><span style="color: blue">=&quot;clr-namespace:Autodesk.Internal.Windows;assembly=AdWindows&quot;</span>          <p></p>       </font></font></span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 12pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><font size="1"><font face="Courier New"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span><span style="color: red">xmlns</span><span style="color: blue">:</span><span style="color: red">system</span><span style="color: blue">=&quot;clr-namespace:System;assembly=mscorlib&quot;</span>          <p></p>       </font></font></span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 12pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><font size="1"><font face="Courier New"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span><span style="color: red">xmlns</span><span style="color: blue">:</span><span style="color: red">x</span><span style="color: blue">=&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span><span style="mso-spacerun: yes">&#160;&#160; </span></font></font></span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 12pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><font size="1"><font face="Courier New"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: red">xmlns</span><span style="color: blue">:</span><span style="color: red">local</span><span style="color: blue">=&quot;clr-namespace:Autodesk.Navisworks.Gui.Roamer.AIRLook;assembly=navisworks.gui.roamer&quot;&gt;</span>          <p></p>       </font></font></span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 12pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">     <p><font size="1" face="Courier New">&#160;</font></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 12pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><font size="1"><font face="Courier New"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span><span style="color: blue">&lt;</span><span style="color: maroon">RibbonTab</span> <span style="color: red">Id</span><span style="color: blue">=&quot;ID_CustomTab_1&quot;</span> <span style="color: red">KeyTip</span><span style="color: blue">=&quot;T1&quot;&gt;</span>          <p></p>       </font></font></span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 12pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><font size="1"><font face="Courier New"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: blue">&lt;</span><span style="color: maroon">RibbonPanel</span> <span style="color: red">x</span><span style="color: blue">:</span><span style="color: red">Uid</span><span style="color: blue">=&quot;RibbonPane1_1&quot;&gt;</span>          <p></p>       </font></font></span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 12pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><font size="1"><font face="Courier New"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: blue">&lt;</span><span style="color: maroon">RibbonPanelSource</span> <span style="color: red">x</span><span style="color: blue">:</span><span style="color: red">Uid</span><span style="color: blue">=&quot;RibbonPanelSource_RibbonPanel_1&quot;</span> <span style="color: red">KeyTip</span><span style="color: blue">=&quot;C1&quot;</span> <span style="color: red">Title</span><span style="color: blue">=&quot;Large Button&quot;&gt;</span>          <p></p>       </font></font></span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 12pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US">     <p><font size="1" face="Courier New">&#160;</font></p>   </span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 12pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><font size="1"><font face="Courier New"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: blue">&lt;</span><span style="color: maroon">local</span><span style="color: blue">:</span><span style="color: maroon">NWRibbonButton</span> <span style="color: red">x</span><span style="color: blue">:</span><span style="color: red">Uid</span><span style="color: blue">=&quot;Button_1&quot;</span> <span style="color: red">Id</span><span style="color: blue">=&quot;ID_Button_1&quot;</span>          <p></p>       </font></font></span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 12pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><font size="1"><font face="Courier New"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: red">Size</span><span style="color: blue">=&quot;Large&quot;</span>          <p></p>       </font></font></span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 12pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><font size="1"><font face="Courier New"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: red">KeyTip</span><span style="color: blue">=&quot;B1&quot;</span>          <p></p>       </font></font></span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 12pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><font size="1"><font face="Courier New"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: red">ShowText</span><span style="color: blue">=&quot;True&quot;</span><span style="mso-spacerun: yes">&#160;&#160; </span>          <p></p>       </font></font></span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 12pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><font size="1"><font face="Courier New"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: red">Text</span><span style="color: blue">=&quot;Button 1 in xaml&quot;</span>          <p></p>       </font></font></span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 12pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><font size="1"><font face="Courier New"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: red">Orientation</span><span style="color: blue">=&quot;Vertical&quot;/&gt;</span>          <p></p>       </font></font></span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 12pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><font size="1"><font face="Courier New"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: blue">&lt;/</span><span style="color: maroon">RibbonPanelSource</span><span style="color: blue">&gt;</span>          <p></p>       </font></font></span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 12pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><font size="1"><font face="Courier New"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="color: blue">&lt;/</span><span style="color: maroon">RibbonPanel</span><span style="color: blue">&gt;</span>          <p></p>       </font></font></span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 12pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><font size="1"><font face="Courier New"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160; </span><span style="color: blue">&lt;/</span><span style="color: maroon">RibbonTab</span><span style="color: blue">&gt;</span>          <p></p>       </font></font></span></p>  <p style="text-align: left; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: nsimsun; font-size: 12pt; mso-bidi-font-family: nsimsun; mso-font-kerning: 0pt" lang="EN-US"><font size="1"><font face="Courier New"><span style="mso-spacerun: yes">&#160;</span><span style="color: blue">&lt;/</span><span style="color: maroon">RibbonControl</span><span style="color: blue">&gt;</span></font></font></span></p>  <p>In our sample, the grouped buttons (Button4 and Button5) are designed as Synchronize.</p>  <p><b>Name File for Localization</b></p>  <p>This is a text file with the extension *<i>.name</i>. It defines the localized text for ribbon tabs and commands. The strings defined in the xaml layout file overrides strings defined in the name file. That implies that Navisworks will ignore the strings in *.name file if you specify the strings in xaml. So the name file is not required when the xaml file is language-specific. The name file in our sample provides display names for all tabs and buttons. This file uses UTF8 encoding. Lines starting with # or $, or ending with = means do not need translating. e.g.</p>  <blockquote>   <p><font color="#808080"># This is comments</font></p>    <p><font color="#808080">$ This is comments</font></p>    <p><font color="#808080">ID_CustomTab_2.DisplayName=</font></p>    <p><font color="#808080">Tab2 in name file</font></p>    <p><font color="#808080">ID_Button_1.DisplayName=</font></p>    <p><font color="#808080">Button1 in name file</font></p> </blockquote>  <p>In general, the icon of the command is specified with a relative path, while the root path is where the plug-in dll resides in. It is recommended to create one sub-folder for storing these images.</p>  <p>Now that the whole application is available. We shall build the project to generate the <i>ADNRibbonDemo.dll</i>. </p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01774348c36f970d-pi"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="/assets/image_724730.jpg" width="389" height="292" /></a> </p>  <p>(To be continued) </p>
