---
layout: "post"
title: "Keynote Table Reload and Happy iPhone day!"
date: "2014-09-09 09:17:16"
author: "Jaime Rosales"
categories:
  - ".NET"
  - "Jaime Rosales"
  - "Off-topic"
  - "Revit"
  - "Revit Architecture"
  - "Revit MEP"
  - "Revit Structure"
original_url: "https://adndevblog.typepad.com/aec/2014/09/keynote-table-reload-and-happy-iphone-day.html "
typepad_basename: "keynote-table-reload-and-happy-iphone-day"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/aec/jaime-rosales.html">Jaime Rosales</a>&#0160;</p>
<p style="text-align: left">So it’s here, the day that all of you Apple lovers (including myself) have been waiting for (again for another year). The announcement of a new mobile device it is only a couple of hours away and rumors says that a possible iWatch will be announced as well. Let’s see if Jony Ive’s quote “Switzerland is in trouble” will fulfill our expectations of a good watch. Here is a list of Apple Event Essentials to follow.</p>
<p style="text-align: left">&#0160;</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b7c6dcb4fe970b-pi" target="_blank"><img alt="Iphone Day" border="0" height="581" src="/assets/image_579991.jpg" style="display: inline; border: 0px;" title="Iphone Day" width="480" /></a></p>
<p>Back to Revit. Today’s post came from the Autodesk forum, and it is regarding the use of a new class implemented in the 2015 SDK.</p>
<p><a href="http://forums.autodesk.com/t5/revit-api/keybasedtreeentrytable-reload/td-p/5251297" title="http://forums.autodesk.com/t5/revit-api/keybasedtreeentrytable-reload/td-p/5251297">http://forums.autodesk.com/t5/revit-api/keybasedtreeentrytable-reload/td-p/5251297</a></p>
<p><strong>Question: </strong>I am trying to create a simple button that reloads the Keynotes file. Not sure how to code it as I have not coded in Revit. I did my first Revit plugin, but I am not sure how to call this function.&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;</p>
<p>KeyBasedTreeEntryTable.Reload();</p>
<p>I take I need better understanding of the public result execute.</p>
<p>thanks</p>
<pre style="font-size: 13px; font-family: consolas; background: #1e1e1e; color: gainsboro;"><span style="color: #569cd6;">public</span>&#0160;<span style="color: #b8d7a3;">Result</span>&#0160;<span style="color: white;">Execute</span>(<br />&#0160;&#0160;&#0160; <span style="color: #4ec9b0;">ExternalCommandData</span>&#0160;<span style="color: white;">commandData</span>,<br />&#0160;&#0160;&#0160; <span style="color: #569cd6;">ref</span>&#0160;<span style="color: #569cd6;">string</span>&#0160;<span style="color: white;">message</span>,<br />&#0160;&#0160;&#0160; <span style="color: #4ec9b0;">ElementSet</span>&#0160;<span style="color: white;">elements</span>)<br />{<br />&#0160; <span style="color: #608b4e;">//Get application and document objects</span><br />&#0160; <span style="color: #4ec9b0;">UIApplication</span>&#0160;<span style="color: white;">uiApp</span>&#0160;<span style="color: #b4b4b4;">=</span>&#0160;<span style="color: white;">commandData</span><span style="color: #b4b4b4;">.</span><span style="color: white;">Application</span>;<br />&#0160; <span style="color: #4ec9b0;">Document</span>&#0160;<span style="color: white;">doc</span>&#0160;<span style="color: #b4b4b4;">=</span>&#0160;<span style="color: white;">uiApp</span><span style="color: #b4b4b4;">.</span><span style="color: white;">ActiveUIDocument</span><span style="color: #b4b4b4;">.</span><span style="color: white;">Document</span>;<br />&#0160; <span style="color: #4ec9b0;">KeyBasedTreeEntryTable</span><span style="color: #b4b4b4;">.</span><span style="color: white;">Reload</span>();<br />&#0160; <span style="color: #569cd6;">return</span>&#0160;<span style="color: #b8d7a3;">Result</span><span style="color: #b4b4b4;">.</span><span style="color: white;">Succeeded</span>;<br />}</pre>
<p>Unfortunately the way the reload function is being used there will not be the correct one.</p>
<p>The answer came from one of our great Revit Engineers.</p>
<p><strong>Answer: </strong>If what you want&#0160; is just to reload the keynote table from its current location, you should:</p>
<p>1.) Call KeynoteTable.GetKeynoteTable(Document doc). This is a static function which will get you the document&#39;s keynote table. (You will need to pass in the current document as an argument.)</p>
<p>2.) Then you can call Reload() on the keynote table object.</p>
<p>If you want to reload the keynote table from a different location, you should call LoadFrom instead. That function takes in an ExternalResourceReference argument. If you want to load the table from a normal file on disk, you can create an ExternalResourceReference via ExternalResourceReference.CreateLocalResource.</p>
<p>Here is a snippet of code simply showing the 2 steps from the answer above on how to use the reload function from its current location on a command call, nothing too fancy.</p>
<pre style="font-size: 13px; font-family: consolas; background: #1e1e1e; color: gainsboro;"><span style="color: #569cd6;">public</span>&#0160;<span style="color: #b8d7a3;">Result</span>&#0160;<span style="color: white;">Execute</span>(<br />&#0160; <span style="color: #4ec9b0;">ExternalCommandData</span>&#0160;<span style="color: white;">commandData</span>,<br />&#0160; <span style="color: #569cd6;">ref</span>&#0160;<span style="color: #569cd6;">string</span>&#0160;<span style="color: white;">message</span>,<br />&#0160; <span style="color: #4ec9b0;">ElementSet</span>&#0160;<span style="color: white;">elements</span>)<br />{<br />&#0160;&#0160;&#0160; <span style="color: #4ec9b0;">UIApplication</span>&#0160;<span style="color: white;">uiapp</span>&#0160;<span style="color: #b4b4b4;">=</span>&#0160;<span style="color: white;">commandData</span><span style="color: #b4b4b4;">.</span><span style="color: white;">Application</span>;<br />&#0160;&#0160;&#0160; <span style="color: #4ec9b0;">UIDocument</span>&#0160;<span style="color: white;">uidoc</span>&#0160;<span style="color: #b4b4b4;">=</span>&#0160;<span style="color: white;">uiapp</span><span style="color: #b4b4b4;">.</span><span style="color: white;">ActiveUIDocument</span>;<br />&#0160;&#0160;&#0160; <span style="color: #4ec9b0;">Application</span>&#0160;<span style="color: white;">app</span>&#0160;<span style="color: #b4b4b4;">=</span>&#0160;<span style="color: white;">uiapp</span><span style="color: #b4b4b4;">.</span><span style="color: white;">Application</span>;<br />&#0160;&#0160;&#0160; <span style="color: #4ec9b0;">Document</span>&#0160;<span style="color: white;">doc</span>&#0160;<span style="color: #b4b4b4;">=</span>&#0160;<span style="color: white;">uidoc</span><span style="color: #b4b4b4;">.</span><span style="color: white;">Document</span>;<br /> <br />&#0160;&#0160;&#0160; <span style="color: #4ec9b0;">Transaction</span>&#0160;<span style="color: white;">tr</span>&#0160;<span style="color: #b4b4b4;">=</span>&#0160;<span style="color: #569cd6;">new</span>&#0160;<span style="color: #4ec9b0;">Transaction</span>(<span style="color: white;">doc</span>, <span style="color: #d69d85;">&quot;Reload&quot;</span>);<br />&#0160;&#0160;&#0160; <span style="color: white;">tr</span><span style="color: #b4b4b4;">.</span><span style="color: white;">Start</span>();<br /> <br />&#0160;&#0160;&#0160; <span style="color: #4ec9b0;">KeynoteTable</span><span style="color: #b4b4b4;">.</span><span style="color: white;">GetKeynoteTable</span>(<span style="color: white;">doc</span>)<span style="color: #b4b4b4;">.</span><span style="color: white;">Reload</span>(<span style="color: #569cd6;">null</span>);<br /> <br />&#0160;&#0160;&#0160; <span style="color: white;">tr</span><span style="color: #b4b4b4;">.</span><span style="color: white;">Commit</span>();<br />&#0160;&#0160;&#0160; <span style="color: #569cd6;">return</span>&#0160;<span style="color: #b8d7a3;">Result</span><span style="color: #b4b4b4;">.</span><span style="color: white;">Succeeded</span>;<br />}</pre>
<p>Thanks for reading, until next time.</p>
