---
layout: "post"
title: "Closest Grid Point Intersection to an Object"
date: "2014-01-08 19:41:31"
author: "Xiaodong Liang"
categories:
  - ".NET"
  - "Navisworks"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/aec/2014/01/closest-grid-point-intersection-to-an-object.html "
typepad_basename: "closest-grid-point-intersection-to-an-object"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/aec/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>  <p><strong>Question</strong>:</p>  <p>I'm trying to create a plugin to add to a specific/selected object the closest grid intersection point in a property user tab.This should basically be similar to what the clash detective &quot;Grid Intersection&quot; shows.&#160; <br />Should I use the &quot;GridIntersection Class&quot; to do this? And if so, where should I start?</p>  <p><strong>Solution</strong>:     <br />Given a referenced point, you can use GridSystem.ClosestIntersection(point) to get the closest GridIntersection which tells the postion, level, line1 and line2 of the intersection.     <br />The referenced point of &quot;Grid Intersection&quot; in Clash Detective may probably be ClashResult.Center.     <br />In this case, we could use the BoundingBox center of the object we are interested in. or BoundingBox Max or Min.     <br />The following code is based on <a href="http://adndevblog.typepad.com/aec/2013/06/navisworks-2014-api-new-feature-toolplugin.html">ToolsPlugin</a> which is introduced from Navisworks 2014. In custom tool mode, the closest grid insection point will be marked as a sphere graphics when the user selects an object.</p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><font face="Times New Roman"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font style="font-size: 8pt" color="#000000"> Autodesk.Navisworks.Api;</font></span></font></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><font face="Times New Roman"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#0000ff"><font style="font-size: 8pt">using</font></font></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font style="font-size: 8pt" color="#000000"> Autodesk.Navisworks.Api.Plugins;</font></span></font></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><font face="Times New Roman"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#0000ff"><font style="font-size: 8pt">namespace</font></font></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font style="font-size: 8pt" color="#000000"> CustomGraphics</font></span></font></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font style="font-size: 8pt" color="#000000">{</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><span><font style="font-size: 8pt" color="#008000">// The ToolPlugin example.</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160; </font></span><font style="font-size: 8pt">[</font></font><font style="font-size: 8pt"><span><font color="#2b91af">Plugin</font></span><font color="#000000">(</font><span><font color="#a31515">&quot;ToolPluginTest&quot;</font></span><font color="#000000">, </font><span><font color="#a31515">&quot;ADSK&quot;</font></span><font color="#000000">)]</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span><font color="#0000ff">public</font></span><font color="#000000"> </font><span><font color="#0000ff">class</font></span><font color="#000000"> </font><span><font color="#2b91af">ToolPluginTest</font></span><font color="#000000"> : </font></font><span><font style="font-size: 8pt" color="#2b91af">ToolPlugin</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160; </font></span><font style="font-size: 8pt">{</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span><font color="#0000ff">public</font></span><font color="#000000"> </font><span><font color="#2b91af">ModelItem</font></span><font color="#000000"> clickedModel = </font><span><font color="#0000ff">null</font></span><font color="#000000">;</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span><font color="#0000ff">public</font></span><font color="#000000"> </font><span><font color="#0000ff">override</font></span><font color="#000000"> </font><span><font color="#0000ff">bool</font></span><font color="#000000"> MouseDown(</font><span><font color="#2b91af">View</font></span><font color="#000000"> view,</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span><font color="#2b91af">KeyModifiers</font></span><font color="#000000"> modifiers,</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span></font></font><font style="font-size: 8pt"><span><font color="#0000ff">ushort</font></span><font color="#000000"> button,</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span><font color="#0000ff">int</font></span><font color="#000000"> x,</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span><font color="#0000ff">int</font></span><font color="#000000"> y,</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span><font color="#0000ff">double</font></span><font color="#000000"> timeOffset)</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">{</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span><font style="font-size: 8pt" color="#008000">// get current selection </font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span><font color="#2b91af">PickItemResult</font></span><font color="#000000"> itemResult =</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">view.PickItemFromPoint(x, y);</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span><font color="#0000ff">if</font></span><font color="#000000"> (itemResult != </font><span><font color="#0000ff">null</font></span><font color="#000000">)</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">{</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">clickedModel =</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">itemResult.ModelItem;</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span><font color="#2b91af">Application</font></span><font color="#000000">.ActiveDocument.ActiveView.</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">RequestDelayedRedraw(</font></font><font style="font-size: 8pt"><span><font color="#2b91af">ViewRedrawRequests</font></span><font color="#000000">.Render);</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">}</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span><font color="#0000ff">return</font></span><font color="#000000"> </font><span><font color="#0000ff">false</font></span><font color="#000000">;</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">}</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span><font color="#0000ff">public</font></span><font color="#000000"> </font><span><font color="#2b91af">Point3D</font></span><font color="#000000"> GetClosestGridIntersection()</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">{</font><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span><font style="font-size: 8pt" color="#008000">//check that selection is valid</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span><font color="#0000ff">if</font></span><font color="#000000"> (clickedModel != </font><span><font color="#0000ff">null</font></span><font color="#000000">)</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">{</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span><font style="font-size: 8pt" color="#008000">//Get bounding box of the selection</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span><font color="#2b91af">BoundingBox3D</font></span><font color="#000000"> bb3d =</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">clickedModel.BoundingBox();</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span><font color="#2b91af">GridSystem</font></span><font color="#000000"> oGS = Autodesk.Navisworks.Api.</font><span><font color="#2b91af">Application</font></span><font color="#000000">.ActiveDocument.Grids.ActiveSystem;</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt"><span style="mso-spacerun: yes">&#160; </span></font></font><font style="font-size: 8pt"><span><font color="#0000ff">if</font></span><font color="#000000"> (oGS != </font><span><font color="#0000ff">null</font></span><font color="#000000">)</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span><font style="font-size: 8pt" color="#008000">//get the closest grid intersection point</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">{</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span><font color="#2b91af">GridIntersection</font></span><font color="#000000"> oGridIntersection = oGS.ClosestIntersection(bb3d.Center);</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span><font color="#0000ff">return</font></span><font color="#000000"> oGridIntersection.Position;</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160; </span>}</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">}</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span><font color="#0000ff">return</font></span><font color="#000000"> </font><span><font color="#0000ff">null</font></span><font color="#000000">;</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">}</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span><font color="#0000ff">public</font></span><font color="#000000"> </font><span><font color="#0000ff">override</font></span><font color="#000000"> </font><span><font color="#0000ff">void</font></span><font color="#000000"> OverlayRenderModel(</font><span><font color="#2b91af">View</font></span><font color="#000000"> view, </font><span><font color="#2b91af">Graphics</font></span><font color="#000000"> graphics)</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">{</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span><font color="#0000ff">if</font></span><font color="#000000"> (clickedModel != </font><span><font color="#0000ff">null</font></span><font color="#000000">)</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">{</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span><font style="font-size: 8pt" color="#008000">//color for graphics</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span><font color="#2b91af">Color</font></span><font color="#000000"> yellow = </font><span><font color="#2b91af">Color</font></span><font color="#000000">.FromByteRGB(255, 255, 0);</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">graphics.Color(yellow, 0.8);</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span><font style="font-size: 8pt" color="#008000">//center of the current selection</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span><font color="#2b91af">Point3D</font></span><font color="#000000"> oCenter = GetClosestGridIntersection();</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span><font color="#0000ff">if</font></span><font color="#000000"> (oCenter != </font><span><font color="#0000ff">null</font></span><font color="#000000">)</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span></font></font><span><font style="font-size: 8pt" color="#008000">//draw a Sphere</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">graphics.Sphere(oCenter, 1);</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">}</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">}</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160; </font></span><font style="font-size: 8pt">}</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160; </font></span><font style="font-size: 8pt">[</font></font><font style="font-size: 8pt"><span><font color="#2b91af">Plugin</font></span><font color="#000000">(</font><span><font color="#a31515">&quot;EnableToolPluginExample&quot;</font></span><font color="#000000">, </font><span><font color="#a31515">&quot;ADSK&quot;</font></span><font color="#000000">,</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">DisplayName = </font></font><font style="font-size: 8pt"><span><font color="#a31515">&quot;EnableToolPlugin&quot;</font></span><font color="#000000">)]</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span><font color="#0000ff">public</font></span><font color="#000000"> </font><span><font color="#0000ff">class</font></span><font color="#000000"> </font><span><font color="#2b91af">EnableToolPluginExample</font></span><font color="#000000"> : </font></font><span><font style="font-size: 8pt" color="#2b91af">AddInPlugin</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160; </font></span><font style="font-size: 8pt">{</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span><font color="#0000ff">static</font></span><font color="#000000"> </font><span><font color="#0000ff">bool</font></span><font color="#000000"> enable = </font><span><font color="#0000ff">false</font></span><font color="#000000">;</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span><font color="#0000ff">public</font></span><font color="#000000"> </font><span><font color="#0000ff">override</font></span><font color="#000000"> </font><span><font color="#0000ff">int</font></span><font color="#000000"> Execute(</font><span><font color="#0000ff">params</font></span><font color="#000000"> </font><span><font color="#0000ff">string</font></span><font color="#000000">[] parameters)</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">{</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span><font color="#0000ff">if</font></span><font color="#000000"> (enable)</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">{</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span><font style="font-size: 8pt" color="#008000">//switch to the native tool </font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span><font color="#2b91af">Application</font></span><font color="#000000">.MainDocument.Tool.Value = </font><span><font color="#2b91af">Tool</font></span><font color="#000000">.Select;</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span><font style="font-size: 8pt" color="#008000">//switch to custom tool</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span><font color="#2b91af">ToolPluginRecord</font></span><font color="#000000"> toolPluginRecord =</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">(</font></font><font style="font-size: 8pt"><span><font color="#2b91af">ToolPluginRecord</font></span><font color="#000000">)</font><span><font color="#2b91af">Application</font></span><font color="#000000">.Plugins.FindPlugin(</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span><font color="#a31515">&quot;ToolPluginTest.ADSK&quot;</font></span><font color="#000000">);</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span><font color="#2b91af">ToolPluginTest</font></span><font color="#000000"> oPlugin = (</font><span><font color="#2b91af">ToolPluginTest</font></span><font color="#000000">)toolPluginRecord.LoadedPlugin;</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">oPlugin.clickedModel = </font></font><font style="font-size: 8pt"><span><font color="#0000ff">null</font></span><font color="#000000">;</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">}</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span><font style="font-size: 8pt" color="#0000ff">else</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">{</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span><font style="font-size: 8pt" color="#008000">//switch to custom tool</font></span></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span><font color="#2b91af">ToolPluginRecord</font></span><font color="#000000"> toolPluginRecord =</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">(</font></font><font style="font-size: 8pt"><span><font color="#2b91af">ToolPluginRecord</font></span><font color="#000000">)</font><span><font color="#2b91af">Application</font></span><font color="#000000">.Plugins.FindPlugin(</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span><font color="#a31515">&quot;ToolPluginTest.ADSK&quot;</font></span><font color="#000000">);</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span><font color="#2b91af">Application</font></span><font color="#000000">.MainDocument.Tool.</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">SetCustomToolPlugin(toolPluginRecord.LoadPlugin());</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">}</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">enable = !enable;</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span><font color="#0000ff">return</font></span><font color="#000000"> 0;</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">}</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160; </font></span><font style="font-size: 8pt">}</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes"><font face="Times New Roman"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font style="font-size: 8pt" color="#000000">}</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Times New Roman"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="text-justify: inter-ideograph; line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal" align="justify"><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01a3fbea425e970b-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="/assets/image_912028.jpg" width="373" height="318" /></a></p>
