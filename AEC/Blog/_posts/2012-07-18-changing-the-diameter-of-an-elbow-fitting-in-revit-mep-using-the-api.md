---
layout: "post"
title: "Changing the Diameter of an Elbow fitting in Revit MEP using the API"
date: "2012-07-18 09:50:46"
author: "Saikat Bhattacharya"
categories:
  - ".NET"
  - "Revit"
  - "Saikat Bhattacharya"
original_url: "https://adndevblog.typepad.com/aec/2012/07/changing-the-diameter-of-an-elbow-fitting-in-revit-mep-using-the-api.html "
typepad_basename: "changing-the-diameter-of-an-elbow-fitting-in-revit-mep-using-the-api"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/aec/saikat-bhattacharya.html">Saikat Bhattacharya</a></p>
<p>Most of the time, the optimal approach to any API related task/workflow comes out of finding out the best approach of achieving the same using the product user interface (UI) and replicating the same using the API. For example, to change the diameter of an elbow fitting, creating a quick instance of an elbow fitting using Revit UI, shows us that the Nominal Diameter parameter is disabled/greyed out. The Nominal Radius parameter is however enabled and can be modified using the UI.</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01761688fa61970c-pi"><img alt="image" border="0" height="281" src="/assets/image_511919.jpg" style="background-image: none; padding-left: 0px; padding-right: 0px; display: block; float: none; margin-left: auto; margin-right: auto; padding-top: 0px; border-width: 0px;" title="image" width="310" /></a></p>
<p>Taking clues from this, we now know that we should be attempting to modify the nominal radius of the elbow fitting using the API, as shown below:</p>
<p><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">using</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;"> System;</span></span></span></p>
<div style="background: white;">
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">using</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;"> System.Collections.Generic;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">using</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;"> System.Text;</span></span></span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">using</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;"> Autodesk.Revit.Attributes;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">using</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;"> Autodesk.Revit.DB;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">using</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;"> Autodesk.Revit.UI;</span></span></span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #0000ff;"><span style="font-size: 8pt;">namespace</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;"> Revit.SDK.Samples.HelloRevit.CS</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Courier New;"><span style="color: #000000; font-size: 8pt;">{</span></span></span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; [</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">Transaction</span></span><span style="line-height: 11pt;"><span style="color: #000000;">(</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">TransactionMode</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;">.Manual)]</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">class</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Command</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> : </span></span></span><span style="line-height: 11pt;"><span style="color: #2b91af; font-size: 8pt;">IExternalCommand</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Courier New;"><span style="color: #000000; font-size: 8pt;">&#0160; {&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">public</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Result</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> Execute(</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">ExternalCommandData</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;"> commandData, </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">ref</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">string</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;"> message, </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">ElementSet</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;"> elements)</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Courier New;"><span style="color: #000000; font-size: 8pt;">&#0160;&#0160;&#0160; {</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">UIApplication</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;"> uiApp = commandData.Application;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">UIDocument</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;"> uiDoc = uiApp.ActiveUIDocument;</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;</span></span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">Transaction</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> trans = </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">new</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Transaction</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;">(uiDoc.Document);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160; trans.Start(</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;ChangeDia&quot;</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;">);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;</span></span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="color: #008000; font-size: 8pt;">// For simplicity, we have pre-selected the Elbow Fitting</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">foreach</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> (</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Element</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> elbowElement </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">in</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;"> uiDoc.Selection.Elements)</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Courier New;"><span style="color: #000000; font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160; {</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="color: #008000; font-size: 8pt;">// Since elbow fitting is of FamilyInstance type,</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">FamilyInstance</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> famInst = elbowElement </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">as</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">FamilyInstance</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;">;</span></span></span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">if</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> (</span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">null</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;"> != famInst)</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Courier New;"><span style="color: #000000; font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="color: #008000; font-size: 8pt;">// Set the Nominal Radius, since Diameter was disabled</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">Parameter</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> param = famInst.get_Parameter(</span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;Nominal Radius&quot;</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;">);</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Courier New;"><span style="color: #000000; font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; param.Set(3 * 0.08333);</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Courier New;"><span style="color: #000000; font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Courier New;"><span style="color: #000000; font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160; }</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Courier New;"><span style="color: #000000; font-size: 8pt;">&#0160;</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Courier New;"><span style="color: #000000; font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160; trans.Commit();</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">return</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Result</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;">.Succeeded;</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Courier New;"><span style="color: #000000; font-size: 8pt;">&#0160;&#0160;&#0160; }&#0160; </span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Courier New;"><span style="color: #000000; font-size: 8pt;">&#0160; }</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Courier New;"><span style="color: #000000; font-size: 8pt;">}</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Courier New; color: #000000;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="color: #000000;">And the modified elbow fitting with the new radius is now reflected on the UI as well (however non-functional this might appear <img alt="Smile" class="wlEmoticon wlEmoticon-smile" src="/assets/image_255329.jpg" style="border-style: none;" />)</span></span></p>
</div>
<p>&#0160;</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b016768941aa4970b-pi"><img alt="image" border="0" height="244" src="/assets/image_655540.jpg" style="background-image: none; padding-left: 0px; padding-right: 0px; display: block; float: none; margin-left: auto; margin-right: auto; padding-top: 0px; border: 0px;" title="image" width="234" /></a></p>
