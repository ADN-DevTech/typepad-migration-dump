---
layout: "post"
title: "Experiential learning : GbXMLCloudSync App"
date: "2012-06-22 08:00:00"
author: "Saikat Bhattacharya"
categories:
  - ".NET"
  - "Cloud"
  - "Revit"
  - "Saikat Bhattacharya"
original_url: "https://adndevblog.typepad.com/aec/2012/06/experiential-learning-gbxmlcloudsync-app.html "
typepad_basename: "experiential-learning-gbxmlcloudsync-app"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/aec/saikat-bhattacharya.html" target="_self">Saikat Bhattacharya</a></p>  <p>This post has been overdue – this is in continuation to my <a href="http://adndevblog.typepad.com/aec/2012/05/experiential-learning-how-to-use-the-blob-storage-service.html" target="_blank">previous post</a> on this topic and also to wrap up my first phase of experiential learning with the Cloud.</p>  <p>In this post, I will try to elaborate on the app that I created to put this learning to use and also picked up a simple use-case where this app might eventually be useful as well.</p>  <p>So at first, the use-case:</p>  <p>Let’s assume - I am an Architect (well atleast I did study Architecture during my undergrad degree) designing a 500 bed hospital project for the last couple of months. We are at the last stages of design and am currently working with a Autodesk Ecotect Analysis to do a detailed study of my design and its environmental analysis. I woke up this morning and realized that I had to split one of the big rooms into small units (design being such an iterative process, this is not a surprise at all) and so while having breakfast, I use Revit on my home PC and make the changes to the model (let&#39;s assume have got it off the file sharing server we have in our Design office). I have the GbXMLCloudSync app installed too and this app exports the Revit model to GbXML format while pushing it to the cloud, every time I do some changes in the model and save the changes.&#0160; After completing the design changes, I drop my son to his preschool, head to the office and grab the latest GbXML file from the Cloud using this app in Revit and resume my work with Autodesk Ecotect Analysis. I did not have to worry about locating and working with the latest and most updated version of the GbXML file of my model (so ensured accessibility and version control) and neither was there any fear of losing the data since it was all safely and securely stored in the Cloud (safe and secure storage).</p>  <p>I hope this use-case sounded real/convincing enough! <img alt="Smile" class="wlEmoticon wlEmoticon-smile" src="/assets/image_851014.jpg" style="border-bottom-style: none; border-right-style: none; border-top-style: none; border-left-style: none" /></p>  <p>Time for a quick video, demonstrating the app:</p>  <div class="wlWriterEditableSmartContent" id="scid:5737277B-5D6D-4f48-ABFC-DD9C333F4C5D:b72a3541-dcaf-41e4-8bfe-cffed38123a7" style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px"><div id="42bfdcf9-0a87-4454-a980-4f1efded688a" style="margin: 0px; padding: 0px; display: inline;"><div><a href="http://www.youtube.com/watch?v=6sLlrZeihgI" target="_new"><img alt="" galleryimg="no" onload="var downlevelDiv = document.getElementById(&#39;42bfdcf9-0a87-4454-a980-4f1efded688a&#39;); downlevelDiv.innerHTML = &quot;&lt;div&gt;&lt;object width=\&quot;448\&quot; height=\&quot;336\&quot;&gt;&lt;param name=\&quot;movie\&quot; value=\&quot;http://www.youtube.com/v/6sLlrZeihgI?hl=en&amp;hd=1\&quot;&gt;&lt;\/param&gt;&lt;embed src=\&quot;http://www.youtube.com/v/6sLlrZeihgI?hl=en&amp;hd=1\&quot; type=\&quot;application/x-shockwave-flash\&quot; width=\&quot;448\&quot; height=\&quot;336\&quot;&gt;&lt;\/embed&gt;&lt;\/object&gt;&lt;\/div&gt;&quot;;" src="/assets/image_852150.jpg" style="border-style: none" /></a></div></div><div style="width:448px;clear:both;font-size:.8em">Please watch this video in full screen mode for better clarity</div></div>  <p>After discussing over the use-case, lets us look at how we can create the simple app which leverages the Cloud services – to store the file (GbXML) as a Blob.</p>  <p>To trigger the export of the Revit model to the GbXML format everytime the model is saved, I subscribed to the DocumentSaved event in the OnStartUp event of Revit and this is also where the ribbon button for the app gets created, as shown below -</p>  <div style="background: white">   <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #2b91af"><span style="font-size: 8pt">Result</span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #000000"> </span></span><span style="line-height: 11pt"><span style="color: #2b91af">IExternalApplication</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt">.OnShutdown(</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #2b91af">UIControlledApplication</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> application)</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">{</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160; application.ControlledApplication.DocumentSaved -= </span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #0000ff">new</span></span><span style="line-height: 11pt"><span style="color: #000000"> </span></span><span style="line-height: 11pt"><span style="color: #2b91af">EventHandler</span></span><span style="line-height: 11pt"><span style="color: #000000">&lt;</span></span><span style="line-height: 11pt"><span style="color: #2b91af">DocumentSavedEventArgs</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt">&gt;(</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; ControlledApplication_DocumentSaved);</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #0000ff">return</span></span><span style="line-height: 11pt"><span style="color: #000000"> </span></span><span style="line-height: 11pt"><span style="color: #2b91af">Result</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt">.Succeeded;</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">}</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #2b91af"><span style="font-size: 8pt">Result</span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #000000"> </span></span><span style="line-height: 11pt"><span style="color: #2b91af">IExternalApplication</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt">.OnStartup(</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #2b91af">UIControlledApplication</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> application)</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">{</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160; application.ControlledApplication.DocumentSaved += </span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #0000ff">new</span></span><span style="line-height: 11pt"><span style="color: #000000"> </span></span><span style="line-height: 11pt"><span style="color: #2b91af">EventHandler</span></span><span style="line-height: 11pt"><span style="color: #000000">&lt;</span></span><span style="line-height: 11pt"><span style="color: #2b91af">DocumentSavedEventArgs</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt">&gt;(</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; ControlledApplication_DocumentSaved);</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160; </span></span></span><span style="line-height: 11pt"><span style="color: #0000ff; font-size: 8pt">try</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160; {</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt"><span style="color: #008000; font-size: 8pt">// create a Ribbon panel which contains three </span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt"><span style="color: #008000; font-size: 8pt">// stackable buttons and one single push button</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #0000ff">string</span></span><span style="line-height: 11pt"><span style="color: #000000"> firstPanelName = </span></span><span style="line-height: 11pt"><span style="color: #a31515">&quot;BIM Cloud Sync&quot;</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt">;</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #2b91af">RibbonPanel</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> panel = application.CreateRibbonPanel(</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; firstPanelName);</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt"><span style="color: #008000; font-size: 8pt">// set the information about the command we will </span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt"><span style="color: #008000; font-size: 8pt">// be assigning to the button </span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #2b91af">PushButtonData</span></span><span style="line-height: 11pt"><span style="color: #000000"> pushButtonData = </span></span><span style="line-height: 11pt"><span style="color: #0000ff">new</span></span><span style="line-height: 11pt"><span style="color: #000000"> </span></span><span style="line-height: 11pt"><span style="color: #2b91af">PushButtonData</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt">(</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #a31515">&quot;GbXMLCloudSync&quot;</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt">,</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #a31515">&quot;GbXML Cloud Sync&quot;</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt">,</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; AddInPath,</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #a31515">&quot;GbXMLCloudSync.Command&quot;</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt">);</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt"><span style="color: #008000; font-size: 8pt">//&#39; add a button to the panel </span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #2b91af">PushButton</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> pushButton = panel.AddItem(pushButtonData)</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #0000ff">as</span></span><span style="line-height: 11pt"><span style="color: #000000"> </span></span><span style="line-height: 11pt"><span style="color: #2b91af">PushButton</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt">;</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt"><span style="color: #008000; font-size: 8pt">//&#39; add an icon </span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;&#0160;&#0160; pushButton.LargeImage = LoadPNGImageFromResource(</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #a31515">&quot;GbXMLCloudSync.upgrade_32by32.png&quot;</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt">);</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt"><span style="color: #008000; font-size: 8pt">// add a tooltip </span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;&#0160;&#0160; pushButton.ToolTip =</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #a31515">&quot;Set the Options for the BIM model sync feature with&quot;</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> + </span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #a31515">&quot; various formats in the Cloud!&quot;</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt">;</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt"><span style="color: #008000; font-size: 8pt">// long description</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;&#0160;&#0160; pushButton.LongDescription =</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #a31515">&quot;Specify whether the app will sync with the BIM in &quot;</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt">+</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #a31515">&quot;the Cloud with every save or with every update to &quot;</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> +</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #a31515">&quot;the model. The formats that are available on the &quot;</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> +</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #a31515">&quot;Cloud is GBXML versions of the active model.&quot;</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt">; </span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #0000ff">string</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> path;</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; path = System.IO.</span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #2b91af">Path</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt">.GetDirectoryName(</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; System.Reflection.</span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #2b91af">Assembly</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt">.</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; GetExecutingAssembly().Location);</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #0000ff">return</span></span><span style="line-height: 11pt"><span style="color: #000000"> Autodesk.Revit.UI.</span></span><span style="line-height: 11pt"><span style="color: #2b91af">Result</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt">.Succeeded;</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160; }</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #0000ff">catch</span></span><span style="line-height: 11pt"><span style="color: #000000"> (</span></span><span style="line-height: 11pt"><span style="color: #2b91af">Exception</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> ex)</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160; {</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #2b91af">TaskDialog</span></span><span style="line-height: 11pt"><span style="color: #000000">.Show(ex.ToString(), </span></span><span style="line-height: 11pt"><span style="color: #a31515">&quot;BIM Cloud Sync Ribbon&quot;</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt">);</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #0000ff">return</span></span><span style="line-height: 11pt"><span style="color: #000000"> Autodesk.Revit.UI.</span></span><span style="line-height: 11pt"><span style="color: #2b91af">Result</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt">.Failed;</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160; }</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">}</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #808080"><span style="font-size: 8pt">///</span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #008000"> </span></span></span><span style="line-height: 11pt"><span style="color: #808080; font-size: 8pt">&lt;summary&gt;</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #808080"><span style="font-size: 8pt">///</span></span></span><span style="line-height: 11pt"><span style="color: #008000; font-size: 8pt"> Load the bitmap from resource. The resource image </span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #808080"><span style="font-size: 8pt">///</span></span></span><span style="line-height: 11pt"><span style="color: #008000; font-size: 8pt"> &#39;Build action&#39; must be set to &#39;Embeded resource&#39;.</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #808080"><span style="font-size: 8pt">///</span></span></span><span style="line-height: 11pt"><span style="color: #008000; font-size: 8pt"> PNG extension supports transparency.</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #808080"><span style="font-size: 8pt">///</span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #008000"> </span></span></span><span style="line-height: 11pt"><span style="color: #808080; font-size: 8pt">&lt;/summary&gt;</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #808080"><span style="font-size: 8pt">///</span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #008000"> </span></span><span style="line-height: 11pt"><span style="color: #808080">&lt;param name=&quot;imageResourceName&quot;&gt;</span></span><span style="line-height: 11pt"><span style="color: #008000">Resource name .PNG</span></span></span><span style="line-height: 11pt"><span style="color: #808080; font-size: 8pt">&lt;/param&gt;</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #808080"><span style="font-size: 8pt">///</span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #008000"> </span></span><span style="line-height: 11pt"><span style="color: #808080">&lt;returns&gt;</span></span><span style="line-height: 11pt"><span style="color: #008000">The loaded image</span></span></span><span style="line-height: 11pt"><span style="color: #808080; font-size: 8pt">&lt;/returns&gt;</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #0000ff"><span style="font-size: 8pt">private</span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #000000"> </span></span><span style="line-height: 11pt"><span style="color: #0000ff">static</span></span><span style="line-height: 11pt"><span style="color: #000000"> System.Windows.Media.</span></span></span><span style="line-height: 11pt"><span style="color: #2b91af; font-size: 8pt">ImageSource</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160; LoadPNGImageFromResource(</span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #0000ff">string</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> imageResourceName)</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">{</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160; System.Reflection.</span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #2b91af">Assembly</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> dotNetAssembly =</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; System.Reflection.</span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #2b91af">Assembly</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt">.GetExecutingAssembly();</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160; System.IO.</span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #2b91af">Stream</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> iconStream =</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;&#0160;&#0160; dotNetAssembly.GetManifestResourceStream(imageResourceName);</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160; System.Windows.Media.Imaging.</span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #2b91af">PngBitmapDecoder</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> bitmapDecoder =</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #0000ff">new</span></span><span style="line-height: 11pt"><span style="color: #000000"> System.Windows.Media.Imaging.</span></span><span style="line-height: 11pt"><span style="color: #2b91af">PngBitmapDecoder</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt">(iconStream,</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; System.Windows.Media.Imaging.</span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #2b91af">BitmapCreateOptions</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt">.</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; PreservePixelFormat, System.Windows.Media.Imaging.</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #2b91af">BitmapCacheOption</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt">.Default);</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160; System.Windows.Media.</span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #2b91af">ImageSource</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> imageSource =</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;&#0160;&#0160; bitmapDecoder.Frames[0];</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #0000ff">return</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> imageSource;</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">}</span></span></span></p> </div>  <p>In the DocumentSaved event handler, all that needed to be done was to export the Revit model to a GBXML file using the Document.Export() method. For the sake of simplicity, the exported GbXML file is saved to a particular location in the Temp folder. If desired, we can also add a line of code to delete this temporary GbXML file after it has been pushed to the Cloud.</p>  <div style="background: white">   <div style="background: white">     <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;&#0160; </span></span></span></p>   </div>    <div style="background: white">     <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #0000ff"><span style="font-size: 8pt">void</span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #000000"> ControlledApplication_DocumentSaved(</span></span><span style="line-height: 11pt"><span style="color: #0000ff">object</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> sender, </span></span></span></p>      <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #2b91af">DocumentSavedEventArgs</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> e)</span></span></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">{</span></span></span></p>      <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #0000ff">if</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> (withEverySave)</span></span></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160; {</span></span></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;&#0160;&#0160; Export(e.Document);</span></span></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160; }</span></span></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">}</span></span></span></p>      <p style="margin: 0px"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></p>      <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #0000ff"><span style="font-size: 8pt">private</span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #000000"> </span></span><span style="line-height: 11pt"><span style="color: #0000ff">void</span></span><span style="line-height: 11pt"><span style="color: #000000"> Export(</span></span><span style="line-height: 11pt"><span style="color: #2b91af">Document</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> doc)</span></span></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">{</span></span></span></p>      <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160; </span></span></span><span style="line-height: 11pt"><span style="color: #0000ff; font-size: 8pt">try</span></span></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160; {</span></span></span></p>      <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #2b91af">Transaction</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> transaction = </span></span></span></p>      <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #0000ff">new</span></span><span style="line-height: 11pt"><span style="color: #000000"> </span></span><span style="line-height: 11pt"><span style="color: #2b91af">Transaction</span></span><span style="line-height: 11pt"><span style="color: #000000">(doc, </span></span><span style="line-height: 11pt"><span style="color: #a31515">&quot;Export_To_GBXML&quot;</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt">);</span></span></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;&#0160;&#0160; transaction.Start();</span></span></span></p>      <p style="margin: 0px"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></p>      <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #2b91af">GBXMLExportOptions</span></span><span style="line-height: 11pt"><span style="color: #000000"> options = </span></span><span style="line-height: 11pt"><span style="color: #0000ff">new</span></span><span style="line-height: 11pt"><span style="color: #000000"> </span></span><span style="line-height: 11pt"><span style="color: #2b91af">GBXMLExportOptions</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt">();</span></span></span></p>      <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #0000ff">bool</span></span><span style="line-height: 11pt"><span style="color: #000000"> exported = doc.Export(</span></span><span style="line-height: 11pt"><span style="color: #a31515">&quot;C:\\Temp\\&quot;</span></span><span style="line-height: 11pt"><span style="color: #000000">, </span></span><span style="line-height: 11pt"><span style="color: #a31515">&quot;Sample&quot;</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt">, options);</span></span></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;&#0160;&#0160; transaction.Commit();</span></span></span></p>      <p style="margin: 0px"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;&#0160;&#0160; pushToCloud(doc);</span></span></span></p>      <p style="margin: 0px"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></p>      <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt"><span style="color: #008000; font-size: 8pt">//TaskDialog.Show(&quot;Export&quot;, </span></span></span></p>      <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt"><span style="color: #008000; font-size: 8pt">//&#0160; &quot;This is where are exporting to the Cloud!&quot;);</span></span></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160; }</span></span></span></p>      <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #0000ff">catch</span></span><span style="line-height: 11pt"><span style="color: #000000"> (System.</span></span><span style="line-height: 11pt"><span style="color: #2b91af">Exception</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> ex)</span></span></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160; {</span></span></span></p>      <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #2b91af">TaskDialog</span></span><span style="line-height: 11pt"><span style="color: #000000">.Show(</span></span><span style="line-height: 11pt"><span style="color: #a31515">&quot;Exception&quot;</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt">, ex.Message);</span></span></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160; }</span></span></span></p>      <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">}&#0160;&#0160;&#0160; </span></span></span></p>   </div> </div>  <p>And after the export, the file is pushed to the cloud using the Windows Azure Blob Storage Service. You can read up on the basics on Storing any file/content to Azure as a Blob in this <a href="http://www.windowsazure.com/en-us/develop/net/how-to-guides/blob-storage/" target="_blank">guide</a>.</p>  <div style="background: white">   <div style="background: white">     <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #0000ff"><span style="font-size: 8pt">public</span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #000000"> </span></span><span style="line-height: 11pt"><span style="color: #0000ff">static</span></span><span style="line-height: 11pt"><span style="color: #000000"> </span></span><span style="line-height: 11pt"><span style="color: #0000ff">string</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> connStr = </span></span></span></p>      <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #a31515">&quot;DefaultEndpointsProtocol=https; &quot;</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> +</span></span></span></p>      <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #a31515">&quot;AccountName=bimsync; &quot;</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> + </span></span></span></p>      <p style="margin: 0px"><span style="font-family: courier new; color: #000000"><span style="line-height: 11pt">&#0160; </span></span><span style="font-family: courier new"><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #a31515"><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #a31515">&quot;</span></span></span>AccountKey=&lt;accountkey&gt;&quot;</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt">;</span></span></span></p>      <p style="margin: 0px"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></p>   </div>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #0000ff"><span style="font-size: 8pt">void</span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #000000"> pushToCloud(</span></span><span style="line-height: 11pt"><span style="color: #2b91af">Document</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> doc)</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">{</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160; </span></span></span><span style="line-height: 11pt"><span style="color: #0000ff; font-size: 8pt">try</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160; {&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #0000ff">var</span></span><span style="line-height: 11pt"><span style="color: #000000"> storageAccount = </span></span><span style="line-height: 11pt"><span style="color: #2b91af">CloudStorageAccount</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> </span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; .Parse(connStr); </span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt"><span style="color: #008000; font-size: 8pt">// Create the blob client </span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #2b91af">CloudBlobClient</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> blobClient = </span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; storageAccount.CreateCloudBlobClient();</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;&#0160;&#0160; containerName = doc.Application.Username.ToLower();</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;&#0160;&#0160; blobName = doc.Title.ToLower(); </span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt"><span style="color: #008000; font-size: 8pt">// Retrieve a reference to a container </span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #2b91af">CloudBlobContainer</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> container = </span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; blobClient.GetContainerReference(containerName);</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt"><span style="color: #008000; font-size: 8pt">// Create the container if it doesn&#39;t already exist</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;&#0160;&#0160; container.CreateIfNotExist();</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt"><span style="color: #008000; font-size: 8pt">// Retrieve reference to a blob named after title of the RVT</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #2b91af">CloudBlob</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> blob = container.GetBlobReference(blobName);</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt"><span style="color: #008000; font-size: 8pt">// Create or overwrite the local file</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #0000ff">using</span></span><span style="line-height: 11pt"><span style="color: #000000"> (</span></span><span style="line-height: 11pt"><span style="color: #0000ff">var</span></span><span style="line-height: 11pt"><span style="color: #000000"> fileStream = System.IO.</span></span><span style="line-height: 11pt"><span style="color: #2b91af">File</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt">.OpenRead(</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #a31515">@&quot;C:\Temp\Sample.xml&quot;</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt">))</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;&#0160;&#0160; {</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; blob.UploadFromStream(fileStream);</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;&#0160;&#0160; }</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160; }</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #0000ff">catch</span></span><span style="line-height: 11pt"><span style="color: #000000">(System.</span></span><span style="line-height: 11pt"><span style="color: #2b91af">Exception</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> exm)</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160; {</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #2b91af">TaskDialog</span></span><span style="line-height: 11pt"><span style="color: #000000">.Show(</span></span><span style="line-height: 11pt"><span style="color: #a31515">&quot;PushToCloud Ex&quot;</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt">, exm.Message);</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160; }</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">}&#0160;&#0160; </span></span></span></p> </div>  <p>Before we proceed with the code, in case you are wondering how to get the connection string used in the code snippet above, you can login to Windows Azure Platform and go to the <em>Hosted Services, Storage Accounts &amp; CDN</em> and on selecting the Storage Account (I am asuming you have already created a Storage account), you can see the <em>Primary Access Key</em> in the Properties panel. A screenshot is shown below. This is the same string that should be entered in the &lt;accountkey&gt; field in the code.</p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0177429a2f3c970d-pi"><img alt="image_thumb1" border="0" height="140" src="/assets/image_571295.jpg" style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image_thumb1" width="398" /></a></p>  <p>With this, we have looked at the code which exports the Revit model to GbXML format as a temporary file and then pushes it to the Windows Azure Blob Storage Service.</p>  <p>The other part of the app retrieves a selected Blob, lists all the blobs in the container (which is defined by the user name in Revit) and delete a selected blob. The blob name, as you might have noticed already, is based on the Revit file name itself.</p>  <p>The (self-explanatory) code which covers all of the above mentioned functionality is included below:</p>  <div style="background: white">   <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #0000ff"><span style="font-size: 8pt">private</span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #000000"> </span></span><span style="line-height: 11pt"><span style="color: #0000ff">static</span></span><span style="line-height: 11pt"><span style="color: #000000"> </span></span><span style="line-height: 11pt"><span style="color: #0000ff">void</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> CloudPlubming()</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">{</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160; </span></span></span><span style="line-height: 11pt"><span style="color: #0000ff; font-size: 8pt">try</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160; {</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #0000ff">string</span></span><span style="line-height: 11pt"><span style="color: #000000"> connStr = </span></span><span style="line-height: 11pt"><span style="color: #a31515">&quot;DefaultEndpointsProtocol=https; &quot;</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> +</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #a31515">&quot; AccountName=bimsync; &quot;</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> +</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new; color: #000000"><span style="line-height: 11pt">&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-family: courier new"><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #a31515">&quot;AccountKey=&lt;accountKey&gt;&quot;</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt">;</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt"><span style="color: #008000; font-size: 8pt">// Retrieve storage account from connection-string</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #0000ff">var</span></span><span style="line-height: 11pt"><span style="color: #000000"> storageAccount = </span></span></span><span style="line-height: 11pt"><span style="color: #2b91af; font-size: 8pt">CloudStorageAccount</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; .Parse(connStr);</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt"><span style="color: #008000; font-size: 8pt">// Create the blob client</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #2b91af">CloudBlobClient</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> blobClient = </span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; storageAccount.CreateCloudBlobClient();</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;&#0160;&#0160; containerName = </span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; _cmdData.Application.Application.Username.ToLower();</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt"><span style="color: #008000; font-size: 8pt">// Retrieve reference to a previously created container</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;&#0160;&#0160; container = blobClient.GetContainerReference(containerName);</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160; }</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #0000ff">catch</span></span><span style="line-height: 11pt"><span style="color: #000000"> (System.</span></span><span style="line-height: 11pt"><span style="color: #2b91af">Exception</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> ex)</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160; {</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #2b91af">MessageBox</span></span><span style="line-height: 11pt"><span style="color: #000000">.Show(</span></span><span style="line-height: 11pt"><span style="color: #a31515">&quot;CloudPlumbing&quot;</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt">, ex.Message);</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160; }</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">}</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #0000ff"><span style="font-size: 8pt">private</span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #000000"> </span></span><span style="line-height: 11pt"><span style="color: #0000ff">void</span></span><span style="line-height: 11pt"><span style="color: #000000"> btnDelete_Click(</span></span><span style="line-height: 11pt"><span style="color: #0000ff">object</span></span><span style="line-height: 11pt"><span style="color: #000000"> sender, </span></span><span style="line-height: 11pt"><span style="color: #2b91af">EventArgs</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> e)</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">{</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #0000ff">if</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> (listProjects.SelectedItems.Count &gt; 0 </span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;&#0160;&#0160; &amp;&amp; !listProjects.SelectedItems[0].SubItems[0].Text.Equals(</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #a31515">&quot;None&quot;</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt">))</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160; {</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;&#0160;&#0160; CloudPlubming();</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #0000ff">string</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt">[] Split = </span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; listProjects.SelectedItems[0].SubItems[0].Text.Split(</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #0000ff">new</span></span><span style="line-height: 11pt"><span style="color: #000000"> </span></span><span style="line-height: 11pt"><span style="color: #2b91af">Char</span></span><span style="line-height: 11pt"><span style="color: #000000">[] { </span></span><span style="line-height: 11pt"><span style="color: #a31515">&#39;/&#39;</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> });</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt"><span style="color: #008000; font-size: 8pt">// Retrieve reference to a blob named after title of the RVT</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #2b91af">CloudBlob</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> blob = container.GetBlobReference(</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #2b91af">Convert</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt">.ToString(Split[2]));</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt"><span style="color: #008000; font-size: 8pt">// Delete the blob</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;&#0160;&#0160; blob.Delete();</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;&#0160;&#0160; ListAllBlobs();</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160; }</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160; </span></span></span><span style="line-height: 11pt"><span style="color: #0000ff; font-size: 8pt">else</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160; {</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; System.Windows.Forms.</span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #2b91af">MessageBox</span></span><span style="line-height: 11pt"><span style="color: #000000">.Show(</span></span><span style="line-height: 11pt"><span style="color: #a31515">&quot;Invalid selection!&quot;</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt">);</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160; }</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">}</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #0000ff"><span style="font-size: 8pt">private</span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #000000"> </span></span><span style="line-height: 11pt"><span style="color: #0000ff">void</span></span><span style="line-height: 11pt"><span style="color: #000000"> btnOpen_Click(</span></span><span style="line-height: 11pt"><span style="color: #0000ff">object</span></span><span style="line-height: 11pt"><span style="color: #000000"> sender, </span></span><span style="line-height: 11pt"><span style="color: #2b91af">EventArgs</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> e)</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">{</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #0000ff">if</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> (listProjects.SelectedItems.Count &gt; 0 </span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;&#0160;&#0160; &amp;&amp; !listProjects.SelectedItems[0].SubItems[0].Text.Equals(</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #a31515">&quot;None&quot;</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt">))</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160; {</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;&#0160;&#0160; CloudPlubming();</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #0000ff">string</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt">[] Split = </span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; listProjects.SelectedItems[0].SubItems[0].Text.Split(</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #0000ff">new</span></span><span style="line-height: 11pt"><span style="color: #000000"> </span></span><span style="line-height: 11pt"><span style="color: #2b91af">Char</span></span><span style="line-height: 11pt"><span style="color: #000000">[] { </span></span><span style="line-height: 11pt"><span style="color: #a31515">&#39;/&#39;</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> });</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt"><span style="color: #008000; font-size: 8pt">// Retrieve reference to a blob named after title of the RVT</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #2b91af">CloudBlob</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> blob = container.GetBlobReference(</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #2b91af">Convert</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt">.ToString(Split[2]));</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt"><span style="color: #008000; font-size: 8pt">// Save blob contents to disk</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #0000ff">using</span></span><span style="line-height: 11pt"><span style="color: #000000"> (</span></span><span style="line-height: 11pt"><span style="color: #0000ff">var</span></span><span style="line-height: 11pt"><span style="color: #000000"> fileStream = System.IO.</span></span><span style="line-height: 11pt"><span style="color: #2b91af">File</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt">.OpenWrite(</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #a31515">@&quot;C:\Temp\Sample.xml&quot;</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt">))</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;&#0160;&#0160; {</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; blob.DownloadToStream(fileStream);</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;&#0160;&#0160; }</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt"><span style="color: #008000; font-size: 8pt">// Open the GBXML file</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; System.Diagnostics.</span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #2b91af">Process</span></span><span style="line-height: 11pt"><span style="color: #000000">.Start(</span></span><span style="line-height: 11pt"><span style="color: #a31515">@&quot;C:\Temp\Sample.xml&quot;</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt">);</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160; }</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160; </span></span></span><span style="line-height: 11pt"><span style="color: #0000ff; font-size: 8pt">else</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160; {</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; System.Windows.Forms.</span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #2b91af">MessageBox</span></span><span style="line-height: 11pt"><span style="color: #000000">.Show(</span></span><span style="line-height: 11pt"><span style="color: #a31515">&quot;Invalid selection!&quot;</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt">);</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160; }</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">}</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #0000ff"><span style="font-size: 8pt">private</span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #000000"> </span></span><span style="line-height: 11pt"><span style="color: #0000ff">void</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> ListAllBlobs()</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">{</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160; listProjects.Items.Clear();</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160; CloudPlubming();</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #0000ff">if</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> (container.ListBlobs().Count() &gt; 0)</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160; {</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt"><span style="color: #008000; font-size: 8pt">// Loop over blobs within the container and output </span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt"><span style="color: #008000; font-size: 8pt">// the URI to each of them</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #0000ff">foreach</span></span><span style="line-height: 11pt"><span style="color: #000000"> (</span></span><span style="line-height: 11pt"><span style="color: #0000ff">var</span></span><span style="line-height: 11pt"><span style="color: #000000"> blobItem </span></span><span style="line-height: 11pt"><span style="color: #0000ff">in</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> container.ListBlobs())</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;&#0160;&#0160; {</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;&#0160;&#0160;&#0160;&#0160; listProjects.Items.Add(blobItem.Uri.AbsolutePath);</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;&#0160;&#0160; }</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160; }</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160; </span></span></span><span style="line-height: 11pt"><span style="color: #0000ff; font-size: 8pt">else</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160; {</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #000000"><span style="font-size: 8pt">&#0160;&#0160;&#0160; listProjects.Items.Add(</span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #a31515">&quot;None&quot;</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt">);</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160; }</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">}</span></span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160;</span></span></p>    <p style="margin: 0px"><span style="font-family: courier new"><span style="line-height: 11pt"><span style="color: #0000ff"><span style="font-size: 8pt">private</span></span></span><span style="font-size: 8pt"><span style="line-height: 11pt"><span style="color: #000000"> </span></span><span style="line-height: 11pt"><span style="color: #0000ff">void</span></span><span style="line-height: 11pt"><span style="color: #000000"> btnList_Click(</span></span><span style="line-height: 11pt"><span style="color: #0000ff">object</span></span><span style="line-height: 11pt"><span style="color: #000000"> sender, </span></span><span style="line-height: 11pt"><span style="color: #2b91af">EventArgs</span></span></span><span style="line-height: 11pt"><span style="color: #000000; font-size: 8pt"> e)</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">{</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">&#0160; ListAllBlobs();</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new"><span style="color: #000000; font-size: 8pt">}</span></span></span></p>    <p style="margin: 0px"><span style="line-height: 11pt"><span style="font-family: courier new; color: #000000">&#0160;</span></span>&#0160;</p>    <p style="margin: 0px">The complete VS project with the source code for this app can be downloaded from <span class="asset  asset-generic at-xid-6a0167607c2431970b017615b4758b970c"><a href="http://adndevblog.typepad.com/files/gbxmlcloudsync.zip">here</a></span>.</p>    <p style="margin: 0px">&#0160;</p>    <p style="margin: 0px">Hope this simple app proves to be a good starting point in your experimentation with our product APIs and leveraging the generic Cloud services for the various workflows that is now possible – time to stretch our imagination!</p> </div>
