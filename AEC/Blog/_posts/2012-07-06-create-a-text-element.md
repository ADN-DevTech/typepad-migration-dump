---
layout: "post"
title: "Create a text element"
date: "2012-07-06 08:35:30"
author: "Augusto Goncalves"
categories:
  - ".NET"
  - "Augusto Goncalves"
  - "Revit"
original_url: "https://adndevblog.typepad.com/aec/2012/07/create-a-text-element.html "
typepad_basename: "create-a-text-element"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/aec/augusto-goncalves.html">Augusto Goncalves</a></p>  <p>The method <strong>Create.NewTextNote</strong> of the Document class is the key to create a text node element. This sample code additionally gets the curve information of elements to align the text.</p>  <div style="font-family: ; background: white">   <p style="margin: 0px"><span><font face="Courier New"><font style="font-size: 8pt" color="#008000">// Get the active document and view</font></font></span></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#2b91af"><font style="font-size: 8pt">UIDocument</font></font></span><font style="font-size: 8pt" color="#000000"> uiDoc = commandData.Application.ActiveUIDocument;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#2b91af"><font style="font-size: 8pt">Document</font></font></span><font style="font-size: 8pt" color="#000000"> doc = uiDoc.Document;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#2b91af"><font style="font-size: 8pt">View</font></font></span><font style="font-size: 8pt" color="#000000"> view = uiDoc.ActiveView;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><span><font color="#0000ff"><font style="font-size: 8pt">foreach</font></font></span><font style="font-size: 8pt"><font color="#000000"> (</font><span><font color="#2b91af">Element</font></span><font color="#000000"> elem </font><span><font color="#0000ff">in</font></span><font color="#000000"> uiDoc.Selection.Elements)</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">{</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// skip elements without curve</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">if</font></span><font color="#000000"> (!(elem.Location </font><span><font color="#0000ff">is</font></span><font color="#000000"> </font><span><font color="#2b91af">LocationCurve</font></span><font color="#000000">)) </font><span><font color="#0000ff">continue</font></span><font color="#000000">;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// get the curve of the element</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">Curve</font></span><font color="#000000"> curve = ((</font><span><font color="#2b91af">LocationCurve</font></span><font color="#000000">)elem.Location).Curve;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// Calculate necessary auguments</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">XYZ</font></span><font color="#000000"> origin = curve.get_EndPoint(0);</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">XYZ</font></span><font color="#000000"> baseVec = </font><span><font color="#2b91af">XYZ</font></span><font color="#000000">.BasisX;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">XYZ</font></span><font color="#000000"> upVec = </font><span><font color="#2b91af">XYZ</font></span><font color="#000000">.BasisZ;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">double</font></span><font color="#000000"> textSize = curve.Length / 10;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">double</font></span><font color="#000000"> lineWidth = curve.Length / 50;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#0000ff">string</font></span><font color="#000000"> strText = </font><span><font color="#a31515">&quot;This is &quot;</font></span><font color="#000000"> + elem.Name;</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><span><font style="font-size: 8pt" color="#008000">// Create the text</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">TextNote</font></span><font color="#000000"> text = doc.Create.NewTextNote(view, origin,</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; baseVec,</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; upVec,</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160; lineWidth,</font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">TextAlignFlags</font></span><font color="#000000">.TEF_ALIGN_CENTER |</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font><font style="font-size: 8pt"><span><font color="#2b91af">TextAlignFlags</font></span><font color="#000000">.TEF_ALIGN_MIDDLE, strText);</font></font></font></p>    <p style="margin: 0px"><font face="Courier New"><font color="#000000"><font style="font-size: 8pt">&#160; text.Width = curve.Length * 10; </font></font><span><font style="font-size: 8pt" color="#008000">// set the width of the text</font></span></font></p>    <p style="margin: 0px"><font face="Courier New"><font style="font-size: 8pt" color="#000000">}</font></font></p> </div>
