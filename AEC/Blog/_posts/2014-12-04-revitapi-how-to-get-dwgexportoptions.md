---
layout: "post"
title: "RevitAPI: How to get DWGExportOptions"
date: "2014-12-04 02:11:09"
author: "Aaron Lu"
categories:
  - "Aaron Lu"
  - "Revit"
original_url: "https://adndevblog.typepad.com/aec/2014/12/revitapi-how-to-get-dwgexportoptions.html "
typepad_basename: "revitapi-how-to-get-dwgexportoptions"
typepad_status: "Publish"
---

<p><small>By <a href="http://adndevblog.typepad.com/aec/aaron-lu.html" target="_self">Aaron Lu</a></small></p>
<p>As we know we can export DWG from Revit, before exporting we can config some settings, question is how to access&#0160;DWGExportOptions in Revit?</p>
<p>Since DWGExportOptions inherits from Element, we can use ElementFilter to filter it.</p>
<p>after that we can call ExportDWGSettings.GetDWGExportOptoins() to get the entry point of all information related with DWG export, below is the example code on how to find ExportDWGSettings and how to get its layers information:</p>
<div style="border: #000080 1px solid; color: #000; font-family: &#39;Courier New&#39;, Courier, Monospace; font-size: 10pt;">
<div style="background-color: #ffffff; overflow: auto; padding: 2px 5px;"><span style="background: #ffffff; color: #0000ff;">var&#0160;</span><span style="background: #ffffff; color: #000080;">dwgSettingsFilter</span><span style="background: #ffffff; color: #000000;"> = </span><br /> &#0160;&#0160;&#0160;&#0160;<span style="background: #ffffff; color: #0000ff;">new&#0160;</span><span style="background: #ffffff; color: #2b91af;">ElementClassFilter</span><span style="background: #ffffff; color: #000000;">(</span><span style="background: #ffffff; color: #0000ff;">typeof</span><span style="background: #ffffff; color: #000000;">(</span><span style="background: #ffffff; color: #2b91af;">ExportDWGSettings</span><span style="background: #ffffff; color: #000000;">));</span><br /> <span style="background: #ffffff; color: #2b91af;">FilteredElementCollector</span><span style="background: #ffffff; color: #000080;">settings</span><span style="background: #ffffff; color: #000000;"> = </span><br /> &#0160;&#0160;&#0160;&#0160;<span style="background: #ffffff; color: #0000ff;">new&#0160;</span><span style="background: #ffffff; color: #2b91af;">FilteredElementCollector</span><span style="background: #ffffff; color: #000000;">(</span><span style="background: #ffffff; color: #000080;">RevitDoc</span><span style="background: #ffffff; color: #000000;">);</span><br /> <span style="background: #ffffff; color: #000080;">settings</span><span style="background: #ffffff; color: #000000;"> = </span><span style="background: #ffffff; color: #000080;">settings</span><span style="background: #ffffff; color: #000000;">.</span><span style="background: #ffffff; color: #880000;">WherePasses</span><span style="background: #ffffff; color: #000000;">(</span><span style="background: #ffffff; color: #000080;">dwgSettingsFilter</span><span style="background: #ffffff; color: #000000;">);</span><br /> <span style="background: #ffffff; color: #0000ff;">foreach</span><span style="background: #ffffff; color: #000000;"> (</span><span style="background: #ffffff; color: #2b91af;">ExportDWGSetting s</span><span style="background: #ffffff; color: #000080;">element&#0160;</span><span style="background: #ffffff; color: #0000ff;">in&#0160;</span><span style="background: #ffffff; color: #000080;">settings</span><span style="background: #ffffff; color: #000000;">)</span><br /> <span style="background: #ffffff; color: #000000;">{</span><br /> &#0160;&#0160;&#0160;&#0160;<span style="background: #ffffff; color: #0000ff;">var&#0160;</span><span style="background: #ffffff; color: #000080;">options</span><span style="background: #ffffff; color: #000000;"> = </span><span style="background: #ffffff; color: #000080;">element</span><span style="background: #ffffff; color: #000000;">.</span><span style="background: #ffffff; color: #880000;">GetDWGExportOptions</span><span style="background: #ffffff; color: #000000;">();</span><br /> &#0160;&#0160;&#0160;&#0160;<span style="background: #ffffff; color: #0000ff;">var&#0160;</span><span style="background: #ffffff; color: #000080;">layerTable</span><span style="background: #ffffff; color: #000000;"> = </span><span style="background: #ffffff; color: #000080;">options</span><span style="background: #ffffff; color: #000000;">.</span><span style="background: #ffffff; color: #880000;">GetExportLayerTable</span><span style="background: #ffffff; color: #000000;">();</span><br /> &#0160;&#0160;&#0160;&#0160;<span style="background: #ffffff; color: #0000ff;">foreach</span><span style="background: #ffffff; color: #000000;"> (</span><span style="background: #ffffff; color: #0000ff;">var&#0160;</span><span style="background: #ffffff; color: #000080;">layerItem&#0160;</span><span style="background: #ffffff; color: #0000ff;">in&#0160;</span><span style="background: #ffffff; color: #000080;">layerTable</span><span style="background: #ffffff; color: #000000;">)</span><br /> &#0160;&#0160;&#0160;&#0160;<span style="background: #ffffff; color: #000000;">{</span><br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;<span style="background: #ffffff; color: #0000ff;">var&#0160;</span><span style="background: #ffffff; color: #000080;">layerInfo</span><span style="background: #ffffff; color: #000000;"> = </span><span style="background: #ffffff; color: #000080;">layerItem</span><span style="background: #ffffff; color: #000000;">.</span><span style="background: #ffffff; color: #000080;">Value</span><span style="background: #ffffff; color: #000000;">;</span><br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;<span style="background: #ffffff; color: #0000ff;">if</span><span style="background: #ffffff; color: #000000;"> (</span><span style="background: #ffffff; color: #000080;">layerInfo</span><span style="background: #ffffff; color: #000000;">.</span><span style="background: #ffffff; color: #216f85;">CategoryType</span><span style="background: #ffffff; color: #000000;"> == </span><span style="background: #ffffff; color: #2b91af;">LayerCategoryType</span><span style="background: #ffffff; color: #000000;">.</span><span style="background: #ffffff; color: #6f008a;">Model</span><span style="background: #ffffff; color: #000000;">)</span><br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;<span style="background: #ffffff; color: #000000;">{</span><br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;<span style="background: #ffffff; color: #0000ff;">var&#0160;</span><span style="background: #ffffff; color: #000080;">modifiers</span><span style="background: #ffffff; color: #000000;"> = </span><span style="background: #ffffff; color: #000080;">layerInfo</span><span style="background: #ffffff; color: #000000;">.</span><span style="background: #ffffff; color: #880000;">GetLayerModifiers</span><span style="background: #ffffff; color: #000000;">();</span><br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;<span style="background: #ffffff; color: #0000ff;">foreach</span><span style="background: #ffffff; color: #000000;"> (</span><span style="background: #ffffff; color: #0000ff;">var&#0160;</span><span style="background: #ffffff; color: #000080;">modifier&#0160;</span><span style="background: #ffffff; color: #0000ff;">in&#0160;</span><span style="background: #ffffff; color: #000080;">modifiers</span><span style="background: #ffffff; color: #000000;">)</span><br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;<span style="background: #ffffff; color: #000000;">{</span><br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;<span style="background: #ffffff; color: #008000;">// get modifier type</span><br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;<span style="background: #ffffff; color: #0000ff;">var&#0160;</span><span style="background: #ffffff; color: #000080;">modifierType</span><span style="background: #ffffff; color: #000000;"> = </span><span style="background: #ffffff; color: #000080;">modifier</span><span style="background: #ffffff; color: #000000;">.</span><span style="background: #ffffff; color: #216f85;">ModifierType</span><span style="background: #ffffff; color: #000000;">;</span><br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;<span style="background: #ffffff; color: #008000;">// get separator</span><br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;<span style="background: #ffffff; color: #0000ff;">var&#0160;</span><span style="background: #ffffff; color: #000080;">separater</span><span style="background: #ffffff; color: #000000;"> = </span><span style="background: #ffffff; color: #000080;">modifier</span><span style="background: #ffffff; color: #000000;">.</span><span style="background: #ffffff; color: #216f85;">Separator</span><span style="background: #ffffff; color: #000000;">; </span><br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;<span style="background: #ffffff; color: #000000;">}</span><br /> &#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;<span style="background: #ffffff; color: #000000;">}</span><br /> &#0160;&#0160;&#0160;&#0160;<span style="background: #ffffff; color: #000000;">}</span><br /> <span style="background: #ffffff; color: #000000;">}</span></div>
</div>
<p><br /><a href="http://blog.csdn.net/lushibi/article/details/41699641" target="_self" title="中文">中文链接</a></p>
