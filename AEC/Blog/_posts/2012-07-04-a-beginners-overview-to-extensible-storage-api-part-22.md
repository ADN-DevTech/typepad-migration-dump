---
layout: "post"
title: "A Beginners Overview to Extensible Storage API &ndash; Part 2/2"
date: "2012-07-04 08:00:00"
author: "Saikat Bhattacharya"
categories:
  - ".NET"
  - "Revit"
  - "Saikat Bhattacharya"
original_url: "https://adndevblog.typepad.com/aec/2012/07/a-beginners-overview-to-extensible-storage-api-part-22.html "
typepad_basename: "a-beginners-overview-to-extensible-storage-api-part-22"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/aec/saikat-bhattacharya.html" target="_self">Saikat Bhattacharya</a></p>
<p>In the <a href="http://adndevblog.typepad.com/aec/2012/07/a-beginners-overview-to-extensible-storage-api.html" target="_self">first post</a> on this topic, we saw how we can use the Extensible Storage API to define schema, fields, entities, add data to the fields and eventually setting the entity on Revit elements (namely a wall). In this post, we shall look at extracting all those information and various approaches of doing so.</p>
<p><strong>Extracting Schema and Field Related Information from a Revit Element</strong><strong> <br /></strong>The existing list of Schemas from a given Revit model can be accessed using the Schema.ListSchemas() method. This list can then be iterated through to extract each of the schemas: e.g.,&#0160; <br /><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;</span></span></span></span></p>
<p><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="color: #008000; font-size: 8pt;">//Let us list all schemas in the document</span></span></span></p>
<div style="background: white;">
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">IList</span></span><span style="line-height: 11pt;"><span style="color: #000000;">&lt;</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Schema</span></span><span style="line-height: 11pt;"><span style="color: #000000;">&gt; schmeas = </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Schema</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;">.ListSchemas();</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">foreach</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> (</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Schema</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> sch </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">in</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;"> schmeas)</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Courier New;"><span style="color: #000000; font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160; {</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">TaskDialog</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;">.Show(</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;Schema Details&quot;</span></span><span style="line-height: 11pt;"><span style="color: #000000;">, </span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;Schema Name: &quot;</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;"> + sch.SchemaName);</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Courier New;"><span style="color: #000000; font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160; }</span></span></span></p>
</div>
<p>Any specific Schema can also be accessed using the Schema.Lookup() method and by providing the unique GUID for that Schema, as shown below:</p>
<div style="background: white;">
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="color: #008000; font-size: 8pt;">// Let us list all Fields for our schema</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">Schema</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> ourSchema = </span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Schema</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;">.Lookup(schemaGuid);</span></span></span></p>
</div>
<p>All the fields that are defined in a Schema can be directly accessed using the Schema.ListFields() method:</p>
<div style="background: white;">
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #2b91af;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160; IList</span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #000000;">&lt;</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Field</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;">&gt; fields = ourSchema.ListFields();</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #0000ff;">foreach</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> (</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Field</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> fld </span></span><span style="line-height: 11pt;"><span style="color: #0000ff;">in</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;"> fields)</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Courier New;"><span style="color: #000000; font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160; {</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">TaskDialog</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;">.Show(</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;Field Details&quot;</span></span><span style="line-height: 11pt;"><span style="color: #000000;">, </span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;Field Name: &quot;</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;"> + fld.FieldName);</span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Courier New;"><span style="color: #000000; font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160; }</span></span></span></p>
<p style="margin: 0px;">If API users are looking at extracting specific field information on any Revit element, it can be accessed by first accessing the entity object on a given element, and then by accessing the field information using the field name stored in the entity. The entity information on an element can be obtained using the Element.GetEntity() method and by passing the schema object (since entity is an instance of a given schema). With this entity object, the specific value of a field can be obtained using the Entity.Get&lt;type&gt;() method which accepts parameters like field (which is accessed using its name). One of the overloads of this Get&lt;type&gt;() method also accepts the unit types. The following code snippet uses both the Entity.Get&lt;type&gt;() method overloads to extract the field information and values for a given entity.&#0160;</p>
<p style="margin: 0px;">&#0160;</p>
<div style="background: white;">
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="line-height: 11pt;"><span style="color: #008000; font-size: 8pt;">// Now let us extract the value for the field we created</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">Entity</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> wallSchemaEnt = wall.GetEntity(</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">Schema</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;">.Lookup(schemaGuid));</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">XYZ</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> wallSocketPos = wallSchemaEnt.Get&lt;</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">XYZ</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;">&gt;(</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">Schema</span></span><span style="line-height: 11pt;"><span style="color: #000000;">.Lookup(schemaGuid).GetField(</span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;SocketLocation&quot;</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;">), </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">DisplayUnitType</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;">.DUT_METERS);</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">TaskDialog</span></span><span style="line-height: 11pt;"><span style="color: #000000;">.Show(</span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;SocketLocation&quot;</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;">, </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;SocketLocation: &quot;</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;"> </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; + wallSocketPos.X.ToString() + </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;, &quot;</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;"> </span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; + wallSocketPos.Y.ToString() + </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;, &quot;</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;"> </span></span></span></p>
<p style="margin: 0px;"><span style="line-height: 11pt;"><span style="font-family: Courier New;"><span style="color: #000000; font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; + wallSocketPos.Z.ToString());</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="color: #000000; font-size: 8pt;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">String</span></span><span style="line-height: 11pt;"><span style="color: #000000;"> wallSocketNumber = wallSchemaEnt.Get&lt;</span></span><span style="line-height: 11pt;"><span style="color: #2b91af;">String</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;">&gt;(</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">Schema</span></span><span style="line-height: 11pt;"><span style="color: #000000;">.Lookup(schemaGuid).GetField(</span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;SocketNumber&quot;</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;">));</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #2b91af;">TaskDialog</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;">.Show(</span></span></span></p>
<p style="margin: 0px;"><span style="font-family: Courier New;"><span style="line-height: 11pt;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;SocketNumber&quot;</span></span><span style="line-height: 11pt;"><span style="color: #000000;">, </span></span><span style="line-height: 11pt;"><span style="color: #a31515;">&quot;SocketNumber: &quot;</span></span></span><span style="line-height: 11pt;"><span style="color: #000000; font-size: 8pt;"> + wallSocketNumber);</span></span></span></p>
</div>
</div>
<p>This new and powerful Extensible Storage API can be used to replace the existing technique of storing data in hidden shared parameters and provides a more structured and object-oriented alternative for data storage on Revit elements.</p>
