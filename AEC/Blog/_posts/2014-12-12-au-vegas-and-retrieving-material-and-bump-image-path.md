---
layout: "post"
title: "AU Vegas and Retrieving Material and Bump Image Path"
date: "2014-12-12 08:12:26"
author: "Jaime Rosales"
categories:
  - ".NET"
  - "Announcements"
  - "Cloud"
  - "Events"
  - "Jaime Rosales"
  - "Jeremy Tammik"
  - "Revit"
  - "Revit Architecture"
  - "Revit MEP"
  - "Revit Structure"
original_url: "https://adndevblog.typepad.com/aec/2014/12/au-vegas-and-retrieving-material-and-bump-image-path.html "
typepad_basename: "au-vegas-and-retrieving-material-and-bump-image-path"
typepad_status: "Publish"
---

<h3 class="entry-header">&#0160;</h3>
<p>By <a href="http://adndevblog.typepad.com/aec/jaime-rosales.html" target="_blank">Jaime Rosales</a></p>
<p>It’s been a week since <a href="http://au.autodesk.com/" target="_blank">AU 2014</a> happened and it was such a great experience. I got to meet really interesting people and many of our ADN partners which are doing pretty amazing things with our API’s.</p>
<p>I met clients like <a href="http://www.cl3ver.com/" target="_blank">Cl3ver</a> which have a pretty interesting Platform for 3D presentations and they have native Revit plug-in which will make your model available reducing it up to 10 times for a faster and smoother presentation.</p>
<p>Another one that caught my eye was <a href="http://www.hsbcad.de/en/" target="_blank">HsbCAD</a> which have a very interesting plug-in that breaks your model into small pieces and makes them 3D print available adding parts to then get put together like a 3D puzzle, very interesting work.</p>
<p>During the exhibition I got to help the A360 team booth which turned out to be a total success with more than 4K visitors during the 3 days and got so many started with their free year subscription of A360. Also had the chance to meet incredible evangelist from my team which showed me how the logistics of ADN work and I couldn’t be happier that I’m part of this team.</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01b8d0a7aac3970c-pi"><img alt="IMG_3318" border="0" height="360" src="/assets/image_328641.jpg" style="display: inline; border-width: 0px;" title="IMG_3318" width="480" /></a></p>
<p><a href="http://thebuildingcoder.typepad.com/blog/about-the-author.html" target="_blank"><em>Jeremy Tammik</em></a><em> rocking the A360 booth.</em></p>
<p>During DevDays, Philippe Leefsma and Jim Quanci rocked the stage showing the Viewer and Data API with over 400 happy attendees.</p>
<p>Got a lot of selfies with our customers since being part of the ADN target list of #selfiewith there were many enthusiastic guys and girls trying to get us for the chance of scoring one of the coolest smart watches we were giving away.</p>
<p>DevHack was also a great experience on Tuesday afternoon, where we had many of our API’s developers come by for a consultation and we got the chance to help them with their current development projects. It was such a great time to meet all of those great developers in person after helping them for quite some time I was able to finally put a face to their name.</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01bb07c2bcf3970d-pi"><img alt="IMG_0482" border="0" height="360" src="/assets/image_497179.jpg" style="display: inline; border-width: 0px;" title="IMG_0482" width="480" /></a></p>
<p><a href="http://dances-with-elephants.typepad.com/blog/about-the-author.html#tp" target="_blank"><em>Jim Quanci</em></a><em> rocking DevDays Stage.</em></p>
<p>&#0160;</p>
<p>Now back to Revit API. During the past couple of weeks I looked over a case where a developer was trying to get the material appearance&#39;s and bump image path.</p>
<p>Here is the question.</p>
<p><strong>Question:</strong> How can I use the Revit API to retrieve the material appearance&#39;s generic and bump image file path and name.</p>
<pre style="font-size: 13px; font-family: consolas; background: #1e1e1e; color: gainsboro;"><span style="color: #569cd6;">foreach</span> (<span style="color: #4ec9b0;">Element</span>&#0160;<span style="color: white;">elem</span>&#0160;<span style="color: #569cd6;">in</span>&#0160;<span style="color: white;">collector</span>) <br />&#0160; { <br />&#0160;&#0160;&#0160; <span style="color: #4ec9b0;">Material</span>&#0160;<span style="color: white;">mat</span>&#0160;<span style="color: #b4b4b4;">=</span>&#0160;<span style="color: white;">elem</span>&#0160;<span style="color: #569cd6;">as</span>&#0160;<span style="color: #4ec9b0;">Material</span>; <br />&#0160;&#0160;&#0160; <span style="color: #4ec9b0;">AppearanceAssetElement</span>&#0160;<span style="color: white;">ae</span>&#0160;<span style="color: #b4b4b4;">=</span> (<span style="color: #4ec9b0;">AppearanceAssetElement</span>)<br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: white;">m_CurrentDocument</span><span style="color: #b4b4b4;">.</span><span style="color: white;">GetElement</span>(<span style="color: white;">mat</span><span style="color: #b4b4b4;">.</span><span style="color: white;">AppearanceAssetId</span>); <br />&#0160;&#0160;&#0160; <span style="color: #4ec9b0;">Asset</span>&#0160;<span style="color: white;">set</span>&#0160;<span style="color: #b4b4b4;">=</span>&#0160;<span style="color: white;">ae</span><span style="color: #b4b4b4;">.</span><span style="color: white;">GetRenderingAsset</span>(); <br />&#0160;&#0160;&#0160; <span style="color: #b4b4b4;">......</span>&#0160;<br />&#0160; } </pre>
<p><strong>Answer:</strong> The asset has properties which are collections of name/value pairs.&#0160; So these paths should be a part of the properties. Unfortunately there is no set of predefined values for the names, so you will need to experiment looking at the properties and then decide if you want to hardcode the names you are looking for, or try to find them dynamically.&#0160;</p>
<p>(Sometimes the names change, and sometimes the available properties are different for different material types, so hard coding, while simplest, carries some possible risk).</p>
<p>I hope this helps, and let us know if you need more assistance from us.</p>
<p><strong>Response</strong>: This is the code that I finally got it working.</p>
<pre style="font-size: 13px; font-family: consolas; background: #1e1e1e; color: gainsboro;"><span style="color: #569cd6;">void</span>&#0160;<span style="color: white;">MyCommand</span>(<span style="color: #4ec9b0;">ExternalCommandData</span>&#0160;<span style="color: white;">commandData</span>) <br />{ <br />&#0160; <span style="color: #569cd6;">string</span>&#0160;<span style="color: white;">genericImage</span>&#0160;<span style="color: #b4b4b4;">=</span>&#0160;<span style="color: #d69d85;">&quot;&quot;</span>; <br />&#0160; <span style="color: #569cd6;">string</span>&#0160;<span style="color: white;">bumpImage</span>&#0160;<span style="color: #b4b4b4;">=</span>&#0160;<span style="color: #d69d85;">&quot;&quot;</span>; <br />&#0160; <span style="color: #4ec9b0;">Element</span>&#0160;<span style="color: white;">someElement</span>&#0160;<span style="color: #b4b4b4;">=</span>&#0160;<span style="color: #569cd6;">null</span>; <span style="color: #608b4e;">// have some material element here. </span><br /> <br />&#0160; <span style="color: #4ec9b0;">Material</span>&#0160;<span style="color: white;">theMaterial</span>&#0160;<span style="color: #b4b4b4;">=</span>&#0160;<span style="color: white;">someElement</span>&#0160;<span style="color: #569cd6;">as</span>&#0160;<span style="color: #4ec9b0;">Material</span>; <br />&#0160; <span style="color: #4ec9b0;">AppearanceAssetElement</span>&#0160;<span style="color: white;">appearanceAsset</span>&#0160;<span style="color: #b4b4b4;">=</span>&#0160;<br />&#0160; (<span style="color: #4ec9b0;">AppearanceAssetElement</span>)<span style="color: white;">commandData</span><span style="color: #b4b4b4;">.</span><span style="color: white;">Application</span><span style="color: #b4b4b4;">.</span><span style="color: white;">ActiveUIDocument</span><span style="color: #b4b4b4;">.</span><br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: white;">Document</span><span style="color: #b4b4b4;">.</span><span style="color: white;">GetElement</span>(<span style="color: white;">theMaterial</span><span style="color: #b4b4b4;">.</span><span style="color: white;">AppearanceAssetId</span>); <br />&#0160; <span style="color: #4ec9b0;">Asset</span>&#0160;<span style="color: white;">asset1</span>&#0160;<span style="color: #b4b4b4;">=</span>&#0160;<span style="color: white;">appearanceAsset</span><span style="color: #b4b4b4;">.</span><span style="color: white;">GetRenderingAsset</span>(); <br />&#0160; <span style="color: white;">genericImage</span>&#0160;<span style="color: #b4b4b4;">=</span>&#0160;<span style="color: white;">GetAssetProperty</span>(<span style="color: white;">asset1</span>, <span style="color: #d69d85;">&quot;generic_diffuse&quot;</span>); <br />&#0160; <span style="color: white;">bumpImage</span>&#0160;<span style="color: #b4b4b4;">=</span>&#0160;<span style="color: white;">GetAssetProperty</span>(<span style="color: white;">asset1</span>, <span style="color: #d69d85;">&quot;generic_bump_map&quot;</span>); <br />} <br /> <br /><span style="color: #569cd6;">private</span>&#0160;<span style="color: #569cd6;">string</span>&#0160;<span style="color: white;">GetAssetProperty</span>(<span style="color: #4ec9b0;">Asset</span>&#0160;<span style="color: white;">asset1</span>, <span style="color: #569cd6;">string</span>&#0160;<span style="color: white;">propertyName</span>) <br />{ <br />&#0160; <span style="color: #569cd6;">const</span>&#0160;<span style="color: #569cd6;">string</span>&#0160;<span style="color: white;">BitmapPropertyName</span>&#0160;<span style="color: #b4b4b4;">=</span>&#0160;<span style="color: #d69d85;">&quot;unifiedbitmap_Bitmap&quot;</span>; <br />&#0160; <span style="color: #569cd6;">string</span>&#0160;<span style="color: white;">theValue</span>&#0160;<span style="color: #b4b4b4;">=</span>&#0160;<span style="color: #d69d85;">&quot;&quot;</span>; <br />&#0160; <span style="color: #569cd6;">if</span> (<span style="color: white;">asset1</span>&#0160;<span style="color: #b4b4b4;">!=</span>&#0160;<span style="color: #569cd6;">null</span>) <br />&#0160; { <br />&#0160;&#0160;&#0160; <span style="color: #4ec9b0;">AssetProperty</span>&#0160;<span style="color: white;">property</span>; <br />&#0160;&#0160;&#0160; <span style="color: #4ec9b0;">AssetPropertyString</span>&#0160;<span style="color: white;">stringProperty</span>; <br />&#0160;&#0160;&#0160; <span style="color: #4ec9b0;">AssetProperty</span>&#0160;<span style="color: white;">property2</span>; <br />&#0160;&#0160;&#0160; <span style="color: #569cd6;">for</span> (<span style="color: #569cd6;">int</span>&#0160;<span style="color: white;">i</span>&#0160;<span style="color: #b4b4b4;">=</span>&#0160;<span style="color: #b5cea8;">0</span>; <span style="color: white;">i</span>&#0160;<span style="color: #b4b4b4;">&lt;</span>&#0160;<span style="color: white;">asset1</span><span style="color: #b4b4b4;">.</span><span style="color: white;">Size</span>; <span style="color: white;">i</span><span style="color: #b4b4b4;">++</span>) <br />&#0160;&#0160;&#0160; { <br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: white;">property</span>&#0160;<span style="color: #b4b4b4;">=</span>&#0160;<span style="color: white;">asset1</span>[<span style="color: white;">i</span>]; <br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #569cd6;">if</span> (<span style="color: white;">property</span>&#0160;<span style="color: #b4b4b4;">!=</span>&#0160;<span style="color: #569cd6;">null</span>&#0160;<span style="color: #b4b4b4;">&amp;&amp;</span>&#0160;<span style="color: white;">property</span><span style="color: #b4b4b4;">.</span><span style="color: white;">Name</span>&#0160;<span style="color: #b4b4b4;">==</span>&#0160;<span style="color: white;">propertyName</span>) <br />&#0160;&#0160;&#0160;&#0160;&#0160; { <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #b8d7a3;">IList</span><span style="color: #b4b4b4;">&lt;</span><span style="color: #4ec9b0;">AssetProperty</span><span style="color: #b4b4b4;">&gt;</span>&#0160;<span style="color: white;">propertiesConnected</span>&#0160;<span style="color: #b4b4b4;">=</span>&#0160;<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: white;">property</span><span style="color: #b4b4b4;">.</span><span style="color: white;">GetAllConnectedProperties</span>(); <br /> <br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #569cd6;">if</span> (<span style="color: white;">propertiesConnected</span>&#0160;<span style="color: #b4b4b4;">!=</span>&#0160;<span style="color: #569cd6;">null</span>&#0160;<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #b4b4b4;">&amp;&amp;</span>&#0160;<span style="color: white;">propertiesConnected</span><span style="color: #b4b4b4;">.</span><span style="color: white;">Count</span>&#0160;<span style="color: #b4b4b4;">&gt;</span>&#0160;<span style="color: #b5cea8;">0</span>) <br />&#0160;&#0160;&#0160;&#0160;&#0160; { <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: white;">property2</span>&#0160;<span style="color: #b4b4b4;">=</span>&#0160;<span style="color: white;">propertiesConnected</span>[<span style="color: #b5cea8;">0</span>]; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #569cd6;">if</span> (<span style="color: white;">property2</span><span style="color: #b4b4b4;">.</span><span style="color: white;">Type</span>&#0160;<span style="color: #b4b4b4;">==</span>&#0160;<span style="color: #b8d7a3;">AssetPropertyType</span><span style="color: #b4b4b4;">.</span><span style="color: white;">APT_Asset</span>) <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; { <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #4ec9b0;">Asset</span>&#0160;<span style="color: white;">asset2</span>&#0160;<span style="color: #b4b4b4;">=</span>&#0160;<span style="color: white;">property2</span>&#0160;<span style="color: #569cd6;">as</span>&#0160;<span style="color: #4ec9b0;">Asset</span>; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #569cd6;">if</span> (<span style="color: white;">asset2</span>&#0160;<span style="color: #b4b4b4;">!=</span>&#0160;<span style="color: #569cd6;">null</span>) <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; { <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #569cd6;">for</span> (<span style="color: #569cd6;">int</span>&#0160;<span style="color: white;">i2</span>&#0160;<span style="color: #b4b4b4;">=</span>&#0160;<span style="color: #b5cea8;">0</span>; <span style="color: white;">i2</span>&#0160;<span style="color: #b4b4b4;">&lt;</span>&#0160;<span style="color: white;">asset2</span><span style="color: #b4b4b4;">.</span><span style="color: white;">Size</span>; <span style="color: white;">i2</span><span style="color: #b4b4b4;">++</span>) <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; { <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: white;">property</span>&#0160;<span style="color: #b4b4b4;">=</span>&#0160;<span style="color: white;">asset2</span>[<span style="color: white;">i2</span>]; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #569cd6;">if</span> (<span style="color: white;">property</span>&#0160;<span style="color: #b4b4b4;">!=</span>&#0160;<span style="color: #569cd6;">null</span>&#0160;<span style="color: #b4b4b4;">&amp;&amp;</span>&#0160;<span style="color: white;">property</span><span style="color: #b4b4b4;">.</span><span style="color: white;">Name</span>&#0160;<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #b4b4b4;">==</span>&#0160;<span style="color: white;">BitmapPropertyName</span>) <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; { <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: white;">stringProperty</span>&#0160;<span style="color: #b4b4b4;">=</span>&#0160;<span style="color: white;">property</span>&#0160;<br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #569cd6;">as</span>&#0160;<span style="color: #4ec9b0;">AssetPropertyString</span>; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #569cd6;">if</span> (<span style="color: white;">stringProperty</span>&#0160;<span style="color: #b4b4b4;">!=</span>&#0160;<span style="color: #569cd6;">null</span>) <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; { <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: white;">theValue</span>&#0160;<span style="color: #b4b4b4;">=</span>&#0160;<span style="color: white;">stringProperty</span><span style="color: #b4b4b4;">.</span><span style="color: white;">Value</span>; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; } <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #569cd6;">return</span>&#0160;<span style="color: white;">theValue</span>; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; } <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; } <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; } <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; } <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; } <br /><span style="color: #608b4e;">//Once the named property was found,</span><br /><span style="color: #608b4e;">//we wont search next. </span><br />&#0160;&#0160;&#0160;&#0160;&#0160; <span style="color: #569cd6;">break</span>; <br />&#0160;&#0160;&#0160;&#0160;&#0160; } <br /> <br />&#0160;&#0160;&#0160; } <br />&#0160; } <br />&#0160; <span style="color: #569cd6;">return</span>&#0160;<span style="color: #d69d85;">&quot;&quot;</span>; <br />}</pre>
<p>Here is a screenshot of the information that we will be retrieving.</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01bb07c2beb2970d-pi" target="_blank"><img alt="MaterialAppearanceRendering" height="286" src="/assets/image_475784.jpg" style="display: inline;" title="MaterialAppearanceRendering" width="480" /></a></p>
<p>Thank you Jeff Yao from <a href="http://www.asti.com" target="_blank">Applied Software</a> for providing such a great and useful solution.</p>
<p>Thank you for reading and until next time.</p>
