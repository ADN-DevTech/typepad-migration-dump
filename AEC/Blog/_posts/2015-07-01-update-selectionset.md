---
layout: "post"
title: "Update SelectionSet"
date: "2015-07-01 21:04:59"
author: "Xiaodong Liang"
categories:
  - ".NET"
  - "Navisworks"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/aec/2015/07/update-selectionset.html "
typepad_basename: "update-selectionset"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/manufacturing/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>  <p>We have some articles on how to add&#160; new SelectionSet. I got a question how to update a SelectionSet. The customer said this object (from the collection of DocumentSelectionSets) is read-only. </p>  <p>In general, to modify a .NET object of Navisworks, you would need to make a copy of the original object (CreateCopy method), modify the copy, and copy to the original object (CopyFrom). Normally, a collection object provide the relevant copy methods. In DocumentSelectionSets, they are:   <br />    <br />1. ReplaceWithCopy(Int32, SavedItem)&#160; Replaces item at given index within Value with a copy of item&#160; <br />2. ReplaceWithCopy(GroupItem, Int32, SavedItem): Replaces item from the specified parent group with a copy of item</p>  <p>I’d recommend the second method as it clearly indicates the relationship of an item and its parent.</p>  <p>So,    <br />1.&#160;&#160;&#160; get the parent item of the SelectionSet you want to modify. In default, the SelectionSet in first level is actually included in a root item which is invisible in UI.    <br />2.&#160;&#160;&#160; get the index the item resides in the group (parent)    <br />3.&#160;&#160;&#160; make a copy of the original item, modify the relevant properties.    <br />4.&#160;&#160;&#160; call ReplaceWithCopy to update the original item.</p>  <p>The following code demos how to update an item named ‘mytestset’. Assume some other objects are selected in advanced. The code will update the SelectionSet with a new name and the current selection.</p>  <p>&#160;</p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><font face="Consolas"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#0000ff"><font style="font-size: 9.5pt">public</font></font></span><font style="font-size: 9.5pt"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#000000"> </font></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#0000ff">override</font></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#000000"> </font></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#0000ff">int</font></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#000000"> Execute(</font></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#0000ff">params</font></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#000000"> </font></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#0000ff">string</font></span></font><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font style="font-size: 9.5pt" color="#000000">[] parameters)</font></span></font></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Consolas"><font color="#000000"><font style="font-size: 9.5pt">{</font><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160; </font></span></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><font face="Consolas"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font style="font-size: 9.5pt" color="#0000ff">try</font></span></font><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">{ </font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><font face="Consolas"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 9.5pt"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#0000ff">string</font></span></font><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font style="font-size: 9.5pt" color="#000000"> output =</font></span></font></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">ModifySelectionSetContent(</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><font face="Consolas"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">Autodesk.Navisworks.Api.</font></font></span><font style="font-size: 9.5pt"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#2b91af">Application</font></span></font><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font style="font-size: 9.5pt" color="#000000">.</font></span></font></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">ActiveDocument.SelectionSets.RootItem,</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><font face="Consolas"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">Autodesk.Navisworks.Api.</font></font></span><font style="font-size: 9.5pt"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#2b91af">Application</font></span></font><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font style="font-size: 9.5pt" color="#000000">.</font></span></font></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">ActiveDocument.Title,</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><font face="Consolas"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 9.5pt"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#a31515">&quot;&quot;</font></span></font><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font style="font-size: 9.5pt" color="#000000">); </font></span></font></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><font face="Consolas"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span></span><font style="font-size: 9.5pt"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#0000ff">catch</font></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#000000"> (</font></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#2b91af">Exception</font></span></font><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font style="font-size: 9.5pt" color="#000000"> ex)</font></span></font></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">{</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><font face="Consolas"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font style="font-size: 9.5pt" color="#008000">// any exception</font></span></font><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><font face="Consolas"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">System.Diagnostics.</font></font></span><font style="font-size: 9.5pt"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#2b91af">Debug</font></span></font><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font style="font-size: 9.5pt" color="#000000">.Write(ex.ToString());</font></span></font></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><font face="Consolas"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span></span><font style="font-size: 9.5pt"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#0000ff">return</font></span></font><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font style="font-size: 9.5pt" color="#000000"> 0;</font></span></font></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;</font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><font face="Consolas"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;</font></font></span></span><font style="font-size: 9.5pt"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#0000ff">public</font></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#000000"> </font></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#0000ff">string</font></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#000000"> ModifySelectionSetContent(           <br />&#160;&#160;&#160;&#160; </font></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#2b91af">SavedItem</font></span></font><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font style="font-size: 9.5pt" color="#000000"> item, </font></span></font></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><font face="Consolas"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 9.5pt"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#0000ff">string</font></span></font><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font style="font-size: 9.5pt" color="#000000"> label, </font></span></font></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><font face="Consolas"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 9.5pt"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#0000ff">string</font></span></font><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font style="font-size: 9.5pt" color="#000000"> lineText)</font></span></font></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">{</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><font face="Consolas"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font style="font-size: 9.5pt" color="#008000">//set the output</font></span></font><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><font face="Consolas"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span></span><font style="font-size: 9.5pt"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#0000ff">string</font></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#000000"> output = lineText + </font></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#a31515">&quot;+ &quot;</font></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#000000"> + label + </font></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#a31515">&quot;\n&quot;</font></span></font><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font style="font-size: 9.5pt" color="#000000">;</font></span></font></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><font face="Consolas"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font style="font-size: 9.5pt" color="#008000">//See if this SavedItem is a GroupItem</font></span></font><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><font face="Consolas"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span></span><font style="font-size: 9.5pt"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#0000ff">if</font></span></font><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font style="font-size: 9.5pt" color="#000000"> (item.IsGroup)</font></span></font></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">{</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><font face="Consolas"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font style="font-size: 9.5pt" color="#008000">//Indent the lines below this item</font></span></font><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><font face="Consolas"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">lineText += </font></font></span><font style="font-size: 9.5pt"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#a31515">&quot;<span style="mso-spacerun: yes">&#160;&#160; </span>&quot;</font></span></font><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font style="font-size: 9.5pt" color="#000000">;</font></span></font></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><font face="Consolas"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 9.5pt"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#0000ff">int</font></span></font><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font style="font-size: 9.5pt" color="#000000"> index = 0;</font></span></font></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><font face="Consolas"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font style="font-size: 9.5pt" color="#008000">//iterate the children and output</font></span></font><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><font face="Consolas"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 9.5pt"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#0000ff">foreach</font></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#000000"> (</font></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#2b91af">SavedItem</font></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#000000"> childItem </font></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#0000ff">in</font></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#000000">            <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ((</font></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#2b91af">GroupItem</font></span></font><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font style="font-size: 9.5pt" color="#000000">)item).Children)</font></span></font></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">{</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">output +=&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ModifySelectionSetContent(childItem,</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">childItem.DisplayName, </font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">lineText);           <br /></font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><font face="Consolas"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 9.5pt"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#0000ff">if</font></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#000000"> (childItem.DisplayName == </font></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#a31515">&quot;mytestset&quot;</font></span></font><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font style="font-size: 9.5pt" color="#000000">)</font></span></font></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">{</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><font face="Consolas"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 9.5pt"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#2b91af">SelectionSet</font></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#000000"> oSet =           <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; childItem </font></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#0000ff">as</font></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#000000"> </font></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#2b91af">SelectionSet</font></span></font><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font style="font-size: 9.5pt" color="#000000">;</font></span></font></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><font face="Consolas"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 9.5pt"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#2b91af">SelectionSet</font></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#000000"> copyItem =&#160;&#160;&#160;&#160;&#160;&#160; </font></span></font></font></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><font face="Consolas"><font style="font-size: 9.5pt"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; oSet.CreateCopy() </font></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#0000ff">as</font></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#000000"> </font></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#2b91af">SelectionSet</font></span></font><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font style="font-size: 9.5pt" color="#000000">;</font></span></font></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><font face="Consolas"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font style="font-size: 9.5pt" color="#008000">//change name</font></span></font><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><font face="Consolas"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">copyItem.DisplayName += </font></font></span><font style="font-size: 9.5pt"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#a31515">&quot;_updated&quot;</font></span></font><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font style="font-size: 9.5pt" color="#000000">;</font></span></font></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><font face="Consolas"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font style="font-size: 9.5pt" color="#008000">//change selection</font></span></font><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">copyItem.ExplicitModelItems.CopyFrom(</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><font face="Consolas"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></font></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><font face="Consolas"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Autodesk.Navisworks.Api.</font></font></span><font style="font-size: 9.5pt"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#2b91af">Application</font></span></font><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font style="font-size: 9.5pt" color="#000000">.</font></span></font></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">&#160; ActiveDocument.CurrentSelection.SelectedItems);</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#000000" face="Consolas"></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><font face="Consolas"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 9.5pt"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#2b91af">DocumentSelectionSets</font></span></font><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font style="font-size: 9.5pt" color="#000000"> oSets = </font></span></font></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><font face="Consolas"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">Autodesk.Navisworks.Api.</font></font></span><font style="font-size: 9.5pt"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#2b91af">Application</font></span></font><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font style="font-size: 9.5pt" color="#000000">.</font></span></font></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>ActiveDocument.SelectionSets;</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><font face="Consolas"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">oSets.ReplaceWithCopy((</font></font></span><font style="font-size: 9.5pt"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#2b91af">GroupItem</font></span></font><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font style="font-size: 9.5pt" color="#000000">)item, </font></span></font></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><font face="Consolas"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font style="font-size: 9.5pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; index, copyItem); </font></span></font></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">index ++;</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></span><font style="font-size: 9.5pt">}</font></font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><font face="Consolas"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span></span><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font style="font-size: 9.5pt" color="#008000">//return the node information</font></span></font><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"></span></p>  <p style="line-height: normal; margin: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal" align="left"><font face="Consolas"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 9.5pt">&#160;&#160;&#160; </font></font></span></span><font style="font-size: 9.5pt"><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font color="#0000ff">return</font></span></font><span style="font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font style="font-size: 9.5pt" color="#000000"> output;</font></span></font></p>  <p style="text-justify: inter-ideograph; line-height: normal; margin: 0cm 0cm 0pt" class="MsoNormal" align="justify"><span style="text-justify: inter-ideograph; text-align: justify; font-family: ; mso-font-kerning: 0pt" lang="EN-US"><font face="Consolas"><font style="font-size: 9.5pt" color="#000000">}</font></font></span><span style="text-justify: inter-ideograph; text-align: justify; font-family: " lang="EN-US"></span></p>
