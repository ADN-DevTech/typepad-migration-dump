---
layout: "post"
title: "Use Navisworks API with WPF &ndash; Binding Model Hierarchy to Tree View"
date: "2013-04-02 19:48:25"
author: "Xiaodong Liang"
categories:
  - ".NET"
  - "Navisworks"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/aec/2013/04/use-navisworks-api-with-wpf-binding-model-hierarchy-to-tree-view.html "
typepad_basename: "use-navisworks-api-with-wpf-binding-model-hierarchy-to-tree-view"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/aec/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>
<p>In the last <a href="http://adndevblog.typepad.com/aec/2013/03/use-navisworks-api-with-wpf-create-a-net-control-application-of-wpf.html">post</a>, we have seen how to create an application of WPF with .NET control. As mentioned, WPF could be looked as the successor of Win Form. But it is much more powerful and flexible.&#0160; One of its unique features is <strong>Data Binding</strong>.&#0160; WPF has a built-in set of data services to enable application developers to bind and manipulate data within applications. If you have some codes of Win Form to build the hierarchy tree of Navisworks model like the Selection Tree in UI, you must have to iterate each items and build the nodes &amp; child nodes recursively. While with WPF, the job is much easier.</p>
<p>The whole project is available at <span class="asset  asset-generic at-xid-6a0167607c2431970b0192abeaae9f970d"><a href="http://adndevblog.typepad.com/files/adn-nwwpftree.zip">Download ADN-NwWPFTree</a></span></p>
<p>Firstly, add a tree view control to the form. You could either drag it from toolbox, or add the elements directly in the xaml. I adjusted the width of Navisworks view control to make the tree control wider.</p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &#39;Tahoma&#39;,&#39;sans-serif&#39;; color: gray; font-size: 8pt; mso-font-kerning: 0pt; mso-themecolor: background1; mso-themeshade: 128;">&lt;Window x:Class=&quot;NwWPFControlApp.MainWindow&quot; </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &#39;Tahoma&#39;,&#39;sans-serif&#39;; color: gray; font-size: 8pt; mso-font-kerning: 0pt; mso-themecolor: background1; mso-themeshade: 128;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="mso-spacerun: yes;">&#0160;</span>xmlns=&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &#39;Tahoma&#39;,&#39;sans-serif&#39;; color: gray; font-size: 8pt; mso-font-kerning: 0pt; mso-themecolor: background1; mso-themeshade: 128;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="mso-spacerun: yes;">&#0160;</span>xmlns:x=&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;<span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &#39;Tahoma&#39;,&#39;sans-serif&#39;; color: gray; font-size: 8pt; mso-font-kerning: 0pt; mso-themecolor: background1; mso-themeshade: 128;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="mso-spacerun: yes;">&#0160;</span>Title=&quot;MainWindow&quot; Height=&quot;350&quot; Width=&quot;525&quot; </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &#39;Tahoma&#39;,&#39;sans-serif&#39;; color: gray; font-size: 8pt; mso-font-kerning: 0pt; mso-themecolor: background1; mso-themeshade: 128;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="mso-spacerun: yes;">&#0160;</span>xmlns:NwApi=&quot;clr-namespace:Autodesk.Navisworks.Api;assembly=Autodesk.Navisworks.Api&quot; </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &#39;Tahoma&#39;,&#39;sans-serif&#39;; color: gray; font-size: 8pt; mso-font-kerning: 0pt; mso-themecolor: background1; mso-themeshade: 128;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="mso-spacerun: yes;">&#0160;</span>xmlns:NwControls=&quot;clr-namespace:Autodesk.Navisworks.Api.Controls;assembly=Autodesk.Navisworks.Controls&quot; </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &#39;Tahoma&#39;,&#39;sans-serif&#39;; color: gray; font-size: 8pt; mso-font-kerning: 0pt; mso-themecolor: background1; mso-themeshade: 128;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="mso-spacerun: yes;">&#0160;</span>xmlns:my=&quot;clr-namespace:System.Windows.Forms.Integration;assembly=WindowsFormsIntegration&quot; Closed=&quot;Window_Closed&quot;&gt;</span><span lang="EN-US" style="font-family: &#39;Tahoma&#39;,&#39;sans-serif&#39;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160; </span></span><span lang="EN-US" style="font-family: &#39;Tahoma&#39;,&#39;sans-serif&#39;; font-size: 8pt; mso-font-kerning: 0pt;">&#0160;</span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &#39;Tahoma&#39;,&#39;sans-serif&#39;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160; </span></span><span lang="EN-US" style="font-family: &#39;Tahoma&#39;,&#39;sans-serif&#39;; color: gray; font-size: 8pt; mso-font-kerning: 0pt; mso-themecolor: background1; mso-themeshade: 128;"><span style="mso-spacerun: yes;">&#0160;</span>&lt;DockPanel&gt; </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &#39;Tahoma&#39;,&#39;sans-serif&#39;; color: gray; font-size: 8pt; mso-font-kerning: 0pt; mso-themecolor: background1; mso-themeshade: 128;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>&lt;Button Content=&quot;Open File&quot; Height=&quot;23&quot; Name=&quot;button1&quot; Width=&quot;75&quot; Click=&quot;button1_Click&quot; /&gt; </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &#39;Tahoma&#39;,&#39;sans-serif&#39;; color: gray; font-size: 8pt; mso-font-kerning: 0pt; mso-themecolor: background1; mso-themeshade: 128;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>&lt;WindowsFormsHost Width=&quot;<span style="background: yellow; mso-highlight: yellow;">198</span>&quot;&gt; </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &#39;Tahoma&#39;,&#39;sans-serif&#39;; color: gray; font-size: 8pt; mso-font-kerning: 0pt; mso-themecolor: background1; mso-themeshade: 128;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>&lt;!--x:Uid used in XAML context--&gt; </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &#39;Tahoma&#39;,&#39;sans-serif&#39;; color: gray; font-size: 8pt; mso-font-kerning: 0pt; mso-themecolor: background1; mso-themeshade: 128;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>&lt;!--x:Name governed by the XAML namescope--&gt; </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &#39;Tahoma&#39;,&#39;sans-serif&#39;; color: gray; font-size: 8pt; mso-font-kerning: 0pt; mso-themecolor: background1; mso-themeshade: 128;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>&lt;NwControls:ViewControl x:Uid=&quot;viewControl&quot;<span style="mso-spacerun: yes;">&#0160;&#0160; </span></span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &#39;Tahoma&#39;,&#39;sans-serif&#39;; color: gray; font-size: 8pt; mso-font-kerning: 0pt; mso-themecolor: background1; mso-themeshade: 128;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="mso-spacerun: yes;">&#0160;</span>x:Name=&quot;viewControl&quot; </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &#39;Tahoma&#39;,&#39;sans-serif&#39;; color: gray; font-size: 8pt; mso-font-kerning: 0pt; mso-themecolor: background1; mso-themeshade: 128;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="mso-spacerun: yes;">&#0160;</span>Dock=&quot;Fill&quot; /&gt; </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &#39;Tahoma&#39;,&#39;sans-serif&#39;; color: gray; font-size: 8pt; mso-font-kerning: 0pt; mso-themecolor: background1; mso-themeshade: 128;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>&lt;/WindowsFormsHost&gt;</span><span lang="EN-US" style="font-family: &#39;Tahoma&#39;,&#39;sans-serif&#39;; color: gray; font-size: 8pt; mso-font-kerning: 0pt; mso-themecolor: background1; mso-themeshade: 128;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &#39;Tahoma&#39;,&#39;sans-serif&#39;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span lang="EN-US" style="font-family: &#39;Tahoma&#39;,&#39;sans-serif&#39;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">&lt;</span><span lang="EN-US" style="font-family: &#39;Tahoma&#39;,&#39;sans-serif&#39;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;">TreeView</span><span lang="EN-US" style="font-family: &#39;Tahoma&#39;,&#39;sans-serif&#39;; color: red; font-size: 8pt; mso-font-kerning: 0pt;"> Height</span><span lang="EN-US" style="font-family: &#39;Tahoma&#39;,&#39;sans-serif&#39;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">=&quot;308&quot;</span><span lang="EN-US" style="font-family: &#39;Tahoma&#39;,&#39;sans-serif&#39;; color: red; font-size: 8pt; mso-font-kerning: 0pt;"> Name</span><span lang="EN-US" style="font-family: &#39;Tahoma&#39;,&#39;sans-serif&#39;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">=&quot;treeView1&quot;</span><span lang="EN-US" style="font-family: &#39;Tahoma&#39;,&#39;sans-serif&#39;; color: red; font-size: 8pt; mso-font-kerning: 0pt;"> Width</span><span lang="EN-US" style="font-family: &#39;Tahoma&#39;,&#39;sans-serif&#39;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">=&quot;223&quot;&gt;</span> </p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &#39;Tahoma&#39;,&#39;sans-serif&#39;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span lang="EN-US" style="font-family: &#39;Tahoma&#39;,&#39;sans-serif&#39;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">&lt;/</span><span lang="EN-US" style="font-family: &#39;Tahoma&#39;,&#39;sans-serif&#39;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;">TreeView</span><span lang="EN-US" style="font-family: &#39;Tahoma&#39;,&#39;sans-serif&#39;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">&gt;</span><span lang="EN-US" style="font-family: &#39;Tahoma&#39;,&#39;sans-serif&#39;; font-size: 8pt; mso-font-kerning: 0pt;"> </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &#39;Tahoma&#39;,&#39;sans-serif&#39;; color: gray; font-size: 8pt; mso-font-kerning: 0pt; mso-themecolor: background1; mso-themeshade: 128;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span>&lt;/DockPanel&gt; </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &#39;Tahoma&#39;,&#39;sans-serif&#39;; color: gray; font-size: 8pt; mso-font-kerning: 0pt; mso-themecolor: background1; mso-themeshade: 128;">&lt;/Window&gt; </span></p>
<p>Next, we need to tell the tree view which source to bind. I am not a WPF expert, I’d appreciate many posts in internet which guides me how to get started with. I’d recommend this article below. It helped me to know the basic elements I need for building the tree.</p>
<p><a href="http://blogs.msdn.com/b/mikehillberg/archive/2009/10/30/treeview-and-hierarchicaldatatemplate-step-by-step.aspx" title="http://blogs.msdn.com/b/mikehillberg/archive/2009/10/30/treeview-and-hierarchicaldatatemplate-step-by-step.aspx">http://blogs.msdn.com/b/mikehillberg/archive/2009/10/30/treeview-and-hierarchicaldatatemplate-step-by-step.aspx</a></p>
<p>In short, the key steps with tree binding are:</p>
<p>1. tell the tree view control which data source you want to bind. In general, this is the top of the hierarchy. In our case, it is the root item of the tree. e.g.&#0160;&#0160; </p>
<p class="MsoNormal" style="text-align: left; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #2b91af; font-size: 8pt; mso-font-kerning: 0pt;">Document</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"> oDoc = documentControl.Document;</span>     <br />&#0160;<span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;">treeView1.DataContext = oDoc.Models[0].RootItem; </span></p>
<p>2. bind the data source&#0160; to the tree view.&#0160;&#0160;&#0160; </p>
<p class="MsoNormal" style="text-align: left; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: green; font-size: 8pt; mso-font-kerning: 0pt;">&lt;!--tell the tree the collection of the hierarchy. in our case it is RootItem.Children--&gt;</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"> </span></p>
<p class="MsoNormal" style="text-align: left; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">&lt;</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;">TreeView</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: red; font-size: 8pt; mso-font-kerning: 0pt;"> Height</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">=&quot;308&quot;</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: red; font-size: 8pt; mso-font-kerning: 0pt;"> Name</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">=&quot;treeView1&quot;</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: red; font-size: 8pt; mso-font-kerning: 0pt;"> Width</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">=&quot;223&quot;</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: red; font-size: 8pt; mso-font-kerning: 0pt;"> ItemsSource</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">=&quot;{</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;">Binding</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: red; font-size: 8pt; mso-font-kerning: 0pt;"> Path=Children</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">}&quot;&gt;</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"> </span></p>
<p class="MsoNormal" style="text-align: left; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: green; font-size: 8pt; mso-font-kerning: 0pt;">&lt;!--define the item (tree node) template, i.e. each ModelItem corresponds to a node--&gt;</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"> </span></p>
<p class="MsoNormal" style="text-align: left; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">&lt;</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;">TreeView.ItemTemplate</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;"> &gt;</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"> </span></p>
<p class="MsoNormal" style="text-align: left; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: green; font-size: 8pt; mso-font-kerning: 0pt;">&lt;!--in order to have a hierarchical tree, it also requires to bind ModeItem.Children. Thus</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"> </span></p>
<p class="MsoNormal" style="text-align: left; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: green; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>WPF knows to iterate the child node--&gt;</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"> </span></p>
<p class="MsoNormal" style="text-align: left; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">&lt;</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;">HierarchicalDataTemplate</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"> <span style="color: red;"><span style="mso-spacerun: yes;">&#0160;</span>ItemsSource</span><span style="color: blue;">=&quot;{</span><span style="color: #a31515;">Binding</span><span style="color: red;"> Path=Children</span><span style="color: blue;"> }&quot;&gt;</span> </span></p>
<p class="MsoNormal" style="text-align: left; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: green; font-size: 8pt; mso-font-kerning: 0pt;">&lt;!--TextBlock defines the final text displayed with the tree node. e.g. we tell WPF to display</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"> </span></p>
<p class="MsoNormal" style="text-align: left; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: green; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>ModelItem.DsiplayName--&gt;</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"> </span></p>
<p class="MsoNormal" style="text-align: left; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">&lt;</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;">TextBlock</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: red; font-size: 8pt; mso-font-kerning: 0pt;"> Foreground</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">=&quot;Red&quot;</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: red; font-size: 8pt; mso-font-kerning: 0pt;"> Text</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">=&quot;{</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;">Binding</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: red; font-size: 8pt; mso-font-kerning: 0pt;"> Path</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">=DisplayName}&quot; /&gt;</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"> </span></p>
<p class="MsoNormal" style="text-align: left; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160; </span></span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">&lt;/</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;">HierarchicalDataTemplate</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">&gt;</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"> </span></p>
<p class="MsoNormal" style="text-align: left; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">&lt;/</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;">TreeView.ItemTemplate</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">&gt;</span></p>
<p class="MsoNormal" style="text-align: left; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">&lt;/</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;">TreeView</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">&gt; </span></p>
<p class="MsoNormal">&#0160;</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017c384d2468970b-pi"><img alt="image" border="0" height="343" src="/assets/image_921882.jpg" style="display: inline; border-width: 0px;" title="image" width="512" /></a> </p>
<p>The tree is built.But you may quickly find some nodes have no name! What’s up? Actually, ModelItem.DisplayName is the name displayed for the end user. It is supplied by the original CAD designer. e.g. in this model which is from a DWG file, the layer has name, the block definition has name, however, insert or the end geometries have no name. While I guess Navisworks organized the names when it is loading the CAD file. So it looks well in its Selection Tree. ModelItem.ClassName or ModelItem.ClassDisplayName are not empty in default. But they are not meaningful to the end user. I do not suggest to bind them to the tree.</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017c384d249b970b-pi"><img alt="image" border="0" height="409" src="/assets/image_587907.jpg" style="display: inline; border-width: 0px;" title="image" width="340" /></a> </p>
<p>Well, does this mean we have no way to give the desired name by binding? No, WPF is much flexible. It allows you with conditional statements. again, the tutorial on internet tells more:</p>
<p><a href="http://stackoverflow.com/questions/11395349/writing-conditional-statements-in-xaml-code" title="http://stackoverflow.com/questions/11395349/writing-conditional-statements-in-xaml-code">http://stackoverflow.com/questions/11395349/writing-conditional-statements-in-xaml-code</a></p>
<p>I chose the way <strong>IValueConverter</strong>. I do not want to spend time to explain the theory of <strong>IValueConverter</strong>. Please refer to MSDN for details. In our case, we need firstly create our own conversion class. e.g.</p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: green; font-size: 8pt; mso-font-kerning: 0pt;">// conversion class for tree node</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"> </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">public</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"> <span style="color: blue;">class</span> <span style="color: #2b91af;">NwTreeConverter</span> : <span style="color: #2b91af;">IValueConverter</span> </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;">{ </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span><span style="color: blue;">public</span> <span style="color: blue;">object</span> Convert(<span style="color: blue;">object</span> value, <span style="color: #2b91af;">Type</span> targetType, <span style="color: blue;">object</span> parameter, <span style="color: #2b91af;">CultureInfo</span> culture) </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span>{ </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: green;">// since we bind DisplayName to the node, the value is a string</span> </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: green;">//&lt;TextBlock Foreground=&quot;Red&quot; Text=&quot;{Binding Path=DisplayName}&quot; /&gt;</span></span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"> </span></p>
<p>&#0160;</p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: blue;">if</span> (value == <span style="color: #a31515;">&quot;&quot;</span>) </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: green;">// if it is empty, return an arbitrary string </span></span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: blue;">return</span> <span style="color: #a31515;">&quot;dummy&quot;</span>; </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: blue;">else</span> </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: green;">// if it is not empty, return it</span> </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: blue;">return</span> value;</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"> </span></p>
<p>&#0160;</p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span>} </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span><span style="color: blue;">public</span> <span style="color: blue;">object</span> ConvertBack(<span style="color: blue;">object</span> value, <span style="color: #2b91af;">Type</span> targetType, <span style="color: blue;">object</span> parameter, <span style="color: #2b91af;">CultureInfo</span> culture) </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span>{ </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: green;">// we do not need to convert back at this moment </span></span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: blue;">throw</span> <span style="color: blue;">new</span> <span style="color: #2b91af;">NotImplementedException</span>(); </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span>} </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;">} </span></p>
<p class="MsoNormal" style="layout-grid-mode: char;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt;">&#0160;</span></p>
<p>Some more lines in the xmal are required, in order to tell the tree view control to use the class.</p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: gray; font-size: 8pt; mso-font-kerning: 0pt; mso-themecolor: background1; mso-themeshade: 128;">&lt;Window x:Class=&quot;NwWPFControlApp.MainWindow&quot; </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: gray; font-size: 8pt; mso-font-kerning: 0pt; mso-themecolor: background1; mso-themeshade: 128;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="mso-spacerun: yes;">&#0160;</span>xmlns=&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: gray; font-size: 8pt; mso-font-kerning: 0pt; mso-themecolor: background1; mso-themeshade: 128;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="mso-spacerun: yes;">&#0160;</span>xmlns:x=&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;<span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: gray; font-size: 8pt; mso-font-kerning: 0pt; mso-themecolor: background1; mso-themeshade: 128;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="mso-spacerun: yes;">&#0160;</span>Title=&quot;MainWindow&quot; Height=&quot;350&quot; Width=&quot;525&quot; </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: gray; font-size: 8pt; mso-font-kerning: 0pt; mso-themecolor: background1; mso-themeshade: 128;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="mso-spacerun: yes;">&#0160;</span>xmlns:NwApi=&quot;clr-namespace:Autodesk.Navisworks.Api;assembly=Autodesk.Navisworks.Api&quot; </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: gray; font-size: 8pt; mso-font-kerning: 0pt; mso-themecolor: background1; mso-themeshade: 128;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="mso-spacerun: yes;">&#0160;</span>xmlns:NwControls=&quot;clr-namespace:Autodesk.Navisworks.Api.Controls;assembly=Autodesk.Navisworks.Controls&quot; </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: gray; font-size: 8pt; mso-font-kerning: 0pt; mso-themecolor: background1; mso-themeshade: 128;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="mso-spacerun: yes;">&#0160;</span>xmlns:my=&quot;clr-namespace:System.Windows.Forms.Integration;assembly=WindowsFormsIntegration&quot; Closed=&quot;Window_Closed&quot; </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="color: red;"><span style="mso-spacerun: yes;">&#0160;</span>xmlns</span><span style="color: blue;">:</span><span style="color: red;">src</span><span style="color: blue;">=&quot;clr-namespace:</span></span><span lang="EN-US"> </span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">NwWPFControlApp&quot;&gt;</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"> </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;">&#0160;</span></p>
<p>&#0160;</p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span></span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: green; font-size: 8pt; mso-font-kerning: 0pt;">&lt;!--import the conversion class--&gt;</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"> </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span></span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; background: yellow; color: blue; font-size: 8pt; mso-font-kerning: 0pt; mso-highlight: yellow;">&lt;</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; background: yellow; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt; mso-highlight: yellow;">Control.Resources</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; background: yellow; color: blue; font-size: 8pt; mso-font-kerning: 0pt; mso-highlight: yellow;">&gt;</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; background: yellow; font-size: 8pt; mso-font-kerning: 0pt; mso-highlight: yellow;"> </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; background: yellow; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt; mso-highlight: yellow;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; background: yellow; color: blue; font-size: 8pt; mso-font-kerning: 0pt; mso-highlight: yellow;">&lt;</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; background: yellow; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt; mso-highlight: yellow;">src</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; background: yellow; color: blue; font-size: 8pt; mso-font-kerning: 0pt; mso-highlight: yellow;">:</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; background: yellow; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt; mso-highlight: yellow;">NwTreeConverter</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; background: yellow; color: red; font-size: 8pt; mso-font-kerning: 0pt; mso-highlight: yellow;"> x</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; background: yellow; color: blue; font-size: 8pt; mso-font-kerning: 0pt; mso-highlight: yellow;">:</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; background: yellow; color: red; font-size: 8pt; mso-font-kerning: 0pt; mso-highlight: yellow;">Key</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; background: yellow; color: blue; font-size: 8pt; mso-font-kerning: 0pt; mso-highlight: yellow;">=&quot;NwTreeConverter&quot;/&gt;</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; background: yellow; font-size: 8pt; mso-font-kerning: 0pt; mso-highlight: yellow;"> </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; background: yellow; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt; mso-highlight: yellow;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span></span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; background: yellow; color: blue; font-size: 8pt; mso-font-kerning: 0pt; mso-highlight: yellow;">&lt;/</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; background: yellow; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt; mso-highlight: yellow;">Control.Resources</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; background: yellow; color: blue; font-size: 8pt; mso-font-kerning: 0pt; mso-highlight: yellow;">&gt;</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"> </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span></span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;">&#0160;</span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160; </span></span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: gray; font-size: 8pt; mso-font-kerning: 0pt; mso-themecolor: background1; mso-themeshade: 128;"><span style="mso-spacerun: yes;">&#0160;</span>&lt;DockPanel&gt; </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: gray; font-size: 8pt; mso-font-kerning: 0pt; mso-themecolor: background1; mso-themeshade: 128;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>&lt;Button Content=&quot;Open File&quot; Height=&quot;23&quot; Name=&quot;button1&quot; Width=&quot;75&quot; Click=&quot;button1_Click&quot; /&gt; </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: gray; font-size: 8pt; mso-font-kerning: 0pt; mso-themecolor: background1; mso-themeshade: 128;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>&lt;WindowsFormsHost Width=&quot;198&quot;&gt; </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: gray; font-size: 8pt; mso-font-kerning: 0pt; mso-themecolor: background1; mso-themeshade: 128;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>&lt;!--x:Uid used in XAML context--&gt; </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: gray; font-size: 8pt; mso-font-kerning: 0pt; mso-themecolor: background1; mso-themeshade: 128;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>&lt;!--x:Name governed by the XAML namescope--&gt; </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: gray; font-size: 8pt; mso-font-kerning: 0pt; mso-themecolor: background1; mso-themeshade: 128;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>&lt;NwControls:ViewControl x:Uid=&quot;viewControl&quot;<span style="mso-spacerun: yes;">&#0160;&#0160; </span></span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: gray; font-size: 8pt; mso-font-kerning: 0pt; mso-themecolor: background1; mso-themeshade: 128;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="mso-spacerun: yes;">&#0160;</span>x:Name=&quot;viewControl&quot; </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: gray; font-size: 8pt; mso-font-kerning: 0pt; mso-themecolor: background1; mso-themeshade: 128;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="mso-spacerun: yes;">&#0160;</span>Dock=&quot;Fill&quot; /&gt; </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: gray; font-size: 8pt; mso-font-kerning: 0pt; mso-themecolor: background1; mso-themeshade: 128;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>&lt;/WindowsFormsHost&gt; </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;">&#0160;</span></p>
<p>&#0160;</p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160; </span></span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: green; font-size: 8pt; mso-font-kerning: 0pt;">&lt;!--tell the tree the collection of the hierarchy. in our case it is RootItem.Children--&gt;</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"> </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">&lt;</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;">TreeView</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: red; font-size: 8pt; mso-font-kerning: 0pt;"> Height</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">=&quot;308&quot;</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: red; font-size: 8pt; mso-font-kerning: 0pt;"> Name</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">=&quot;treeView1&quot;</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: red; font-size: 8pt; mso-font-kerning: 0pt;"> Width</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">=&quot;223&quot;</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: red; font-size: 8pt; mso-font-kerning: 0pt;"> ItemsSource</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">=&quot;{</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;">Binding</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: red; font-size: 8pt; mso-font-kerning: 0pt;"> Path</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">=Children}&quot; SelectedItemChanged=&quot;treeView1_SelectedItemChanged&quot;&gt;</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"> </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: green; font-size: 8pt; mso-font-kerning: 0pt;">&lt;!--define the item (tree node) template, i.e. each ModelItem corresponds to a node--&gt;</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"> </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">&lt;</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;">TreeView.ItemTemplate</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;"> &gt;</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"> </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: green; font-size: 8pt; mso-font-kerning: 0pt;">&lt;!--in order to have a hierarchical tree, it also requires to bind ModeItem.Children. Thus</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"> </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: green; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>WPF knows to iterate the child node--&gt;</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"> </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">&lt;</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;">HierarchicalDataTemplate</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"> <span style="color: red;"><span style="mso-spacerun: yes;">&#0160;</span>ItemsSource</span><span style="color: blue;">=&quot;{</span><span style="color: #a31515;">Binding</span><span style="color: red;"> Path</span><span style="color: blue;">=Children }&quot;&gt;</span> </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: green; font-size: 8pt; mso-font-kerning: 0pt;">&lt;!--TextBlock defines the final text displayed with the tree node. e.g. we tell WPF to display</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"> </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: green; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span>ModelItem.DsiplayName--&gt;</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"> </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: green; font-size: 8pt; mso-font-kerning: 0pt;">&lt;!--tell the textbox to use the string returned from the conversion class--&gt;</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"> </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">&lt;</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;">TextBlock</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: red; font-size: 8pt; mso-font-kerning: 0pt;"> Foreground</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">=&quot;Red&quot;</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: red; font-size: 8pt; mso-font-kerning: 0pt;"> Text</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">=&quot;{</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;">Binding</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: red; font-size: 8pt; mso-font-kerning: 0pt;"> Path</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">=PropertyCategories,</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: red; font-size: 8pt; mso-font-kerning: 0pt;"> <span style="background: yellow; mso-highlight: yellow;">Converter</span></span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; background: yellow; color: blue; font-size: 8pt; mso-font-kerning: 0pt; mso-highlight: yellow;">={</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; background: yellow; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt; mso-highlight: yellow;">StaticResource</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; background: yellow; font-size: 8pt; mso-font-kerning: 0pt; mso-highlight: yellow;"> <span style="color: red;"><span style="mso-spacerun: yes;">&#0160;</span>NwTreeConverter</span><span style="color: blue;">}}&quot; /&gt;</span></span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"> </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">&lt;/</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;">HierarchicalDataTemplate</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">&gt;</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"> </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160; </span><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">&lt;/</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;">TreeView.ItemTemplate</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">&gt;</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"> </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">&lt;/</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;">TreeView</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">&gt;</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"> </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;"><span style="mso-spacerun: yes;">&#0160;&#0160; </span></span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: gray; font-size: 8pt; mso-font-kerning: 0pt; mso-themecolor: background1; mso-themeshade: 128;"><span style="mso-spacerun: yes;">&#0160;</span>&lt;/DockPanel&gt; </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: gray; font-size: 8pt; mso-font-kerning: 0pt; mso-themecolor: background1; mso-themeshade: 128;">&lt;/Window&gt; </span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;">&#0160;</span></p>
<p class="MsoNormal" style="text-align: left; layout-grid-mode: char; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt;">&#0160;</span></p>
<p>Now, if we open the model, the tree looks like as below. </p>
<p class="MsoNormal" style="layout-grid-mode: char;"><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017ee9f08cb9970d-pi"><img alt="image" border="0" height="324" src="/assets/image_987186.jpg" style="display: inline; border-width: 0px;" title="image" width="487" /></a> </p>
<p>But it is not elegant to hard-code the name of the node with “dummy”. I have been racking my brain trying the way to provide more meaningful name. Finally, I can only think of to bind the ModelItem.PropertyCategories thus we could get any information in the properties and use them as the node name. So the conversion class is tuned to:</p>
<div style="font-family: courier new; background: white; color: black; font-size: 8pt;">
<p style="margin: 0px;"><span style="line-height: 140%; color: green;">// conversion class for tree node</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">public</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">class</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">NwTreeConverter</span><span style="line-height: 140%;"> : </span><span style="line-height: 140%; color: #2b91af;">IValueConverter</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">public</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">object</span><span style="line-height: 140%;"> Convert(</span><span style="line-height: 140%; color: blue;">object</span><span style="line-height: 140%;"> value, </span><span style="line-height: 140%; color: #2b91af;">Type</span><span style="line-height: 140%;"> targetType, </span><span style="line-height: 140%; color: blue;">object</span><span style="line-height: 140%;"> parameter, </span><span style="line-height: 140%; color: #2b91af;">CultureInfo</span><span style="line-height: 140%;"> culture)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">// &lt;TextBlock Foreground=&quot;Red&quot; Text=&quot;{Binding Path=PropertyCategories, </span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">// Converter={StaticResource&#0160; NwTreeConverter}}&quot; /&gt;</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">// the value is PropertyCategoryCollection</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af;">PropertyCategoryCollection</span><span style="line-height: 140%;"> oColl = value </span><span style="line-height: 140%; color: blue;">as</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">PropertyCategoryCollection</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">if</span><span style="line-height: 140%;"> (oColl == </span><span style="line-height: 140%; color: blue;">null</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">// can be null? that must be a terrible error!</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">return</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #a31515;">&quot;error!&quot;</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">else</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">// try to check if there is name with the item</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af;">DataProperty</span><span style="line-height: 140%;"> oDP = oColl.FindPropertyByDisplayName(</span><span style="line-height: 140%; color: #a31515;">&quot;Item&quot;</span><span style="line-height: 140%;">, </span><span style="line-height: 140%; color: #a31515;">&quot;Name&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">if</span><span style="line-height: 140%;"> (oDP != </span><span style="line-height: 140%; color: blue;">null</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">//use &quot;name&quot; as node name</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">return</span><span style="line-height: 140%;"> oDP.Value.ToDisplayString();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">else</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">// no &quot;name&quot;, then check &quot;type&quot;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oDP = oColl.FindPropertyByDisplayName(</span><span style="line-height: 140%; color: #a31515;">&quot;Item&quot;</span><span style="line-height: 140%;">, </span><span style="line-height: 140%; color: #a31515;">&quot;Type&quot;</span><span style="line-height: 140%;">);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">if</span><span style="line-height: 140%;"> (oDP != </span><span style="line-height: 140%; color: blue;">null</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">//use &quot;type&quot; as node name</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">return</span><span style="line-height: 140%;"> oDP.Value.ToDisplayString();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">else</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">// can be null? that must be a terrible error!</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">return</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #a31515;">&quot;Error!&quot;</span><span style="line-height: 140%;">;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; }</span></p>
<p style="margin: 0px;">&#0160;</p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">public</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">object</span><span style="line-height: 140%;"> ConvertBack(</span><span style="line-height: 140%; color: blue;">object</span><span style="line-height: 140%;"> value, </span><span style="line-height: 140%; color: #2b91af;">Type</span><span style="line-height: 140%;"> targetType, </span><span style="line-height: 140%; color: blue;">object</span><span style="line-height: 140%;"> parameter, </span><span style="line-height: 140%; color: #2b91af;">CultureInfo</span><span style="line-height: 140%;"> culture)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">return</span><span style="line-height: 140%;"> value;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
<p>And tell the xmal to bind PropertyCategories to the text of tree item.</p>
<p class="MsoNormal" style="text-align: left; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">&lt;</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;">TextBlock</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: red; font-size: 8pt; mso-font-kerning: 0pt;"> Foreground</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">=&quot;Red&quot;</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: red; font-size: 8pt; mso-font-kerning: 0pt;"> Text</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">=&quot;{</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;">Binding</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: red; font-size: 8pt; mso-font-kerning: 0pt;"> Path</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">=<span style="background: yellow; mso-highlight: yellow;">PropertyCategories</span>,</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: red; font-size: 8pt; mso-font-kerning: 0pt;"> Converter</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: blue; font-size: 8pt; mso-font-kerning: 0pt;">={</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; color: #a31515; font-size: 8pt; mso-font-kerning: 0pt;">StaticResource</span><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"> <span style="color: red;"><span style="mso-spacerun: yes;">&#0160;</span>NwTreeConverter</span><span style="color: blue;">}}&quot; /&gt;</span></span></p>
<p class="MsoNormal" style="text-align: left; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"><span style="color: blue;">&#0160;</span></span></p>
<p class="MsoNormal" style="text-align: left; mso-layout-grid-align: none;"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt; mso-font-kerning: 0pt;"><span style="color: blue;">&#0160;</span></span>     </p>
<p class="MsoNormal"><span lang="EN-US" style="font-family: &quot;Tahoma&quot;,&quot;sans-serif&quot;; font-size: 8pt;">&#0160;</span></p>
<p>&#0160;</p>
<p>Now our tree view is:</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017ee9f08cde970d-pi"><img alt="image" border="0" height="341" src="/assets/image_71192.jpg" style="display: inline; border-width: 0px;" title="image" width="507" /></a> </p>
<p>looks not bad, isn’t it? A little pity is I did not find a workaround to provide more meaningful name for the Insert node like UI does. But at least, it tells the end user what the node type is.</p>
<p>OK, I’d say the post is completed….wait! you must be wondering how the tree item can connect to the real model item since they are bound. yeah! You are correct! see below :-)</p>
<p>&#0160;</p>
<div style="font-family: courier new; background: white; color: black; font-size: 8pt;">
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;">private</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">void</span><span style="line-height: 140%;"> treeView1_SelectedItemChanged(</span><span style="line-height: 140%; color: blue;">object</span><span style="line-height: 140%;"> sender, </span><span style="line-height: 140%; color: #2b91af;">RoutedPropertyChangedEventArgs</span><span style="line-height: 140%;">&lt;</span><span style="line-height: 140%; color: blue;">object</span><span style="line-height: 140%;">&gt; e)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">{</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af;">ModelItem</span><span style="line-height: 140%;"> oCurrentNode= (</span><span style="line-height: 140%; color: #2b91af;">ModelItem</span><span style="line-height: 140%;">)e.NewValue;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">if</span><span style="line-height: 140%;"> (oCurrentNode != </span><span style="line-height: 140%; color: blue;">null</span><span style="line-height: 140%;">)</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; {</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af;">ModelItemCollection</span><span style="line-height: 140%;"> oMC = </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">ModelItemCollection</span><span style="line-height: 140%;">();</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oMC.Add(oCurrentNode);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af;">Document</span><span style="line-height: 140%;"> oDoc = documentControl.Document;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oDoc.CurrentSelection.CopyFrom(oMC);</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; }</span></p>
<p style="margin: 0px;"><span style="line-height: 140%;">}</span></p>
</div>
<p>&#0160;</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017ee9f08d0d970d-pi"><img alt="image" border="0" height="337" src="/assets/image_383292.jpg" style="display: inline; border-width: 0px;" title="image" width="497" /></a></p>
<p>&#0160;</p>
<p>I am thinking the next topic about WPF. If you have any suggestion, please share with me.</p>
