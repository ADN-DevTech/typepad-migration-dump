---
layout: "post"
title: "Check saved viewpoints of Navisworks model on-site - Part I"
date: "2012-11-05 19:48:22"
author: "Xiaodong Liang"
categories:
  - "Amazon Web Services"
  - "Android"
  - "Cloud"
  - "Mobile"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/cloud_and_mobile/2012/11/check-saved-viewpoints-of-navisworks-model-on-site-part-i.html "
typepad_basename: "check-saved-viewpoints-of-navisworks-model-on-site-part-i"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/cloud_and_mobile/xiaodong-liang.html" target="_self">Xiaodong Liang</a></p>
<p>Cloud &amp; mobile (C&amp;M) is an exciting technology. My colleagues have created many excellent tutorials on various aspects that can be used to integrate Autodesk products with C&amp;M. I believe some Navisworks developers are thinking the applications to connect Navisworks with C&amp;M. Recently, I started to try my hands on it and created a first demo. In addition, my colleague Simon Bee in the engineer team has delivered another demo on the DevCamp in June this year. I will post them in a series as a start for the practice of Navisworks. </p>
<p>Here is the first post that introduces my sample.</p>
<p><strong>Target</strong></p>
<p>The diagram below illustrates what the sample targets to.</p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017ee4c9c51c970d-pi"><img alt="image" border="0" height="161" src="/assets/image_4a235c.jpg" style="display: inline; border-width: 0px;" title="image" width="476" /></a> </p>
<p><span style="font-size: xx-small;">The figures above refer to the two pictures in the links:      <br /></span><a href="http://www.uimaker.com/uimakerhtml/uidesign/uiphone/2011/1114/25549.htm"><span style="font-size: xx-small;">www.uimaker.com/uimakerhtml/uidesign/uiphone/2011/1114/25549.htm</span></a>     <br /><a href="http://it.southcn.com/9/2009-09/11/content_5759707_2.htm"><span style="font-size: xx-small;">http://it.southcn.com/9/2009-09/11/content_5759707_2.htm</span></a><span style="font-size: xx-small;"> </span></p>
<p>In the office, we open the Navisworks model, switch to each saved viewpoints, export to the image and upload it to the cloud. When we are working on-site, we can use mobile to connect with the cloud, download the images and view the viewpoints that we are interested in. Actually, you can apply this demo with other Autodesk products such as Inventor, Revit, uploading the latest list of viewpoints and check them anywhere with the mobile. I hope this tiny demo would be helpful for you to get started with Simon’s demo J - more interesting! </p>
<p>In this practice, we use <a href="http://aws.amazon.com/">Amazon cloud </a>and the services <a href="http://aws.amazon.com/s3/">S3</a>. At the mobile end, it is Android. Please make sure you have the following environments:</p>
<p>- Navisworks 2013 on your machines in the office</p>
<p>- Account of <a href="http://aws.amazon.com/">Amazon cloud </a>and can have <a href="http://aws.amazon.com/s3/">S3</a> service     <br />- Visual Studio 2010     <br />- <a href="http://aws.amazon.com/visualstudio/">Amazon SDK for Visual Studio</a>     <br />- <a href="http://www.eclipse.org/downloads/">Eclipse </a>    <br />- <a href="http://developer.android.com/tools/sdk/eclipse-adt.html">Android SDK for Eclipse</a> (ADT Plugin)     <br />- Amazon SDK for Eclipse     <br />- A mobile of Android. This is just for the real test. In our developing, the emulator AVD (Android Virtual Device) is used.</p>
<p>We will not introduce in detail on how to setup these environments. If you are new to cloud and mobile technology, I would suggest you get started with the tutorials on <a href="http://developer.android.com/sdk/index.html">Android Development</a> and <a href="http://aws.amazon.com/articles/">Amazon Cloud</a> . </p>
<p><strong>Creating Navisworks .NET plug-in</strong></p>
<p>First we need to create a .NET plug-in of Navisworks, adding a button in Add-Ins tab to execute our command. Simply, create a class from AddInPlugin. Add the basic references of Navisworks API. The references are required:</p>
<p>- Autodesk.Navisworks.Api: for plug-in, saved viewpoints    <br />- Autodesk.Navisworks.ComApi : for export image     <br />- Autodesk.Navisworks.Interop.ComApi: for export image     <br />- AWSSDK: for cloud of Amazon.</p>
<p>Navisworks 2013 has exposed the <a href="http://adndevblog.typepad.com/aec/2012/06/navisworks-net-api-2013-new-feature-viewpoint-1.html">.NET API for viewpoints</a> and <a href="http://adndevblog.typepad.com/aec/2012/06/navisworks-net-api-2013-new-feature-saved-viewpoint.html">saved viewpoints</a>. These are some posts on the relevant topic on <a href="http://adndevblog.typepad.com/">AEC blog</a>. However, we still need to use COM interop to access the ability of exporting image. In this demo, we iterate the collection of each save viewpoint, export the current viewpoint to the image. </p>
<p>After that, the image will be uploaded to the cloud. We will firstly check if a bucket named “nw_demo_test” exists. If not, create one. To category the saved viewpoints from different files, we create a folder for each model in the bucket.</p>
<p>Of course, we could use an Automation application (calling the plug-in) to do all the jobs above, when we are sleeping. </p>
<p>Following is the source code. It self-explains the functionalities. </p>
<div style="font-family: 新宋体; background: white; color: black; font-size: 14pt;">
<p style="margin: 0px;"><span style="color: #2b91af;">&#0160;&#0160; </span></p>
</div>
<div style="font-family: 新宋体; background: white; color: black; font-size: 9pt;">
<p style="margin: 0px;"><span style="line-height: 140%; color: green;"><span style="font-family: &#39;Courier New&#39;;">// namespaces of Navisworks</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> Autodesk.Navisworks.Api;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> Autodesk.Navisworks.Api.Plugins;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> Autodesk.Navisworks.Api.DocumentParts;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">ComBridge</span><span style="line-height: 140%;"> = Autodesk.Navisworks.Api.ComApi.</span><span style="line-height: 140%; color: #2b91af;">ComApiBridge</span><span style="line-height: 140%;">;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> ComApi = Autodesk.Navisworks.Api.Interop.ComApi;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;">&#0160;</span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: green;"><span style="font-family: &#39;Courier New&#39;;">//namespaces of Amazon cloud</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> Amazon.S3;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> Amazon.S3.Model;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;</span></span></p>
</div>
<div style="font-family: 新宋体; background: white; color: black; font-size: 9pt;">
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">[</span><span style="line-height: 140%; color: #2b91af;">PluginAttribute</span><span style="line-height: 140%;">(</span><span style="line-height: 140%; color: #a31515;">&quot;NW_API_Cloud_Mobile&quot;</span><span style="line-height: 140%;">,</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">//4 character Developer ID or GUID</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #a31515;">&quot;ADSK&quot;</span><span style="line-height: 140%;">,</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">//The tooltip for the item in the ribbon</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; ToolTip = </span><span style="line-height: 140%; color: #a31515;">&quot;demo of Navisworks and C &amp; M&quot;</span><span style="line-height: 140%;">,</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">//Display name for the Plugin in the Ribbon</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; DisplayName = </span><span style="line-height: 140%; color: #a31515;">&quot;Autodesk C&amp;M&quot;</span><span style="line-height: 140%;">)]</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%; color: blue;">public</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">class</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">Class1</span><span style="line-height: 140%;"> : </span><span style="line-height: 140%; color: #2b91af;">AddInPlugin</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">{</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">// execute the plug-in command</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">public</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">override</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">int</span><span style="line-height: 140%;"> Execute(</span><span style="line-height: 140%; color: blue;">params</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;">[] parameters)</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160; {</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">// export the saved viewpoints to images</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; dumpSavedVP();</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">// upload images to cloud</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; uploadToCloud();</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">return</span><span style="line-height: 140%;"> 0;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160; }</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;">&#0160;</span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%; color: blue;">#region</span><span style="line-height: 140%;"> &quot;produce images&quot;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">//locations to export the images</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">static</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> _snapshos_location = </span><span style="line-height: 140%; color: #a31515;">&quot;c:\\temp\\&quot;</span><span style="line-height: 140%;">;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">// array of names of the saved viewpoints</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af;">List</span><span style="line-height: 140%;">&lt;</span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;">&gt; _fileArray = </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">List</span><span style="line-height: 140%;">&lt;</span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;">&gt;();</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;">&#0160;</span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">// export the saved viewpoints to images</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">private</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">void</span><span style="line-height: 140%;"> dumpSavedVP()</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160; {</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">// get the active document</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af;">Document</span><span style="line-height: 140%;"> oDoc = </span><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Autodesk.Navisworks.Api.</span><span style="line-height: 140%; color: #2b91af;">Application</span><span style="line-height: 140%;">.ActiveDocument;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">// get the state of COM</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ComApi.</span><span style="line-height: 140%; color: #2b91af;">InwOpState10</span><span style="line-height: 140%;"> oState =</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af;">ComBridge</span><span style="line-height: 140%;">.State;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">// get the IO plugin for image</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; ComApi.</span><span style="line-height: 140%; color: #2b91af;">InwOaPropertyVec</span><span style="line-height: 140%;"> options = </span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oState.GetIOPluginOptions(</span><span style="line-height: 140%; color: #a31515;">&quot;lcodpimage&quot;</span><span style="line-height: 140%;">);</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;">&#0160;</span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">// configure the option &quot;export.image.format&quot; </span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%; color: green;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; //to export png</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">foreach</span><span style="line-height: 140%;"> (ComApi.</span><span style="line-height: 140%; color: #2b91af;">InwOaProperty</span><span style="line-height: 140%;"> opt </span><span style="line-height: 140%; color: blue;">in</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; options.Properties())</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">if</span><span style="line-height: 140%;"> (opt.name == </span><span style="line-height: 140%; color: #a31515;">&quot;export.image.format&quot;</span><span style="line-height: 140%;">)</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; opt.value = </span><span style="line-height: 140%; color: #a31515;">&quot;lcodpexpng&quot;</span><span style="line-height: 140%;">;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span>&#0160;</span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">// swtich to the saved viewpoint</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">foreach</span><span style="line-height: 140%;"> (</span><span style="line-height: 140%; color: #2b91af;">SavedViewpoint</span><span style="line-height: 140%;"> oSVP </span><span style="line-height: 140%; color: blue;">in</span><span style="line-height: 140%;"> </span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oDoc.SavedViewpoints.ToSavedItemCollection())</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> svpName = oSVP.DisplayName;</span>&#0160;</span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%; color: green;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; // set the current viewpoint</span></span>&#0160; <span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">oDoc.SavedViewpoints.CurrentSavedViewpoint </span></span><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; = </span></span><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;"> oSVP;</span>&#0160;</span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">// the image name</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> tempFileName = </span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; _snapshos_location + svpName + </span><span style="line-height: 140%; color: #a31515;">&quot;.png&quot;</span><span style="line-height: 140%;">;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;">&#0160;</span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">// delete the existing image if there is.</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">if</span><span style="line-height: 140%;"> (System.IO.</span><span style="line-height: 140%; color: #2b91af;">File</span><span style="line-height: 140%;">.Exists(tempFileName))</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; System.IO.</span><span style="line-height: 140%; color: #2b91af;">File</span><span style="line-height: 140%;">.Delete(tempFileName);&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">try</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">//export the viewpoint to the image</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oState.DriveIOPlugin(</span><span style="line-height: 140%; color: #a31515;">&quot;lcodpimage&quot;</span><span style="line-height: 140%;">, </span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; tempFileName, options);</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; System.Drawing.</span><span style="line-height: 140%; color: #2b91af;">Bitmap</span></span><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;"> oBitmap =          <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> System.Drawing.</span><span style="line-height: 140%; color: #2b91af;">Bitmap</span><span style="line-height: 140%;">(tempFileName);</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; System.IO.</span><span style="line-height: 140%; color: #2b91af;">MemoryStream</span></span><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;"> ImageStream =          <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> System.IO.</span><span style="line-height: 140%; color: #2b91af;">MemoryStream</span><span style="line-height: 140%;">();</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oBitmap.Save(ImageStream,&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; System.Drawing.Imaging.</span><span style="line-height: 140%; color: #2b91af;">ImageFormat</span><span style="line-height: 140%;">.Jpeg);</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;">&#0160;</span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%; color: green;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; // add the image name to the list for use </span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">//of uploading to cloud</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; _fileArray.Add(svpName);</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">catch</span><span style="line-height: 140%;">(</span><span style="line-height: 140%; color: #2b91af;">Exception</span><span style="line-height: 140%;"> ex)</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af;">MessageBox</span><span style="line-height: 140%;">.Show(ex.ToString());</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; } </span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160; }</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;"><span style="font-family: &#39;Courier New&#39;;">#endregion</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;">&#0160;</span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%; color: blue;">#region</span><span style="line-height: 140%;"> &quot;upload images&quot;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;">&#0160;</span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">//Amazon client object</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">static</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">AmazonS3</span><span style="line-height: 140%;"> _s3Client;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">// Your Access Key To Cloud</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">static</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> accessKey = </span><span style="line-height: 140%; color: #a31515;">&quot;Your Access Key To Cloud&quot;</span><span style="line-height: 140%;">;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">//Your Secrete Key To Cloud</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">static</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> secreteKey = </span><span style="line-height: 140%; color: #a31515;">&quot;Your Secrete Key To Cloud&quot;</span><span style="line-height: 140%;">;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">//the name of the bucket we will upload image to</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">static</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> bucketName = </span><span style="line-height: 140%; color: #a31515;">&quot;nw_demo_test&quot;</span><span style="line-height: 140%;">;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">//the name of folder to store the images of each model</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">static</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> folderName = </span><span style="line-height: 140%; color: #a31515;">&quot;&quot;</span><span style="line-height: 140%;">;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;">&#0160;</span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">// upload images to cloud</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">private</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">void</span><span style="line-height: 140%;"> uploadToCloud()</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160; {</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">// connect to the cloud</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; _s3Client = </span></span><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Amazon.</span><span style="line-height: 140%; color: #2b91af;">AWSClientFactory</span><span style="line-height: 140%;">.CreateAmazonS3Client(</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; accessKey, secreteKey);</span></span><span style="font-family: &#39;Courier New&#39;;">&#0160;</span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af;">Document</span><span style="line-height: 140%;"> oDoc =</span><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Autodesk.Navisworks.Api.</span><span style="line-height: 140%; color: #2b91af;">Application</span><span style="line-height: 140%;">.ActiveDocument;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;">&#0160;</span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">// get the model file name</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; folderName = </span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; System.IO.</span><span style="line-height: 140%; color: #2b91af;">Path</span><span style="line-height: 140%;">.</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; GetFileNameWithoutExtension(oDoc.FileName) + </span><span style="line-height: 140%; color: #a31515;">&quot;/&quot;</span><span style="line-height: 140%;">;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;">&#0160;</span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">//Create bucket and folder</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">if</span><span style="line-height: 140%;"> (!createBucketAndFolder())</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">return</span><span style="line-height: 140%;">;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">try</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">// connect to the service to upload by S3</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> (</span><span style="line-height: 140%; color: #2b91af;">ListBucketsResponse</span><span style="line-height: 140%;"> response = </span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; _s3Client.ListBuckets())</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">foreach</span><span style="line-height: 140%;">(</span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> oEachImage </span><span style="line-height: 140%; color: blue;">in</span><span style="line-height: 140%;"> </span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; _fileArray)</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">// new a PutObjectRequest</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af;">PutObjectRequest</span><span style="line-height: 140%;"> por_file = </span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">PutObjectRequest</span><span style="line-height: 140%;">();</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">//put into this bucket </span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; por_file.WithBucketName</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (bucketName);</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">//the key:</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">// &quot;/&quot; means the folder</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; por_file.WithKey(folderName +</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oEachImage + </span><span style="line-height: 140%; color: #a31515;">&quot;.png&quot;</span><span style="line-height: 140%;">);</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">// the image to upload</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; por_file.WithFilePath(</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; _snapshos_location +</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oEachImage + </span><span style="line-height: 140%; color: #a31515;">&quot;.png&quot;</span><span style="line-height: 140%;">);</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;">&#0160;</span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">// upload method</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; _s3Client.PutObject(por_file);</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">catch</span><span style="line-height: 140%;"> (</span><span style="line-height: 140%; color: #2b91af;">AmazonS3Exception</span><span style="line-height: 140%;"> amazonS3Exception)</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af;">MessageBox</span><span style="line-height: 140%;">.Show(amazonS3Exception.ToString());&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160; }</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;">&#0160; </span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">//create the bucket and folder</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">private</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">bool</span><span style="line-height: 140%;"> createBucketAndFolder()</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160; {</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">try</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">// connect to the service to upload by S3</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">using</span><span style="line-height: 140%;"> (</span><span style="line-height: 140%; color: #2b91af;">ListBucketsResponse</span><span style="line-height: 140%;"> response = </span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; _s3Client.ListBuckets())</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">bool</span><span style="line-height: 140%;"> hasBucket = </span><span style="line-height: 140%; color: blue;">false</span><span style="line-height: 140%;">;</span>&#0160;</span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">//check if the bucket exists</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">////note: case sensitive&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">foreach</span><span style="line-height: 140%;"> (</span><span style="line-height: 140%; color: #2b91af;">S3Bucket</span><span style="line-height: 140%;"> bucket </span><span style="line-height: 140%; color: blue;">in</span><span style="line-height: 140%;"> </span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; response.Buckets)</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">if</span><span style="line-height: 140%;"> (bucket.BucketName == </span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; bucketName)&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; hasBucket = </span><span style="line-height: 140%; color: blue;">true</span><span style="line-height: 140%;">; ;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">break</span><span style="line-height: 140%;">; </span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;">&#0160;</span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">if</span><span style="line-height: 140%;"> (!hasBucket)</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">// create the&#0160; bucket</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af;">PutBucketRequest</span><span style="line-height: 140%;"> oBucketRequest = </span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">PutBucketRequest</span><span style="line-height: 140%;">();</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; oBucketRequest.BucketName = bucketName;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; _s3Client.PutBucket(oBucketRequest);</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;">&#0160;</span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">//check if folder exists</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">if</span><span style="line-height: 140%;">( ! S3ObjectExists(bucketName,folderName))</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="line-height: 140%; color: green;"><span style="font-family: &#39;Courier New&#39;;">// a folder is an item with the name          <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; //ended by &quot;/&quot;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af;">PutObjectRequest</span><span style="line-height: 140%;"> por_folder = </span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">PutObjectRequest</span><span style="line-height: 140%;">();</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; por_folder.WithBucketName(bucketName);</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; por_folder.WithKey(folderName);</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; por_folder.WithContentBody(</span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;">.Empty);</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;">&#0160;</span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">// create the item &gt;&gt; folder</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; _s3Client.PutObject(por_folder);&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; } </span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">return</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">true</span><span style="line-height: 140%;">;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;">&#0160;</span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">return</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">false</span><span style="line-height: 140%;">;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">catch</span><span style="line-height: 140%;"> (</span><span style="line-height: 140%; color: #2b91af;">AmazonS3Exception</span><span style="line-height: 140%;"> amazonS3Exception)</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af;">MessageBox</span><span style="line-height: 140%;">.Show(amazonS3Exception.ToString());</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">return</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">false</span><span style="line-height: 140%;">;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160; }</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;">&#0160;</span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">// refer to this post</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">// <a href="http://www.billrowell.com/2010/12/21/determine-if-amazon-s3-object-exists-with-asp-net-sdk/">http://www.billrowell.com/2010/12/21/determine-if-amazon-s3-object-exists-with-asp-net-sdk/</a></span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: green;"><span style="font-family: &#39;Courier New&#39;;">&#0160;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">// check if an S3 item exists</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">public</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">bool</span><span style="line-height: 140%;"> S3ObjectExists(</span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> bucket, </span><span style="line-height: 140%; color: blue;">string</span><span style="line-height: 140%;"> key)</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160; {&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af;">GetObjectRequest</span><span style="line-height: 140%;"> request = </span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">new</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: #2b91af;">GetObjectRequest</span><span style="line-height: 140%;">();</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; request.BucketName = bucket;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; request.Key = key;</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">try</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">// try if the S3Response</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: #2b91af;">S3Response</span><span style="line-height: 140%;"> response = </span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; _s3Client.GetObject(request);</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">if</span><span style="line-height: 140%;"> (response.ResponseStream != </span><span style="line-height: 140%; color: blue;">null</span><span style="line-height: 140%;">)</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: green;">// the item exists</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">return</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">true</span><span style="line-height: 140%;">;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">catch</span><span style="line-height: 140%;"> (</span><span style="line-height: 140%; color: #2b91af;">AmazonS3Exception</span><span style="line-height: 140%;">)</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">return</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">false</span><span style="line-height: 140%;">;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">catch</span><span style="line-height: 140%;"> (</span><span style="line-height: 140%; color: #2b91af;">Exception</span><span style="line-height: 140%;">)</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; {</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">return</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">false</span><span style="line-height: 140%;">;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; }</span></span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;">&#0160;</span></p>
<p style="margin: 0px;"><span style="font-family: &#39;Courier New&#39;;"><span style="line-height: 140%;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span style="line-height: 140%; color: blue;">return</span><span style="line-height: 140%;"> </span><span style="line-height: 140%; color: blue;">false</span><span style="line-height: 140%;">;</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160; }</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%; color: blue;"><span style="font-family: &#39;Courier New&#39;;">&#0160;&#0160;&#0160; #endregion</span></span></p>
<p style="margin: 0px;"><span style="line-height: 140%;"><span style="font-family: &#39;Courier New&#39;;">}</span></span></p>
</div>
<p>Open a Navisworks file, run the plug-in. The images of each saved viewpoint will be uploaded to the cloud. </p>
<p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017d3d54661b970c-pi"><img alt="image" border="0" height="244" src="/assets/image_9d7d0e.jpg" style="display: inline; border: 0px;" title="image" width="440" /></a> </p>
<p>In the next post, we will see the section of creating Android project. </p>
