---
layout: "post"
title: "Creating a cloud based viewer &ndash; Part IV"
date: "2012-08-06 15:35:38"
author: "Philippe Leefsma"
categories:
  - "Philippe Leefsma"
  - "Server"
  - "Web Server"
original_url: "https://adndevblog.typepad.com/cloud_and_mobile/2012/08/creating-a-cloud-based-viewerpart-iv.html "
typepad_basename: "creating-a-cloud-based-viewerpart-iv"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/cloud_and_mobile/philippe-leefsma.html">Philippe Leefsma</a></p>  <p>Here is the fourth part of my quest to share with you my experience in creating cloud based viewing technologies. <a href="http://adndevblog.typepad.com/cloud_and_mobile/2012/07/creating-a-cloud-based-viewer-part-iii.html">Last Time</a> we took a look at how to host our viewer service on the Amazon cloud, so it could be reached from any desktop application. Today we are going to add a, let’s say, fancy – at least to me – feature:&#160; server callbacks. It is also known as push notifications. Here is a definition I gathered from the web: </p>  <p><em>Push notification, or server push, describes a style of Internet-based communication where the request for a given communication is initiated by the publisher or server. This technology aims at enhancing performances and traffic at the client side by suppressing the need for the client to poll regularly the server for updates.</em> </p>  <p>The technology we are studying today is a kind of push notification, only valid in the context WCF Server – WCF Client. You can find resources about it on the web by looking for <em>WCF Callback</em> keywords.</p>  <p>First of all, I largely inspired that example from the great blog post of Barry Dorrans you can find <a href="http://idunno.org/archive/2008/05/29/wcf-callbacks-a-beginners-guide.aspx">here</a>.</p>  <p>As usual, I will start by the server side implementation, expose the deployment considerations, to finish with the client side implementation and tests. The idea I wanted to illustrate is to add server callbacks to our viewer service, such as when a new model is added by the administrator console to the cloud database, reciprocally removed, each client viewer will be automatically notified without the need to run for example a polling thread on the client side. I hope the interest of such an approach looks obvious to you…</p>  <p><strong>I – Implementing callback on server side</strong></p>  <p>The first thing we need to define is a callback contract interface, to reuse WCF terminology. This interface will expose the methods that the clients can implement in order to receive server callbacks. We also need to specify that this interface is the <em>CallbackContract</em> of a specific <em>ServiceContract</em>. In my example, I decided to create a specific ServiceContract so things can look more organized as if it was gathered with my existing previous contract. So declaration of that stuff is as follow:</p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><font style="font-size: 8pt">public</font></font></span><span style="font-family: "><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#0000ff">interface</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#2b91af">IServerCallback</font></span></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 8pt" color="#000000">{</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160; </font></span><font style="font-size: 8pt">[</font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">OperationContract</font></span><font color="#000000">(IsOneWay = </font><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">)]</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">void</font></span><font color="#000000"> OnDbModelAdded(</font><span style="color: "><font color="#2b91af">ModelInfo</font></span><font color="#000000"> modelInfo);</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160; </font></span><font style="font-size: 8pt">[</font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">OperationContract</font></span><font color="#000000">(IsOneWay = </font><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">)]</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">void</font></span><font color="#000000"> OnDbModelRemoved(</font><span style="color: "><font color="#0000ff">string</font></span><font color="#000000"> modelId);</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 8pt" color="#000000">}</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><font style="font-size: 8pt">[</font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">ServiceContract</font></span><font color="#000000">(CallbackContract = </font><span style="color: "><font color="#0000ff">typeof</font></span><font color="#000000">(</font><span style="color: "><font color="#2b91af">IServerCallback</font></span><font color="#000000">))]</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><font style="font-size: 8pt">public</font></font></span><span style="font-family: "><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#0000ff">interface</font></span><font color="#000000"> </font></font><span style="color: "><font style="font-size: 8pt" color="#2b91af">IAdnCloudViewerNotification</font></span></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 8pt" color="#000000">{</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160; </font></span><font style="font-size: 8pt">[</font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">OperationContract</font></span><font color="#000000">]</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">bool</font></span><font color="#000000"> Subscribe();</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160; </font></span><font style="font-size: 8pt">[</font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">OperationContract</font></span><font color="#000000">]</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">bool</font></span><font color="#000000"> Unsubscribe();</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 8pt" color="#000000">}</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font color="#000000" face="Consolas"></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font color="#ffffff" face="Consolas">-</font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal">My callback interface need to notify the client of two things: when a new model is added and when one is removed, so the clients can automatically update their cloud model collection without need to refresh all of it from the server. </p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal">&#160;</p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal">The new <em>IAdnCloudViewerNotification</em> contract also provides two functionalities: being able to subscribe and unsubscribe to the server callbacks.</p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal">&#160;</p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal">Here is the added implementation on the server side:</p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal">&#160;</p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><font style="font-size: 8pt">public</font></font></span><span style="font-family: "><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#0000ff">class</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">AdnCloudViewerSrv</font></span><font color="#000000"> : </font></font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">IAdnCloudViewerSrv</font></span><font color="#000000">,</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><span style="color: "><font style="font-size: 8pt" color="#2b91af">IAdnCloudViewerNotification</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font style="font-size: 11pt" color="#000000">{</font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;</font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Calibri"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;</font></span><font style="font-size: 11pt"><span style="mso-spacerun: yes">&#160;&#160;&#160; </span></font><span style="mso-spacerun: yes"><font style="font-size: 11pt">&#160;</font></span></font></font><span style="font-family: ; color: "><font face="Consolas"><font style="font-size: 8pt" color="#008000">// Previous implementation...</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><span style="mso-tab-count: 1"><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="mso-spacerun: yes"><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;&#160;&#160; </font></font></span><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;</font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">private</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">static</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">readonly</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">List</font></span><font color="#000000">&lt;</font><span style="color: "><font color="#2b91af">IServerCallback</font></span><font color="#000000">&gt; _subscribers =</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">List</font></span><font color="#000000">&lt;</font><span style="color: "><font color="#2b91af">IServerCallback</font></span><font color="#000000">&gt;();</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><span style="mso-spacerun: yes"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160; </font></font></span></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">bool</font></span><font color="#000000"> Subscribe()</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160; </font></span><font style="font-size: 8pt">{</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="color: "><font style="font-size: 8pt" color="#0000ff">try</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">{</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">IServerCallback</font></span><font color="#000000"> callback =</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">OperationContext</font></span><font color="#000000">.Current.GetCallbackChannel&lt;</font><span style="color: "><font color="#2b91af">IServerCallback</font></span><font color="#000000">&gt;();</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (!_subscribers.Contains(callback))</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">_subscribers.Add(callback);</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">;</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">}</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">catch</font></span><font color="#000000">(</font><span style="color: "><font color="#2b91af">Exception</font></span><font color="#000000"> ex)</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">{</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">false</font></span><font color="#000000">;</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">}</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160; </font></span><font style="font-size: 8pt">}</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">bool</font></span><font color="#000000"> Unsubscribe()</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160; </font></span><font style="font-size: 8pt">{</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="color: "><font style="font-size: 8pt" color="#0000ff">try</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">{</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">IServerCallback</font></span><font color="#000000"> callback =</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">OperationContext</font></span><font color="#000000">.Current.GetCallbackChannel&lt;</font><span style="color: "><font color="#2b91af">IServerCallback</font></span><font color="#000000">&gt;();</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (!_subscribers.Contains(callback))</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">_subscribers.Remove(callback);</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">;</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">}</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="color: "><font style="font-size: 8pt" color="#0000ff">catch</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">{</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">false</font></span><font color="#000000">;</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">}</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160; </font></span><font style="font-size: 8pt">}</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">private</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000"> DbModelAddedNotifySubscribers(</font><span style="color: "><font color="#2b91af">ModelInfo</font></span><font color="#000000"> modelInfo)</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160; </font></span><font style="font-size: 8pt">{</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">_subscribers.ForEach(</font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">delegate</font></span><font color="#000000">(</font><span style="color: "><font color="#2b91af">IServerCallback</font></span><font color="#000000"> callback)</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">{</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (((</font><span style="color: "><font color="#2b91af">ICommunicationObject</font></span><font color="#000000">)callback).State == </font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">CommunicationState</font></span><font color="#000000">.Opened)</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">{</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">callback.OnDbModelAdded(modelInfo);</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">}</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="color: "><font style="font-size: 8pt" color="#0000ff">else</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">{</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">_subscribers.Remove(callback);</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">}</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">});</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160; </font></span><font style="font-size: 8pt">}</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">private</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000"> DbModelRemovedNotifySubscribers(</font><span style="color: "><font color="#0000ff">string</font></span><font color="#000000"> modelId)</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160; </font></span><font style="font-size: 8pt">{</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">_subscribers.ForEach(</font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">delegate</font></span><font color="#000000">(</font><span style="color: "><font color="#2b91af">IServerCallback</font></span><font color="#000000"> callback)</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">{</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (((</font><span style="color: "><font color="#2b91af">ICommunicationObject</font></span><font color="#000000">)callback).State ==</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">CommunicationState</font></span><font color="#000000">.Opened)</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">{</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">callback.OnDbModelRemoved(modelId);</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">}</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="color: "><font style="font-size: 8pt" color="#0000ff">else</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">{</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">_subscribers.Remove(callback);</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">}</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">});</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160; </font></span><font style="font-size: 8pt">}</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font style="font-size: 11pt" color="#000000">}</font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal">&#160;</p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal">The only modification to the existing methods was to add the appropriate calls to <em>DbModelAddedNotifySubscribers</em> and <font face="Consolas"><font color="#000000"><font face="Arial"><em>DbModelRemovedNotifySubscribers</em> when a model is added/removed, so the subscribers get notified. </font></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font color="#000000"></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font color="#ffffff">-</font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font color="#000000"><strong>II – Configuring WCF service for callback notifications</strong></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font color="#000000"></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font color="#ffffff">-</font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font color="#000000">That was the easy part. We now need to deploy our service in order to test it. I followed the path I’m getting used to when testing WCF services:</font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font color="#ffffff">-</font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font color="#000000"></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font color="#000000">- Start by testing the service locally using the ServiceHost functionality I talked about in the <a href="http://adndevblog.typepad.com/cloud_and_mobile/2012/07/creating-a-cloud-based-viewer-part-ii.html">second part</a>.</font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font color="#000000"></font><font color="#ffffff">-</font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font color="#000000">- Deploy the service locally in IIS and test it locally.</font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font color="#ffffff">-</font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font color="#000000">- Deploy the service on the cloud in IIS and test it from remote desktops</font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font color="#ffffff">-</font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font color="#000000">The first we are going to need in order to get WCF callback working is to choose a binding that supports duplex communication. It’s pretty obvious when we think about it: in order for the server to callback the client, it needs to have a channel available between them, so basicHttpBinding we used so far isn’t adequate.</font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font color="#000000"></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font color="#000000">There are two predefined bindings that supports duplex, so our choices are pretty restricted: </font><font color="#000000">wsDualHttpBinding and Net.Tcp binding. The <a href="http://www.dotnetconsult.co.uk/weblog2/PermaLink,guid,b891610a-6b78-4b54-b9a6-4ec81c82b7c0.aspx">following</a> post explains very well why Net.Tcp binding is the recommended binding to use, so I won’t expand over it, just read the post:) </font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font color="#ffffff">-</font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font color="#000000">As usual all those binding settings will be configured through the Web.Config file of our service, so pay attention to the following, as a little mistake in that file can cause hours of troubles finding why your dam service doesn’t work when deployed in IIS, talking from experience!</font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font color="#ffffff">-</font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font color="#000000">I highlighted the areas of specific interest. You can see I added a netTcpBinding configuration, as well as two netTcp endpoints: one for the <em>IAdnCloudViewerSrv</em> contract (that’s the previous viewer functionalities) and a new one <em>IAdnCloudViewerNotification</em> dedicated for the callback notifications. Although not required in this example, I conserved the basicHttpBinding endpoint for future use, for example to be used by a mobile client such as an Android application. Because of that you also need to allow mutiple site binding by specifying the <em>multipleSiteBindingEnabled=true</em> flag. </font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font color="#ffffff">-</font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><font style="font-size: 8pt">&lt;?</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">xml</font></span><span style="font-family: ; color: "><font color="#0000ff"> </font></span><span style="font-family: ; color: "><font color="#ff0000">version</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">1.0</font></span><font color="#000000">&quot;</font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">?&gt;</font></span></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><font style="font-size: 8pt">&lt;</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">configuration</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160; </font></span><font style="font-size: 8pt">&lt;</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">system.web</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160; </font></span><font style="font-size: 8pt">&lt;</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">compilation</font></span><span style="font-family: ; color: "><font color="#0000ff"> </font></span><span style="font-family: ; color: "><font color="#ff0000">debug</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff"> </font></span><span style="color: "><font color="#ff0000">targetFramework</font></span><span style="color: "><font color="#0000ff">=</font></span><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">4.0</font></span><font color="#000000">&quot;</font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff"> /&gt;</font></span></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160; </font></span><font style="font-size: 8pt">&lt;/</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">system.web</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160; </font></span><font style="font-size: 8pt">&lt;</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">system.serviceModel</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160; </font></span><font style="font-size: 8pt">&lt;</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">bindings</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">&lt;</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">basicHttpBinding</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">&lt;</font></font></span><span style="font-family: ; color: "><font style="font-size: 8pt" color="#a31515">binding</font></span></font><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><span style="mso-spacerun: yes"><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#ff0000">name</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">AdnCloudServicesBinding</font></span><font color="#000000">&quot;</font></font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><span style="mso-spacerun: yes"><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#ff0000">transferMode</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">Streamed</font></span><font color="#000000">&quot;</font></font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><span style="mso-spacerun: yes"><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#ff0000">messageEncoding</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">Mtom</font></span><font color="#000000">&quot;</font></font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><span style="mso-spacerun: yes"><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#ff0000">maxBufferSize</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">2147483647</font></span><font color="#000000">&quot;</font></font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><span style="mso-spacerun: yes"><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#ff0000">maxBufferPoolSize</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">2147483647</font></span><font color="#000000">&quot;</font></font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><span style="mso-spacerun: yes"><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#ff0000">maxReceivedMessageSize</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">2147483647</font></span><font color="#000000">&quot;</font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">&lt;</font></font></span><span style="font-family: ; color: "><font style="font-size: 8pt" color="#a31515">readerQuotas</font></span></font><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><span style="mso-spacerun: yes"><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#ff0000">maxDepth</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">200</font></span><font color="#000000">&quot;</font></font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><span style="mso-spacerun: yes"><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#ff0000">maxStringContentLength</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">2147483647</font></span><font color="#000000">&quot;</font></font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><span style="mso-spacerun: yes"><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#ff0000">maxArrayLength</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">2147483647</font></span><font color="#000000">&quot;</font></font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><span style="mso-spacerun: yes"><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#ff0000">maxBytesPerRead</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">2147483647</font></span><font color="#000000">&quot;</font></font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><span style="mso-spacerun: yes"><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#ff0000">maxNameTableCharCount</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">2147483647</font></span><font color="#000000">&quot;</font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">/&gt;</font></span></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">&lt;/</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">binding</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">&lt;/</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">basicHttpBinding</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160; <font style="background-color: #ffff00"> </font></font></span><font style="background-color: #ffff00; font-size: 8pt">&lt;</font></font></span><font style="background-color: #ffff00"><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">netTcpBinding</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font></font><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><font style="background-color: #ffff00"><span style="font-family: ; color: "><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">&lt;</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">binding</font></span><span style="font-family: ; color: "><font color="#0000ff"> </font></span><span style="font-family: ; color: "><font color="#ff0000">name</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">TcpBinding</font></span><font color="#000000">&quot;</font></font></span></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><font style="background-color: #ffff00"><span style="font-family: ; color: "><span style="mso-spacerun: yes"><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#ff0000">hostNameComparisonMode</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">StrongWildcard</font></span><font color="#000000">&quot;</font></font></span></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><font style="background-color: #ffff00"><span style="font-family: ; color: "><span style="mso-spacerun: yes"><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#ff0000">sendTimeout</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">00:10:00</font></span><font color="#000000">&quot;</font></font></span></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><font style="background-color: #ffff00"><span style="font-family: ; color: "><span style="mso-spacerun: yes"><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#ff0000">maxReceivedMessageSize</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">65536</font></span><font color="#000000">&quot;</font></font></span></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><font style="background-color: #ffff00"><span style="font-family: ; color: "><span style="mso-spacerun: yes"><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#ff0000">transferMode</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">Buffered</font></span><font color="#000000">&quot;</font></font></span></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><font style="background-color: #ffff00"><span style="font-family: ; color: "><span style="mso-spacerun: yes"><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#ff0000">portSharingEnabled</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">false</font></span><font color="#000000">&quot;</font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></span></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="background-color: #ffff00; font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font style="background-color: #ffff00"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">&lt;</font></font></span><span style="font-family: ; color: "><font style="font-size: 8pt" color="#a31515">readerQuotas</font></span></font><span style="font-family: "></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><font style="background-color: #ffff00"><span style="font-family: ; color: "><span style="mso-spacerun: yes"><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#ff0000">maxDepth</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">200</font></span><font color="#000000">&quot;</font></font></span></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><font style="background-color: #ffff00"><span style="font-family: ; color: "><span style="mso-spacerun: yes"><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#ff0000">maxStringContentLength</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">2147483647</font></span><font color="#000000">&quot;</font></font></span></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><font style="background-color: #ffff00"><span style="font-family: ; color: "><span style="mso-spacerun: yes"><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#ff0000">maxArrayLength</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">2147483647</font></span><font color="#000000">&quot;</font></font></span></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><font style="background-color: #ffff00"><span style="font-family: ; color: "><span style="mso-spacerun: yes"><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#ff0000">maxBytesPerRead</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">2147483647</font></span><font color="#000000">&quot;</font></font></span></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><font style="background-color: #ffff00"><span style="font-family: ; color: "><span style="mso-spacerun: yes"><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#ff0000">maxNameTableCharCount</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">2147483647</font></span><font color="#000000">&quot;</font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">/&gt;</font></span></span></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="background-color: #ffff00; font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><font style="background-color: #ffff00"><span style="font-family: ; color: "><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">&lt;</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">security</font></span><span style="font-family: ; color: "><font color="#0000ff"> </font></span><span style="font-family: ; color: "><font color="#ff0000">mode</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">None</font></span><font color="#000000">&quot;</font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></span></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><font style="background-color: #ffff00"><span style="font-family: ; color: "><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">&lt;</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">transport</font></span><span style="font-family: ; color: "><font color="#0000ff"> </font></span><span style="font-family: ; color: "><font color="#ff0000">clientCredentialType</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">None</font></span><font color="#000000">&quot;</font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">/&gt;</font></span></span></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><font style="background-color: #ffff00"><span style="font-family: ; color: "><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">&lt;</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">message</font></span><span style="font-family: ; color: "><font color="#0000ff"> </font></span><span style="font-family: ; color: "><font color="#ff0000">clientCredentialType</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">None</font></span><font color="#000000">&quot;</font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">/&gt;</font></span></span></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font style="background-color: #ffff00"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">&lt;/</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">security</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font><span style="font-family: "></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; color: "><span style="mso-spacerun: yes"><font face="Consolas"><font style="background-color: #ffff00; font-size: 8pt" color="#0000ff">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font style="background-color: #ffff00"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">&lt;/</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">binding</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font><span style="font-family: "></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font style="background-color: #ffff00"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">&lt;/</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">netTcpBinding</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font><span style="font-family: "></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160; </font></span><font style="font-size: 8pt">&lt;/</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">bindings</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160; </font></span><font style="font-size: 8pt">&lt;</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">behaviors</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">&lt;</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">serviceBehaviors</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">&lt;</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">behavior</font></span><span style="font-family: ; color: "><font color="#0000ff"> </font></span><span style="font-family: ; color: "><font color="#ff0000">name</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">AdnCloudServicesBehavior</font></span><font color="#000000">&quot;</font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">&lt;</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">serviceMetadata</font></span><span style="font-family: ; color: "><font color="#0000ff"> </font></span><span style="font-family: ; color: "><font color="#ff0000">httpGetEnabled</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">&quot;</font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">/&gt;</font></span></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">&lt;</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">serviceDebug</font></span><span style="font-family: ; color: "><font color="#0000ff"> </font></span><span style="font-family: ; color: "><font color="#ff0000">includeExceptionDetailInFaults</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">&quot;</font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">/&gt;</font></span></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">&lt;</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">dataContractSerializer</font></span><span style="font-family: ; color: "><font color="#0000ff"> </font></span><span style="font-family: ; color: "><font color="#ff0000">maxItemsInObjectGraph</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">2147483647</font></span><font color="#000000">&quot;</font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">/&gt;</font></span></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">&lt;/</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">behavior</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">&lt;/</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">serviceBehaviors</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160; </font></span><font style="font-size: 8pt">&lt;/</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">behaviors</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160; </font></span><font style="font-size: 8pt">&lt;</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">services</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">&lt;</font></font></span><span style="font-family: ; color: "><font style="font-size: 8pt" color="#a31515">service</font></span></font><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><span style="mso-spacerun: yes"><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#ff0000">behaviorConfiguration</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">AdnCloudServicesBehavior</font></span><font color="#000000">&quot;</font></font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><span style="mso-spacerun: yes"><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#ff0000">name</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">AdnCloudViewerService.AdnCloudViewerSrv</font></span><font color="#000000">&quot;</font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">&lt;</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">endpoint</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#0000ff"> </font></span></font><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><span style="mso-spacerun: yes"><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#ff0000">address</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">mex</font></span><font color="#000000">&quot;</font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff"> </font></span></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><span style="mso-spacerun: yes"><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#ff0000">binding</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">mexTcpBinding</font></span><font color="#000000">&quot;</font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff"> </font></span></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><span style="mso-spacerun: yes"><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#ff0000">contract</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">IMetadataExchange</font></span><font color="#000000">&quot;</font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">/&gt;</font></span></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">&lt;</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">endpoint</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#0000ff"> </font></span></font><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><span style="mso-spacerun: yes"><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#ff0000">name</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">WCFCHttpEndpoint</font></span><font color="#000000">&quot;</font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff"> </font></span></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><span style="mso-spacerun: yes"><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#ff0000">address</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;&quot;</font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff"> </font></span></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><span style="mso-spacerun: yes"><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#ff0000">binding</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">basicHttpBinding</font></span><font color="#000000">&quot;</font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff"> </font></span></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><span style="mso-spacerun: yes"><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#ff0000">bindingConfiguration</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">AdnCloudServicesBinding</font></span><font color="#000000">&quot;</font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff"> </font></span></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><span style="mso-spacerun: yes"><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#ff0000">contract</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">AdnCloudViewerService.IAdnCloudViewerSrv</font></span><font color="#000000">&quot;</font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">/&gt;</font></span></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="background-color: #ffff00; font-size: 8pt">&lt;</font></font></span><span style="font-family: ; color: "><font style="background-color: #ffff00; font-size: 8pt" color="#a31515">endpoint</font></span></font><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><font style="background-color: #ffff00"><span style="font-family: ; color: "><span style="mso-spacerun: yes"><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#ff0000">name</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">WCFNetTcpEndpoint</font></span><font color="#000000">&quot;</font></font></span></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><font style="background-color: #ffff00"><span style="font-family: ; color: "><span style="mso-spacerun: yes"><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#ff0000">bindingConfiguration</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">TcpBinding</font></span><font color="#000000">&quot;</font></font></span></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><font style="background-color: #ffff00"><span style="font-family: ; color: "><span style="mso-spacerun: yes"><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#ff0000">binding</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">netTcpBinding</font></span><font color="#000000">&quot;</font></font></span></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><font style="background-color: #ffff00"><span style="font-family: ; color: "><span style="mso-spacerun: yes"><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#ff0000">contract</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">AdnCloudViewerService.IAdnCloudViewerSrv</font></span><font color="#000000">&quot;</font></font></span></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><font style="background-color: #ffff00"><span style="font-family: ; color: "><span style="mso-spacerun: yes"><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#ff0000">address</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;&quot;</font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">/&gt;</font></span></span></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="background-color: #ffff00; font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font style="background-color: #ffff00"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">&lt;</font></font></span><span style="font-family: ; color: "><font style="font-size: 8pt" color="#a31515">endpoint</font></span></font><span style="font-family: "></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><font style="background-color: #ffff00"><span style="font-family: ; color: "><span style="mso-spacerun: yes"><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#ff0000">name</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">WCFCallbackEndpoint</font></span><font color="#000000">&quot;</font></font></span></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><font style="background-color: #ffff00"><span style="font-family: ; color: "><span style="mso-spacerun: yes"><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#ff0000">bindingConfiguration</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">TcpBinding</font></span><font color="#000000">&quot;</font></font></span></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><font style="background-color: #ffff00"><span style="font-family: ; color: "><span style="mso-spacerun: yes"><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#ff0000">binding</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">netTcpBinding</font></span><font color="#000000">&quot;</font></font></span></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><font style="background-color: #ffff00"><span style="font-family: ; color: "><span style="mso-spacerun: yes"><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#ff0000">contract</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">AdnCloudViewerService.IAdnCloudViewerNotification</font></span><font color="#000000">&quot;</font></font></span></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><font style="background-color: #ffff00"><span style="font-family: ; color: "><span style="mso-spacerun: yes"><font color="#0000ff"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#ff0000">address</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">Callback</font></span><font color="#000000">&quot;</font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">/&gt;</font></span></span></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">&lt;/</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">service</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160; </font></span><font style="font-size: 8pt">&lt;/</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">services</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160; <font style="background-color: #ffff00"> </font></font></span><font style="background-color: #ffff00; font-size: 8pt">&lt;</font></font></span><font style="background-color: #ffff00"><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">serviceHostingEnvironment</font></span><span style="font-family: ; color: "><font color="#0000ff"> </font></span><span style="font-family: ; color: "><font color="#ff0000">multipleSiteBindingsEnabled</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">true </font></span><font color="#000000">&quot;</font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">/&gt;</font></span></span></font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160; </font></span><font style="font-size: 8pt">&lt;/</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">system.serviceModel</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; color: "><span style="mso-spacerun: yes"><font face="Consolas"><font style="font-size: 8pt" color="#0000ff">&#160; </font></font></span></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;</font></span><font style="font-size: 8pt">&lt;</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">system.webServer</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160; </font></span><font style="font-size: 8pt">&lt;</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">modules</font></span><span style="font-family: ; color: "><font color="#0000ff"> </font></span><span style="font-family: ; color: "><font color="#ff0000">runAllManagedModulesForAllRequests</font></span><span style="font-family: ; color: "><font color="#0000ff">=</font></span></font><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&quot;</font><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">&quot;</font></font><span style="color: "><font style="font-size: 8pt" color="#0000ff">/&gt;</font></span></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160; </font></span><font style="font-size: 8pt">&lt;/</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">system.webServer</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: ; color: "><span style="mso-spacerun: yes"><font face="Consolas"><font style="font-size: 8pt" color="#0000ff">&#160; </font></font></span></span><span style="font-family: "></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><font style="font-size: 8pt">&lt;/</font></font></span><font style="font-size: 8pt"><span style="font-family: ; color: "><font color="#a31515">configuration</font></span></font><span style="font-family: ; color: "><font style="font-size: 8pt" color="#0000ff">&gt;</font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;</font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font color="#000000" face="Calibri"></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font color="#000000"><strong>III – Enabling IIS for net.tcp transport</strong></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font color="#ffffff">-</font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font color="#000000">We are a couple of steps away from being able to deploy in IIS now. The next thing you need to make sure is that you enabled the WCF Non-HTTP Activation. This is done through the Add/remove Windows Feature of the control panel:</font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font color="#ffffff">-</font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b017743f5f697970d-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="wcf1" border="0" alt="wcf1" src="/assets/image_959201.jpg" width="481" height="441" /></a></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font color="#ffffff">-</font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font color="#000000">Fire your IIS console, select the desired web site and then go to “Bindings…” in the right pane menu. Here make sure a <u>single</u> net.tcp binding is defined and that it matches the port defined in your web.config. For me 8000 (the default net.tcp port is 808)</font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font color="#ffffff">-</font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none" class="MsoNormal"><font color="#000000"><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0167691ac180970b-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="wcf2" border="0" alt="wcf2" src="/assets/image_e3503e.jpg" width="476" height="435" /></a></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none" class="MsoNormal"><font color="#ffffff">-</font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none" class="MsoNormal"><font color="#000000">Publish a deployment package for your service and deploy as described in the <a href="http://adndevblog.typepad.com/cloud_and_mobile/2012/07/creating-a-cloud-based-viewer-part-ii.html">second post</a>. Once deployed, make sure you add <strong><em>net.tcp</em></strong> protocol to the list of Enabled Protocols of your service. This is available in the right pane menu, once you selected the relevant service, under <em>Advanced Settings…</em></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font color="#ffffff">-</font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0176170fb134970c-pi"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="wcf3" border="0" alt="wcf3" src="/assets/image_d8fbae.jpg" width="478" height="290" /></a></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font color="#ffffff">-</font></p>      <p><strong>IV – Implementing the client side</strong></p>  <p>If you did everything as described, you should have your service running locally under IIS and should be able to communicate through net.tcp with it. Go to the client project and add a new service reference to it (eventually delete any previous existing reference to the http service). In the new service reference field add in that case “<a title="net.tcp://localhost:8000/AdnCloudViewer/AdnCloudViewerSrv.svc" href="net.tcp://localhost:8000/AdnCloudViewer/AdnCloudViewerSrv.svc">net.tcp://localhost:8000/AdnCloudViewer/AdnCloudViewerSrv.svc</a>” your service should be found by Visual Studio. Remember to add the async wrappers option, as described in the <a href="http://adndevblog.typepad.com/cloud_and_mobile/2012/07/creating-a-cloud-based-viewer-part-i.html">first post</a>.</p>  <p>The client should implement the callback interface and also connect to the subscribe/unsubscribe service. The relevant parts of the implementation are illustrated below:</p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><font style="font-size: 8pt">public</font></font></span><span style="font-family: "><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#0000ff">partial</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">class</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">ViewerClientForm</font></span><font color="#000000"> : </font></font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">Form</font></span><font color="#000000">,</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">IDisposable</font></span><font color="#000000">,</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><span style="color: "><font style="font-size: 8pt" color="#2b91af">IAdnCloudViewerNotificationCallback</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 8pt" color="#000000">{</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">AdnCloudViewerSrvClient</font></span><font color="#000000"> _viewerClient;</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">AdnCloudViewerNotificationClient</font></span><font color="#000000"> _notificationClient;</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">Dictionary</font></span><font color="#000000">&lt;</font><span style="color: "><font color="#0000ff">string</font></span><font color="#000000">, </font><span style="color: "><font color="#2b91af">TreeNode</font></span><font color="#000000">&gt; _modelIdNodeMap;</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;</font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160; </font></span><font style="font-size: 8pt">bool</font></font></span><span style="font-family: "><font style="font-size: 8pt" color="#000000"> ConnectService()</font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160; </font></span><font style="font-size: 8pt">{</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="color: "><font style="font-size: 8pt" color="#0000ff">try</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">{</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="color: "><font style="font-size: 8pt" color="#008000">// We use the NetTcp End Point</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">_viewerClient = </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">AdnCloudViewerSrvClient</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;WCFNetTcpEndpoint&quot;</font></span><font color="#000000">);</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="color: "><font style="font-size: 8pt" color="#008000">//_viewerClient=new AdnCloudViewerSrvClient(&quot;WCFCHttpEndpoint&quot;);</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><span style="mso-spacerun: yes"><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (_viewerClient.Endpoint != </font><span style="color: "><font color="#0000ff">null</font></span><font color="#000000">)</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">{</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="color: "><font style="font-size: 8pt" color="#008000">// Callback client initialization is as follow.</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="color: "><font style="font-size: 8pt" color="#008000">// For sake of simplicity init is synchronous</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="color: "><font style="font-size: 8pt" color="#008000">// but we could very well use an asyn init as well</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">InstanceContext</font></span><font color="#000000"> context = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">InstanceContext</font></span><font color="#000000">(</font><span style="color: "><font color="#0000ff">this</font></span><font color="#000000">);</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">_notificationClient = </font></font><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">AdnCloudViewerNotificationClient</font></span><font color="#000000">(</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">context, </font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#a31515">&quot;WCFCallbackEndpoint&quot;</font></span><font color="#000000">);</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="color: "><font style="font-size: 8pt" color="#008000">// Subscribe to notification service</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">_notificationClient.Subscribe();</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">true</font></span><font color="#000000">;</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">}</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">false</font></span><font color="#000000">;</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">}</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">catch</font></span><font color="#000000"> (</font><span style="color: "><font color="#2b91af">Exception</font></span><font color="#000000"> ex)</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">{</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">System.Windows.Forms.</font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">MessageBox</font></span><font color="#000000">.Show(ex.Message);</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">false</font></span><font color="#000000">;</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">}</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160; </font></span><font style="font-size: 8pt">}</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font style="font-size: 11pt" color="#000000">&#160;</font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: ; color: "><font color="#0000ff"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160; </font></span><font style="font-size: 8pt">void</font></font></span><span style="font-family: "><font style="font-size: 8pt"><font color="#000000"> </font><span style="color: "><font color="#2b91af">IAdnCloudViewerNotificationCallback</font></span><font color="#000000">.OnDbModelAdded(</font></font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><font face="Consolas"><span style="font-family: "><font style="font-size: 8pt"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#2b91af">ModelInfo</font></span><font color="#000000"> modelInfo)</font></font></span></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160; </font></span><font style="font-size: 8pt">{</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><span style="color: "><font style="font-size: 8pt" color="#0000ff">try</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">{</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">ModelInfo</font></span><font color="#000000">[] infos = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">ModelInfo</font></span><font color="#000000">[]</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">{</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">modelInfo</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">};</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">this</font></span><font color="#000000">.Invoke(</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#2b91af">RefreshCloudModelsDelegate</font></span><font color="#000000">(EndRefreshCloudModels),</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">object</font></span><font color="#000000">[] { infos });</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">}</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">catch</font></span><font color="#000000"> (</font><span style="color: "><font color="#2b91af">Exception</font></span><font color="#000000"> ex)</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">{</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">System.Windows.Forms.</font></font><font style="font-size: 8pt"><span style="color: "><font color="#2b91af">MessageBox</font></span><font color="#000000">.Show(ex.Message);</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">}</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160; </font></span><font style="font-size: 8pt">}</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><span style="color: "><font style="font-size: 8pt" color="#008000">///////////////////////////////////////////////////////////////////////</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><span style="color: "><font style="font-size: 8pt" color="#008000">// OnDbModelRemoved server callback implementation</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><span style="color: "><font style="font-size: 8pt" color="#008000">//</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><span style="color: "><font style="font-size: 8pt" color="#008000">///////////////////////////////////////////////////////////////////////</font></span></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">public</font></span><font color="#000000"> </font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000"> OnDbModelRemoved(</font><span style="color: "><font color="#0000ff">string</font></span><font color="#000000"> modelId)</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160; </font></span><font style="font-size: 8pt">{</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><span style="mso-spacerun: yes"><font color="#000000"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font></span><font style="font-size: 8pt"><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (_modelIdNodeMap.ContainsKey(modelId))</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">{</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">_modelIdNodeMap[modelId].Remove();</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font style="font-size: 8pt" color="#000000">&#160;</font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt"><span style="mso-spacerun: yes">&#160;&#160;&#160;&#160; </span>_modelIdNodeMap.Remove(modelId);</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><font style="font-size: 8pt">}</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt; text-autospace: ; mso-layout-grid-align: none" class="MsoNormal"><span style="font-family: "><font face="Consolas"><font color="#000000"><span style="mso-spacerun: yes"><font style="font-size: 8pt">&#160;&#160;&#160; </font></span><font style="font-size: 8pt">}</font></font></font></span></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font face="Calibri"><font style="font-size: 11pt" color="#000000">}</font></font></p>  <p style="line-height: normal; margin: 0in 0in 0pt" class="MsoNormal"><font color="#000000" face="Calibri"></font></p>  <p>I also implemented very much the same thing on the console side, so there could be multiple consoles and clients apps running each on different machine over the web. </p>  <p>When done you can deploy the service on AWS cloud the very same way we did in the <a href="http://adndevblog.typepad.com/cloud_and_mobile/2012/07/creating-a-cloud-based-viewer-part-iii.html">previous post</a>. You would need to make sure net.tcp is enabled on the cloud machine as we did here locally.</p>  <p>That’s finally time to test our callbacks: upload a model through the console, you should see it appearing on each clients connected to the internet on any remote desktop machine… ta daaa! </p>  <p><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0176170fbb11970c-pi"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="wcf4" border="0" alt="wcf4" src="/assets/image_6f8604.jpg" width="390" height="375" /></a></p>  <p>   <div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:fb3a1972-4489-4e52-abe7-25a00bb07fdf:9bbf18d7-33fd-4770-aa0a-66aad0df87f9" class="wlWriterEditableSmartContent"><p> <a href="http://adndevblog.typepad.com/adncloudviewertutorial---part-iv-4.zip" target="_blank">AdnCloudViewerTutorial - Part IV.zip</a></p></div></p>
