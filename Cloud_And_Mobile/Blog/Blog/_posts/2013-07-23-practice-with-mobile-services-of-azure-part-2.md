---
layout: "post"
title: "Practice with Mobile Services of Azure &ndash; part 2"
date: "2013-07-23 08:16:00"
author: "Xiaodong Liang"
categories:
  - "ASP .NET"
  - "HTML"
  - "Javascript"
  - "Xiaodong Liang"
original_url: "https://adndevblog.typepad.com/cloud_and_mobile/2013/07/practice-with-mobile-services-of-azure-part-2.html "
typepad_basename: "practice-with-mobile-services-of-azure-part-2"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/aec/xiaodong-liang.html" target="_self">Xiaodong Liang</a>&#0160;</p>
<p>In the last post, we draw some geometries on Android and upload to Mobile Service of Azure. As mentioned, Mobile Service of Azure allows you to access the service by HTML/JavaScript. So we could take advantage JavaScript AutoCAD 2014 provides. We will render the geometries in AutoCAD using the new technology.</p>
<p>Here is the sample project.
<span class="asset  asset-generic at-xid-6a0167607c2431970b01901e6ed0c2970b"><a href="http://adndevblog.typepad.com/files/azuremsautocad.zip">Download AzureMSAutoCAD</a>.</span> The key points are: <br />   <br />1. Create an ASP.NET project. In this demo, it is named AzureMSAutoCAD. Load the necessary Js libs or Js code in Default.aspx.    </p>
<p><span style="font-family: Consolas;"><span style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: yellow;"><span style="background-color: #ffff00; color: #000000;"><span style="font-size: 8pt;">&lt;%</span></span></span><span style="font-size: 8pt;"><span><span style="color: #0000ff;">@</span></span></span><span><span style="font-size: 8pt;"><span style="color: #000000;"> </span><span><span style="color: #800000;">Page</span></span><span style="color: #000000;"> </span><span><span style="color: #ff0000;">Title</span></span><span><span style="color: #0000ff;">=&quot;Home Page&quot;</span></span><span style="color: #000000;"> </span><span><span style="color: #ff0000;">Language</span></span><span><span style="color: #0000ff;">=&quot;C#&quot;</span></span><span style="color: #000000;"> </span><span><span style="color: #ff0000;">MasterPageFile</span></span><span><span style="color: #0000ff;">=&quot;~/Site.master&quot;</span></span><span style="color: #000000;"> </span><span><span style="color: #ff0000;">AutoEventWireup</span></span></span><span><span style="font-size: 8pt; color: #0000ff;">=&quot;true&quot;</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span><span style="color: #ff0000;">CodeBehind</span></span><span><span style="color: #0000ff;">=&quot;Default.aspx.cs&quot;</span></span><span style="color: #000000;"> </span><span><span style="color: #ff0000;">Inherits</span></span><span><span style="color: #0000ff;">=&quot;AzureMSAutoCAD._Default&quot;</span></span><span style="color: #000000;"> </span></span><span style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: yellow;"><span style="background-color: #ffff00; font-size: 8pt; color: #000000;">%&gt;</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;"><span style="font-size: 8pt;">&lt;</span></span></span><span style="font-size: 8pt;"><span><span style="color: #800000;">asp</span></span><span><span style="color: #0000ff;">:</span></span><span><span style="color: #800000;">Content</span></span></span><span><span style="font-size: 8pt;"><span style="color: #000000;"> </span><span><span style="color: #ff0000;">ID</span></span><span><span style="color: #0000ff;">=&quot;BodyContent&quot;</span></span><span style="color: #000000;"> </span><span><span style="color: #ff0000;">runat</span></span><span><span style="color: #0000ff;">=&quot;server&quot;</span></span><span style="color: #000000;"> </span><span><span style="color: #ff0000;">ContentPlaceHolderID</span></span><span><span style="color: #0000ff;">=&quot;MainContent&quot;&gt;</span></span></span><span style="mso-spacerun: yes;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160; </span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt;"><span style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: yellow;"><span style="background-color: #ffff00;">&lt;%</span></span></span></span><span style="font-size: 8pt;"><span><span style="color: #006400;">--load Javascriot lib of AutoCAD--</span></span></span><span style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: yellow;"><span style="background-color: #ffff00; font-size: 8pt; color: #000000;">%&gt;</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span><span style="color: #0000ff;">&lt;</span></span><span><span style="color: #800000;">script</span></span><span style="color: #000000;"> </span><span><span style="color: #ff0000;">type</span></span><span><span style="color: #0000ff;">=&quot;text/javascript&quot;</span></span><span style="color: #000000;"> </span><span><span style="color: #ff0000;">src</span></span><span><span style="color: #0000ff;">=&quot;http://www.autocadws.com/jsapi/v1/Autodesk.AutoCAD.js&quot;&gt;&lt;/</span></span><span><span style="color: #800000;">script</span></span><span><span style="color: #0000ff;">&gt;</span></span></span><span style="mso-spacerun: yes;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160; </span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt;"><span style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: yellow;"><span style="background-color: #ffff00;">&lt;%</span></span></span></span><span style="font-size: 8pt;"><span><span style="color: #006400;">--load jquery lib--</span></span></span><span style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: yellow;"><span style="background-color: #ffff00; font-size: 8pt; color: #000000;">%&gt;</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span><span style="color: #0000ff;">&lt;</span></span><span><span style="color: #800000;">script</span></span><span style="color: #000000;"> </span><span><span style="color: #ff0000;">src</span></span><span><span style="color: #0000ff;">=&#39;https://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.9.1.min.js&#39;&gt;&lt;/</span></span><span><span style="color: #800000;">script</span></span></span><span><span style="font-size: 8pt; color: #0000ff;">&gt;</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt;"><span style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: yellow;"><span style="background-color: #ffff00;">&lt;%</span></span></span></span><span style="font-size: 8pt;"><span><span style="color: #006400;">--load the js produced by Azure for your mobile service--</span></span></span><span style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: yellow;"><span style="background-color: #ffff00; font-size: 8pt; color: #000000;">%&gt;</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span><span style="color: #0000ff;">&lt;</span></span><span><span style="color: #800000;">script</span></span><span style="color: #000000;"> </span><span><span style="color: #ff0000;">src</span></span><span><span style="color: #0000ff;">=&#39;https://lxdcell.azure-mobile.net/client/MobileServices.Web-1.0.0.min.js&#39;&gt;&lt;/</span></span><span><span style="color: #800000;">script</span></span><span><span style="color: #0000ff;">&gt;</span></span></span><span style="mso-spacerun: yes;"><span style="font-size: 8pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span><span style="font-size: 8pt;"><span style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: yellow;"><span style="background-color: #ffff00;">&lt;%</span></span></span></span><span style="font-size: 8pt;"><span><span style="color: #006400;">--the js for this demo, which gets all records of mobile service and provides the ability the draw the geometries--</span></span></span><span style="background-image: none; background-attachment: scroll; background-repeat: repeat; background-position: 0% 0%; mso-highlight: yellow;"><span style="background-color: #ffff00; font-size: 8pt; color: #000000;">%&gt;</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span><span style="color: #0000ff;">&lt;</span></span><span><span style="color: #800000;">script</span></span><span style="color: #000000;"> </span><span><span style="color: #ff0000;">type</span></span><span><span style="color: #0000ff;">=&quot;text/javascript&quot;</span></span><span style="color: #000000;"> </span><span><span style="color: #ff0000;">src</span></span><span><span style="color: #0000ff;">=&quot;Scripts\AzureAutoCAD.js&quot;&gt;&lt;/</span></span><span><span style="color: #800000;">script</span></span><span><span style="color: #0000ff;">&gt;</span></span><span style="color: #000000;"> </span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span><span style="color: #0000ff;">&lt;</span></span><span><span style="color: #800000;">ul</span></span><span style="color: #000000;"> </span><span><span style="color: #ff0000;">id</span></span><span><span style="color: #0000ff;">=&#39;todo-items&#39;&gt;</span></span><span style="color: #000000;"> </span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 8pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 8pt;"><span><span style="color: #0000ff;">&lt;/</span></span><span><span style="color: #800000;">ul</span></span><span><span style="color: #0000ff;">&gt;</span></span></span><span style="mso-spacerun: yes;"><span style="font-size: 8pt; color: #000000;">&#0160; </span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span><span style="color: #0000ff;"><span style="font-size: 8pt;">&lt;/</span></span></span><span style="font-size: 8pt;"><span><span style="color: #800000;">asp</span></span><span><span style="color: #0000ff;">:</span></span><span><span style="color: #800000;">Content</span></span></span><span><span style="font-size: 8pt; color: #0000ff;">&gt;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="font-size: 8pt; color: #0000ff;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; mso-layout-grid-align: none;">2. Similar to Android, you could download the Js demo from Azure. It shows how to access the service, including the access url and key.</p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; mso-layout-grid-align: none;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="mso-spacerun: yes;"><span style="color: #000000; font-family: &#39;Times New Roman&#39;;">&#0160;&#0160;&#0160; </span></span></span><span style="mso-no-proof: yes;"><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01910464bcd5970c-pi"><img alt="clip_image001[4]" border="0" height="164" src="/assets/image_66250c.jpg" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border-width: 0px;" title="clip_image001[4]" width="433" /></a></span><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;">&#0160;</span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; mso-layout-grid-align: none;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="color: #000000; font-family: &#39;Times New Roman&#39;;">&#0160;</span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; mso-layout-grid-align: none;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="mso-spacerun: yes;"><span style="color: #000000; font-family: &#39;Times New Roman&#39;;">&#0160; </span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; mso-layout-grid-align: none;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="color: #000000; font-family: &#39;Times New Roman&#39;;">&#0160;</span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; mso-layout-grid-align: none;">3. In AzureAutoCAD.js of our demo, I will connect to my mobile service. The code reads each geometry data of the mobile table and produces the rows of a list in the web page.</p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; mso-layout-grid-align: none;">&#0160;</p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 9pt;">$(</span></span><span style="font-size: 9pt;"><span><span style="color: #0000ff;">function</span></span><span style="color: #000000;"> () {</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #0000ff;">var</span></span><span style="color: #000000;"> client = </span><span><span style="color: #0000ff;">new</span></span><span style="color: #000000;"> WindowsAzure.MobileServiceClient(</span><span><span style="color: #800000;">&#39;Access URL&#39;</span></span><span style="color: #000000;">, </span><span><span style="color: #800000;">&#39;Key&#39;</span></span><span style="color: #000000;">);</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #0000ff;">var</span></span><span style="color: #000000;"> mytable = client.getTable(</span><span><span style="color: #800000;">&#39;AzureTableItem&#39;</span></span><span style="color: #000000;">);</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span></span><span><span style="font-size: 9pt; color: #006400;">// Read current data and rebuild UI.</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span></span><span><span style="font-size: 9pt; color: #006400;">// If you plan to generate complex UIs like this, consider using a JavaScript templating library.</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #0000ff;">function</span></span><span style="color: #000000;"> refreshTodoItems() {</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="font-size: 9.5pt; color: #006400;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: #006400;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">// read two columns of the table and produce the rows of the list</span></span></span></span><span style="mso-bidi-font-size: 9.5pt;">&#0160;</span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #0000ff;">var</span></span><span style="color: #000000;"> query = mytable.select(</span><span><span style="color: #800000;">&quot;id&quot;</span></span><span style="color: #000000;">, </span><span><span style="color: #800000;">&quot;graphicsdata&quot;</span></span><span style="color: #000000;">).read().done(</span><span><span style="color: #0000ff;">function</span></span><span style="color: #000000;"> (results) {</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #0000ff;">var</span></span><span style="color: #000000;"> listItems = $.map(results, </span><span><span style="color: #0000ff;">function</span></span><span style="color: #000000;"> (item) {</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #0000ff;">return</span></span><span style="color: #000000;"> $(</span><span><span style="color: #800000;">&#39;&lt;li&gt;&#39;</span></span><span style="color: #000000;">)</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; .attr(</span></span><span style="font-size: 9pt;"><span><span style="color: #800000;">&#39;data-todoitem-data&#39;</span></span><span style="color: #000000;">, item.graphicsdata)</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; .append($(</span></span><span style="font-size: 9pt;"><span><span style="color: #800000;">&#39;&lt;button class=&quot;item-display&quot;&gt;display graphics&lt;/button&gt;&#39;</span></span><span style="color: #000000;">))</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; .append($(</span></span><span style="font-size: 9pt;"><span><span style="color: #800000;">&#39;&lt;input class=&quot;item-data&quot; readonly = &quot;true&quot;&gt;&#39;</span></span><span style="color: #000000;">).val(item.id + </span></span><span><span style="font-size: 9pt; color: #800000;">&quot;:&quot;</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">+ item.graphicsdata));</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">});</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">$(</span></span><span style="font-size: 9pt;"><span><span style="color: #800000;">&#39;#todo-items&#39;</span></span><span style="color: #000000;">).empty().append(listItems).toggle(listItems.length &gt; 0);</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">}, handleError);</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; text-indent: 21pt; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">}</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; text-indent: 21pt; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #006400;">// …. Other codes</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; text-indent: 21pt; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #006400;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;">&#0160;</p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;">&#0160;</span></span></span></p>
<p>4. Before deploying to Azure, we need to test on local. Firstly, we need to add localhost as the [<strong>Allow Requests From Host Names</strong>] in the mobile service configuration.    </p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-no-proof: yes;"><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01910464bce2970c-pi"><img alt="clip_image002[4]" border="0" height="249" src="/assets/image_901561.jpg" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="clip_image002[4]" width="446" /></a></span><span style="mso-bidi-font-size: 9.5pt;">&#0160;</span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;">This is how it works locally. Beside each row, there is a button, it will draw the geometry in AutoCAD with the corresponding data.</p>
<p class="MsoNormal" style="line-height: normal; text-indent: 21pt; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #006400;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; text-indent: 21pt; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-no-proof: yes;"><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01910464bcf7970c-pi"><img alt="clip_image003[4]" border="0" height="224" src="/assets/image_7ac9d0.jpg" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="clip_image003[4]" width="354" /></a></span><span style="mso-bidi-font-size: 9.5pt;">&#0160;</span></p>
<p class="MsoNormal" style="line-height: normal; text-indent: 21pt; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #006400;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; text-indent: 21pt; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #006400;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;">5. When the ASP.net project is ready, we could host it to a website. In this demo, I deploy it to Azure (before this, please <a href="http://www.windowsazure.com/en-us/manage/services/web-sites/how-to-create-websites/">create a website in Azure</a>). Again, remember to add the website as a host names in mobile service. </p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-no-proof: yes;"><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b0192ac2e110e970d-pi"><img alt="clip_image004[4]" border="0" height="118" src="/assets/image_0fe880.jpg" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="clip_image004[4]" width="402" /></a></span><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;">&#0160;</span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="font-size: 9.5pt; color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; mso-layout-grid-align: none;">&#0160;</p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; mso-layout-grid-align: none;">6. Now, we will implement the Js code that draws geometry in AutoCAD. I’d recommend you have a look at the <a href="http://adndevblog.typepad.com/autocad/2013/04/getting-started-with-javascript-api-on-autocad-2014.html">tutorial on AutoCAD Js basic</a> my colleague Philippe has delivered. Since the 2014 Js has not much abilities such as creating database entities, we could use extension Js which calls a .NET function. In the <a href="http://adndevblog.typepad.com/autocad/2013/04/getting-started-with-javascript-api-on-autocad-2014.html">tutorial AutoCAD Js basic</a>, Philippe has introduced on extension Js. Here are two more nice blogs which are more helpful to understand the mechanism how to call .NET modules. </p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; mso-layout-grid-align: none;">&#0160;</p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; mso-layout-grid-align: none;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><a href="http://through-the-interface.typepad.com/through_the_interface/2013/05/complementing-autocads-javascript-api-using-net.html"><span style="color: #0000ff; font-family: &#39;Times New Roman&#39;;">http://through-the-interface.typepad.com/through_the_interface/2013/05/complementing-autocads-javascript-api-using-net.html</span></a></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; mso-layout-grid-align: none;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><a href="http://through-the-interface.typepad.com/through_the_interface/2013/05/returning-data-from-net-to-javascript-inside-autocad.html"><span style="color: #0000ff; font-family: &#39;Times New Roman&#39;;">http://through-the-interface.typepad.com/through_the_interface/2013/05/returning-data-from-net-to-javascript-inside-autocad.html</span></a><span style="font-family: &#39;Times New Roman&#39;;"><span style="color: #000000;"> </span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; mso-layout-grid-align: none;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;">&#0160;</span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; mso-layout-grid-align: none;"><span style="mso-fareast-font-family: &#39;Times New Roman&#39;;"><span style="color: #000000; font-family: &#39;Times New Roman&#39;;">7. </span></span>So, in AzureAutoCAD.js of our demo, it gets the geometry data of the corresponding row, produces a json string, and calls the function of .NET. To make the display more clear, it deletes the older geometry and zoom all after the new geometry is drawn. </p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; layout-grid-mode: char; mso-layout-grid-align: none;">&#0160;</p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="font-family: Consolas;"><span style="mso-bidi-font-size: 9.5pt;"><span style="mso-spacerun: yes;"><span style="font-size: 8pt; color: #000000;">&#0160; </span></span></span><span style="mso-bidi-font-size: 9.5pt;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span></span><span><span style="font-size: 9pt; color: #006400;">// Handle display</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">$(document.body).on(</span></span><span style="font-size: 9pt;"><span><span style="color: #800000;">&#39;click&#39;</span></span><span style="color: #000000;">, </span><span><span style="color: #800000;">&#39;.item-display&#39;</span></span><span style="color: #000000;">, </span><span><span style="color: #0000ff;">function</span></span><span style="color: #000000;"> () {</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="font-size: 9pt; color: #006400;">//delete he previous entities, just for this demo</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">Acad.Editor.executeCommand(</span></span><span style="font-size: 9pt;"><span><span style="color: #800000;">&quot;delete all &quot;</span></span><span style="color: #000000;">);</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="font-size: 9pt; color: #006400;">//the corresponding geometry data of this row</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #0000ff;">var</span></span><span style="color: #000000;"> thisata = getTodoItemId(</span><span><span style="color: #0000ff;">this</span></span><span style="color: #000000;">);</span></span><span style="mso-spacerun: yes;"><span style="font-size: 9pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="font-size: 9pt; color: #006400;">//execute the .NET<span style="mso-spacerun: yes;">&#0160; </span>function, passing the geometry data in.</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">execAsync(JSON.stringify({</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">functionName: </span></span><span style="font-size: 9pt;"><span><span style="color: #800000;">&#39;JsCallDotNet&#39;</span></span><span style="color: #000000;">,</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">invokeAsCommand: </span></span><span style="font-size: 9pt;"><span><span style="color: #0000ff;">false</span></span><span style="color: #000000;">,</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">functionParams: { args: thisata }</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">}),</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">OnArxSuccess,</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">OnArxError);</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="font-size: 9pt; color: #006400;">//zoom all</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">Acad.Editor.executeCommand(</span></span><span style="font-size: 9pt;"><span><span style="color: #800000;">&quot;zoom e&quot;</span></span><span style="color: #000000;">);</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span style="mso-bidi-font-size: 9.5pt;"><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">});</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="color: #000000; font-family: Calibri;">&#0160;</span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;">8. Next, we prepare a .NET project of AutoCAD, in which one command <strong>AdnJsDemo</strong>&#0160; loads the webpage, the other <strong>JsCallDotNet</strong> is a JavaScript Callback function. </p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="font-size: 9.5pt; color: #a31515;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160; </span></span><span style="font-size: 9pt;">[</span></span><span style="font-size: 9pt;"><span><span style="color: #2b91af;">JavaScriptCallback</span></span><span style="color: #000000;">(</span><span><span style="color: #a31515;">&quot;JsCallDotNet&quot;</span></span><span style="color: #000000;">)]</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #0000ff;">public</span></span><span style="color: #000000;"> </span><span><span style="color: #0000ff;">string</span></span><span style="color: #000000;"> TestDotNetRead(</span><span><span style="color: #0000ff;">string</span></span><span style="color: #000000;"> jsonArgs)</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">{</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #2b91af;">Document</span></span><span style="color: #000000;"> doc =&#0160; </span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="font-size: 9pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; Autodesk.AutoCAD.ApplicationServices.</span><span><span style="color: #2b91af;">Application</span></span><span style="color: #000000;">.           <br /></span></span></span></span><span><span style="font-family: Consolas;"><span style="font-size: 9pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; DocumentManager.MdiActiveDocument;</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #2b91af;">Database</span></span><span style="color: #000000;"> db = doc.Database;</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #2b91af;">Editor</span></span><span style="color: #000000;"> ed = doc.Editor;</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="font-size: 9pt; color: #008000;">//lock the document</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #0000ff;">using</span></span><span style="color: #000000;"> (doc.LockDocument())</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">{</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="font-size: 9pt; color: #0000ff;">try</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">{</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="font-size: 9pt; color: #008000;">//parse the geometry data</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #0000ff;">var</span></span><span style="color: #000000;"> obj_jsonArgs =            <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #2b91af;">JObject</span></span><span style="color: #000000;">.Parse(jsonArgs);</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #0000ff;">var</span></span><span style="color: #000000;"> obj_args =            <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; (</span><span><span style="color: #0000ff;">string</span></span><span style="color: #000000;">)obj_jsonArgs[</span><span><span style="color: #a31515;">&quot;functionParams&quot;</span></span><span style="color: #000000;">][</span><span><span style="color: #a31515;">&quot;args&quot;</span></span><span style="color: #000000;">];</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="font-size: 9pt; color: #008000;">//get the geometry data array</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #2b91af;">JavaScriptSerializer</span></span><span style="color: #000000;"> js =            <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #0000ff;">new</span></span><span style="color: #000000;"> </span><span><span style="color: #2b91af;">JavaScriptSerializer</span></span><span style="color: #000000;">();</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #2b91af;">JsonPt</span></span><span style="color: #000000;">[] ptArray =            <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; js.Deserialize&lt;</span><span><span style="color: #2b91af;">JsonPt</span></span><span style="color: #000000;">[]&gt;(obj_args);</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span><span style="font-size: 9pt; color: #008000;">//draw the lines one by one</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #0000ff;">using</span></span><span style="color: #000000;"> (</span><span><span style="color: #2b91af;">Transaction</span></span><span style="color: #000000;"> tx = </span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="font-size: 9pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; doc.TransactionManager.StartTransaction())</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">{</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #2b91af;">BlockTableRecord</span></span><span style="color: #000000;"> btr =           <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; tx.GetObject(db.CurrentSpaceId, </span><span><span style="color: #2b91af;">OpenMode</span></span><span style="color: #000000;">.ForWrite)</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #0000ff;">as</span></span><span style="color: #000000;"> </span><span><span style="color: #2b91af;">BlockTableRecord</span></span><span style="color: #000000;">;</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #0000ff;">for</span></span><span style="color: #000000;"> (</span><span><span style="color: #0000ff;">int</span></span><span style="color: #000000;"> i = 0; i &lt; ptArray.Length - 1; i++)</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">{</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #2b91af;">JsonPt</span></span><span style="color: #000000;"> stPt = ptArray[i];</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #2b91af;">JsonPt</span></span><span style="color: #000000;"> endPt = ptArray[i + 1];</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #2b91af;">Point3d</span></span><span style="color: #000000;"> oDBStPt =            <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #0000ff;">new</span></span><span style="color: #000000;"> </span><span><span style="color: #2b91af;">Point3d</span></span><span style="color: #000000;">(stPt.X, stPt.Y, 0);</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #2b91af;">Point3d</span></span><span style="color: #000000;"> oDBEndPt = </span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="font-size: 9pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #0000ff;">new</span></span><span style="color: #000000;"> </span><span><span style="color: #2b91af;">Point3d</span></span><span style="color: #000000;">(endPt.X, endPt.Y, 0);</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;"><span><span style="color: #2b91af;">Line</span></span><span style="color: #000000;"> oNewLine =&#0160; <br /></span></span></span></span><span><span style="font-family: Consolas;"><span style="font-size: 9pt;"><span style="color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span><span><span style="color: #0000ff;">new</span></span><span style="color: #000000;"> </span><span><span style="color: #2b91af;">Line</span></span><span style="color: #000000;">(oDBStPt, oDBEndPt);</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">oNewLine.Color =&#0160;&#0160; <br />&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;"><span><span style="color: #2b91af;">Color</span></span><span style="color: #000000;">.FromRgb(255, 0, 0);</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">oNewLine.LineWeight = </span></span><span style="font-size: 9pt;"><span><span style="color: #2b91af;">&#0160;</span></span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="font-size: 9pt;"><span><span style="color: #2b91af;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; LineWeight</span></span><span style="color: #000000;">.LineWeight018;</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">btr.AppendEntity(oNewLine);</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; tx.AddNewlyCreatedDBObject(oNewLine, </span></span><span style="font-size: 9pt;"><span><span style="color: #0000ff;">true</span></span><span style="color: #000000;">);</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">}</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">tx.Commit();</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">}</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">}</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #0000ff;">catch</span></span><span style="color: #000000;"> (System.</span><span><span style="color: #2b91af;">Exception</span></span><span style="color: #000000;"> ex)</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">{</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #2b91af;">MessageBox</span></span><span style="color: #000000;">.Show(ex.ToString());</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">}</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">}</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="mso-spacerun: yes;"><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="font-size: 9pt; color: #000000;">&#0160;</span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="mso-spacerun: yes;"><span style="color: #000000;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span></span><span style="font-size: 9pt;"><span><span style="color: #0000ff;">return</span></span><span style="color: #000000;"> </span><span><span style="color: #a31515;">&quot;{\&quot;retCode\&quot;:0, \&quot;result\&quot;:\&quot;OK\&quot;}&quot;</span></span><span style="color: #000000;">;</span></span></span></span></p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt; mso-layout-grid-align: none;"><span><span style="font-family: Consolas;"><span style="color: #000000;"><span style="mso-spacerun: yes;"><span style="font-size: 9pt;">&#0160;&#0160;&#0160;&#0160;&#0160;&#0160;&#0160; </span></span><span style="font-size: 9pt;">}</span></span></span></span></p>
<p style="line-height: normal; margin-left: 0.5in; margin-right: 0in;"><span><span style="color: #000000; font-family: &#39;Times New Roman&#39;;">&#0160;</span></span></p>
<p style="line-height: normal; margin-left: 0.5in; margin-right: 0in;">All are completed! Now, netload the .NET project in AutoCAD 2014, run the command AdnJsDemo, it will load our webpage in a panel. After the rows are generated, click the button, the corresponding geometries will drawn in AutoCAD.</p>
<p style="line-height: normal; margin-left: 0.5in; margin-right: 0in;"><span style="mso-no-proof: yes;"><a href="http://adndevblog.typepad.com/.a/6a0167607c2431970b01901e6ec4ff970b-pi"><img alt="clip_image005[4]" border="0" height="279" src="/assets/image_db9795.jpg" style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="clip_image005[4]" width="424" /></a></span><span>&#0160;</span></p>
<p style="line-height: normal; margin-left: 0.5in; margin-right: 0in;">&#0160;</p>
<p style="line-height: normal; margin-left: 0.5in; margin-right: 0in;">Enjoy it!&#0160; <img alt="微笑" class="wlEmoticon wlEmoticon-smile" src="/assets/image_f4e1e1.jpg" style="border-style: none;" /></p>
<p style="line-height: normal; margin-left: 0.5in; margin-right: 0in;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 12pt; color: #000000;">&#0160;</span></span></p>
<p style="line-height: normal; margin-left: 0.5in; margin-right: 0in;"><span style="font-family: &#39;Times New Roman&#39;;"><span style="font-size: 12pt; color: #000000;">&#0160;</span></span></p>
<p style="line-height: normal; margin-left: 0.5in; margin-right: 0in;">&#0160;</p>
<p class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt;"><span style="font-family: Calibri;"><span style="font-size: 11pt; color: #000000;">&#0160;</span></span></p>
