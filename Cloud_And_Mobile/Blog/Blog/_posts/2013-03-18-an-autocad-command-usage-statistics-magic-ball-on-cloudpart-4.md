---
layout: "post"
title: "An AutoCAD Command Usage Statistics &ldquo;Magic Ball&rdquo; on Cloud&ndash;Part 4"
date: "2013-03-18 23:28:08"
author: "Daniel Du"
categories:
  - "Cloud"
  - "Daniel Du"
  - "WebGL"
original_url: "https://adndevblog.typepad.com/cloud_and_mobile/2013/03/an-autocad-command-usage-statistics-magic-ball-on-cloudpart-4.html "
typepad_basename: "an-autocad-command-usage-statistics-magic-ball-on-cloudpart-4"
typepad_status: "Publish"
---

<p>By <a href="http://adndevblog.typepad.com/cloud_and_mobile/daniel-du.html">Daniel Du</a></p>  <p>This is the last part of this topic. In this post, I will introduce how I created the AutoCAD plugin to monitor the AutoCAD command usage and upload it to cloud. </p>  <p>firstly, I created an AutoCAD plugin project with the help of <a href="http://images.autodesk.com/adsk/files/autocad_2013_dotnet_wizards.zip">AutoCAD.net plugin wizard</a>. AutoCAD related references are added automatically by the wizard. </p>  <p>To use my custom data model, I need to add referenced to my data model project, which is created in part 1. It is simple to monitor the AutoCAD command with Document Events in AutoCAD API, for example CommandEnded wraps the AcEditorReactor.commandEnded() ObjectARX function, it indicates that a command has complete. So firstly register the Document.CommandEnded event: </p>  <pre style="line-height: normal; font-family: ; background: white; color: "><font face="新宋体"><span style="color: "><font color="#0000ff"><font style="font-size: 7.8pt">  private</font></font></span><font style="font-size: 7.8pt"><font color="#000000">&#160;</font><span style="color: "><font color="#2b91af">Dictionary</font></span><font color="#000000">&lt;</font><span style="color: "><font color="#0000ff">string</font></span><font color="#000000">, </font><span style="color: "><font color="#0000ff">int</font></span><font color="#000000">&gt; _commandHitDic = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000">&#160;</font><span style="color: "><font color="#2b91af">Dictionary</font></span><font color="#000000">&lt;</font><span style="color: "><font color="#0000ff">string</font></span><font color="#000000">, </font><span style="color: "><font color="#0000ff">int</font></span><font color="#000000">&gt;();</font></font></font><br /></pre>

<pre style="line-height: normal; text-indent: 0pt; font-family: ; background: white; color: ; word-break: normal"><font face="新宋体"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />        [</font><span style="line-height: normal; color: "><font color="#2b91af">CommandMethod</font></span><font color="#000000">(</font><span style="line-height: normal; color: "><font color="#a31515">&quot;ACV_MonitorCommandEvents&quot;</font></span></font><font face="新宋体"><font color="#000000">)]<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="line-height: normal; color: "><font color="#0000ff">public</font></span><font color="#000000">&#160;</font><span style="line-height: normal; color: "><font color="#0000ff">void</font></span></font><font face="新宋体"><font color="#000000"> MonitorCommandEvents_Method()<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; SubscribeToDoc(</font><span style="line-height: normal; color: "><font color="#2b91af">Application</font></span></font><font face="新宋体"><font color="#000000">.DocumentManager.MdiActiveDocument);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; GetEditor().WriteMessage(</font><span style="line-height: normal; color: "><font color="#a31515">&quot;Magic ball is listening, keep working... &quot;</font></span></font><font face="新宋体"><font color="#000000">);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="line-height: normal; color: "><font color="#0000ff">public</font></span><font color="#000000">&#160;</font><span style="line-height: normal; color: "><font color="#0000ff">void</font></span><font color="#000000"> SubscribeToDoc(</font><span style="line-height: normal; color: "><font color="#2b91af">Document</font></span></font><font face="新宋体"><font color="#000000"> doc)<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font face="新宋体"><font color="#000000">doc.CommandEnded += </font><span style="line-height: normal; color: "><font color="#0000ff">new</font></span><font color="#000000">&#160;</font><span style="line-height: normal; color: "><font color="#2b91af">CommandEventHandler</font></span></font><font face="新宋体"><font color="#000000">(doc_CommandEnded);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font face="新宋体"><font color="#000000">}<br /> <br /> <br /></font></font><font face="新宋体"><font color="#000000"><br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="line-height: normal; color: "><font color="#0000ff">void</font></span><font color="#000000"> doc_CommandEnded(</font><span style="line-height: normal; color: "><font color="#0000ff">object</font></span><font color="#000000"> sender, </font><span style="line-height: normal; color: "><font color="#2b91af">CommandEventArgs</font></span></font><font face="新宋体"><font color="#000000"> e)<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="line-height: normal; color: "><font color="#0000ff">string</font></span></font><font face="新宋体"><font color="#000000"> commandName = e.GlobalCommandName;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="line-height: normal; color: "><font color="#008000">// filter out the custom commands of this application</font></span><br /><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="line-height: normal; color: "><font color="#0000ff">if</font></span><font color="#000000"> (commandName.StartsWith(</font><span style="line-height: normal; color: "><font color="#a31515">&quot;ACV&quot;</font></span></font><font face="新宋体"><font color="#000000">))<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="line-height: normal; color: "><font color="#0000ff">return</font></span></font><font face="新宋体"><font color="#000000">;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; AddCommandHit(commandName);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="line-height: normal; color: "><font color="#0000ff">private</font></span><font color="#000000">&#160;</font><span style="line-height: normal; color: "><font color="#0000ff">void</font></span><font color="#000000"> AddCommandHit(</font><span style="line-height: normal; color: "><font color="#0000ff">string</font></span></font><font face="新宋体"><font color="#000000"> commandName)<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="line-height: normal; color: "><font color="#0000ff">if</font></span><font color="#000000"> (_commandHitDic.Keys.Contains&lt;</font><span style="line-height: normal; color: "><font color="#0000ff">string</font></span></font><font face="新宋体"><font color="#000000">&gt;(commandName))<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; _commandHitDic[commandName]++;<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="line-height: normal; color: "><font color="#0000ff">else</font></span><br /></font><font face="新宋体"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; _commandHitDic.Add(commandName, 1);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br /> <br /></font></font></pre>

<p>By this code snippet, I am listening to the CommandEnded event and put the hit number of command into a a dictionary.</p>

<p>&#160;</p>

<p>Next step is to upload the command statistics up to the RESTful service on Windows Azure from the dictionary. To send REST request, I am using a popular library <a href="http://restsharp.org/">RestSharp</a> here, you may want to read Stephen’s post about usage of RestSharp <a href="http://adndevblog.typepad.com/autocad/2013/01/integrating-autocad-with-twitter-using-restsharp-part-1.html">here</a>.</p>

<pre style="line-height: normal; font-family: ; background: white; color: "><font face="新宋体"><font color="#000000"><font style="font-size: 7.8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; [</font></font><font style="font-size: 7.8pt"><span style="color: "><font color="#2b91af">CommandMethod</font></span><font color="#000000">(</font><span style="color: "><font color="#a31515">&quot;ACV_UpdateToCloud&quot;</font></span></font></font><font style="font-size: 7.8pt"><font face="新宋体"><font color="#000000">)]<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">public</font></span><font color="#000000">&#160;</font><span style="color: "><font color="#0000ff">void</font></span></font><font face="新宋体"><font color="#000000"> UpdateToCloud()<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#2b91af">UserCommandsHit</font></span><font color="#000000"> usrCmdsHit = </font><span style="color: "><font color="#0000ff">null</font></span></font><font face="新宋体"><font color="#000000">;<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#2b91af">RestClient</font></span><font color="#000000"> client = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000">&#160;</font><span style="color: "><font color="#2b91af">RestClient</font></span></font><font face="新宋体"><font color="#000000">(BASE_URL);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; client.AddHandler(</font><span style="color: "><font color="#a31515">&quot;application/json&quot;</font></span><font color="#000000">, </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000">&#160;</font><span style="color: "><font color="#2b91af">JsonDeserializer</font></span></font><font face="新宋体"><font color="#000000">());<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; usrCmdsHit = GetUserCommadsHitByUserName(_userName, client);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#008000">//CommandHit record with this username is not found in cloud </font></span><br /><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#008000">//Add one record for this user.</font></span><br /><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (usrCmdsHit == </font><span style="color: "><font color="#0000ff">null</font></span></font><font face="新宋体"><font color="#000000">)<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#008000">//add user command hit record </font></span><br /></font><font face="新宋体"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; usrCmdsHit = BuildNewUserCommandsHitFromDictionary(_userName,_commandHitDic);<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#008000">//POST to add new</font></span><br /></font><font face="新宋体"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; AddNewToCloud(usrCmdsHit, client);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">else</font></span><br /></font><font face="新宋体"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#008000">//update the user command hit with dictionary </font></span><br /></font><font face="新宋体"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; usrCmdsHit = UpdateUserCommandsHitFromDictionary(usrCmdsHit,_commandHitDic);<br /> <br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#008000">//PUT to update</font></span><br /></font><font face="新宋体"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; UpdateToCloud(usrCmdsHit, client);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; GetEditor().WriteMessage(</font><span style="color: "><font color="#a31515">&quot;\n Your command usage statastic has been updated to cloud succesfully.&quot;</font></span></font><font face="新宋体"><font color="#000000">);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; GetEditor().WriteMessage(</font><span style="color: "><font color="#a31515">&quot;\n Keep working or open http://acadcommandwebviewer.cloudapp.net/ with a modern broswerto view the magic ball ;) &quot;</font></span></font><font face="新宋体"><font color="#000000">);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; GetEditor().WriteMessage(</font><span style="color: "><font color="#a31515">&quot;\n Chrome/Firefox are recommended. &quot;</font></span></font></font><font face="新宋体"><font style="font-size: 7.8pt"><font color="#000000">);<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; System.Diagnostics.</font><span style="color: "><font color="#2b91af">Process</font></span><font color="#000000">.Start(</font><span style="color: "><font color="#a31515">&quot;http://acadcommandwebviewer.cloudapp.net/&quot;</font></span><font color="#000000">);<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></font></pre>

<pre style="line-height: normal; font-family: ; background: white; color: "><font face="新宋体"><font color="#000000"><font style="font-size: 7.8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 7.8pt"><span style="color: "><font color="#0000ff">private</font></span><font color="#000000">&#160;</font><span style="color: "><font color="#2b91af">UserCommandsHit</font></span></font></font><font style="font-size: 7.8pt"><font face="新宋体"><font color="#000000"> GetUserCommadsHitByUserName(<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">string</font></span></font><font face="新宋体"><font color="#000000"> userName, <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#2b91af">RestClient</font></span></font><font face="新宋体"><font color="#000000"> client)<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#2b91af">UserCommandsHit</font></span><font color="#000000"> usrCmdsHit = </font><span style="color: "><font color="#0000ff">null</font></span></font><font face="新宋体"><font color="#000000">;<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#2b91af">RestRequest</font></span><font color="#000000"> reqGet = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000">&#160;</font><span style="color: "><font color="#2b91af">RestRequest</font></span></font><font face="新宋体"><font color="#000000">();<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; reqGet.Resource = </font><span style="color: "><font color="#a31515">&quot;api/AcadCommands&quot;</font></span></font><font face="新宋体"><font color="#000000">;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; reqGet.Method = </font><span style="color: "><font color="#2b91af">Method</font></span></font><font face="新宋体"><font color="#000000">.GET;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; reqGet.RequestFormat = </font><span style="color: "><font color="#2b91af">DataFormat</font></span></font><font face="新宋体"><font color="#000000">.Json;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; reqGet.AddHeader(</font><span style="color: "><font color="#a31515">&quot;Accept&quot;</font></span><font color="#000000">, </font><span style="color: "><font color="#a31515">&quot;Application/json&quot;</font></span></font><font face="新宋体"><font color="#000000">);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; reqGet.JsonSerializer = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> RestSharp.Serializers.</font><span style="color: "><font color="#2b91af">JsonSerializer</font></span></font><font face="新宋体"><font color="#000000">();<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; reqGet.AddParameter(</font><span style="color: "><font color="#a31515">&quot;username&quot;</font></span></font><font face="新宋体"><font color="#000000">, userName);<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">var</font></span><font color="#000000"> respGet = client.Execute&lt;</font><span style="color: "><font color="#2b91af">UserCommandsHit</font></span></font><font face="新宋体"><font color="#000000">&gt;(reqGet);<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (respGet.StatusCode == System.Net.</font><span style="color: "><font color="#2b91af">HttpStatusCode</font></span></font><font face="新宋体"><font color="#000000">.OK)<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (respGet.Data != </font><span style="color: "><font color="#0000ff">null</font></span><font color="#000000">) </font><br /></font><font face="新宋体"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; usrCmdsHit = respGet.Data;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">else</font></span><br /></font><font face="新宋体"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; usrCmdsHit = Newtonsoft.Json.</font><span style="color: "><font color="#2b91af">JsonConvert</font></span><br /><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; .DeserializeObject&lt;</font><span style="color: "><font color="#2b91af">UserCommandsHit</font></span></font></font><font face="新宋体"><font style="font-size: 7.8pt"><font color="#000000">&gt;(respGet.Content);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> usrCmdsHit;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></font><br /></pre>

<p>&#160;</p>

<pre style="line-height: normal; font-family: ; background: white"><font face="新宋体"><font color="#000000"><font style="font-size: 7.8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 7.8pt"><span style="color: "><font color="#0000ff">private</font></span><font color="#000000">&#160;</font><span style="color: "><font color="#2b91af">UserCommandsHit</font></span></font></font><font style="font-size: 7.8pt"><font face="新宋体"><font color="#000000"> BuildNewUserCommandsHitFromDictionary(<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">string</font></span></font><font face="新宋体"><font color="#000000"> userName,<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#2b91af">Dictionary</font></span><font color="#000000">&lt;</font><span style="color: "><font color="#0000ff">string</font></span><font color="#000000">, </font><span style="color: "><font color="#0000ff">int</font></span></font><font face="新宋体"><font color="#000000">&gt; commandHitDic)<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#2b91af">UserCommandsHit</font></span><font color="#000000"> usrCmdsHit = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000">&#160;</font><span style="color: "><font color="#2b91af">UserCommandsHit</font></span></font><font face="新宋体"><font color="#000000">();<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; usrCmdsHit.UserName = userName;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#2b91af">List</font></span><font color="#000000">&lt;</font><span style="color: "><font color="#2b91af">CommandHit</font></span><font color="#000000">&gt; list = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000">&#160;</font><span style="color: "><font color="#2b91af">List</font></span><font color="#000000">&lt;</font><span style="color: "><font color="#2b91af">CommandHit</font></span></font><font face="新宋体"><font color="#000000">&gt;();<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">foreach</font></span><font color="#000000"> (</font><span style="color: "><font color="#0000ff">var</font></span><font color="#000000"> cmdName </font><span style="color: "><font color="#0000ff">in</font></span></font><font face="新宋体"><font color="#000000"> commandHitDic.Keys)<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#2b91af">CommandHit</font></span><font color="#000000"> ch = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000">&#160;</font><span style="color: "><font color="#2b91af">CommandHit</font></span><br /></font></font><font face="新宋体"><font style="font-size: 7.8pt"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; CommandName = cmdName,<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; HitNumber = commandHitDic[cmdName]<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; };<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; list.Add(ch);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; usrCmdsHit.CommandHits = list;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> usrCmdsHit;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></font></pre>

<pre style="line-height: normal; font-family: ; background: white"><font face="新宋体"><font color="#000000"><font style="font-size: 7.8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 7.8pt"><span style="color: "><font color="#0000ff">private</font></span><font color="#000000">&#160;</font><span style="color: "><font color="#2b91af">UserCommandsHit</font></span></font></font><font style="font-size: 7.8pt"><font face="新宋体"><font color="#000000"> UpdateUserCommandsHitFromDictionary(<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#2b91af">UserCommandsHit</font></span></font><font face="新宋体"><font color="#000000"> usrCmdsHit, <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#2b91af">Dictionary</font></span><font color="#000000">&lt;</font><span style="color: "><font color="#0000ff">string</font></span><font color="#000000">,</font><span style="color: "><font color="#0000ff">int</font></span></font><font face="新宋体"><font color="#000000">&gt; commandHitDic)<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">foreach</font></span><font color="#000000"> (</font><span style="color: "><font color="#0000ff">var</font></span><font color="#000000"> cmdName </font><span style="color: "><font color="#0000ff">in</font></span></font><font face="新宋体"><font color="#000000"> commandHitDic.Keys)<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">int</font></span></font><font face="新宋体"><font color="#000000"> count = usrCmdsHit.CommandHits<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; .Where&lt;</font><span style="color: "><font color="#2b91af">CommandHit</font></span></font><font face="新宋体"><font color="#000000">&gt;(p =&gt; p.CommandName == cmdName)<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; .Count&lt;</font><span style="color: "><font color="#2b91af">CommandHit</font></span></font><font face="新宋体"><font color="#000000">&gt;();<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">if</font></span></font><font face="新宋体"><font color="#000000"> (count == 0)<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#2b91af">CommandHit</font></span><font color="#000000"> ch = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000">&#160;</font><span style="color: "><font color="#2b91af">CommandHit</font></span><br /></font><font face="新宋体"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; CommandName = cmdName,<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; HitNumber = commandHitDic[cmdName]<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; };<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; usrCmdsHit.CommandHits.Add(ch);<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">else</font></span><br /></font><font face="新宋体"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#2b91af">CommandHit</font></span></font><font face="新宋体"><font color="#000000"> ch = usrCmdsHit.CommandHits<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; .First&lt;</font><span style="color: "><font color="#2b91af">CommandHit</font></span></font></font><font face="新宋体"><font style="font-size: 7.8pt"><font color="#000000">&gt;(p =&gt; p.CommandName == cmdName);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; ch.HitNumber += commandHitDic[cmdName];<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">return</font></span><font color="#000000"> usrCmdsHit;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></font></pre>

<pre style="line-height: normal; font-family: ; background: white"><font color="#000000" face="新宋体"></font></pre>

<pre style="line-height: normal; font-family: ; background: white"><font face="新宋体"><font color="#000000"><font style="font-size: 7.8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 7.8pt"><span style="color: "><font color="#0000ff">private</font></span><font color="#000000">&#160;</font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000"> AddNewToCloud(</font><span style="color: "><font color="#2b91af">UserCommandsHit</font></span><font color="#000000"> usrCmdsHit, </font><span style="color: "><font color="#2b91af">RestClient</font></span></font></font><font style="font-size: 7.8pt"><font face="新宋体"><font color="#000000"> client)<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#2b91af">RestRequest</font></span><font color="#000000"> reqPost = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000">&#160;</font><span style="color: "><font color="#2b91af">RestRequest</font></span></font><font face="新宋体"><font color="#000000">();<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; reqPost.Resource = </font><span style="color: "><font color="#a31515">&quot;api/AcadCommands&quot;</font></span></font><font face="新宋体"><font color="#000000">;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; reqPost.Method = </font><span style="color: "><font color="#2b91af">Method</font></span></font><font face="新宋体"><font color="#000000">.POST;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; reqPost.RequestFormat = </font><span style="color: "><font color="#2b91af">DataFormat</font></span></font><font face="新宋体"><font color="#000000">.Json;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; reqPost.AddHeader(</font><span style="color: "><font color="#a31515">&quot;Content-Type&quot;</font></span><font color="#000000">, </font><span style="color: "><font color="#a31515">&quot;application/json&quot;</font></span></font><font face="新宋体"><font color="#000000">);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; reqPost.JsonSerializer = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000"> RestSharp.Serializers.</font><span style="color: "><font color="#2b91af">JsonSerializer</font></span></font><font face="新宋体"><font color="#000000">();<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; reqPost.AddBody(usrCmdsHit);<br /> <br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">var</font></span><font color="#000000"> respPost = client.Execute&lt;</font><span style="color: "><font color="#2b91af">UserCommandsHit</font></span></font><font face="新宋体"><font color="#000000">&gt;(reqPost);<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (respPost.StatusCode == System.Net.</font><span style="color: "><font color="#2b91af">HttpStatusCode</font></span></font><font face="新宋体"><font color="#000000">.Created)<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; _commandHitDic.Clear();<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; GetEditor().WriteMessage(</font><span style="color: "><font color="#a31515">&quot;\nUpdate to cloud successfully.&quot;</font></span></font><font face="新宋体"><font color="#000000">);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">else</font></span><br /></font><font face="新宋体"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; GetEditor().WriteMessage(</font><span style="color: "><font color="#a31515">&quot;\n Error:&quot;</font></span></font></font><font face="新宋体"><font style="font-size: 7.8pt"><font color="#000000"> + respPost.StatusCode);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; GetEditor().WriteMessage(</font><span style="color: "><font color="#a31515">&quot;\n&quot;</font></span><font color="#000000"> + respPost.Content);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></font></pre>

<pre style="line-height: normal; font-family: ; background: white"><font color="#000000" face="新宋体"></font></pre>

<p><font color="#000000" face="新宋体"></font></p>

<pre style="line-height: normal; font-family: ; background: white; color: "><font face="新宋体"><font color="#000000"><font style="font-size: 7.8pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></font><font style="font-size: 7.8pt"><span style="color: "><font color="#0000ff">private</font></span><font color="#000000">&#160;</font><span style="color: "><font color="#0000ff">void</font></span><font color="#000000"> UpdateToCloud(</font><span style="color: "><font color="#2b91af">UserCommandsHit</font></span><font color="#000000"> usrCmdsHit, </font><span style="color: "><font color="#2b91af">RestClient</font></span></font></font><font style="font-size: 7.8pt"><font face="新宋体"><font color="#000000"> client)<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#2b91af">RestRequest</font></span><font color="#000000"> reqPut = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000">&#160;</font><span style="color: "><font color="#2b91af">RestRequest</font></span></font><font face="新宋体"><font color="#000000">();<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; reqPut.Resource = </font><span style="color: "><font color="#a31515">&quot;api/AcadCommands/&quot;</font></span></font><font face="新宋体"><font color="#000000"> + usrCmdsHit.Id ;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; reqPut.Method = </font><span style="color: "><font color="#2b91af">Method</font></span></font><font face="新宋体"><font color="#000000">.PUT;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; reqPut.RequestFormat = </font><span style="color: "><font color="#2b91af">DataFormat</font></span></font><font face="新宋体"><font color="#000000">.Json;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; reqPut.AddHeader(</font><span style="color: "><font color="#a31515">&quot;Content-Type&quot;</font></span><font color="#000000">, </font><span style="color: "><font color="#a31515">&quot;application/json&quot;</font></span></font><font face="新宋体"><font color="#000000">);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; reqPut.JsonSerializer = </font><span style="color: "><font color="#0000ff">new</font></span><font color="#000000">&#160;</font><span style="color: "><font color="#2b91af">JsonSerializer</font></span></font><font face="新宋体"><font color="#000000">();<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; reqPut.AddBody(usrCmdsHit);<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">var</font></span><font color="#000000"> respPut = client.Execute&lt;</font><span style="color: "><font color="#2b91af">UserCommandsHit</font></span></font><font face="新宋体"><font color="#000000">&gt;(reqPut);<br /> <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">if</font></span><font color="#000000"> (respPut.StatusCode == System.Net.</font><span style="color: "><font color="#2b91af">HttpStatusCode</font></span></font><font face="新宋体"><font color="#000000">.OK)<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; _commandHitDic.Clear();<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; GetEditor().WriteMessage(</font><span style="color: "><font color="#a31515">&quot;\nUpdate to cloud successfully.&quot;</font></span></font><font face="新宋体"><font color="#000000">);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font><span style="color: "><font color="#0000ff">else</font></span><br /></font><font face="新宋体"><font color="#000000">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; {<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; GetEditor().WriteMessage(</font><span style="color: "><font color="#a31515">&quot;\n Error:&quot;</font></span></font></font><font face="新宋体"><font style="font-size: 7.8pt"><font color="#000000"> + respPut.StatusCode);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; GetEditor().WriteMessage(</font><span style="color: "><font color="#a31515">&quot;\n&quot;</font></span><font color="#000000"> + respPut.Content);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; }</font></font></font></pre>

<pre style="line-height: normal; font-family: ; background: white"><br /></pre>

<pre style="line-height: normal; font-family: ; background: white"><font color="#000000" face="新宋体"></font></pre>

<p>Okay, with that I am wrapping up this post, hopefully you got the idea what I did, and hope it is helpful for you.</p>
