comments:
- author: bsyap
  email: nsybs.86@gmail.com
  ip: 60.51.122.54
  url: ''
  date: '2010-06-09 05:43:29'
  body: "Hi,\n \nI am using a Structural Modeling/Design application to model'design\
    \ a simple building. And I am trying to save the content/data generated by the\
    \ application into a revit file format (.rvt) using the Revit API.\n \nExample\
    \ : \n1)How to save the (Source)Structural Beam Data (generated by my Structural\
    \ Modeling/Design application) into the (Target)Beam Data in Revit Structural\
    \ Software. (.rvt)\n2)How to map each of my external data into a revit file.\n\
    eg: Let's said my beam object contain properties like beam depth(DOUBLE), beam\
    \ length(DOUBLE), beam offset(DOUBLE),beam mark(string),isConcreate(boolean)...,\
    \ how do I map all this field into Revit beam object.\n \nAs a result, Autodesk\
    \ Revit Structure can be able to generate the same building i have modeled/designed.\n\
    \ \nAny idea of doing this?\n \nAny help would be greatly appreciated.\n \nRegards,\n\
    bsyap"
- author: Jeremy Tammik
  email: ''
  ip: 63.138.96.2
  url: http://profile.typepad.com/1218580759s22477
  date: '2010-06-09 09:39:52'
  body: 'Dear bsyap,


    1) You can define shared parameters on the beam elements and store arbitrary data
    in those. For more information on this, look at the Parameters category:


    <a href="http://thebuildingcoder.typepad.com/blog/parameters">http://thebuildingcoder.typepad.com/blog/parameters</a>


    2) For mapping data between an external database and Revit elements, the safest
    bet is to make use of the Revit element UniqueId property, which provides a unique
    identifier for each element.


    Cheers, Jeremy.'
- author: bsyap
  email: nsybs.86@gmail.com
  ip: 60.51.122.54
  url: ''
  date: '2010-06-13 23:55:34'
  body: "Hi Jeremy,\n\nThanks for the reply. I have read the solution you provided\
    \ above. However, i need to save all the content/data generated by a third party\
    \ structural application to a .rvt(Revit file). The solution you provided is for\
    \ Revit user to import external database into Revit program, but what i intended\
    \ to do is to write the structural content into a .rvt extension file. \n\nI have\
    \ study the Revit API and the class structure of Revit (Application,Document,\
    \ Element,...)and the Revit class structure is huge.\n\nBelow is the scenario\
    \ of what i am intended to do.\n\n1)Create the Revit file. (How can i create a\
    \ Revit file without the using the IexternalCommand  doc = commandData.Application.ActiveUIDocument.Document;\n\
    I have try to create a new Revit document using this, but it won't works. \nApplication\
    \ revitApp = new Application();\nDocument doc = revitApp.NewProjectDocument(RevitTemplate);\n\
    \nException Thrown : revitApp.Family Template Path threw an exception of type\
    \ \n{Autodesk.Revit.Exceptions.ApplicationException} = {\"Object has not been\
    \ initialized yet.\"}\n\nI have all the content of a building model such as grid/beam/column/slab/load/wall.\
    \ How am i get all this data fit into the Revit building model.\n\nEg:\n\n2)Creation\
    \ of beam/grid/slab object. (How do i map my own beam data to the revit beam object.)\n\
    Eg: I have a myBeam class. After initiation of myBeam object, how do i map the\
    \ value of each of the properties into the beam object in Revit. \npublic class\
    \ myBeam\n{\n  //private fields\n  private double length;\n  private string beammark;\n\
    \  private bool isconcreate;\n  //Constructor\n  public myBeam(){}\n  //Properties\n\
    \  public double Length{ get{} set{} }\n}\n\n3)Save the Revit file. (How can I\
    \ save the Revit document file.)\ndoc.SaveAs(\"example.rvt\"),this command didn't\
    \ work since the early exception thrown.\n\nAny help would be greatly appreciated.\n\
    \nRegards,\nbsyap"
- author: Jeremy Tammik
  email: ''
  ip: 132.188.32.100
  url: http://profile.typepad.com/1218580759s22477
  date: '2010-06-14 10:53:57'
  body: 'Dear bsyap,


    The Revit API is actually pretty small compared to AutoCAD ARX.


    You cannot create a new instance of the Revit Application class.


    An application instance is provided to you in the external command Exectue callback
    method, and other Revit API entry point methods.


    You cannot drive Revit or make ose of the Revit API from outside a Revit API callback
    context, as described in numerous posts on this blog, e.g.


    <a href="http://thebuildingcoder.typepad.com/blog/2010/04/asynchronous-api-calls-and-idling.html">http://thebuildingcoder.typepad.com/blog/2010/04/asynchronous-api-calls-and-idling.html</a>


    Cheers, Jeremy.'
- author: bsyap
  email: nsybs.86@gmail.com
  ip: 60.51.122.54
  url: ''
  date: '2010-06-15 05:11:27'
  body: "Hi Jeremy,\n\nThanks again for the reply. Since I can't create \nan instance\
    \ of Revit Application file, i can't store all my third party application building\
    \ information into the Revit file.\n \nMay I know is there any alternative ways\
    \ to store a third party application building data(beam length, column width,...)\
    \ in order to be imported and shared by the Revit application.\n\nBesides that,\
    \ do i need to set/map each of my building data respectively to a building data\
    \ in Revit. But how? using element iteration and set the value of each element?\n\
    \nEg: I have a myBeam class. After initiation of myBeam object, how do i map the\
    \ value of each of the properties into the beam object in Revit. \npublic class\
    \ myBeam\n{\n//private fields\nprivate double length;\nprivate string beammark;\n\
    private bool isconcreate;\n//Constructor\npublic myBeam(){}\n//Properties\npublic\
    \ double Length{ get{} set{} }\n}\n\nAny suggestion would be greatly appreciated.\n\
    \nRegards,\nbsyap"
- author: Jeremy Tammik
  email: ''
  ip: 132.188.32.100
  url: http://profile.typepad.com/1218580759s22477
  date: '2010-06-15 06:08:56'
  body: "Dear bsyap,\n\nI never said that you cannot create a new Revit file, just\
    \ that you cannot create an instance of the main Revit Application.\n\nCreating\
    \ new doucments is enabled by the following Applicaton member methods:\n\n- NewFamilyDocument\n\
    - NewProjectDocument\n- NewProjectTemplateDocument\n\nYou can also create new\
    \ Revit building elements in the file, and store your application data in new\
    \ and existing elements, either using existing element properties or your own\
    \ custom shared parameters.\n\nIt seems to me that you are rushing ahead of things.\
    \ How about simply downloading and studying the Revit SDK and the introduction\
    \ to the Revit API presented there. \n\nYou can also read the Getting started\
    \ category of this blog.\n\nCheers, Jeremy."
- author: Daniel LAMBLIN
  email: daniel.lamblin@egis.fr
  ip: 194.250.6.178
  url: ''
  date: '2015-01-12 10:21:07'
  body: "Hello Jeremy,\n\nI simply want to make a saveas of rvt file when user create\
    \ a new file. for instance I click on a button to lauch this method :\n\n    \
    \        UIApplication app = commandData.Application;\n            Document doc\
    \ = app.ActiveUIDocument.Document;\n            SaveAsOptions options = new SaveAsOptions();\n\
    \            options.OverwriteExistingFile = true;\n\n            string fich\
    \ = \"D:/DATA/d.lamblin/Documents/docsaveas.rvt\";\n            try\n        \
    \    {\n                doc.SaveAs(fich);\n            }\n            catch (Exception\
    \ e)\n            {\n                string msg = e.Message;\n\n             \
    \   System.Diagnostics.Debug.WriteLine(\"Write to \" + fich + \" Failed \" + msg);\n\
    \                System.Diagnostics.Debug.WriteLine(e.Message);\n            }\n\
    \nBut SaveAs doesn't work : 'Internal error' each time.\nIs it a problem of context\
    \ ?\n(In which case I can use saveas ?)\n\nRegards,\n\nDaniel"
- author: Jeremy Tammik
  email: ''
  ip: 87.102.230.236
  url: http://profile.typepad.com/jeremytammik
  date: '2015-01-12 11:40:03'
  body: 'Dear Daniel,


    You ask "Is it a problem of context?"


    That makes me think...


    Have you implemented an external command?


    If not, you need to work through the Revit API getting started material, especially
    the DevTV and My First Revit Plugin tutorials:


    <a href="http://thebuildingcoder.typepad.com/blog/about-the-author.html#2">http://thebuildingcoder.typepad.com/blog/about-the-author.html#2</a>


    Here are some additional pointer for getting started:


    <a href="http://thebuildingcoder.typepad.com/blog/2015/01/cloud-accelerator-and-more-revit-stuff.html#3">http://thebuildingcoder.typepad.com/blog/2015/01/cloud-accelerator-and-more-revit-stuff.html#3</a>


    Once you have worked through the tutorials, you know what you need about external
    commands and valid Revit API context.


    Have you installed the Revit SDK, and do you have the Revit API help file RevitAPI.chm
    at hand?


    That is obviously the first place to look.


    By the way, although you instantiate a SaveAsOptions instance and set its OverwriteExistingFile,
    you never make use of it.


    Did you intend to overwrite an existing file?


    If so, pass in the options to the SaveAs method.


    Cheers, Jeremy.'
- author: Daniel LAMBLIN
  email: daniel.lamblin@egis.fr
  ip: 194.250.6.178
  url: ''
  date: '2015-01-13 04:06:24'
  body: "Hello Jeremy,\n\nI have allready maked several applications from REVIT, so\
    \ I have REVIT SDK with all his samples.\nI don't want to overwrite an existing\
    \ file. I implemented an external command : \n  [Transaction(TransactionMode.ReadOnly)]\n\
    \    [Regeneration(RegenerationOption.Manual)]\n    public class CmdDocSaveas\
    \ : IExternalCommand\n    {\n          public Result Execute(ExternalCommandData\
    \ commandData,\n          ref String message, ElementSet elements)\n        {\n\
    \            if (null == commandData.Application.ActiveUIDocument.Document)\n\
    \            {\n                message = \"Active view is null.\";\n        \
    \        return Autodesk.Revit.UI.Result.Failed;\n            }\n            Document\
    \ doc = commandData.Application.ActiveUIDocument.Document;\n           string\
    \ fich = \"C:/docsaveas.rvt\";\n            try\n            {\n             \
    \   doc.SaveAs(fich);\n            }\n            catch (Exception e)\n      \
    \      {\n                string msg = e.Message;\n                System.Diagnostics.Debug.WriteLine(\"\
    Write to \" + fich + \" Failed \" + msg);\n                System.Diagnostics.Debug.WriteLine(e.Message);\n\
    \            }\n             System.Windows.MessageBox.Show(doc.PathName, \" SaveAS\"\
    );\n            return Result.Succeeded;\n        }\n    }\n\nOf course my target\
    \ is to help user to give a right name to his files and help him to range it.\n\
    The first step is to be able to do a saveas.\nWhen I click to the good button\
    \ on my ribon panel, the command start but fail in the saveas method:\n\"An internal\
    \ error has occured\"\nany idea ?\n\nregards,\n\nDaniel"
- author: Jeremy Tammik
  email: ''
  ip: 87.102.230.236
  url: http://profile.typepad.com/jeremytammik
  date: '2015-01-13 07:05:58'
  body: "Dear Daniel,\n\nNope, sorry, no idea.\n\nI created a new add-in using your\
    \ code to implement the external command Execute method like this:\n\n  Document\
    \ doc = commandData.Application.ActiveUIDocument.Document;\n\n  if( null == doc\
    \ )\n  {\n    message = \"Active view is null.\";\n    return Result.Failed;\n\
    \  }\n  string fich = \"C:/docsaveas.rvt\";\n  try\n  {\n    doc.SaveAs( fich\
    \ );\n  }\n  catch( Exception e )\n  {\n    string msg = e.Message;\n    System.Diagnostics.Debug.WriteLine(\
    \ \"Write to \" + fich + \" Failed \" + msg );\n    System.Diagnostics.Debug.WriteLine(\
    \ e.Message );\n  }\n  Debug.Print( doc.PathName + \" saved by SaveAs\" );\n \
    \ return Result.Succeeded;\n\nIt performs flawlessly for me and creates:\n\n01/13/2015\
    \  01:02 PM  3,620,864 docsaveas.rvt\n\nSo, sorry to say, there is something else\
    \ wrong in your system.\n\nSaveAs is used in many locations and situations in\
    \ all kinds of Revit add-ins, including several discussed here on the blog.\n\n\
    Here are some of the more recent examples:\n\nFamily related:\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2014/09/modifying-saving-and-reloading-families.html\"\
    >http://thebuildingcoder.typepad.com/blog/2014/09/modifying-saving-and-reloading-families.html</a>\n\
    \n<a href=\"http://thebuildingcoder.typepad.com/blog/2014/10/creating-a-sloped-wall.html#4\"\
    >http://thebuildingcoder.typepad.com/blog/2014/10/creating-a-sloped-wall.html#4</a>\n\
    \nServer related:\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2013/12/saving-a-new-central-file-to-revit-server.html#3\"\
    >http://thebuildingcoder.typepad.com/blog/2013/12/saving-a-new-central-file-to-revit-server.html#3</a>\n\
    \nA bit older:\n\n<a href=\"http://thebuildingcoder.typepad.com/blog/2011/05/cascaded-events-and-renaming-the-active-document.html\"\
    >http://thebuildingcoder.typepad.com/blog/2011/05/cascaded-events-and-renaming-the-active-document.html</a>\n\
    \nUnfortunately, people in general have infinite creativity in finding ways to\
    \ make life difficult for themselves.\n\nI do what I can to try to prevent it,\
    \ but to little avail  :-)\n\nI wonder what is causing this issue for you.\n\n\
    Best of luck resolving it!\n\nCheers, Jeremy."
- author: Daniel LAMBLIN
  email: daniel.lamblin@egis.fr
  ip: 217.167.155.117
  url: ''
  date: '2015-01-14 05:52:27'
  body: "Hello Jeremy,\n\nI understand your answer. I am sure now that the code is\
    \ right (is it important to known), so I can look after other reasons, probably\
    \ outside REVIT. \n\nThanks for your test with my code.\n\nRegards\n\nDaniel"
- author: Jeremy Tammik
  email: ''
  ip: 132.188.32.206
  url: http://profile.typepad.com/jeremytammik
  date: '2015-01-14 06:44:54'
  body: 'Dear Daniel,


    My pleasure, thank you for your appreciation, and sorry I could not say more.


    Have you ensured that you can successfully save the Revit project file manually
    in the user interface?


    Good luck resolving it!


    Cheers, Jeremy.

    -----'
