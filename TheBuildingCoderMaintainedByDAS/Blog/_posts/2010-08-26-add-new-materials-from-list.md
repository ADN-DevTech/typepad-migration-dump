---
layout: "post"
title: "Add New Materials from List"
date: "2010-08-26 00:00:00"
author: "Jeremy Tammik"
categories:
  - "Element Relationships"
  - "External"
  - "Settings"
  - "Utilities"
original_url: "https://thebuildingcoder.typepad.com/blog/2010/08/add-new-materials-from-list.html "
typepad_basename: "add-new-materials-from-list"
typepad_status: "Publish"
---

<p>I am happily back from 

<a href="http://en.wikipedia.org/wiki/Siem_Reap">
Siem Reap</a> in 

Cambodia and the 

<a href="http://en.wikipedia.org/wiki/Angkor_Wat">
ruins of Angkor Wat</a>

(<a href="http://www.facebook.com/album.php?aid=68525&id=1019863650">more</a>
<a href="http://www.facebook.com/album.php?aid=68592&id=1019863650">photos</a>):</p>

<center>

<a style="display: inline;" href="http://thebuildingcoder.typepad.com/.a/6a00e553e1689788330134867870a9970c-popup" onclick="window.open( this.href, '_blank', 'width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0' ); return false"><img class="asset  asset-image at-xid-6a00e553e1689788330134867870a9970c" alt="Angkor Wat" title="Angkor Wat" src="/assets/image_1a99db.jpg" /></a> <br />

<a style="display: inline;" href="http://thebuildingcoder.typepad.com/.a/6a00e553e168978833013486787472970c-popup" onclick="window.open( this.href, '_blank', 'width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0' ); return false"><img class="asset  asset-image at-xid-6a00e553e168978833013486787472970c" alt="Angkor Wat" title="Angkor Wat" src="/assets/image_550bd6.jpg" /></a> <br />

<a style="display: inline;" href="http://thebuildingcoder.typepad.com/.a/6a00e553e168978833013486787627970c-popup" onclick="window.open( this.href, '_blank', 'width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0' ); return false"><img class="asset  asset-image at-xid-6a00e553e168978833013486787627970c" alt="Angkor Wat" title="Angkor Wat" src="/assets/image_f3577c.jpg" /></a> <br />

<a style="display: inline;" href="http://thebuildingcoder.typepad.com/.a/6a00e553e1689788330133f3545194970b-popup" onclick="window.open( this.href, '_blank', 'width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0' ); return false"><img class="asset  asset-image at-xid-6a00e553e1689788330133f3545194970b" alt="Angkor Wat" title="Angkor Wat" src="/assets/image_a6294d.jpg" /></a> <br />

<a style="display: inline;" href="http://thebuildingcoder.typepad.com/.a/6a00e553e1689788330133f354537e970b-popup" onclick="window.open( this.href, '_blank', 'width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0' ); return false"><img class="asset  asset-image at-xid-6a00e553e1689788330133f354537e970b" alt="Angkor Wat" title="Angkor Wat" src="/assets/image_c43f19.jpg" /></a> <br />

</center>

<p>Yesterday I visited the 

<a href="http://en.wikipedia.org/wiki/Grand_Palace">
Grand Palace</a> and 

the 

<a href="http://en.wikipedia.org/wiki/Wat_Pho">
reclining Buddha in Wat Pho</a> in Bangkok

(<a href="http://www.facebook.com/album.php?aid=68594&id=1019863650">more photos</a>):</p>

<center>

<a style="display: inline;" href="http://thebuildingcoder.typepad.com/.a/6a00e553e1689788330133f3545958970b-popup" onclick="window.open( this.href, '_blank', 'width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0' ); return false"><img class="asset  asset-image at-xid-6a00e553e1689788330133f3545958970b" alt="Grand Palace" title="Grand Palace" src="/assets/image_d3a5cc.jpg" /></a> <br />

<a style="display: inline;" href="http://thebuildingcoder.typepad.com/.a/6a00e553e168978833013486788737970c-popup" onclick="window.open( this.href, '_blank', 'width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0' ); return false"><img class="asset  asset-image at-xid-6a00e553e168978833013486788737970c" alt="Grand Palace" title="Grand Palace" src="/assets/image_f53b01.jpg" /></a> <br />

<a style="display: inline;" href="http://thebuildingcoder.typepad.com/.a/6a00e553e1689788330133f3546564970b-popup" onclick="window.open( this.href, '_blank', 'width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0' ); return false"><img class="asset  asset-image at-xid-6a00e553e1689788330133f3546564970b" alt="Reclining Buddha" title="Reclining Buddha" src="/assets/image_8b9765.jpg" /></a> <br />

<a style="display: inline;" href="http://thebuildingcoder.typepad.com/.a/6a00e553e1689788330134867896d5970c-popup" onclick="window.open( this.href, '_blank', 'width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0' ); return false"><img class="asset  asset-image at-xid-6a00e553e1689788330134867896d5970c" alt="Reclining Buddha" title="Reclining Buddha" src="/assets/image_e7a8f3.jpg" /></a> <br />

</center>

<p>Angkor Wat and Cambodia was absolutely wonderful, and I am really glad that I went there.
The places I visited in Thailand were rather touristy, whereas in Cambodia I had the feeling of getting much 

more in touch with real people and life:</p>

<center>

<a style="display: inline;" href="http://thebuildingcoder.typepad.com/.a/6a00e553e168978833013486785a7e970c-popup" onclick="window.open( this.href, '_blank', 'width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0' ); return false"><img class="asset  asset-image at-xid-6a00e553e168978833013486785a7e970c" alt="Child" title="Child" src="/assets/image_5658b2.jpg" /></a> <br />

<a style="display: inline;" href="http://thebuildingcoder.typepad.com/.a/6a00e553e168978833013486785f3a970c-popup" onclick="window.open( this.href, '_blank', 'width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0' ); return false"><img class="asset  asset-image at-xid-6a00e553e168978833013486785f3a970c" alt="Children" title="Children" src="/assets/image_09ed78.jpg" /></a> <br />

<a style="display: inline;" href="http://thebuildingcoder.typepad.com/.a/6a00e553e1689788330134867862f3970c-popup" onclick="window.open( this.href, '_blank', 'width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0' ); return false"><img class="asset  asset-image at-xid-6a00e553e1689788330134867862f3970c" alt="Temple" title="Temple" src="/assets/image_6f4118.jpg" /></a> <br />

<a style="display: inline;" href="http://thebuildingcoder.typepad.com/.a/6a00e553e168978833013486786461970c-popup" onclick="window.open( this.href, '_blank', 'width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0' ); return false"><img class="asset  asset-image at-xid-6a00e553e168978833013486786461970c" alt="People" title="People" src="/assets/image_cbd089.jpg" /></a> <br />

<a style="display: inline;" href="http://thebuildingcoder.typepad.com/.a/6a00e553e1689788330133f354435b970b-popup" onclick="window.open( this.href, '_blank', 'width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0' ); return false"><img class="asset  asset-image at-xid-6a00e553e1689788330133f354435b970b" alt="Monkey" title="Monkey" src="/assets/image_67d8db.jpg" /></a> <br />

</center>

<p>Before going there I was thinking that I am not really all that interested in this kind of travelling, but 

the connection that I experienced there really motivated me to return again, and possibly visit Laos as well.
One nice idea would be to go for a walk from northern Thailand along the western border of Laos all the way up 

to China.

<p>Now I am staying with my brother Marcus in Pattaya again, picking up my computer before returning to 

Switzerland.

<p>So, returning to Revit programming topics after this wonderful break from computers and the heart-warming dive into loving friendliness of Cambodian people...


<a name="2"></a>

<h4>Importing and Creating New Materials from a List</h4>

<p>Quite a while back, I discussed programmatically 

<a href="http://thebuildingcoder.typepad.com/blog/2009/05/new-material.html">
adding a new material</a> to the Revit project. 

I would like to present a useful real-world application that takes this much further, created by Jinsol Kim of 

<a href="http:www.rcmsgroup.com">
RCMS GROUP</a> to

add an entire list of materials read from an Excel spreadsheet to a Revit project.

Here is part of the discussions we had during the development and Jinsol's detailed description of the final 

process:

<p><strong>Question:</strong> I am trying to add some material lists programmatically and running into some 

problems here.
The materials are defined in Excel spreadsheets used as input and containing data such as 

<ul>
<li>Material Name
<ul>
<li>Code
<li>Title
<li>Strength
</ul>
<li>Graphics
<ul>
<li>RGB colour
<li>Rendering data
</ul>
<li>Identity
<ul>
<li>Filter criteria
<li>Descriptive information
<li>Custom parameters
</ul>
</ul>

<p>I found a way to add materials like this:

<pre>
&nbsp; <span class="blue">string</span> newName = <span class="maroon">&quot;03 15 00&quot;</span>;
&nbsp;
&nbsp; <span class="teal">MaterialOther</span> myMaterial
&nbsp; &nbsp; = doc.Settings.Materials.AddOther(
&nbsp; &nbsp; &nbsp; newName );
&nbsp;
&nbsp; myMaterial.Color = <span class="blue">new</span> <span class="teal">Color</span>( 127, 127, 127 );
&nbsp; myMaterial.Transparency = 0;
</pre>

<p>However, I cannot find out any parameters related to 'Identity'.
In order to classify the material lists, I need to put values on 'Material Class'.
How can I access that value, i.e. Materials &gt; Identity &gt; Material Class (Filter Criteria)?

<p><strong>Answer:</strong> As said, we did discuss 

<a href="http://thebuildingcoder.typepad.com/blog/2009/05/new-material.html">
adding a new material</a> quite 

a while back.

<p>For the identity fields, you could simply add your own shared parameters to the model.

<p>Using shared parameters, you can add arbitrary data to all elements of any category.

<p><strong>Question:</strong> One more thing:
If I create a shared parameter named 'Material Class' for example under the Materials and finishes group, then 

there seems to be no way for users to use the Material Class filter.
Using the API, I will add up to about 2000 materials at once to avoid typing in every material in each 

project.
Users might want to see only specific materials which belong to specific material class by filtering them out 

with material class.
If the material class doesn't support filter by material class, then do you think I need to create a custom 

filter separately for it?

<p>Here are the expected results, although created manually in this case:</p>

<center>

<a style="display: inline;" href="http://thebuildingcoder.typepad.com/.a/6a00e553e1689788330133f3542c5f970b-popup" onclick="window.open( this.href, '_blank', 'width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0' ); return false"><img class="asset  asset-image at-xid-6a00e553e1689788330133f3542c5f970b image-full" alt="Added materials" title="Added materials" src="/assets/image_f45724.jpg" border="0" /></a> <br />

</center>

<p><strong>Answer:</strong> That looks a bit similar to the view filter, for which there is full API access as 

demonstrated by the ElementFilter/ViewFilters sample.
Unfortunately, it looks to me as if the materials filter is not accessible in the same way.

<p><strong>Question:</strong> I chose another way to solve how to maintain the material class name in the 

identity data of Materials.

<p>First, I created a set of root materials manually with the proper Material Class and then duplicated them 

accordingly to appropriate master format division.

<p>Here is a more detailed description:

<p><strong>Step 1:</strong> Set up the basic materials manually within the project file to duplicate with 

'Material Class'.

<p>Note: The Material Class name should follow this format: 'CSI XX'.</p>

<center>

<a style="display: inline;" href="http://thebuildingcoder.typepad.com/.a/6a00e553e1689788330133f3542be7970b-popup" onclick="window.open( this.href, '_blank', 'width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0' ); return false"><img class="asset  asset-image at-xid-6a00e553e1689788330133f3542be7970b image-full" alt="Basic materials" title="Basic materials" src="/assets/image_9f2a4d.jpg" border="0" /></a> <br />

</center>

<p><strong>Step 2:</strong> Check all the material information in defined in the right format. 

<p>The input spreadsheet is read from C:\RevitAPI\MaterialList.xlsx.

<p>Note 1: Graphics section doesn't allow an empty space. It should be filled with '0' or N/A.

<p>Note 2: Material Class values should be equivalent to basic material class that will be used for 

duplication.</p>

<center>

<a style="display: inline;" href="http://thebuildingcoder.typepad.com/.a/6a00e553e1689788330133f35428cc970b-popup" onclick="window.open( this.href, '_blank', 'width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0' ); return false"><img class="asset  asset-image at-xid-6a00e553e1689788330133f35428cc970b image-full" alt="Input spreadsheet" title="Input spreadsheet" src="/assets/image_501764.jpg" border="0" /></a> <br />

</center>

<p><strong>Step 3:</strong> Run the add-in and check that the materials were added successfully.</p>

<center>

<a style="display: inline;" href="http://thebuildingcoder.typepad.com/.a/6a00e553e1689788330133f3542857970b-popup" onclick="window.open( this.href, '_blank', 'width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0' ); return false"><img class="asset  asset-image at-xid-6a00e553e1689788330133f3542857970b" alt="Run the add-in" title="Run the add-in" src="/assets/image_748fe0.jpg" border="0" /></a> <br />

</center>

<center>

<a style="display: inline;" href="http://thebuildingcoder.typepad.com/.a/6a00e553e1689788330133f35427d8970b-popup" onclick="window.open( this.href, '_blank', 'width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0' ); return false"><img class="asset  asset-image at-xid-6a00e553e1689788330133f35427d8970b" alt="Add-in message" title="Add-in message" src="/assets/image_00b72a.jpg" border="0" /></a> <br />

</center>

<center>

<a style="display: inline;" href="http://thebuildingcoder.typepad.com/.a/6a00e553e1689788330133f3542750970b-popup" onclick="window.open( this.href, '_blank', 'width=640,height=480,scrollbars=no,resizable=no,toolbar=no,directories=no,location=no,menubar=no,status=no,left=0,top=0' ); return false"><img class="asset  asset-image at-xid-6a00e553e1689788330133f3542750970b image-full" alt="Added materials" title="Added materials" src="/assets/image_d90490.jpg" border="0" /></a> <br />

</center>

<p>Here is Jinsol's original 

<span class="asset  asset-generic at-xid-6a00e553e1689788330133f3542680970b"><a href="http://thebuildingcoder.typepad.com/files/addmaterials.pptx">Powerpoint version</a></span> of 

the detailed description, and here is 

<span class="asset  asset-generic at-xid-6a00e553e168978833013486784b64970c"><a href="http://thebuildingcoder.typepad.com/files/addmaterials01.zip">AddMaterials01.zip</a></span> containing 

the complete Visual Studio solution and source code of the AddMaterials Revit add-in.

<p>Thank you very much, Jinsol, for creating this solution and documenting and sharing it with us!

<p><strong>Addendum:</strong> This utility has been updated.

Please check out the

<a href="http://thebuildingcoder.typepad.com/blog/2014/03/adding-new-materials-from-list-updated.html">
migration to Revit 2014</a> and the

<a href="http://thebuildingcoder.typepad.com/blog/2014/03/adding-new-materials-from-list-updated-again.html">
enhancements in release 2014.0.0.1</a>.</p>
